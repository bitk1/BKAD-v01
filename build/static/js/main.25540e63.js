/*! For license information please see main.25540e63.js.LICENSE.txt */
(()=>{var __webpack_modules__={50676:(e,t,n)=>{"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,{Z:()=>r})},59968:(e,t,n)=>{"use strict";function r(e){if(Array.isArray(e))return e}n.d(t,{Z:()=>r})},63349:(e,t,n)=>{"use strict";function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,{Z:()=>r})},97723:(e,t,n)=>{"use strict";function r(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}n.d(t,{Z:()=>r})},6610:(e,t,n)=>{"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,{Z:()=>r})},63914:(e,t,n)=>{"use strict";function r(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}n.d(t,{Z:()=>r})},58271:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(63914);function i(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,(0,r.Z)(e,t,"get"))}},44743:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(97723);function i(e,t,n){(0,r.Z)(e,t),t.set(e,n)}},5991:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(22863);function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(0,r.Z)(i.key),i)}}function o(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}},96156:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(22863);function i(e,t,n){return(t=(0,r.Z)(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},22122:(e,t,n)=>{"use strict";function r(){return r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}n.d(t,{Z:()=>r})},77608:(e,t,n)=>{"use strict";function r(e){return r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},r(e)}n.d(t,{Z:()=>r})},10379:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(14665);function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&(0,r.Z)(e,t)}},41788:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(14665);function i(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,(0,r.Z)(e,t)}},96410:(e,t,n)=>{"use strict";function r(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}n.d(t,{Z:()=>r})},28970:(e,t,n)=>{"use strict";function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}n.d(t,{Z:()=>r})},81253:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(19756);function i(e,t){if(null==e)return{};var n,i,o=(0,r.Z)(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}},19756:(e,t,n)=>{"use strict";function r(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}n.d(t,{Z:()=>r})},46070:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(90484),i=n(63349);function o(e,t){if(t&&("object"===(0,r.Z)(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return(0,i.Z)(e)}},14665:(e,t,n)=>{"use strict";function r(e,t){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},r(e,t)}n.d(t,{Z:()=>r})},28481:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=n(59968);var i=n(82961),o=n(28970);function s(e,t){return(0,r.Z)(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,s,a=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(a.push(r.value),a.length!==t);c=!0);}catch(u){l=!0,i=u}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw i}}return a}}(e,t)||(0,i.Z)(e,t)||(0,o.Z)()}},22863:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(90484);function i(e){var t=function(e,t){if("object"!==(0,r.Z)(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==(0,r.Z)(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===(0,r.Z)(t)?t:String(t)}},90484:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}n.d(t,{Z:()=>r})},82961:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(50676);function i(e,t){if(e){if("string"===typeof e)return(0,r.Z)(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?(0,r.Z)(e,t):void 0}}},98595:(e,t,n)=>{"use strict";n.d(t,{D:()=>r});const r=e=>e.reduce(((e,t)=>(e[t]=t,e)),Object.create(null))},11642:(e,t,n)=>{"use strict";n.d(t,{Z:()=>S,E:()=>w});var r=n(67643),i=n(83383);function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Set;if(!e)return t;const n=(0,r.dirname)(e);return"."===n?t:(t.add(n),"/"===n?t:o(n,t))}const s=function(e){if(!e||!e.length)return 0;const t=e.map((e=>e.path)).filter((e=>!!e)),n=new Set;return t.forEach((e=>o(e,n))),n.size};var a=n(23596),c=n.n(a),l=n(50464),u=n.n(l),h=n(27889),d=n.n(h),f=n(26723),p=n.n(f),g=n(47652),y=n(24075),m=n(34585);const v=function(e){let{cumulativeSize:t,type:n,size:r,cid:i,name:o,path:s,pinned:a,isParent:c}=e,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/ipfs";return{size:t||r||0,type:"dir"===n?"directory":n,cid:i,name:o||s.split("/").pop()||i.toString(),path:s||"".concat(l,"/").concat(i.toString()),pinned:Boolean(a),isParent:c}},b=async(e,t)=>{const{cumulativeSize:n}=await A(e,t);return n||0},w=e=>e.startsWith("/files")?e.substring(6)||"/":e,E=c()(((e,t)=>t.files.stat(e))),A=async(e,t)=>{const n=t.toString(),r=n.startsWith("/")?n:"/ipfs/".concat(n);try{let t;return t=r.startsWith("/ipfs/")?await E(r,e):await e.files.stat(r),{path:r,...t}}catch(o){var i;const[,,e]=r.split("/");return{path:n,cid:null!==(i=g.k0.asCID(e))&&void 0!==i?i:g.k0.parse(e),type:"unknown",cumulativeSize:0,size:0}}},S=()=>({doPinsFetch:()=>(0,y.fb)(m.aO.PIN_LIST,(async e=>{const t=await u()((e=>d()(async function*(e){yield*e.pin.ls({type:"recursive"}),yield*e.pin.ls({type:"direct"})}(e),(e=>e.cid)))(e));return{pins:t}})),doFilesFetch:()=>async e=>{let{store:t}=e;const n=t.selectIpfsReady(),r=t.selectIpfsConnected(),i=t.selectFilesIsFetching(),o=t.selectFilesPathInfo();n&&r&&!i&&o&&await t.doFetch(o)},doFetch:e=>{let{path:t,realPath:n,isMfs:r,isRoot:i}=e;return(0,y.fb)(m.aO.FETCH,(async(e,o)=>{let{store:s}=o;if(i&&!r)throw new Error("not supposed to be here");const a=n.startsWith("/ipns")?await p()(e.name.resolve(n)):n,c=await A(e,a),l=Date.now();switch(c.type){case"unknown":return{fetched:l,...c};case"file":return{...v({...c,path:t}),fetched:l,type:"file",read:()=>e.cat(c.cid),name:t.split("/").pop(),size:c.size,cid:c.cid};case"directory":return await I(e,c.cid,{path:t,isRoot:i,sorting:s.selectFilesSorting()});default:throw Error('Unsupported file type "'.concat(c.type,'"'))}}))},doFilesWrite:(e,t)=>(0,y.Cs)(m.aO.WRITE,(function(n,i){try{let{store:o}=i;return async function*(){const i=e.filter((e=>!m.wA.includes((0,r.basename)(e.path)))).map((e=>"/"===e.path[0]?{...e,path:e.path.slice(1)}:e)),a=i.reduce(((e,t)=>{let{size:n}=t;return e+n}),0),c=i.map((e=>{let{path:t,size:n}=e;return{path:t,size:n}}));yield{entries:c,progress:0};const{result:l,progress:u}=_(n,i);let h=null;for await(const{name:e,offset:t}of u){h=null==h?{uploaded:0,offset:t,name:e}:e===h.name?{uploaded:h.uploaded,offset:t,name:e}:{uploaded:h.uploaded+h.offset,offset:t,name:e};const n=(h.uploaded+h.offset)/a*100;yield{entries:c,progress:n}}try{const e=await l,o=i.length,a=o+s(i);if(e.length!==a)throw Object.assign(new Error("API returned a partial response."),{code:"ERR_API_RESPONSE"});for(const{path:i,cid:s}of e)if(-1===i.indexOf("/")&&""!==i){const e="/ipfs/".concat(s),o=(0,r.join)(w(t||"/files"),i);try{await n.files.cp(e,o)}catch(d){throw Object.assign(new Error("ipfs.files.cp call failed"),{code:"ERR_FILES_CP_FAILED"})}}return yield{entries:c,progress:100},c}finally{await o.doFilesFetch()}}()}catch(o){return Promise.reject(o)}})),doFilesDelete:e=>{let{files:t,removeLocally:n,removeRemotely:r,remoteServices:i}=e;return(0,y.fb)(m.aO.DELETE,(async(e,o)=>{let{store:s}=o;if((0,y.SY)(s),0===t.length)return;const a=async e=>{try{await e()}catch(t){}};try{await Promise.all(t.map((async t=>e.files.rm(w(t.path),{recursive:!0})))),r&&t.forEach((t=>i.map((async n=>a((()=>e.pin.remote.rm({cid:[t.cid],service:n}))))))),n&&await Promise.all(t.map((async t=>t.pinned&&a((()=>e.pin.rm(t.cid))))));const o=t[0].path,c=o.slice(0,o.lastIndexOf("/"));return void await s.doUpdateHash(c)}finally{await s.doFilesFetch()}}))},doFilesAddPath:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return(0,y.fb)(m.aO.ADD_BY_PATH,(async(i,o)=>{let{store:s}=o;(0,y.SY)(s);const a=w(t).split("/").pop();n||(n=a);const c=w((0,r.join)(e,n)),l=t.startsWith("/")?t:"/ipfs/".concat(a);try{return await i.files.cp(l,c)}finally{await s.doFilesFetch()}}))},doFilesDownloadLink:e=>(0,y.fb)(m.aO.DOWNLOAD_LINK,(async(t,n)=>{let{store:r}=n;const o=r.selectGatewayUrl();return(0,i.cd)(e,o,t)})),doFilesDownloadCarLink:e=>(0,y.fb)(m.aO.DOWNLOAD_LINK,(async(t,n)=>{let{store:r}=n;const o=r.selectGatewayUrl();return(0,i.v_)(e,o,t)})),doFilesShareLink:e=>(0,y.fb)(m.aO.SHARE_LINK,(async(t,n)=>{let{store:r}=n;const o=r.selectPublicGateway();return(0,i.x9)(e,o,t)})),doFilesMove:(e,t)=>(0,y.fb)(m.aO.MOVE,(async(n,r)=>{let{store:i}=r;(0,y.SY)(i);try{await n.files.mv(w(e),w(t));const r=i.selectFiles(),o=r&&r.path;e===o&&await i.doUpdateHash(t)}finally{await i.doFilesFetch()}})),doFilesCopy:(e,t)=>(0,y.fb)(m.aO.COPY,(async(n,r)=>{let{store:i}=r;(0,y.SY)(i);try{await n.files.cp(w(e),w(t))}finally{await i.doFilesFetch()}})),doFilesMakeDir:e=>(0,y.fb)(m.aO.MAKE_DIR,(async(t,n)=>{let{store:r}=n;(0,y.SY)(r);try{await t.files.mkdir(w(e),{parents:!0})}finally{await r.doFilesFetch()}})),doFilesPin:e=>(0,y.fb)(m.aO.PIN_ADD,(async(t,n)=>{let{store:r}=n;try{return await t.pin.add(e)}finally{await r.doPinsFetch()}})),doFilesUnpin:e=>(0,y.fb)(m.aO.PIN_REMOVE,(async(t,n)=>{let{store:r}=n;try{return await t.pin.rm(e)}finally{await r.doPinsFetch()}})),doFilesDismissErrors:()=>(0,y.lW)({type:m.aO.DISMISS_ERRORS}),doFilesNavigateTo:e=>{let{path:t,cid:n}=e;return async e=>{let{store:r}=e;try{const e=t.split("/").map((e=>encodeURIComponent(e))).join("/"),n=r.selectFiles(),i=r.selectFilesPathInfo();n&&n.path===e&&i?await r.doFilesFetch():await r.doUpdateHash(e)}catch(i){console.error(i),r.doUpdateHash("/ipfs/".concat(n))}}},doFilesUpdateSorting:(e,t)=>(0,y.lW)({type:m.aO.UPDATE_SORT,payload:{by:e,asc:t}}),doFilesClear:()=>(0,y.lW)({type:m.aO.CLEAR_ALL}),doFilesSizeGet:()=>(0,y.fb)(m.aO.SIZE_GET,(async e=>({size:await b(e,"/")}))),doGetFileSizeThroughCid:e=>async t=>{const n=t.getIpfs();return b(n,e)}}),_=(e,t)=>{const n=new y.$W,r=u()(e.addAll(t,{pin:!1,wrapWithDirectory:!1,progress:(e,t)=>n.send({offset:e,name:t})}));return r.then((()=>n.close()),(e=>n.close(e))),{result:r,progress:n}},I=async(e,t,n)=>{let{path:i,isRoot:o,sorting:s}=n;const a=await u()(e.ls(t))||[],c=1===a.length&&a[0].cid.toString()===t.toString()?[]:a,l=[];let h=0;for(const u of c){const t=(0,r.join)(i,u.name);let n=null;h<1e3&&("directory"===u.type||"dir"===u.type)?(h+=1,n=v({...await A(e,u.cid),path:t})):n=v({...u,path:t}),l.push(n)}let d=null;if(!o){const t=(0,r.dirname)(i),n=(0,y.Dl)(t,!1);if(n&&(n.isMfs||!n.isRoot)){const t=n.realPath;t&&t.startsWith("/ipns")&&(n.realPath=await p()(e.name.resolve(n.realPath))),d=v({...await A(e,n.realPath),path:n.path,name:"..",isParent:!0})}}return{path:i,fetched:Date.now(),type:"directory",cid:t,upper:d,content:(0,y.hE)(l,s)}}},34585:(e,t,n)=>{"use strict";n.d(t,{FQ:()=>o,LI:()=>a,Mq:()=>r,Ok:()=>l,UL:()=>u,aD:()=>c,aO:()=>i,wA:()=>s});const r=-1!==navigator.userAgent.indexOf("Mac"),i={FETCH:"FILES_FETCH",MOVE:"FILES_MOVE",COPY:"FILES_COPY",DELETE:"FILES_DELETE",MAKE_DIR:"FILES_MAKEDIR",WRITE:"FILES_WRITE",DOWNLOAD_LINK:"FILES_DOWNLOADLINK",SHARE_LINK:"FILES_SHARE_LINK",ADD_BY_PATH:"FILES_ADDBYPATH",PIN_ADD:"FILES_PIN_ADD",PIN_REMOVE:"FILES_PIN_REMOVE",PIN_LIST:"FILES_PIN_LIST",SIZE_GET:"FILES_SIZE_GET",DISMISS_ERRORS:"FILES_DISMISS_ERRORS",CLEAR_ALL:"FILES_CLEAR_ALL",WRITE_UPDATED:"FILES_WRITE_UPDATED",UPDATE_SORT:"FILES_UPDATE_SORT"},o={BY_NAME:"name",BY_SIZE:"size"},s=[".DS_Store","thumbs.db","desktop.ini"],a={pageContent:null,mfsSize:-1,pins:[],sorting:{by:o.BY_NAME,asc:!0},pending:[],finished:[],failed:[]},c={DOWNLOAD_OBJECT_COMMAND:"downloadObjectCommand",REMOVE_FILE_FROM_IPFS:"removeFileFromIpfs",UPDATE_IPFS_CONFIG:"updateIpfsConfig",PIN_OBJECT:"pinObject",RENAME_IPFS_OBJECT:"renameObject",ADD_FILE:"addNewFile",ADD_DIRECTORY:"addNewDirectory",CREATE_NEW_DIRECTORY:"createNewDirectory",FROM_IPFS:"fromIpfs",ADD_NEW_PEER:"addNewPeer",PUBLISH_WITH_IPNS:"publishWithIPNS",DOWNLOAD_CAR_COMMAND:"downloadCarCommand"},l={PIN_OBJECT:"ipfs pin"},u={[c.UPDATE_IPFS_CONFIG]:()=>"ipfs config replace <path-to-settings.json>",[c.REMOVE_FILE_FROM_IPFS]:e=>'ipfs files rm -r "'.concat(e,'"'),[c.DOWNLOAD_OBJECT_COMMAND]:e=>"ipfs get ".concat(e),[c.PIN_OBJECT]:(e,t)=>"".concat(l.PIN_OBJECT," ").concat(t," ").concat(e),[c.RENAME_IPFS_OBJECT]:(e,t)=>{const n=e.replace(t,"").trim();return'ipfs files mv "'.concat(e,'" "').concat(n,'<new-name>"')},[c.ADD_FILE]:e=>'ipfs files cp /ipfs/$(ipfs add -Q <local-file>) "'.concat(e,'/<dest-name>"'),[c.ADD_DIRECTORY]:e=>'ipfs files cp /ipfs/$(ipfs add -r -Q <local-folder>) "'.concat(e,'/<dest-name>"'),[c.CREATE_NEW_DIRECTORY]:e=>'ipfs files mkdir "'.concat(e,'/<folder-name>"'),[c.FROM_IPFS]:e=>'ipfs files cp /ipfs/<cid> "'.concat(e,'/<dest-name>"'),[c.ADD_NEW_PEER]:()=>"ipfs swarm connect <peer-multiaddr>",[c.PUBLISH_WITH_IPNS]:(e,t)=>"ipfs name publish ".concat(e,' --key="').concat(t,'"'),[c.DOWNLOAD_CAR_COMMAND]:e=>"ipfs dag export ".concat(e)}},72126:(e,t,n)=>{"use strict";n.d(t,{aO:()=>i.aO,ZP:()=>l,Ld:()=>c});var r=n(24075),i=n(34585),o=n(99491);const s=()=>({selectFiles:e=>e.files.pageContent,selectCurrentDirectorySize:e=>{var t,n,r;return"directory"===(null===(t=e.files.pageContent)||void 0===t?void 0:t.type)&&(null===(n=e.files.pageContent)||void 0===n||null===(r=n.content)||void 0===r?void 0:r.reduce(((e,t)=>e+t.size),0))},selectPins:e=>e.files.pins,selectFilesSize:e=>e.files.mfsSize,selectFilesIsFetching:e=>e.files.pending.some((e=>e.type===i.aO.FETCH)),selectShowLoadingAnimation:e=>{const t=e.files.pending.find((e=>e.type===i.aO.FETCH));return!!t&&Date.now()-t.start>1e3},selectFilesSorting:e=>e.files.sorting,selectFilesPending:e=>e.files.pending.filter((e=>e.type===i.aO.WRITE&&null!=e.message)),selectFilesFinished:e=>e.files.finished.filter((e=>e.type===i.aO.WRITE)),selectFilesHasError:e=>e.files.failed.length>0,selectFilesErrors:e=>e.files.failed,selectHasUpperDirectory:e=>{var t,n;return"directory"===(null===(t=e.files.pageContent)||void 0===t?void 0:t.type)&&(null===(n=e.files.pageContent)||void 0===n?void 0:n.upper)},selectFilesPathInfo:(0,o.P1)("selectRouteInfo",(e=>(0,r.Dl)(e.url)))});var a=n(11642);const c=i.FQ,l=()=>({name:"files",reducer:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.LI,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case i.aO.DELETE:case i.aO.ADD_BY_PATH:case i.aO.DOWNLOAD_LINK:case i.aO.SHARE_LINK:case i.aO.MOVE:case i.aO.COPY:case i.aO.MAKE_DIR:case i.aO.PIN_ADD:case i.aO.PIN_REMOVE:case i.aO.WRITE:return u(e,t.task,t.type);case i.aO.PIN_LIST:{const{task:n,type:r}=t,i="Exit"===n.status&&n.result.ok?n.result.value.pins.map(String):e.pins;return{...u(e,n,r),pins:i}}case i.aO.FETCH:{const{task:n,type:r}=t,i="Exit"===n.status&&n.result.ok?n.result.value:null,{pageContent:o}=i?{pageContent:i}:e;return{...u(e,n,r),pageContent:o}}case i.aO.DISMISS_ERRORS:return{...e,failed:[]};case i.aO.CLEAR_ALL:return{...e,failed:[],finished:[],pending:[]};case i.aO.UPDATE_SORT:{const{pageContent:n}=e;if(n&&"directory"===n.type){const i=(0,r.hE)(n.content,t.payload);return{...e,pageContent:{...n,content:i},sorting:t.payload}}return e}case i.aO.SIZE_GET:{const{task:n,type:r}=t,i="Exit"===n.status&&n.result.ok?n.result.value.size:e.mfsSize;return{...u(e,n,r),mfsSize:i}}default:return e}},...(0,a.Z)(),...s()}),u=(e,t,n)=>{switch(t.status){case"Init":return{...e,pending:[...e.pending,{...t,type:n,status:"Pending",start:Date.now()}]};case"Send":{const{pending:n,rest:r}=h(e.pending,t);return{...e,pending:[...r,{...n,...t,status:"Pending"}]}}case"Exit":{const{pending:n,rest:r}=h(e.pending,t);return t.result.ok?{...e,pending:r,finished:[...e.finished,{...n,...t,end:Date.now(),value:t.result.value,status:"Done"}]}:{...e,pending:r,failed:[...e.failed,{...n,...t,end:Date.now(),error:t.result.error,status:"Failed"}]}}default:return console.error("Task has an invalid state",t),e}},h=(e,t)=>{const{id:n}=t,r=e.find((e=>e.id===n));if(null==r)throw Error("Unable to find a pending task");return{pending:r,rest:e.filter((e=>e.id!==n))}}},24075:(e,t,n)=>{"use strict";n.d(t,{$W:()=>h,Cs:()=>s,Dl:()=>u,SY:()=>d,fb:()=>a,hE:()=>l,lW:()=>c});var r=n(22956),i=n(34585),o=n(89849);const s=function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];let[s]=r;return async n=>{const r=n.getIpfs();if(null==r)throw Error("IPFS node was not found");{const i=o.C(e,(async function*(e){const n=t(r,e);for(;;){const e=await n.next();if(e.done)return await e.value;yield e.value}}),s);return await i(n)}}},a=function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];let[s]=r;return async n=>{const r=n.getIpfs();if(null==r)throw Error("IPFS node was not found");{const i=o.f(e,(e=>t(r,e)),s);return await i(n)}}},c=e=>async t=>{let{store:n}=t;n.dispatch(e)},l=(e,t)=>{const n=t.asc?1:-1,o=(0,r.m2)(n),s=(0,r.dO)(n);return e.sort(((e,n)=>e.type===n.type||i.Mq?t.by===i.FQ.BY_NAME?o(e.name,n.name):s(e.cumulativeSize||e.size,n.cumulativeSize||n.size):"directory"===e.type?-1:1))},u=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n={path:e,realPath:"",isMfs:!1,isRoot:!1};if(n.path.startsWith("/ipns")||n.path.startsWith("/ipfs"))n.realPath=n.path,n.isRoot="/ipns"===n.path||"/ipfs"===n.path;else{if(!n.path.startsWith("/files"))return;r="/files",n.realPath=n.path.substring(r.length).trim()||"/",n.isRoot="/"===n.realPath,n.isMfs=!0}var r;return n.path.endsWith("/")&&"/"!==n.realPath&&(n.path=n.path.substring(0,n.path.length-1),n.realPath=n.realPath.substring(0,n.realPath.length-1)),t&&(n.realPath=decodeURIComponent(n.realPath),n.path=decodeURIComponent(n.path)),n};class h{constructor(){this.done=!1,this.queue=[],this.pending=[]}[Symbol.asyncIterator](){return this}async next(){const{done:e,queue:t,pending:n}=this;if(e)return{done:e,value:void 0};if(t.length>0){const n=t[t.length-1];return t.pop(),{done:e,value:n}}return await new Promise(((e,t)=>{n.unshift({resolve:e,reject:t})}))}send(e){const{done:t,pending:n,queue:r}=this;if(t)throw Error("Channel is closed");if(n.length){const r=n[n.length-1];n.pop(),r.resolve({done:t,value:e})}else r.unshift(e)}close(e){const{done:t,pending:n}=this;if(t)throw Error("Channel is already closed");this.done=!0;for(const r of n)e?r.reject(e):r.resolve({done:!0,value:void 0});n.length=0}}const d=e=>{const t=e.selectFilesPathInfo();if(!t||!t.isMfs)throw new Error("Unable to perform task if not in MFS")}},72672:(e,t,n)=>{"use strict";n.d(t,{Dp:()=>a,KG:()=>i,Rf:()=>s,ZP:()=>l});var r=n(11044);const i="https://ipfs.io",o=[{id:"IMG_HASH_1PX",name:"1x1.png",hash:"bafybeibwzifw52ttrkqlikfzext5akxu7lz4xiwjgwzmqcpdzmp3n5vnbe"},{id:"IMG_HASH_1PXID",name:"1x1.png",hash:"bafkqax4jkbheodikdifaaaaabveuqrcsaaaaaaiaaaaacaidaaaaajo3k3faaaaaanieyvcfaaaabj32hxnaaaaaaf2fetstabaonwdgaaaaacsjiravicgxmnqaaaaaaiaadyrbxqzqaaaaabeuktsevzbgbaq"},{id:"IMG_HASH_FAVICON",name:"favicon.ico",hash:"bafkreihc7efnl2prri6j6krcopelxms3xsh7undpsjqbfsasm7ikiyha4i"}],s=e=>{let t;try{t=new URL(e)}catch(n){return!1}return"http:"===t.protocol||"https:"===t.protocol},a=e=>{const t=new URL(e);return Promise.any(o.map((e=>{const n=new URL("".concat(t.protocol,"//").concat(t.hostname,"/ipfs/").concat(e.hash,"?now=").concat(Date.now(),"&filename=").concat(e.name,"#x-ipfs-companion-no-redirect"));return c(n)})))},c=e=>new Promise(((t,n)=>{const r=()=>!!i&&(clearTimeout(i),i=null,!0);let i=setTimeout((()=>{r()&&n(new Error)}),15e3);const o=new Image;o.onerror=()=>{r(),n(new Error)},o.onload=()=>{r(),t()},o.src=e})),l={name:"gateway",reducer:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{availableGateway:null,publicGateway:(0,r.g)("ipfsPublicGateway")||i},t=arguments.length>1?arguments[1]:void 0;return"SET_AVAILABLE_GATEWAY"===t.type?{...e,availableGateway:t.payload}:"SET_PUBLIC_GATEWAY"===t.type?{...e,publicGateway:t.payload}:e},doSetAvailableGateway:e=>t=>{let{dispatch:n}=t;return n({type:"SET_AVAILABLE_GATEWAY",payload:e})},doUpdatePublicGateway:e=>async t=>{let{dispatch:n}=t;await(0,r.D)("ipfsPublicGateway",e),n({type:"SET_PUBLIC_GATEWAY",payload:e})},selectAvailableGateway:e=>{var t;return null===e||void 0===e||null===(t=e.gateway)||void 0===t?void 0:t.availableGateway},selectPublicGateway:e=>{var t;return null===e||void 0===e||null===(t=e.gateway)||void 0===t?void 0:t.publicGateway}}},4046:(e,t,n)=>{"use strict";n.d(t,{VI:()=>p,ZP:()=>_,aO:()=>d});var r=n(95321),i=n(33006),o=n(84744),s=n.n(o),a=n(26723),c=n.n(a),l=n(98595),u=n(89849),h=n(11044);const d=l.D(["IPFS_INIT","IPFS_STOPPED","IPFS_API_ADDRESS_UPDATED","IPFS_API_ADDRESS_PENDING_FIRST_CONNECTION","IPFS_API_ADDRESS_INVALID","IPFS_API_ADDRESS_INVALID_DISMISS","IPFS_CONNECT_FAILED","IPFS_CONNECT_SUCCEED","NOTIFY_DISMISSED"]),f=()=>{const e=(0,h.g)("ipfsApi");return null==e?null:g(e)},p=e=>null!=g(e),g=e=>v(e)||m(e)||y(e),y=e=>{try{return new URL(e).toString()}catch(t){return null}},m=e=>{if(null!=e&&""!==e)try{return(0,r.HM)(e).toString()}catch(t){}return null},v=e=>"string"===typeof e?b(e):w(e),b=e=>{try{return w(JSON.parse(e))}catch(t){}try{const t=new URL(e),{username:n,password:r}=t;if(n&&r)return t.username=t.password="",{url:t.toString(),headers:{authorization:"Basic ".concat(btoa(n+":"+r))}}}catch(t){}return null},w=e=>e&&(e.url||e.host||e.apiPath||e.protocol||e.port||e.headers)?e:null;let E=null;const A={getIpfs:()=>E},S={doTryInitIpfs:()=>async e=>{let{store:t}=e;try{return await t.doInitIpfs(),!0}catch(n){return!1}},doInitIpfs:()=>(0,u.f)("IPFS_INIT",(async e=>{const{apiAddress:t}=e.getState().ipfs;let r={};const{create:o}=await Promise.all([n.e(259),n.e(40),n.e(104)]).then(n.bind(n,95040));r="string"===typeof t?{...r,url:t}:{...t,...r};const s=await(0,i.getIpfs)({connectionTest:async e=>{try{await c()(e.stats.bw())}catch(t){const e=t,n=e.toString()||e.message||e;if(!/bandwidth reporter disabled in config/.test(n))throw t}return!0},loadHttpClientModule:()=>o,providers:[i.providers.httpClient(r)]});if(s)return s;throw Error("Could not connect to the IPFS API (".concat(t,")"))})),doStopIpfs:()=>async e=>{E&&(await E.stop(),e.dispatch({type:"IPFS_STOPPED"}))},doUpdateIpfsApiAddress:e=>async t=>{const n=g(e);if(null==n)return t.dispatch({type:d.IPFS_API_ADDRESS_INVALID}),!1;{await(0,h.D)("ipfsApi",n),t.dispatch({type:d.IPFS_API_ADDRESS_UPDATED,payload:n}),t.dispatch({type:d.IPFS_API_ADDRESS_PENDING_FIRST_CONNECTION,pending:!0}),t.dispatch({type:d.IPFS_STOPPED}),t.dispatch({type:d.NOTIFY_DISMISSED});const e=await t.store.doTryInitIpfs();return e?t.dispatch({type:d.IPFS_CONNECT_SUCCEED}):t.dispatch({type:d.IPFS_CONNECT_FAILED}),t.dispatch({type:d.IPFS_API_ADDRESS_PENDING_FIRST_CONNECTION,pending:!1}),e}},doDismissIpfsInvalidAddress:()=>e=>{e.dispatch({type:"IPFS_API_ADDRESS_INVALID_DISMISS"})},doGetPathInfo:e=>async()=>{if(E)return await E.files.stat(e);throw Error("IPFS is not initialized")},doCheckIfPinned:e=>async()=>{if(null==E)return!1;try{return!!await s()(E.pin.ls({paths:[e],type:"recursive"}))}catch(t){return!1}}},_={name:"ipfs",reducer:(e,t)=>((e,t)=>{switch(t.type){case d.IPFS_INIT:{const{task:n}=t;switch(n.status){case"Init":return{...e,ready:!1};case"Exit":{const{result:t}=n;if(t.ok){const{provider:n,apiAddress:r,ipfs:i}=t.value;return E=i,{...e,ready:!0,failed:!1,provider:n,apiAddress:r||e.apiAddress}}return{...e,ready:!1,failed:!0}}default:return e}}case d.IPFS_STOPPED:return{...e,ready:!1,failed:!1};case d.IPFS_API_ADDRESS_UPDATED:return{...e,apiAddress:t.payload,invalidAddress:!1};case d.IPFS_API_ADDRESS_INVALID:case d.IPFS_API_ADDRESS_INVALID_DISMISS:return{...e,invalidAddress:!0};case d.IPFS_API_ADDRESS_PENDING_FIRST_CONNECTION:{const{pending:n}=t;return{...e,pendingFirstConnection:n}}case d.IPFS_CONNECT_SUCCEED:return{...e,failed:!1};case d.IPFS_CONNECT_FAILED:return{...e,failed:!0};default:return e}})(null==e?{apiAddress:f(),provider:null,failed:!1,ready:!1,invalidAddress:!1,pendingFirstConnection:!1}:e,t),getExtraArgs:()=>A,selectIpfsReady:e=>e.ipfs.ready,selectIpfsProvider:e=>e.ipfs.provider,selectIpfsApiAddress:e=>e.ipfs.apiAddress,selectIpfsInvalidAddress:e=>e.ipfs.invalidAddress,selectIpfsInitFailed:e=>e.ipfs.failed,selectIpfsPendingFirstConnection:e=>e.ipfs.pendingFirstConnection,...S}},11044:(e,t,n)=>{"use strict";n.d(t,{D:()=>i,g:()=>r});const r=e=>{let t=null;if(window.localStorage){try{t=window.localStorage.getItem(e)}catch(n){console.error("Error reading '".concat(e,"' value from localStorage"),n)}try{return JSON.parse(t||"")}catch(r){return t}}return t},i=(e,t)=>{try{window.localStorage.setItem(e,JSON.stringify(t))}catch(n){console.error("Error writing '".concat(e,"' value to localStorage"),n)}}},89849:(e,t,n)=>{"use strict";n.d(t,{C:()=>i,f:()=>r});const r=function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];let[s]=r;return i(e,(async function*(e){return await t(e)}),s)},i=function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];let[o]=r;return async n=>{const r=Symbol(e),i=performance.now();try{n.dispatch({type:e,task:{id:r,status:"Init",init:o}});const s=t(n);for(;;){const t=await s.next();if(t.done){const{value:o}=t;return n.dispatch({type:e,task:{id:r,status:"Exit",duration:performance.now()-i,result:{ok:!0,value:o}}}),o}{const{value:i}=t;n.dispatch({type:e,task:{id:r,status:"Send",message:i}})}}}catch(s){const t=s;throw n.dispatch({type:e,task:{id:r,status:"Exit",duration:performance.now()-i,result:{ok:!1,error:t}}}),t}}}},43697:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var r=n(72791),i=n(87945),o=n(218),s=n(14849),a=n(25222);const c=e=>{let{url:t,method:n="GET"}=e;return r.createElement("pre",{className:"overflow-x-scroll pa3 mr3 f6 ba b--black-10 br2 bg-snow-muted"},r.createElement("code",{className:"green"},n)," ",t)},l=e=>{let{url:t}=e;if(!t)return null;const n=[...new URL(t).searchParams];return r.createElement("dl",{className:"pa3 mr3 f7 overflow-x-scroll monospace nowrap ba b--black-10 br2 bg-snow-muted"},n.map((e=>{let[t,n]=e;return r.createElement("div",{key:"QueryParams-".concat(t)},r.createElement("dt",{className:"dib green"},t,":"),r.createElement("dd",{className:"dib ml1"},n))})))},u=e=>{let{children:t,onChange:n,enabled:i,label:o,summary:a,exampleRequest:u,queryParams:h,sourceLink:d,sourceLinkLabel:f="view source"}=e;const[p,g]=(0,r.useState)(!1);return r.createElement("section",{className:"bg-white bb b--black-10"},r.createElement("div",{className:"flex items-center"},r.createElement(s.Z,{className:"pv3 pl3 pr1 bg-white flex-none",onChange:n,checked:i,label:r.createElement("span",{className:"fw5 f6"},o)}),r.createElement("div",{className:"truncate fw4 f6 flex-auto charcoal-muted"},"\u2013 ",a),r.createElement("button",{className:"focus-outline bg-transparent pa3 bn link blue flex-none",onClick:()=>g(!p),style:{minWidth:100}},p?"Close":"Show me")),p&&r.createElement("div",{className:"ph3 nt2 pb3"},t,d&&r.createElement("p",null,r.createElement("a",{href:d,className:"link blue",target:"_blank",rel:"noopener noreferrer"},"View source")),u&&r.createElement("div",null,r.createElement("h3",{className:"f5 fw6"},"Example request"),r.createElement(c,{url:u}),r.createElement("h4",{className:"f6 fw5"},"Query parameters"),r.createElement(l,{url:u}))))},h=(0,o.$)("selectAnalyticsEnabled","selectAnalyticsConsent","selectAnalyticsActionsToRecord","doToggleAnalytics","doToggleConsent",(e=>{let{analyticsActionsToRecord:t,analyticsConsent:n,doToggleConsent:o,doToggleAnalytics:c,analyticsEnabled:l,t:h,open:d}=e;return r.createElement(r.Fragment,null,r.createElement(s.Z,{className:"dib",onChange:c,checked:l,label:r.createElement("span",{className:"f5"},h("AnalyticsToggle.label"))}),r.createElement("div",{className:"f6 charcoal lh-copy"},r.createElement("p",{className:"mb0"},h("AnalyticsToggle.paragraph1")),r.createElement(a.Z,{summaryText:h("AnalyticsToggle.summary"),className:"pt2",open:d},r.createElement("p",null,r.createElement(i.cC,{i18nKey:"AnalyticsToggle.paragraph2",t:h},"Protocol Labs hosts a ",r.createElement("a",{className:"link blue",href:"https://count.ly/"},"Countly")," instance to record anonymous usage data for this app.")),r.createElement("p",null,h("AnalyticsToggle.optionalInfo")),r.createElement(u,{onChange:()=>o("sessions"),enabled:n.includes("sessions"),label:h("AnalyticsToggle.sessions.label"),summary:h("AnalyticsToggle.sessions.summary"),sourceLink:"https://github.com/Countly/countly-sdk-web/blob/93442edbe8c108618c88cc9e1ad179892c42940b/lib/countly.js#L1885-L1953",exampleRequest:"https://countly.ipfs.io/i?begin_session=1&metrics=%7B%22_app_version%22%3A%222.4.0%22%2C%22_ua%22%3A%22Mozilla%2F5.0%20(Macintosh%3B%20Intel%20Mac%20OS%20X%2010_14_2)%20AppleWebKit%2F537.36%20(KHTML%2C%20like%20Gecko)%20Chrome%2F72.0.3626.121%20Safari%2F537.36%22%2C%22_resolution%22%3A%221920x1080%22%2C%22_density%22%3A2%2C%22_locale%22%3A%22en-GB%22%7D&app_key=700fd825c3b257e021bd9dbc6cbf044d33477531&device_id=804117b1-c21d-4e55-a65f-f9dbbe9a1f91&sdk_name=javascript_native_web&sdk_version=19.02.1&timestamp=1552296210554&hour=9&dow=1&consent=%7B%22sessions%22%3Atrue%2C%22events%22%3Atrue%2C%22views%22%3Atrue%2C%22location%22%3Atrue%2C%22crashes%22%3Atrue%7D"},r.createElement(i.cC,{i18nKey:"AnalyticsToggle.sessions.details",t:h},r.createElement("p",null,"The following browser metrics are sent"),r.createElement("ul",null,r.createElement("li",null,"A random, generated device ID"),r.createElement("li",null,"Timestamp when the session starts"),r.createElement("li",null,"Periodic timestamps to track duration"),r.createElement("li",null,'App version e.g. "2.4.4"'),r.createElement("li",null,'Locale e.g. "en-GB"'),r.createElement("li",null,'User Agent e.g. "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_2) ..."'),r.createElement("li",null,'Screen resolution e.g. "800x600"'),r.createElement("li",null,'Screen pixel density e.g. "1"')))),r.createElement(u,{onChange:()=>o("events"),enabled:n.includes("events"),label:h("AnalyticsToggle.events.label"),summary:h("AnalyticsToggle.events.summary"),sourceLink:"https://github.com/ipfs-shipyard/ipfs-webui/blob/30a077efe5198bf6403681b094ab585a88395c40/src/bundles/analytics.js#L93-L111",exampleRequest:"https://countly.ipfs.io/i?events=%5B%7B%22key%22%3A%22FILES_MAKEDIR%22%2C%22count%22%3A1%2C%22dur%22%3A0.015194999985396862%2C%22timestamp%22%3A1552296333639%2C%22hour%22%3A9%2C%22dow%22%3A1%7D%5D&app_key=700fd825c3b257e021bd9dbc6cbf044d33477531&device_id=804117b1-c21d-4e55-a65f-f9dbbe9a1f91&sdk_name=javascript_native_web&sdk_version=19.02.1&timestamp=1552296333640&hour=9&dow=1"},r.createElement("p",null,r.createElement(i.cC,{i18nKey:"AnalyticsToggle.events.details",t:h},"App specific actions. We record only that the action happened, how long it took from start to finish, and a count if the event involved multiple items.")),r.createElement("p",null,"The recorded actions are:"),r.createElement("ul",null,t.map((e=>r.createElement("li",{key:e,className:"mb1"},r.createElement("code",{className:"f7 bg-snow-muted pa1 br2"},e)))))),r.createElement(u,{onChange:()=>o("views"),enabled:n.includes("views"),label:h("AnalyticsToggle.views.label"),summary:h("AnalyticsToggle.views.summary"),sourceLink:"https://github.com/ipfs-shipyard/ipfs-webui/blob/2fb9df4e7b294f26b35b1dd76084fe85672b6f2b/src/bundles/analytics.js#L81-L86",exampleRequest:"https://countly.ipfs.io/i?events=%5B%7B%22key%22%3A%22%5BCLY%5D_view%22%2C%22count%22%3A1%2C%22dur%22%3A2%2C%22segmentation%22%3A%7B%22name%22%3A%22%2F%22%7D%2C%22timestamp%22%3A1552296364914%2C%22hour%22%3A9%2C%22dow%22%3A1%7D%2C%7B%22key%22%3A%22%5BCLY%5D_view%22%2C%22count%22%3A1%2C%22segmentation%22%3A%7B%22name%22%3A%22%2Ffiles*%22%2C%22visit%22%3A1%2C%22domain%22%3A%22localhost%22%2C%22view%22%3A%22%2F%22%7D%2C%22timestamp%22%3A1552296364915%2C%22hour%22%3A9%2C%22dow%22%3A1%7D%5D&app_key=700fd825c3b257e021bd9dbc6cbf044d33477531&device_id=804117b1-c21d-4e55-a65f-f9dbbe9a1f91&sdk_name=javascript_native_web&sdk_version=19.02.1&timestamp=1552296364916&hour=9&dow=1"},r.createElement("p",null,h("AnalyticsToggle.views.details"))),r.createElement(u,{onChange:()=>o("location"),enabled:n.includes("location"),label:h("AnalyticsToggle.location.label"),summary:h("AnalyticsToggle.location.summary"),sourceLink:"https://github.com/Countly/countly-sdk-web/blob/93442edbe8c108618c88cc9e1ad179892c42940b/lib/countly.js#L1736-L1751"},r.createElement("p",null,h("AnalyticsToggle.location.details"))),r.createElement(u,{onChange:()=>o("crashes"),enabled:n.includes("crashes"),label:h("AnalyticsToggle.crashes.label"),summary:h("AnalyticsToggle.crashes.summary"),sourceLink:"https://github.com/ipfs-shipyard/ipfs-webui/blob/2fb9df4e7b294f26b35b1dd76084fe85672b6f2b/src/bundles/analytics.js#L115-L121",exampleRequest:"https://countly.ipfs.io/i?crash=%7B%22_resolution%22%3A%221920x1080%22%2C%22_error%22%3A%22Error%3A%20example%20error%5Cn%20%20%20%20at%20Object._callee%24%20(http%3A%2F%2Flocalhost%3A3000%2Fstatic%2Fjs%2Fbundle.js%3A192105%3A63)%5Cn%20%20%20%20at%20tryCatch%20(http%3A%2F%2Flocalhost%3A3000%2Fstatic%2Fjs%2Fbundle.js%3A173974%3A40)%5Cn%20%20%20%20at%20Generator.invoke%20%5Bas%20_invoke%5D%20(http%3A%2F%2Flocalhost%3A3000%2Fstatic%2Fjs%2Fbundle.js%3A174208%3A22)%5Cn%20%20%20%20at%20Generator.prototype.(anonymous%20function)%20%5Bas%20next%5D%20(http%3A%2F%2Flocalhost%3A3000%2Fstatic%2Fjs%2Fbundle.js%3A174026%3A21)%5Cn%20%20%20%20at%20step%20(http%3A%2F%2Flocalhost%3A3000%2Fstatic%2Fjs%2Fbundle.js%3A192086%3A191)%5Cn%20%20%20%20at%20http%3A%2F%2Flocalhost%3A3000%2Fstatic%2Fjs%2Fbundle.js%3A192086%3A361%22%2C%22_app_version%22%3A%222.4.0%22%2C%22_run%22%3A5%2C%22_not_os_specific%22%3Atrue%2C%22_online%22%3Atrue%2C%22_background%22%3Atrue%2C%22_logs%22%3A%22STATS_FETCH_FAILED%22%2C%22_nonfatal%22%3Atrue%2C%22_view%22%3A%22%2F%23%2Fsettings%22%2C%22_custom%22%3Anull%2C%22_opengl%22%3A%22WebGL%201.0%20(OpenGL%20ES%202.0%20Chromium)%22%7D&app_key=700fd825c3b257e021bd9dbc6cbf044d33477531&device_id=d96d67ff-4797-45da-83b4-9e8f599cd12a&sdk_name=javascript_native_web&sdk_version=19.02.1&timestamp=1552294449012&hour=8&dow=1"},r.createElement("p",null,r.createElement(i.cC,{i18nKey:"AnalyticsToggle.crashes.details",t:h},"Records JavaScript error messages and stack traces that occur while using the app, where possible. It is very helpful to know when the app is not working for you, but ",r.createElement("b",null,"error messages may include identifiable information")," like CIDs or file paths, so only enable this if you are comfortable sharing that information with us."))))))}))},84855:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(72791),i=n(30178);const o=e=>{let{className:t="pa4",style:n,children:o,...s}=e;return r.createElement("section",{className:t,style:{background:"#fbfbfb",...n}},r.createElement(i.Z,null,o))}},53350:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var r=n(72791),i=n(81694),o=n.n(i);function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s.apply(this,arguments)}const a=(e,t)=>{let{fill:n,bg:r,color:i,danger:o,disabled:s}=e;return o?"bg-red fill-white white":s?"bg-gray-muted fill-snow light-gray":"link"===t?"link bg-transparent":"".concat(n," ").concat(r," ").concat(i)},c=e=>{let{className:t,minWidth:n,children:i,style:c,type:l,danger:u,...h}=e;return r.createElement("button",s({type:l,className:o()("Button transition-all sans-serif dib v-mid fw5 nowrap lh-copy bn br1 pa2 focus-outline",t,a(h,l)),disabled:h.disabled,style:{minWidth:n,...c}},h),i)};c.defaultProps={bg:"bg-teal",color:"white",fill:"white",className:"",minWidth:140};const l=c},14849:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var r=n(72791),i=n(59356);function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o.apply(this,arguments)}const s=e=>{let{className:t,label:n,disabled:s,checked:a,onChange:c,...l}=e;t="Checkbox dib sans-serif ".concat(t),s||(t+=" pointer");return r.createElement("label",o({className:t},l),r.createElement("input",{className:"absolute",type:"checkbox",checked:a,disabled:s,onChange:e=>{c(e.target.checked)}}),r.createElement("span",{className:"dib v-mid br1 w1 h1 pointer"},r.createElement(i.Z,{className:"w1 h1 o-0 fill-aqua",viewBox:"25 25 50 50"})),r.createElement("span",{className:"v-mid pl2"},n))};s.defaultProps={className:"",label:"",disabled:!1,checked:null,onChange:()=>{}};const a=s},25222:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(72791);n(61713);const i=e=>{let{summaryText:t="Advanced",children:n,onClick:i,...o}=e;return r.createElement("details",o,r.createElement("summary",{className:"pointer blue outline-0",onClick:i},t),n)}},30178:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var r=n(72791),i=n(83072),o=n(15560),s=n.n(o);function a(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class c extends r.Component{constructor(){super(...arguments),a(this,"state",{hasError:!1})}componentDidCatch(e,t){this.setState({hasError:!0}),console.log(e),s()&&s().Countly&&s().Countly.q.push(["log_error"],e)}render(){const{hasError:e}=this.state,{children:t,fallback:n}=this.props;return e?r.createElement(n,null):t}}a(c,"defaultProps",{fallback:i.Z});const l=c},76290:(e,t,n)=>{"use strict";n.d(t,{Q:()=>r,X:()=>i});const r="https://ipfs-shipyard.github.io/pinning-service-compliance",i=[{name:"Pinata",icon:"https://dweb.link/ipfs/QmVYXV4urQNDzZpddW4zZ9PGvcAbF38BnKWSgch3aNeViW?filename=pinata.svg",apiEndpoint:"https://api.pinata.cloud/psa",visitServiceUrl:"https://docs.pinata.cloud/api-reference/pinning-service-api"},{name:"Filebase",icon:"https://dweb.link/ipfs/QmWBaeu6y1zEcKbsEqCuhuDHPL3W8pZouCPdafMCRCSUWk?filename=filebase.png",apiEndpoint:"https://api.filebase.io/v1/ipfs",visitServiceUrl:"https://docs.filebase.com/api-documentation/ipfs-pinning-service-api"},{name:"Web3.Storage",icon:"https://dweb.link/ipfs/bafybeiaqsdwuwemchbofzok4cq7cuvotfs6bgickxdqr6f7hdt7a64cwwa/Web3.Storage-logo.svg",apiEndpoint:"https://api.web3.storage",visitServiceUrl:"https://web3.storage/docs/how-tos/pinning-services-api/"},{name:"4EVERLAND",icon:"https://dweb.link/ipfs/bafkreie4mg2rmoe6fzct4rpwd2d4nuok3yx2mew567nu3s5bfnnmlb65ei?filename=4everland-logo.svg",apiEndpoint:"https://api.4everland.dev",visitServiceUrl:"https://docs.4everland.org/storage/4ever-pin/pinning-services-api"},{name:"Scaleway",icon:"https://dweb.link/ipfs/QmTM7RtYsuJFoV7y3Ec1WdGTW8knKrjwbY6ByTGsJN6TYw?filename=scaleway.svg",apiEndpoint:"https://<your-volume-region-code>.ipfs.labs.scw.cloud/<your-volume-id>/",visitServiceUrl:"https://www.scaleway.com/en/docs/labs/ipfs-pinning/reference-content/install-ipfs-desktop/"}].map((e=>{try{const t=new URL(e.apiEndpoint).hostname;e.complianceReportUrl="".concat(r,"/").concat(t,".html")}catch(t){}return{service:e,sort:Math.random()}})).sort(((e,t)=>e.sort-t.sort)).map((e=>{let{service:t}=e;return t}))},70814:(e,t,n)=>{"use strict";n.d(t,{_:()=>r});const r=e=>({back:e("tour.back"),close:e("tour.close"),last:e("tour.last"),next:e("tour.next"),skip:e("tour.skip")})},32821:(e,t,n)=>{"use strict";n.d(t,{Z:()=>Jn,H:()=>Yn});var r=n(90484),i=n(6610),o=n(5991),s=n(63349),a=n(10379),c=n(46070),l=n(77608),u=n(96156),h=n(59968),d=n(96410),f=n(82961),p=n(28970);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m={type:"logger",log:function(e){this.output("log",e)},warn:function(e){this.output("warn",e)},error:function(e){this.output("error",e)},output:function(e,t){console&&console[e]&&console[e].apply(console,t)}},v=new(function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,i.Z)(this,e),this.init(t,n)}return(0,o.Z)(e,[{key:"init",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.prefix=t.prefix||"i18next:",this.logger=e||m,this.options=t,this.debug=t.debug}},{key:"setDebug",value:function(e){this.debug=e}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"log","",!0)}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"warn","",!0)}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"error","")}},{key:"deprecate",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}},{key:"forward",value:function(e,t,n,r){return r&&!this.debug?null:("string"===typeof e[0]&&(e[0]="".concat(n).concat(this.prefix," ").concat(e[0])),this.logger[t](e))}},{key:"create",value:function(t){return new e(this.logger,y(y({},{prefix:"".concat(this.prefix,":").concat(t,":")}),this.options))}},{key:"clone",value:function(t){return(t=t||this.options).prefix=t.prefix||this.prefix,new e(this.logger,t)}}]),e}()),b=function(){function e(){(0,i.Z)(this,e),this.observers={}}return(0,o.Z)(e,[{key:"on",value:function(e,t){var n=this;return e.split(" ").forEach((function(e){n.observers[e]=n.observers[e]||[],n.observers[e].push(t)})),this}},{key:"off",value:function(e,t){this.observers[e]&&(t?this.observers[e]=this.observers[e].filter((function(e){return e!==t})):delete this.observers[e])}},{key:"emit",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.observers[e]&&[].concat(this.observers[e]).forEach((function(e){e.apply(void 0,n)}));this.observers["*"]&&[].concat(this.observers["*"]).forEach((function(t){t.apply(t,[e].concat(n))}))}}]),e}();function w(){var e,t,n=new Promise((function(n,r){e=n,t=r}));return n.resolve=e,n.reject=t,n}function E(e){return null==e?"":""+e}function A(e,t,n){function r(e){return e&&e.indexOf("###")>-1?e.replace(/###/g,"."):e}function i(){return!e||"string"===typeof e}for(var o="string"!==typeof t?[].concat(t):t.split(".");o.length>1;){if(i())return{};var s=r(o.shift());!e[s]&&n&&(e[s]=new n),e=Object.prototype.hasOwnProperty.call(e,s)?e[s]:{}}return i()?{}:{obj:e,k:r(o.shift())}}function S(e,t,n){var r=A(e,t,Object);r.obj[r.k]=n}function _(e,t){var n=A(e,t),r=n.obj,i=n.k;if(r)return r[i]}function I(e,t,n){var r=_(e,n);return void 0!==r?r:_(t,n)}function C(e,t,n){for(var r in t)"__proto__"!==r&&"constructor"!==r&&(r in e?"string"===typeof e[r]||e[r]instanceof String||"string"===typeof t[r]||t[r]instanceof String?n&&(e[r]=t[r]):C(e[r],t[r],n):e[r]=t[r]);return e}function T(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var k={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function R(e){return"string"===typeof e?e.replace(/[&<>"'\/]/g,(function(e){return k[e]})):e}var x="undefined"!==typeof window&&window.navigator&&"undefined"===typeof window.navigator.userAgentData&&window.navigator.userAgent&&window.navigator.userAgent.indexOf("MSIE")>-1,P=[" ",",","?","!",";"];function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function N(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,c.Z)(this,n)}}function B(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";if(e){if(e[t])return e[t];for(var r=t.split(n),i=e,o=0;o<r.length;++o){if(!i)return;if("string"===typeof i[r[o]]&&o+1<r.length)return;if(void 0===i[r[o]]){for(var s=2,a=r.slice(o,o+s).join(n),c=i[a];void 0===c&&r.length>o+s;)s++,c=i[a=r.slice(o,o+s).join(n)];if(void 0===c)return;if(null===c)return null;if(t.endsWith(a)){if("string"===typeof c)return c;if(a&&"string"===typeof c[a])return c[a]}var l=r.slice(o+s).join(n);return l?B(c,l,n):void 0}i=i[r[o]]}return i}}var L=function(e){(0,a.Z)(n,e);var t=N(n);function n(e){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ns:["translation"],defaultNS:"translation"};return(0,i.Z)(this,n),r=t.call(this),x&&b.call((0,s.Z)(r)),r.data=e||{},r.options=o,void 0===r.options.keySeparator&&(r.options.keySeparator="."),void 0===r.options.ignoreJSONStructure&&(r.options.ignoreJSONStructure=!0),r}return(0,o.Z)(n,[{key:"addNamespaces",value:function(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}},{key:"removeNamespaces",value:function(e){var t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}},{key:"getResource",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=void 0!==r.keySeparator?r.keySeparator:this.options.keySeparator,o=void 0!==r.ignoreJSONStructure?r.ignoreJSONStructure:this.options.ignoreJSONStructure,s=[e,t];n&&"string"!==typeof n&&(s=s.concat(n)),n&&"string"===typeof n&&(s=s.concat(i?n.split(i):n)),e.indexOf(".")>-1&&(s=e.split("."));var a=_(this.data,s);return a||!o||"string"!==typeof n?a:B(this.data&&this.data[e]&&this.data[e][t],n,i)}},{key:"addResource",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{silent:!1},o=this.options.keySeparator;void 0===o&&(o=".");var s=[e,t];n&&(s=s.concat(o?n.split(o):n)),e.indexOf(".")>-1&&(r=t,t=(s=e.split("."))[1]),this.addNamespaces(t),S(this.data,s,r),i.silent||this.emit("added",e,t,n,r)}},{key:"addResources",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{silent:!1};for(var i in n)"string"!==typeof n[i]&&"[object Array]"!==Object.prototype.toString.apply(n[i])||this.addResource(e,t,i,n[i],{silent:!0});r.silent||this.emit("added",e,t,n)}},{key:"addResourceBundle",value:function(e,t,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{silent:!1},s=[e,t];e.indexOf(".")>-1&&(r=n,n=t,t=(s=e.split("."))[1]),this.addNamespaces(t);var a=_(this.data,s)||{};r?C(a,n,i):a=O(O({},a),n),S(this.data,s,a),o.silent||this.emit("added",e,t,n)}},{key:"removeResourceBundle",value:function(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}},{key:"hasResourceBundle",value:function(e,t){return void 0!==this.getResource(e,t)}},{key:"getResourceBundle",value:function(e,t){return t||(t=this.options.defaultNS),"v1"===this.options.compatibilityAPI?O(O({},{}),this.getResource(e,t)):this.getResource(e,t)}},{key:"getDataByLanguage",value:function(e){return this.data[e]}},{key:"hasLanguageSomeTranslations",value:function(e){var t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find((function(e){return t[e]&&Object.keys(t[e]).length>0}))}},{key:"toJSON",value:function(){return this.data}}]),n}(b),M={processors:{},addPostProcessor:function(e){this.processors[e.name]=e},handle:function(e,t,n,r,i){var o=this;return e.forEach((function(e){o.processors[e]&&(t=o.processors[e].process(t,n,r,i))})),t}};function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function K(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,c.Z)(this,n)}}var j={},Z=function(e){(0,a.Z)(n,e);var t=K(n);function n(e){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,i.Z)(this,n),r=t.call(this),x&&b.call((0,s.Z)(r)),function(e,t,n){e.forEach((function(e){t[e]&&(n[e]=t[e])}))}(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,(0,s.Z)(r)),r.options=o,void 0===r.options.keySeparator&&(r.options.keySeparator="."),r.logger=v.create("translator"),r}return(0,o.Z)(n,[{key:"changeLanguage",value:function(e){e&&(this.language=e)}},{key:"exists",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}};if(void 0===e||null===e)return!1;var n=this.resolve(e,t);return n&&void 0!==n.res}},{key:"extractFromKey",value:function(e,t){var n=void 0!==t.nsSeparator?t.nsSeparator:this.options.nsSeparator;void 0===n&&(n=":");var r=void 0!==t.keySeparator?t.keySeparator:this.options.keySeparator,i=t.ns||this.options.defaultNS||[],o=n&&e.indexOf(n)>-1,s=!this.options.userDefinedKeySeparator&&!t.keySeparator&&!this.options.userDefinedNsSeparator&&!t.nsSeparator&&!function(e,t,n){t=t||"",n=n||"";var r=P.filter((function(e){return t.indexOf(e)<0&&n.indexOf(e)<0}));if(0===r.length)return!0;var i=new RegExp("(".concat(r.map((function(e){return"?"===e?"\\?":e})).join("|"),")")),o=!i.test(e);if(!o){var s=e.indexOf(n);s>0&&!i.test(e.substring(0,s))&&(o=!0)}return o}(e,n,r);if(o&&!s){var a=e.match(this.interpolator.nestingRegexp);if(a&&a.length>0)return{key:e,namespaces:i};var c=e.split(n);(n!==r||n===r&&this.options.ns.indexOf(c[0])>-1)&&(i=c.shift()),e=c.join(r)}return"string"===typeof i&&(i=[i]),{key:e,namespaces:i}}},{key:"translate",value:function(e,t,i){var o=this;if("object"!==(0,r.Z)(t)&&this.options.overloadTranslationOptionHandler&&(t=this.options.overloadTranslationOptionHandler(arguments)),t||(t={}),void 0===e||null===e)return"";Array.isArray(e)||(e=[String(e)]);var s=void 0!==t.returnDetails?t.returnDetails:this.options.returnDetails,a=void 0!==t.keySeparator?t.keySeparator:this.options.keySeparator,c=this.extractFromKey(e[e.length-1],t),l=c.key,u=c.namespaces,h=u[u.length-1],d=t.lng||this.language,f=t.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(d&&"cimode"===d.toLowerCase()){if(f){var p=t.nsSeparator||this.options.nsSeparator;return s?(g.res="".concat(h).concat(p).concat(l),g):"".concat(h).concat(p).concat(l)}return s?(g.res=l,g):l}var g=this.resolve(e,t),y=g&&g.res,m=g&&g.usedKey||l,v=g&&g.exactUsedKey||l,b=Object.prototype.toString.apply(y),w=void 0!==t.joinArrays?t.joinArrays:this.options.joinArrays,E=!this.i18nFormat||this.i18nFormat.handleAsObject;if(E&&y&&("string"!==typeof y&&"boolean"!==typeof y&&"number"!==typeof y)&&["[object Number]","[object Function]","[object RegExp]"].indexOf(b)<0&&("string"!==typeof w||"[object Array]"!==b)){if(!t.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");var A=this.options.returnedObjectHandler?this.options.returnedObjectHandler(m,y,F(F({},t),{},{ns:u})):"key '".concat(l," (").concat(this.language,")' returned an object instead of string.");return s?(g.res=A,g):A}if(a){var S="[object Array]"===b,_=S?[]:{},I=S?v:m;for(var C in y)if(Object.prototype.hasOwnProperty.call(y,C)){var T="".concat(I).concat(a).concat(C);_[C]=this.translate(T,F(F({},t),{joinArrays:!1,ns:u})),_[C]===T&&(_[C]=y[C])}y=_}}else if(E&&"string"===typeof w&&"[object Array]"===b)(y=y.join(w))&&(y=this.extendTranslation(y,e,t,i));else{var k=!1,R=!1,x=void 0!==t.count&&"string"!==typeof t.count,P=n.hasDefaultValue(t),D=x?this.pluralResolver.getSuffix(d,t.count,t):"",O=t["defaultValue".concat(D)]||t.defaultValue;!this.isValidLookup(y)&&P&&(k=!0,y=O),this.isValidLookup(y)||(R=!0,y=l);var N=(t.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&R?void 0:y,B=P&&O!==y&&this.options.updateMissing;if(R||k||B){if(this.logger.log(B?"updateKey":"missingKey",d,h,l,B?O:y),a){var L=this.resolve(l,F(F({},t),{},{keySeparator:!1}));L&&L.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}var M=[],U=this.languageUtils.getFallbackCodes(this.options.fallbackLng,t.lng||this.language);if("fallback"===this.options.saveMissingTo&&U&&U[0])for(var K=0;K<U.length;K++)M.push(U[K]);else"all"===this.options.saveMissingTo?M=this.languageUtils.toResolveHierarchy(t.lng||this.language):M.push(t.lng||this.language);var j=function(e,n,r){var i=P&&r!==y?r:N;o.options.missingKeyHandler?o.options.missingKeyHandler(e,h,n,i,B,t):o.backendConnector&&o.backendConnector.saveMissing&&o.backendConnector.saveMissing(e,h,n,i,B,t),o.emit("missingKey",e,h,n,y)};this.options.saveMissing&&(this.options.saveMissingPlurals&&x?M.forEach((function(e){o.pluralResolver.getSuffixes(e,t).forEach((function(n){j([e],l+n,t["defaultValue".concat(n)]||O)}))})):j(M,l,O))}y=this.extendTranslation(y,e,t,g,i),R&&y===l&&this.options.appendNamespaceToMissingKey&&(y="".concat(h,":").concat(l)),(R||k)&&this.options.parseMissingKeyHandler&&(y="v1"!==this.options.compatibilityAPI?this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?"".concat(h,":").concat(l):l,k?y:void 0):this.options.parseMissingKeyHandler(y))}return s?(g.res=y,g):y}},{key:"extendTranslation",value:function(e,t,n,r,i){var o=this;if(this.i18nFormat&&this.i18nFormat.parse)e=this.i18nFormat.parse(e,F(F({},this.options.interpolation.defaultVariables),n),r.usedLng,r.usedNS,r.usedKey,{resolved:r});else if(!n.skipInterpolation){n.interpolation&&this.interpolator.init(F(F({},n),{interpolation:F(F({},this.options.interpolation),n.interpolation)}));var s,a="string"===typeof e&&(n&&n.interpolation&&void 0!==n.interpolation.skipOnVariables?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);if(a){var c=e.match(this.interpolator.nestingRegexp);s=c&&c.length}var l=n.replace&&"string"!==typeof n.replace?n.replace:n;if(this.options.interpolation.defaultVariables&&(l=F(F({},this.options.interpolation.defaultVariables),l)),e=this.interpolator.interpolate(e,l,n.lng||this.language,n),a){var u=e.match(this.interpolator.nestingRegexp);s<(u&&u.length)&&(n.nest=!1)}!1!==n.nest&&(e=this.interpolator.nest(e,(function(){for(var e=arguments.length,r=new Array(e),s=0;s<e;s++)r[s]=arguments[s];return i&&i[0]===r[0]&&!n.context?(o.logger.warn("It seems you are nesting recursively key: ".concat(r[0]," in key: ").concat(t[0])),null):o.translate.apply(o,r.concat([t]))}),n)),n.interpolation&&this.interpolator.reset()}var h=n.postProcess||this.options.postProcess,d="string"===typeof h?[h]:h;return void 0!==e&&null!==e&&d&&d.length&&!1!==n.applyPostProcessor&&(e=M.handle(d,e,t,this.options&&this.options.postProcessPassResolved?F({i18nResolved:r},n):n,this)),e}},{key:"resolve",value:function(e){var t,n,r,i,o,s=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"===typeof e&&(e=[e]),e.forEach((function(e){if(!s.isValidLookup(t)){var c=s.extractFromKey(e,a),l=c.key;n=l;var u=c.namespaces;s.options.fallbackNS&&(u=u.concat(s.options.fallbackNS));var h=void 0!==a.count&&"string"!==typeof a.count,d=h&&!a.ordinal&&0===a.count&&s.pluralResolver.shouldUseIntlApi(),f=void 0!==a.context&&("string"===typeof a.context||"number"===typeof a.context)&&""!==a.context,p=a.lngs?a.lngs:s.languageUtils.toResolveHierarchy(a.lng||s.language,a.fallbackLng);u.forEach((function(e){s.isValidLookup(t)||(o=e,!j["".concat(p[0],"-").concat(e)]&&s.utils&&s.utils.hasLoadedNamespace&&!s.utils.hasLoadedNamespace(o)&&(j["".concat(p[0],"-").concat(e)]=!0,s.logger.warn('key "'.concat(n,'" for languages "').concat(p.join(", "),'" won\'t get resolved as namespace "').concat(o,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),p.forEach((function(n){if(!s.isValidLookup(t)){i=n;var o,c=[l];if(s.i18nFormat&&s.i18nFormat.addLookupKeys)s.i18nFormat.addLookupKeys(c,l,n,e,a);else{var u;h&&(u=s.pluralResolver.getSuffix(n,a.count,a));var p="".concat(s.options.pluralSeparator,"zero");if(h&&(c.push(l+u),d&&c.push(l+p)),f){var g="".concat(l).concat(s.options.contextSeparator).concat(a.context);c.push(g),h&&(c.push(g+u),d&&c.push(g+p))}}for(;o=c.pop();)s.isValidLookup(t)||(r=o,t=s.getResource(n,e,o,a))}})))}))}})),{res:t,usedKey:n,exactUsedKey:r,usedLng:i,usedNS:o}}},{key:"isValidLookup",value:function(e){return void 0!==e&&!(!this.options.returnNull&&null===e)&&!(!this.options.returnEmptyString&&""===e)}},{key:"getResource",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(e,t,n,r):this.resourceStore.getResource(e,t,n,r)}}],[{key:"hasDefaultValue",value:function(e){var t="defaultValue";for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t===n.substring(0,12)&&void 0!==e[n])return!0;return!1}}]),n}(b);function z(e){return e.charAt(0).toUpperCase()+e.slice(1)}var V=function(){function e(t){(0,i.Z)(this,e),this.options=t,this.supportedLngs=this.options.supportedLngs||!1,this.logger=v.create("languageUtils")}return(0,o.Z)(e,[{key:"getScriptPartFromCode",value:function(e){if(!e||e.indexOf("-")<0)return null;var t=e.split("-");return 2===t.length?null:(t.pop(),"x"===t[t.length-1].toLowerCase()?null:this.formatLanguageCode(t.join("-")))}},{key:"getLanguagePartFromCode",value:function(e){if(!e||e.indexOf("-")<0)return e;var t=e.split("-");return this.formatLanguageCode(t[0])}},{key:"formatLanguageCode",value:function(e){if("string"===typeof e&&e.indexOf("-")>-1){var t=["hans","hant","latn","cyrl","cans","mong","arab"],n=e.split("-");return this.options.lowerCaseLng?n=n.map((function(e){return e.toLowerCase()})):2===n.length?(n[0]=n[0].toLowerCase(),n[1]=n[1].toUpperCase(),t.indexOf(n[1].toLowerCase())>-1&&(n[1]=z(n[1].toLowerCase()))):3===n.length&&(n[0]=n[0].toLowerCase(),2===n[1].length&&(n[1]=n[1].toUpperCase()),"sgn"!==n[0]&&2===n[2].length&&(n[2]=n[2].toUpperCase()),t.indexOf(n[1].toLowerCase())>-1&&(n[1]=z(n[1].toLowerCase())),t.indexOf(n[2].toLowerCase())>-1&&(n[2]=z(n[2].toLowerCase()))),n.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}},{key:"isSupportedCode",value:function(e){return("languageOnly"===this.options.load||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}},{key:"getBestMatchFromCodes",value:function(e){var t,n=this;return e?(e.forEach((function(e){if(!t){var r=n.formatLanguageCode(e);n.options.supportedLngs&&!n.isSupportedCode(r)||(t=r)}})),!t&&this.options.supportedLngs&&e.forEach((function(e){if(!t){var r=n.getLanguagePartFromCode(e);if(n.isSupportedCode(r))return t=r;t=n.options.supportedLngs.find((function(e){if(0===e.indexOf(r))return e}))}})),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t):null}},{key:"getFallbackCodes",value:function(e,t){if(!e)return[];if("function"===typeof e&&(e=e(t)),"string"===typeof e&&(e=[e]),"[object Array]"===Object.prototype.toString.apply(e))return e;if(!t)return e.default||[];var n=e[t];return n||(n=e[this.getScriptPartFromCode(t)]),n||(n=e[this.formatLanguageCode(t)]),n||(n=e[this.getLanguagePartFromCode(t)]),n||(n=e.default),n||[]}},{key:"toResolveHierarchy",value:function(e,t){var n=this,r=this.getFallbackCodes(t||this.options.fallbackLng||[],e),i=[],o=function(e){e&&(n.isSupportedCode(e)?i.push(e):n.logger.warn("rejecting language code not found in supportedLngs: ".concat(e)))};return"string"===typeof e&&e.indexOf("-")>-1?("languageOnly"!==this.options.load&&o(this.formatLanguageCode(e)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&o(this.getScriptPartFromCode(e)),"currentOnly"!==this.options.load&&o(this.getLanguagePartFromCode(e))):"string"===typeof e&&o(this.formatLanguageCode(e)),r.forEach((function(e){i.indexOf(e)<0&&o(n.formatLanguageCode(e))})),i}}]),e}(),H=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],q={1:function(e){return Number(e>1)},2:function(e){return Number(1!=e)},3:function(e){return 0},4:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},5:function(e){return Number(0==e?0:1==e?1:2==e?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5)},6:function(e){return Number(1==e?0:e>=2&&e<=4?1:2)},7:function(e){return Number(1==e?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},8:function(e){return Number(1==e?0:2==e?1:8!=e&&11!=e?2:3)},9:function(e){return Number(e>=2)},10:function(e){return Number(1==e?0:2==e?1:e<7?2:e<11?3:4)},11:function(e){return Number(1==e||11==e?0:2==e||12==e?1:e>2&&e<20?2:3)},12:function(e){return Number(e%10!=1||e%100==11)},13:function(e){return Number(0!==e)},14:function(e){return Number(1==e?0:2==e?1:3==e?2:3)},15:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&(e%100<10||e%100>=20)?1:2)},16:function(e){return Number(e%10==1&&e%100!=11?0:0!==e?1:2)},17:function(e){return Number(1==e||e%10==1&&e%100!=11?0:1)},18:function(e){return Number(0==e?0:1==e?1:2)},19:function(e){return Number(1==e?0:0==e||e%100>1&&e%100<11?1:e%100>10&&e%100<20?2:3)},20:function(e){return Number(1==e?0:0==e||e%100>0&&e%100<20?1:2)},21:function(e){return Number(e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0)},22:function(e){return Number(1==e?0:2==e?1:(e<0||e>10)&&e%10==0?2:3)}},G=["v1","v2","v3"],W={zero:0,one:1,two:2,few:3,many:4,other:5};var Q=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,i.Z)(this,e),this.languageUtils=t,this.options=n,this.logger=v.create("pluralResolver"),this.options.compatibilityJSON&&"v4"!==this.options.compatibilityJSON||"undefined"!==typeof Intl&&Intl.PluralRules||(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=function(){var e={};return H.forEach((function(t){t.lngs.forEach((function(n){e[n]={numbers:t.nr,plurals:q[t.fc]}}))})),e}()}return(0,o.Z)(e,[{key:"addRule",value:function(e,t){this.rules[e]=t}},{key:"getRule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.shouldUseIntlApi())try{return new Intl.PluralRules(e,{type:t.ordinal?"ordinal":"cardinal"})}catch(n){return}return this.rules[e]||this.rules[this.languageUtils.getLanguagePartFromCode(e)]}},{key:"needsPlural",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getRule(e,t);return this.shouldUseIntlApi()?n&&n.resolvedOptions().pluralCategories.length>1:n&&n.numbers.length>1}},{key:"getPluralFormsOfKey",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.getSuffixes(e,n).map((function(e){return"".concat(t).concat(e)}))}},{key:"getSuffixes",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.getRule(e,n);return r?this.shouldUseIntlApi()?r.resolvedOptions().pluralCategories.sort((function(e,t){return W[e]-W[t]})).map((function(e){return"".concat(t.options.prepend).concat(e)})):r.numbers.map((function(r){return t.getSuffix(e,r,n)})):[]}},{key:"getSuffix",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this.getRule(e,n);return r?this.shouldUseIntlApi()?"".concat(this.options.prepend).concat(r.select(t)):this.getSuffixRetroCompatible(r,t):(this.logger.warn("no plural rule found for: ".concat(e)),"")}},{key:"getSuffixRetroCompatible",value:function(e,t){var n=this,r=e.noAbs?e.plurals(t):e.plurals(Math.abs(t)),i=e.numbers[r];this.options.simplifyPluralSuffix&&2===e.numbers.length&&1===e.numbers[0]&&(2===i?i="plural":1===i&&(i=""));var o=function(){return n.options.prepend&&i.toString()?n.options.prepend+i.toString():i.toString()};return"v1"===this.options.compatibilityJSON?1===i?"":"number"===typeof i?"_plural_".concat(i.toString()):o():"v2"===this.options.compatibilityJSON||this.options.simplifyPluralSuffix&&2===e.numbers.length&&1===e.numbers[0]?o():this.options.prepend&&r.toString()?this.options.prepend+r.toString():r.toString()}},{key:"shouldUseIntlApi",value:function(){return!G.includes(this.options.compatibilityJSON)}}]),e}();function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function J(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var X=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,i.Z)(this,e),this.logger=v.create("interpolator"),this.options=t,this.format=t.interpolation&&t.interpolation.format||function(e){return e},this.init(t)}return(0,o.Z)(e,[{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.interpolation||(e.interpolation={escapeValue:!0});var t=e.interpolation;this.escape=void 0!==t.escape?t.escape:R,this.escapeValue=void 0===t.escapeValue||t.escapeValue,this.useRawValueToEscape=void 0!==t.useRawValueToEscape&&t.useRawValueToEscape,this.prefix=t.prefix?T(t.prefix):t.prefixEscaped||"{{",this.suffix=t.suffix?T(t.suffix):t.suffixEscaped||"}}",this.formatSeparator=t.formatSeparator?t.formatSeparator:t.formatSeparator||",",this.unescapePrefix=t.unescapeSuffix?"":t.unescapePrefix||"-",this.unescapeSuffix=this.unescapePrefix?"":t.unescapeSuffix||"",this.nestingPrefix=t.nestingPrefix?T(t.nestingPrefix):t.nestingPrefixEscaped||T("$t("),this.nestingSuffix=t.nestingSuffix?T(t.nestingSuffix):t.nestingSuffixEscaped||T(")"),this.nestingOptionsSeparator=t.nestingOptionsSeparator?t.nestingOptionsSeparator:t.nestingOptionsSeparator||",",this.maxReplaces=t.maxReplaces?t.maxReplaces:1e3,this.alwaysFormat=void 0!==t.alwaysFormat&&t.alwaysFormat,this.resetRegExp()}},{key:"reset",value:function(){this.options&&this.init(this.options)}},{key:"resetRegExp",value:function(){var e="".concat(this.prefix,"(.+?)").concat(this.suffix);this.regexp=new RegExp(e,"g");var t="".concat(this.prefix).concat(this.unescapePrefix,"(.+?)").concat(this.unescapeSuffix).concat(this.suffix);this.regexpUnescape=new RegExp(t,"g");var n="".concat(this.nestingPrefix,"(.+?)").concat(this.nestingSuffix);this.nestingRegexp=new RegExp(n,"g")}},{key:"interpolate",value:function(e,t,n,r){var i,o,s,a=this,c=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function l(e){return e.replace(/\$/g,"$$$$")}var u=function(e){if(e.indexOf(a.formatSeparator)<0){var i=I(t,c,e);return a.alwaysFormat?a.format(i,void 0,n,J(J(J({},r),t),{},{interpolationkey:e})):i}var o=e.split(a.formatSeparator),s=o.shift().trim(),l=o.join(a.formatSeparator).trim();return a.format(I(t,c,s),l,n,J(J(J({},r),t),{},{interpolationkey:s}))};this.resetRegExp();var h=r&&r.missingInterpolationHandler||this.options.missingInterpolationHandler,d=r&&r.interpolation&&void 0!==r.interpolation.skipOnVariables?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:function(e){return l(e)}},{regex:this.regexp,safeValue:function(e){return a.escapeValue?l(a.escape(e)):l(e)}}].forEach((function(t){for(s=0;i=t.regex.exec(e);){var n=i[1].trim();if(void 0===(o=u(n)))if("function"===typeof h){var c=h(e,i,r);o="string"===typeof c?c:""}else if(r&&r.hasOwnProperty(n))o="";else{if(d){o=i[0];continue}a.logger.warn("missed to pass in variable ".concat(n," for interpolating ").concat(e)),o=""}else"string"===typeof o||a.useRawValueToEscape||(o=E(o));var l=t.safeValue(o);if(e=e.replace(i[0],l),d?(t.regex.lastIndex+=o.length,t.regex.lastIndex-=i[0].length):t.regex.lastIndex=0,++s>=a.maxReplaces)break}})),e}},{key:"nest",value:function(e,t){var n,r,i=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=J({},o);function a(e,t){var n=this.nestingOptionsSeparator;if(e.indexOf(n)<0)return e;var r=e.split(new RegExp("".concat(n,"[ ]*{"))),i="{".concat(r[1]);e=r[0];var o=(i=this.interpolate(i,s)).match(/'/g),a=i.match(/"/g);(o&&o.length%2===0&&!a||a.length%2!==0)&&(i=i.replace(/'/g,'"'));try{s=JSON.parse(i),t&&(s=J(J({},t),s))}catch(c){return this.logger.warn("failed parsing options string in nesting for key ".concat(e),c),"".concat(e).concat(n).concat(i)}return delete s.defaultValue,e}for(s.applyPostProcessor=!1,delete s.defaultValue;n=this.nestingRegexp.exec(e);){var c=[],l=!1;if(-1!==n[0].indexOf(this.formatSeparator)&&!/{.*}/.test(n[1])){var u=n[1].split(this.formatSeparator).map((function(e){return e.trim()}));n[1]=u.shift(),c=u,l=!0}if((r=t(a.call(this,n[1].trim(),s),s))&&n[0]===e&&"string"!==typeof r)return r;"string"!==typeof r&&(r=E(r)),r||(this.logger.warn("missed to resolve ".concat(n[1]," for nesting ").concat(e)),r=""),l&&(r=c.reduce((function(e,t){return i.format(e,t,o.lng,J(J({},o),{},{interpolationkey:n[1].trim()}))}),r.trim())),e=e.replace(n[0],r),this.regexp.lastIndex=0}return e}}]),e}();function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function te(e){var t=e.toLowerCase().trim(),n={};if(e.indexOf("(")>-1){var r=e.split("(");t=r[0].toLowerCase().trim();var i=r[1].substring(0,r[1].length-1);if("currency"===t&&i.indexOf(":")<0)n.currency||(n.currency=i.trim());else if("relativetime"===t&&i.indexOf(":")<0)n.range||(n.range=i.trim());else{i.split(";").forEach((function(e){if(e){var t=function(e){return(0,h.Z)(e)||(0,d.Z)(e)||(0,f.Z)(e)||(0,p.Z)()}(e.split(":")),r=t[0],i=t.slice(1).join(":").trim().replace(/^'+|'+$/g,"");n[r.trim()]||(n[r.trim()]=i),"false"===i&&(n[r.trim()]=!1),"true"===i&&(n[r.trim()]=!0),isNaN(i)||(n[r.trim()]=parseInt(i,10))}}))}}return{formatName:t,formatOptions:n}}function ne(e){var t={};return function(n,r,i){var o=r+JSON.stringify(i),s=t[o];return s||(s=e(r,i),t[o]=s),s(n)}}var re=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,i.Z)(this,e),this.logger=v.create("formatter"),this.options=t,this.formats={number:ne((function(e,t){var n=new Intl.NumberFormat(e,t);return function(e){return n.format(e)}})),currency:ne((function(e,t){var n=new Intl.NumberFormat(e,ee(ee({},t),{},{style:"currency"}));return function(e){return n.format(e)}})),datetime:ne((function(e,t){var n=new Intl.DateTimeFormat(e,ee({},t));return function(e){return n.format(e)}})),relativetime:ne((function(e,t){var n=new Intl.RelativeTimeFormat(e,ee({},t));return function(e){return n.format(e,t.range||"day")}})),list:ne((function(e,t){var n=new Intl.ListFormat(e,ee({},t));return function(e){return n.format(e)}}))},this.init(t)}return(0,o.Z)(e,[{key:"init",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}}).interpolation;this.formatSeparator=t.formatSeparator?t.formatSeparator:t.formatSeparator||","}},{key:"add",value:function(e,t){this.formats[e.toLowerCase().trim()]=t}},{key:"addCached",value:function(e,t){this.formats[e.toLowerCase().trim()]=ne(t)}},{key:"format",value:function(e,t,n,r){var i=this;return t.split(this.formatSeparator).reduce((function(e,t){var o=te(t),s=o.formatName,a=o.formatOptions;if(i.formats[s]){var c=e;try{var l=r&&r.formatParams&&r.formatParams[r.interpolationkey]||{},u=l.locale||l.lng||r.locale||r.lng||n;c=i.formats[s](e,u,ee(ee(ee({},a),r),l))}catch(h){i.logger.warn(h)}return c}return i.logger.warn("there was no format function for ".concat(s)),e}),e)}}]),e}();function ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function se(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,c.Z)(this,n)}}var ae=function(e){(0,a.Z)(n,e);var t=se(n);function n(e,r,o){var a,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return(0,i.Z)(this,n),a=t.call(this),x&&b.call((0,s.Z)(a)),a.backend=e,a.store=r,a.services=o,a.languageUtils=o.languageUtils,a.options=c,a.logger=v.create("backendConnector"),a.waitingReads=[],a.maxParallelReads=c.maxParallelReads||10,a.readingCalls=0,a.maxRetries=c.maxRetries>=0?c.maxRetries:5,a.retryTimeout=c.retryTimeout>=1?c.retryTimeout:350,a.state={},a.queue=[],a.backend&&a.backend.init&&a.backend.init(o,c.backend,c),a}return(0,o.Z)(n,[{key:"queueLoad",value:function(e,t,n,r){var i=this,o={},s={},a={},c={};return e.forEach((function(e){var r=!0;t.forEach((function(t){var a="".concat(e,"|").concat(t);!n.reload&&i.store.hasResourceBundle(e,t)?i.state[a]=2:i.state[a]<0||(1===i.state[a]?void 0===s[a]&&(s[a]=!0):(i.state[a]=1,r=!1,void 0===s[a]&&(s[a]=!0),void 0===o[a]&&(o[a]=!0),void 0===c[t]&&(c[t]=!0)))})),r||(a[e]=!0)})),(Object.keys(o).length||Object.keys(s).length)&&this.queue.push({pending:s,pendingCount:Object.keys(s).length,loaded:{},errors:[],callback:r}),{toLoad:Object.keys(o),pending:Object.keys(s),toLoadLanguages:Object.keys(a),toLoadNamespaces:Object.keys(c)}}},{key:"loaded",value:function(e,t,n){var r=e.split("|"),i=r[0],o=r[1];t&&this.emit("failedLoading",i,o,t),n&&this.store.addResourceBundle(i,o,n),this.state[e]=t?-1:2;var s={};this.queue.forEach((function(n){!function(e,t,n,r){var i=A(e,t,Object),o=i.obj,s=i.k;o[s]=o[s]||[],r&&(o[s]=o[s].concat(n)),r||o[s].push(n)}(n.loaded,[i],o),function(e,t){void 0!==e.pending[t]&&(delete e.pending[t],e.pendingCount--)}(n,e),t&&n.errors.push(t),0!==n.pendingCount||n.done||(Object.keys(n.loaded).forEach((function(e){s[e]||(s[e]={});var t=n.loaded[e];t.length&&t.forEach((function(t){void 0===s[e][t]&&(s[e][t]=!0)}))})),n.done=!0,n.errors.length?n.callback(n.errors):n.callback())})),this.emit("loaded",s),this.queue=this.queue.filter((function(e){return!e.done}))}},{key:"read",value:function(e,t,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.retryTimeout,s=arguments.length>5?arguments[5]:void 0;return e.length?this.readingCalls>=this.maxParallelReads?void this.waitingReads.push({lng:e,ns:t,fcName:n,tried:i,wait:o,callback:s}):(this.readingCalls++,this.backend[n](e,t,(function(a,c){if(r.readingCalls--,r.waitingReads.length>0){var l=r.waitingReads.shift();r.read(l.lng,l.ns,l.fcName,l.tried,l.wait,l.callback)}a&&c&&i<r.maxRetries?setTimeout((function(){r.read.call(r,e,t,n,i+1,2*o,s)}),o):s(a,c)}))):s(null,{})}},{key:"prepareLoading",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),i&&i();"string"===typeof e&&(e=this.languageUtils.toResolveHierarchy(e)),"string"===typeof t&&(t=[t]);var o=this.queueLoad(e,t,r,i);if(!o.toLoad.length)return o.pending.length||i(),null;o.toLoad.forEach((function(e){n.loadOne(e)}))}},{key:"load",value:function(e,t,n){this.prepareLoading(e,t,{},n)}},{key:"reload",value:function(e,t,n){this.prepareLoading(e,t,{reload:!0},n)}},{key:"loadOne",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=e.split("|"),i=r[0],o=r[1];this.read(i,o,"read",void 0,void 0,(function(r,s){r&&t.logger.warn("".concat(n,"loading namespace ").concat(o," for language ").concat(i," failed"),r),!r&&s&&t.logger.log("".concat(n,"loaded namespace ").concat(o," for language ").concat(i),s),t.loaded(e,r,s)}))}},{key:"saveMissing",value:function(e,t,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(t)?this.logger.warn('did not save key "'.concat(n,'" as the namespace "').concat(t,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!"):void 0!==n&&null!==n&&""!==n&&(this.backend&&this.backend.create&&this.backend.create(e,t,n,r,null,oe(oe({},o),{},{isUpdate:i})),e&&e[0]&&this.store.addResource(e[0],t,n,r))}}]),n}(b);function ce(e){return"string"===typeof e.ns&&(e.ns=[e.ns]),"string"===typeof e.fallbackLng&&(e.fallbackLng=[e.fallbackLng]),"string"===typeof e.fallbackNS&&(e.fallbackNS=[e.fallbackNS]),e.supportedLngs&&e.supportedLngs.indexOf("cimode")<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),e}function le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ue(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?le(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function he(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,c.Z)(this,n)}}function de(){}var fe=function(e){(0,a.Z)(n,e);var t=he(n);function n(){var e,r,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0;if((0,i.Z)(this,n),e=t.call(this),x&&b.call((0,s.Z)(e)),e.options=ce(o),e.services={},e.logger=v,e.modules={external:[]},r=(0,s.Z)(e),Object.getOwnPropertyNames(Object.getPrototypeOf(r)).forEach((function(e){"function"===typeof r[e]&&(r[e]=r[e].bind(r))})),a&&!e.isInitialized&&!o.isClone){if(!e.options.initImmediate)return e.init(o,a),(0,c.Z)(e,(0,s.Z)(e));setTimeout((function(){e.init(o,a)}),0)}return e}return(0,o.Z)(n,[{key:"init",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;"function"===typeof t&&(n=t,t={}),!t.defaultNS&&!1!==t.defaultNS&&t.ns&&("string"===typeof t.ns?t.defaultNS=t.ns:t.ns.indexOf("translation")<0&&(t.defaultNS=t.ns[0]));var i={debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!0,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(e){var t={};if("object"===(0,r.Z)(e[1])&&(t=e[1]),"string"===typeof e[1]&&(t.defaultValue=e[1]),"string"===typeof e[2]&&(t.tDescription=e[2]),"object"===(0,r.Z)(e[2])||"object"===(0,r.Z)(e[3])){var n=e[3]||e[2];Object.keys(n).forEach((function(e){t[e]=n[e]}))}return t},interpolation:{escapeValue:!0,format:function(e,t,n,r){return e},prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}};function o(e){return e?"function"===typeof e?new e:e:null}if(this.options=ue(ue(ue({},i),this.options),ce(t)),"v1"!==this.options.compatibilityAPI&&(this.options.interpolation=ue(ue({},i.interpolation),this.options.interpolation)),void 0!==t.keySeparator&&(this.options.userDefinedKeySeparator=t.keySeparator),void 0!==t.nsSeparator&&(this.options.userDefinedNsSeparator=t.nsSeparator),!this.options.isClone){var s;this.modules.logger?v.init(o(this.modules.logger),this.options):v.init(null,this.options),this.modules.formatter?s=this.modules.formatter:"undefined"!==typeof Intl&&(s=re);var a=new V(this.options);this.store=new L(this.options.resources,this.options);var c=this.services;c.logger=v,c.resourceStore=this.store,c.languageUtils=a,c.pluralResolver=new Q(a,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),!s||this.options.interpolation.format&&this.options.interpolation.format!==i.interpolation.format||(c.formatter=o(s),c.formatter.init(c,this.options),this.options.interpolation.format=c.formatter.format.bind(c.formatter)),c.interpolator=new X(this.options),c.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},c.backendConnector=new ae(o(this.modules.backend),c.resourceStore,c,this.options),c.backendConnector.on("*",(function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];e.emit.apply(e,[t].concat(r))})),this.modules.languageDetector&&(c.languageDetector=o(this.modules.languageDetector),c.languageDetector.init(c,this.options.detection,this.options)),this.modules.i18nFormat&&(c.i18nFormat=o(this.modules.i18nFormat),c.i18nFormat.init&&c.i18nFormat.init(this)),this.translator=new Z(this.services,this.options),this.translator.on("*",(function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];e.emit.apply(e,[t].concat(r))})),this.modules.external.forEach((function(t){t.init&&t.init(e)}))}if(this.format=this.options.interpolation.format,n||(n=de),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){var l=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);l.length>0&&"dev"!==l[0]&&(this.options.lng=l[0])}this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined");["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach((function(t){e[t]=function(){var n;return(n=e.store)[t].apply(n,arguments)}}));["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach((function(t){e[t]=function(){var n;return(n=e.store)[t].apply(n,arguments),e}}));var u=w(),h=function(){var t=function(t,r){e.isInitialized&&!e.initializedStoreOnce&&e.logger.warn("init: i18next is already initialized. You should call init just once!"),e.isInitialized=!0,e.options.isClone||e.logger.log("initialized",e.options),e.emit("initialized",e.options),u.resolve(r),n(t,r)};if(e.languages&&"v1"!==e.options.compatibilityAPI&&!e.isInitialized)return t(null,e.t.bind(e));e.changeLanguage(e.options.lng,t)};return this.options.resources||!this.options.initImmediate?h():setTimeout(h,0),u}},{key:"loadResources",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:de,r="string"===typeof e?e:this.language;if("function"===typeof e&&(n=e),!this.options.resources||this.options.partialBundledLanguages){if(r&&"cimode"===r.toLowerCase())return n();var i=[],o=function(e){e&&t.services.languageUtils.toResolveHierarchy(e).forEach((function(e){i.indexOf(e)<0&&i.push(e)}))};if(r)o(r);else this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach((function(e){return o(e)}));this.options.preload&&this.options.preload.forEach((function(e){return o(e)})),this.services.backendConnector.load(i,this.options.ns,(function(e){e||t.resolvedLanguage||!t.language||t.setResolvedLanguage(t.language),n(e)}))}else n(null)}},{key:"reloadResources",value:function(e,t,n){var r=w();return e||(e=this.languages),t||(t=this.options.ns),n||(n=de),this.services.backendConnector.reload(e,t,(function(e){r.resolve(),n(e)})),r}},{key:"use",value:function(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===e.type&&(this.modules.backend=e),("logger"===e.type||e.log&&e.warn&&e.error)&&(this.modules.logger=e),"languageDetector"===e.type&&(this.modules.languageDetector=e),"i18nFormat"===e.type&&(this.modules.i18nFormat=e),"postProcessor"===e.type&&M.addPostProcessor(e),"formatter"===e.type&&(this.modules.formatter=e),"3rdParty"===e.type&&this.modules.external.push(e),this}},{key:"setResolvedLanguage",value:function(e){if(e&&this.languages&&!(["cimode","dev"].indexOf(e)>-1))for(var t=0;t<this.languages.length;t++){var n=this.languages[t];if(!(["cimode","dev"].indexOf(n)>-1)&&this.store.hasLanguageSomeTranslations(n)){this.resolvedLanguage=n;break}}}},{key:"changeLanguage",value:function(e,t){var n=this;this.isLanguageChangingTo=e;var r=w();this.emit("languageChanging",e);var i=function(e){n.language=e,n.languages=n.services.languageUtils.toResolveHierarchy(e),n.resolvedLanguage=void 0,n.setResolvedLanguage(e)},o=function(o){e||o||!n.services.languageDetector||(o=[]);var s="string"===typeof o?o:n.services.languageUtils.getBestMatchFromCodes(o);s&&(n.language||i(s),n.translator.language||n.translator.changeLanguage(s),n.services.languageDetector&&n.services.languageDetector.cacheUserLanguage(s)),n.loadResources(s,(function(e){!function(e,o){o?(i(o),n.translator.changeLanguage(o),n.isLanguageChangingTo=void 0,n.emit("languageChanged",o),n.logger.log("languageChanged",o)):n.isLanguageChangingTo=void 0,r.resolve((function(){return n.t.apply(n,arguments)})),t&&t(e,(function(){return n.t.apply(n,arguments)}))}(e,s)}))};return e||!this.services.languageDetector||this.services.languageDetector.async?!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect(o):o(e):o(this.services.languageDetector.detect()),r}},{key:"getFixedT",value:function(e,t,n){var i=this,o=function e(t,o){var s;if("object"!==(0,r.Z)(o)){for(var a=arguments.length,c=new Array(a>2?a-2:0),l=2;l<a;l++)c[l-2]=arguments[l];s=i.options.overloadTranslationOptionHandler([t,o].concat(c))}else s=ue({},o);s.lng=s.lng||e.lng,s.lngs=s.lngs||e.lngs,s.ns=s.ns||e.ns,s.keyPrefix=s.keyPrefix||n||e.keyPrefix;var u=i.options.keySeparator||".",h=s.keyPrefix?"".concat(s.keyPrefix).concat(u).concat(t):t;return i.t(h,s)};return"string"===typeof e?o.lng=e:o.lngs=e,o.ns=t,o.keyPrefix=n,o}},{key:"t",value:function(){var e;return this.translator&&(e=this.translator).translate.apply(e,arguments)}},{key:"exists",value:function(){var e;return this.translator&&(e=this.translator).exists.apply(e,arguments)}},{key:"setDefaultNamespace",value:function(e){this.options.defaultNS=e}},{key:"hasLoadedNamespace",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;var r=this.resolvedLanguage||this.languages[0],i=!!this.options&&this.options.fallbackLng,o=this.languages[this.languages.length-1];if("cimode"===r.toLowerCase())return!0;var s=function(e,n){var r=t.services.backendConnector.state["".concat(e,"|").concat(n)];return-1===r||2===r};if(n.precheck){var a=n.precheck(this,s);if(void 0!==a)return a}return!!this.hasResourceBundle(r,e)||(!(this.services.backendConnector.backend&&(!this.options.resources||this.options.partialBundledLanguages))||!(!s(r,e)||i&&!s(o,e)))}},{key:"loadNamespaces",value:function(e,t){var n=this,r=w();return this.options.ns?("string"===typeof e&&(e=[e]),e.forEach((function(e){n.options.ns.indexOf(e)<0&&n.options.ns.push(e)})),this.loadResources((function(e){r.resolve(),t&&t(e)})),r):(t&&t(),Promise.resolve())}},{key:"loadLanguages",value:function(e,t){var n=w();"string"===typeof e&&(e=[e]);var r=this.options.preload||[],i=e.filter((function(e){return r.indexOf(e)<0}));return i.length?(this.options.preload=r.concat(i),this.loadResources((function(e){n.resolve(),t&&t(e)})),n):(t&&t(),Promise.resolve())}},{key:"dir",value:function(e){if(e||(e=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),!e)return"rtl";return["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"].indexOf(this.services.languageUtils.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}},{key:"cloneInstance",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:de,i=ue(ue(ue({},this.options),t),{isClone:!0}),o=new n(i);void 0===t.debug&&void 0===t.prefix||(o.logger=o.logger.clone(t));return["store","services","language"].forEach((function(t){o[t]=e[t]})),o.services=ue({},this.services),o.services.utils={hasLoadedNamespace:o.hasLoadedNamespace.bind(o)},o.translator=new Z(o.services,o.options),o.translator.on("*",(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];o.emit.apply(o,[e].concat(n))})),o.init(i,r),o.translator.options=o.options,o.translator.backendConnector.services.utils={hasLoadedNamespace:o.hasLoadedNamespace.bind(o)},o}},{key:"toJSON",value:function(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}]),n}(b);(0,u.Z)(fe,"createInstance",(function(){return new fe(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},arguments.length>1?arguments[1]:void 0)}));var pe=fe.createInstance();pe.createInstance=fe.createInstance;pe.createInstance,pe.init,pe.loadResources,pe.reloadResources,pe.use,pe.changeLanguage,pe.getFixedT,pe.t,pe.exists,pe.setDefaultNamespace,pe.hasLoadedNamespace,pe.loadNamespaces,pe.loadLanguages;const ge=pe;function ye(e,t,n){function r(e){return e&&e.indexOf("###")>-1?e.replace(/###/g,"."):e}function i(){return!e||"string"===typeof e}for(var o="string"!==typeof t?[].concat(t):t.split(".");o.length>1;){if(i())return{};var s=r(o.shift());!e[s]&&n&&(e[s]=new n),e=e[s]}return i()?{}:{obj:e,k:r(o.shift())}}var me=[],ve=me.forEach,be=me.slice;var we=function(e,t){return we=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},we(e,t)};function Ee(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}we(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var Ae=function(){return Ae=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Ae.apply(this,arguments)};Object.create;function Se(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}Object.create;var _e,Ie,Ce;function Te(e){return e.type===Ie.literal}function ke(e){return e.type===Ie.argument}function Re(e){return e.type===Ie.number}function xe(e){return e.type===Ie.date}function Pe(e){return e.type===Ie.time}function De(e){return e.type===Ie.select}function Oe(e){return e.type===Ie.plural}function Ne(e){return e.type===Ie.pound}function Be(e){return e.type===Ie.tag}function Le(e){return!(!e||"object"!==typeof e||e.type!==Ce.number)}function Me(e){return!(!e||"object"!==typeof e||e.type!==Ce.dateTime)}!function(e){e[e.EXPECT_ARGUMENT_CLOSING_BRACE=1]="EXPECT_ARGUMENT_CLOSING_BRACE",e[e.EMPTY_ARGUMENT=2]="EMPTY_ARGUMENT",e[e.MALFORMED_ARGUMENT=3]="MALFORMED_ARGUMENT",e[e.EXPECT_ARGUMENT_TYPE=4]="EXPECT_ARGUMENT_TYPE",e[e.INVALID_ARGUMENT_TYPE=5]="INVALID_ARGUMENT_TYPE",e[e.EXPECT_ARGUMENT_STYLE=6]="EXPECT_ARGUMENT_STYLE",e[e.INVALID_NUMBER_SKELETON=7]="INVALID_NUMBER_SKELETON",e[e.INVALID_DATE_TIME_SKELETON=8]="INVALID_DATE_TIME_SKELETON",e[e.EXPECT_NUMBER_SKELETON=9]="EXPECT_NUMBER_SKELETON",e[e.EXPECT_DATE_TIME_SKELETON=10]="EXPECT_DATE_TIME_SKELETON",e[e.UNCLOSED_QUOTE_IN_ARGUMENT_STYLE=11]="UNCLOSED_QUOTE_IN_ARGUMENT_STYLE",e[e.EXPECT_SELECT_ARGUMENT_OPTIONS=12]="EXPECT_SELECT_ARGUMENT_OPTIONS",e[e.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE=13]="EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE",e[e.INVALID_PLURAL_ARGUMENT_OFFSET_VALUE=14]="INVALID_PLURAL_ARGUMENT_OFFSET_VALUE",e[e.EXPECT_SELECT_ARGUMENT_SELECTOR=15]="EXPECT_SELECT_ARGUMENT_SELECTOR",e[e.EXPECT_PLURAL_ARGUMENT_SELECTOR=16]="EXPECT_PLURAL_ARGUMENT_SELECTOR",e[e.EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT=17]="EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT",e[e.EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT=18]="EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT",e[e.INVALID_PLURAL_ARGUMENT_SELECTOR=19]="INVALID_PLURAL_ARGUMENT_SELECTOR",e[e.DUPLICATE_PLURAL_ARGUMENT_SELECTOR=20]="DUPLICATE_PLURAL_ARGUMENT_SELECTOR",e[e.DUPLICATE_SELECT_ARGUMENT_SELECTOR=21]="DUPLICATE_SELECT_ARGUMENT_SELECTOR",e[e.MISSING_OTHER_CLAUSE=22]="MISSING_OTHER_CLAUSE",e[e.INVALID_TAG=23]="INVALID_TAG",e[e.INVALID_TAG_NAME=25]="INVALID_TAG_NAME",e[e.UNMATCHED_CLOSING_TAG=26]="UNMATCHED_CLOSING_TAG",e[e.UNCLOSED_TAG=27]="UNCLOSED_TAG"}(_e||(_e={})),function(e){e[e.literal=0]="literal",e[e.argument=1]="argument",e[e.number=2]="number",e[e.date=3]="date",e[e.time=4]="time",e[e.select=5]="select",e[e.plural=6]="plural",e[e.pound=7]="pound",e[e.tag=8]="tag"}(Ie||(Ie={})),function(e){e[e.number=0]="number",e[e.dateTime=1]="dateTime"}(Ce||(Ce={}));var Ue=/[ \xA0\u1680\u2000-\u200A\u202F\u205F\u3000]/,Fe=/(?:[Eec]{1,6}|G{1,5}|[Qq]{1,5}|(?:[yYur]+|U{1,5})|[ML]{1,5}|d{1,2}|D{1,3}|F{1}|[abB]{1,5}|[hkHK]{1,2}|w{1,2}|W{1}|m{1,2}|s{1,2}|[zZOvVxX]{1,4})(?=([^']*'[^']*')*[^']*$)/g;function Ke(e){var t={};return e.replace(Fe,(function(e){var n=e.length;switch(e[0]){case"G":t.era=4===n?"long":5===n?"narrow":"short";break;case"y":t.year=2===n?"2-digit":"numeric";break;case"Y":case"u":case"U":case"r":throw new RangeError("`Y/u/U/r` (year) patterns are not supported, use `y` instead");case"q":case"Q":throw new RangeError("`q/Q` (quarter) patterns are not supported");case"M":case"L":t.month=["numeric","2-digit","short","long","narrow"][n-1];break;case"w":case"W":throw new RangeError("`w/W` (week) patterns are not supported");case"d":t.day=["numeric","2-digit"][n-1];break;case"D":case"F":case"g":throw new RangeError("`D/F/g` (day) patterns are not supported, use `d` instead");case"E":t.weekday=4===n?"short":5===n?"narrow":"short";break;case"e":if(n<4)throw new RangeError("`e..eee` (weekday) patterns are not supported");t.weekday=["short","long","narrow","short"][n-4];break;case"c":if(n<4)throw new RangeError("`c..ccc` (weekday) patterns are not supported");t.weekday=["short","long","narrow","short"][n-4];break;case"a":t.hour12=!0;break;case"b":case"B":throw new RangeError("`b/B` (period) patterns are not supported, use `a` instead");case"h":t.hourCycle="h12",t.hour=["numeric","2-digit"][n-1];break;case"H":t.hourCycle="h23",t.hour=["numeric","2-digit"][n-1];break;case"K":t.hourCycle="h11",t.hour=["numeric","2-digit"][n-1];break;case"k":t.hourCycle="h24",t.hour=["numeric","2-digit"][n-1];break;case"j":case"J":case"C":throw new RangeError("`j/J/C` (hour) patterns are not supported, use `h/H/K/k` instead");case"m":t.minute=["numeric","2-digit"][n-1];break;case"s":t.second=["numeric","2-digit"][n-1];break;case"S":case"A":throw new RangeError("`S/A` (second) patterns are not supported, use `s` instead");case"z":t.timeZoneName=n<4?"short":"long";break;case"Z":case"O":case"v":case"V":case"X":case"x":throw new RangeError("`Z/O/v/V/X/x` (timeZone) patterns are not supported, use `z` instead")}return""})),t}var je=/[\t-\r \x85\u200E\u200F\u2028\u2029]/i;var Ze,ze=/^\.(?:(0+)(\*)?|(#+)|(0+)(#+))$/g,Ve=/^(@+)?(\+|#+)?[rs]?$/g,He=/(\*)(0+)|(#+)(0+)|(0+)/g,qe=/^(0+)$/;function Ge(e){var t={};return"r"===e[e.length-1]?t.roundingPriority="morePrecision":"s"===e[e.length-1]&&(t.roundingPriority="lessPrecision"),e.replace(Ve,(function(e,n,r){return"string"!==typeof r?(t.minimumSignificantDigits=n.length,t.maximumSignificantDigits=n.length):"+"===r?t.minimumSignificantDigits=n.length:"#"===n[0]?t.maximumSignificantDigits=n.length:(t.minimumSignificantDigits=n.length,t.maximumSignificantDigits=n.length+("string"===typeof r?r.length:0)),""})),t}function We(e){switch(e){case"sign-auto":return{signDisplay:"auto"};case"sign-accounting":case"()":return{currencySign:"accounting"};case"sign-always":case"+!":return{signDisplay:"always"};case"sign-accounting-always":case"()!":return{signDisplay:"always",currencySign:"accounting"};case"sign-except-zero":case"+?":return{signDisplay:"exceptZero"};case"sign-accounting-except-zero":case"()?":return{signDisplay:"exceptZero",currencySign:"accounting"};case"sign-never":case"+_":return{signDisplay:"never"}}}function Qe(e){var t;if("E"===e[0]&&"E"===e[1]?(t={notation:"engineering"},e=e.slice(2)):"E"===e[0]&&(t={notation:"scientific"},e=e.slice(1)),t){var n=e.slice(0,2);if("+!"===n?(t.signDisplay="always",e=e.slice(2)):"+?"===n&&(t.signDisplay="exceptZero",e=e.slice(2)),!qe.test(e))throw new Error("Malformed concise eng/scientific notation");t.minimumIntegerDigits=e.length}return t}function Ye(e){var t=We(e);return t||{}}function Je(e){for(var t={},n=0,r=e;n<r.length;n++){var i=r[n];switch(i.stem){case"percent":case"%":t.style="percent";continue;case"%x100":t.style="percent",t.scale=100;continue;case"currency":t.style="currency",t.currency=i.options[0];continue;case"group-off":case",_":t.useGrouping=!1;continue;case"precision-integer":case".":t.maximumFractionDigits=0;continue;case"measure-unit":case"unit":t.style="unit",t.unit=i.options[0].replace(/^(.*?)-/,"");continue;case"compact-short":case"K":t.notation="compact",t.compactDisplay="short";continue;case"compact-long":case"KK":t.notation="compact",t.compactDisplay="long";continue;case"scientific":t=Ae(Ae(Ae({},t),{notation:"scientific"}),i.options.reduce((function(e,t){return Ae(Ae({},e),Ye(t))}),{}));continue;case"engineering":t=Ae(Ae(Ae({},t),{notation:"engineering"}),i.options.reduce((function(e,t){return Ae(Ae({},e),Ye(t))}),{}));continue;case"notation-simple":t.notation="standard";continue;case"unit-width-narrow":t.currencyDisplay="narrowSymbol",t.unitDisplay="narrow";continue;case"unit-width-short":t.currencyDisplay="code",t.unitDisplay="short";continue;case"unit-width-full-name":t.currencyDisplay="name",t.unitDisplay="long";continue;case"unit-width-iso-code":t.currencyDisplay="symbol";continue;case"scale":t.scale=parseFloat(i.options[0]);continue;case"integer-width":if(i.options.length>1)throw new RangeError("integer-width stems only accept a single optional option");i.options[0].replace(He,(function(e,n,r,i,o,s){if(n)t.minimumIntegerDigits=r.length;else{if(i&&o)throw new Error("We currently do not support maximum integer digits");if(s)throw new Error("We currently do not support exact integer digits")}return""}));continue}if(qe.test(i.stem))t.minimumIntegerDigits=i.stem.length;else if(ze.test(i.stem)){if(i.options.length>1)throw new RangeError("Fraction-precision stems only accept a single optional option");i.stem.replace(ze,(function(e,n,r,i,o,s){return"*"===r?t.minimumFractionDigits=n.length:i&&"#"===i[0]?t.maximumFractionDigits=i.length:o&&s?(t.minimumFractionDigits=o.length,t.maximumFractionDigits=o.length+s.length):(t.minimumFractionDigits=n.length,t.maximumFractionDigits=n.length),""}));var o=i.options[0];"w"===o?t=Ae(Ae({},t),{trailingZeroDisplay:"stripIfInteger"}):o&&(t=Ae(Ae({},t),Ge(o)))}else if(Ve.test(i.stem))t=Ae(Ae({},t),Ge(i.stem));else{var s=We(i.stem);s&&(t=Ae(Ae({},t),s));var a=Qe(i.stem);a&&(t=Ae(Ae({},t),a))}}return t}var Xe=new RegExp("^".concat(Ue.source,"*")),$e=new RegExp("".concat(Ue.source,"*$"));function et(e,t){return{start:e,end:t}}var tt=!!String.prototype.startsWith,nt=!!String.fromCodePoint,rt=!!Object.fromEntries,it=!!String.prototype.codePointAt,ot=!!String.prototype.trimStart,st=!!String.prototype.trimEnd,at=!!Number.isSafeInteger?Number.isSafeInteger:function(e){return"number"===typeof e&&isFinite(e)&&Math.floor(e)===e&&Math.abs(e)<=9007199254740991},ct=!0;try{ct="a"===(null===(Ze=yt("([^\\p{White_Space}\\p{Pattern_Syntax}]*)","yu").exec("a"))||void 0===Ze?void 0:Ze[0])}catch(Xn){ct=!1}var lt,ut=tt?function(e,t,n){return e.startsWith(t,n)}:function(e,t,n){return e.slice(n,n+t.length)===t},ht=nt?String.fromCodePoint:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n,r="",i=e.length,o=0;i>o;){if((n=e[o++])>1114111)throw RangeError(n+" is not a valid code point");r+=n<65536?String.fromCharCode(n):String.fromCharCode(55296+((n-=65536)>>10),n%1024+56320)}return r},dt=rt?Object.fromEntries:function(e){for(var t={},n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],s=i[1];t[o]=s}return t},ft=it?function(e,t){return e.codePointAt(t)}:function(e,t){var n=e.length;if(!(t<0||t>=n)){var r,i=e.charCodeAt(t);return i<55296||i>56319||t+1===n||(r=e.charCodeAt(t+1))<56320||r>57343?i:r-56320+(i-55296<<10)+65536}},pt=ot?function(e){return e.trimStart()}:function(e){return e.replace(Xe,"")},gt=st?function(e){return e.trimEnd()}:function(e){return e.replace($e,"")};function yt(e,t){return new RegExp(e,t)}if(ct){var mt=yt("([^\\p{White_Space}\\p{Pattern_Syntax}]*)","yu");lt=function(e,t){var n;return mt.lastIndex=t,null!==(n=mt.exec(e)[1])&&void 0!==n?n:""}}else lt=function(e,t){for(var n=[];;){var r=ft(e,t);if(void 0===r||wt(r)||Et(r))break;n.push(r),t+=r>=65536?2:1}return ht.apply(void 0,n)};var vt=function(){function e(e,t){void 0===t&&(t={}),this.message=e,this.position={offset:0,line:1,column:1},this.ignoreTag=!!t.ignoreTag,this.requiresOtherClause=!!t.requiresOtherClause,this.shouldParseSkeletons=!!t.shouldParseSkeletons}return e.prototype.parse=function(){if(0!==this.offset())throw Error("parser can only be used once");return this.parseMessage(0,"",!1)},e.prototype.parseMessage=function(e,t,n){for(var r=[];!this.isEOF();){var i=this.char();if(123===i){if((o=this.parseArgument(e,n)).err)return o;r.push(o.val)}else{if(125===i&&e>0)break;if(35!==i||"plural"!==t&&"selectordinal"!==t){if(60===i&&!this.ignoreTag&&47===this.peek()){if(n)break;return this.error(_e.UNMATCHED_CLOSING_TAG,et(this.clonePosition(),this.clonePosition()))}if(60===i&&!this.ignoreTag&&bt(this.peek()||0)){if((o=this.parseTag(e,t)).err)return o;r.push(o.val)}else{var o;if((o=this.parseLiteral(e,t)).err)return o;r.push(o.val)}}else{var s=this.clonePosition();this.bump(),r.push({type:Ie.pound,location:et(s,this.clonePosition())})}}}return{val:r,err:null}},e.prototype.parseTag=function(e,t){var n=this.clonePosition();this.bump();var r=this.parseTagName();if(this.bumpSpace(),this.bumpIf("/>"))return{val:{type:Ie.literal,value:"<".concat(r,"/>"),location:et(n,this.clonePosition())},err:null};if(this.bumpIf(">")){var i=this.parseMessage(e+1,t,!0);if(i.err)return i;var o=i.val,s=this.clonePosition();if(this.bumpIf("</")){if(this.isEOF()||!bt(this.char()))return this.error(_e.INVALID_TAG,et(s,this.clonePosition()));var a=this.clonePosition();return r!==this.parseTagName()?this.error(_e.UNMATCHED_CLOSING_TAG,et(a,this.clonePosition())):(this.bumpSpace(),this.bumpIf(">")?{val:{type:Ie.tag,value:r,children:o,location:et(n,this.clonePosition())},err:null}:this.error(_e.INVALID_TAG,et(s,this.clonePosition())))}return this.error(_e.UNCLOSED_TAG,et(n,this.clonePosition()))}return this.error(_e.INVALID_TAG,et(n,this.clonePosition()))},e.prototype.parseTagName=function(){var e,t=this.offset();for(this.bump();!this.isEOF()&&(45===(e=this.char())||46===e||e>=48&&e<=57||95===e||e>=97&&e<=122||e>=65&&e<=90||183==e||e>=192&&e<=214||e>=216&&e<=246||e>=248&&e<=893||e>=895&&e<=8191||e>=8204&&e<=8205||e>=8255&&e<=8256||e>=8304&&e<=8591||e>=11264&&e<=12271||e>=12289&&e<=55295||e>=63744&&e<=64975||e>=65008&&e<=65533||e>=65536&&e<=983039);)this.bump();return this.message.slice(t,this.offset())},e.prototype.parseLiteral=function(e,t){for(var n=this.clonePosition(),r="";;){var i=this.tryParseQuote(t);if(i)r+=i;else{var o=this.tryParseUnquoted(e,t);if(o)r+=o;else{var s=this.tryParseLeftAngleBracket();if(!s)break;r+=s}}}var a=et(n,this.clonePosition());return{val:{type:Ie.literal,value:r,location:a},err:null}},e.prototype.tryParseLeftAngleBracket=function(){return this.isEOF()||60!==this.char()||!this.ignoreTag&&(bt(e=this.peek()||0)||47===e)?null:(this.bump(),"<");var e},e.prototype.tryParseQuote=function(e){if(this.isEOF()||39!==this.char())return null;switch(this.peek()){case 39:return this.bump(),this.bump(),"'";case 123:case 60:case 62:case 125:break;case 35:if("plural"===e||"selectordinal"===e)break;return null;default:return null}this.bump();var t=[this.char()];for(this.bump();!this.isEOF();){var n=this.char();if(39===n){if(39!==this.peek()){this.bump();break}t.push(39),this.bump()}else t.push(n);this.bump()}return ht.apply(void 0,t)},e.prototype.tryParseUnquoted=function(e,t){if(this.isEOF())return null;var n=this.char();return 60===n||123===n||35===n&&("plural"===t||"selectordinal"===t)||125===n&&e>0?null:(this.bump(),ht(n))},e.prototype.parseArgument=function(e,t){var n=this.clonePosition();if(this.bump(),this.bumpSpace(),this.isEOF())return this.error(_e.EXPECT_ARGUMENT_CLOSING_BRACE,et(n,this.clonePosition()));if(125===this.char())return this.bump(),this.error(_e.EMPTY_ARGUMENT,et(n,this.clonePosition()));var r=this.parseIdentifierIfPossible().value;if(!r)return this.error(_e.MALFORMED_ARGUMENT,et(n,this.clonePosition()));if(this.bumpSpace(),this.isEOF())return this.error(_e.EXPECT_ARGUMENT_CLOSING_BRACE,et(n,this.clonePosition()));switch(this.char()){case 125:return this.bump(),{val:{type:Ie.argument,value:r,location:et(n,this.clonePosition())},err:null};case 44:return this.bump(),this.bumpSpace(),this.isEOF()?this.error(_e.EXPECT_ARGUMENT_CLOSING_BRACE,et(n,this.clonePosition())):this.parseArgumentOptions(e,t,r,n);default:return this.error(_e.MALFORMED_ARGUMENT,et(n,this.clonePosition()))}},e.prototype.parseIdentifierIfPossible=function(){var e=this.clonePosition(),t=this.offset(),n=lt(this.message,t),r=t+n.length;return this.bumpTo(r),{value:n,location:et(e,this.clonePosition())}},e.prototype.parseArgumentOptions=function(e,t,n,r){var i,o=this.clonePosition(),s=this.parseIdentifierIfPossible().value,a=this.clonePosition();switch(s){case"":return this.error(_e.EXPECT_ARGUMENT_TYPE,et(o,a));case"number":case"date":case"time":this.bumpSpace();var c=null;if(this.bumpIf(",")){this.bumpSpace();var l=this.clonePosition();if((y=this.parseSimpleArgStyleIfPossible()).err)return y;if(0===(d=gt(y.val)).length)return this.error(_e.EXPECT_ARGUMENT_STYLE,et(this.clonePosition(),this.clonePosition()));c={style:d,styleLocation:et(l,this.clonePosition())}}if((m=this.tryParseArgumentClose(r)).err)return m;var u=et(r,this.clonePosition());if(c&&ut(null===c||void 0===c?void 0:c.style,"::",0)){var h=pt(c.style.slice(2));if("number"===s)return(y=this.parseNumberSkeletonFromString(h,c.styleLocation)).err?y:{val:{type:Ie.number,value:n,location:u,style:y.val},err:null};if(0===h.length)return this.error(_e.EXPECT_DATE_TIME_SKELETON,u);var d={type:Ce.dateTime,pattern:h,location:c.styleLocation,parsedOptions:this.shouldParseSkeletons?Ke(h):{}};return{val:{type:"date"===s?Ie.date:Ie.time,value:n,location:u,style:d},err:null}}return{val:{type:"number"===s?Ie.number:"date"===s?Ie.date:Ie.time,value:n,location:u,style:null!==(i=null===c||void 0===c?void 0:c.style)&&void 0!==i?i:null},err:null};case"plural":case"selectordinal":case"select":var f=this.clonePosition();if(this.bumpSpace(),!this.bumpIf(","))return this.error(_e.EXPECT_SELECT_ARGUMENT_OPTIONS,et(f,Ae({},f)));this.bumpSpace();var p=this.parseIdentifierIfPossible(),g=0;if("select"!==s&&"offset"===p.value){if(!this.bumpIf(":"))return this.error(_e.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE,et(this.clonePosition(),this.clonePosition()));var y;if(this.bumpSpace(),(y=this.tryParseDecimalInteger(_e.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE,_e.INVALID_PLURAL_ARGUMENT_OFFSET_VALUE)).err)return y;this.bumpSpace(),p=this.parseIdentifierIfPossible(),g=y.val}var m,v=this.tryParsePluralOrSelectOptions(e,s,t,p);if(v.err)return v;if((m=this.tryParseArgumentClose(r)).err)return m;var b=et(r,this.clonePosition());return"select"===s?{val:{type:Ie.select,value:n,options:dt(v.val),location:b},err:null}:{val:{type:Ie.plural,value:n,options:dt(v.val),offset:g,pluralType:"plural"===s?"cardinal":"ordinal",location:b},err:null};default:return this.error(_e.INVALID_ARGUMENT_TYPE,et(o,a))}},e.prototype.tryParseArgumentClose=function(e){return this.isEOF()||125!==this.char()?this.error(_e.EXPECT_ARGUMENT_CLOSING_BRACE,et(e,this.clonePosition())):(this.bump(),{val:!0,err:null})},e.prototype.parseSimpleArgStyleIfPossible=function(){for(var e=0,t=this.clonePosition();!this.isEOF();){switch(this.char()){case 39:this.bump();var n=this.clonePosition();if(!this.bumpUntil("'"))return this.error(_e.UNCLOSED_QUOTE_IN_ARGUMENT_STYLE,et(n,this.clonePosition()));this.bump();break;case 123:e+=1,this.bump();break;case 125:if(!(e>0))return{val:this.message.slice(t.offset,this.offset()),err:null};e-=1;break;default:this.bump()}}return{val:this.message.slice(t.offset,this.offset()),err:null}},e.prototype.parseNumberSkeletonFromString=function(e,t){var n=[];try{n=function(e){if(0===e.length)throw new Error("Number skeleton cannot be empty");for(var t=[],n=0,r=e.split(je).filter((function(e){return e.length>0}));n<r.length;n++){var i=r[n].split("/");if(0===i.length)throw new Error("Invalid number skeleton");for(var o=i[0],s=i.slice(1),a=0,c=s;a<c.length;a++)if(0===c[a].length)throw new Error("Invalid number skeleton");t.push({stem:o,options:s})}return t}(e)}catch(r){return this.error(_e.INVALID_NUMBER_SKELETON,t)}return{val:{type:Ce.number,tokens:n,location:t,parsedOptions:this.shouldParseSkeletons?Je(n):{}},err:null}},e.prototype.tryParsePluralOrSelectOptions=function(e,t,n,r){for(var i,o=!1,s=[],a=new Set,c=r.value,l=r.location;;){if(0===c.length){var u=this.clonePosition();if("select"===t||!this.bumpIf("="))break;var h=this.tryParseDecimalInteger(_e.EXPECT_PLURAL_ARGUMENT_SELECTOR,_e.INVALID_PLURAL_ARGUMENT_SELECTOR);if(h.err)return h;l=et(u,this.clonePosition()),c=this.message.slice(u.offset,this.offset())}if(a.has(c))return this.error("select"===t?_e.DUPLICATE_SELECT_ARGUMENT_SELECTOR:_e.DUPLICATE_PLURAL_ARGUMENT_SELECTOR,l);"other"===c&&(o=!0),this.bumpSpace();var d=this.clonePosition();if(!this.bumpIf("{"))return this.error("select"===t?_e.EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT:_e.EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT,et(this.clonePosition(),this.clonePosition()));var f=this.parseMessage(e+1,t,n);if(f.err)return f;var p=this.tryParseArgumentClose(d);if(p.err)return p;s.push([c,{value:f.val,location:et(d,this.clonePosition())}]),a.add(c),this.bumpSpace(),c=(i=this.parseIdentifierIfPossible()).value,l=i.location}return 0===s.length?this.error("select"===t?_e.EXPECT_SELECT_ARGUMENT_SELECTOR:_e.EXPECT_PLURAL_ARGUMENT_SELECTOR,et(this.clonePosition(),this.clonePosition())):this.requiresOtherClause&&!o?this.error(_e.MISSING_OTHER_CLAUSE,et(this.clonePosition(),this.clonePosition())):{val:s,err:null}},e.prototype.tryParseDecimalInteger=function(e,t){var n=1,r=this.clonePosition();this.bumpIf("+")||this.bumpIf("-")&&(n=-1);for(var i=!1,o=0;!this.isEOF();){var s=this.char();if(!(s>=48&&s<=57))break;i=!0,o=10*o+(s-48),this.bump()}var a=et(r,this.clonePosition());return i?at(o*=n)?{val:o,err:null}:this.error(t,a):this.error(e,a)},e.prototype.offset=function(){return this.position.offset},e.prototype.isEOF=function(){return this.offset()===this.message.length},e.prototype.clonePosition=function(){return{offset:this.position.offset,line:this.position.line,column:this.position.column}},e.prototype.char=function(){var e=this.position.offset;if(e>=this.message.length)throw Error("out of bound");var t=ft(this.message,e);if(void 0===t)throw Error("Offset ".concat(e," is at invalid UTF-16 code unit boundary"));return t},e.prototype.error=function(e,t){return{val:null,err:{kind:e,message:this.message,location:t}}},e.prototype.bump=function(){if(!this.isEOF()){var e=this.char();10===e?(this.position.line+=1,this.position.column=1,this.position.offset+=1):(this.position.column+=1,this.position.offset+=e<65536?1:2)}},e.prototype.bumpIf=function(e){if(ut(this.message,e,this.offset())){for(var t=0;t<e.length;t++)this.bump();return!0}return!1},e.prototype.bumpUntil=function(e){var t=this.offset(),n=this.message.indexOf(e,t);return n>=0?(this.bumpTo(n),!0):(this.bumpTo(this.message.length),!1)},e.prototype.bumpTo=function(e){if(this.offset()>e)throw Error("targetOffset ".concat(e," must be greater than or equal to the current offset ").concat(this.offset()));for(e=Math.min(e,this.message.length);;){var t=this.offset();if(t===e)break;if(t>e)throw Error("targetOffset ".concat(e," is at invalid UTF-16 code unit boundary"));if(this.bump(),this.isEOF())break}},e.prototype.bumpSpace=function(){for(;!this.isEOF()&&wt(this.char());)this.bump()},e.prototype.peek=function(){if(this.isEOF())return null;var e=this.char(),t=this.offset(),n=this.message.charCodeAt(t+(e>=65536?2:1));return null!==n&&void 0!==n?n:null},e}();function bt(e){return e>=97&&e<=122||e>=65&&e<=90}function wt(e){return e>=9&&e<=13||32===e||133===e||e>=8206&&e<=8207||8232===e||8233===e}function Et(e){return e>=33&&e<=35||36===e||e>=37&&e<=39||40===e||41===e||42===e||43===e||44===e||45===e||e>=46&&e<=47||e>=58&&e<=59||e>=60&&e<=62||e>=63&&e<=64||91===e||92===e||93===e||94===e||96===e||123===e||124===e||125===e||126===e||161===e||e>=162&&e<=165||166===e||167===e||169===e||171===e||172===e||174===e||176===e||177===e||182===e||187===e||191===e||215===e||247===e||e>=8208&&e<=8213||e>=8214&&e<=8215||8216===e||8217===e||8218===e||e>=8219&&e<=8220||8221===e||8222===e||8223===e||e>=8224&&e<=8231||e>=8240&&e<=8248||8249===e||8250===e||e>=8251&&e<=8254||e>=8257&&e<=8259||8260===e||8261===e||8262===e||e>=8263&&e<=8273||8274===e||8275===e||e>=8277&&e<=8286||e>=8592&&e<=8596||e>=8597&&e<=8601||e>=8602&&e<=8603||e>=8604&&e<=8607||8608===e||e>=8609&&e<=8610||8611===e||e>=8612&&e<=8613||8614===e||e>=8615&&e<=8621||8622===e||e>=8623&&e<=8653||e>=8654&&e<=8655||e>=8656&&e<=8657||8658===e||8659===e||8660===e||e>=8661&&e<=8691||e>=8692&&e<=8959||e>=8960&&e<=8967||8968===e||8969===e||8970===e||8971===e||e>=8972&&e<=8991||e>=8992&&e<=8993||e>=8994&&e<=9e3||9001===e||9002===e||e>=9003&&e<=9083||9084===e||e>=9085&&e<=9114||e>=9115&&e<=9139||e>=9140&&e<=9179||e>=9180&&e<=9185||e>=9186&&e<=9254||e>=9255&&e<=9279||e>=9280&&e<=9290||e>=9291&&e<=9311||e>=9472&&e<=9654||9655===e||e>=9656&&e<=9664||9665===e||e>=9666&&e<=9719||e>=9720&&e<=9727||e>=9728&&e<=9838||9839===e||e>=9840&&e<=10087||10088===e||10089===e||10090===e||10091===e||10092===e||10093===e||10094===e||10095===e||10096===e||10097===e||10098===e||10099===e||10100===e||10101===e||e>=10132&&e<=10175||e>=10176&&e<=10180||10181===e||10182===e||e>=10183&&e<=10213||10214===e||10215===e||10216===e||10217===e||10218===e||10219===e||10220===e||10221===e||10222===e||10223===e||e>=10224&&e<=10239||e>=10240&&e<=10495||e>=10496&&e<=10626||10627===e||10628===e||10629===e||10630===e||10631===e||10632===e||10633===e||10634===e||10635===e||10636===e||10637===e||10638===e||10639===e||10640===e||10641===e||10642===e||10643===e||10644===e||10645===e||10646===e||10647===e||10648===e||e>=10649&&e<=10711||10712===e||10713===e||10714===e||10715===e||e>=10716&&e<=10747||10748===e||10749===e||e>=10750&&e<=11007||e>=11008&&e<=11055||e>=11056&&e<=11076||e>=11077&&e<=11078||e>=11079&&e<=11084||e>=11085&&e<=11123||e>=11124&&e<=11125||e>=11126&&e<=11157||11158===e||e>=11159&&e<=11263||e>=11776&&e<=11777||11778===e||11779===e||11780===e||11781===e||e>=11782&&e<=11784||11785===e||11786===e||11787===e||11788===e||11789===e||e>=11790&&e<=11798||11799===e||e>=11800&&e<=11801||11802===e||11803===e||11804===e||11805===e||e>=11806&&e<=11807||11808===e||11809===e||11810===e||11811===e||11812===e||11813===e||11814===e||11815===e||11816===e||11817===e||e>=11818&&e<=11822||11823===e||e>=11824&&e<=11833||e>=11834&&e<=11835||e>=11836&&e<=11839||11840===e||11841===e||11842===e||e>=11843&&e<=11855||e>=11856&&e<=11857||11858===e||e>=11859&&e<=11903||e>=12289&&e<=12291||12296===e||12297===e||12298===e||12299===e||12300===e||12301===e||12302===e||12303===e||12304===e||12305===e||e>=12306&&e<=12307||12308===e||12309===e||12310===e||12311===e||12312===e||12313===e||12314===e||12315===e||12316===e||12317===e||e>=12318&&e<=12319||12320===e||12336===e||64830===e||64831===e||e>=65093&&e<=65094}function At(e){e.forEach((function(e){if(delete e.location,De(e)||Oe(e))for(var t in e.options)delete e.options[t].location,At(e.options[t].value);else Re(e)&&Le(e.style)||(xe(e)||Pe(e))&&Me(e.style)?delete e.style.location:Be(e)&&At(e.children)}))}function St(e,t){void 0===t&&(t={}),t=Ae({shouldParseSkeletons:!0,requiresOtherClause:!0},t);var n=new vt(e,t).parse();if(n.err){var r=SyntaxError(_e[n.err.kind]);throw r.location=n.err.location,r.originalMessage=n.err.message,r}return(null===t||void 0===t?void 0:t.captureLocation)||At(n.val),n.val}function _t(e,t){var n=t&&t.cache?t.cache:Dt,r=t&&t.serializer?t.serializer:Rt;return(t&&t.strategy?t.strategy:kt)(e,{cache:n,serializer:r})}function It(e,t,n,r){var i,o=null==(i=r)||"number"===typeof i||"boolean"===typeof i?r:n(r),s=t.get(o);return"undefined"===typeof s&&(s=e.call(this,r),t.set(o,s)),s}function Ct(e,t,n){var r=Array.prototype.slice.call(arguments,3),i=n(r),o=t.get(i);return"undefined"===typeof o&&(o=e.apply(this,r),t.set(i,o)),o}function Tt(e,t,n,r,i){return n.bind(t,e,r,i)}function kt(e,t){return Tt(e,this,1===e.length?It:Ct,t.cache.create(),t.serializer)}var Rt=function(){return JSON.stringify(arguments)};function xt(){this.cache=Object.create(null)}xt.prototype.get=function(e){return this.cache[e]},xt.prototype.set=function(e,t){this.cache[e]=t};var Pt,Dt={create:function(){return new xt}},Ot={variadic:function(e,t){return Tt(e,this,Ct,t.cache.create(),t.serializer)},monadic:function(e,t){return Tt(e,this,It,t.cache.create(),t.serializer)}};!function(e){e.MISSING_VALUE="MISSING_VALUE",e.INVALID_VALUE="INVALID_VALUE",e.MISSING_INTL_API="MISSING_INTL_API"}(Pt||(Pt={}));var Nt,Bt=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.code=n,i.originalMessage=r,i}return Ee(t,e),t.prototype.toString=function(){return"[formatjs Error: ".concat(this.code,"] ").concat(this.message)},t}(Error),Lt=function(e){function t(t,n,r,i){return e.call(this,'Invalid values for "'.concat(t,'": "').concat(n,'". Options are "').concat(Object.keys(r).join('", "'),'"'),Pt.INVALID_VALUE,i)||this}return Ee(t,e),t}(Bt),Mt=function(e){function t(t,n,r){return e.call(this,'Value for "'.concat(t,'" must be of type ').concat(n),Pt.INVALID_VALUE,r)||this}return Ee(t,e),t}(Bt),Ut=function(e){function t(t,n){return e.call(this,'The intl string context variable "'.concat(t,'" was not provided to the string "').concat(n,'"'),Pt.MISSING_VALUE,n)||this}return Ee(t,e),t}(Bt);function Ft(e){return"function"===typeof e}function Kt(e,t,n,r,i,o,s){if(1===e.length&&Te(e[0]))return[{type:Nt.literal,value:e[0].value}];for(var a=[],c=0,l=e;c<l.length;c++){var u=l[c];if(Te(u))a.push({type:Nt.literal,value:u.value});else if(Ne(u))"number"===typeof o&&a.push({type:Nt.literal,value:n.getNumberFormat(t).format(o)});else{var h=u.value;if(!i||!(h in i))throw new Ut(h,s);var d=i[h];if(ke(u))d&&"string"!==typeof d&&"number"!==typeof d||(d="string"===typeof d||"number"===typeof d?String(d):""),a.push({type:"string"===typeof d?Nt.literal:Nt.object,value:d});else if(xe(u)){var f="string"===typeof u.style?r.date[u.style]:Me(u.style)?u.style.parsedOptions:void 0;a.push({type:Nt.literal,value:n.getDateTimeFormat(t,f).format(d)})}else if(Pe(u)){f="string"===typeof u.style?r.time[u.style]:Me(u.style)?u.style.parsedOptions:r.time.medium;a.push({type:Nt.literal,value:n.getDateTimeFormat(t,f).format(d)})}else if(Re(u)){(f="string"===typeof u.style?r.number[u.style]:Le(u.style)?u.style.parsedOptions:void 0)&&f.scale&&(d*=f.scale||1),a.push({type:Nt.literal,value:n.getNumberFormat(t,f).format(d)})}else{if(Be(u)){var p=u.children,g=u.value,y=i[g];if(!Ft(y))throw new Mt(g,"function",s);var m=y(Kt(p,t,n,r,i,o).map((function(e){return e.value})));Array.isArray(m)||(m=[m]),a.push.apply(a,m.map((function(e){return{type:"string"===typeof e?Nt.literal:Nt.object,value:e}})))}if(De(u)){if(!(v=u.options[d]||u.options.other))throw new Lt(u.value,d,Object.keys(u.options),s);a.push.apply(a,Kt(v.value,t,n,r,i))}else if(Oe(u)){var v;if(!(v=u.options["=".concat(d)])){if(!Intl.PluralRules)throw new Bt('Intl.PluralRules is not available in this environment.\nTry polyfilling it using "@formatjs/intl-pluralrules"\n',Pt.MISSING_INTL_API,s);var b=n.getPluralRules(t,{type:u.pluralType}).select(d-(u.offset||0));v=u.options[b]||u.options.other}if(!v)throw new Lt(u.value,d,Object.keys(u.options),s);a.push.apply(a,Kt(v.value,t,n,r,i,d-(u.offset||0)))}else;}}}return function(e){return e.length<2?e:e.reduce((function(e,t){var n=e[e.length-1];return n&&n.type===Nt.literal&&t.type===Nt.literal?n.value+=t.value:e.push(t),e}),[])}(a)}function jt(e,t){return t?Object.keys(e).reduce((function(n,r){var i,o;return n[r]=(i=e[r],(o=t[r])?Ae(Ae(Ae({},i||{}),o||{}),Object.keys(i).reduce((function(e,t){return e[t]=Ae(Ae({},i[t]),o[t]||{}),e}),{})):i),n}),Ae({},e)):e}function Zt(e){return{create:function(){return{get:function(t){return e[t]},set:function(t,n){e[t]=n}}}}}!function(e){e[e.literal=0]="literal",e[e.object=1]="object"}(Nt||(Nt={}));var zt=function(){function e(t,n,r,i){var o,s=this;if(void 0===n&&(n=e.defaultLocale),this.formatterCache={number:{},dateTime:{},pluralRules:{}},this.format=function(e){var t=s.formatToParts(e);if(1===t.length)return t[0].value;var n=t.reduce((function(e,t){return e.length&&t.type===Nt.literal&&"string"===typeof e[e.length-1]?e[e.length-1]+=t.value:e.push(t.value),e}),[]);return n.length<=1?n[0]||"":n},this.formatToParts=function(e){return Kt(s.ast,s.locales,s.formatters,s.formats,e,void 0,s.message)},this.resolvedOptions=function(){return{locale:Intl.NumberFormat.supportedLocalesOf(s.locales)[0]}},this.getAst=function(){return s.ast},"string"===typeof t){if(this.message=t,!e.__parse)throw new TypeError("IntlMessageFormat.__parse must be set to process `message` of type `string`");this.ast=e.__parse(t,{ignoreTag:null===i||void 0===i?void 0:i.ignoreTag})}else this.ast=t;if(!Array.isArray(this.ast))throw new TypeError("A message must be provided as a String or AST.");this.formats=jt(e.formats,r),this.locales=n,this.formatters=i&&i.formatters||(void 0===(o=this.formatterCache)&&(o={number:{},dateTime:{},pluralRules:{}}),{getNumberFormat:_t((function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return new((e=Intl.NumberFormat).bind.apply(e,Se([void 0],t,!1)))}),{cache:Zt(o.number),strategy:Ot.variadic}),getDateTimeFormat:_t((function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return new((e=Intl.DateTimeFormat).bind.apply(e,Se([void 0],t,!1)))}),{cache:Zt(o.dateTime),strategy:Ot.variadic}),getPluralRules:_t((function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return new((e=Intl.PluralRules).bind.apply(e,Se([void 0],t,!1)))}),{cache:Zt(o.pluralRules),strategy:Ot.variadic})})}return Object.defineProperty(e,"defaultLocale",{get:function(){return e.memoizedDefaultLocale||(e.memoizedDefaultLocale=(new Intl.NumberFormat).resolvedOptions().locale),e.memoizedDefaultLocale},enumerable:!1,configurable:!0}),e.memoizedDefaultLocale=null,e.__parse=St,e.formats={number:{integer:{maximumFractionDigits:0},currency:{style:"currency"},percent:{style:"percent"}},date:{short:{month:"numeric",day:"numeric",year:"2-digit"},medium:{month:"short",day:"numeric",year:"numeric"},long:{month:"long",day:"numeric",year:"numeric"},full:{weekday:"long",month:"long",day:"numeric",year:"numeric"}},time:{short:{hour:"numeric",minute:"numeric"},medium:{hour:"numeric",minute:"numeric",second:"numeric"},long:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"},full:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"}}},e}();const Vt=zt;function Ht(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ht(Object(n),!0).forEach((function(t){Gt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ht(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Gt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Wt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Qt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type="i18nFormat",this.mem={},this.init(null,t)}var t,n,r;return t=e,n=[{key:"init",value:function(e,t){var n=this,r=e&&e.options&&e.options.i18nFormat||{};if(this.options=function(e){return ve.call(be.call(arguments,1),(function(t){if(t)for(var n in t)void 0===e[n]&&(e[n]=t[n])})),e}(r,t,this.options||{},{memoize:!0,memoizeFallback:!1,bindI18n:"",bindI18nStore:"",parseErrorHandler:function(e,t,n,r){return n}}),this.formats=this.options.formats,e){var i=this.options,o=i.bindI18n,s=i.bindI18nStore,a=i.memoize;e.IntlMessageFormat=Vt,e.ICU=this,a&&(o&&e.on(o,(function(){return n.clearCache()})),s&&e.store.on(s,(function(){return n.clearCache()})))}}},{key:"addUserDefinedFormats",value:function(e){this.formats=this.formats?qt(qt({},this.formats),e):e}},{key:"parse",value:function(e,t,n,r,i,o){var s,a=o&&o.resolved&&o.resolved.res,c=this.options.memoize&&"".concat(n,".").concat(r,".").concat(i.replace(/\./g,"###"));this.options.memoize&&(s=function(e,t){var n=ye(e,t),r=n.obj,i=n.k;if(r)return r[i]}(this.mem,c));try{return s||(s=new Vt(e,n,this.formats,{ignoreTag:!0}),this.options.memoize&&(this.options.memoizeFallback||!o||a)&&function(e,t,n){var r=ye(e,t,Object);r.obj[r.k]=n}(this.mem,c,s)),s.format(t)}catch(l){return this.options.parseErrorHandler(l,i,e,t)}}},{key:"addLookupKeys",value:function(e,t,n,r,i){return e}},{key:"clearCache",value:function(){this.mem={}}}],n&&Wt(t.prototype,n),r&&Wt(t,r),e}();Qt.type="i18nFormat";const Yt=Qt;var Jt=[],Xt=Jt.forEach,$t=Jt.slice;var en=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,i.Z)(this,e),this.backends=[],this.type="backend",this.init(t,n)}return(0,o.Z)(e,[{key:"init",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;this.services=e,this.options=function(e){return Xt.call($t.call(arguments,1),(function(t){if(t)for(var n in t)void 0===e[n]&&(e[n]=t[n])})),e}(n,this.options||{},{handleEmptyResourcesAsFailed:!0}),this.options.backends&&this.options.backends.forEach((function(n,i){var o;t.backends[i]=t.backends[i]||((o=n)?"function"===typeof o?new o:o:null),t.backends[i].init(e,t.options.backendOptions&&t.options.backendOptions[i]||{},r)}))}},{key:"read",value:function(e,t,n){var r=this,i=this.backends.length,o=function n(i,o){if(!(i<0)){var s=r.backends[i];s.save?(s.save(e,t,o),n(i-1,o)):n(i-1,o)}};!function s(a){if(a>=i)return n(new Error("non of the backend loaded data;",!0));var c=a===i-1,l=r.options.handleEmptyResourcesAsFailed&&!c?0:-1,u=r.backends[a];u.read?u.read(e,t,(function(e,t){!e&&t&&Object.keys(t).length>l?(n(null,t,a),o(a-1,t)):s(a+1)})):s(a+1)}(0)}},{key:"create",value:function(e,t,n,r,i,o){this.backends.forEach((function(i){i.create&&i.create(e,t,n,r,null,o)}))}}]),e}();function tn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function nn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tn(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}en.type="backend";var rn=function(){function e(t){(0,i.Z)(this,e),this.store=t.store}return(0,o.Z)(e,[{key:"setItem",value:function(e,t){if(this.store)try{this.store.setItem(e,t)}catch(n){}}},{key:"getItem",value:function(e,t){if(this.store)try{return this.store.getItem(e,t)}catch(n){}}}]),e}();var on=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,i.Z)(this,e),this.init(t,n),this.type="backend"}return(0,o.Z)(e,[{key:"init",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.services=e,this.options=nn(nn(nn({},{prefix:"i18next_res_",expirationTime:6048e5,defaultVersion:void 0,versions:{},store:"undefined"!==typeof window?window.localStorage:null}),this.options),t),this.storage=new rn(this.options)}},{key:"read",value:function(e,t,n){var r=(new Date).getTime();if(!this.storage.store)return n(null,null);var i=this.storage.getItem("".concat(this.options.prefix).concat(e,"-").concat(t));if(i){i=JSON.parse(i);var o=this.getVersion(e);if(i.i18nStamp&&i.i18nStamp+this.options.expirationTime>r&&o===i.i18nVersion)return delete i.i18nVersion,delete i.i18nStamp,n(null,i)}return n(null,null)}},{key:"save",value:function(e,t,n){if(this.storage.store){n.i18nStamp=(new Date).getTime();var r=this.getVersion(e);r&&(n.i18nVersion=r),this.storage.setItem("".concat(this.options.prefix).concat(e,"-").concat(t),JSON.stringify(n))}}},{key:"getVersion",value:function(e){return this.options.versions[e]||this.options.defaultVersion}}]),e}();on.type="backend";const sn=on;function an(e){return an="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},an(e)}var cn=[],ln=cn.forEach,un=cn.slice;function hn(e){return ln.call(un.call(arguments,1),(function(t){if(t)for(var n in t)void 0===e[n]&&(e[n]=t[n])})),e}function dn(){return"function"===typeof XMLHttpRequest||"object"===("undefined"===typeof XMLHttpRequest?"undefined":an(XMLHttpRequest))}const fn=n.p+"static/media/getFetch.40f37ddea2378391108f.cjs";var pn,gn,yn,mn=n.t(fn);function vn(e){return vn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vn(e)}"function"===typeof fetch&&(pn="undefined"!==typeof n.g&&n.g.fetch?n.g.fetch:"undefined"!==typeof window&&window.fetch?window.fetch:fetch),dn()&&("undefined"!==typeof n.g&&n.g.XMLHttpRequest?gn=n.g.XMLHttpRequest:"undefined"!==typeof window&&window.XMLHttpRequest&&(gn=window.XMLHttpRequest)),"function"===typeof ActiveXObject&&("undefined"!==typeof n.g&&n.g.ActiveXObject?yn=n.g.ActiveXObject:"undefined"!==typeof window&&window.ActiveXObject&&(yn=window.ActiveXObject)),pn||!mn||gn||yn||(pn=fn||mn),"function"!==typeof pn&&(pn=void 0);var bn=function(e,t){if(t&&"object"===vn(t)){var n="";for(var r in t)n+="&"+encodeURIComponent(r)+"="+encodeURIComponent(t[r]);if(!n)return e;e=e+(-1!==e.indexOf("?")?"&":"?")+n.slice(1)}return e},wn=function(e,t,n){pn(e,t).then((function(e){if(!e.ok)return n(e.statusText||"Error",{status:e.status});e.text().then((function(t){n(null,{status:e.status,data:t})})).catch(n)})).catch(n)},En=!1;const An=function(e,t,n,r){return"function"===typeof n&&(r=n,n=void 0),r=r||function(){},pn?function(e,t,n,r){e.queryStringParams&&(t=bn(t,e.queryStringParams));var i=hn({},"function"===typeof e.customHeaders?e.customHeaders():e.customHeaders);n&&(i["Content-Type"]="application/json");var o="function"===typeof e.requestOptions?e.requestOptions(n):e.requestOptions,s=hn({method:n?"POST":"GET",body:n?e.stringify(n):void 0,headers:i},En?{}:o);try{wn(t,s,r)}catch(a){if(!o||0===Object.keys(o).length||!a.message||a.message.indexOf("not implemented")<0)return r(a);try{Object.keys(o).forEach((function(e){delete s[e]})),wn(t,s,r),En=!0}catch(c){r(c)}}}(e,t,n,r):dn()||"function"===typeof ActiveXObject?function(e,t,n,r){n&&"object"===vn(n)&&(n=bn("",n).slice(1)),e.queryStringParams&&(t=bn(t,e.queryStringParams));try{var i;(i=gn?new gn:new yn("MSXML2.XMLHTTP.3.0")).open(n?"POST":"GET",t,1),e.crossDomain||i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.withCredentials=!!e.withCredentials,n&&i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.overrideMimeType&&i.overrideMimeType("application/json");var o=e.customHeaders;if(o="function"===typeof o?o():o)for(var s in o)i.setRequestHeader(s,o[s]);i.onreadystatechange=function(){i.readyState>3&&r(i.status>=400?i.statusText:null,{status:i.status,data:i.responseText})},i.send(n)}catch(a){console&&console.log(a)}}(e,t,n,r):void r(new Error("No fetch and no xhr implementation found!"))};function Sn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var _n=function(){return{loadPath:"/locales/{{lng}}/{{ns}}.json",addPath:"/locales/add/{{lng}}/{{ns}}",allowMultiLoading:!1,parse:function(e){return JSON.parse(e)},stringify:JSON.stringify,parsePayload:function(e,t,n){return function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},t,n||"")},request:An,reloadInterval:"undefined"===typeof window&&36e5,customHeaders:{},queryStringParams:{},crossDomain:!1,withCredentials:!1,overrideMimeType:!1,requestOptions:{mode:"cors",credentials:"same-origin",cache:"default"}}},In=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.services=t,this.options=n,this.allOptions=r,this.type="backend",this.init(t,n,r)}var t,n,r;return t=e,n=[{key:"init",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.services=e,this.options=hn(n,this.options||{},_n()),this.allOptions=r,this.services&&this.options.reloadInterval&&setInterval((function(){return t.reload()}),this.options.reloadInterval)}},{key:"readMulti",value:function(e,t,n){this._readAny(e,e,t,t,n)}},{key:"read",value:function(e,t,n){this._readAny([e],e,[t],t,n)}},{key:"_readAny",value:function(e,t,n,r,i){var o,s=this,a=this.options.loadPath;"function"===typeof this.options.loadPath&&(a=this.options.loadPath(e,n)),(a=function(e){return!!e&&"function"===typeof e.then}(o=a)?o:Promise.resolve(o)).then((function(o){if(!o)return i(null,{});var a=s.services.interpolator.interpolate(o,{lng:e.join("+"),ns:n.join("+")});s.loadUrl(a,i,t,r)}))}},{key:"loadUrl",value:function(e,t,n,r){var i=this;this.options.request(this.options,e,void 0,(function(o,s){if(s&&(s.status>=500&&s.status<600||!s.status))return t("failed loading "+e+"; status code: "+s.status,!0);if(s&&s.status>=400&&s.status<500)return t("failed loading "+e+"; status code: "+s.status,!1);if(!s&&o&&o.message&&o.message.indexOf("Failed to fetch")>-1)return t("failed loading "+e+": "+o.message,!0);if(o)return t(o,!1);var a,c;try{a="string"===typeof s.data?i.options.parse(s.data,n,r):s.data}catch(l){c="failed parsing "+e+" to json"}if(c)return t(c,!1);t(null,a)}))}},{key:"create",value:function(e,t,n,r,i){var o=this;if(this.options.addPath){"string"===typeof e&&(e=[e]);var s=this.options.parsePayload(t,n,r),a=0,c=[],l=[];e.forEach((function(n){var r=o.options.addPath;"function"===typeof o.options.addPath&&(r=o.options.addPath(n,t));var u=o.services.interpolator.interpolate(r,{lng:n,ns:t});o.options.request(o.options,u,s,(function(t,n){a+=1,c.push(t),l.push(n),a===e.length&&i&&i(c,l)}))}))}}},{key:"reload",value:function(){var e=this,t=this.services,n=t.backendConnector,r=t.languageUtils,i=t.logger,o=n.language;if(!o||"cimode"!==o.toLowerCase()){var s=[],a=function(e){r.toResolveHierarchy(e).forEach((function(e){s.indexOf(e)<0&&s.push(e)}))};a(o),this.allOptions.preload&&this.allOptions.preload.forEach((function(e){return a(e)})),s.forEach((function(t){e.allOptions.ns.forEach((function(e){n.read(t,e,"read",null,null,(function(r,o){r&&i.warn("loading namespace ".concat(e," for language ").concat(t," failed"),r),!r&&o&&i.log("loaded namespace ".concat(e," for language ").concat(t),o),n.loaded("".concat(t,"|").concat(e),r,o)}))}))}))}}}],n&&Sn(t.prototype,n),r&&Sn(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();In.type="backend";const Cn=In;var Tn=[],kn=Tn.forEach,Rn=Tn.slice;var xn=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,Pn=function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{path:"/",sameSite:"strict"};n&&(i.expires=new Date,i.expires.setTime(i.expires.getTime()+60*n*1e3)),r&&(i.domain=r),document.cookie=function(e,t,n){var r=n||{};r.path=r.path||"/";var i=encodeURIComponent(t),o="".concat(e,"=").concat(i);if(r.maxAge>0){var s=r.maxAge-0;if(Number.isNaN(s))throw new Error("maxAge should be a Number");o+="; Max-Age=".concat(Math.floor(s))}if(r.domain){if(!xn.test(r.domain))throw new TypeError("option domain is invalid");o+="; Domain=".concat(r.domain)}if(r.path){if(!xn.test(r.path))throw new TypeError("option path is invalid");o+="; Path=".concat(r.path)}if(r.expires){if("function"!==typeof r.expires.toUTCString)throw new TypeError("option expires is invalid");o+="; Expires=".concat(r.expires.toUTCString())}if(r.httpOnly&&(o+="; HttpOnly"),r.secure&&(o+="; Secure"),r.sameSite)switch("string"===typeof r.sameSite?r.sameSite.toLowerCase():r.sameSite){case!0:o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"strict":o+="; SameSite=Strict";break;case"none":o+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return o}(e,encodeURIComponent(t),i)},Dn=function(e){for(var t="".concat(e,"="),n=document.cookie.split(";"),r=0;r<n.length;r++){for(var i=n[r];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(t))return i.substring(t.length,i.length)}return null},On={name:"cookie",lookup:function(e){var t;if(e.lookupCookie&&"undefined"!==typeof document){var n=Dn(e.lookupCookie);n&&(t=n)}return t},cacheUserLanguage:function(e,t){t.lookupCookie&&"undefined"!==typeof document&&Pn(t.lookupCookie,e,t.cookieMinutes,t.cookieDomain,t.cookieOptions)}},Nn={name:"querystring",lookup:function(e){var t;if("undefined"!==typeof window){var n=window.location.search;!window.location.search&&window.location.hash&&window.location.hash.indexOf("?")>-1&&(n=window.location.hash.substring(window.location.hash.indexOf("?")));for(var r=n.substring(1).split("&"),i=0;i<r.length;i++){var o=r[i].indexOf("=");if(o>0)r[i].substring(0,o)===e.lookupQuerystring&&(t=r[i].substring(o+1))}}return t}},Bn=null,Ln=function(){if(null!==Bn)return Bn;try{Bn="undefined"!==window&&null!==window.localStorage;var e="i18next.translate.boo";window.localStorage.setItem(e,"foo"),window.localStorage.removeItem(e)}catch(t){Bn=!1}return Bn},Mn={name:"localStorage",lookup:function(e){var t;if(e.lookupLocalStorage&&Ln()){var n=window.localStorage.getItem(e.lookupLocalStorage);n&&(t=n)}return t},cacheUserLanguage:function(e,t){t.lookupLocalStorage&&Ln()&&window.localStorage.setItem(t.lookupLocalStorage,e)}},Un=null,Fn=function(){if(null!==Un)return Un;try{Un="undefined"!==window&&null!==window.sessionStorage;var e="i18next.translate.boo";window.sessionStorage.setItem(e,"foo"),window.sessionStorage.removeItem(e)}catch(t){Un=!1}return Un},Kn={name:"sessionStorage",lookup:function(e){var t;if(e.lookupSessionStorage&&Fn()){var n=window.sessionStorage.getItem(e.lookupSessionStorage);n&&(t=n)}return t},cacheUserLanguage:function(e,t){t.lookupSessionStorage&&Fn()&&window.sessionStorage.setItem(t.lookupSessionStorage,e)}},jn={name:"navigator",lookup:function(e){var t=[];if("undefined"!==typeof navigator){if(navigator.languages)for(var n=0;n<navigator.languages.length;n++)t.push(navigator.languages[n]);navigator.userLanguage&&t.push(navigator.userLanguage),navigator.language&&t.push(navigator.language)}return t.length>0?t:void 0}},Zn={name:"htmlTag",lookup:function(e){var t,n=e.htmlTag||("undefined"!==typeof document?document.documentElement:null);return n&&"function"===typeof n.getAttribute&&(t=n.getAttribute("lang")),t}},zn={name:"path",lookup:function(e){var t;if("undefined"!==typeof window){var n=window.location.pathname.match(/\/([a-zA-Z-]*)/g);if(n instanceof Array)if("number"===typeof e.lookupFromPathIndex){if("string"!==typeof n[e.lookupFromPathIndex])return;t=n[e.lookupFromPathIndex].replace("/","")}else t=n[0].replace("/","")}return t}},Vn={name:"subdomain",lookup:function(e){var t="number"===typeof e.lookupFromSubdomainIndex?e.lookupFromSubdomainIndex+1:1,n="undefined"!==typeof window&&window.location&&window.location.hostname&&window.location.hostname.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i);if(n)return n[t]}};var Hn=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,i.Z)(this,e),this.type="languageDetector",this.detectors={},this.init(t,n)}return(0,o.Z)(e,[{key:"init",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.services=e,this.options=function(e){return kn.call(Rn.call(arguments,1),(function(t){if(t)for(var n in t)void 0===e[n]&&(e[n]=t[n])})),e}(t,this.options||{},{order:["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"],lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"]}),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=n,this.addDetector(On),this.addDetector(Nn),this.addDetector(Mn),this.addDetector(Kn),this.addDetector(jn),this.addDetector(Zn),this.addDetector(zn),this.addDetector(Vn)}},{key:"addDetector",value:function(e){this.detectors[e.name]=e}},{key:"detect",value:function(e){var t=this;e||(e=this.options.order);var n=[];return e.forEach((function(e){if(t.detectors[e]){var r=t.detectors[e].lookup(t.options);r&&"string"===typeof r&&(r=[r]),r&&(n=n.concat(r))}})),this.services.languageUtils.getBestMatchFromCodes?n:n.length>0?n[0]:null}},{key:"cacheUserLanguage",value:function(e,t){var n=this;t||(t=this.options.caches),t&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(e)>-1||t.forEach((function(t){n.detectors[t]&&n.detectors[t].cacheUserLanguage(e,n.options)})))}}]),e}();Hn.type="languageDetector";var qn=n(4147),Gn=n(73788),Wn=n(75283);const{version:Qn}=qn,Yn=Object.values(Gn);ge.use(Yt).use(en).use(Hn).init({load:"currentOnly",backend:{backends:[sn,Cn],backendOptions:[{defaultVersion:Qn,expirationTime:6048e5},{loadPath:(e,t)=>{const n=(0,Wn.Z)({i18n:ge,localeCode:e[0],languages:Gn});return"locales/".concat(n,"/").concat(t,".json")}}]},ns:["app","welcome","status","files","explore","peers","settings","notify"],defaultNS:"app",fallbackNS:"app",fallbackLng:{"zh-Hans":["zh-CN","en"],"zh-Hant":["zh-TW","en"],zh:["zh-CN","en"],ko:["ko-KR","en"],default:["en"]},debug:{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_GIT_REV:"9c10520",REACT_APP_VERSION:"4.2.1"}.DEBUG,react:{wait:!0,useSuspense:!1,bindI18n:"languageChanged loaded",bindStore:"added removed",nsMode:"default"}});const Jn=ge},83072:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(72791);function i(){return i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i.apply(this,arguments)}const o=function(e){return r.createElement("svg",i({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 100"},e),r.createElement("path",{d:"M63.79 63.2l-3.88 3.88-9.71-9.7-9.7 9.7-3.88-3.88 9.7-9.71-9.7-9.7 3.88-3.88 9.7 9.7 9.71-9.7 3.88 3.88-9.7 9.7 9.7 9.71z"}))}},59356:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(72791);function i(){return i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i.apply(this,arguments)}const o=function(e){return r.createElement("svg",i({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 100"},e),r.createElement("path",{d:"M44.39 66.09L32.74 54.44l3.92-3.92 7.73 7.73 19.36-19.36 3.92 3.92z"}))}},17098:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(72791);function i(){return i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i.apply(this,arguments)}const o=function(e){return r.createElement("svg",i({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 100"},e),r.createElement("path",{d:"M84.173 64.865v-29.1a4.48 4.48 0 10-4.4-7.63l-25.35-14.61a4.7 4.7 0 000-1.5 4.485 4.485 0 00-8.86 1.4v.17l-25 14.85a4.48 4.48 0 10-4.74 7.32v29.08a4.48 4.48 0 001.5 8.71 4.14 4.14 0 00.7-.06 4.24 4.24 0 001.51-.5l26 14.72v.27a4.49 4.49 0 004.49 3.76 4.2 4.2 0 00.7 0 4.5 4.5 0 003.78-4.19l25-15.32a4.48 4.48 0 003.2 1.37 4.23 4.23 0 00.7-.06 4.47 4.47 0 00.8-8.63zm-5.15 1.56a4.42 4.42 0 00-.82 3l-24.63 15.13a4.5 4.5 0 00-2.55-1.66v-28.55a4.48 4.48 0 003.44-5l25-14.77a4.46 4.46 0 001.74 1.15v29.12a4.46 4.46 0 00-2.18 1.58zm-32.67 18.27l-24.81-14a4.34 4.34 0 00.26-2.3 4.44 4.44 0 00-2.93-3.5v-29.13a4.61 4.61 0 001.44-.85l25.33 14.16a4.4 4.4 0 000 1.62 4.48 4.48 0 003.38 3.66v28.55a4.52 4.52 0 00-2.67 1.79zm3.67-67.48a4.23 4.23 0 00.7-.06 4.33 4.33 0 002.2-1l25.35 14.58a4.76 4.76 0 000 1.51 4 4 0 00.17.66l-24.71 14.59a4.46 4.46 0 00-7.25-.24l-25-14a4.31 4.31 0 00.33-2.06l25.34-15a4.48 4.48 0 002.87 1.02zm.39 35.24a2.49 2.49 0 112.07-2.85 2.5 2.5 0 01-2.07 2.85zm31.87-23.37a2.49 2.49 0 11-2.07 2.84 2.49 2.49 0 012.07-2.84zm-32.65-18.81a2.49 2.49 0 11-2.07 2.84 2.49 2.49 0 012.07-2.84zm-34.71 21.65a2.49 2.49 0 112.84 2.07 2.48 2.48 0 01-2.84-2.07zm2.84 39.6a2.49 2.49 0 01-.74-4.91 2.43 2.43 0 011.85.44 2.48 2.48 0 01-1.07 4.47zm32.65 18.19a2.49 2.49 0 112.07-2.84 2.5 2.5 0 01-2.07 2.84zm32.61-18.19a2.49 2.49 0 11-.78-4.91 2.47 2.47 0 012.84 2.06 2.49 2.49 0 01-2.06 2.85z"}))}},73741:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(72791);function i(){return i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i.apply(this,arguments)}const o=function(e){return r.createElement("svg",i({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 100"},e),r.createElement("path",{d:"M72.53 32.38H55.08a3.76 3.76 0 01-3.44-2.25l-2.28-4.83a6 6 0 00-5.57-3.8H31.47c-6.37 0-11.56 5.5-11.56 12.18v32.64c0 6.68 5.19 12.18 11.56 12.18h41.06c6.37 0 11.56-5.46 11.56-12.18V44.56c0-6.72-5.19-12.18-11.56-12.18zM31.47 24.1h12.32A3.45 3.45 0 0147 26.35l2.34 4.95a6.33 6.33 0 005.74 3.7h17.45a9.22 9.22 0 018.9 8.5H22.51v-9.8c0-5.3 4.02-9.6 8.96-9.6zm41.06 51.8H31.47c-4.94 0-9-4.3-9-9.58V45h59v21.32c.02 5.28-4 9.58-8.94 9.58z"}))}},62472:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(72791);function i(){return i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i.apply(this,arguments)}const o=function(e){return r.createElement("svg",i({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 100"},e),r.createElement("path",{d:"M87.589 44.265c0-1.157-.45-2.245-1.27-3.062a4.304 4.304 0 00-3.062-1.269 4.304 4.304 0 00-3.062 1.269 4.337 4.337 0 000 6.125c.602.602 1.35 1 2.164 1.172v2.442l-14.686 9.276v-19.79l4.498-2.842v-3.717a4.27 4.27 0 001.827-1.067 4.337 4.337 0 000-6.125 4.337 4.337 0 00-6.126 0 4.304 4.304 0 00-1.27 3.063c0 1.157.45 2.245 1.27 3.062a4.282 4.282 0 001.963 1.107V36.3L51.11 48.128v-8.901l9.304-5.877v-7.051a4.282 4.282 0 001.986-1.114 4.336 4.336 0 00-.001-6.125 4.337 4.337 0 00-6.125 0h-.001a4.337 4.337 0 000 6.125c.52.519 1.145.859 1.804 1.059v5.818l-6.967 4.401V15.062a4.283 4.283 0 002.008-1.12 4.337 4.337 0 00-.001-6.126 4.337 4.337 0 00-6.125 0h-.001a4.337 4.337 0 000 6.126 4.273 4.273 0 001.783 1.053v15.881l-7.23-4.566v-3.436a4.292 4.292 0 002.009-1.12 4.337 4.337 0 000-6.125 4.337 4.337 0 00-6.126 0 4.304 4.304 0 00-1.27 3.063c0 1.157.45 2.245 1.27 3.062a4.276 4.276 0 001.78 1.053v4.79l9.566 6.042v21.108l-7.708-4.226v-7.809a4.275 4.275 0 002.034-1.128 4.337 4.337 0 000-6.125 4.337 4.337 0 00-6.126 0 4.304 4.304 0 00-1.27 3.063c0 1.157.45 2.245 1.27 3.062a4.284 4.284 0 001.756 1.046v6.61l-11.705-6.417v-6.217a4.28 4.28 0 001.984-1.117 4.3 4.3 0 001.27-3.063c0-1.157-.45-2.245-1.27-3.062a4.336 4.336 0 00-6.125 0 4.337 4.337 0 000 6.125c.51.51 1.132.858 1.804 1.062v7.621l3.646 2.004v13.632l-10.582-5.77V51.62a4.29 4.29 0 002.05-1.133 4.337 4.337 0 000-6.125 4.304 4.304 0 00-3.061-1.269 4.304 4.304 0 00-3.063 1.269 4.337 4.337 0 000 6.125 4.285 4.285 0 001.738 1.041v3.812l33.359 18.269v11.397a4.277 4.277 0 00-1.783 1.053 4.337 4.337 0 000 6.125 4.32 4.32 0 003.063 1.266 4.316 4.316 0 003.063-1.267 4.337 4.337 0 000-6.125 4.29 4.29 0 00-2.008-1.119V73.444l33.585-21.216v-3.892a4.29 4.29 0 001.625-1.008 4.3 4.3 0 001.269-3.063zM30.46 60.969V47.345l18.314 10.066v13.542zm34.876-19.065v19.79L51.11 70.68V50.89zm3.067-12.164c0-.676.264-1.312.742-1.79a2.525 2.525 0 011.79-.74c.647 0 1.296.247 1.789.74a2.536 2.536 0 010 3.581 2.535 2.535 0 01-3.58 0 2.516 2.516 0 01-.741-1.791zm-10.857-9.407a2.534 2.534 0 013.58 0 2.534 2.534 0 010 3.58 2.534 2.534 0 01-3.58 0 2.534 2.534 0 010-3.58zM48.264 9.09a2.536 2.536 0 013.58 0c.988.987.988 2.593.002 3.58a2.536 2.536 0 01-3.581 0 2.535 2.535 0 01-.001-3.58zm-10.305 9.601c0-.676.264-1.312.742-1.79a2.525 2.525 0 011.79-.74c.647 0 1.296.247 1.789.74a2.536 2.536 0 010 3.581 2.535 2.535 0 01-3.58 0 2.52 2.52 0 01-.741-1.791zm-.453 19.832c0-.676.264-1.312.742-1.79a2.525 2.525 0 011.79-.74c.647 0 1.296.247 1.789.74a2.536 2.536 0 010 3.581 2.535 2.535 0 01-3.58 0 2.525 2.525 0 01-.741-1.791zm-13.348-7.887a2.524 2.524 0 011.789-.74 2.526 2.526 0 012.532 2.531c0 .677-.264 1.312-.742 1.79-.422.422-.984.647-1.562.696h-.456c-.577-.049-1.14-.274-1.561-.696a2.534 2.534 0 010-3.581zM14.95 45.635a2.514 2.514 0 011.79-.742 2.534 2.534 0 011.789 4.322 2.533 2.533 0 01-3.58 0 2.533 2.533 0 010-3.58zm36.894 45.277a2.534 2.534 0 01-3.58 0 2.534 2.534 0 010-3.58 2.536 2.536 0 013.58 0 2.534 2.534 0 010 3.58zm33.202-44.857c-.955.955-2.624.957-3.58 0a2.534 2.534 0 011.79-4.322c.677 0 1.312.264 1.79.742.479.478.742 1.113.742 1.79s-.263 1.311-.742 1.79z"}))}},83383:(e,t,n)=>{"use strict";n.d(t,{cd:()=>c,dw:()=>o,ob:()=>h,v_:()=>u,x9:()=>l});var r=n(27530),i=n.n(r);function o(e){const t=[];for(const n of e)t.push({path:n.filepath||n.webkitRelativePath||n.name,content:n,size:n.size});return t}function s(e,t,n,r){if("directory"===e){const e="".concat(t||"download_".concat(n.toString()),".tar");return"".concat(r,"/ipfs/").concat(n.toString(),"?download=true&format=tar&filename=").concat(e)}{const e="".concat(t||n);return"".concat(r,"/ipfs/").concat(n.toString(),"?download=true&filename=").concat(e)}}async function a(e,t){const n="/zzzz_".concat(Date.now());await t.files.mkdir(n,{});for(const{cid:i,name:o}of e)await t.files.cp("/ipfs/".concat(i),"".concat(n,"/").concat(o));const r=await t.files.stat(n);return t.files.rm(n,{recursive:!0}),r.cid}async function c(e,t,n){if(1===e.length)return s(e[0].type,e[0].name,e[0].cid,t);return s("directory","",await a(e,n),t)}async function l(e,t,n){let r,i;return 1===e.length?(r=e[0].cid,"file"===e[0].type&&(i="?filename=".concat(encodeURIComponent(e[0].name)))):r=await a(e,n),"".concat(t,"/ipfs/").concat(r).concat(i||"")}async function u(e,t,n){let r,i;return 1===e.length?(r=e[0].cid,i=encodeURIComponent(e[0].name)):r=await a(e,n),"".concat(t,"/ipfs/").concat(r,"?format=car&filename=").concat(i||r,".car")}function h(e,t){return"undefined"===typeof e||null===e?"N/A":i()(e||0,{spacer:String.fromCharCode(160),round:e>=1073741824?1:0,standard:"iec",base:2,bits:!1,...t})}},75283:(e,t,n)=>{"use strict";function r(e){let{i18n:t,localeCode:n,languages:r}=e;const i=r[n];if(null!=i)return n;const o=t.options.fallbackLng[n];if(null==i&&null!=o){const e=o;for(const t of e){const e=r[t];if(null!=e)return e.locale}}const s=n.split("-")[0];if(r[s])return s;const a=Object.keys(r).find((e=>e.startsWith(n)));return a||"en"}n.d(t,{Z:()=>r})},22956:(e,t,n)=>{"use strict";function r(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{numeric:!0,sensitivity:"base"};return(n,r)=>n.localeCompare(r,void 0,t)*e}function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return(t,n)=>(t-n)*e}function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(n,r)=>{let{[e]:i}=n,{[e]:o}=r;return(null==i)-(null==o)||t*+(i>o)||t*-(i<o)}}n.d(t,{dO:()=>i,hr:()=>o,m2:()=>r})},64746:(e,t,n)=>{"use strict";n.d(t,{IL:()=>s,Qu:()=>l,ab:()=>a,oC:()=>c,us:()=>i,z3:()=>o});var r=n(72791);const i={getSteps:e=>{let{t:t}=e;return[{content:r.createElement("div",{className:"montserrat white"},r.createElement("p",{className:"ma0 pa0 tl f6"},t("tour.tooltip"))),placement:"left",target:".joyride-app-tour",disableBeacon:!0}]},styles:{tooltipContent:{padding:"0 20px 0 0"},tooltipFooter:{display:"none"},options:{width:"250px",backgroundColor:"rgba(105, 196, 205, 0.85)",arrowColor:"rgba(105, 196, 205, 0.85)",textColor:"#fff",zIndex:999}}},o={getSteps:e=>{let{t:t,Trans:n}=e;return[{content:r.createElement("div",{className:"montserrat charcoal"},r.createElement("h2",{className:"f3 fw4"},t("tour.step1.title")),r.createElement("p",{className:"tl f6"},t("tour.step1.paragraph1")),r.createElement("p",{className:"tl f6"},t("tour.step1.paragraph2")),r.createElement("p",{className:"tl f6"},t("tour.step1.paragraph3"))),placement:"center",target:"body"}]},styles:{options:{width:"500px",primaryColor:"#378085",textColor:"#34373f",zIndex:999}}},s={getSteps:e=>{let{t:t,Trans:n}=e;return[{content:r.createElement("div",{className:"montserrat charcoal"},r.createElement("h2",{className:"f3 fw4"},t("tour.step1.title")),r.createElement("p",{className:"tl f6"},t("tour.step1.paragraph1")),r.createElement("p",{className:"tl f6"},t("tour.step1.paragraph2"))),placement:"center",target:"body"},{content:r.createElement("div",{className:"montserrat charcoal"},r.createElement("h2",{className:"f3 fw4"},t("tour.step2.title")),r.createElement("p",{className:"tl f6"},t("tour.step2.paragraph1")),r.createElement("p",{className:"tl f6"},t("tour.step2.paragraph2"))),placement:"left",target:".joyride-app-status"},{content:r.createElement("div",{className:"montserrat charcoal"},r.createElement("h2",{className:"f3 fw4"},t("tour.step3.title")),r.createElement("p",{className:"tl f6"},t("tour.step3.paragraph1")),r.createElement(n,{i18nKey:"tour.step3.paragraph2",t:t},r.createElement("p",{className:"tl f6"},"Click on ",r.createElement("code",null,"Advanced")," to see more info such as the gateway URL and addresses."))),placement:"bottom",target:".joyride-status-node"},{content:r.createElement("div",{className:"montserrat charcoal"},r.createElement("h2",{className:"f3 fw4"},t("tour.step4.title")),r.createElement("p",{className:"tl f6"},t("tour.step4.paragraph1")),r.createElement("p",{className:"tl f6"},t("tour.step4.paragraph2"))),placement:"top",target:".joyride-status-charts"},{content:r.createElement("div",{className:"montserrat charcoal"},r.createElement("h2",{className:"f3 fw4"},t("tour.stepExplore.title")),r.createElement("p",{className:"tl f6"},t("tour.stepExplore.paragraph"))),locale:{last:t("tour.finish")},placement:"right",target:".joyride-app-explore"}]},styles:{options:{width:"500px",primaryColor:"#378085",textColor:"#34373f",zIndex:999}}},a={getSteps:e=>{let{t:t,Trans:n}=e;return[{content:r.createElement("div",{className:"montserrat charcoal"},r.createElement("h2",{className:"f3 fw4"},t("tour.step1.title")),r.createElement(n,{i18nKey:"tour.step1.paragraph1",t:t},r.createElement("p",{className:"tl f6"},"This is where the files on your ",r.createElement("a",{className:"teal link",href:"https://docs.ipfs.tech/concepts/file-systems/",rel:"noopener noreferrer",target:"_blank"},"Mutable File System (MFS)")," live. You can add files or folders and manage them from this page.")),r.createElement("p",{className:"tl f6"},t("tour.step1.paragraph2"))),placement:"center",target:"body"},{content:r.createElement("div",{className:"montserrat charcoal"},r.createElement("h2",{className:"f3 fw4"},t("tour.step2.title")),r.createElement("p",{className:"tl f6"},t("tour.step2.paragraph1")),r.createElement("ul",{className:"pl4"},r.createElement("li",{className:"tl f6"},t("tour.step2.bullet1")),r.createElement("li",{className:"tl f6"},t("tour.step2.bullet2")),r.createElement("li",{className:"tl f6"},t("tour.step2.bullet3")))),placement:"bottom",target:".joyride-files-breadcrumbs"},{content:r.createElement("div",{className:"montserrat charcoal"},r.createElement("h2",{className:"f3 fw4"},t("tour.step3.title")),r.createElement("p",{className:"tl f6"},t("tour.step3.paragraph1")),r.createElement("p",{className:"tl f6"},t("tour.step3.paragraph2")),r.createElement(n,{i18nKey:"tour.step3.paragraph3",t:t},r.createElement("p",{className:"tl f6"},"If you want to add something that is already on IPFS, you can import it to your MFS by passing its ",r.createElement("a",{className:"teal link",href:"https://docs.ipfs.tech/concepts/content-addressing/",rel:"noopener noreferrer",target:"_blank"},"Content Identifier (CID)"),"."))),placement:"bottom",target:".joyride-files-add"},{content:r.createElement("div",{className:"montserrat charcoal"},r.createElement("h2",{className:"f3 fw4"},t("tour.step5.title")),r.createElement("p",{className:"tl f6"},t("tour.step5.paragraph1")),r.createElement("p",{className:"tl f6"},t("tour.step5.paragraph2")),r.createElement("p",{className:"tl f6"},t("tour.step5.paragraph3"))),locale:{last:t("tour.finish")},placement:"center",target:"body"}]},styles:{options:{width:"500px",primaryColor:"#378085",textColor:"#34373f",zIndex:999}}},c={getSteps:e=>{let{t:t}=e;return[{content:r.createElement("div",{className:"montserrat charcoal"},r.createElement("h2",{className:"f3 fw4"},t("tour.step1.title")),r.createElement("p",{className:"tl f6"},t("tour.step1.paragraph1")),r.createElement("p",{className:"tl f6"},t("tour.step1.paragraph2"))),placement:"center",target:"body"},{content:r.createElement("div",{className:"montserrat charcoal"},r.createElement("h2",{className:"f3 fw4"},t("tour.step2.title")),r.createElement("p",{className:"tl f6"},t("tour.step2.paragraph1"))),placement:"bottom",target:".joyride-peers-map"},{content:r.createElement("div",{className:"montserrat charcoal"},r.createElement("h2",{className:"f3 fw4"},t("tour.step3.title")),r.createElement("p",{className:"tl f6"},t("tour.step3.paragraph1"))),locale:{last:t("tour.finish")},placement:"top",target:".joyride-peers-table"}]},styles:{options:{width:"500px",primaryColor:"#378085",textColor:"#34373f",zIndex:999}}},l={getSteps:e=>{let{t:t,Trans:n}=e;return[{content:r.createElement("div",{className:"montserrat charcoal"},r.createElement("h2",{className:"f3 fw4"},t("tour.step1.title")),r.createElement("p",{className:"tl f6"},t("tour.step1.paragraph1")),r.createElement("p",{className:"tl f6"},t("tour.step1.paragraph2"))),placement:"center",target:"body"},{content:r.createElement("div",{className:"montserrat charcoal"},r.createElement("h2",{className:"f3 fw4"},t("tour.step2.title")),r.createElement("p",{className:"tl f6"},t("tour.step2.paragraph1"))),placement:"auto",target:".joyride-settings-customapi"},{content:r.createElement("div",{className:"montserrat charcoal"},r.createElement("h2",{className:"f3 fw4"},t("tour.step3.title")),r.createElement(n,{i18nKey:"tour.step3.paragraph1",t:t},r.createElement("p",{className:"tl f6"},"If you have accounts with third-party remote pinning services, add them here so you can pin/unpin items to those services directly from the Files screen. You can learn more about third-party pinning services in the ",r.createElement("a",{className:"teal link",href:"https://docs.ipfs.tech/how-to/work-with-pinning-services",rel:"noopener noreferrer",target:"_blank"},"IPFS Docs"),"."))),placement:"auto",target:".joyride-settings-pinning"},{content:r.createElement("div",{className:"montserrat charcoal"},r.createElement("h2",{className:"f3 fw4"},t("tour.step4.title")),r.createElement(n,{i18nKey:"tour.step4.paragraph1",t:t},r.createElement("p",{className:"tl f6"},"You can change the language of the Web UI. If your preferred language isn't available, head over our project page in ",r.createElement("a",{className:"teal link",href:"https://www.transifex.com/ipfs/ipfs-webui/translate/",rel:"noopener noreferrer",target:"_blank"},"Transifex")," to help us translate!"))),placement:"auto",target:".joyride-settings-language"},{content:r.createElement("div",{className:"montserrat charcoal"},r.createElement("h2",{className:"f3 fw4"},t("tour.step5.title")),r.createElement("p",{className:"tl f6"},t("tour.step5.paragraph1")),r.createElement("p",{className:"tl f6"},t("tour.step5.paragraph2"))),placement:"auto",target:".joyride-settings-analytics"},{content:r.createElement("div",{className:"montserrat charcoal"},r.createElement("h2",{className:"f3 fw4"},t("tour.step6.title")),r.createElement("p",{className:"tl f6"},t("tour.step6.paragraph1"))),placement:"auto",target:".joyride-settings-tutormode"},{content:r.createElement("div",{className:"montserrat charcoal"},r.createElement("h2",{className:"f3 fw4"},t("tour.step7.title")),r.createElement("p",{className:"tl f6"},t("tour.step7.paragraph1")),r.createElement("p",{className:"tl f6"},t("tour.step7.paragraph2"))),locale:{last:t("tour.finish")},placement:"auto",target:".joyride-settings-config"}]},styles:{options:{width:"500px",primaryColor:"#378085",textColor:"#34373f",zIndex:999}}}},11848:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(72791);function i(){return i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i.apply(this,arguments)}const o=e=>r.createElement("div",i({},e,{style:{width:300,margin:"10vh auto",...e.style}}),r.createElement("svg",{className:"ComponentLoader",style:{width:"100%"},viewBox:"0 0 512 512",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.createElement("path",{className:"shape",strokeDasharray:"4187",stroke:"#40898C",strokeWidth:"3",d:"M256.7 511.99L35 383.99V128L256.7 0L478.4 127.99V383.99L256.7 511.99ZM73.075 123.636L233.815 30.83H233.832C247.387 40.831 265.877 40.831 279.431 30.83L440.171 123.636C439.85 126.49 439.85 129.37 440.172 132.224L279.422 225.031C265.868 215.031 247.379 215.031 233.825 225.031L73.075 132.226C73.3963 129.372 73.3963 126.49 73.075 123.636ZM294.685 251.7L455.605 157.86L455.614 157.864C457.926 159.569 460.421 161.009 463.054 162.158V347.768C447.615 354.506 438.371 370.519 440.255 387.258L279.505 480.063C277.194 478.358 274.699 476.918 272.066 475.769L271.886 291.189C287.324 284.451 296.569 268.439 294.685 251.7ZM50.357 163.187C52.9892 162.038 55.4841 160.597 57.795 158.892L57.796 158.887L218.536 251.697C216.652 268.437 225.897 284.449 241.336 291.187V476.797C238.703 477.946 236.208 479.387 233.896 481.092L73.156 388.286C75.04 371.547 65.795 355.535 50.357 348.797V163.187Z"}),r.createElement("path",{d:"M34.298 384L255.998 512L477.698 384V128L255.998 0.0100098L34.298 128.01V384Z",fill:"url(#paint1_linear)"}),r.createElement("path",{d:"M233.113 30.84L72.373 123.646C72.6943 126.5 72.6943 129.382 72.373 132.236L233.123 225.041C246.677 215.041 265.166 215.041 278.72 225.041L439.47 132.234C439.148 129.38 439.148 126.5 439.469 123.646L278.729 30.84C265.175 40.841 246.685 40.841 233.13 30.84H233.113ZM454.903 157.87L293.983 251.71C295.867 268.449 286.622 284.461 271.184 291.199L271.364 475.779C273.997 476.928 276.492 478.368 278.803 480.073L439.553 387.268C437.669 370.529 446.913 354.516 462.352 347.778V162.168C459.719 161.019 457.224 159.579 454.912 157.874L454.903 157.87ZM57.093 158.902C54.7821 160.607 52.2872 162.048 49.655 163.197V348.807C65.093 355.545 74.338 371.557 72.454 388.296L233.194 481.102C235.506 479.397 238.001 477.956 240.634 476.807V291.197C225.195 284.459 215.95 268.447 217.834 251.707L57.094 158.897L57.093 158.902Z",fill:"url(#paint2_linear)"}),r.createElement("path",{d:"M256 512L477.7 384V128L256 256V512Z",fill:"black",fillOpacity:"0.251"}),r.createElement("path",{d:"M256 512V256C169.421 206.013 120.879 177.987 34.3 128V384L256 512Z",fill:"black",fillOpacity:"0.039"}),r.createElement("path",{d:"M34.298 128L255.998 256L477.698 128L255.998 0L34.298 128Z",fill:"black",fillOpacity:"0.13"}),r.createElement("defs",null,r.createElement("linearGradient",{id:"paint1_linear",x1:"34.298",y1:"256",x2:"477.703",y2:"256",gradientUnits:"userSpaceOnUse"},r.createElement("stop",{stopColor:"#4A9EA1"})),r.createElement("linearGradient",{id:"paint2_linear",x1:"49.658",y1:"255.97",x2:"462.343",y2:"255.97",gradientUnits:"userSpaceOnUse"},r.createElement("stop",{stopColor:"#63D3D7"})))))},17457:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(72791);function i(){return i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i.apply(this,arguments)}const o=e=>{let{props:t,children:n}=e;return r.createElement("h2",i({className:"ttu tracked f6 fw4 teal mt0 mb3"},t),n)}},43663:e=>{"use strict";function t(e,t){t=t||{};this._capacity=t.capacity,this._head=0,this._tail=0,Array.isArray(e)?this._fromArray(e):(this._capacityMask=3,this._list=new Array(4))}t.prototype.peekAt=function(e){var t=e;if(t===(0|t)){var n=this.size();if(!(t>=n||t<-n))return t<0&&(t+=n),t=this._head+t&this._capacityMask,this._list[t]}},t.prototype.get=function(e){return this.peekAt(e)},t.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]},t.prototype.peekFront=function(){return this.peek()},t.prototype.peekBack=function(){return this.peekAt(-1)},Object.defineProperty(t.prototype,"length",{get:function(){return this.size()}}),t.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},t.prototype.unshift=function(e){if(0===arguments.length)return this.size();var t=this._list.length;return this._head=this._head-1+t&this._capacityMask,this._list[this._head]=e,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},t.prototype.shift=function(){var e=this._head;if(e!==this._tail){var t=this._list[e];return this._list[e]=void 0,this._head=e+1&this._capacityMask,e<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),t}},t.prototype.push=function(e){if(0===arguments.length)return this.size();var t=this._tail;return this._list[t]=e,this._tail=t+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},t.prototype.pop=function(){var e=this._tail;if(e!==this._head){var t=this._list.length;this._tail=e-1+t&this._capacityMask;var n=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&e>1e4&&e<=t>>>2&&this._shrinkArray(),n}},t.prototype.removeOne=function(e){var t=e;if(t===(0|t)&&this._head!==this._tail){var n=this.size(),r=this._list.length;if(!(t>=n||t<-n)){t<0&&(t+=n),t=this._head+t&this._capacityMask;var i,o=this._list[t];if(e<n/2){for(i=e;i>0;i--)this._list[t]=this._list[t=t-1+r&this._capacityMask];this._list[t]=void 0,this._head=this._head+1+r&this._capacityMask}else{for(i=n-1-e;i>0;i--)this._list[t]=this._list[t=t+1+r&this._capacityMask];this._list[t]=void 0,this._tail=this._tail-1+r&this._capacityMask}return o}}},t.prototype.remove=function(e,t){var n,r=e,i=t;if(r===(0|r)&&this._head!==this._tail){var o=this.size(),s=this._list.length;if(!(r>=o||r<-o||t<1)){if(r<0&&(r+=o),1===t||!t)return(n=new Array(1))[0]=this.removeOne(r),n;if(0===r&&r+t>=o)return n=this.toArray(),this.clear(),n;var a;for(r+t>o&&(t=o-r),n=new Array(t),a=0;a<t;a++)n[a]=this._list[this._head+r+a&this._capacityMask];if(r=this._head+r&this._capacityMask,e+t===o){for(this._tail=this._tail-t+s&this._capacityMask,a=t;a>0;a--)this._list[r=r+1+s&this._capacityMask]=void 0;return n}if(0===e){for(this._head=this._head+t+s&this._capacityMask,a=t-1;a>0;a--)this._list[r=r+1+s&this._capacityMask]=void 0;return n}if(r<o/2){for(this._head=this._head+e+t+s&this._capacityMask,a=e;a>0;a--)this.unshift(this._list[r=r-1+s&this._capacityMask]);for(r=this._head-1+s&this._capacityMask;i>0;)this._list[r=r-1+s&this._capacityMask]=void 0,i--;e<0&&(this._tail=r)}else{for(this._tail=r,r=r+t+s&this._capacityMask,a=o-(t+e);a>0;a--)this.push(this._list[r++]);for(r=this._tail;i>0;)this._list[r=r+1+s&this._capacityMask]=void 0,i--}return this._head<2&&this._tail>1e4&&this._tail<=s>>>2&&this._shrinkArray(),n}}},t.prototype.splice=function(e,t){var n=e;if(n===(0|n)){var r=this.size();if(n<0&&(n+=r),!(n>r)){if(arguments.length>2){var i,o,s,a=arguments.length,c=this._list.length,l=2;if(!r||n<r/2){for(o=new Array(n),i=0;i<n;i++)o[i]=this._list[this._head+i&this._capacityMask];for(0===t?(s=[],n>0&&(this._head=this._head+n+c&this._capacityMask)):(s=this.remove(n,t),this._head=this._head+n+c&this._capacityMask);a>l;)this.unshift(arguments[--a]);for(i=n;i>0;i--)this.unshift(o[i-1])}else{var u=(o=new Array(r-(n+t))).length;for(i=0;i<u;i++)o[i]=this._list[this._head+n+t+i&this._capacityMask];for(0===t?(s=[],n!=r&&(this._tail=this._head+n+c&this._capacityMask)):(s=this.remove(n,t),this._tail=this._tail-u+c&this._capacityMask);l<a;)this.push(arguments[l++]);for(i=0;i<u;i++)this.push(o[i])}return s}return this.remove(n,t)}}},t.prototype.clear=function(){this._list=new Array(this._list.length),this._head=0,this._tail=0},t.prototype.isEmpty=function(){return this._head===this._tail},t.prototype.toArray=function(){return this._copyArray(!1)},t.prototype._fromArray=function(e){var t=e.length,n=this._nextPowerOf2(t);this._list=new Array(n),this._capacityMask=n-1,this._tail=t;for(var r=0;r<t;r++)this._list[r]=e[r]},t.prototype._copyArray=function(e,t){var n=this._list,r=n.length,i=this.length;if((t|=i)==i&&this._head<this._tail)return this._list.slice(this._head,this._tail);var o,s=new Array(t),a=0;if(e||this._head>this._tail){for(o=this._head;o<r;o++)s[a++]=n[o];for(o=0;o<this._tail;o++)s[a++]=n[o]}else for(o=this._head;o<this._tail;o++)s[a++]=n[o];return s},t.prototype._growArray=function(){if(0!=this._head){var e=this._copyArray(!0,this._list.length<<1);this._tail=this._list.length,this._head=0,this._list=e}else this._tail=this._list.length,this._list.length<<=1;this._capacityMask=this._capacityMask<<1|1},t.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1},t.prototype._nextPowerOf2=function(e){var t=1<<Math.log(e)/Math.log(2)+1;return Math.max(t,4)},e.exports=t},62001:(e,t,n)=>{"use strict";e.exports=n(86181)},86181:(e,t,n)=>{"use strict";var r=t;function i(){r.util._configure(),r.Writer._configure(r.BufferWriter),r.Reader._configure(r.BufferReader)}r.build="minimal",r.Writer=n(39800),r.BufferWriter=n(96489),r.Reader=n(85684),r.BufferReader=n(61229),r.util=n(39584),r.rpc=n(31872),r.roots=n(59358),r.configure=i,i()},85684:(e,t,n)=>{"use strict";e.exports=c;var r,i=n(39584),o=i.LongBits,s=i.utf8;function a(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function c(e){this.buf=e,this.pos=0,this.len=e.length}var l="undefined"!==typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new c(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new c(e);throw Error("illegal buffer")},u=function(){return i.Buffer?function(e){return(c.create=function(e){return i.Buffer.isBuffer(e)?new r(e):l(e)})(e)}:l};function h(){var e=new o(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw a(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw a(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function d(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function f(){if(this.pos+8>this.len)throw a(this,8);return new o(d(this.buf,this.pos+=4),d(this.buf,this.pos+=4))}c.create=u(),c.prototype._slice=i.Array.prototype.subarray||i.Array.prototype.slice,c.prototype.uint32=function(){var e=4294967295;return function(){if(e=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return e;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return e}}(),c.prototype.int32=function(){return 0|this.uint32()},c.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},c.prototype.bool=function(){return 0!==this.uint32()},c.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return d(this.buf,this.pos+=4)},c.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|d(this.buf,this.pos+=4)},c.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var e=i.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},c.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var e=i.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},c.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw a(this,e);if(this.pos+=e,Array.isArray(this.buf))return this.buf.slice(t,n);if(t===n){var r=i.Buffer;return r?r.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,t,n)},c.prototype.string=function(){var e=this.bytes();return s.read(e,0,e.length)},c.prototype.skip=function(e){if("number"===typeof e){if(this.pos+e>this.len)throw a(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw a(this)}while(128&this.buf[this.pos++]);return this},c.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!==(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},c._configure=function(e){r=e,c.create=u(),r._configure();var t=i.Long?"toLong":"toNumber";i.merge(c.prototype,{int64:function(){return h.call(this)[t](!1)},uint64:function(){return h.call(this)[t](!0)},sint64:function(){return h.call(this).zzDecode()[t](!1)},fixed64:function(){return f.call(this)[t](!0)},sfixed64:function(){return f.call(this)[t](!1)}})}},61229:(e,t,n)=>{"use strict";e.exports=o;var r=n(85684);(o.prototype=Object.create(r.prototype)).constructor=o;var i=n(39584);function o(e){r.call(this,e)}o._configure=function(){i.Buffer&&(o.prototype._slice=i.Buffer.prototype.slice)},o.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},o._configure()},59358:e=>{"use strict";e.exports={}},31872:(e,t,n)=>{"use strict";t.Service=n(94648)},94648:(e,t,n)=>{"use strict";e.exports=i;var r=n(39584);function i(e,t,n){if("function"!==typeof e)throw TypeError("rpcImpl must be a function");r.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(n)}(i.prototype=Object.create(r.EventEmitter.prototype)).constructor=i,i.prototype.rpcCall=function e(t,n,i,o,s){if(!o)throw TypeError("request must be specified");var a=this;if(!s)return r.asPromise(e,a,t,n,i,o);if(a.rpcImpl)try{return a.rpcImpl(t,n[a.requestDelimited?"encodeDelimited":"encode"](o).finish(),(function(e,n){if(e)return a.emit("error",e,t),s(e);if(null!==n){if(!(n instanceof i))try{n=i[a.responseDelimited?"decodeDelimited":"decode"](n)}catch(e){return a.emit("error",e,t),s(e)}return a.emit("data",n,t),s(null,n)}a.end(!0)}))}catch(c){return a.emit("error",c,t),void setTimeout((function(){s(c)}),0)}else setTimeout((function(){s(Error("already ended"))}),0)},i.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},46880:(e,t,n)=>{"use strict";e.exports=i;var r=n(39584);function i(e,t){this.lo=e>>>0,this.hi=t>>>0}var o=i.zero=new i(0,0);o.toNumber=function(){return 0},o.zzEncode=o.zzDecode=function(){return this},o.length=function(){return 1};var s=i.zeroHash="\0\0\0\0\0\0\0\0";i.fromNumber=function(e){if(0===e)return o;var t=e<0;t&&(e=-e);var n=e>>>0,r=(e-n)/4294967296>>>0;return t&&(r=~r>>>0,n=~n>>>0,++n>4294967295&&(n=0,++r>4294967295&&(r=0))),new i(n,r)},i.from=function(e){if("number"===typeof e)return i.fromNumber(e);if(r.isString(e)){if(!r.Long)return i.fromNumber(parseInt(e,10));e=r.Long.fromString(e)}return e.low||e.high?new i(e.low>>>0,e.high>>>0):o},i.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+4294967296*n)}return this.lo+4294967296*this.hi},i.prototype.toLong=function(e){return r.Long?new r.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var a=String.prototype.charCodeAt;i.fromHash=function(e){return e===s?o:new i((a.call(e,0)|a.call(e,1)<<8|a.call(e,2)<<16|a.call(e,3)<<24)>>>0,(a.call(e,4)|a.call(e,5)<<8|a.call(e,6)<<16|a.call(e,7)<<24)>>>0)},i.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},i.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},i.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},i.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10}},39584:function(e,t,n){"use strict";var r=t;function i(e,t,n){for(var r=Object.keys(t),i=0;i<r.length;++i)void 0!==e[r[i]]&&n||(e[r[i]]=t[r[i]]);return e}function o(e){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&i(this,n)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return e},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}r.asPromise=n(17206),r.base64=n(70001),r.EventEmitter=n(27111),r.float=n(30802),r.inquire=n(77172),r.utf8=n(93861),r.pool=n(58236),r.LongBits=n(46880),r.isNode=Boolean("undefined"!==typeof n.g&&n.g&&n.g.process&&n.g.process.versions&&n.g.process.versions.node),r.global=r.isNode&&n.g||"undefined"!==typeof window&&window||"undefined"!==typeof self&&self||this,r.emptyArray=Object.freeze?Object.freeze([]):[],r.emptyObject=Object.freeze?Object.freeze({}):{},r.isInteger=Number.isInteger||function(e){return"number"===typeof e&&isFinite(e)&&Math.floor(e)===e},r.isString=function(e){return"string"===typeof e||e instanceof String},r.isObject=function(e){return e&&"object"===typeof e},r.isset=r.isSet=function(e,t){var n=e[t];return!(null==n||!e.hasOwnProperty(t))&&("object"!==typeof n||(Array.isArray(n)?n.length:Object.keys(n).length)>0)},r.Buffer=function(){try{var e=r.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(t){return null}}(),r._Buffer_from=null,r._Buffer_allocUnsafe=null,r.newBuffer=function(e){return"number"===typeof e?r.Buffer?r._Buffer_allocUnsafe(e):new r.Array(e):r.Buffer?r._Buffer_from(e):"undefined"===typeof Uint8Array?e:new Uint8Array(e)},r.Array="undefined"!==typeof Uint8Array?Uint8Array:Array,r.Long=r.global.dcodeIO&&r.global.dcodeIO.Long||r.global.Long||r.inquire("long"),r.key2Re=/^true|false|0|1$/,r.key32Re=/^-?(?:0|[1-9][0-9]*)$/,r.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,r.longToHash=function(e){return e?r.LongBits.from(e).toHash():r.LongBits.zeroHash},r.longFromHash=function(e,t){var n=r.LongBits.fromHash(e);return r.Long?r.Long.fromBits(n.lo,n.hi,t):n.toNumber(Boolean(t))},r.merge=i,r.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},r.newError=o,r.ProtocolError=o("ProtocolError"),r.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var e=Object.keys(this),n=e.length-1;n>-1;--n)if(1===t[e[n]]&&void 0!==this[e[n]]&&null!==this[e[n]])return e[n]}},r.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}},r.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},r._configure=function(){var e=r.Buffer;e?(r._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,n){return new e(t,n)},r._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):r._Buffer_from=r._Buffer_allocUnsafe=null}},39800:(e,t,n)=>{"use strict";e.exports=h;var r,i=n(39584),o=i.LongBits,s=i.base64,a=i.utf8;function c(e,t,n){this.fn=e,this.len=t,this.next=void 0,this.val=n}function l(){}function u(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function h(){this.len=0,this.head=new c(l,0,0),this.tail=this.head,this.states=null}var d=function(){return i.Buffer?function(){return(h.create=function(){return new r})()}:function(){return new h}};function f(e,t,n){t[n]=255&e}function p(e,t){this.len=e,this.next=void 0,this.val=t}function g(e,t,n){for(;e.hi;)t[n++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[n++]=127&e.lo|128,e.lo=e.lo>>>7;t[n++]=e.lo}function y(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}h.create=d(),h.alloc=function(e){return new i.Array(e)},i.Array!==Array&&(h.alloc=i.pool(h.alloc,i.Array.prototype.subarray)),h.prototype._push=function(e,t,n){return this.tail=this.tail.next=new c(e,t,n),this.len+=t,this},p.prototype=Object.create(c.prototype),p.prototype.fn=function(e,t,n){for(;e>127;)t[n++]=127&e|128,e>>>=7;t[n]=e},h.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new p((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},h.prototype.int32=function(e){return e<0?this._push(g,10,o.fromNumber(e)):this.uint32(e)},h.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},h.prototype.uint64=function(e){var t=o.from(e);return this._push(g,t.length(),t)},h.prototype.int64=h.prototype.uint64,h.prototype.sint64=function(e){var t=o.from(e).zzEncode();return this._push(g,t.length(),t)},h.prototype.bool=function(e){return this._push(f,1,e?1:0)},h.prototype.fixed32=function(e){return this._push(y,4,e>>>0)},h.prototype.sfixed32=h.prototype.fixed32,h.prototype.fixed64=function(e){var t=o.from(e);return this._push(y,4,t.lo)._push(y,4,t.hi)},h.prototype.sfixed64=h.prototype.fixed64,h.prototype.float=function(e){return this._push(i.float.writeFloatLE,4,e)},h.prototype.double=function(e){return this._push(i.float.writeDoubleLE,8,e)};var m=i.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var r=0;r<e.length;++r)t[n+r]=e[r]};h.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(f,1,0);if(i.isString(e)){var n=h.alloc(t=s.length(e));s.decode(e,n,0),e=n}return this.uint32(t)._push(m,t,e)},h.prototype.string=function(e){var t=a.length(e);return t?this.uint32(t)._push(a.write,t,e):this._push(f,1,0)},h.prototype.fork=function(){return this.states=new u(this),this.head=this.tail=new c(l,0,0),this.len=0,this},h.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new c(l,0,0),this.len=0),this},h.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this},h.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t},h._configure=function(e){r=e,h.create=d(),r._configure()}},96489:(e,t,n)=>{"use strict";e.exports=o;var r=n(39800);(o.prototype=Object.create(r.prototype)).constructor=o;var i=n(39584);function o(){r.call(this)}function s(e,t,n){e.length<40?i.utf8.write(e,t,n):t.utf8Write?t.utf8Write(e,n):t.write(e,n)}o._configure=function(){o.alloc=i._Buffer_allocUnsafe,o.writeBytesBuffer=i.Buffer&&i.Buffer.prototype instanceof Uint8Array&&"set"===i.Buffer.prototype.set.name?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var r=0;r<e.length;)t[n++]=e[r++]}},o.prototype.bytes=function(e){i.isString(e)&&(e=i._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(o.writeBytesBuffer,t,e),this},o.prototype.string=function(e){var t=i.Buffer.byteLength(e);return this.uint32(t),t&&this._push(s,t,e),this},o._configure()},839:(e,t,n)=>{"use strict";n.r(t),n.d(t,{code:()=>It,decode:()=>Tt,encode:()=>Ct,name:()=>_t});const r=["string","number","bigint","symbol"],i=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function o(e){if(null===e)return"null";if(void 0===e)return"undefined";if(!0===e||!1===e)return"boolean";const t=typeof e;if(r.includes(t))return t;if("function"===t)return"Function";if(Array.isArray(e))return"Array";if(function(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}(e))return"Buffer";const n=function(e){const t=Object.prototype.toString.call(e).slice(8,-1);if(i.includes(t))return t;return}(e);return n||"Object"}class s{constructor(e,t,n){this.major=e,this.majorEncoded=e<<5,this.name=t,this.terminal=n}toString(){return"Type[".concat(this.major,"].").concat(this.name)}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}}s.uint=new s(0,"uint",!0),s.negint=new s(1,"negint",!0),s.bytes=new s(2,"bytes",!0),s.string=new s(3,"string",!0),s.array=new s(4,"array",!1),s.map=new s(5,"map",!1),s.tag=new s(6,"tag",!1),s.float=new s(7,"float",!0),s.false=new s(7,"false",!0),s.true=new s(7,"true",!0),s.null=new s(7,"null",!0),s.undefined=new s(7,"undefined",!0),s.break=new s(7,"break",!0);class a{constructor(e,t,n){this.type=e,this.value=t,this.encodedLength=n,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return"Token[".concat(this.type,"].").concat(this.value)}}const c=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&"function"===typeof globalThis.Buffer.isBuffer,l=new TextDecoder,u=new TextEncoder;function h(e){return c&&globalThis.Buffer.isBuffer(e)}function d(e){return e instanceof Uint8Array?h(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e:Uint8Array.from(e)}const f=c?(e,t,n)=>n-t>64?globalThis.Buffer.from(e.subarray(t,n)).toString("utf8"):w(e,t,n):(e,t,n)=>n-t>64?l.decode(e.subarray(t,n)):w(e,t,n),p=c?e=>e.length>64?globalThis.Buffer.from(e):b(e):e=>e.length>64?u.encode(e):b(e),g=e=>Uint8Array.from(e),y=c?(e,t,n)=>h(e)?new Uint8Array(e.subarray(t,n)):e.slice(t,n):(e,t,n)=>e.slice(t,n),m=c?(e,t)=>(e=e.map((e=>e instanceof Uint8Array?e:globalThis.Buffer.from(e))),d(globalThis.Buffer.concat(e,t))):(e,t)=>{const n=new Uint8Array(t);let r=0;for(let i of e)r+i.length>n.length&&(i=i.subarray(0,n.length-r)),n.set(i,r),r+=i.length;return n},v=c?e=>globalThis.Buffer.allocUnsafe(e):e=>new Uint8Array(e);function b(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t}function w(e,t,n){const r=[];for(;t<n;){const i=e[t];let o=null,s=i>239?4:i>223?3:i>191?2:1;if(t+s<=n){let n,r,a,c;switch(s){case 1:i<128&&(o=i);break;case 2:n=e[t+1],128===(192&n)&&(c=(31&i)<<6|63&n,c>127&&(o=c));break;case 3:n=e[t+1],r=e[t+2],128===(192&n)&&128===(192&r)&&(c=(15&i)<<12|(63&n)<<6|63&r,c>2047&&(c<55296||c>57343)&&(o=c));break;case 4:n=e[t+1],r=e[t+2],a=e[t+3],128===(192&n)&&128===(192&r)&&128===(192&a)&&(c=(15&i)<<18|(63&n)<<12|(63&r)<<6|63&a,c>65535&&c<1114112&&(o=c))}}null===o?(o=65533,s=1):o>65535&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|1023&o),r.push(o),t+=s}return function(e){const t=e.length;if(t<=E)return String.fromCharCode.apply(String,e);let n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=E));return n}(r)}const E=4096;class A{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:256;this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),null!==this._initReuseChunk&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let t=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){const n=t.length-(this.maxCursor-this.cursor)-1;t.set(e,n)}else{if(t){const e=t.length-(this.maxCursor-this.cursor)-1;e<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,e),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(t=v(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,null===this._initReuseChunk&&(this._initReuseChunk=t),t.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(){let e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(1===this.chunks.length){const n=this.chunks[0];t&&this.cursor>n.length/2?(e=this.cursor===n.length?n:n.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):e=y(n,0,this.cursor)}else e=m(this.chunks,this.cursor);return t&&this.reset(),e}}const S="CBOR decode error:",_="CBOR encode error:",I=[];function C(e,t,n){if(e.length-t<n)throw new Error("".concat(S," not enough data for type"))}I[23]=1,I[24]=2,I[25]=3,I[26]=5,I[27]=9;const T=[24,256,65536,4294967296,BigInt("18446744073709551616")];function k(e,t,n){C(e,t,1);const r=e[t];if(!0===n.strict&&r<T[0])throw new Error("".concat(S," integer encoded in more bytes than necessary (strict decode)"));return r}function R(e,t,n){C(e,t,2);const r=e[t]<<8|e[t+1];if(!0===n.strict&&r<T[1])throw new Error("".concat(S," integer encoded in more bytes than necessary (strict decode)"));return r}function x(e,t,n){C(e,t,4);const r=16777216*e[t]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];if(!0===n.strict&&r<T[2])throw new Error("".concat(S," integer encoded in more bytes than necessary (strict decode)"));return r}function P(e,t,n){C(e,t,8);const r=16777216*e[t]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3],i=16777216*e[t+4]+(e[t+5]<<16)+(e[t+6]<<8)+e[t+7],o=(BigInt(r)<<BigInt(32))+BigInt(i);if(!0===n.strict&&o<T[3])throw new Error("".concat(S," integer encoded in more bytes than necessary (strict decode)"));if(o<=Number.MAX_SAFE_INTEGER)return Number(o);if(!0===n.allowBigInt)return o;throw new Error("".concat(S," integers outside of the safe integer range are not supported"))}function D(e,t){return O(e,0,t.value)}function O(e,t,n){if(n<T[0]){const r=Number(n);e.push([t|r])}else if(n<T[1]){const r=Number(n);e.push([24|t,r])}else if(n<T[2]){const r=Number(n);e.push([25|t,r>>>8,255&r])}else if(n<T[3]){const r=Number(n);e.push([26|t,r>>>24&255,r>>>16&255,r>>>8&255,255&r])}else{const r=BigInt(n);if(!(r<T[4]))throw new Error("".concat(S," encountered BigInt larger than allowable range"));{const n=[27|t,0,0,0,0,0,0,0];let i=Number(r&BigInt(4294967295)),o=Number(r>>BigInt(32)&BigInt(4294967295));n[8]=255&i,i>>=8,n[7]=255&i,i>>=8,n[6]=255&i,i>>=8,n[5]=255&i,n[4]=255&o,o>>=8,n[3]=255&o,o>>=8,n[2]=255&o,o>>=8,n[1]=255&o,e.push(n)}}}D.encodedSize=function(e){return O.encodedSize(e.value)},O.encodedSize=function(e){return e<T[0]?1:e<T[1]?2:e<T[2]?3:e<T[3]?5:9},D.compareTokens=function(e,t){return e.value<t.value?-1:e.value>t.value?1:0};const N=BigInt(-1),B=BigInt(1);function L(e,t){const n=t.value,r="bigint"===typeof n?n*N-B:-1*n-1;O(e,t.type.majorEncoded,r)}function M(e,t,n,r){C(e,t,n+r);const i=y(e,t+n,t+n+r);return new a(s.bytes,i,n+r)}function U(e,t,n,r){return M(e,t,1,n)}function F(e){return void 0===e.encodedBytes&&(e.encodedBytes=e.type===s.string?p(e.value):e.value),e.encodedBytes}function K(e,t){const n=F(t);O(e,t.type.majorEncoded,n.length),e.push(n)}function j(e,t,n,r,i){const o=n+r;C(e,t,o);const c=new a(s.string,f(e,t+n,t+o),o);return!0===i.retainStringBytes&&(c.byteValue=y(e,t+n,t+o)),c}function Z(e,t,n,r){return j(e,t,1,n,r)}L.encodedSize=function(e){const t=e.value,n="bigint"===typeof t?t*N-B:-1*t-1;return n<T[0]?1:n<T[1]?2:n<T[2]?3:n<T[3]?5:9},L.compareTokens=function(e,t){return e.value<t.value?1:e.value>t.value?-1:0},K.encodedSize=function(e){const t=F(e);return O.encodedSize(t.length)+t.length},K.compareTokens=function(e,t){return n=F(e),r=F(t),n.length<r.length?-1:n.length>r.length?1:function(e,t){if(h(e)&&h(t))return e.compare(t);for(let n=0;n<e.length;n++)if(e[n]!==t[n])return e[n]<t[n]?-1:1;return 0}(n,r);var n,r};const z=K;function V(e,t,n,r){return new a(s.array,r,n)}function H(e,t,n,r){return V(0,0,1,n)}function q(e,t){O(e,s.array.majorEncoded,t.value)}function G(e,t,n,r){return new a(s.map,r,n)}function W(e,t,n,r){return G(0,0,1,n)}function Q(e,t){O(e,s.map.majorEncoded,t.value)}function Y(e,t,n,r){return new a(s.tag,n,1)}function J(e,t){O(e,s.tag.majorEncoded,t.value)}q.compareTokens=D.compareTokens,q.encodedSize=function(e){return O.encodedSize(e.value)},Q.compareTokens=D.compareTokens,Q.encodedSize=function(e){return O.encodedSize(e.value)},J.compareTokens=D.compareTokens,J.encodedSize=function(e){return O.encodedSize(e.value)};const X=20,$=21,ee=22,te=23;function ne(e,t,n){if(n){if(!1===n.allowNaN&&Number.isNaN(e))throw new Error("".concat(S," NaN values are not supported"));if(!1===n.allowInfinity&&(e===1/0||e===-1/0))throw new Error("".concat(S," Infinity values are not supported"))}return new a(s.float,e,t)}function re(e,t,n){const r=t.value;if(!1===r)e.push([s.float.majorEncoded|X]);else if(!0===r)e.push([s.float.majorEncoded|$]);else if(null===r)e.push([s.float.majorEncoded|ee]);else if(void 0===r)e.push([s.float.majorEncoded|te]);else{let t,o=!1;n&&!0===n.float64||(ae(r),t=ce(se,1),r===t||Number.isNaN(r)?(se[0]=249,e.push(se.slice(0,3)),o=!0):(le(r),t=ue(se,1),r===t&&(se[0]=250,e.push(se.slice(0,5)),o=!0))),o||(i=r,oe.setFloat64(0,i,!1),t=he(se,1),se[0]=251,e.push(se.slice(0,9)))}var i}re.encodedSize=function(e,t){const n=e.value;if(!1===n||!0===n||null===n||void 0===n)return 1;if(!t||!0!==t.float64){ae(n);let e=ce(se,1);if(n===e||Number.isNaN(n))return 3;if(le(n),e=ue(se,1),n===e)return 5}return 9};const ie=new ArrayBuffer(9),oe=new DataView(ie,1),se=new Uint8Array(ie,0);function ae(e){if(e===1/0)oe.setUint16(0,31744,!1);else if(e===-1/0)oe.setUint16(0,64512,!1);else if(Number.isNaN(e))oe.setUint16(0,32256,!1);else{oe.setFloat32(0,e);const t=oe.getUint32(0),n=(2139095040&t)>>23,r=8388607&t;if(255===n)oe.setUint16(0,31744,!1);else if(0===n)oe.setUint16(0,(2147483648&e)>>16|r>>13,!1);else{const e=n-127;e<-24?oe.setUint16(0,0):e<-14?oe.setUint16(0,(2147483648&t)>>16|1<<24+e,!1):oe.setUint16(0,(2147483648&t)>>16|e+15<<10|r>>13,!1)}}}function ce(e,t){if(e.length-t<2)throw new Error("".concat(S," not enough data for float16"));const n=(e[t]<<8)+e[t+1];if(31744===n)return 1/0;if(64512===n)return-1/0;if(32256===n)return NaN;const r=n>>10&31,i=1023&n;let o;return o=0===r?i*2**-24:31!==r?(i+1024)*2**(r-25):0===i?1/0:NaN,32768&n?-o:o}function le(e){oe.setFloat32(0,e,!1)}function ue(e,t){if(e.length-t<4)throw new Error("".concat(S," not enough data for float32"));const n=(e.byteOffset||0)+t;return new DataView(e.buffer,n,4).getFloat32(0,!1)}function he(e,t){if(e.length-t<8)throw new Error("".concat(S," not enough data for float64"));const n=(e.byteOffset||0)+t;return new DataView(e.buffer,n,8).getFloat64(0,!1)}function de(e,t,n){throw new Error("".concat(S," encountered invalid minor (").concat(n,") for major ").concat(e[t]>>>5))}function fe(e){return()=>{throw new Error("".concat(S," ").concat(e))}}re.compareTokens=D.compareTokens;const pe=[];for(let kt=0;kt<=23;kt++)pe[kt]=de;pe[24]=function(e,t,n,r){return new a(s.uint,k(e,t+1,r),2)},pe[25]=function(e,t,n,r){return new a(s.uint,R(e,t+1,r),3)},pe[26]=function(e,t,n,r){return new a(s.uint,x(e,t+1,r),5)},pe[27]=function(e,t,n,r){return new a(s.uint,P(e,t+1,r),9)},pe[28]=de,pe[29]=de,pe[30]=de,pe[31]=de;for(let kt=32;kt<=55;kt++)pe[kt]=de;pe[56]=function(e,t,n,r){return new a(s.negint,-1-k(e,t+1,r),2)},pe[57]=function(e,t,n,r){return new a(s.negint,-1-R(e,t+1,r),3)},pe[58]=function(e,t,n,r){return new a(s.negint,-1-x(e,t+1,r),5)},pe[59]=function(e,t,n,r){const i=P(e,t+1,r);if("bigint"!==typeof i){const e=-1-i;if(e>=Number.MIN_SAFE_INTEGER)return new a(s.negint,e,9)}if(!0!==r.allowBigInt)throw new Error("".concat(S," integers outside of the safe integer range are not supported"));return new a(s.negint,N-BigInt(i),9)},pe[60]=de,pe[61]=de,pe[62]=de,pe[63]=de;for(let kt=64;kt<=87;kt++)pe[kt]=U;pe[88]=function(e,t,n,r){return M(e,t,2,k(e,t+1,r))},pe[89]=function(e,t,n,r){return M(e,t,3,R(e,t+1,r))},pe[90]=function(e,t,n,r){return M(e,t,5,x(e,t+1,r))},pe[91]=function(e,t,n,r){const i=P(e,t+1,r);if("bigint"===typeof i)throw new Error("".concat(S," 64-bit integer bytes lengths not supported"));return M(e,t,9,i)},pe[92]=de,pe[93]=de,pe[94]=de,pe[95]=fe("indefinite length bytes/strings are not supported");for(let kt=96;kt<=119;kt++)pe[kt]=Z;pe[120]=function(e,t,n,r){return j(e,t,2,k(e,t+1,r),r)},pe[121]=function(e,t,n,r){return j(e,t,3,R(e,t+1,r),r)},pe[122]=function(e,t,n,r){return j(e,t,5,x(e,t+1,r),r)},pe[123]=function(e,t,n,r){const i=P(e,t+1,r);if("bigint"===typeof i)throw new Error("".concat(S," 64-bit integer string lengths not supported"));return j(e,t,9,i,r)},pe[124]=de,pe[125]=de,pe[126]=de,pe[127]=fe("indefinite length bytes/strings are not supported");for(let kt=128;kt<=151;kt++)pe[kt]=H;pe[152]=function(e,t,n,r){return V(0,0,2,k(e,t+1,r))},pe[153]=function(e,t,n,r){return V(0,0,3,R(e,t+1,r))},pe[154]=function(e,t,n,r){return V(0,0,5,x(e,t+1,r))},pe[155]=function(e,t,n,r){const i=P(e,t+1,r);if("bigint"===typeof i)throw new Error("".concat(S," 64-bit integer array lengths not supported"));return V(0,0,9,i)},pe[156]=de,pe[157]=de,pe[158]=de,pe[159]=function(e,t,n,r){if(!1===r.allowIndefinite)throw new Error("".concat(S," indefinite length items not allowed"));return V(0,0,1,1/0)};for(let kt=160;kt<=183;kt++)pe[kt]=W;pe[184]=function(e,t,n,r){return G(0,0,2,k(e,t+1,r))},pe[185]=function(e,t,n,r){return G(0,0,3,R(e,t+1,r))},pe[186]=function(e,t,n,r){return G(0,0,5,x(e,t+1,r))},pe[187]=function(e,t,n,r){const i=P(e,t+1,r);if("bigint"===typeof i)throw new Error("".concat(S," 64-bit integer map lengths not supported"));return G(0,0,9,i)},pe[188]=de,pe[189]=de,pe[190]=de,pe[191]=function(e,t,n,r){if(!1===r.allowIndefinite)throw new Error("".concat(S," indefinite length items not allowed"));return G(0,0,1,1/0)};for(let kt=192;kt<=215;kt++)pe[kt]=Y;pe[216]=function(e,t,n,r){return new a(s.tag,k(e,t+1,r),2)},pe[217]=function(e,t,n,r){return new a(s.tag,R(e,t+1,r),3)},pe[218]=function(e,t,n,r){return new a(s.tag,x(e,t+1,r),5)},pe[219]=function(e,t,n,r){return new a(s.tag,P(e,t+1,r),9)},pe[220]=de,pe[221]=de,pe[222]=de,pe[223]=de;for(let kt=224;kt<=243;kt++)pe[kt]=fe("simple values are not supported");pe[244]=de,pe[245]=de,pe[246]=de,pe[247]=function(e,t,n,r){if(!1===r.allowUndefined)throw new Error("".concat(S," undefined values are not supported"));return!0===r.coerceUndefinedToNull?new a(s.null,null,1):new a(s.undefined,void 0,1)},pe[248]=fe("simple values are not supported"),pe[249]=function(e,t,n,r){return ne(ce(e,t+1),3,r)},pe[250]=function(e,t,n,r){return ne(ue(e,t+1),5,r)},pe[251]=function(e,t,n,r){return ne(he(e,t+1),9,r)},pe[252]=de,pe[253]=de,pe[254]=de,pe[255]=function(e,t,n,r){if(!1===r.allowIndefinite)throw new Error("".concat(S," indefinite length items not allowed"));return new a(s.break,void 0,1)};const ge=[];for(let kt=0;kt<24;kt++)ge[kt]=new a(s.uint,kt,1);for(let kt=-1;kt>=-24;kt--)ge[31-kt]=new a(s.negint,kt,1);ge[64]=new a(s.bytes,new Uint8Array(0),1),ge[96]=new a(s.string,"",1),ge[128]=new a(s.array,0,1),ge[160]=new a(s.map,0,1),ge[244]=new a(s.false,!1,1),ge[245]=new a(s.true,!0,1),ge[246]=new a(s.null,null,1);const ye={float64:!1,mapSorter:function(e,t){const n=Array.isArray(e[0])?e[0][0]:e[0],r=Array.isArray(t[0])?t[0][0]:t[0];if(n.type!==r.type)return n.type.compare(r.type);const i=n.type.major,o=me[i].compareTokens(n,r);0===o&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone");return o},quickEncodeToken:function(e){switch(e.type){case s.false:return g([244]);case s.true:return g([245]);case s.null:return g([246]);case s.bytes:return e.value.length?void 0:g([64]);case s.string:return""===e.value?g([96]):void 0;case s.array:return 0===e.value?g([128]):void 0;case s.map:return 0===e.value?g([160]):void 0;case s.uint:return e.value<24?g([Number(e.value)]):void 0;case s.negint:if(e.value>=-24)return g([31-Number(e.value)])}}};const me=function(){const e=[];return e[s.uint.major]=D,e[s.negint.major]=L,e[s.bytes.major]=K,e[s.string.major]=z,e[s.array.major]=q,e[s.map.major]=Q,e[s.tag.major]=J,e[s.float.major]=re,e}(),ve=new A;class be{constructor(e,t){this.obj=e,this.parent=t}includes(e){let t=this;do{if(t.obj===e)return!0}while(t=t.parent);return!1}static createCheck(e,t){if(e&&e.includes(t))throw new Error("".concat(_," object contains circular references"));return new be(t,e)}}const we={null:new a(s.null,null),undefined:new a(s.undefined,void 0),true:new a(s.true,!0),false:new a(s.false,!1),emptyArray:new a(s.array,0),emptyMap:new a(s.map,0)},Ee={number:(e,t,n,r)=>Number.isInteger(e)&&Number.isSafeInteger(e)?new a(e>=0?s.uint:s.negint,e):new a(s.float,e),bigint:(e,t,n,r)=>e>=BigInt(0)?new a(s.uint,e):new a(s.negint,e),Uint8Array:(e,t,n,r)=>new a(s.bytes,e),string:(e,t,n,r)=>new a(s.string,e),boolean:(e,t,n,r)=>e?we.true:we.false,null:(e,t,n,r)=>we.null,undefined:(e,t,n,r)=>we.undefined,ArrayBuffer:(e,t,n,r)=>new a(s.bytes,new Uint8Array(e)),DataView:(e,t,n,r)=>new a(s.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),Array(e,t,n,r){if(!e.length)return!0===n.addBreakTokens?[we.emptyArray,new a(s.break)]:we.emptyArray;r=be.createCheck(r,e);const i=[];let o=0;for(const s of e)i[o++]=Ae(s,n,r);return n.addBreakTokens?[new a(s.array,e.length),i,new a(s.break)]:[new a(s.array,e.length),i]},Object(e,t,n,r){const i="Object"!==t,o=i?e.keys():Object.keys(e),c=i?e.size:o.length;if(!c)return!0===n.addBreakTokens?[we.emptyMap,new a(s.break)]:we.emptyMap;r=be.createCheck(r,e);const l=[];let u=0;for(const s of o)l[u++]=[Ae(s,n,r),Ae(i?e.get(s):e[s],n,r)];return function(e,t){t.mapSorter&&e.sort(t.mapSorter)}(l,n),n.addBreakTokens?[new a(s.map,c),l,new a(s.break)]:[new a(s.map,c),l]}};Ee.Map=Ee.Object,Ee.Buffer=Ee.Uint8Array;for(const kt of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))Ee["".concat(kt,"Array")]=Ee.DataView;function Ae(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const r=o(e),i=t&&t.typeEncoders&&t.typeEncoders[r]||Ee[r];if("function"===typeof i){const o=i(e,r,t,n);if(null!=o)return o}const s=Ee[r];if(!s)throw new Error("".concat(_," unsupported type: ").concat(r));return s(e,r,t,n)}function Se(e,t,n,r){if(Array.isArray(t))for(const i of t)Se(e,i,n,r);else n[t.type.major](e,t,r)}function _e(e,t,n){const r=Ae(e,n);if(!Array.isArray(r)&&n.quickEncodeToken){const e=n.quickEncodeToken(r);if(e)return e;const i=t[r.type.major];if(i.encodedSize){const e=i.encodedSize(r,n),t=new A(e);if(i(t,r,n),1!==t.chunks.length)throw new Error("Unexpected error: pre-calculated length for ".concat(r," was wrong"));return d(t.chunks[0])}}return ve.reset(),Se(ve,r,t,n),ve.toBytes(!0)}const Ie={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class Ce{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._pos=0,this.data=e,this.options=t}pos(){return this._pos}done(){return this._pos>=this.data.length}next(){const e=this.data[this._pos];let t=ge[e];if(void 0===t){const n=pe[e];if(!n)throw new Error("".concat(S," no decoder for major type ").concat(e>>>5," (byte 0x").concat(e.toString(16).padStart(2,"0"),")"));const r=31&e;t=n(this.data,this._pos,r,this.options)}return this._pos+=t.encodedLength,t}}const Te=Symbol.for("DONE"),ke=Symbol.for("BREAK");function Re(e,t){if(e.done())return Te;const n=e.next();if(n.type===s.break)return ke;if(n.type.terminal)return n.value;if(n.type===s.array)return function(e,t,n){const r=[];for(let i=0;i<e.value;i++){const o=Re(t,n);if(o===ke){if(e.value===1/0)break;throw new Error("".concat(S," got unexpected break to lengthed array"))}if(o===Te)throw new Error("".concat(S," found array but not enough entries (got ").concat(i,", expected ").concat(e.value,")"));r[i]=o}return r}(n,e,t);if(n.type===s.map)return function(e,t,n){const r=!0===n.useMaps,i=r?void 0:{},o=r?new Map:void 0;for(let s=0;s<e.value;s++){const a=Re(t,n);if(a===ke){if(e.value===1/0)break;throw new Error("".concat(S," got unexpected break to lengthed map"))}if(a===Te)throw new Error("".concat(S," found map but not enough entries (got ").concat(s," [no key], expected ").concat(e.value,")"));if(!0!==r&&"string"!==typeof a)throw new Error("".concat(S," non-string keys not supported (got ").concat(typeof a,")"));if(!0===n.rejectDuplicateMapKeys&&(r&&o.has(a)||!r&&a in i))throw new Error("".concat(S,' found repeat map key "').concat(a,'"'));const c=Re(t,n);if(c===Te)throw new Error("".concat(S," found map but not enough entries (got ").concat(s," [no value], expected ").concat(e.value,")"));r?o.set(a,c):i[a]=c}return r?o:i}(n,e,t);if(n.type===s.tag){if(t.tags&&"function"===typeof t.tags[n.value]){const r=Re(e,t);return t.tags[n.value](r)}throw new Error("".concat(S," tag not supported (").concat(n.value,")"))}throw new Error("unsupported")}function xe(e,t){const[n,r]=function(e,t){if(!(e instanceof Uint8Array))throw new Error("".concat(S," data to decode must be a Uint8Array"));const n=(t=Object.assign({},Ie,t)).tokenizer||new Ce(e,t),r=Re(n,t);if(r===Te)throw new Error("".concat(S," did not find any content to decode"));if(r===ke)throw new Error("".concat(S," got unexpected break"));return[r,e.subarray(n.pos())]}(e,t);if(r.length>0)throw new Error("".concat(S," too many terminals, data makes no sense"));return n}var Pe=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==n[s])throw new TypeError(o+" is ambiguous");n[s]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var r=0,i=0;e[t]===c;)r++,t++;for(var o=(e.length-t)*l+1>>>0,s=new Uint8Array(o);e[t];){var u=n[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=o-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*s[d]>>>0,s[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=o-i;f!==o&&0===s[f];)f++;for(var p=new Uint8Array(r+(o-f)),g=r;f!==o;)p[g++]=s[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,o=t.length;i!==o&&0===t[i];)i++,n++;for(var s=(o-i)*u+1>>>0,l=new Uint8Array(s);i!==o;){for(var h=t[i],d=0,f=s-1;(0!==h||d<r)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");r=d,i++}for(var p=s-r;p!==s&&0===l[p];)p++;for(var g=c.repeat(n);p<s;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:h,decode:function(e){var n=h(e);if(n)return n;throw new Error("Non-".concat(t," character"))}}};const De=Pe,Oe=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class Ne{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(e));throw Error("Unknown type, must be binary type")}}class Be{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(e),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return Me(this,e)}}class Le{constructor(e){this.decoders=e}or(e){return Me(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(e),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}}const Me=(e,t)=>new Le({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class Ue{constructor(e,t,n,r){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=r,this.encoder=new Ne(e,t,n),this.decoder=new Be(e,t,r)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Fe=e=>{let{name:t,prefix:n,encode:r,decode:i}=e;return new Ue(t,n,r,i)},Ke=e=>{let{prefix:t,name:n,alphabet:r}=e;const{encode:i,decode:o}=De(r,n);return Fe({prefix:t,name:n,encode:i,decode:e=>Oe(o(e))})},je=e=>{let{name:t,prefix:n,bitsPerChar:r,alphabet:i}=e;return Fe({prefix:n,name:t,encode:e=>((e,t,n)=>{const r="="===t[t.length-1],i=(1<<n)-1;let o="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>n;)s-=n,o+=t[i&a>>s];if(s&&(o+=t[i&a<<n-s]),r)for(;o.length*n&7;)o+="=";return o})(e,i,r),decode:e=>((e,t,n,r)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*n/8|0);let a=0,c=0,l=0;for(let u=0;u<o;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError("Non-".concat(r," character"));c=c<<n|t,a+=n,a>=8&&(a-=8,s[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s})(e,i,r,t)})},Ze=je({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),ze=(je({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),je({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),je({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),je({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),je({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),je({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),je({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),je({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Ke({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}));Ke({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Ve=function e(t,n,r){n=n||[];var i=r=r||0;for(;t>=Ge;)n[r++]=255&t|He,t/=128;for(;t&qe;)n[r++]=255&t|He,t>>>=7;return n[r]=0|t,e.bytes=r-i+1,n},He=128,qe=-128,Ge=Math.pow(2,31);var We=function e(t,n){var r,i=0,o=0,s=n=n||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");r=t[s++],i+=o<28?(r&Ye)<<o:(r&Ye)*Math.pow(2,o),o+=7}while(r>=Qe);return e.bytes=s-n,i},Qe=128,Ye=127;var Je=Math.pow(2,7),Xe=Math.pow(2,14),$e=Math.pow(2,21),et=Math.pow(2,28),tt=Math.pow(2,35),nt=Math.pow(2,42),rt=Math.pow(2,49),it=Math.pow(2,56),ot=Math.pow(2,63);const st={encode:Ve,decode:We,encodingLength:function(e){return e<Je?1:e<Xe?2:e<$e?3:e<et?4:e<tt?5:e<nt?6:e<rt?7:e<it?8:e<ot?9:10}},at=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return[st.decode(e,t),st.decode.bytes]},ct=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return st.encode(e,t,n),t},lt=e=>st.encodingLength(e);class ut{constructor(e,t,n,r){this.code=e,this.size=t,this.digest=n,this.bytes=r}}const ht=(e,t)=>{const{bytes:n,version:r}=e;return 0===r?yt(n,ft(e),t||ze.encoder):mt(n,ft(e),t||Ze.encoder)},dt=new WeakMap,ft=e=>{const t=dt.get(e);if(null==t){const t=new Map;return dt.set(e,t),t}return t};class pt{constructor(e,t,n,r){this.code=t,this.version=e,this.multihash=n,this.bytes=r,this["/"]=r}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==vt)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==bt)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return pt.createV0(t)}default:throw Error("Can not convert CID version ".concat(this.version," to version 0. This is a bug please report"))}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=((e,t)=>{const n=t.byteLength,r=lt(e),i=r+lt(n),o=new Uint8Array(i+n);return ct(e,o,0),ct(n,o,r),o.set(t,i),new ut(e,n,t,o)})(e,t);return pt.createV1(this.code,n)}case 1:return this;default:throw Error("Can not convert CID version ".concat(this.version," to version 1. This is a bug please report"))}}equals(e){return pt.equals(this,e)}static equals(e,t){const n=t;return n&&e.code===n.code&&e.version===n.version&&((e,t)=>{if(e===t)return!0;{const n=t;return e.code===n.code&&e.size===n.size&&n.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0})(e.bytes,n.bytes)}})(e.multihash,n.multihash)}toString(e){return ht(this,e)}toJSON(){return{"/":ht(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID(".concat(this.toString(),")")}static asCID(e){if(null==e)return null;const t=e;if(t instanceof pt)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:n,multihash:r,bytes:i}=t;return new pt(e,n,r,i||wt(e,n,r.bytes))}if(!0===t[Et]){const{version:e,multihash:n,code:r}=t,i=(e=>{const t=Oe(e),[n,r]=at(t),[i,o]=at(t.subarray(r)),s=t.subarray(r+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new ut(n,i,s,t)})(n);return pt.create(e,r,i)}return null}static create(e,t,n){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==vt)throw new Error("Version 0 CID must use dag-pb (code: ".concat(vt,") block encoding"));return new pt(e,t,n,n.bytes);case 1:{const r=wt(e,t,n.bytes);return new pt(e,t,n,r)}default:throw new Error("Invalid version")}}static createV0(e){return pt.create(0,vt,e)}static createV1(e,t){return pt.create(1,e,t)}static decode(e){const[t,n]=pt.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=pt.inspectBytes(e),n=t.size-t.multihashSize,r=Oe(e.subarray(n,n+t.multihashSize));if(r.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=r.subarray(t.multihashSize-t.digestSize),o=new ut(t.multihashCode,t.digestSize,i,r);return[0===t.version?pt.createV0(o):pt.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[n,r]=at(e.subarray(t));return t+=r,n};let r=n(),i=vt;if(18===r?(r=0,t=0):i=n(),0!==r&&1!==r)throw new RangeError("Invalid CID version ".concat(r));const o=t,s=n(),a=n(),c=t+a;return{version:r,codec:i,multihashCode:s,digestSize:a,multihashSize:c-o,size:c}}static parse(e,t){const[n,r]=gt(e,t),i=pt.decode(r);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return ft(i).set(n,e),i}}const gt=(e,t)=>{switch(e[0]){case"Q":{const n=t||ze;return[ze.prefix,n.decode("".concat(ze.prefix).concat(e))]}case ze.prefix:{const n=t||ze;return[ze.prefix,n.decode(e)]}case Ze.prefix:{const n=t||Ze;return[Ze.prefix,n.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},yt=(e,t,n)=>{const{prefix:r}=n;if(r!==ze.prefix)throw Error("Cannot string encode V0 in ".concat(n.name," encoding"));const i=t.get(r);if(null==i){const i=n.encode(e).slice(1);return t.set(r,i),i}return i},mt=(e,t,n)=>{const{prefix:r}=n,i=t.get(r);if(null==i){const i=n.encode(e);return t.set(r,i),i}return i},vt=112,bt=18,wt=(e,t,n)=>{const r=lt(e),i=r+lt(t),o=new Uint8Array(i+n.byteLength);return ct(e,o,0),ct(t,o,r),o.set(n,i),o},Et=Symbol.for("@ipld/js-cid/CID");const At={float64:!0,typeEncoders:{Object:function(e){if(e.asCID!==e&&e["/"]!==e.bytes)return null;const t=pt.asCID(e);if(!t)return null;const n=new Uint8Array(t.bytes.byteLength+1);return n.set(t.bytes,1),[new a(s.tag,42),new a(s.bytes,n)]},undefined:function(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")},number:function(e){if(Number.isNaN(e))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(e===1/0||e===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}}};const St={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};St.tags[42]=function(e){if(0!==e[0])throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return pt.decode(e.subarray(1))};const _t="dag-cbor",It=113,Ct=e=>{return t=e,n=At,n=Object.assign({},ye,n),_e(t,me,n);var t,n},Tt=e=>xe(e,St)},1315:(e,t,n)=>{"use strict";n.r(t),n.d(t,{code:()=>xt,decode:()=>Dt,encode:()=>Pt,format:()=>Ot,name:()=>Rt,parse:()=>Bt,stringify:()=>Ot});const r=["string","number","bigint","symbol"],i=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function o(e){if(null===e)return"null";if(void 0===e)return"undefined";if(!0===e||!1===e)return"boolean";const t=typeof e;if(r.includes(t))return t;if("function"===t)return"Function";if(Array.isArray(e))return"Array";if(function(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}(e))return"Buffer";const n=function(e){const t=Object.prototype.toString.call(e).slice(8,-1);if(i.includes(t))return t;return}(e);return n||"Object"}class s{constructor(e,t,n){this.major=e,this.majorEncoded=e<<5,this.name=t,this.terminal=n}toString(){return"Type[".concat(this.major,"].").concat(this.name)}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}}s.uint=new s(0,"uint",!0),s.negint=new s(1,"negint",!0),s.bytes=new s(2,"bytes",!0),s.string=new s(3,"string",!0),s.array=new s(4,"array",!1),s.map=new s(5,"map",!1),s.tag=new s(6,"tag",!1),s.float=new s(7,"float",!0),s.false=new s(7,"false",!0),s.true=new s(7,"true",!0),s.null=new s(7,"null",!0),s.undefined=new s(7,"undefined",!0),s.break=new s(7,"break",!0);class a{constructor(e,t,n){this.type=e,this.value=t,this.encodedLength=n,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return"Token[".concat(this.type,"].").concat(this.value)}}const c=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&"function"===typeof globalThis.Buffer.isBuffer,l=new TextDecoder,u=new TextEncoder;function h(e){return c&&globalThis.Buffer.isBuffer(e)}function d(e){return e instanceof Uint8Array?h(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e:Uint8Array.from(e)}const f=c?(e,t,n)=>n-t>64?globalThis.Buffer.from(e.subarray(t,n)).toString("utf8"):b(e,t,n):(e,t,n)=>n-t>64?l.decode(e.subarray(t,n)):b(e,t,n),p=c?e=>e.length>64?globalThis.Buffer.from(e):v(e):e=>e.length>64?u.encode(e):v(e),g=c?(e,t,n)=>h(e)?new Uint8Array(e.subarray(t,n)):e.slice(t,n):(e,t,n)=>e.slice(t,n),y=c?(e,t)=>(e=e.map((e=>e instanceof Uint8Array?e:globalThis.Buffer.from(e))),d(globalThis.Buffer.concat(e,t))):(e,t)=>{const n=new Uint8Array(t);let r=0;for(let i of e)r+i.length>n.length&&(i=i.subarray(0,n.length-r)),n.set(i,r),r+=i.length;return n},m=c?e=>globalThis.Buffer.allocUnsafe(e):e=>new Uint8Array(e);function v(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t}function b(e,t,n){const r=[];for(;t<n;){const i=e[t];let o=null,s=i>239?4:i>223?3:i>191?2:1;if(t+s<=n){let n,r,a,c;switch(s){case 1:i<128&&(o=i);break;case 2:n=e[t+1],128===(192&n)&&(c=(31&i)<<6|63&n,c>127&&(o=c));break;case 3:n=e[t+1],r=e[t+2],128===(192&n)&&128===(192&r)&&(c=(15&i)<<12|(63&n)<<6|63&r,c>2047&&(c<55296||c>57343)&&(o=c));break;case 4:n=e[t+1],r=e[t+2],a=e[t+3],128===(192&n)&&128===(192&r)&&128===(192&a)&&(c=(15&i)<<18|(63&n)<<12|(63&r)<<6|63&a,c>65535&&c<1114112&&(o=c))}}null===o?(o=65533,s=1):o>65535&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|1023&o),r.push(o),t+=s}return E(r)}const w=4096;function E(e){const t=e.length;if(t<=w)return String.fromCharCode.apply(String,e);let n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=w));return n}class A{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:256;this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),null!==this._initReuseChunk&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let t=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){const n=t.length-(this.maxCursor-this.cursor)-1;t.set(e,n)}else{if(t){const e=t.length-(this.maxCursor-this.cursor)-1;e<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,e),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(t=m(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,null===this._initReuseChunk&&(this._initReuseChunk=t),t.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(){let e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(1===this.chunks.length){const n=this.chunks[0];t&&this.cursor>n.length/2?(e=this.cursor===n.length?n:n.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):e=g(n,0,this.cursor)}else e=y(this.chunks,this.cursor);return t&&this.reset(),e}}const S="CBOR decode error:",_="CBOR encode error:",I=[];function C(e,t,n){if(e.length-t<n)throw new Error("".concat(S," not enough data for type"))}I[23]=1,I[24]=2,I[25]=3,I[26]=5,I[27]=9;const T=[24,256,65536,4294967296,BigInt("18446744073709551616")];function k(e,t,n){C(e,t,1);const r=e[t];if(!0===n.strict&&r<T[0])throw new Error("".concat(S," integer encoded in more bytes than necessary (strict decode)"));return r}function R(e,t,n){C(e,t,2);const r=e[t]<<8|e[t+1];if(!0===n.strict&&r<T[1])throw new Error("".concat(S," integer encoded in more bytes than necessary (strict decode)"));return r}function x(e,t,n){C(e,t,4);const r=16777216*e[t]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];if(!0===n.strict&&r<T[2])throw new Error("".concat(S," integer encoded in more bytes than necessary (strict decode)"));return r}function P(e,t,n){C(e,t,8);const r=16777216*e[t]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3],i=16777216*e[t+4]+(e[t+5]<<16)+(e[t+6]<<8)+e[t+7],o=(BigInt(r)<<BigInt(32))+BigInt(i);if(!0===n.strict&&o<T[3])throw new Error("".concat(S," integer encoded in more bytes than necessary (strict decode)"));if(o<=Number.MAX_SAFE_INTEGER)return Number(o);if(!0===n.allowBigInt)return o;throw new Error("".concat(S," integers outside of the safe integer range are not supported"))}function D(e,t){return O(e,0,t.value)}function O(e,t,n){if(n<T[0]){const r=Number(n);e.push([t|r])}else if(n<T[1]){const r=Number(n);e.push([24|t,r])}else if(n<T[2]){const r=Number(n);e.push([25|t,r>>>8,255&r])}else if(n<T[3]){const r=Number(n);e.push([26|t,r>>>24&255,r>>>16&255,r>>>8&255,255&r])}else{const r=BigInt(n);if(!(r<T[4]))throw new Error("".concat(S," encountered BigInt larger than allowable range"));{const n=[27|t,0,0,0,0,0,0,0];let i=Number(r&BigInt(4294967295)),o=Number(r>>BigInt(32)&BigInt(4294967295));n[8]=255&i,i>>=8,n[7]=255&i,i>>=8,n[6]=255&i,i>>=8,n[5]=255&i,n[4]=255&o,o>>=8,n[3]=255&o,o>>=8,n[2]=255&o,o>>=8,n[1]=255&o,e.push(n)}}}D.encodedSize=function(e){return O.encodedSize(e.value)},O.encodedSize=function(e){return e<T[0]?1:e<T[1]?2:e<T[2]?3:e<T[3]?5:9},D.compareTokens=function(e,t){return e.value<t.value?-1:e.value>t.value?1:0};const N=BigInt(-1),B=BigInt(1);function L(e,t){const n=t.value,r="bigint"===typeof n?n*N-B:-1*n-1;O(e,t.type.majorEncoded,r)}function M(e,t,n,r){C(e,t,n+r);const i=g(e,t+n,t+n+r);return new a(s.bytes,i,n+r)}function U(e,t,n,r){return M(e,t,1,n)}function F(e){return void 0===e.encodedBytes&&(e.encodedBytes=e.type===s.string?p(e.value):e.value),e.encodedBytes}function K(e,t){const n=F(t);O(e,t.type.majorEncoded,n.length),e.push(n)}function j(e,t,n,r,i){const o=n+r;C(e,t,o);const c=new a(s.string,f(e,t+n,t+o),o);return!0===i.retainStringBytes&&(c.byteValue=g(e,t+n,t+o)),c}function Z(e,t,n,r){return j(e,t,1,n,r)}L.encodedSize=function(e){const t=e.value,n="bigint"===typeof t?t*N-B:-1*t-1;return n<T[0]?1:n<T[1]?2:n<T[2]?3:n<T[3]?5:9},L.compareTokens=function(e,t){return e.value<t.value?1:e.value>t.value?-1:0},K.encodedSize=function(e){const t=F(e);return O.encodedSize(t.length)+t.length},K.compareTokens=function(e,t){return n=F(e),r=F(t),n.length<r.length?-1:n.length>r.length?1:function(e,t){if(h(e)&&h(t))return e.compare(t);for(let n=0;n<e.length;n++)if(e[n]!==t[n])return e[n]<t[n]?-1:1;return 0}(n,r);var n,r};const z=K;function V(e,t,n,r){return new a(s.array,r,n)}function H(e,t,n,r){return V(0,0,1,n)}function q(e,t){O(e,s.array.majorEncoded,t.value)}function G(e,t,n,r){return new a(s.map,r,n)}function W(e,t,n,r){return G(0,0,1,n)}function Q(e,t){O(e,s.map.majorEncoded,t.value)}function Y(e,t,n,r){return new a(s.tag,n,1)}function J(e,t){O(e,s.tag.majorEncoded,t.value)}q.compareTokens=D.compareTokens,q.encodedSize=function(e){return O.encodedSize(e.value)},Q.compareTokens=D.compareTokens,Q.encodedSize=function(e){return O.encodedSize(e.value)},J.compareTokens=D.compareTokens,J.encodedSize=function(e){return O.encodedSize(e.value)};const X=20,$=21,ee=22,te=23;function ne(e,t,n){if(n){if(!1===n.allowNaN&&Number.isNaN(e))throw new Error("".concat(S," NaN values are not supported"));if(!1===n.allowInfinity&&(e===1/0||e===-1/0))throw new Error("".concat(S," Infinity values are not supported"))}return new a(s.float,e,t)}function re(e,t,n){const r=t.value;if(!1===r)e.push([s.float.majorEncoded|X]);else if(!0===r)e.push([s.float.majorEncoded|$]);else if(null===r)e.push([s.float.majorEncoded|ee]);else if(void 0===r)e.push([s.float.majorEncoded|te]);else{let t,o=!1;n&&!0===n.float64||(ae(r),t=ce(se,1),r===t||Number.isNaN(r)?(se[0]=249,e.push(se.slice(0,3)),o=!0):(le(r),t=ue(se,1),r===t&&(se[0]=250,e.push(se.slice(0,5)),o=!0))),o||(i=r,oe.setFloat64(0,i,!1),t=he(se,1),se[0]=251,e.push(se.slice(0,9)))}var i}re.encodedSize=function(e,t){const n=e.value;if(!1===n||!0===n||null===n||void 0===n)return 1;if(!t||!0!==t.float64){ae(n);let e=ce(se,1);if(n===e||Number.isNaN(n))return 3;if(le(n),e=ue(se,1),n===e)return 5}return 9};const ie=new ArrayBuffer(9),oe=new DataView(ie,1),se=new Uint8Array(ie,0);function ae(e){if(e===1/0)oe.setUint16(0,31744,!1);else if(e===-1/0)oe.setUint16(0,64512,!1);else if(Number.isNaN(e))oe.setUint16(0,32256,!1);else{oe.setFloat32(0,e);const t=oe.getUint32(0),n=(2139095040&t)>>23,r=8388607&t;if(255===n)oe.setUint16(0,31744,!1);else if(0===n)oe.setUint16(0,(2147483648&e)>>16|r>>13,!1);else{const e=n-127;e<-24?oe.setUint16(0,0):e<-14?oe.setUint16(0,(2147483648&t)>>16|1<<24+e,!1):oe.setUint16(0,(2147483648&t)>>16|e+15<<10|r>>13,!1)}}}function ce(e,t){if(e.length-t<2)throw new Error("".concat(S," not enough data for float16"));const n=(e[t]<<8)+e[t+1];if(31744===n)return 1/0;if(64512===n)return-1/0;if(32256===n)return NaN;const r=n>>10&31,i=1023&n;let o;return o=0===r?i*2**-24:31!==r?(i+1024)*2**(r-25):0===i?1/0:NaN,32768&n?-o:o}function le(e){oe.setFloat32(0,e,!1)}function ue(e,t){if(e.length-t<4)throw new Error("".concat(S," not enough data for float32"));const n=(e.byteOffset||0)+t;return new DataView(e.buffer,n,4).getFloat32(0,!1)}function he(e,t){if(e.length-t<8)throw new Error("".concat(S," not enough data for float64"));const n=(e.byteOffset||0)+t;return new DataView(e.buffer,n,8).getFloat64(0,!1)}function de(e,t,n){throw new Error("".concat(S," encountered invalid minor (").concat(n,") for major ").concat(e[t]>>>5))}function fe(e){return()=>{throw new Error("".concat(S," ").concat(e))}}re.compareTokens=D.compareTokens;const pe=[];for(let Mt=0;Mt<=23;Mt++)pe[Mt]=de;pe[24]=function(e,t,n,r){return new a(s.uint,k(e,t+1,r),2)},pe[25]=function(e,t,n,r){return new a(s.uint,R(e,t+1,r),3)},pe[26]=function(e,t,n,r){return new a(s.uint,x(e,t+1,r),5)},pe[27]=function(e,t,n,r){return new a(s.uint,P(e,t+1,r),9)},pe[28]=de,pe[29]=de,pe[30]=de,pe[31]=de;for(let Mt=32;Mt<=55;Mt++)pe[Mt]=de;pe[56]=function(e,t,n,r){return new a(s.negint,-1-k(e,t+1,r),2)},pe[57]=function(e,t,n,r){return new a(s.negint,-1-R(e,t+1,r),3)},pe[58]=function(e,t,n,r){return new a(s.negint,-1-x(e,t+1,r),5)},pe[59]=function(e,t,n,r){const i=P(e,t+1,r);if("bigint"!==typeof i){const e=-1-i;if(e>=Number.MIN_SAFE_INTEGER)return new a(s.negint,e,9)}if(!0!==r.allowBigInt)throw new Error("".concat(S," integers outside of the safe integer range are not supported"));return new a(s.negint,N-BigInt(i),9)},pe[60]=de,pe[61]=de,pe[62]=de,pe[63]=de;for(let Mt=64;Mt<=87;Mt++)pe[Mt]=U;pe[88]=function(e,t,n,r){return M(e,t,2,k(e,t+1,r))},pe[89]=function(e,t,n,r){return M(e,t,3,R(e,t+1,r))},pe[90]=function(e,t,n,r){return M(e,t,5,x(e,t+1,r))},pe[91]=function(e,t,n,r){const i=P(e,t+1,r);if("bigint"===typeof i)throw new Error("".concat(S," 64-bit integer bytes lengths not supported"));return M(e,t,9,i)},pe[92]=de,pe[93]=de,pe[94]=de,pe[95]=fe("indefinite length bytes/strings are not supported");for(let Mt=96;Mt<=119;Mt++)pe[Mt]=Z;pe[120]=function(e,t,n,r){return j(e,t,2,k(e,t+1,r),r)},pe[121]=function(e,t,n,r){return j(e,t,3,R(e,t+1,r),r)},pe[122]=function(e,t,n,r){return j(e,t,5,x(e,t+1,r),r)},pe[123]=function(e,t,n,r){const i=P(e,t+1,r);if("bigint"===typeof i)throw new Error("".concat(S," 64-bit integer string lengths not supported"));return j(e,t,9,i,r)},pe[124]=de,pe[125]=de,pe[126]=de,pe[127]=fe("indefinite length bytes/strings are not supported");for(let Mt=128;Mt<=151;Mt++)pe[Mt]=H;pe[152]=function(e,t,n,r){return V(0,0,2,k(e,t+1,r))},pe[153]=function(e,t,n,r){return V(0,0,3,R(e,t+1,r))},pe[154]=function(e,t,n,r){return V(0,0,5,x(e,t+1,r))},pe[155]=function(e,t,n,r){const i=P(e,t+1,r);if("bigint"===typeof i)throw new Error("".concat(S," 64-bit integer array lengths not supported"));return V(0,0,9,i)},pe[156]=de,pe[157]=de,pe[158]=de,pe[159]=function(e,t,n,r){if(!1===r.allowIndefinite)throw new Error("".concat(S," indefinite length items not allowed"));return V(0,0,1,1/0)};for(let Mt=160;Mt<=183;Mt++)pe[Mt]=W;pe[184]=function(e,t,n,r){return G(0,0,2,k(e,t+1,r))},pe[185]=function(e,t,n,r){return G(0,0,3,R(e,t+1,r))},pe[186]=function(e,t,n,r){return G(0,0,5,x(e,t+1,r))},pe[187]=function(e,t,n,r){const i=P(e,t+1,r);if("bigint"===typeof i)throw new Error("".concat(S," 64-bit integer map lengths not supported"));return G(0,0,9,i)},pe[188]=de,pe[189]=de,pe[190]=de,pe[191]=function(e,t,n,r){if(!1===r.allowIndefinite)throw new Error("".concat(S," indefinite length items not allowed"));return G(0,0,1,1/0)};for(let Mt=192;Mt<=215;Mt++)pe[Mt]=Y;pe[216]=function(e,t,n,r){return new a(s.tag,k(e,t+1,r),2)},pe[217]=function(e,t,n,r){return new a(s.tag,R(e,t+1,r),3)},pe[218]=function(e,t,n,r){return new a(s.tag,x(e,t+1,r),5)},pe[219]=function(e,t,n,r){return new a(s.tag,P(e,t+1,r),9)},pe[220]=de,pe[221]=de,pe[222]=de,pe[223]=de;for(let Mt=224;Mt<=243;Mt++)pe[Mt]=fe("simple values are not supported");pe[244]=de,pe[245]=de,pe[246]=de,pe[247]=function(e,t,n,r){if(!1===r.allowUndefined)throw new Error("".concat(S," undefined values are not supported"));return!0===r.coerceUndefinedToNull?new a(s.null,null,1):new a(s.undefined,void 0,1)},pe[248]=fe("simple values are not supported"),pe[249]=function(e,t,n,r){return ne(ce(e,t+1),3,r)},pe[250]=function(e,t,n,r){return ne(ue(e,t+1),5,r)},pe[251]=function(e,t,n,r){return ne(he(e,t+1),9,r)},pe[252]=de,pe[253]=de,pe[254]=de,pe[255]=function(e,t,n,r){if(!1===r.allowIndefinite)throw new Error("".concat(S," indefinite length items not allowed"));return new a(s.break,void 0,1)};const ge=[];for(let Mt=0;Mt<24;Mt++)ge[Mt]=new a(s.uint,Mt,1);for(let Mt=-1;Mt>=-24;Mt--)ge[31-Mt]=new a(s.negint,Mt,1);ge[64]=new a(s.bytes,new Uint8Array(0),1),ge[96]=new a(s.string,"",1),ge[128]=new a(s.array,0,1),ge[160]=new a(s.map,0,1),ge[244]=new a(s.false,!1,1),ge[245]=new a(s.true,!0,1),ge[246]=new a(s.null,null,1);!function(){const e=[];e[s.uint.major]=D,e[s.negint.major]=L,e[s.bytes.major]=K,e[s.string.major]=z,e[s.array.major]=q,e[s.map.major]=Q,e[s.tag.major]=J,e[s.float.major]=re}();const ye=new A;class me{constructor(e,t){this.obj=e,this.parent=t}includes(e){let t=this;do{if(t.obj===e)return!0}while(t=t.parent);return!1}static createCheck(e,t){if(e&&e.includes(t))throw new Error("".concat(_," object contains circular references"));return new me(t,e)}}const ve={null:new a(s.null,null),undefined:new a(s.undefined,void 0),true:new a(s.true,!0),false:new a(s.false,!1),emptyArray:new a(s.array,0),emptyMap:new a(s.map,0)},be={number:(e,t,n,r)=>Number.isInteger(e)&&Number.isSafeInteger(e)?new a(e>=0?s.uint:s.negint,e):new a(s.float,e),bigint:(e,t,n,r)=>e>=BigInt(0)?new a(s.uint,e):new a(s.negint,e),Uint8Array:(e,t,n,r)=>new a(s.bytes,e),string:(e,t,n,r)=>new a(s.string,e),boolean:(e,t,n,r)=>e?ve.true:ve.false,null:(e,t,n,r)=>ve.null,undefined:(e,t,n,r)=>ve.undefined,ArrayBuffer:(e,t,n,r)=>new a(s.bytes,new Uint8Array(e)),DataView:(e,t,n,r)=>new a(s.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),Array(e,t,n,r){if(!e.length)return!0===n.addBreakTokens?[ve.emptyArray,new a(s.break)]:ve.emptyArray;r=me.createCheck(r,e);const i=[];let o=0;for(const s of e)i[o++]=we(s,n,r);return n.addBreakTokens?[new a(s.array,e.length),i,new a(s.break)]:[new a(s.array,e.length),i]},Object(e,t,n,r){const i="Object"!==t,o=i?e.keys():Object.keys(e),c=i?e.size:o.length;if(!c)return!0===n.addBreakTokens?[ve.emptyMap,new a(s.break)]:ve.emptyMap;r=me.createCheck(r,e);const l=[];let u=0;for(const s of o)l[u++]=[we(s,n,r),we(i?e.get(s):e[s],n,r)];return function(e,t){t.mapSorter&&e.sort(t.mapSorter)}(l,n),n.addBreakTokens?[new a(s.map,c),l,new a(s.break)]:[new a(s.map,c),l]}};be.Map=be.Object,be.Buffer=be.Uint8Array;for(const Mt of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))be["".concat(Mt,"Array")]=be.DataView;function we(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const r=o(e),i=t&&t.typeEncoders&&t.typeEncoders[r]||be[r];if("function"===typeof i){const o=i(e,r,t,n);if(null!=o)return o}const s=be[r];if(!s)throw new Error("".concat(_," unsupported type: ").concat(r));return s(e,r,t,n)}function Ee(e,t,n,r){if(Array.isArray(t))for(const i of t)Ee(e,i,n,r);else n[t.type.major](e,t,r)}function Ae(e,t,n){const r=we(e,n);if(!Array.isArray(r)&&n.quickEncodeToken){const e=n.quickEncodeToken(r);if(e)return e;const i=t[r.type.major];if(i.encodedSize){const e=i.encodedSize(r,n),t=new A(e);if(i(t,r,n),1!==t.chunks.length)throw new Error("Unexpected error: pre-calculated length for ".concat(r," was wrong"));return d(t.chunks[0])}}return ye.reset(),Ee(ye,r,t,n),ye.toBytes(!0)}const Se={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class _e{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._pos=0,this.data=e,this.options=t}pos(){return this._pos}done(){return this._pos>=this.data.length}next(){const e=this.data[this._pos];let t=ge[e];if(void 0===t){const n=pe[e];if(!n)throw new Error("".concat(S," no decoder for major type ").concat(e>>>5," (byte 0x").concat(e.toString(16).padStart(2,"0"),")"));const r=31&e;t=n(this.data,this._pos,r,this.options)}return this._pos+=t.encodedLength,t}}const Ie=Symbol.for("DONE"),Ce=Symbol.for("BREAK");function Te(e,t){if(e.done())return Ie;const n=e.next();if(n.type===s.break)return Ce;if(n.type.terminal)return n.value;if(n.type===s.array)return function(e,t,n){const r=[];for(let i=0;i<e.value;i++){const o=Te(t,n);if(o===Ce){if(e.value===1/0)break;throw new Error("".concat(S," got unexpected break to lengthed array"))}if(o===Ie)throw new Error("".concat(S," found array but not enough entries (got ").concat(i,", expected ").concat(e.value,")"));r[i]=o}return r}(n,e,t);if(n.type===s.map)return function(e,t,n){const r=!0===n.useMaps,i=r?void 0:{},o=r?new Map:void 0;for(let s=0;s<e.value;s++){const a=Te(t,n);if(a===Ce){if(e.value===1/0)break;throw new Error("".concat(S," got unexpected break to lengthed map"))}if(a===Ie)throw new Error("".concat(S," found map but not enough entries (got ").concat(s," [no key], expected ").concat(e.value,")"));if(!0!==r&&"string"!==typeof a)throw new Error("".concat(S," non-string keys not supported (got ").concat(typeof a,")"));if(!0===n.rejectDuplicateMapKeys&&(r&&o.has(a)||!r&&a in i))throw new Error("".concat(S,' found repeat map key "').concat(a,'"'));const c=Te(t,n);if(c===Ie)throw new Error("".concat(S," found map but not enough entries (got ").concat(s," [no value], expected ").concat(e.value,")"));r?o.set(a,c):i[a]=c}return r?o:i}(n,e,t);if(n.type===s.tag){if(t.tags&&"function"===typeof t.tags[n.value]){const r=Te(e,t);return t.tags[n.value](r)}throw new Error("".concat(S," tag not supported (").concat(n.value,")"))}throw new Error("unsupported")}function ke(e,t){const[n,r]=function(e,t){if(!(e instanceof Uint8Array))throw new Error("".concat(S," data to decode must be a Uint8Array"));const n=(t=Object.assign({},Se,t)).tokenizer||new _e(e,t),r=Te(n,t);if(r===Ie)throw new Error("".concat(S," did not find any content to decode"));if(r===Ce)throw new Error("".concat(S," got unexpected break"));return[r,e.subarray(n.pos())]}(e,t);if(r.length>0)throw new Error("".concat(S," too many terminals, data makes no sense"));return n}class Re extends Array{constructor(){super(),this.inRecursive=[]}prefix(e){const t=this.inRecursive[this.inRecursive.length-1];t&&(t.type===s.array&&(t.elements++,1!==t.elements&&e.push([44])),t.type===s.map&&(t.elements++,1!==t.elements&&(t.elements%2===1?e.push([44]):e.push([58]))))}[s.uint.major](e,t){this.prefix(e);const n=String(t.value),r=[];for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);e.push(r)}[s.negint.major](e,t){this[s.uint.major](e,t)}[s.bytes.major](e,t){throw new Error("".concat(_," unsupported type: Uint8Array"))}[s.string.major](e,t){this.prefix(e);const n=p(JSON.stringify(t.value));e.push(n.length>32?d(n):n)}[s.array.major](e,t){this.prefix(e),this.inRecursive.push({type:s.array,elements:0}),e.push([91])}[s.map.major](e,t){this.prefix(e),this.inRecursive.push({type:s.map,elements:0}),e.push([123])}[s.tag.major](e,t){}[s.float.major](e,t){if("break"===t.type.name){const t=this.inRecursive.pop();if(t){if(t.type===s.array)e.push([93]);else{if(t.type!==s.map)throw new Error("Unexpected recursive type; this should not happen!");e.push([125])}return}throw new Error("Unexpected break; this should not happen!")}if(void 0===t.value)throw new Error("".concat(_," unsupported type: undefined"));if(this.prefix(e),"true"===t.type.name)return void e.push([116,114,117,101]);if("false"===t.type.name)return void e.push([102,97,108,115,101]);if("null"===t.type.name)return void e.push([110,117,108,108]);const n=String(t.value),r=[];let i=!1;for(let o=0;o<n.length;o++)r[o]=n.charCodeAt(o),i||46!==r[o]&&101!==r[o]&&69!==r[o]||(i=!0);i||(r.push(46),r.push(48)),e.push(r)}}const xe={addBreakTokens:!0,mapSorter:function(e,t){if(Array.isArray(e[0])||Array.isArray(t[0]))throw new Error("".concat(_," complex map keys are not supported"));const n=e[0],r=t[0];if(n.type!==s.string||r.type!==s.string)throw new Error("".concat(_," non-string map keys are not supported"));if(n<r)return-1;if(n>r)return 1;throw new Error("".concat(_," unexpected duplicate map keys, this is not supported"))}};class Pe{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._pos=0,this.data=e,this.options=t,this.modeStack=["value"],this.lastToken=""}pos(){return this._pos}done(){return this._pos>=this.data.length}ch(){return this.data[this._pos]}currentMode(){return this.modeStack[this.modeStack.length-1]}skipWhitespace(){let e=this.ch();for(;32===e||9===e||13===e||10===e;)e=this.data[++this._pos]}expect(e){if(this.data.length-this._pos<e.length)throw new Error("".concat(S," unexpected end of input at position ").concat(this._pos));for(let t=0;t<e.length;t++)if(this.data[this._pos++]!==e[t])throw new Error("".concat(S," unexpected token at position ").concat(this._pos,", expected to find '").concat(String.fromCharCode(...e),"'"))}parseNumber(){const e=this._pos;let t=!1,n=!1;const r=e=>{for(;!this.done();){const t=this.ch();if(!e.includes(t))break;this._pos++}};if(45===this.ch()&&(t=!0,this._pos++),48===this.ch()){if(this._pos++,46!==this.ch())return new a(s.uint,0,this._pos-e);this._pos++,n=!0}if(r([48,49,50,51,52,53,54,55,56,57]),t&&this._pos===e+1)throw new Error("".concat(S," unexpected token at position ").concat(this._pos));if(!this.done()&&46===this.ch()){if(n)throw new Error("".concat(S," unexpected token at position ").concat(this._pos));n=!0,this._pos++,r([48,49,50,51,52,53,54,55,56,57])}this.done()||101!==this.ch()&&69!==this.ch()||(n=!0,this._pos++,this.done()||43!==this.ch()&&45!==this.ch()||this._pos++,r([48,49,50,51,52,53,54,55,56,57]));const i=String.fromCharCode.apply(null,this.data.subarray(e,this._pos)),o=parseFloat(i);return n?new a(s.float,o,this._pos-e):!0!==this.options.allowBigInt||Number.isSafeInteger(o)?new a(o>=0?s.uint:s.negint,o,this._pos-e):new a(o>=0?s.uint:s.negint,BigInt(i),this._pos-e)}parseString(){if(34!==this.ch())throw new Error("".concat(S," unexpected character at position ").concat(this._pos,"; this shouldn't happen"));this._pos++;for(let i=this._pos,o=0;i<this.data.length&&o<65536;i++,o++){const e=this.data[i];if(92===e||e<32||e>=128)break;if(34===e){const e=String.fromCharCode.apply(null,this.data.subarray(this._pos,i));return this._pos=i+1,new a(s.string,e,o)}}const e=this._pos,t=[],n=()=>{if(this._pos+4>=this.data.length)throw new Error("".concat(S," unexpected end of unicode escape sequence at position ").concat(this._pos));let e=0;for(let t=0;t<4;t++){let t=this.ch();if(t>=48&&t<=57)t-=48;else if(t>=97&&t<=102)t=t-97+10;else{if(!(t>=65&&t<=70))throw new Error("".concat(S," unexpected unicode escape character at position ").concat(this._pos));t=t-65+10}e=16*e+t,this._pos++}return e},r=()=>{const e=this.ch();let n,r,i,o,s=null,a=e>239?4:e>223?3:e>191?2:1;if(this._pos+a>this.data.length)throw new Error("".concat(S," unexpected unicode sequence at position ").concat(this._pos));switch(a){case 1:e<128&&(s=e);break;case 2:n=this.data[this._pos+1],128===(192&n)&&(o=(31&e)<<6|63&n,o>127&&(s=o));break;case 3:n=this.data[this._pos+1],r=this.data[this._pos+2],128===(192&n)&&128===(192&r)&&(o=(15&e)<<12|(63&n)<<6|63&r,o>2047&&(o<55296||o>57343)&&(s=o));break;case 4:n=this.data[this._pos+1],r=this.data[this._pos+2],i=this.data[this._pos+3],128===(192&n)&&128===(192&r)&&128===(192&i)&&(o=(15&e)<<18|(63&n)<<12|(63&r)<<6|63&i,o>65535&&o<1114112&&(s=o))}null===s?(s=65533,a=1):s>65535&&(s-=65536,t.push(s>>>10&1023|55296),s=56320|1023&s),t.push(s),this._pos+=a};for(;!this.done();){const i=this.ch();let o;switch(i){case 92:if(this._pos++,this.done())throw new Error("".concat(S," unexpected string termination at position ").concat(this._pos));switch(o=this.ch(),this._pos++,o){case 34:case 39:case 92:case 47:t.push(o);break;case 98:t.push(8);break;case 116:t.push(9);break;case 110:t.push(10);break;case 102:t.push(12);break;case 114:t.push(13);break;case 117:t.push(n());break;default:throw new Error("".concat(S," unexpected string escape character at position ").concat(this._pos))}break;case 34:return this._pos++,new a(s.string,E(t),this._pos-e);default:if(i<32)throw new Error("".concat(S," invalid control character at position ").concat(this._pos));i<128?(t.push(i),this._pos++):r()}}throw new Error("".concat(S," unexpected end of string at position ").concat(this._pos))}parseValue(){switch(this.ch()){case 123:return this.modeStack.push("obj-start"),this._pos++,new a(s.map,1/0,1);case 91:return this.modeStack.push("array-start"),this._pos++,new a(s.array,1/0,1);case 34:return this.parseString();case 110:return this.expect([110,117,108,108]),new a(s.null,null,4);case 102:return this.expect([102,97,108,115,101]),new a(s.false,!1,5);case 116:return this.expect([116,114,117,101]),new a(s.true,!0,4);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.parseNumber();default:throw new Error("".concat(S," unexpected character at position ").concat(this._pos))}}next(){switch(this.skipWhitespace(),this.currentMode()){case"value":return this.modeStack.pop(),this.parseValue();case"array-value":if(this.modeStack.pop(),93===this.ch())return this._pos++,this.skipWhitespace(),new a(s.break,void 0,1);if(44!==this.ch())throw new Error("".concat(S," unexpected character at position ").concat(this._pos,", was expecting array delimiter but found '").concat(String.fromCharCode(this.ch()),"'"));return this._pos++,this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue();case"array-start":return this.modeStack.pop(),93===this.ch()?(this._pos++,this.skipWhitespace(),new a(s.break,void 0,1)):(this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue());case"obj-key":if(125===this.ch())return this.modeStack.pop(),this._pos++,this.skipWhitespace(),new a(s.break,void 0,1);if(44!==this.ch())throw new Error("".concat(S," unexpected character at position ").concat(this._pos,", was expecting object delimiter but found '").concat(String.fromCharCode(this.ch()),"'"));this._pos++,this.skipWhitespace();case"obj-start":{if(this.modeStack.pop(),125===this.ch())return this._pos++,this.skipWhitespace(),new a(s.break,void 0,1);const e=this.parseString();if(this.skipWhitespace(),58!==this.ch())throw new Error("".concat(S," unexpected character at position ").concat(this._pos,", was expecting key/value delimiter ':' but found '").concat(String.fromCharCode(this.ch()),"'"));return this._pos++,this.modeStack.push("obj-value"),e}case"obj-value":return this.modeStack.pop(),this.modeStack.push("obj-key"),this.skipWhitespace(),this.parseValue();default:throw new Error("".concat(S," unexpected parse state at position ").concat(this._pos,"; this shouldn't happen"))}}}new Uint8Array(0);const De=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")};var Oe=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==n[s])throw new TypeError(o+" is ambiguous");n[s]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var r=0,i=0;e[t]===c;)r++,t++;for(var o=(e.length-t)*l+1>>>0,s=new Uint8Array(o);e[t];){var u=n[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=o-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*s[d]>>>0,s[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=o-i;f!==o&&0===s[f];)f++;for(var p=new Uint8Array(r+(o-f)),g=r;f!==o;)p[g++]=s[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,o=t.length;i!==o&&0===t[i];)i++,n++;for(var s=(o-i)*u+1>>>0,l=new Uint8Array(s);i!==o;){for(var h=t[i],d=0,f=s-1;(0!==h||d<r)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");r=d,i++}for(var p=s-r;p!==s&&0===l[p];)p++;for(var g=c.repeat(n);p<s;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:h,decode:function(e){var n=h(e);if(n)return n;throw new Error("Non-".concat(t," character"))}}};const Ne=Oe;class Be{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(e));throw Error("Unknown type, must be binary type")}}class Le{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(e),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return Ue(this,e)}}class Me{constructor(e){this.decoders=e}or(e){return Ue(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(e),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}}const Ue=(e,t)=>new Me({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class Fe{constructor(e,t,n,r){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=r,this.encoder=new Be(e,t,n),this.decoder=new Le(e,t,r)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Ke=e=>{let{name:t,prefix:n,encode:r,decode:i}=e;return new Fe(t,n,r,i)},je=e=>{let{prefix:t,name:n,alphabet:r}=e;const{encode:i,decode:o}=Ne(r,n);return Ke({prefix:t,name:n,encode:i,decode:e=>De(o(e))})},Ze=e=>{let{name:t,prefix:n,bitsPerChar:r,alphabet:i}=e;return Ke({prefix:n,name:t,encode:e=>((e,t,n)=>{const r="="===t[t.length-1],i=(1<<n)-1;let o="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>n;)s-=n,o+=t[i&a>>s];if(s&&(o+=t[i&a<<n-s]),r)for(;o.length*n&7;)o+="=";return o})(e,i,r),decode:e=>((e,t,n,r)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*n/8|0);let a=0,c=0,l=0;for(let u=0;u<o;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError("Non-".concat(r," character"));c=c<<n|t,a+=n,a>=8&&(a-=8,s[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s})(e,i,r,t)})},ze=Ze({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Ve=(Ze({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Ze({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Ze({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Ze({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Ze({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Ze({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Ze({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Ze({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),je({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}));je({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var He=function e(t,n,r){n=n||[];var i=r=r||0;for(;t>=We;)n[r++]=255&t|qe,t/=128;for(;t&Ge;)n[r++]=255&t|qe,t>>>=7;return n[r]=0|t,e.bytes=r-i+1,n},qe=128,Ge=-128,We=Math.pow(2,31);var Qe=function e(t,n){var r,i=0,o=0,s=n=n||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");r=t[s++],i+=o<28?(r&Je)<<o:(r&Je)*Math.pow(2,o),o+=7}while(r>=Ye);return e.bytes=s-n,i},Ye=128,Je=127;var Xe=Math.pow(2,7),$e=Math.pow(2,14),et=Math.pow(2,21),tt=Math.pow(2,28),nt=Math.pow(2,35),rt=Math.pow(2,42),it=Math.pow(2,49),ot=Math.pow(2,56),st=Math.pow(2,63);const at={encode:He,decode:Qe,encodingLength:function(e){return e<Xe?1:e<$e?2:e<et?3:e<tt?4:e<nt?5:e<rt?6:e<it?7:e<ot?8:e<st?9:10}},ct=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return[at.decode(e,t),at.decode.bytes]},lt=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return at.encode(e,t,n),t},ut=e=>at.encodingLength(e);class ht{constructor(e,t,n,r){this.code=e,this.size=t,this.digest=n,this.bytes=r}}const dt=(e,t)=>{const{bytes:n,version:r}=e;return 0===r?mt(n,pt(e),t||Ve.encoder):vt(n,pt(e),t||ze.encoder)},ft=new WeakMap,pt=e=>{const t=ft.get(e);if(null==t){const t=new Map;return ft.set(e,t),t}return t};class gt{constructor(e,t,n,r){this.code=t,this.version=e,this.multihash=n,this.bytes=r,this["/"]=r}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==bt)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==wt)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return gt.createV0(t)}default:throw Error("Can not convert CID version ".concat(this.version," to version 0. This is a bug please report"))}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=((e,t)=>{const n=t.byteLength,r=ut(e),i=r+ut(n),o=new Uint8Array(i+n);return lt(e,o,0),lt(n,o,r),o.set(t,i),new ht(e,n,t,o)})(e,t);return gt.createV1(this.code,n)}case 1:return this;default:throw Error("Can not convert CID version ".concat(this.version," to version 1. This is a bug please report"))}}equals(e){return gt.equals(this,e)}static equals(e,t){const n=t;return n&&e.code===n.code&&e.version===n.version&&((e,t)=>{if(e===t)return!0;{const n=t;return e.code===n.code&&e.size===n.size&&n.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0})(e.bytes,n.bytes)}})(e.multihash,n.multihash)}toString(e){return dt(this,e)}toJSON(){return{"/":dt(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID(".concat(this.toString(),")")}static asCID(e){if(null==e)return null;const t=e;if(t instanceof gt)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:n,multihash:r,bytes:i}=t;return new gt(e,n,r,i||Et(e,n,r.bytes))}if(!0===t[At]){const{version:e,multihash:n,code:r}=t,i=(e=>{const t=De(e),[n,r]=ct(t),[i,o]=ct(t.subarray(r)),s=t.subarray(r+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new ht(n,i,s,t)})(n);return gt.create(e,r,i)}return null}static create(e,t,n){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==bt)throw new Error("Version 0 CID must use dag-pb (code: ".concat(bt,") block encoding"));return new gt(e,t,n,n.bytes);case 1:{const r=Et(e,t,n.bytes);return new gt(e,t,n,r)}default:throw new Error("Invalid version")}}static createV0(e){return gt.create(0,bt,e)}static createV1(e,t){return gt.create(1,e,t)}static decode(e){const[t,n]=gt.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=gt.inspectBytes(e),n=t.size-t.multihashSize,r=De(e.subarray(n,n+t.multihashSize));if(r.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=r.subarray(t.multihashSize-t.digestSize),o=new ht(t.multihashCode,t.digestSize,i,r);return[0===t.version?gt.createV0(o):gt.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[n,r]=ct(e.subarray(t));return t+=r,n};let r=n(),i=bt;if(18===r?(r=0,t=0):i=n(),0!==r&&1!==r)throw new RangeError("Invalid CID version ".concat(r));const o=t,s=n(),a=n(),c=t+a;return{version:r,codec:i,multihashCode:s,digestSize:a,multihashSize:c-o,size:c}}static parse(e,t){const[n,r]=yt(e,t),i=gt.decode(r);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return pt(i).set(n,e),i}}const yt=(e,t)=>{switch(e[0]){case"Q":{const n=t||Ve;return[Ve.prefix,n.decode("".concat(Ve.prefix).concat(e))]}case Ve.prefix:{const n=t||Ve;return[Ve.prefix,n.decode(e)]}case ze.prefix:{const n=t||ze;return[ze.prefix,n.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},mt=(e,t,n)=>{const{prefix:r}=n;if(r!==Ve.prefix)throw Error("Cannot string encode V0 in ".concat(n.name," encoding"));const i=t.get(r);if(null==i){const i=n.encode(e).slice(1);return t.set(r,i),i}return i},vt=(e,t,n)=>{const{prefix:r}=n,i=t.get(r);if(null==i){const i=n.encode(e);return t.set(r,i),i}return i},bt=112,wt=18,Et=(e,t,n)=>{const r=ut(e),i=r+ut(t),o=new Uint8Array(i+n.byteLength);return lt(e,o,0),lt(t,o,r),o.set(n,i),o},At=Symbol.for("@ipld/js-cid/CID");const St=Ze({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});Ze({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Ze({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Ze({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function _t(e){const t=St.encode(e).slice(1);return[new a(s.map,1/0,1),new a(s.string,"/",1),new a(s.map,1/0,1),new a(s.string,"bytes",5),new a(s.string,t,t.length),new a(s.break,void 0,1),new a(s.break,void 0,1)]}function It(e){return _t(new Uint8Array(e.buffer,e.byteOffset,e.byteLength))}const Ct={typeEncoders:{Object:function(e){if(e.asCID!==e&&e["/"]!==e.bytes)return null;const t=gt.asCID(e);if(!t)return null;const n=t.toString();return[new a(s.map,1/0,1),new a(s.string,"/",1),new a(s.string,n,n.length),new a(s.break,void 0,1)]},Buffer:_t,Uint8Array:_t,Int8Array:It,Uint16Array:It,Int16Array:It,Uint32Array:It,Int32Array:It,Float32Array:It,Float64Array:It,Uint8ClampedArray:It,BigInt64Array:It,BigUint64Array:It,DataView:It,ArrayBuffer:function(e){return _t(new Uint8Array(e))},undefined:function(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")},number:function(e){if(Number.isNaN(e))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(e===1/0||e===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}}};class Tt extends Pe{constructor(e,t){super(e,t),this.tokenBuffer=[]}done(){return 0===this.tokenBuffer.length&&super.done()}_next(){return this.tokenBuffer.length>0?this.tokenBuffer.pop():super.next()}next(){const e=this._next();if(e.type===s.map){const e=this._next();if(e.type===s.string&&"/"===e.value){const e=this._next();if(e.type===s.string){if(this._next().type!==s.break)throw new Error("Invalid encoded CID form");return this.tokenBuffer.push(e),new a(s.tag,42,0)}if(e.type===s.map){const e=this._next();if(e.type===s.string&&"bytes"===e.value){const e=this._next();if(e.type===s.string){for(let e=0;e<2;e++){if(this._next().type!==s.break)throw new Error("Invalid encoded Bytes form")}const t=St.decode("m".concat(e.value));return new a(s.bytes,t,e.value.length)}this.tokenBuffer.push(e)}this.tokenBuffer.push(e)}this.tokenBuffer.push(e)}this.tokenBuffer.push(e)}return e}}const kt={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};kt.tags[42]=gt.parse;const Rt="dag-json",xt=297,Pt=e=>{return t=e,n=Ct,n=Object.assign({},xe,n),Ae(t,new Re,n);var t,n},Dt=e=>function(e,t){return ke(e,t=Object.assign({tokenizer:new Pe(e,t)},t))}(e,Object.assign(kt,{tokenizer:new Tt(e,kt)})),Ot=e=>Nt.decode(Pt(e)),Nt=new TextDecoder,Bt=e=>Dt(Lt.encode(e)),Lt=new TextEncoder},20099:(e,t,n)=>{"use strict";n.r(t),n.d(t,{code:()=>R,createLink:()=>T,createNode:()=>C,decode:()=>P,encode:()=>x,name:()=>k,prepare:()=>_,validate:()=>I});var r=n(47652);const i=new TextDecoder;function o(e,t){let n=0;for(let r=0;;r+=7){if(r>=64)throw new Error("protobuf: varint overflow");if(t>=e.length)throw new Error("protobuf: unexpected end of data");const i=e[t++];if(n+=r<28?(127&i)<<r:(127&i)*2**r,i<128)break}return[n,t]}function s(e,t){let n;[n,t]=o(e,t);const r=t+n;if(n<0||r<0)throw new Error("protobuf: invalid length");if(r>e.length)throw new Error("protobuf: unexpected end of data");return[e.subarray(t,r),r]}function a(e,t){let n;return[n,t]=o(e,t),[7&n,n>>3,t]}function c(e){const t={},n=e.length;let r=0;for(;r<n;){let n,c;if([n,c,r]=a(e,r),1===c){if(t.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(2!==n)throw new Error("protobuf: (PBLink) wrong wireType (".concat(n,") for Hash"));if(void 0!==t.Name)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(void 0!==t.Tsize)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[t.Hash,r]=s(e,r)}else if(2===c){if(void 0!==t.Name)throw new Error("protobuf: (PBLink) duplicate Name section");if(2!==n)throw new Error("protobuf: (PBLink) wrong wireType (".concat(n,") for Name"));if(void 0!==t.Tsize)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let o;[o,r]=s(e,r),t.Name=i.decode(o)}else{if(3!==c)throw new Error("protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ".concat(c));if(void 0!==t.Tsize)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(0!==n)throw new Error("protobuf: (PBLink) wrong wireType (".concat(n,") for Tsize"));[t.Tsize,r]=o(e,r)}}if(r>n)throw new Error("protobuf: (PBLink) unexpected end of data");return t}const l=new TextEncoder,u=2**32,h=2**31;function d(e,t){let n=t.length;if("number"===typeof e.Tsize){if(e.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(e.Tsize))throw new Error("Tsize too large for encoding");n=g(t,n,e.Tsize)-1,t[n]=24}if("string"===typeof e.Name){const r=l.encode(e.Name);n-=r.length,t.set(r,n),n=g(t,n,r.length)-1,t[n]=18}return e.Hash&&(n-=e.Hash.length,t.set(e.Hash,n),n=g(t,n,e.Hash.length)-1,t[n]=10),t.length-n}function f(e){const t=function(e){let t=0;if(e.Data){const n=e.Data.length;t+=1+n+y(n)}if(e.Links)for(const n of e.Links){const e=p(n);t+=1+e+y(e)}return t}(e),n=new Uint8Array(t);let r=t;if(e.Data&&(r-=e.Data.length,n.set(e.Data,r),r=g(n,r,e.Data.length)-1,n[r]=10),e.Links)for(let i=e.Links.length-1;i>=0;i--){const t=d(e.Links[i],n.subarray(0,r));r-=t,r=g(n,r,t)-1,n[r]=18}return n}function p(e){let t=0;if(e.Hash){const n=e.Hash.length;t+=1+n+y(n)}if("string"===typeof e.Name){const n=l.encode(e.Name).length;t+=1+n+y(n)}return"number"===typeof e.Tsize&&(t+=1+y(e.Tsize)),t}function g(e,t,n){const r=t-=y(n);for(;n>=h;)e[t++]=127&n|128,n/=128;for(;n>=128;)e[t++]=127&n|128,n>>>=7;return e[t]=n,r}function y(e){return e%2===0&&e++,Math.floor((function(e){let t=0;e>=u&&(e=Math.floor(e/u),t=32);e>=65536&&(e>>>=16,t+=16);e>=256&&(e>>>=8,t+=8);return t+m[e]}(e)+6)/7)}const m=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],v=["Data","Links"],b=["Hash","Name","Tsize"],w=new TextEncoder;function E(e,t){if(e===t)return 0;const n=e.Name?w.encode(e.Name):[],r=t.Name?w.encode(t.Name):[];let i=n.length,o=r.length;for(let s=0,a=Math.min(i,o);s<a;++s)if(n[s]!==r[s]){i=n[s],o=r[s];break}return i<o?-1:o<i?1:0}function A(e,t){return!Object.keys(e).some((e=>!t.includes(e)))}function S(e){if("object"===typeof e.asCID){const t=r.k0.asCID(e);if(!t)throw new TypeError("Invalid DAG-PB form");return{Hash:t}}if("object"!==typeof e||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");const t={};if(e.Hash){let i=r.k0.asCID(e.Hash);try{i||("string"===typeof e.Hash?i=r.k0.parse(e.Hash):e.Hash instanceof Uint8Array&&(i=r.k0.decode(e.Hash)))}catch(n){throw new TypeError("Invalid DAG-PB form: ".concat(n.message))}i&&(t.Hash=i)}if(!t.Hash)throw new TypeError("Invalid DAG-PB form");return"string"===typeof e.Name&&(t.Name=e.Name),"number"===typeof e.Tsize&&(t.Tsize=e.Tsize),t}function _(e){if((e instanceof Uint8Array||"string"===typeof e)&&(e={Data:e}),"object"!==typeof e||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");const t={};if(void 0!==e.Data)if("string"===typeof e.Data)t.Data=w.encode(e.Data);else{if(!(e.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form");t.Data=e.Data}if(void 0!==e.Links){if(!Array.isArray(e.Links))throw new TypeError("Invalid DAG-PB form");t.Links=e.Links.map(S),t.Links.sort(E)}else t.Links=[];return t}function I(e){if(!e||"object"!==typeof e||Array.isArray(e)||e instanceof Uint8Array||e["/"]&&e["/"]===e.bytes)throw new TypeError("Invalid DAG-PB form");if(!A(e,v))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(void 0!==e.Data&&!(e.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be bytes)");if(!Array.isArray(e.Links))throw new TypeError("Invalid DAG-PB form (Links must be a list)");for(let t=0;t<e.Links.length;t++){const n=e.Links[t];if(!n||"object"!==typeof n||Array.isArray(n)||n instanceof Uint8Array||n["/"]&&n["/"]===n.bytes)throw new TypeError("Invalid DAG-PB form (bad link)");if(!A(n,b))throw new TypeError("Invalid DAG-PB form (extraneous properties on link)");if(void 0===n.Hash)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(null==n.Hash||!n.Hash["/"]||n.Hash["/"]!==n.Hash.bytes)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(void 0!==n.Name&&"string"!==typeof n.Name)throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(void 0!==n.Tsize){if("number"!==typeof n.Tsize||n.Tsize%1!==0)throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(n.Tsize<0)throw new TypeError("Invalid DAG-PB form (link Tsize cannot be negative)")}if(t>0&&-1===E(n,e.Links[t-1]))throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function C(e){return _({Data:e,Links:arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]})}function T(e,t,n){return S({Hash:n,Name:e,Tsize:t})}const k="dag-pb",R=112;function x(e){I(e);const t={};return e.Links&&(t.Links=e.Links.map((e=>{const t={};return e.Hash&&(t.Hash=e.Hash.bytes),void 0!==e.Name&&(t.Name=e.Name),void 0!==e.Tsize&&(t.Tsize=e.Tsize),t}))),e.Data&&(t.Data=e.Data),f(t)}function P(e){const t=function(e){const t=e.length;let n,r,i=0,o=!1;for(;i<t;){let t,l;if([t,l,i]=a(e,i),2!==t)throw new Error("protobuf: (PBNode) invalid wireType, expected 2, got ".concat(t));if(1===l){if(r)throw new Error("protobuf: (PBNode) duplicate Data section");[r,i]=s(e,i),n&&(o=!0)}else{if(2!==l)throw new Error("protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ".concat(l));{if(o)throw new Error("protobuf: (PBNode) duplicate Links section");let t;n||(n=[]),[t,i]=s(e,i),n.push(c(t))}}}if(i>t)throw new Error("protobuf: (PBNode) unexpected end of data");const l={};return r&&(l.Data=r),l.Links=n||[],l}(e),n={};return t.Data&&(n.Data=t.Data),t.Links&&(n.Links=t.Links.map((e=>{const t={};try{t.Hash=r.k0.decode(e.Hash)}catch(n){}if(!t.Hash)throw new Error("Invalid Hash field found in link, expected CID");return void 0!==e.Name&&(t.Name=e.Name),void 0!==e.Tsize&&(t.Tsize=e.Tsize),t}))),n}},9963:(e,t,n)=>{"use strict";n.d(t,{Mb:()=>l,Vc:()=>u,_L:()=>i,l9:()=>c,sv:()=>o});var r=n(96156);class i extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"The operation was aborted"),(0,r.Z)(this,"code",void 0),(0,r.Z)(this,"type",void 0),this.code=i.code,this.type=i.type}}(0,r.Z)(i,"code","ABORT_ERR"),(0,r.Z)(i,"type","aborted");class o extends Error{constructor(e,t,n){var i;super(e),(0,r.Z)(this,"code",void 0),(0,r.Z)(this,"props",void 0),this.code=t,this.name=null!==(i=null===n||void 0===n?void 0:n.name)&&void 0!==i?i:"CodeError",this.props=null!==n&&void 0!==n?n:{}}}class s extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected Peer"),(0,r.Z)(this,"code",void 0),this.code=s.code}}(0,r.Z)(s,"code","ERR_UNEXPECTED_PEER");class a extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid crypto exchange"),(0,r.Z)(this,"code",void 0),this.code=a.code}}(0,r.Z)(a,"code","ERR_INVALID_CRYPTO_EXCHANGE");const c="ERR_TIMEOUT",l="ERR_INVALID_PARAMETERS",u="ERR_NOT_FOUND"},7619:(e,t,n)=>{"use strict";n.d(t,{_L:()=>f._L,sv:()=>f.sv,Aw:()=>w,Mb:()=>f.Mb,Vc:()=>f.Vc,l9:()=>f.l9,P7:()=>h,Le:()=>v,fL:()=>r,wj:()=>i,I$:()=>a,qK:()=>A,JX:()=>o,Cs:()=>s,mV:()=>c,Wp:()=>E,SF:()=>u});const r=Symbol.for("@libp2p/connection");const i=Symbol.for("@libp2p/content-routing"),o=Symbol.for("@libp2p/peer-discovery"),s=Symbol.for("@libp2p/peer-id");function a(e){return null!=e&&Boolean(e[s])}const c=Symbol.for("@libp2p/peer-routing");var l;!function(e){e.Accept="accept",e.Ignore="ignore",e.Reject="reject"}(l||(l={}));const u=Symbol.for("@libp2p/transport");var h;!function(e){e[e.FATAL_ALL=0]="FATAL_ALL",e[e.NO_FATAL=1]="NO_FATAL"}(h||(h={}));var d,f=n(9963),p=n(96156),g=n(44743),y=n(58271);var m=new WeakMap;class v extends EventTarget{constructor(){super(...arguments),(0,g.Z)(this,m,{writable:!0,value:new Map})}listenerCount(e){const t=(0,y.Z)(this,m).get(e);return null==t?0:t.length}addEventListener(e,t,n){var r;super.addEventListener(e,t,n);let i=(0,y.Z)(this,m).get(e);null==i&&(i=[],(0,y.Z)(this,m).set(e,i)),i.push({callback:t,once:null!==(r=!0!==n&&!1!==n&&(null===n||void 0===n?void 0:n.once))&&void 0!==r&&r})}removeEventListener(e,t,n){super.removeEventListener(e.toString(),null!==t&&void 0!==t?t:null,n);let r=(0,y.Z)(this,m).get(e);null!=r&&(r=r.filter((e=>{let{callback:n}=e;return n!==t})),(0,y.Z)(this,m).set(e,r))}dispatchEvent(e){const t=super.dispatchEvent(e);let n=(0,y.Z)(this,m).get(e.type);return null==n||(n=n.filter((e=>{let{once:t}=e;return!t})),(0,y.Z)(this,m).set(e.type,n)),t}safeDispatchEvent(e,t){return this.dispatchEvent(new w(e,t))}}class b extends Event{constructor(e,t){super(e,t),(0,p.Z)(this,"detail",void 0),this.detail=null===t||void 0===t?void 0:t.detail}}const w=null!==(d=globalThis.CustomEvent)&&void 0!==d?d:b,E=function(e){try{for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r]}catch{}};function A(e){return null!=e&&"function"===typeof e.start&&"function"===typeof e.stop}},5803:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>I});var r=n(72791),i=n(19756),o=n(22122),s=n(63349),a=n(41788),c=n(57441),l=n(62110),u=n.n(l);function h(e,t){if(!e){var n=new Error("loadable: "+t);throw n.framesToPop=1,n.name="Invariant Violation",n}}var d=r.createContext();var f={initialChunks:{}},p="PENDING",g="REJECTED";var y=function(e){return e};function m(e){var t=e.defaultResolveComponent,n=void 0===t?y:t,l=e.render,m=e.onLoad;function v(e,t){void 0===t&&(t={});var y=function(e){return"function"===typeof e?{requireAsync:e,resolve:function(){},chunkName:function(){}}:e}(e),v={};function b(e){return t.cacheKey?t.cacheKey(e):y.resolve?y.resolve(e):"static"}function w(e,r,i){var o=t.resolveComponent?t.resolveComponent(e,r):n(e);if(t.resolveComponent&&!(0,c.isValidElementType)(o))throw new Error("resolveComponent returned something that is not a React component!");return u()(i,o,{preload:!0}),o}var E=function(e){var t=b(e),n=v[t];return n&&n.status!==g||((n=y.requireAsync(e)).status=p,v[t]=n,n.then((function(){n.status="RESOLVED"}),(function(t){console.error("loadable-components: failed to asynchronously load component",{fileName:y.resolve(e),chunkName:y.chunkName(e),error:t?t.message:t}),n.status=g}))),n},A=function(e){var t=function(t){return r.createElement(d.Consumer,null,(function(n){return r.createElement(e,Object.assign({__chunkExtractor:n},t))}))};return e.displayName&&(t.displayName=e.displayName+"WithChunkExtractor"),t}(function(e){function n(n){var r;return(r=e.call(this,n)||this).state={result:null,error:null,loading:!0,cacheKey:b(n)},h(!n.__chunkExtractor||y.requireSync,"SSR requires `@loadable/babel-plugin`, please install it"),n.__chunkExtractor?(!1===t.ssr||(y.requireAsync(n).catch((function(){return null})),r.loadSync(),n.__chunkExtractor.addChunk(y.chunkName(n))),(0,s.Z)(r)):(!1!==t.ssr&&(y.isReady&&y.isReady(n)||y.chunkName&&f.initialChunks[y.chunkName(n)])&&r.loadSync(),r)}(0,a.Z)(n,e),n.getDerivedStateFromProps=function(e,t){var n=b(e);return(0,o.Z)({},t,{cacheKey:n,loading:t.loading||t.cacheKey!==n})};var r=n.prototype;return r.componentDidMount=function(){this.mounted=!0;var e=this.getCache();e&&e.status===g&&this.setCache(),this.state.loading&&this.loadAsync()},r.componentDidUpdate=function(e,t){t.cacheKey!==this.state.cacheKey&&this.loadAsync()},r.componentWillUnmount=function(){this.mounted=!1},r.safeSetState=function(e,t){this.mounted&&this.setState(e,t)},r.getCacheKey=function(){return b(this.props)},r.getCache=function(){return v[this.getCacheKey()]},r.setCache=function(e){void 0===e&&(e=void 0),v[this.getCacheKey()]=e},r.triggerOnLoad=function(){var e=this;m&&setTimeout((function(){m(e.state.result,e.props)}))},r.loadSync=function(){if(this.state.loading)try{var e=w(y.requireSync(this.props),this.props,S);this.state.result=e,this.state.loading=!1}catch(t){console.error("loadable-components: failed to synchronously load component, which expected to be available",{fileName:y.resolve(this.props),chunkName:y.chunkName(this.props),error:t?t.message:t}),this.state.error=t}},r.loadAsync=function(){var e=this,t=this.resolveAsync();return t.then((function(t){var n=w(t,e.props,S);e.safeSetState({result:n,loading:!1},(function(){return e.triggerOnLoad()}))})).catch((function(t){return e.safeSetState({error:t,loading:!1})})),t},r.resolveAsync=function(){var e=this.props,t=(e.__chunkExtractor,e.forwardedRef,(0,i.Z)(e,["__chunkExtractor","forwardedRef"]));return E(t)},r.render=function(){var e=this.props,n=e.forwardedRef,r=e.fallback,s=(e.__chunkExtractor,(0,i.Z)(e,["forwardedRef","fallback","__chunkExtractor"])),a=this.state,c=a.error,u=a.loading,h=a.result;if(t.suspense&&(this.getCache()||this.loadAsync()).status===p)throw this.loadAsync();if(c)throw c;var d=r||t.fallback||null;return u?d:l({fallback:d,result:h,options:t,props:(0,o.Z)({},s,{ref:n})})},n}(r.Component)),S=r.forwardRef((function(e,t){return r.createElement(A,Object.assign({forwardedRef:t},e))}));return S.displayName="Loadable",S.preload=function(e){S.load(e)},S.load=function(e){return E(e)},S}return{loadable:v,lazy:function(e,t){return v(e,(0,o.Z)({},t,{suspense:!0}))}}}var v=m({defaultResolveComponent:function(e){return e.__esModule?e.default:e.default||e},render:function(e){var t=e.result,n=e.props;return r.createElement(t,n)}}),b=v.loadable,w=v.lazy,E=m({onLoad:function(e,t){e&&t.forwardedRef&&("function"===typeof t.forwardedRef?t.forwardedRef(e):t.forwardedRef.current=e)},render:function(e){var t=e.result,n=e.props;return n.children?n.children(t):null}}),A=E.loadable,S=E.lazy;var _=b;_.lib=A,w.lib=S;const I=_},19814:e=>{"use strict";e.exports=function(e){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var r=0;r<e.length;r++){var i=e.charAt(r),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=r}var s=e.length,a=e.charAt(0),c=Math.log(s)/Math.log(256),l=Math.log(256)/Math.log(s);function u(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var n=0;if(" "!==e[n]){for(var r=0,i=0;e[n]===a;)r++,n++;for(var o=(e.length-n)*c+1>>>0,l=new Uint8Array(o);e[n];){var u=t[e.charCodeAt(n)];if(255===u)return;for(var h=0,d=o-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=s*l[d]>>>0,l[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,n++}if(" "!==e[n]){for(var f=o-i;f!==o&&0===l[f];)f++;for(var p=new Uint8Array(r+(o-f)),g=r;f!==o;)p[g++]=l[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,o=t.length;i!==o&&0===t[i];)i++,n++;for(var c=(o-i)*l+1>>>0,u=new Uint8Array(c);i!==o;){for(var h=t[i],d=0,f=c-1;(0!==h||d<r)&&-1!==f;f--,d++)h+=256*u[f]>>>0,u[f]=h%s>>>0,h=h/s>>>0;if(0!==h)throw new Error("Non-zero carry");r=d,i++}for(var p=c-r;p!==c&&0===u[p];)p++;for(var g=a.repeat(n);p<c;++p)g+=e.charAt(u[p]);return g},decodeUnsafe:u,decode:function(e){var t=u(e);if(t)return t;throw new Error("Non-base"+s+" character")}}}},9837:(e,t,n)=>{var r,i=n(1426);!function(){"use strict";var o="input is invalid type",s="object"===typeof window,a=s?window:{};a.JS_SHA3_NO_WINDOW&&(s=!1);var c=!s&&"object"===typeof self;!a.JS_SHA3_NO_NODE_JS&&"object"===typeof i&&i.versions&&i.versions.node?a=n.g:c&&(a=self);for(var l=!a.JS_SHA3_NO_COMMON_JS&&e.exports,u=n.amdO,h=!a.JS_SHA3_NO_ARRAY_BUFFER&&"undefined"!==typeof ArrayBuffer,d="0123456789abcdef".split(""),f=[4,1024,262144,67108864],p=[0,8,16,24],g=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],y=[224,256,384,512],m=[128,256],v=["hex","buffer","arrayBuffer","array","digest"],b={128:168,256:136},w=a.JS_SHA3_NO_NODE_JS||!Array.isArray?function(e){return"[object Array]"===Object.prototype.toString.call(e)}:Array.isArray,E=!h||!a.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView?ArrayBuffer.isView:function(e){return"object"===typeof e&&e.buffer&&e.buffer.constructor===ArrayBuffer},A=function(e){var t=typeof e;if("string"===t)return[e,!0];if("object"!==t||null===e)throw new Error(o);if(h&&e.constructor===ArrayBuffer)return[new Uint8Array(e),!1];if(!w(e)&&!E(e))throw new Error(o);return[e,!1]},S=function(e){return 0===A(e)[0].length},_=function(e,t,n){return function(r){return new F(e,t,e).update(r)[n]()}},I=function(e,t,n){return function(r,i){return new F(e,t,i).update(r)[n]()}},C=function(e,t,n){return function(t,r,i,o){return P["cshake"+e].update(t,r,i,o)[n]()}},T=function(e,t,n){return function(t,r,i,o){return P["kmac"+e].update(t,r,i,o)[n]()}},k=function(e,t,n,r){for(var i=0;i<v.length;++i){var o=v[i];e[o]=t(n,r,o)}return e},R=function(e,t){var n=_(e,t,"hex");return n.create=function(){return new F(e,t,e)},n.update=function(e){return n.create().update(e)},k(n,_,e,t)},x=[{name:"keccak",padding:[1,256,65536,16777216],bits:y,createMethod:R},{name:"sha3",padding:[6,1536,393216,100663296],bits:y,createMethod:R},{name:"shake",padding:[31,7936,2031616,520093696],bits:m,createMethod:function(e,t){var n=I(e,t,"hex");return n.create=function(n){return new F(e,t,n)},n.update=function(e,t){return n.create(t).update(e)},k(n,I,e,t)}},{name:"cshake",padding:f,bits:m,createMethod:function(e,t){var n=b[e],r=C(e,0,"hex");return r.create=function(r,i,o){return S(i)&&S(o)?P["shake"+e].create(r):new F(e,t,r).bytepad([i,o],n)},r.update=function(e,t,n,i){return r.create(t,n,i).update(e)},k(r,C,e,t)}},{name:"kmac",padding:f,bits:m,createMethod:function(e,t){var n=b[e],r=T(e,0,"hex");return r.create=function(r,i,o){return new K(e,t,i).bytepad(["KMAC",o],n).bytepad([r],n)},r.update=function(e,t,n,i){return r.create(e,n,i).update(t)},k(r,T,e,t)}}],P={},D=[],O=0;O<x.length;++O)for(var N=x[O],B=N.bits,L=0;L<B.length;++L){var M=N.name+"_"+B[L];if(D.push(M),P[M]=N.createMethod(B[L],N.padding),"sha3"!==N.name){var U=N.name+B[L];D.push(U),P[U]=P[M]}}function F(e,t,n){this.blocks=[],this.s=[],this.padding=t,this.outputBits=n,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(e<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=n>>5,this.extraBytes=(31&n)>>3;for(var r=0;r<50;++r)this.s[r]=0}function K(e,t,n){F.call(this,e,t,n)}F.prototype.update=function(e){if(this.finalized)throw new Error("finalize already called");var t=A(e);e=t[0];for(var n,r,i=t[1],o=this.blocks,s=this.byteCount,a=e.length,c=this.blockCount,l=0,u=this.s;l<a;){if(this.reset)for(this.reset=!1,o[0]=this.block,n=1;n<c+1;++n)o[n]=0;if(i)for(n=this.start;l<a&&n<s;++l)(r=e.charCodeAt(l))<128?o[n>>2]|=r<<p[3&n++]:r<2048?(o[n>>2]|=(192|r>>6)<<p[3&n++],o[n>>2]|=(128|63&r)<<p[3&n++]):r<55296||r>=57344?(o[n>>2]|=(224|r>>12)<<p[3&n++],o[n>>2]|=(128|r>>6&63)<<p[3&n++],o[n>>2]|=(128|63&r)<<p[3&n++]):(r=65536+((1023&r)<<10|1023&e.charCodeAt(++l)),o[n>>2]|=(240|r>>18)<<p[3&n++],o[n>>2]|=(128|r>>12&63)<<p[3&n++],o[n>>2]|=(128|r>>6&63)<<p[3&n++],o[n>>2]|=(128|63&r)<<p[3&n++]);else for(n=this.start;l<a&&n<s;++l)o[n>>2]|=e[l]<<p[3&n++];if(this.lastByteIndex=n,n>=s){for(this.start=n-s,this.block=o[c],n=0;n<c;++n)u[n]^=o[n];j(u),this.reset=!0}else this.start=n}return this},F.prototype.encode=function(e,t){var n=255&e,r=1,i=[n];for(n=255&(e>>=8);n>0;)i.unshift(n),n=255&(e>>=8),++r;return t?i.push(r):i.unshift(r),this.update(i),i.length},F.prototype.encodeString=function(e){var t=A(e);e=t[0];var n=t[1],r=0,i=e.length;if(n)for(var o=0;o<e.length;++o){var s=e.charCodeAt(o);s<128?r+=1:s<2048?r+=2:s<55296||s>=57344?r+=3:(s=65536+((1023&s)<<10|1023&e.charCodeAt(++o)),r+=4)}else r=i;return r+=this.encode(8*r),this.update(e),r},F.prototype.bytepad=function(e,t){for(var n=this.encode(t),r=0;r<e.length;++r)n+=this.encodeString(e[r]);var i=(t-n%t)%t,o=[];return o.length=i,this.update(o),this},F.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex,n=this.blockCount,r=this.s;if(e[t>>2]|=this.padding[3&t],this.lastByteIndex===this.byteCount)for(e[0]=e[n],t=1;t<n+1;++t)e[t]=0;for(e[n-1]|=2147483648,t=0;t<n;++t)r[t]^=e[t];j(r)}},F.prototype.toString=F.prototype.hex=function(){this.finalize();for(var e,t=this.blockCount,n=this.s,r=this.outputBlocks,i=this.extraBytes,o=0,s=0,a="";s<r;){for(o=0;o<t&&s<r;++o,++s)e=n[o],a+=d[e>>4&15]+d[15&e]+d[e>>12&15]+d[e>>8&15]+d[e>>20&15]+d[e>>16&15]+d[e>>28&15]+d[e>>24&15];s%t===0&&(j(n),o=0)}return i&&(e=n[o],a+=d[e>>4&15]+d[15&e],i>1&&(a+=d[e>>12&15]+d[e>>8&15]),i>2&&(a+=d[e>>20&15]+d[e>>16&15])),a},F.prototype.arrayBuffer=function(){this.finalize();var e,t=this.blockCount,n=this.s,r=this.outputBlocks,i=this.extraBytes,o=0,s=0,a=this.outputBits>>3;e=i?new ArrayBuffer(r+1<<2):new ArrayBuffer(a);for(var c=new Uint32Array(e);s<r;){for(o=0;o<t&&s<r;++o,++s)c[s]=n[o];s%t===0&&j(n)}return i&&(c[o]=n[o],e=e.slice(0,a)),e},F.prototype.buffer=F.prototype.arrayBuffer,F.prototype.digest=F.prototype.array=function(){this.finalize();for(var e,t,n=this.blockCount,r=this.s,i=this.outputBlocks,o=this.extraBytes,s=0,a=0,c=[];a<i;){for(s=0;s<n&&a<i;++s,++a)e=a<<2,t=r[s],c[e]=255&t,c[e+1]=t>>8&255,c[e+2]=t>>16&255,c[e+3]=t>>24&255;a%n===0&&j(r)}return o&&(e=a<<2,t=r[s],c[e]=255&t,o>1&&(c[e+1]=t>>8&255),o>2&&(c[e+2]=t>>16&255)),c},K.prototype=new F,K.prototype.finalize=function(){return this.encode(this.outputBits,!0),F.prototype.finalize.call(this)};var j=function(e){var t,n,r,i,o,s,a,c,l,u,h,d,f,p,y,m,v,b,w,E,A,S,_,I,C,T,k,R,x,P,D,O,N,B,L,M,U,F,K,j,Z,z,V,H,q,G,W,Q,Y,J,X,$,ee,te,ne,re,ie,oe,se,ae,ce,le,ue;for(r=0;r<48;r+=2)i=e[0]^e[10]^e[20]^e[30]^e[40],o=e[1]^e[11]^e[21]^e[31]^e[41],s=e[2]^e[12]^e[22]^e[32]^e[42],a=e[3]^e[13]^e[23]^e[33]^e[43],c=e[4]^e[14]^e[24]^e[34]^e[44],l=e[5]^e[15]^e[25]^e[35]^e[45],u=e[6]^e[16]^e[26]^e[36]^e[46],h=e[7]^e[17]^e[27]^e[37]^e[47],t=(d=e[8]^e[18]^e[28]^e[38]^e[48])^(s<<1|a>>>31),n=(f=e[9]^e[19]^e[29]^e[39]^e[49])^(a<<1|s>>>31),e[0]^=t,e[1]^=n,e[10]^=t,e[11]^=n,e[20]^=t,e[21]^=n,e[30]^=t,e[31]^=n,e[40]^=t,e[41]^=n,t=i^(c<<1|l>>>31),n=o^(l<<1|c>>>31),e[2]^=t,e[3]^=n,e[12]^=t,e[13]^=n,e[22]^=t,e[23]^=n,e[32]^=t,e[33]^=n,e[42]^=t,e[43]^=n,t=s^(u<<1|h>>>31),n=a^(h<<1|u>>>31),e[4]^=t,e[5]^=n,e[14]^=t,e[15]^=n,e[24]^=t,e[25]^=n,e[34]^=t,e[35]^=n,e[44]^=t,e[45]^=n,t=c^(d<<1|f>>>31),n=l^(f<<1|d>>>31),e[6]^=t,e[7]^=n,e[16]^=t,e[17]^=n,e[26]^=t,e[27]^=n,e[36]^=t,e[37]^=n,e[46]^=t,e[47]^=n,t=u^(i<<1|o>>>31),n=h^(o<<1|i>>>31),e[8]^=t,e[9]^=n,e[18]^=t,e[19]^=n,e[28]^=t,e[29]^=n,e[38]^=t,e[39]^=n,e[48]^=t,e[49]^=n,p=e[0],y=e[1],G=e[11]<<4|e[10]>>>28,W=e[10]<<4|e[11]>>>28,R=e[20]<<3|e[21]>>>29,x=e[21]<<3|e[20]>>>29,ae=e[31]<<9|e[30]>>>23,ce=e[30]<<9|e[31]>>>23,z=e[40]<<18|e[41]>>>14,V=e[41]<<18|e[40]>>>14,B=e[2]<<1|e[3]>>>31,L=e[3]<<1|e[2]>>>31,m=e[13]<<12|e[12]>>>20,v=e[12]<<12|e[13]>>>20,Q=e[22]<<10|e[23]>>>22,Y=e[23]<<10|e[22]>>>22,P=e[33]<<13|e[32]>>>19,D=e[32]<<13|e[33]>>>19,le=e[42]<<2|e[43]>>>30,ue=e[43]<<2|e[42]>>>30,te=e[5]<<30|e[4]>>>2,ne=e[4]<<30|e[5]>>>2,M=e[14]<<6|e[15]>>>26,U=e[15]<<6|e[14]>>>26,b=e[25]<<11|e[24]>>>21,w=e[24]<<11|e[25]>>>21,J=e[34]<<15|e[35]>>>17,X=e[35]<<15|e[34]>>>17,O=e[45]<<29|e[44]>>>3,N=e[44]<<29|e[45]>>>3,I=e[6]<<28|e[7]>>>4,C=e[7]<<28|e[6]>>>4,re=e[17]<<23|e[16]>>>9,ie=e[16]<<23|e[17]>>>9,F=e[26]<<25|e[27]>>>7,K=e[27]<<25|e[26]>>>7,E=e[36]<<21|e[37]>>>11,A=e[37]<<21|e[36]>>>11,$=e[47]<<24|e[46]>>>8,ee=e[46]<<24|e[47]>>>8,H=e[8]<<27|e[9]>>>5,q=e[9]<<27|e[8]>>>5,T=e[18]<<20|e[19]>>>12,k=e[19]<<20|e[18]>>>12,oe=e[29]<<7|e[28]>>>25,se=e[28]<<7|e[29]>>>25,j=e[38]<<8|e[39]>>>24,Z=e[39]<<8|e[38]>>>24,S=e[48]<<14|e[49]>>>18,_=e[49]<<14|e[48]>>>18,e[0]=p^~m&b,e[1]=y^~v&w,e[10]=I^~T&R,e[11]=C^~k&x,e[20]=B^~M&F,e[21]=L^~U&K,e[30]=H^~G&Q,e[31]=q^~W&Y,e[40]=te^~re&oe,e[41]=ne^~ie&se,e[2]=m^~b&E,e[3]=v^~w&A,e[12]=T^~R&P,e[13]=k^~x&D,e[22]=M^~F&j,e[23]=U^~K&Z,e[32]=G^~Q&J,e[33]=W^~Y&X,e[42]=re^~oe&ae,e[43]=ie^~se&ce,e[4]=b^~E&S,e[5]=w^~A&_,e[14]=R^~P&O,e[15]=x^~D&N,e[24]=F^~j&z,e[25]=K^~Z&V,e[34]=Q^~J&$,e[35]=Y^~X&ee,e[44]=oe^~ae&le,e[45]=se^~ce&ue,e[6]=E^~S&p,e[7]=A^~_&y,e[16]=P^~O&I,e[17]=D^~N&C,e[26]=j^~z&B,e[27]=Z^~V&L,e[36]=J^~$&H,e[37]=X^~ee&q,e[46]=ae^~le&te,e[47]=ce^~ue&ne,e[8]=S^~p&m,e[9]=_^~y&v,e[18]=O^~I&T,e[19]=N^~C&k,e[28]=z^~B&M,e[29]=V^~L&U,e[38]=$^~H&G,e[39]=ee^~q&W,e[48]=le^~te&re,e[49]=ue^~ne&ie,e[0]^=g[r],e[1]^=g[r+1]};if(l)e.exports=P;else{for(O=0;O<D.length;++O)a[D[O]]=P[D[O]];u&&(void 0===(r=function(){return P}.call(t,n,t,e))||(e.exports=r))}}()},17206:e=>{"use strict";e.exports=function(e,t){var n=new Array(arguments.length-1),r=0,i=2,o=!0;for(;i<arguments.length;)n[r++]=arguments[i++];return new Promise((function(i,s){n[r]=function(e){if(o)if(o=!1,e)s(e);else{for(var t=new Array(arguments.length-1),n=0;n<t.length;)t[n++]=arguments[n];i.apply(null,t)}};try{e.apply(t||null,n)}catch(a){o&&(o=!1,s(a))}}))}},70001:(e,t)=>{"use strict";var n=t;n.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;--t%4>1&&"="===e.charAt(t);)++n;return Math.ceil(3*e.length)/4-n};for(var r=new Array(64),i=new Array(123),o=0;o<64;)i[r[o]=o<26?o+65:o<52?o+71:o<62?o-4:o-59|43]=o++;n.encode=function(e,t,n){for(var i,o=null,s=[],a=0,c=0;t<n;){var l=e[t++];switch(c){case 0:s[a++]=r[l>>2],i=(3&l)<<4,c=1;break;case 1:s[a++]=r[i|l>>4],i=(15&l)<<2,c=2;break;case 2:s[a++]=r[i|l>>6],s[a++]=r[63&l],c=0}a>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,s)),a=0)}return c&&(s[a++]=r[i],s[a++]=61,1===c&&(s[a++]=61)),o?(a&&o.push(String.fromCharCode.apply(String,s.slice(0,a))),o.join("")):String.fromCharCode.apply(String,s.slice(0,a))};var s="invalid encoding";n.decode=function(e,t,n){for(var r,o=n,a=0,c=0;c<e.length;){var l=e.charCodeAt(c++);if(61===l&&a>1)break;if(void 0===(l=i[l]))throw Error(s);switch(a){case 0:r=l,a=1;break;case 1:t[n++]=r<<2|(48&l)>>4,r=l,a=2;break;case 2:t[n++]=(15&r)<<4|(60&l)>>2,r=l,a=3;break;case 3:t[n++]=(3&r)<<6|l,a=0}}if(1===a)throw Error(s);return n-o},n.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},27111:e=>{"use strict";function t(){this._listeners={}}e.exports=t,t.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this},t.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var n=this._listeners[e],r=0;r<n.length;)n[r].fn===t?n.splice(r,1):++r;return this},t.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],r=1;r<arguments.length;)n.push(arguments[r++]);for(r=0;r<t.length;)t[r].fn.apply(t[r++].ctx,n)}return this}},30802:e=>{"use strict";function t(e){return"undefined"!==typeof Float32Array?function(){var t=new Float32Array([-0]),n=new Uint8Array(t.buffer),r=128===n[3];function i(e,r,i){t[0]=e,r[i]=n[0],r[i+1]=n[1],r[i+2]=n[2],r[i+3]=n[3]}function o(e,r,i){t[0]=e,r[i]=n[3],r[i+1]=n[2],r[i+2]=n[1],r[i+3]=n[0]}function s(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],t[0]}function a(e,r){return n[3]=e[r],n[2]=e[r+1],n[1]=e[r+2],n[0]=e[r+3],t[0]}e.writeFloatLE=r?i:o,e.writeFloatBE=r?o:i,e.readFloatLE=r?s:a,e.readFloatBE=r?a:s}():function(){function t(e,t,n,r){var i=t<0?1:0;if(i&&(t=-t),0===t)e(1/t>0?0:2147483648,n,r);else if(isNaN(t))e(2143289344,n,r);else if(t>34028234663852886e22)e((i<<31|2139095040)>>>0,n,r);else if(t<11754943508222875e-54)e((i<<31|Math.round(t/1401298464324817e-60))>>>0,n,r);else{var o=Math.floor(Math.log(t)/Math.LN2);e((i<<31|o+127<<23|8388607&Math.round(t*Math.pow(2,-o)*8388608))>>>0,n,r)}}function s(e,t,n){var r=e(t,n),i=2*(r>>31)+1,o=r>>>23&255,s=8388607&r;return 255===o?s?NaN:i*(1/0):0===o?1401298464324817e-60*i*s:i*Math.pow(2,o-150)*(s+8388608)}e.writeFloatLE=t.bind(null,n),e.writeFloatBE=t.bind(null,r),e.readFloatLE=s.bind(null,i),e.readFloatBE=s.bind(null,o)}(),"undefined"!==typeof Float64Array?function(){var t=new Float64Array([-0]),n=new Uint8Array(t.buffer),r=128===n[7];function i(e,r,i){t[0]=e,r[i]=n[0],r[i+1]=n[1],r[i+2]=n[2],r[i+3]=n[3],r[i+4]=n[4],r[i+5]=n[5],r[i+6]=n[6],r[i+7]=n[7]}function o(e,r,i){t[0]=e,r[i]=n[7],r[i+1]=n[6],r[i+2]=n[5],r[i+3]=n[4],r[i+4]=n[3],r[i+5]=n[2],r[i+6]=n[1],r[i+7]=n[0]}function s(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],n[4]=e[r+4],n[5]=e[r+5],n[6]=e[r+6],n[7]=e[r+7],t[0]}function a(e,r){return n[7]=e[r],n[6]=e[r+1],n[5]=e[r+2],n[4]=e[r+3],n[3]=e[r+4],n[2]=e[r+5],n[1]=e[r+6],n[0]=e[r+7],t[0]}e.writeDoubleLE=r?i:o,e.writeDoubleBE=r?o:i,e.readDoubleLE=r?s:a,e.readDoubleBE=r?a:s}():function(){function t(e,t,n,r,i,o){var s=r<0?1:0;if(s&&(r=-r),0===r)e(0,i,o+t),e(1/r>0?0:2147483648,i,o+n);else if(isNaN(r))e(0,i,o+t),e(2146959360,i,o+n);else if(r>17976931348623157e292)e(0,i,o+t),e((s<<31|2146435072)>>>0,i,o+n);else{var a;if(r<22250738585072014e-324)e((a=r/5e-324)>>>0,i,o+t),e((s<<31|a/4294967296)>>>0,i,o+n);else{var c=Math.floor(Math.log(r)/Math.LN2);1024===c&&(c=1023),e(4503599627370496*(a=r*Math.pow(2,-c))>>>0,i,o+t),e((s<<31|c+1023<<20|1048576*a&1048575)>>>0,i,o+n)}}}function s(e,t,n,r,i){var o=e(r,i+t),s=e(r,i+n),a=2*(s>>31)+1,c=s>>>20&2047,l=4294967296*(1048575&s)+o;return 2047===c?l?NaN:a*(1/0):0===c?5e-324*a*l:a*Math.pow(2,c-1075)*(l+4503599627370496)}e.writeDoubleLE=t.bind(null,n,0,4),e.writeDoubleBE=t.bind(null,r,4,0),e.readDoubleLE=s.bind(null,i,0,4),e.readDoubleBE=s.bind(null,o,4,0)}(),e}function n(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}function r(e,t,n){t[n]=e>>>24,t[n+1]=e>>>16&255,t[n+2]=e>>>8&255,t[n+3]=255&e}function i(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function o(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=t(t)},77172:module=>{"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},58236:e=>{"use strict";e.exports=function(e,t,n){var r=n||8192,i=r>>>1,o=null,s=r;return function(n){if(n<1||n>i)return e(n);s+n>r&&(o=e(r),s=0);var a=t.call(o,s,s+=n);return 7&s&&(s=1+(7|s)),a}}},93861:(e,t)=>{"use strict";var n=t;n.length=function(e){for(var t=0,n=0,r=0;r<e.length;++r)(n=e.charCodeAt(r))<128?t+=1:n<2048?t+=2:55296===(64512&n)&&56320===(64512&e.charCodeAt(r+1))?(++r,t+=4):t+=3;return t},n.read=function(e,t,n){if(n-t<1)return"";for(var r,i=null,o=[],s=0;t<n;)(r=e[t++])<128?o[s++]=r:r>191&&r<224?o[s++]=(31&r)<<6|63&e[t++]:r>239&&r<365?(r=((7&r)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,o[s++]=55296+(r>>10),o[s++]=56320+(1023&r)):o[s++]=(15&r)<<12|(63&e[t++])<<6|63&e[t++],s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),s=0);return i?(s&&i.push(String.fromCharCode.apply(String,o.slice(0,s))),i.join("")):String.fromCharCode.apply(String,o.slice(0,s))},n.write=function(e,t,n){for(var r,i,o=n,s=0;s<e.length;++s)(r=e.charCodeAt(s))<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296===(64512&r)&&56320===(64512&(i=e.charCodeAt(s+1)))?(r=65536+((1023&r)<<10)+(1023&i),++s,t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128);return n-o}},5204:(e,t,n)=>{"use strict";function r(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(!e){var o;if(void 0===t)o=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var s=0;(o=new Error(t.replace(/%s/g,(function(){return r[s++]})))).name="Invariant Violation"}throw o.framesToPop=1,o}}n.d(t,{k:()=>r})},62702:(e,t,n)=>{"use strict";function r(e,t,n,r){var i=n?n.call(r,e,t):void 0;if(void 0!==i)return!!i;if(e===t)return!0;if("object"!==typeof e||!e||"object"!==typeof t||!t)return!1;var o=Object.keys(e),s=Object.keys(t);if(o.length!==s.length)return!1;for(var a=Object.prototype.hasOwnProperty.bind(t),c=0;c<o.length;c++){var l=o[c];if(!a(l))return!1;var u=e[l],h=t[l];if(!1===(i=n?n.call(r,u,h,l):void 0)||void 0===i&&u!==h)return!1}return!0}n.d(t,{w:()=>r})},56755:(e,t)=>{"use strict";const n=Math.exp;e.exports=function(e){if("number"!==typeof e)throw new Error("must provide a timespan to the moving average constructor");if(e<=0)throw new Error("must provide a timespan > 0 to the moving average constructor");let t,r,i=0,o=0,s=0,a={};return a.push=function(a,c){if(r){const l=1-n(-(a-r)/e),u=c-t;t=l*c+(1-l)*t,i=(1-l)*(i+u*(l*u)),o=Math.sqrt(i),s=t+l*u}else t=c;r=a},a.movingAverage=function(){return t},a.variance=function(){return i},a.deviation=function(){return o},a.forecast=function(){return s},a}},2009:(e,t)=>{"use strict";t.byteLength=function(e){var t=a(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,o=a(e),s=o[0],c=o[1],l=new i(function(e,t,n){return 3*(t+n)/4-n}(0,s,c)),u=0,h=c>0?s-4:s;for(n=0;n<h;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],l[u++]=t>>16&255,l[u++]=t>>8&255,l[u++]=255&t;2===c&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,l[u++]=255&t);1===c&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,l[u++]=t>>8&255,l[u++]=255&t);return l},t.fromByteArray=function(e){for(var t,r=e.length,i=r%3,o=[],s=16383,a=0,l=r-i;a<l;a+=s)o.push(c(e,a,a+s>l?l:a+s));1===i?(t=e[r-1],o.push(n[t>>2]+n[t<<4&63]+"==")):2===i&&(t=(e[r-2]<<8)+e[r-1],o.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return o.join("")};for(var n=[],r=[],i="undefined"!==typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0;s<64;++s)n[s]=o[s],r[o.charCodeAt(s)]=s;function a(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function c(e,t,r){for(var i,o,s=[],a=t;a<r;a+=3)i=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(n[(o=i)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return s.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},75584:(e,t,n)=>{"use strict";function r(e){try{let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){const n=e.getReader();try{for(;;){const e=await n.read();if(e.done)return;yield e.value}}finally{!0!==t.preventCancel&&await n.cancel(),n.releaseLock()}}()}catch(t){return Promise.reject(t)}}n.d(t,{Z:()=>r})},19778:(e,t,n)=>{"use strict";const r=n(2009),i=n(84038),o="function"===typeof Symbol&&"function"===typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=c,t.SlowBuffer=function(e){+e!=e&&(e=0);return c.alloc(+e)},t.INSPECT_MAX_BYTES=50;const s=2147483647;function a(e){if(e>s)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,c.prototype),t}function c(e,t,n){if("number"===typeof e){if("string"===typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return h(e)}return l(e,t,n)}function l(e,t,n){if("string"===typeof e)return function(e,t){"string"===typeof t&&""!==t||(t="utf8");if(!c.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const n=0|g(e,t);let r=a(n);const i=r.write(e,t);i!==n&&(r=r.slice(0,i));return r}(e,t);if(ArrayBuffer.isView(e))return function(e){if(Q(e,Uint8Array)){const t=new Uint8Array(e);return f(t.buffer,t.byteOffset,t.byteLength)}return d(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(Q(e,ArrayBuffer)||e&&Q(e.buffer,ArrayBuffer))return f(e,t,n);if("undefined"!==typeof SharedArrayBuffer&&(Q(e,SharedArrayBuffer)||e&&Q(e.buffer,SharedArrayBuffer)))return f(e,t,n);if("number"===typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return c.from(r,t,n);const i=function(e){if(c.isBuffer(e)){const t=0|p(e.length),n=a(t);return 0===n.length||e.copy(n,0,0,t),n}if(void 0!==e.length)return"number"!==typeof e.length||Y(e.length)?a(0):d(e);if("Buffer"===e.type&&Array.isArray(e.data))return d(e.data)}(e);if(i)return i;if("undefined"!==typeof Symbol&&null!=Symbol.toPrimitive&&"function"===typeof e[Symbol.toPrimitive])return c.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function u(e){if("number"!==typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function h(e){return u(e),a(e<0?0:0|p(e))}function d(e){const t=e.length<0?0:0|p(e.length),n=a(t);for(let r=0;r<t;r+=1)n[r]=255&e[r];return n}function f(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');let r;return r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(r,c.prototype),r}function p(e){if(e>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return 0|e}function g(e,t){if(c.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||Q(e,ArrayBuffer))return e.byteLength;if("string"!==typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return q(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return G(e).length;default:if(i)return r?-1:q(e).length;t=(""+t).toLowerCase(),i=!0}}function y(e,t,n){let r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return x(this,t,n);case"utf8":case"utf-8":return C(this,t,n);case"ascii":return k(this,t,n);case"latin1":case"binary":return R(this,t,n);case"base64":return I(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function m(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function v(e,t,n,r,i){if(0===e.length)return-1;if("string"===typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),Y(n=+n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"===typeof t&&(t=c.from(t,r)),c.isBuffer(t))return 0===t.length?-1:b(e,t,n,r,i);if("number"===typeof t)return t&=255,"function"===typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):b(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function b(e,t,n,r,i){let o,s=1,a=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s=2,a/=2,c/=2,n/=2}function l(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){let r=-1;for(o=n;o<a;o++)if(l(e,o)===l(t,-1===r?0:o-r)){if(-1===r&&(r=o),o-r+1===c)return r*s}else-1!==r&&(o-=o-r),r=-1}else for(n+c>a&&(n=a-c),o=n;o>=0;o--){let n=!0;for(let r=0;r<c;r++)if(l(e,o+r)!==l(t,r)){n=!1;break}if(n)return o}return-1}function w(e,t,n,r){n=Number(n)||0;const i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;const o=t.length;let s;for(r>o/2&&(r=o/2),s=0;s<r;++s){const r=parseInt(t.substr(2*s,2),16);if(Y(r))return s;e[n+s]=r}return s}function E(e,t,n,r){return W(q(t,e.length-n),e,n,r)}function A(e,t,n,r){return W(function(e){const t=[];for(let n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function S(e,t,n,r){return W(G(t),e,n,r)}function _(e,t,n,r){return W(function(e,t){let n,r,i;const o=[];for(let s=0;s<e.length&&!((t-=2)<0);++s)n=e.charCodeAt(s),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function I(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function C(e,t,n){n=Math.min(e.length,n);const r=[];let i=t;for(;i<n;){const t=e[i];let o=null,s=t>239?4:t>223?3:t>191?2:1;if(i+s<=n){let n,r,a,c;switch(s){case 1:t<128&&(o=t);break;case 2:n=e[i+1],128===(192&n)&&(c=(31&t)<<6|63&n,c>127&&(o=c));break;case 3:n=e[i+1],r=e[i+2],128===(192&n)&&128===(192&r)&&(c=(15&t)<<12|(63&n)<<6|63&r,c>2047&&(c<55296||c>57343)&&(o=c));break;case 4:n=e[i+1],r=e[i+2],a=e[i+3],128===(192&n)&&128===(192&r)&&128===(192&a)&&(c=(15&t)<<18|(63&n)<<12|(63&r)<<6|63&a,c>65535&&c<1114112&&(o=c))}}null===o?(o=65533,s=1):o>65535&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|1023&o),r.push(o),i+=s}return function(e){const t=e.length;if(t<=T)return String.fromCharCode.apply(String,e);let n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=T));return n}(r)}t.kMaxLength=s,c.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),c.TYPED_ARRAY_SUPPORT||"undefined"===typeof console||"function"!==typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}}),c.poolSize=8192,c.from=function(e,t,n){return l(e,t,n)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array),c.alloc=function(e,t,n){return function(e,t,n){return u(e),e<=0?a(e):void 0!==t?"string"===typeof n?a(e).fill(t,n):a(e).fill(t):a(e)}(e,t,n)},c.allocUnsafe=function(e){return h(e)},c.allocUnsafeSlow=function(e){return h(e)},c.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==c.prototype},c.compare=function(e,t){if(Q(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),Q(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let n=e.length,r=t.length;for(let i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);let n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;const r=c.allocUnsafe(t);let i=0;for(n=0;n<e.length;++n){let t=e[n];if(Q(t,Uint8Array))i+t.length>r.length?(c.isBuffer(t)||(t=c.from(t)),t.copy(r,i)):Uint8Array.prototype.set.call(r,t,i);else{if(!c.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(r,i)}i+=t.length}return r},c.byteLength=g,c.prototype._isBuffer=!0,c.prototype.swap16=function(){const e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)m(this,t,t+1);return this},c.prototype.swap32=function(){const e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},c.prototype.swap64=function(){const e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},c.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?C(this,0,e):y.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){let e="";const n=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},o&&(c.prototype[o]=c.prototype.inspect),c.prototype.compare=function(e,t,n,r,i){if(Q(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),!c.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;let o=(i>>>=0)-(r>>>=0),s=(n>>>=0)-(t>>>=0);const a=Math.min(o,s),l=this.slice(r,i),u=e.slice(t,n);for(let c=0;c<a;++c)if(l[c]!==u[c]){o=l[c],s=u[c];break}return o<s?-1:s<o?1:0},c.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},c.prototype.indexOf=function(e,t,n){return v(this,e,t,n,!0)},c.prototype.lastIndexOf=function(e,t,n){return v(this,e,t,n,!1)},c.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"===typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}const i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let o=!1;for(;;)switch(r){case"hex":return w(this,e,t,n);case"utf8":case"utf-8":return E(this,e,t,n);case"ascii":case"latin1":case"binary":return A(this,e,t,n);case"base64":return S(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const T=4096;function k(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function R(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function x(e,t,n){const r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);let i="";for(let o=t;o<n;++o)i+=J[e[o]];return i}function P(e,t,n){const r=e.slice(t,n);let i="";for(let o=0;o<r.length-1;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function D(e,t,n){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function O(e,t,n,r,i,o){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function N(e,t,n,r,i){Z(t,r,i,e,n,7);let o=Number(t&BigInt(4294967295));e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s,n}function B(e,t,n,r,i){Z(t,r,i,e,n,7);let o=Number(t&BigInt(4294967295));e[n+7]=o,o>>=8,e[n+6]=o,o>>=8,e[n+5]=o,o>>=8,e[n+4]=o;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[n+3]=s,s>>=8,e[n+2]=s,s>>=8,e[n+1]=s,s>>=8,e[n]=s,n+8}function L(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function M(e,t,n,r,o){return t=+t,n>>>=0,o||L(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function U(e,t,n,r,o){return t=+t,n>>>=0,o||L(e,0,n,8),i.write(e,t,n,r,52,8),n+8}c.prototype.slice=function(e,t){const n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);const r=this.subarray(e,t);return Object.setPrototypeOf(r,c.prototype),r},c.prototype.readUintLE=c.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||D(e,t,this.length);let r=this[e],i=1,o=0;for(;++o<t&&(i*=256);)r+=this[e+o]*i;return r},c.prototype.readUintBE=c.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||D(e,t,this.length);let r=this[e+--t],i=1;for(;t>0&&(i*=256);)r+=this[e+--t]*i;return r},c.prototype.readUint8=c.prototype.readUInt8=function(e,t){return e>>>=0,t||D(e,1,this.length),this[e]},c.prototype.readUint16LE=c.prototype.readUInt16LE=function(e,t){return e>>>=0,t||D(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUint16BE=c.prototype.readUInt16BE=function(e,t){return e>>>=0,t||D(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUint32LE=c.prototype.readUInt32LE=function(e,t){return e>>>=0,t||D(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUint32BE=c.prototype.readUInt32BE=function(e,t){return e>>>=0,t||D(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readBigUInt64LE=X((function(e){z(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||V(e,this.length-8);const r=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+n*2**24;return BigInt(r)+(BigInt(i)<<BigInt(32))})),c.prototype.readBigUInt64BE=X((function(e){z(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||V(e,this.length-8);const r=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+n;return(BigInt(r)<<BigInt(32))+BigInt(i)})),c.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||D(e,t,this.length);let r=this[e],i=1,o=0;for(;++o<t&&(i*=256);)r+=this[e+o]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*t)),r},c.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||D(e,t,this.length);let r=t,i=1,o=this[e+--r];for(;r>0&&(i*=256);)o+=this[e+--r]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*t)),o},c.prototype.readInt8=function(e,t){return e>>>=0,t||D(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){e>>>=0,t||D(e,2,this.length);const n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(e,t){e>>>=0,t||D(e,2,this.length);const n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(e,t){return e>>>=0,t||D(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return e>>>=0,t||D(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readBigInt64LE=X((function(e){z(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||V(e,this.length-8);const r=this[e+4]+256*this[e+5]+65536*this[e+6]+(n<<24);return(BigInt(r)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),c.prototype.readBigInt64BE=X((function(e){z(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||V(e,this.length-8);const r=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(r)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+n)})),c.prototype.readFloatLE=function(e,t){return e>>>=0,t||D(e,4,this.length),i.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return e>>>=0,t||D(e,4,this.length),i.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return e>>>=0,t||D(e,8,this.length),i.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return e>>>=0,t||D(e,8,this.length),i.read(this,e,!1,52,8)},c.prototype.writeUintLE=c.prototype.writeUIntLE=function(e,t,n,r){if(e=+e,t>>>=0,n>>>=0,!r){O(this,e,t,n,Math.pow(2,8*n)-1,0)}let i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},c.prototype.writeUintBE=c.prototype.writeUIntBE=function(e,t,n,r){if(e=+e,t>>>=0,n>>>=0,!r){O(this,e,t,n,Math.pow(2,8*n)-1,0)}let i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},c.prototype.writeUint8=c.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||O(this,e,t,1,255,0),this[t]=255&e,t+1},c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||O(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||O(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||O(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||O(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeBigUInt64LE=X((function(e){return N(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,BigInt(0),BigInt("0xffffffffffffffff"))})),c.prototype.writeBigUInt64BE=X((function(e){return B(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,BigInt(0),BigInt("0xffffffffffffffff"))})),c.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);O(this,e,t,n,r-1,-r)}let i=0,o=1,s=0;for(this[t]=255&e;++i<n&&(o*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/o>>0)-s&255;return t+n},c.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);O(this,e,t,n,r-1,-r)}let i=n-1,o=1,s=0;for(this[t+i]=255&e;--i>=0&&(o*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/o>>0)-s&255;return t+n},c.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||O(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||O(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||O(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||O(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},c.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||O(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeBigInt64LE=X((function(e){return N(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),c.prototype.writeBigInt64BE=X((function(e){return B(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),c.prototype.writeFloatLE=function(e,t,n){return M(this,e,t,!0,n)},c.prototype.writeFloatBE=function(e,t,n){return M(this,e,t,!1,n)},c.prototype.writeDoubleLE=function(e,t,n){return U(this,e,t,!0,n)},c.prototype.writeDoubleBE=function(e,t,n){return U(this,e,t,!1,n)},c.prototype.copy=function(e,t,n,r){if(!c.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);const i=r-n;return this===e&&"function"===typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,r):Uint8Array.prototype.set.call(e,this.subarray(n,r),t),i},c.prototype.fill=function(e,t,n,r){if("string"===typeof e){if("string"===typeof t?(r=t,t=0,n=this.length):"string"===typeof n&&(r=n,n=this.length),void 0!==r&&"string"!==typeof r)throw new TypeError("encoding must be a string");if("string"===typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){const t=e.charCodeAt(0);("utf8"===r&&t<128||"latin1"===r)&&(e=t)}}else"number"===typeof e?e&=255:"boolean"===typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;let i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"===typeof e)for(i=t;i<n;++i)this[i]=e;else{const o=c.isBuffer(e)?e:c.from(e,r),s=o.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<n-t;++i)this[i+t]=o[i%s]}return this};const F={};function K(e,t,n){F[e]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name="".concat(this.name," [").concat(e,"]"),this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return"".concat(this.name," [").concat(e,"]: ").concat(this.message)}}}function j(e){let t="",n=e.length;const r="-"===e[0]?1:0;for(;n>=r+4;n-=3)t="_".concat(e.slice(n-3,n)).concat(t);return"".concat(e.slice(0,n)).concat(t)}function Z(e,t,n,r,i,o){if(e>n||e<t){const r="bigint"===typeof t?"n":"";let i;throw i=o>3?0===t||t===BigInt(0)?">= 0".concat(r," and < 2").concat(r," ** ").concat(8*(o+1)).concat(r):">= -(2".concat(r," ** ").concat(8*(o+1)-1).concat(r,") and < 2 ** ")+"".concat(8*(o+1)-1).concat(r):">= ".concat(t).concat(r," and <= ").concat(n).concat(r),new F.ERR_OUT_OF_RANGE("value",i,e)}!function(e,t,n){z(t,"offset"),void 0!==e[t]&&void 0!==e[t+n]||V(t,e.length-(n+1))}(r,i,o)}function z(e,t){if("number"!==typeof e)throw new F.ERR_INVALID_ARG_TYPE(t,"number",e)}function V(e,t,n){if(Math.floor(e)!==e)throw z(e,n),new F.ERR_OUT_OF_RANGE(n||"offset","an integer",e);if(t<0)throw new F.ERR_BUFFER_OUT_OF_BOUNDS;throw new F.ERR_OUT_OF_RANGE(n||"offset",">= ".concat(n?1:0," and <= ").concat(t),e)}K("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?"".concat(e," is outside of buffer bounds"):"Attempt to access memory outside buffer bounds"}),RangeError),K("ERR_INVALID_ARG_TYPE",(function(e,t){return'The "'.concat(e,'" argument must be of type number. Received type ').concat(typeof t)}),TypeError),K("ERR_OUT_OF_RANGE",(function(e,t,n){let r='The value of "'.concat(e,'" is out of range.'),i=n;return Number.isInteger(n)&&Math.abs(n)>2**32?i=j(String(n)):"bigint"===typeof n&&(i=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(i=j(i)),i+="n"),r+=" It must be ".concat(t,". Received ").concat(i),r}),RangeError);const H=/[^+/0-9A-Za-z-_]/g;function q(e,t){let n;t=t||1/0;const r=e.length;let i=null;const o=[];for(let s=0;s<r;++s){if(n=e.charCodeAt(s),n>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function G(e){return r.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(H,"")).length<2)return"";for(;e.length%4!==0;)e+="=";return e}(e))}function W(e,t,n,r){let i;for(i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function Q(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function Y(e){return e!==e}const J=function(){const e="0123456789abcdef",t=new Array(256);for(let n=0;n<16;++n){const r=16*n;for(let i=0;i<16;++i)t[r+i]=e[n]+e[i]}return t}();function X(e){return"undefined"===typeof BigInt?$:e}function $(){throw new Error("BigInt not supported")}},97394:(e,t,n)=>{var r=n(98059),i=n(17870);e.exports=function(e,t,n){var o=i(e,t);return n||(o=o.replace(/ (?=\d)/g,"_")),o.replace(/ (.)/g,(function(e,n){return r(n,t)}))}},69497:(e,t,n)=>{t.no=t.noCase=n(17870),t.dot=t.dotCase=n(7142),t.swap=t.swapCase=n(68241),t.path=t.pathCase=n(15102),t.upper=t.upperCase=n(98059),t.lower=t.lowerCase=n(60463),t.camel=t.camelCase=n(97394),t.snake=t.snakeCase=n(42956),t.title=t.titleCase=n(27220),t.param=t.paramCase=n(22910),t.kebab=t.kebabCase=t.paramCase,t.hyphen=t.hyphenCase=t.paramCase,t.header=t.headerCase=n(39895),t.pascal=t.pascalCase=n(87265),t.constant=t.constantCase=n(23998),t.sentence=t.sentenceCase=n(93884),t.isUpper=t.isUpperCase=n(49355),t.isLower=t.isLowerCase=n(14456),t.ucFirst=t.upperCaseFirst=n(32996),t.lcFirst=t.lowerCaseFirst=n(16386)},81694:(e,t)=>{var n;!function(){"use strict";var r={}.hasOwnProperty;function i(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var o=typeof n;if("string"===o||"number"===o)e.push(n);else if(Array.isArray(n)){if(n.length){var s=i.apply(null,n);s&&e.push(s)}}else if("object"===o){if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]")){e.push(n.toString());continue}for(var a in n)r.call(n,a)&&n[a]&&e.push(a)}}}return e.join(" ")}e.exports?(i.default=i,e.exports=i):void 0===(n=function(){return i}.apply(t,[]))||(e.exports=n)}()},23998:(e,t,n)=>{var r=n(98059),i=n(42956);e.exports=function(e,t){return r(i(e,t),t)}},52354:(e,t,n)=>{async function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{raw:!1};const n=e=>{if(r.didShowInfo)return;if("EncodingError"!==e.name)return;r.didShowInfo=!0;const t="".concat(e.name," occured within datatransfer-files-promise module\n")+'Error message: "'.concat(e.message,'"\n')+"Try serving html over http if currently you are running it from the filesystem.";console.warn(t)},i=(e,t)=>new Promise(((r,i)=>{e.readEntries((async e=>{let n=[];for(let r of e){const e=await o(r,t);n=n.concat(e)}r(n)}),(e=>{n(e),i(e)}))})),o=async function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(e.isFile){const i=await function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new Promise(((i,o)=>{e.file((e=>{t.raw||(e.filepath=r+e.name),i(e)}),(e=>{n(e),o(e)}))}))}(e,r);return[i]}if(e.isDirectory){const t=await(async(e,t)=>{const n=e.createReader(),r=t+e.name+"/";let o,s=[];do{o=await i(n,r),s=s.concat(o)}while(o.length>0);return s})(e,r);return t}};let s=[],a=[];for(let r=0,c=e.length;r<c;r++)a.push(e[r].webkitGetAsEntry());for(let r of a){const e=await o(r);s=s.concat(e)}return s}e=n.nmd(e),globalThis.window&&globalThis===globalThis.window&&(globalThis.getFilesFromDataTransferItems=r),e&&e.exports&&(e.exports.getFilesFromDataTransferItems=r)},18392:(e,t,n)=>{var r=n(1426);t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(r++,"%c"===e&&(i=r))})),t.splice(i,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(n){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(n){}!e&&"undefined"!==typeof r&&"env"in r&&(e={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_GIT_REV:"9c10520",REACT_APP_VERSION:"4.2.1"}.DEBUG);return e},t.useColors=function(){if("undefined"!==typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=n(18472)(t);const{formatters:i}=e.exports;i.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}},18472:(e,t,n)=>{e.exports=function(e){function t(e){let n,i,o,s=null;function a(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];if(!a.enabled)return;const o=a,s=Number(new Date),c=s-(n||s);o.diff=c,o.prev=n,o.curr=s,n=s,r[0]=t.coerce(r[0]),"string"!==typeof r[0]&&r.unshift("%O");let l=0;r[0]=r[0].replace(/%([a-zA-Z%])/g,((e,n)=>{if("%%"===e)return"%";l++;const i=t.formatters[n];if("function"===typeof i){const t=r[l];e=i.call(o,t),r.splice(l,1),l--}return e})),t.formatArgs.call(o,r);(o.log||t.log).apply(o,r)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=r,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(i!==t.namespaces&&(i=t.namespaces,o=t.enabled(e)),o),set:e=>{s=e}}),"function"===typeof t.init&&t.init(a),a}function r(e,n){const r=t(this.namespace+("undefined"===typeof n?":":n)+e);return r.log=this.log,r}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(i),...t.skips.map(i).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const r=("string"===typeof e?e:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(78193),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((n=>{t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}},49948:e=>{"use strict";var t=function(e){return function(e){return!!e&&"object"===typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===n}(e)}(e)};var n="function"===typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function r(e,t){return!1!==t.clone&&t.isMergeableObject(e)?c((n=e,Array.isArray(n)?[]:{}),e,t):e;var n}function i(e,t,n){return e.concat(t).map((function(e){return r(e,n)}))}function o(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return Object.propertyIsEnumerable.call(e,t)})):[]}(e))}function s(e,t){try{return t in e}catch(n){return!1}}function a(e,t,n){var i={};return n.isMergeableObject(e)&&o(e).forEach((function(t){i[t]=r(e[t],n)})),o(t).forEach((function(o){(function(e,t){return s(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,o)||(s(e,o)&&n.isMergeableObject(t[o])?i[o]=function(e,t){if(!t.customMerge)return c;var n=t.customMerge(e);return"function"===typeof n?n:c}(o,n)(e[o],t[o],n):i[o]=r(t[o],n))})),i}function c(e,n,o){(o=o||{}).arrayMerge=o.arrayMerge||i,o.isMergeableObject=o.isMergeableObject||t,o.cloneUnlessOtherwiseSpecified=r;var s=Array.isArray(n);return s===Array.isArray(e)?s?o.arrayMerge(e,n,o):a(e,n,o):r(n,o)}c.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,n){return c(e,n,t)}),{})};var l=c;e.exports=l},61713:function(e,t,n){var r,i;void 0===(i="function"===typeof(r=function(){var e="details",t="summary";function n(e){if("summary"===e.target.nodeName.toLowerCase()){var t=e.target.parentNode;if(!t)return;t.getAttribute("open")?(t.open=!1,t.removeAttribute("open")):(t.open=!0,t.setAttribute("open","open"))}}function r(){var n=document.createElement(e);if(!("open"in n))return!1;n.innerHTML="<"+t+">a</"+t+">b",document.body.appendChild(n);var r=n.offsetHeight;n.open=!0;var i=r!=n.offsetHeight;return document.body.removeChild(n),i}function i(e,t){if(!document.getElementById(e)){var n=document.createElement("style");n.id=e,n.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(n)}}r()||(document.documentElement.className+=" no-details",window.addEventListener("click",n),i("details-polyfill-style","html.no-details "+e+" { display: block; }\nhtml.no-details "+e+":not([open]) > :not("+t+") { display: none; }\nhtml.no-details "+e+" > "+t+':before { content: "\u25b6"; display: inline-block; font-size: .8em; width: 1.5em; }\nhtml.no-details '+e+"[open] > "+t+':before { content: "\u25bc"; }'))})?r.call(t,n,t,e):r)||(e.exports=i)},97357:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r=!("undefined"===typeof window||!window.document||!window.document.createElement)},58063:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r,i=n(97357);function o(e){if((!r&&0!==r||e)&&i.Z){var t=document.createElement("div");t.style.position="absolute",t.style.top="-9999px",t.style.width="50px",t.style.height="50px",t.style.overflow="scroll",document.body.appendChild(t),r=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return r}},7142:(e,t,n)=>{var r=n(17870);e.exports=function(e,t){return r(e,t,".")}},67963:e=>{"use strict";function t(e,t){for(const n in t)Object.defineProperty(e,n,{value:t[n],enumerable:!0,configurable:!0});return e}e.exports=function(e,n,r){if(!e||"string"===typeof e)throw new TypeError("Please pass an Error to err-code");r||(r={}),"object"===typeof n&&(r=n,n=""),n&&(r.code=n);try{return t(e,r)}catch(i){r.message=e.message,r.stack=e.stack;const n=function(){};n.prototype=Object.create(Object.getPrototypeOf(e));return t(new n,r)}}},3634:(e,t,n)=>{"use strict";const r=n(45413);t.zN=r.EventIterator,r.EventIterator},45413:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(){this.pullQueue=[],this.pushQueue=[],this.eventHandlers={},this.isPaused=!1,this.isStopped=!1}push(e){if(this.isStopped)return;const t={value:e,done:!1};if(this.pullQueue.length){const e=this.pullQueue.shift();e&&e.resolve(t)}else this.pushQueue.push(Promise.resolve(t)),void 0!==this.highWaterMark&&this.pushQueue.length>=this.highWaterMark&&!this.isPaused&&(this.isPaused=!0,this.eventHandlers.highWater?this.eventHandlers.highWater():console&&console.warn("EventIterator queue reached ".concat(this.pushQueue.length," items")))}stop(){if(!this.isStopped){this.isStopped=!0,this.remove();for(const e of this.pullQueue)e.resolve({value:void 0,done:!0});this.pullQueue.length=0}}fail(e){if(!this.isStopped)if(this.isStopped=!0,this.remove(),this.pullQueue.length){for(const t of this.pullQueue)t.reject(e);this.pullQueue.length=0}else{const t=Promise.reject(e);t.catch((()=>{})),this.pushQueue.push(t)}}remove(){Promise.resolve().then((()=>{this.removeCallback&&this.removeCallback()}))}[Symbol.asyncIterator](){return{next:e=>{const t=this.pushQueue.shift();return t?(void 0!==this.lowWaterMark&&this.pushQueue.length<=this.lowWaterMark&&this.isPaused&&(this.isPaused=!1,this.eventHandlers.lowWater&&this.eventHandlers.lowWater()),t):this.isStopped?Promise.resolve({value:void 0,done:!0}):new Promise(((e,t)=>{this.pullQueue.push({resolve:e,reject:t})}))},return:()=>(this.isStopped=!0,this.pushQueue.length=0,this.remove(),Promise.resolve({value:void 0,done:!0}))}}}class r{constructor(e){let{highWaterMark:t=100,lowWaterMark:r=1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=new n;i.highWaterMark=t,i.lowWaterMark=r,i.removeCallback=e({push:e=>i.push(e),stop:()=>i.stop(),fail:e=>i.fail(e),on:(e,t)=>{i.eventHandlers[e]=t}})||(()=>{}),this[Symbol.asyncIterator]=()=>i[Symbol.asyncIterator](),Object.freeze(this)}}t.EventIterator=r,t.default=r},97143:e=>{"use strict";var t=Object.prototype.hasOwnProperty,n="~";function r(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function o(e,t,r,o,s){if("function"!==typeof r)throw new TypeError("The listener must be a function");var a=new i(r,o||e,s),c=n?n+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function s(e,t){0===--e._eventsCount?e._events=new r:delete e._events[t]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),a.prototype.eventNames=function(){var e,r,i=[];if(0===this._eventsCount)return i;for(r in e=this._events)t.call(e,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},a.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,o=r.length,s=new Array(o);i<o;i++)s[i]=r[i].fn;return s},a.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},a.prototype.emit=function(e,t,r,i,o,s){var a=n?n+e:e;if(!this._events[a])return!1;var c,l,u=this._events[a],h=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),h){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,r),!0;case 4:return u.fn.call(u.context,t,r,i),!0;case 5:return u.fn.call(u.context,t,r,i,o),!0;case 6:return u.fn.call(u.context,t,r,i,o,s),!0}for(l=1,c=new Array(h-1);l<h;l++)c[l-1]=arguments[l];u.fn.apply(u.context,c)}else{var d,f=u.length;for(l=0;l<f;l++)switch(u[l].once&&this.removeListener(e,u[l].fn,void 0,!0),h){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,t);break;case 3:u[l].fn.call(u[l].context,t,r);break;case 4:u[l].fn.call(u[l].context,t,r,i);break;default:if(!c)for(d=1,c=new Array(h-1);d<h;d++)c[d-1]=arguments[d];u[l].fn.apply(u[l].context,c)}}return!0},a.prototype.on=function(e,t,n){return o(this,e,t,n,!1)},a.prototype.once=function(e,t,n){return o(this,e,t,n,!0)},a.prototype.removeListener=function(e,t,r,i){var o=n?n+e:e;if(!this._events[o])return this;if(!t)return s(this,o),this;var a=this._events[o];if(a.fn)a.fn!==t||i&&!a.once||r&&a.context!==r||s(this,o);else{for(var c=0,l=[],u=a.length;c<u;c++)(a[c].fn!==t||i&&!a[c].once||r&&a[c].context!==r)&&l.push(a[c]);l.length?this._events[o]=1===l.length?l[0]:l:s(this,o)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&s(this,t)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a},47465:e=>{"use strict";var t,n="object"===typeof Reflect?Reflect:null,r=n&&"function"===typeof n.apply?n.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};t=n&&"function"===typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!==e};function o(){o.init.call(this)}e.exports=o,e.exports.once=function(e,t){return new Promise((function(n,r){function i(n){e.removeListener(t,o),r(n)}function o(){"function"===typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}g(e,t,o,{once:!0}),"error"!==t&&function(e,t,n){"function"===typeof e.on&&g(e,"error",t,n)}(e,i,{once:!0})}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var s=10;function a(e){if("function"!==typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function l(e,t,n,r){var i,o,s,l;if(a(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),s=o[t]),void 0===s)s=o[t]=n,++e._eventsCount;else if("function"===typeof s?s=o[t]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),(i=c(e))>0&&s.length>i&&!s.warned){s.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=s.length,l=u,console&&console.warn&&console.warn(l)}return e}function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=u.bind(r);return i.listener=n,r.wrapFn=i,i}function d(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"===typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):p(i,i.length)}function f(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"===typeof n)return 1;if(void 0!==n)return n.length}return 0}function p(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function g(e,t,n,r){if("function"===typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!==typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){r.once&&e.removeEventListener(t,i),n(o)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!==typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!==typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return c(this)},o.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=o[e];if(void 0===c)return!1;if("function"===typeof c)r(c,this,t);else{var l=c.length,u=p(c,l);for(n=0;n<l;++n)r(u[n],this,t)}return!0},o.prototype.addListener=function(e,t){return l(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return l(this,e,t,!0)},o.prototype.once=function(e,t){return a(t),this.on(e,h(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,h(this,e,t)),this},o.prototype.removeListener=function(e,t){var n,r,i,o,s;if(a(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!==typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){s=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,s||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"===typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},o.prototype.listeners=function(e){return d(this,e,!0)},o.prototype.rawListeners=function(e){return d(this,e,!1)},o.listenerCount=function(e,t){return"function"===typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},o.prototype.listenerCount=f,o.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},72618:(e,t,n)=>{var r;!function(){"use strict";var i=!("undefined"===typeof window||!window.document||!window.document.createElement),o={canUseDOM:i,canUseWorkers:"undefined"!==typeof Worker,canUseEventListeners:i&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:i&&!!window.screen};void 0===(r=function(){return o}.call(t,n,t,e))||(e.exports=r)}()},27530:function(e){e.exports=function(){"use strict";var e=/^(b|B)$/,t={iec:{bits:["b","Kib","Mib","Gib","Tib","Pib","Eib","Zib","Yib"],bytes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},jedec:{bits:["b","Kb","Mb","Gb","Tb","Pb","Eb","Zb","Yb"],bytes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]}},n={iec:["","kibi","mebi","gibi","tebi","pebi","exbi","zebi","yobi"],jedec:["","kilo","mega","giga","tera","peta","exa","zetta","yotta"]},r={floor:Math.floor,ceil:Math.ceil};function i(i){var o,s,a,c,l,u,h,d,f,p,g,y,m,v,b,w,E,A,S,_,I,C=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},T=[],k=0;if(isNaN(i))throw new TypeError("Invalid number");if(a=!0===C.bits,b=!0===C.unix,y=!0===C.pad,s=C.base||2,m=void 0!==C.round?C.round:b?1:2,h=void 0!==C.locale?C.locale:"",d=C.localeOptions||{},w=void 0!==C.separator?C.separator:"",E=void 0!==C.spacer?C.spacer:b?"":" ",S=C.symbols||{},A=2===s&&C.standard||"jedec",g=C.output||"string",l=!0===C.fullform,u=C.fullforms instanceof Array?C.fullforms:[],o=void 0!==C.exponent?C.exponent:-1,_=r[C.roundingMethod]||Math.round,f=(p=Number(i))<0,c=s>2?1e3:1024,I=!1===isNaN(C.precision)?parseInt(C.precision,10):0,f&&(p=-p),(-1===o||isNaN(o))&&(o=Math.floor(Math.log(p)/Math.log(c)))<0&&(o=0),o>8&&(I>0&&(I+=8-o),o=8),"exponent"===g)return o;if(0===p)T[0]=0,v=T[1]=b?"":t[A][a?"bits":"bytes"][o];else{k=p/(2===s?Math.pow(2,10*o):Math.pow(1e3,o)),a&&(k*=8)>=c&&o<8&&(k/=c,o++);var R=Math.pow(10,o>0?m:0);T[0]=_(k*R)/R,T[0]===c&&o<8&&void 0===C.exponent&&(T[0]=1,o++),v=T[1]=10===s&&1===o?a?"kb":"kB":t[A][a?"bits":"bytes"][o],b&&(T[1]="jedec"===A?T[1].charAt(0):o>0?T[1].replace(/B$/,""):T[1],e.test(T[1])&&(T[0]=Math.floor(T[0]),T[1]=""))}if(f&&(T[0]=-T[0]),I>0&&(T[0]=T[0].toPrecision(I)),T[1]=S[T[1]]||T[1],!0===h?T[0]=T[0].toLocaleString():h.length>0?T[0]=T[0].toLocaleString(h,d):w.length>0&&(T[0]=T[0].toString().replace(".",w)),y&&!1===Number.isInteger(T[0])&&m>0){var x=w||".",P=T[0].toString().split(x),D=P[1]||"",O=D.length,N=m-O;T[0]="".concat(P[0]).concat(x).concat(D.padEnd(O+N,"0"))}return l&&(T[1]=u[o]?u[o]:n[A][o]+(a?"bit":"byte")+(1===T[0]?"":"s")),"array"===g?T:"object"===g?{value:T[0],symbol:T[1],exponent:o,unit:v}:T.join(E)}return i.partial=function(e){return function(t){return i(t,e)}},i}()},34737:e=>{e.exports=function(e){if(!e)throw Error("hashlru must have a max value, of type number, greater than 0");var t=0,n=Object.create(null),r=Object.create(null);function i(i,o){n[i]=o,++t>=e&&(t=0,r=n,n=Object.create(null))}return{has:function(e){return void 0!==n[e]||void 0!==r[e]},remove:function(e){void 0!==n[e]&&(n[e]=void 0),void 0!==r[e]&&(r[e]=void 0)},get:function(e){var t=n[e];return void 0!==t?t:void 0!==(t=r[e])?(i(e,t),t):void 0},set:function(e,t){void 0!==n[e]?n[e]=t:i(e,t)},clear:function(){n=Object.create(null),r=Object.create(null)}}}},39895:(e,t,n)=>{var r=n(17870),i=n(98059);e.exports=function(e,t){return r(e,t,"-").replace(/^.|-./g,(function(e){return i(e,t)}))}},68363:(e,t,n)=>{"use strict";const{AbortController:r}=globalThis,i=n(31779);class o extends r{constructor(e){super(),this._ms=e,this._timer=i((()=>this.abort()),e),Object.setPrototypeOf(this,o.prototype)}abort(){return this._timer.clear(),super.abort()}clear(){this._timer.clear()}reset(){this._timer.clear(),this._timer=i((()=>this.abort()),this._ms)}}e.exports={TimeoutController:o}},62110:(e,t,n)=>{"use strict";var r=n(57441),i={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},o={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},s={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},a={};function c(e){return r.isMemo(e)?s:a[e.$$typeof]||i}a[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},a[r.Memo]=s;var l=Object.defineProperty,u=Object.getOwnPropertyNames,h=Object.getOwnPropertySymbols,d=Object.getOwnPropertyDescriptor,f=Object.getPrototypeOf,p=Object.prototype;e.exports=function e(t,n,r){if("string"!==typeof n){if(p){var i=f(n);i&&i!==p&&e(t,i,r)}var s=u(n);h&&(s=s.concat(h(n)));for(var a=c(t),g=c(n),y=0;y<s.length;++y){var m=s[y];if(!o[m]&&(!r||!r[m])&&(!g||!g[m])&&(!a||!a[m])){var v=d(n,m);try{l(t,m,v)}catch(b){}}}}return t}},84038:(e,t)=>{t.read=function(e,t,n,r,i){var o,s,a=8*i-r-1,c=(1<<a)-1,l=c>>1,u=-7,h=n?i-1:0,d=n?-1:1,f=e[t+h];for(h+=d,o=f&(1<<-u)-1,f>>=-u,u+=a;u>0;o=256*o+e[t+h],h+=d,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=r;u>0;s=256*s+e[t+h],h+=d,u-=8);if(0===o)o=1-l;else{if(o===c)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,r),o-=l}return(f?-1:1)*s*Math.pow(2,o-r)},t.write=function(e,t,n,r,i,o){var s,a,c,l=8*o-i-1,u=(1<<l)-1,h=u>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,p=r?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+h>=1?d/c:d*Math.pow(2,1-h))*c>=2&&(s++,c/=2),s+h>=u?(a=0,s=u):s+h>=1?(a=(t*c-1)*Math.pow(2,i),s+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;e[n+f]=255&a,f+=p,a/=256,i-=8);for(s=s<<i|a,l+=i;l>0;e[n+f]=255&s,f+=p,s/=256,l-=8);e[n+f-p]|=128*g}},59496:(e,t,n)=>{var r=t,{Buffer:i}=n(19778),o=n(11842);r.toBuffer=function(e,t,n){var r;if(n=~~n,this.isV4Format(e))r=t||new i(n+4),e.split(/\./g).map((e=>{r[n++]=255&parseInt(e,10)}));else if(this.isV6Format(e)){var o,s=e.split(":",8);for(o=0;o<s.length;o++){var a;this.isV4Format(s[o])&&(a=this.toBuffer(s[o]),s[o]=a.slice(0,2).toString("hex")),a&&++o<8&&s.splice(o,0,a.slice(2,4).toString("hex"))}if(""===s[0])for(;s.length<8;)s.unshift("0");else if(""===s[s.length-1])for(;s.length<8;)s.push("0");else if(s.length<8){for(o=0;o<s.length&&""!==s[o];o++);var c=[o,1];for(o=9-s.length;o>0;o--)c.push("0");s.splice.apply(s,c)}for(r=t||new i(n+16),o=0;o<s.length;o++){var l=parseInt(s[o],16);r[n++]=l>>8&255,r[n++]=255&l}}if(!r)throw Error("Invalid ip address: ".concat(e));return r},r.toString=function(e,t,n){t=~~t;var r,i=[];if(4===(n=n||e.length-t)){for(r=0;r<n;r++)i.push(e[t+r]);i=i.join(".")}else if(16===n){for(r=0;r<n;r+=2)i.push(e.readUInt16BE(t+r).toString(16));i=(i=(i=i.join(":")).replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3")).replace(/:{3,4}/,"::")}return i};var s=/^(\d{1,3}\.){3,3}\d{1,3}$/,a=/^(::)?(((\d{1,3}\.){3}(\d{1,3}){1})?([0-9a-f]){0,4}:{0,2}){1,8}(::)?$/i;function c(e){return 4===e?"ipv4":6===e?"ipv6":e?e.toLowerCase():"ipv4"}r.isV4Format=function(e){return s.test(e)},r.isV6Format=function(e){return a.test(e)},r.fromPrefixLen=function(e,t){var n=4;"ipv6"===(t=e>32?"ipv6":c(t))&&(n=16);for(var o=new i(n),s=0,a=o.length;s<a;++s){var l=8;e<8&&(l=e),e-=l,o[s]=255&~(255>>l)}return r.toString(o)},r.mask=function(e,t){e=r.toBuffer(e),t=r.toBuffer(t);var n,o=new i(Math.max(e.length,t.length));if(e.length===t.length)for(n=0;n<e.length;n++)o[n]=e[n]&t[n];else if(4===t.length)for(n=0;n<t.length;n++)o[n]=e[e.length-4+n]&t[n];else{for(n=0;n<o.length-6;n++)o[n]=0;for(o[10]=255,o[11]=255,n=0;n<e.length;n++)o[n+12]=e[n]&t[n+12];n+=12}for(;n<o.length;n++)o[n]=0;return r.toString(o)},r.cidr=function(e){var t=e.split("/"),n=t[0];if(2!==t.length)throw new Error("invalid CIDR subnet: ".concat(n));var i=r.fromPrefixLen(parseInt(t[1],10));return r.mask(n,i)},r.subnet=function(e,t){for(var n=r.toLong(r.mask(e,t)),i=r.toBuffer(t),o=0,s=0;s<i.length;s++)if(255===i[s])o+=8;else for(var a=255&i[s];a;)a=a<<1&255,o++;var c=Math.pow(2,32-o);return{networkAddress:r.fromLong(n),firstAddress:c<=2?r.fromLong(n):r.fromLong(n+1),lastAddress:c<=2?r.fromLong(n+c-1):r.fromLong(n+c-2),broadcastAddress:r.fromLong(n+c-1),subnetMask:t,subnetMaskLength:o,numHosts:c<=2?c:c-2,length:c,contains:e=>n===r.toLong(r.mask(e,t))}},r.cidrSubnet=function(e){var t=e.split("/"),n=t[0];if(2!==t.length)throw new Error("invalid CIDR subnet: ".concat(n));var i=r.fromPrefixLen(parseInt(t[1],10));return r.subnet(n,i)},r.not=function(e){for(var t=r.toBuffer(e),n=0;n<t.length;n++)t[n]=255^t[n];return r.toString(t)},r.or=function(e,t){var n;if(e=r.toBuffer(e),t=r.toBuffer(t),e.length===t.length){for(n=0;n<e.length;++n)e[n]|=t[n];return r.toString(e)}var i=e,o=t;t.length>e.length&&(i=t,o=e);var s=i.length-o.length;for(n=s;n<i.length;++n)i[n]|=o[n-s];return r.toString(i)},r.isEqual=function(e,t){var n;if(e=r.toBuffer(e),t=r.toBuffer(t),e.length===t.length){for(n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}if(4===t.length){var i=t;t=e,e=i}for(n=0;n<10;n++)if(0!==t[n])return!1;var o=t.readUInt16BE(10);if(0!==o&&65535!==o)return!1;for(n=0;n<4;n++)if(e[n]!==t[n+12])return!1;return!0},r.isPrivate=function(e){if(r.isLoopback(e))return!0;if(!r.isV6Format(e)){const t=r.normalizeToLong(e);if(t<0)throw new Error("invalid ipv4 address");e=r.fromLong(t)}return/^(::f{4}:)?10\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^(::f{4}:)?192\.168\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^(::f{4}:)?172\.(1[6-9]|2\d|30|31)\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^(::f{4}:)?169\.254\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^f[cd][0-9a-f]{2}:/i.test(e)||/^fe80:/i.test(e)||/^::1$/.test(e)||/^::$/.test(e)},r.isPublic=function(e){return!r.isPrivate(e)},r.isLoopback=function(e){return/\./.test(e)||/:/.test(e)||(e=r.fromLong(Number(e))),/^(::f{4}:)?127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})/.test(e)||/^0177\./.test(e)||/^0x7f\./i.test(e)||/^fe80::1$/i.test(e)||/^::1$/.test(e)||/^::$/.test(e)},r.loopback=function(e){if("ipv4"!==(e=c(e))&&"ipv6"!==e)throw new Error("family must be ipv4 or ipv6");return"ipv4"===e?"127.0.0.1":"fe80::1"},r.address=function(e,t){var n=o.networkInterfaces();if(t=c(t),e&&"private"!==e&&"public"!==e){var i=n[e].filter((e=>c(e.family)===t));if(0===i.length)return;return i[0].address}var s=Object.keys(n).map((i=>{var o=n[i].filter((n=>(n.family=c(n.family),n.family===t&&!r.isLoopback(n.address)&&(!e||("public"===e?r.isPrivate(n.address):r.isPublic(n.address))))));return o.length?o[0].address:void 0})).filter(Boolean);return s.length?s[0]:r.loopback(t)},r.toLong=function(e){var t=0;return e.split(".").forEach((e=>{t<<=8,t+=parseInt(e)})),t>>>0},r.fromLong=function(e){return"".concat(e>>>24,".").concat(e>>16&255,".").concat(e>>8&255,".").concat(255&e)},r.normalizeToLong=function(e){const t=e.split(".").map((e=>e.startsWith("0x")||e.startsWith("0X")?parseInt(e,16):e.startsWith("0")&&"0"!==e&&/^[0-7]+$/.test(e)?parseInt(e,8):/^[1-9]\d*$/.test(e)||"0"===e?parseInt(e,10):NaN));if(t.some(isNaN))return-1;let n=0;switch(t.length){case 1:n=t[0];break;case 2:if(t[0]>255||t[1]>16777215)return-1;n=t[0]<<24|16777215&t[1];break;case 3:if(t[0]>255||t[1]>255||t[2]>65535)return-1;n=t[0]<<24|t[1]<<16|65535&t[2];break;case 4:if(t.some((e=>e>255)))return-1;n=t[0]<<24|t[1]<<16|t[2]<<8|t[3];break;default:return-1}return n>>>0}},87201:function(e){!function(t){"use strict";const n="(0?\\d+|0x[a-f0-9]+)",r={fourOctet:new RegExp("^".concat(n,"\\.").concat(n,"\\.").concat(n,"\\.").concat(n,"$"),"i"),threeOctet:new RegExp("^".concat(n,"\\.").concat(n,"\\.").concat(n,"$"),"i"),twoOctet:new RegExp("^".concat(n,"\\.").concat(n,"$"),"i"),longValue:new RegExp("^".concat(n,"$"),"i")},i=new RegExp("^0[0-7]+$","i"),o=new RegExp("^0x[a-f0-9]+$","i"),s="%[0-9a-z]{1,}",a="(?:[0-9a-f]+::?)+",c={zoneIndex:new RegExp(s,"i"),native:new RegExp("^(::)?(".concat(a,")?([0-9a-f]+)?(::)?(").concat(s,")?$"),"i"),deprecatedTransitional:new RegExp("^(?:::)(".concat(n,"\\.").concat(n,"\\.").concat(n,"\\.").concat(n,"(").concat(s,")?)$"),"i"),transitional:new RegExp("^((?:".concat(a,")|(?:::)(?:").concat(a,")?)").concat(n,"\\.").concat(n,"\\.").concat(n,"\\.").concat(n,"(").concat(s,")?$"),"i")};function l(e,t){if(e.indexOf("::")!==e.lastIndexOf("::"))return null;let n,r,i=0,o=-1,s=(e.match(c.zoneIndex)||[])[0];for(s&&(s=s.substring(1),e=e.replace(/%.+$/,""));(o=e.indexOf(":",o+1))>=0;)i++;if("::"===e.substr(0,2)&&i--,"::"===e.substr(-2,2)&&i--,i>t)return null;for(r=t-i,n=":";r--;)n+="0:";return":"===(e=e.replace("::",n))[0]&&(e=e.slice(1)),":"===e[e.length-1]&&(e=e.slice(0,-1)),{parts:t=function(){const t=e.split(":"),n=[];for(let e=0;e<t.length;e++)n.push(parseInt(t[e],16));return n}(),zoneId:s}}function u(e,t,n,r){if(e.length!==t.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");let i,o=0;for(;r>0;){if(i=n-r,i<0&&(i=0),e[o]>>i!==t[o]>>i)return!1;r-=n,o+=1}return!0}function h(e){if(o.test(e))return parseInt(e,16);if("0"===e[0]&&!isNaN(parseInt(e[1],10))){if(i.test(e))return parseInt(e,8);throw new Error("ipaddr: cannot parse ".concat(e," as octal"))}return parseInt(e,10)}function d(e,t){for(;e.length<t;)e="0".concat(e);return e}const f={};f.IPv4=function(){function e(e){if(4!==e.length)throw new Error("ipaddr: ipv4 octet count should be 4");let t,n;for(t=0;t<e.length;t++)if(n=e[t],!(0<=n&&n<=255))throw new Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=e}return e.prototype.SpecialRanges={unspecified:[[new e([0,0,0,0]),8]],broadcast:[[new e([255,255,255,255]),32]],multicast:[[new e([224,0,0,0]),4]],linkLocal:[[new e([169,254,0,0]),16]],loopback:[[new e([127,0,0,0]),8]],carrierGradeNat:[[new e([100,64,0,0]),10]],private:[[new e([10,0,0,0]),8],[new e([172,16,0,0]),12],[new e([192,168,0,0]),16]],reserved:[[new e([192,0,0,0]),24],[new e([192,0,2,0]),24],[new e([192,88,99,0]),24],[new e([198,18,0,0]),15],[new e([198,51,100,0]),24],[new e([203,0,113,0]),24],[new e([240,0,0,0]),4]]},e.prototype.kind=function(){return"ipv4"},e.prototype.match=function(e,t){let n;if(void 0===t&&(n=e,e=n[0],t=n[1]),"ipv4"!==e.kind())throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return u(this.octets,e.octets,8,t)},e.prototype.prefixLengthFromSubnetMask=function(){let e=0,t=!1;const n={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0};let r,i,o;for(r=3;r>=0;r-=1){if(i=this.octets[r],!(i in n))return null;if(o=n[i],t&&0!==o)return null;8!==o&&(t=!0),e+=o}return 32-e},e.prototype.range=function(){return f.subnetMatch(this,this.SpecialRanges)},e.prototype.toByteArray=function(){return this.octets.slice(0)},e.prototype.toIPv4MappedAddress=function(){return f.IPv6.parse("::ffff:".concat(this.toString()))},e.prototype.toNormalizedString=function(){return this.toString()},e.prototype.toString=function(){return this.octets.join(".")},e}(),f.IPv4.broadcastAddressFromCIDR=function(e){try{const t=this.parseCIDR(e),n=t[0].toByteArray(),r=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),i=[];let o=0;for(;o<4;)i.push(parseInt(n[o],10)|255^parseInt(r[o],10)),o++;return new this(i)}catch(t){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},f.IPv4.isIPv4=function(e){return null!==this.parser(e)},f.IPv4.isValid=function(e){try{return new this(this.parser(e)),!0}catch(t){return!1}},f.IPv4.isValidFourPartDecimal=function(e){return!(!f.IPv4.isValid(e)||!e.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},f.IPv4.networkAddressFromCIDR=function(e){let t,n,r,i,o;try{for(t=this.parseCIDR(e),r=t[0].toByteArray(),o=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),i=[],n=0;n<4;)i.push(parseInt(r[n],10)&parseInt(o[n],10)),n++;return new this(i)}catch(s){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},f.IPv4.parse=function(e){const t=this.parser(e);if(null===t)throw new Error("ipaddr: string is not formatted like an IPv4 Address");return new this(t)},f.IPv4.parseCIDR=function(e){let t;if(t=e.match(/^(.+)\/(\d+)$/)){const e=parseInt(t[2]);if(e>=0&&e<=32){const n=[this.parse(t[1]),e];return Object.defineProperty(n,"toString",{value:function(){return this.join("/")}}),n}}throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")},f.IPv4.parser=function(e){let t,n,i;if(t=e.match(r.fourOctet))return function(){const e=t.slice(1,6),r=[];for(let t=0;t<e.length;t++)n=e[t],r.push(h(n));return r}();if(t=e.match(r.longValue)){if(i=h(t[1]),i>4294967295||i<0)throw new Error("ipaddr: address outside defined range");return function(){const e=[];let t;for(t=0;t<=24;t+=8)e.push(i>>t&255);return e}().reverse()}return(t=e.match(r.twoOctet))?function(){const e=t.slice(1,4),n=[];if(i=h(e[1]),i>16777215||i<0)throw new Error("ipaddr: address outside defined range");return n.push(h(e[0])),n.push(i>>16&255),n.push(i>>8&255),n.push(255&i),n}():(t=e.match(r.threeOctet))?function(){const e=t.slice(1,5),n=[];if(i=h(e[2]),i>65535||i<0)throw new Error("ipaddr: address outside defined range");return n.push(h(e[0])),n.push(h(e[1])),n.push(i>>8&255),n.push(255&i),n}():null},f.IPv4.subnetMaskFromPrefixLength=function(e){if((e=parseInt(e))<0||e>32)throw new Error("ipaddr: invalid IPv4 prefix length");const t=[0,0,0,0];let n=0;const r=Math.floor(e/8);for(;n<r;)t[n]=255,n++;return r<4&&(t[r]=Math.pow(2,e%8)-1<<8-e%8),new this(t)},f.IPv6=function(){function e(e,t){let n,r;if(16===e.length)for(this.parts=[],n=0;n<=14;n+=2)this.parts.push(e[n]<<8|e[n+1]);else{if(8!==e.length)throw new Error("ipaddr: ipv6 part count should be 8 or 16");this.parts=e}for(n=0;n<this.parts.length;n++)if(r=this.parts[n],!(0<=r&&r<=65535))throw new Error("ipaddr: ipv6 part should fit in 16 bits");t&&(this.zoneId=t)}return e.prototype.SpecialRanges={unspecified:[new e([0,0,0,0,0,0,0,0]),128],linkLocal:[new e([65152,0,0,0,0,0,0,0]),10],multicast:[new e([65280,0,0,0,0,0,0,0]),8],loopback:[new e([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new e([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new e([0,0,0,0,0,65535,0,0]),96],rfc6145:[new e([0,0,0,0,65535,0,0,0]),96],rfc6052:[new e([100,65435,0,0,0,0,0,0]),96],"6to4":[new e([8194,0,0,0,0,0,0,0]),16],teredo:[new e([8193,0,0,0,0,0,0,0]),32],reserved:[[new e([8193,3512,0,0,0,0,0,0]),32]],benchmarking:[new e([8193,2,0,0,0,0,0,0]),48],amt:[new e([8193,3,0,0,0,0,0,0]),32],as112v6:[new e([8193,4,274,0,0,0,0,0]),48],deprecated:[new e([8193,16,0,0,0,0,0,0]),28],orchid2:[new e([8193,32,0,0,0,0,0,0]),28]},e.prototype.isIPv4MappedAddress=function(){return"ipv4Mapped"===this.range()},e.prototype.kind=function(){return"ipv6"},e.prototype.match=function(e,t){let n;if(void 0===t&&(n=e,e=n[0],t=n[1]),"ipv6"!==e.kind())throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return u(this.parts,e.parts,16,t)},e.prototype.prefixLengthFromSubnetMask=function(){let e=0,t=!1;const n={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0};let r,i;for(let o=7;o>=0;o-=1){if(r=this.parts[o],!(r in n))return null;if(i=n[r],t&&0!==i)return null;16!==i&&(t=!0),e+=i}return 128-e},e.prototype.range=function(){return f.subnetMatch(this,this.SpecialRanges)},e.prototype.toByteArray=function(){let e;const t=[],n=this.parts;for(let r=0;r<n.length;r++)e=n[r],t.push(e>>8),t.push(255&e);return t},e.prototype.toFixedLengthString=function(){const e=function(){const e=[];for(let t=0;t<this.parts.length;t++)e.push(d(this.parts[t].toString(16),4));return e}.call(this).join(":");let t="";return this.zoneId&&(t="%".concat(this.zoneId)),e+t},e.prototype.toIPv4Address=function(){if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");const e=this.parts.slice(-2),t=e[0],n=e[1];return new f.IPv4([t>>8,255&t,n>>8,255&n])},e.prototype.toNormalizedString=function(){const e=function(){const e=[];for(let t=0;t<this.parts.length;t++)e.push(this.parts[t].toString(16));return e}.call(this).join(":");let t="";return this.zoneId&&(t="%".concat(this.zoneId)),e+t},e.prototype.toRFC5952String=function(){const e=/((^|:)(0(:|$)){2,})/g,t=this.toNormalizedString();let n,r=0,i=-1;for(;n=e.exec(t);)n[0].length>i&&(r=n.index,i=n[0].length);return i<0?t:"".concat(t.substring(0,r),"::").concat(t.substring(r+i))},e.prototype.toString=function(){return this.toRFC5952String()},e}(),f.IPv6.broadcastAddressFromCIDR=function(e){try{const t=this.parseCIDR(e),n=t[0].toByteArray(),r=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),i=[];let o=0;for(;o<16;)i.push(parseInt(n[o],10)|255^parseInt(r[o],10)),o++;return new this(i)}catch(t){throw new Error("ipaddr: the address does not have IPv6 CIDR format (".concat(t,")"))}},f.IPv6.isIPv6=function(e){return null!==this.parser(e)},f.IPv6.isValid=function(e){if("string"===typeof e&&-1===e.indexOf(":"))return!1;try{const t=this.parser(e);return new this(t.parts,t.zoneId),!0}catch(t){return!1}},f.IPv6.networkAddressFromCIDR=function(e){let t,n,r,i,o;try{for(t=this.parseCIDR(e),r=t[0].toByteArray(),o=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),i=[],n=0;n<16;)i.push(parseInt(r[n],10)&parseInt(o[n],10)),n++;return new this(i)}catch(s){throw new Error("ipaddr: the address does not have IPv6 CIDR format (".concat(s,")"))}},f.IPv6.parse=function(e){const t=this.parser(e);if(null===t.parts)throw new Error("ipaddr: string is not formatted like an IPv6 Address");return new this(t.parts,t.zoneId)},f.IPv6.parseCIDR=function(e){let t,n,r;if((n=e.match(/^(.+)\/(\d+)$/))&&(t=parseInt(n[2]),t>=0&&t<=128))return r=[this.parse(n[1]),t],Object.defineProperty(r,"toString",{value:function(){return this.join("/")}}),r;throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")},f.IPv6.parser=function(e){let t,n,r,i,o,s;if(r=e.match(c.deprecatedTransitional))return this.parser("::ffff:".concat(r[1]));if(c.native.test(e))return l(e,8);if((r=e.match(c.transitional))&&(s=r[6]||"",t=l(r[1].slice(0,-1)+s,6),t.parts)){for(o=[parseInt(r[2]),parseInt(r[3]),parseInt(r[4]),parseInt(r[5])],n=0;n<o.length;n++)if(i=o[n],!(0<=i&&i<=255))return null;return t.parts.push(o[0]<<8|o[1]),t.parts.push(o[2]<<8|o[3]),{parts:t.parts,zoneId:t.zoneId}}return null},f.IPv6.subnetMaskFromPrefixLength=function(e){if((e=parseInt(e))<0||e>128)throw new Error("ipaddr: invalid IPv6 prefix length");const t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];let n=0;const r=Math.floor(e/8);for(;n<r;)t[n]=255,n++;return r<16&&(t[r]=Math.pow(2,e%8)-1<<8-e%8),new this(t)},f.fromByteArray=function(e){const t=e.length;if(4===t)return new f.IPv4(e);if(16===t)return new f.IPv6(e);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},f.isValid=function(e){return f.IPv6.isValid(e)||f.IPv4.isValid(e)},f.parse=function(e){if(f.IPv6.isValid(e))return f.IPv6.parse(e);if(f.IPv4.isValid(e))return f.IPv4.parse(e);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")},f.parseCIDR=function(e){try{return f.IPv6.parseCIDR(e)}catch(t){try{return f.IPv4.parseCIDR(e)}catch(n){throw new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},f.process=function(e){const t=this.parse(e);return"ipv6"===t.kind()&&t.isIPv4MappedAddress()?t.toIPv4Address():t},f.subnetMatch=function(e,t,n){let r,i,o,s;for(i in void 0!==n&&null!==n||(n="unicast"),t)if(Object.prototype.hasOwnProperty.call(t,i))for(o=t[i],!o[0]||o[0]instanceof Array||(o=[o]),r=0;r<o.length;r++)if(s=o[r],e.kind()===s[0].kind()&&e.match.apply(e,s))return i;return n},e.exports?e.exports=f:t.ipaddr=f}(this)},78603:e=>{"use strict";e.exports={DEFAULT_HTTP_API:"/ip4/127.0.0.1/tcp/5001"}},53062:e=>{"use strict";e.exports={httpClient:"httpClient",windowIpfs:"windowIpfs",jsIpfs:"jsIpfs",webExt:"webExt"}},8297:function(e,t,n){"use strict";e.exports="object"===typeof self&&self.self===self&&self||"object"===typeof n.g&&n.g.global===n.g&&n.g||this},33006:(e,t,n)=>{"use strict";const r=n(8297),i=n(89842),o=n(38099),s=n(13671),a=n(70155),c=n(16605),l={connectionTest:async e=>{const t="QmUNLLsPACCz1vLxQVkXqqLX5R1X345qqfHbsf67hvA3Nn";for await(const n of e.get(t))if("dir"===n.type&&n.name===t)return!0;return!1}},u=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r=>(n=i(l,t,r,n),e(n))}},h={httpClient:u((e=>a({root:r,...e}))),windowIpfs:u((e=>s({root:r,...e}))),jsIpfs:u((e=>c(e))),webExt:u((e=>o({root:r,...e})))},d=[h.windowIpfs(),h.httpClient()];e.exports={getIpfs:async function(){let{providers:e=d,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(const r of e)try{const e=await r(t);if(e)return e}catch(n){console.error("[ipfs-provider]",n)}},providers:h,makeProvider:u}},70155:(e,t,n)=>{"use strict";const{URL:r}=n(16791),i=n(53062),{DEFAULT_HTTP_API:o}=n(78603);async function s(e){let{apiAddress:t,connectionTest:n,httpClient:r,...o}=e;try{let e;try{e=r.create({...o,...a(t)})}catch(s){e=r({...o,...a(t)})}return await n(e),{ipfs:e,provider:i.httpClient,apiAddress:t}}catch(c){return null}}const a=e=>{switch(typeof e){case"string":return{url:e};case"object":return JSON.parse(JSON.stringify(e));case"undefined":return{};default:throw new Error("invalid apiAddress passed to httpClient")}};e.exports=async function(e){let t,{loadHttpClientModule:n,apiAddress:i,root:a,connectionTest:c,...l}=e;if(n&&(t=await n()),!t){if(!a.IpfsHttpClient)throw new Error("ipfs-provider could not initialize js-ipfs-http-client: make sure its constructor is returned by loadHttpClientModule function or exposed at window.IpfsHttpClient");t=a.IpfsHttpClient}if(t=t.default||t,i||l.url||l.host)return s({apiAddress:i,connectionTest:c,httpClient:t,...l});const{location:u}=a;if(u&&("5001"!==u.port||!u.hostname.match(/^127.0.0.1$|^localhost$/))){const e=new r(u.origin);e.pathname="/";const n=await s({apiAddress:e.toString(),connectionTest:c,httpClient:t,...l});if(n)return n}return s({apiAddress:o,connectionTest:c,httpClient:t,...l})}},16605:(e,t,n)=>{"use strict";const r=n(53062);async function i(e,t){return(e=e.default||e).create(t)}e.exports=async function(e){let{connectionTest:t,loadJsIpfsModule:n,options:o,init:s=i}=e;const a=await n(),c=await s(a,o);return await t(c),{ipfs:c,provider:r.jsIpfs}}},38099:(e,t,n)=>{"use strict";const r=n(53062);e.exports=async function(e){let{root:t,connectionTest:n}=e;if("object"===typeof t.chrome&&t.chrome.extension&&t.chrome.extension.getBackgroundPage){let e=null;try{e=t.chrome.extension.getBackgroundPage()}catch(i){return null}if(e&&e.ipfs){const{ipfs:t}=e;return await n(t),{ipfs:t,provider:r.webExt}}}}},13671:(e,t,n)=>{"use strict";const r=n(53062);e.exports=async function(e){let{root:t,permissions:n,connectionTest:i}=e;if(t.ipfs){n&&n.commands&&n.commands.includes("files.get")||(n=n||{},n=JSON.parse(JSON.stringify(n)),n.commands=n.commands||[],n.commands.push("files.get"));const e="function"===typeof t.ipfs.enable?await t.ipfs.enable(n):t.ipfs;return await i(e),{ipfs:e,provider:r.windowIpfs}}}},59714:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(72791),i=n(18335);const o=e=>{let{className:t="pa4",style:n,children:o,...s}=e;return r.createElement("div",{className:t,style:{background:"#fbfbfb",...n}},r.createElement(i.Z,null,o))}},24461:(e,t,n)=>{"use strict";n.d(t,{Z:()=>f});var r=n(72791),i=n(87945),o=n(48236),s=n(19264),a=n(3734);var c=n(14824);async function l(e){const t=s.CID.parse(e);try{const n=await(0,c.C)(t.multihash.code),r=await async function(e){if("Q"===e)return a.gh.base58btc;const t=Object.values(a.gh).find((t=>t.prefix===e));if(null!=t)return t;throw new Error("unknown multibase prefix '".concat(e,"'"))}(e.substring(0,1)),i={name:t.code};return 0===t.version?i.code="implicit":t.version>=1&&(i.code="0x".concat(t.code.toString(16))),{cid:t,multibase:r,multicodec:i,multihash:{name:n.name,...t.multihash}}}catch(n){console.error("Failed to decode CID",n)}}var u=n(19778).Buffer;async function h(e){const t=await l(e);if(null==t)throw new Error("CID could not be decoded for CID '".concat(e.toString(),"'"));const n=t.multihash.name,r=t.multihash.code.toString(16),i=t.multihash.size,s=8*t.multihash.size,a=(c=t.multihash.digest,u.from(c.buffer,c.byteOffset,c.byteLength).toString("hex").toUpperCase());var c;const h=a.split("").reduce(((e,t,n)=>{const r=Math.floor(n/32);return null==e[r]&&(e[r]=[]),e[r].push(t),e}),[]),d=(0,o.Z)(t.cid.code),f="".concat(t.multibase.name," - cidv").concat(t.cid.version," - ").concat(d," - ").concat(n,"~").concat(s,"~").concat(a);return{base:t.multibase.name,codecName:d,hashFn:n,hashFnCode:r,hashLengthCode:i,hashLengthInBits:s,hashValue:a,hashValueIn32CharChunks:h,humanReadable:f}}function d(){return d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},d.apply(this,arguments)}const f=(0,i.Zh)("explore")((e=>{let{t:t,tReady:n,cid:i,className:o,...s}=e;const[a,c]=(0,r.useState)(null),[l,u]=(0,r.useState)(null);return(0,r.useEffect)((()=>{(async()=>{try{i&&u(await h(i))}catch(e){console.error(e),c(e)}})()}),[i]),i?r.createElement("section",d({className:"ph3 pv4 sans-serif ".concat(o)},s),r.createElement("label",{className:"db pb2"},r.createElement("a",{className:"tracked ttu f5 fw2 teal-muted hover-aqua link",href:"https://docs.ipfs.io/concepts/glossary/#cid",rel:"external",target:"_external"},t("CidInfo.header"))),l?r.createElement("div",null,r.createElement("div",{className:"f7 monospace fw4 ma0 pb2 truncate mid-gray force-select",title:i},i),r.createElement("div",{className:"f6 sans-serif fw4 ma0 pb2 truncate",id:"CidInfo-human-readable-cid"},l.humanReadable),r.createElement("label",{htmlFor:"CidInfo-human-readable-cid",className:"db fw2 ma0 mid-gray ttu f7 tracked"},t("base")," - ",t("version")," - ",t("codec")," - ",t("multihash")),r.createElement("a",{href:"https://docs.ipfs.io/concepts/glossary/#multihash",rel:"external",target:"_external",className:"dib tracked ttu f6 fw2 teal-muted hover-aqua link mt4"},t("multihash")),r.createElement("div",null,r.createElement("div",{className:"dib monospace f6 pt2 tr dark-gray lh-title ph2"},r.createElement("code",{className:"gray"},"0x"),r.createElement("span",{className:"orange force-select"},l.hashFnCode),r.createElement("span",{className:"green force-select"},l.hashLengthCode),r.createElement("span",{id:"CidInfo-multihash",className:"force-select"},l.hashValueIn32CharChunks.map((e=>r.createElement("span",{key:e.join("")},e.join(""),r.createElement("br",null))))),r.createElement("label",{htmlFor:"CidInfo-multihash",className:"sans-serif fw2 ma0 mid-gray ttu f7 tracked"},t("CidInfo.hashDigest")),r.createElement("div",{className:"tl lh-copy"},r.createElement("a",{className:"db orange no-underline pt2",href:"https://docs.ipfs.io/concepts/glossary/#multicodec",rel:"external",target:"_external",title:"Multicodec"},r.createElement("code",{className:"gray"},"0x"),r.createElement("code",null,l.hashFnCode)," = ",l.hashFn),r.createElement("div",{id:"CidInfo-multihash",className:"green"},r.createElement("code",{className:"gray"},"0x"),r.createElement("code",null,l.hashLengthCode)," = ",l.hashLengthInBits," bits"))))):null,a?r.createElement("div",null,r.createElement("div",{className:"f5 sans-serif fw5 ma0 pv2 truncate navy"},i),r.createElement("div",{className:"red fw2 ma0 f7"},a.message)):null):null}))},18335:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var r=n(72791);function i(){return i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i.apply(this,arguments)}const o=e=>r.createElement("svg",i({viewBox:"0 0 100 100"},e),r.createElement("path",{d:"M63.79 63.2l-3.88 3.88-9.71-9.7-9.7 9.7-3.88-3.88 9.7-9.71-9.7-9.7 3.88-3.88 9.7 9.7 9.71-9.7 3.88 3.88-9.7 9.7 9.7 9.71z"}));function s(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class a extends r.Component{constructor(){super(...arguments),s(this,"state",{hasError:!1})}componentDidCatch(e,t){this.setState({hasError:!0}),console.error(e)}render(){const{hasError:e}=this.state,{children:t,fallback:n}=this.props;return e?r.createElement(n,null):t}}s(a,"defaultProps",{fallback:o});const c=a},39278:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=n(5803),i=n(72791),o=n(51483);const s=(0,r.ZP)((()=>Promise.all([n.e(174),n.e(529)]).then(n.bind(n,24529))),{fallback:i.createElement(o.Z,null)})},51483:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=n(72791);const i=e=>{let{color:t="light",...n}=e;const i="dib la-ball-triangle-path la-".concat(t," la-sm");return r.createElement("div",n,r.createElement("div",{className:i,style:{width:20,height:20}},r.createElement("div",null),r.createElement("div",null),r.createElement("div",null)))};var o=n(59714);const s=()=>r.createElement(o.Z,{style:{height:"100%"}},r.createElement("div",{style:{height:"100%"}},r.createElement(i,{color:"dark"})))},21568:(e,t,n)=>{"use strict";n.d(t,{$j:()=>ge,ZP:()=>be,RB:()=>pe,Yn:()=>fe});var r=n(27530),i=n.n(r),o=n(90721),s=n(19264),a=n(72791),c=n(87945),l=Object.create,u=Object.defineProperty,h=Object.getOwnPropertyDescriptor,d=Object.getOwnPropertyNames,f=Object.getPrototypeOf,p=Object.prototype.hasOwnProperty,g=(e,t)=>function(){return t||(0,e[d(e)[0]])((t={exports:{}}).exports,t),t.exports},y=g({"node_modules/is-object/index.js"(e,t){t.exports=function(e){return"object"===typeof e&&null!==e}}}),m=g({"node_modules/is-window/index.js"(e,t){t.exports=function(e){if(null==e)return!1;var t=Object(e);return t===t.window}}}),v=g({"node_modules/is-dom/index.js"(e,t){var n=y(),r=m();t.exports=function(e){return!(!n(e)||!r(window)||"function"!==typeof window.Node)&&("number"===typeof e.nodeType&&"string"===typeof e.nodeName)}}}),b={};((e,t)=>{for(var n in t)u(e,n,{get:t[n],enumerable:!0})})(b,{chromeDark:()=>w,chromeLight:()=>E});var w={BASE_FONT_FAMILY:"Menlo, monospace",BASE_FONT_SIZE:"11px",BASE_LINE_HEIGHT:1.2,BASE_BACKGROUND_COLOR:"rgb(36, 36, 36)",BASE_COLOR:"rgb(213, 213, 213)",OBJECT_PREVIEW_ARRAY_MAX_PROPERTIES:10,OBJECT_PREVIEW_OBJECT_MAX_PROPERTIES:5,OBJECT_NAME_COLOR:"rgb(227, 110, 236)",OBJECT_VALUE_NULL_COLOR:"rgb(127, 127, 127)",OBJECT_VALUE_UNDEFINED_COLOR:"rgb(127, 127, 127)",OBJECT_VALUE_REGEXP_COLOR:"rgb(233, 63, 59)",OBJECT_VALUE_STRING_COLOR:"rgb(233, 63, 59)",OBJECT_VALUE_SYMBOL_COLOR:"rgb(233, 63, 59)",OBJECT_VALUE_NUMBER_COLOR:"hsl(252, 100%, 75%)",OBJECT_VALUE_BOOLEAN_COLOR:"hsl(252, 100%, 75%)",OBJECT_VALUE_FUNCTION_PREFIX_COLOR:"rgb(85, 106, 242)",HTML_TAG_COLOR:"rgb(93, 176, 215)",HTML_TAGNAME_COLOR:"rgb(93, 176, 215)",HTML_TAGNAME_TEXT_TRANSFORM:"lowercase",HTML_ATTRIBUTE_NAME_COLOR:"rgb(155, 187, 220)",HTML_ATTRIBUTE_VALUE_COLOR:"rgb(242, 151, 102)",HTML_COMMENT_COLOR:"rgb(137, 137, 137)",HTML_DOCTYPE_COLOR:"rgb(192, 192, 192)",ARROW_COLOR:"rgb(145, 145, 145)",ARROW_MARGIN_RIGHT:3,ARROW_FONT_SIZE:12,ARROW_ANIMATION_DURATION:"0",TREENODE_FONT_FAMILY:"Menlo, monospace",TREENODE_FONT_SIZE:"11px",TREENODE_LINE_HEIGHT:1.2,TREENODE_PADDING_LEFT:12,TABLE_BORDER_COLOR:"rgb(85, 85, 85)",TABLE_TH_BACKGROUND_COLOR:"rgb(44, 44, 44)",TABLE_TH_HOVER_COLOR:"rgb(48, 48, 48)",TABLE_SORT_ICON_COLOR:"black",TABLE_DATA_BACKGROUND_IMAGE:"linear-gradient(rgba(255, 255, 255, 0), rgba(255, 255, 255, 0) 50%, rgba(51, 139, 255, 0.0980392) 50%, rgba(51, 139, 255, 0.0980392))",TABLE_DATA_BACKGROUND_SIZE:"128px 32px"},E={BASE_FONT_FAMILY:"Menlo, monospace",BASE_FONT_SIZE:"11px",BASE_LINE_HEIGHT:1.2,BASE_BACKGROUND_COLOR:"white",BASE_COLOR:"black",OBJECT_PREVIEW_ARRAY_MAX_PROPERTIES:10,OBJECT_PREVIEW_OBJECT_MAX_PROPERTIES:5,OBJECT_NAME_COLOR:"rgb(136, 19, 145)",OBJECT_VALUE_NULL_COLOR:"rgb(128, 128, 128)",OBJECT_VALUE_UNDEFINED_COLOR:"rgb(128, 128, 128)",OBJECT_VALUE_REGEXP_COLOR:"rgb(196, 26, 22)",OBJECT_VALUE_STRING_COLOR:"rgb(196, 26, 22)",OBJECT_VALUE_SYMBOL_COLOR:"rgb(196, 26, 22)",OBJECT_VALUE_NUMBER_COLOR:"rgb(28, 0, 207)",OBJECT_VALUE_BOOLEAN_COLOR:"rgb(28, 0, 207)",OBJECT_VALUE_FUNCTION_PREFIX_COLOR:"rgb(13, 34, 170)",HTML_TAG_COLOR:"rgb(168, 148, 166)",HTML_TAGNAME_COLOR:"rgb(136, 18, 128)",HTML_TAGNAME_TEXT_TRANSFORM:"lowercase",HTML_ATTRIBUTE_NAME_COLOR:"rgb(153, 69, 0)",HTML_ATTRIBUTE_VALUE_COLOR:"rgb(26, 26, 166)",HTML_COMMENT_COLOR:"rgb(35, 110, 37)",HTML_DOCTYPE_COLOR:"rgb(192, 192, 192)",ARROW_COLOR:"#6e6e6e",ARROW_MARGIN_RIGHT:3,ARROW_FONT_SIZE:12,ARROW_ANIMATION_DURATION:"0",TREENODE_FONT_FAMILY:"Menlo, monospace",TREENODE_FONT_SIZE:"11px",TREENODE_LINE_HEIGHT:1.2,TREENODE_PADDING_LEFT:12,TABLE_BORDER_COLOR:"#aaa",TABLE_TH_BACKGROUND_COLOR:"#eee",TABLE_TH_HOVER_COLOR:"hsla(0, 0%, 90%, 1)",TABLE_SORT_ICON_COLOR:"#6e6e6e",TABLE_DATA_BACKGROUND_IMAGE:"linear-gradient(to bottom, white, white 50%, rgb(234, 243, 255) 50%, rgb(234, 243, 255))",TABLE_DATA_BACKGROUND_SIZE:"128px 32px"},A=(0,a.createContext)([{},()=>{}]),S={WebkitTouchCallout:"none",WebkitUserSelect:"none",KhtmlUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",OUserSelect:"none",userSelect:"none"},_=e=>({DOMNodePreview:{htmlOpenTag:{base:{color:e.HTML_TAG_COLOR},tagName:{color:e.HTML_TAGNAME_COLOR,textTransform:e.HTML_TAGNAME_TEXT_TRANSFORM},htmlAttributeName:{color:e.HTML_ATTRIBUTE_NAME_COLOR},htmlAttributeValue:{color:e.HTML_ATTRIBUTE_VALUE_COLOR}},htmlCloseTag:{base:{color:e.HTML_TAG_COLOR},offsetLeft:{marginLeft:-e.TREENODE_PADDING_LEFT},tagName:{color:e.HTML_TAGNAME_COLOR,textTransform:e.HTML_TAGNAME_TEXT_TRANSFORM}},htmlComment:{color:e.HTML_COMMENT_COLOR},htmlDoctype:{color:e.HTML_DOCTYPE_COLOR}},ObjectPreview:{objectDescription:{fontStyle:"italic"},preview:{fontStyle:"italic"},arrayMaxProperties:e.OBJECT_PREVIEW_ARRAY_MAX_PROPERTIES,objectMaxProperties:e.OBJECT_PREVIEW_OBJECT_MAX_PROPERTIES},ObjectName:{base:{color:e.OBJECT_NAME_COLOR},dimmed:{opacity:.6}},ObjectValue:{objectValueNull:{color:e.OBJECT_VALUE_NULL_COLOR},objectValueUndefined:{color:e.OBJECT_VALUE_UNDEFINED_COLOR},objectValueRegExp:{color:e.OBJECT_VALUE_REGEXP_COLOR},objectValueString:{color:e.OBJECT_VALUE_STRING_COLOR},objectValueSymbol:{color:e.OBJECT_VALUE_SYMBOL_COLOR},objectValueNumber:{color:e.OBJECT_VALUE_NUMBER_COLOR},objectValueBoolean:{color:e.OBJECT_VALUE_BOOLEAN_COLOR},objectValueFunctionPrefix:{color:e.OBJECT_VALUE_FUNCTION_PREFIX_COLOR,fontStyle:"italic"},objectValueFunctionName:{fontStyle:"italic"}},TreeView:{treeViewOutline:{padding:0,margin:0,listStyleType:"none"}},TreeNode:{treeNodeBase:{color:e.BASE_COLOR,backgroundColor:e.BASE_BACKGROUND_COLOR,lineHeight:e.TREENODE_LINE_HEIGHT,cursor:"default",boxSizing:"border-box",listStyle:"none",fontFamily:e.TREENODE_FONT_FAMILY,fontSize:e.TREENODE_FONT_SIZE},treeNodePreviewContainer:{},treeNodePlaceholder:{whiteSpace:"pre",fontSize:e.ARROW_FONT_SIZE,marginRight:e.ARROW_MARGIN_RIGHT,...S},treeNodeArrow:{base:{color:e.ARROW_COLOR,display:"inline-block",fontSize:e.ARROW_FONT_SIZE,marginRight:e.ARROW_MARGIN_RIGHT,...parseFloat(e.ARROW_ANIMATION_DURATION)>0?{transition:"transform ".concat(e.ARROW_ANIMATION_DURATION," ease 0s")}:{},...S},expanded:{WebkitTransform:"rotateZ(90deg)",MozTransform:"rotateZ(90deg)",transform:"rotateZ(90deg)"},collapsed:{WebkitTransform:"rotateZ(0deg)",MozTransform:"rotateZ(0deg)",transform:"rotateZ(0deg)"}},treeNodeChildNodesContainer:{margin:0,paddingLeft:e.TREENODE_PADDING_LEFT}},TableInspector:{base:{color:e.BASE_COLOR,position:"relative",border:"1px solid ".concat(e.TABLE_BORDER_COLOR),fontFamily:e.BASE_FONT_FAMILY,fontSize:e.BASE_FONT_SIZE,lineHeight:"120%",boxSizing:"border-box",cursor:"default"}},TableInspectorHeaderContainer:{base:{top:0,height:"17px",left:0,right:0,overflowX:"hidden"},table:{tableLayout:"fixed",borderSpacing:0,borderCollapse:"separate",height:"100%",width:"100%",margin:0}},TableInspectorDataContainer:{tr:{display:"table-row"},td:{boxSizing:"border-box",border:"none",height:"16px",verticalAlign:"top",padding:"1px 4px",WebkitUserSelect:"text",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",lineHeight:"14px"},div:{position:"static",top:"17px",bottom:0,overflowY:"overlay",transform:"translateZ(0)",left:0,right:0,overflowX:"hidden"},table:{positon:"static",left:0,top:0,right:0,bottom:0,borderTop:"0 none transparent",margin:0,backgroundImage:e.TABLE_DATA_BACKGROUND_IMAGE,backgroundSize:e.TABLE_DATA_BACKGROUND_SIZE,tableLayout:"fixed",borderSpacing:0,borderCollapse:"separate",width:"100%",fontSize:e.BASE_FONT_SIZE,lineHeight:"120%"}},TableInspectorTH:{base:{position:"relative",height:"auto",textAlign:"left",backgroundColor:e.TABLE_TH_BACKGROUND_COLOR,borderBottom:"1px solid ".concat(e.TABLE_BORDER_COLOR),fontWeight:"normal",verticalAlign:"middle",padding:"0 4px",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",lineHeight:"14px",":hover":{backgroundColor:e.TABLE_TH_HOVER_COLOR}},div:{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",fontSize:e.BASE_FONT_SIZE,lineHeight:"120%"}},TableInspectorLeftBorder:{none:{borderLeft:"none"},solid:{borderLeft:"1px solid ".concat(e.TABLE_BORDER_COLOR)}},TableInspectorSortIcon:{display:"block",marginRight:3,width:8,height:7,marginTop:-7,color:e.TABLE_SORT_ICON_COLOR,fontSize:12,...S}}),I="chromeLight",C=(0,a.createContext)(_(b[I])),T=e=>(0,a.useContext)(C)[e],k=e=>t=>{let{theme:n=I,...r}=t;const i=(0,a.useMemo)((()=>{switch(Object.prototype.toString.call(n)){case"[object String]":return _(b[n]);case"[object Object]":return _(n);default:return _(b[I])}}),[n]);return a.createElement(C.Provider,{value:i},a.createElement(e,{...r}))},R=e=>{let{expanded:t,styles:n}=e;return a.createElement("span",{style:{...n.base,...t?n.expanded:n.collapsed}},"\u25b6")},x=(0,a.memo)((e=>{e={expanded:!0,nodeRenderer:e=>{let{name:t}=e;return a.createElement("span",null,t)},onClick:()=>{},shouldShowArrow:!1,shouldShowPlaceholder:!0,...e};const{expanded:t,onClick:n,children:r,nodeRenderer:i,title:o,shouldShowArrow:s,shouldShowPlaceholder:c}=e,l=T("TreeNode"),u=i;return a.createElement("li",{"aria-expanded":t,role:"treeitem",style:l.treeNodeBase,title:o},a.createElement("div",{style:l.treeNodePreviewContainer,onClick:n},s||a.Children.count(r)>0?a.createElement(R,{expanded:t,styles:l.treeNodeArrow}):c&&a.createElement("span",{style:l.treeNodePlaceholder},"\xa0"),a.createElement(u,{...e})),a.createElement("ol",{role:"group",style:l.treeNodeChildNodesContainer},t?r:void 0))})),P="$";function D(e,t){return!t(e).next().done}var O=(e,t,n,r,i)=>{const o=[].concat((s=r,Array.from({length:s},((e,t)=>[P].concat(Array.from({length:t},(()=>"*"))).join("."))))).concat(n).filter((e=>"string"===typeof e));var s;const a=[];return o.forEach((n=>{const r=n.split("."),i=(e,n,o)=>{if(o===r.length)return void a.push(n);const s=r[o];if(0===o)!D(e,t)||s!==P&&"*"!==s||i(e,P,o+1);else if("*"===s)for(const{name:r,data:a}of t(e))D(a,t)&&i(a,"".concat(n,".").concat(r),o+1);else{const r=e[s];D(r,t)&&i(r,"".concat(n,".").concat(s),o+1)}};i(e,"",0)})),a.reduce(((e,t)=>(e[t]=!0,e)),{...i})},N=(0,a.memo)((e=>{const{data:t,dataIterator:n,path:r,depth:i,nodeRenderer:o}=e,[s,c]=(0,a.useContext)(A),l=D(t,n),u=!!s[r],h=(0,a.useCallback)((()=>l&&c((e=>({...e,[r]:!u})))),[l,c,r,u]);return a.createElement(x,{expanded:u,onClick:h,shouldShowArrow:l,shouldShowPlaceholder:i>0,nodeRenderer:o,...e},u?[...n(t)].map((e=>{let{name:t,data:s,...c}=e;return a.createElement(N,{name:t,data:s,depth:i+1,path:"".concat(r,".").concat(t),key:t,dataIterator:n,nodeRenderer:o,...c})})):null)})),B=(0,a.memo)((e=>{let{name:t,data:n,dataIterator:r,nodeRenderer:i,expandPaths:o,expandLevel:s}=e;const c=T("TreeView"),l=(0,a.useState)({}),[,u]=l;return(0,a.useLayoutEffect)((()=>u((e=>O(n,r,o,s,e)))),[n,r,o,s]),a.createElement(A.Provider,{value:l},a.createElement("ol",{role:"tree",style:c.treeViewOutline},a.createElement(N,{name:t,data:n,dataIterator:r,depth:0,path:P,nodeRenderer:i})))})),L=e=>{let{name:t,dimmed:n=!1,styles:r={}}=e;const i=T("ObjectName"),o={...i.base,...n?i.dimmed:{},...r};return a.createElement("span",{style:o},t)},M=e=>{let{object:t,styles:n}=e;const r=T("ObjectValue"),i=e=>({...r[e],...n});switch(typeof t){case"bigint":return a.createElement("span",{style:i("objectValueNumber")},String(t),"n");case"number":return a.createElement("span",{style:i("objectValueNumber")},String(t));case"string":return a.createElement("span",{style:i("objectValueString")},'"',t,'"');case"boolean":return a.createElement("span",{style:i("objectValueBoolean")},String(t));case"undefined":return a.createElement("span",{style:i("objectValueUndefined")},"undefined");case"object":return null===t?a.createElement("span",{style:i("objectValueNull")},"null"):t instanceof Date?a.createElement("span",null,t.toString()):t instanceof RegExp?a.createElement("span",{style:i("objectValueRegExp")},t.toString()):Array.isArray(t)?a.createElement("span",null,"Array(".concat(t.length,")")):t.constructor?"function"===typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)?a.createElement("span",null,"Buffer[".concat(t.length,"]")):a.createElement("span",null,t.constructor.name):a.createElement("span",null,"Object");case"function":return a.createElement("span",null,a.createElement("span",{style:i("objectValueFunctionPrefix")},"\u0192\xa0"),a.createElement("span",{style:i("objectValueFunctionName")},t.name,"()"));case"symbol":return a.createElement("span",{style:i("objectValueSymbol")},t.toString());default:return a.createElement("span",null)}},U=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;function K(e,t){const n=Object.getOwnPropertyDescriptor(e,t);if(n.get)try{return n.get()}catch{return n.get}return e[t]}function j(e,t){return 0===e.length?[]:e.slice(1).reduce(((e,n)=>e.concat([t,n])),[e[0]])}var Z=e=>{let{data:t}=e;const n=T("ObjectPreview"),r=t;if("object"!==typeof r||null===r||r instanceof Date||r instanceof RegExp)return a.createElement(M,{object:r});if(Array.isArray(r)){const e=n.arrayMaxProperties,t=r.slice(0,e).map(((e,t)=>a.createElement(M,{key:t,object:e})));r.length>e&&t.push(a.createElement("span",{key:"ellipsis"},"\u2026"));const i=r.length;return a.createElement(a.Fragment,null,a.createElement("span",{style:n.objectDescription},0===i?"":"(".concat(i,")\xa0")),a.createElement("span",{style:n.preview},"[",j(t,", "),"]"))}{const e=n.objectMaxProperties,t=[];for(const n in r)if(U.call(r,n)){let i;t.length===e-1&&Object.keys(r).length>e&&(i=a.createElement("span",{key:"ellipsis"},"\u2026"));const o=K(r,n);if(t.push(a.createElement("span",{key:n},a.createElement(L,{name:n||'""'}),":\xa0",a.createElement(M,{object:o}),i)),i)break}const i=r.constructor?r.constructor.name:"Object";return a.createElement(a.Fragment,null,a.createElement("span",{style:n.objectDescription},"Object"===i?"":"".concat(i," ")),a.createElement("span",{style:n.preview},"{",j(t,", "),"}"))}},z=e=>{let{name:t,data:n}=e;return"string"===typeof t?a.createElement("span",null,a.createElement(L,{name:t}),a.createElement("span",null,": "),a.createElement(Z,{data:n})):a.createElement(Z,{data:n})},V=e=>{let{name:t,data:n,isNonenumerable:r=!1}=e;const i=n;return a.createElement("span",null,"string"===typeof t?a.createElement(L,{name:t,dimmed:r}):a.createElement(Z,{data:t}),a.createElement("span",null,": "),a.createElement(M,{object:i}))},H=e=>{let{depth:t,name:n,data:r,isNonenumerable:i}=e;return 0===t?a.createElement(z,{name:n,data:r}):a.createElement(V,{name:n,data:r,isNonenumerable:i})},q=k((e=>{let{showNonenumerable:t=!1,sortObjectKeys:n,nodeRenderer:r,...i}=e;const o=((e,t)=>function*(n){if(("object"!==typeof n||null===n)&&"function"!==typeof n)return;const r=Array.isArray(n);if(!r&&n[Symbol.iterator]){let e=0;for(const t of n){if(Array.isArray(t)&&2===t.length){const[e,n]=t;yield{name:e,data:n}}else yield{name:e.toString(),data:t};e++}}else{const o=Object.getOwnPropertyNames(n);!0!==t||r?"function"===typeof t&&o.sort(t):o.sort();for(const t of o)if(F.call(n,t)){const e=K(n,t);yield{name:t||'""',data:e}}else if(e){let e;try{e=K(n,t)}catch(i){}void 0!==e&&(yield{name:t,data:e,isNonenumerable:!0})}e&&n!==Object.prototype&&(yield{name:"__proto__",data:Object.getPrototypeOf(n),isNonenumerable:!0})}})(t,n),s=r||H;return a.createElement(B,{nodeRenderer:s,dataIterator:o,...i})}));var G=e=>{let{rows:t,columns:n,rowsData:r}=e;const i=T("TableInspectorDataContainer"),o=T("TableInspectorLeftBorder");return a.createElement("div",{style:i.div},a.createElement("table",{style:i.table},a.createElement("colgroup",null),a.createElement("tbody",null,t.map(((e,t)=>a.createElement("tr",{key:e,style:i.tr},a.createElement("td",{style:{...i.td,...o.none}},e),n.map((e=>{const n=r[t];return"object"===typeof n&&null!==n&&U.call(n,e)?a.createElement("td",{key:e,style:{...i.td,...o.solid}},a.createElement(M,{object:n[e]})):a.createElement("td",{key:e,style:{...i.td,...o.solid}})}))))))))},W=e=>a.createElement("div",{style:{position:"absolute",top:1,right:0,bottom:1,display:"flex",alignItems:"center"}},e.children),Q=e=>{let{sortAscending:t}=e;const n=T("TableInspectorSortIcon"),r=t?"\u25b2":"\u25bc";return a.createElement("div",{style:n},r)},Y=e=>{let{sortAscending:t=!1,sorted:n=!1,onClick:r,borderStyle:i={},children:o,...s}=e;const c=T("TableInspectorTH"),[l,u]=(0,a.useState)(!1),h=(0,a.useCallback)((()=>u(!0)),[]),d=(0,a.useCallback)((()=>u(!1)),[]);return a.createElement("th",{...s,style:{...c.base,...i,...l?c.base[":hover"]:{}},onMouseEnter:h,onMouseLeave:d,onClick:r},a.createElement("div",{style:c.div},o),n&&a.createElement(W,null,a.createElement(Q,{sortAscending:t})))},J=e=>{let{indexColumnText:t="(index)",columns:n=[],sorted:r,sortIndexColumn:i,sortColumn:o,sortAscending:s,onTHClick:c,onIndexTHClick:l}=e;const u=T("TableInspectorHeaderContainer"),h=T("TableInspectorLeftBorder");return a.createElement("div",{style:u.base},a.createElement("table",{style:u.table},a.createElement("tbody",null,a.createElement("tr",null,a.createElement(Y,{borderStyle:h.none,sorted:r&&i,sortAscending:s,onClick:l},t),n.map((e=>a.createElement(Y,{borderStyle:h.solid,key:e,sorted:r&&o===e,sortAscending:s,onClick:c.bind(null,e)},e)))))))},X=(k((e=>{let{data:t,columns:n}=e;const r=T("TableInspector"),[{sorted:i,sortIndexColumn:o,sortColumn:s,sortAscending:c},l]=(0,a.useState)({sorted:!1,sortIndexColumn:!1,sortColumn:void 0,sortAscending:!1}),u=(0,a.useCallback)((()=>{l((e=>{let{sortIndexColumn:t,sortAscending:n}=e;return{sorted:!0,sortIndexColumn:!0,sortColumn:void 0,sortAscending:!t||!n}}))}),[]),h=(0,a.useCallback)((e=>{l((t=>{let{sortColumn:n,sortAscending:r}=t;return{sorted:!0,sortIndexColumn:!1,sortColumn:e,sortAscending:e!==n||!r}}))}),[]);if("object"!==typeof t||null===t)return a.createElement("div",null);let{rowHeaders:d,colHeaders:f}=function(e){if("object"===typeof e){let t=[];if(Array.isArray(e)){const n=e.length;t=[...Array(n).keys()]}else null!==e&&(t=Object.keys(e));const n=t.reduce(((t,n)=>{const r=e[n];return"object"===typeof r&&null!==r&&Object.keys(r).reduce(((e,t)=>(e.includes(t)||e.push(t),e)),t),t}),[]);return{rowHeaders:t,colHeaders:n}}}(t);void 0!==n&&(f=n);let p,g=d.map((e=>t[e]));if(void 0!==s?p=g.map(((e,t)=>{if("object"===typeof e&&null!==e){return[e[s],t]}return[void 0,t]})):o&&(p=d.map(((e,t)=>[d[t],t]))),void 0!==p){const e=(e,t)=>(n,r)=>{const i=e(n),o=e(r),s=typeof i,a=typeof o,c=(e,t)=>e<t?-1:e>t?1:0;let l;if(s===a)l=c(i,o);else{const e={string:0,number:1,object:2,symbol:3,boolean:4,undefined:5,function:6};l=c(e[s],e[a])}return t||(l=-l),l},t=p.sort(e((e=>e[0]),c)).map((e=>e[1]));d=t.map((e=>d[e])),g=t.map((e=>g[e]))}return a.createElement("div",{style:r.base},a.createElement(J,{columns:f,sorted:i,sortIndexColumn:o,sortColumn:s,sortAscending:c,onTHClick:h,onIndexTHClick:u}),a.createElement(G,{rows:d,columns:f,rowsData:g}))})),e=>0===e.childNodes.length||1===e.childNodes.length&&e.childNodes[0].nodeType===Node.TEXT_NODE&&e.textContent.length<80),$=e=>{let{tagName:t,attributes:n,styles:r}=e;return a.createElement("span",{style:r.base},"<",a.createElement("span",{style:r.tagName},t),(()=>{if(n){const e=[];for(let t=0;t<n.length;t++){const i=n[t];e.push(a.createElement("span",{key:t}," ",a.createElement("span",{style:r.htmlAttributeName},i.name),'="',a.createElement("span",{style:r.htmlAttributeValue},i.value),'"'))}return e}})(),">")},ee=e=>{let{tagName:t,isChildNode:n=!1,styles:r}=e;return a.createElement("span",{style:Object.assign({},r.base,n&&r.offsetLeft)},"</",a.createElement("span",{style:r.tagName},t),">")},te={1:"ELEMENT_NODE",3:"TEXT_NODE",7:"PROCESSING_INSTRUCTION_NODE",8:"COMMENT_NODE",9:"DOCUMENT_NODE",10:"DOCUMENT_TYPE_NODE",11:"DOCUMENT_FRAGMENT_NODE"},ne=e=>{let{isCloseTag:t,data:n,expanded:r}=e;const i=T("DOMNodePreview");if(t)return a.createElement(ee,{styles:i.htmlCloseTag,isChildNode:!0,tagName:n.tagName});switch(n.nodeType){case Node.ELEMENT_NODE:return a.createElement("span",null,a.createElement($,{tagName:n.tagName,attributes:n.attributes,styles:i.htmlOpenTag}),X(n)?n.textContent:!r&&"\u2026",!r&&a.createElement(ee,{tagName:n.tagName,styles:i.htmlCloseTag}));case Node.TEXT_NODE:return a.createElement("span",null,n.textContent);case Node.CDATA_SECTION_NODE:return a.createElement("span",null,"<![CDATA["+n.textContent+"]]>");case Node.COMMENT_NODE:return a.createElement("span",{style:i.htmlComment},"\x3c!--",n.textContent,"--\x3e");case Node.PROCESSING_INSTRUCTION_NODE:return a.createElement("span",null,n.nodeName);case Node.DOCUMENT_TYPE_NODE:return a.createElement("span",{style:i.htmlDoctype},"<!DOCTYPE ",n.name,n.publicId?' PUBLIC "'.concat(n.publicId,'"'):"",!n.publicId&&n.systemId?" SYSTEM":"",n.systemId?' "'.concat(n.systemId,'"'):"",">");case Node.DOCUMENT_NODE:case Node.DOCUMENT_FRAGMENT_NODE:return a.createElement("span",null,n.nodeName);default:return a.createElement("span",null,te[n.nodeType])}},re=function*(e){if(e&&e.childNodes){if(X(e))return;for(let t=0;t<e.childNodes.length;t++){const n=e.childNodes[t];n.nodeType===Node.TEXT_NODE&&0===n.textContent.trim().length||(yield{name:"".concat(n.tagName,"[").concat(t,"]"),data:n})}e.tagName&&(yield{name:"CLOSE_TAG",data:{tagName:e.tagName},isCloseTag:!0})}},ie=(k((e=>a.createElement(B,{nodeRenderer:ne,dataIterator:re,...e}))),((e,t,n)=>{n=null!=e?l(f(e)):{},((e,t,n,r)=>{if(t&&"object"===typeof t||"function"===typeof t)for(let i of d(t))p.call(e,i)||i===n||u(e,i,{get:()=>t[i],enumerable:!(r=h(t,i))||r.enumerable})})(!t&&e&&e.__esModule?n:u(n,"default",{value:e,enumerable:!0}),e)})(v()),n(4775));function oe(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class se extends a.Component{constructor(){super(...arguments),oe(this,"handleOnRowClick",(e=>{let{rowData:t}=e;const{onLinkClick:n}=this.props;n(t)}))}render(){const{links:e}=this.props,t="mid-gray fw2 tracked",n={overflow:"auto"},r=Math.max(370,Math.min(window.innerHeight-500,29*e.length+32));return a.createElement("div",null,a.createElement(ie.qj,{disableHeight:!0},(i=>{let{width:o}=i;return a.createElement(ie.iA,{className:"tl fw4 LinksTable",rowClassName:"pointer bb b--near-white f7",width:o,height:r,headerHeight:32,rowHeight:29,rowCount:e.length,rowGetter:t=>{let{index:n}=t;return{index:n,...e[n]}},onRowClick:this.handleOnRowClick},a.createElement(ie.sg,{dataKey:"index",width:34,className:"pv2 mid-gray monospace tr pr1"}),a.createElement(ie.sg,{label:"Path",dataKey:"path",width:150,flexGrow:1,className:"pv2 navy f6-ns",headerClassName:t}),a.createElement(ie.sg,{label:"CID",dataKey:"target",width:420,className:"pv2 mid-gray monospace no-ellipsis",headerClassName:t,style:n}))})))}}const ae=se;var ce=n(48236);function le(){return le=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},le.apply(this,arguments)}const ue=i().partial({round:0}),he={...E,BASE_FONT_FAMILY:"Consolas, Menlo, monospace",TREENODE_FONT_FAMILY:"Consolas, Menlo, monospace",BASE_FONT_SIZE:"13px",BASE_LINE_HEIGHT:"19px",TREENODE_FONT_SIZE:"13px",TREENODE_LINE_HEIGHT:"19px"},de={"dag-cbor":{shortName:"DAG-CBOR",name:"dag-cbor",color:o.colors.aqua},"dag-json":{shortName:"DAG-JSON",name:"dag-json",color:o.colors.green},raw:{shortName:"RAW",name:"Raw Block",color:o.colors.red},"dag-pb":{shortName:"DAG-PB",name:"dag-pb",color:o.colors.teal},"dag-jose":{shortName:"DAG-JOSE",name:"dag-jose",color:o.colors.yellow},json:{shortName:"JSON",name:"JSON",color:o.colors["green-muted"]},"hamt-sharded-directory":{shortName:"HAMT\nDAG-PB",name:"HAMT-Sharded dag-pb Directory",color:o.colors["teal-muted"]},"eth-block":{shortName:"ETH",name:"Ethereum Block",color:o.colors.charcoal},"eth-block-list":{shortName:"ETH",name:"Ethereum Block List",color:o.colors.charcoal},"eth-tx-trie":{shortName:"ETH",name:"Ethereum Tx Trie",color:o.colors.charcoal},"eth-tx":{shortName:"ETH",name:"Ethereum Tx",color:o.colors.charcoal},"eth-state-trie":{shortName:"ETH",name:"Ethereum State Trie",color:o.colors.charcoal}};function fe(e){const t=de[e];return t&&t.shortName||"DAG"}function pe(e){const t=de[e];return t&&t.name||"DAG Node"}function ge(e){const t=de[e];return t&&t.color||"#ea5037"}function ye(e){if(!e)return[];const t=e.split("/"),n=t.map(((e,n)=>{if(!e)return"$";const r=t.slice(0,n).join(".");return"$".concat(r,".").concat(e)}));return n.slice(0,n.length-1)}const me=e=>{let{type:t,...n}=e;return a.createElement("svg",le({},n,{title:pe(t),width:"30",height:"30",viewBox:"0 0 30 30",xmlns:"http://www.w3.org/2000/svg"}),a.createElement("circle",{cx:"15",cy:"15",r:"15",fillRule:"evenodd",fill:ge(t)}))},ve=e=>(null==e||null!=e.blockSizes&&(e.blockSizes=e.blockSizes.map(Number)),e),be=(0,c.Zh)("explore")((e=>{let{t:t,tReady:n,className:r,type:i,cid:o,localPath:c,size:l,data:u,links:h,format:d,onLinkClick:f,gatewayUrl:p,publicGatewayUrl:g,...y}=e;if(!n)return null;const m="unixfs"===d&&u.type&&["directory","file"].some((e=>e===u.type));let v=i;var b;isNaN(i)&&!m&&"DAG Node"!==pe(i)||(v=null!==(b=(0,ce.Z)(s.CID.parse(o).code))&&void 0!==b?b:i);return a.createElement("section",le({className:"pa4 sans-serif ".concat(r)},y),a.createElement("h2",{className:"ma0 lh-title f4 fw4 montserrat pb2",title:v},a.createElement(me,{type:v,className:"mr3",style:{verticalAlign:-8}}),a.createElement("span",{className:"v-mid"},pe(v)),"unixfs"===d?a.createElement("a",{className:"dn di-ns no-underline charcoal ml2",href:"https://docs.ipfs.io/concepts/glossary/#unixfs",rel:"external",target:"_external"},"UnixFS"):null,m?a.createElement("span",{className:"dib"},p&&p!==g&&a.createElement("a",{className:"no-underline avenir ml2 pa2 fw5 f6 navy dib",href:"".concat(p,"/ipfs/").concat(o),rel:"external nofollow",target:"_external"},t("ObjectInfo.privateGateway")),g&&a.createElement("a",{className:"no-underline avenir ml2 pa2 fw5 f6 navy dib",href:"".concat(g,"/ipfs/").concat(o),rel:"external nofollow",target:"_external"},t("ObjectInfo.publicGateway"))):null),a.createElement("div",{className:"f6"},o?a.createElement("div",{className:"dt dt--fixed pt2"},a.createElement("label",{className:"dtc silver tracked ttu f7",style:{width:48}},"CID"),a.createElement("div",{className:"dtc truncate charcoal monospace","data-id":"ObjectInfo-cid"},o)):null,l?a.createElement("div",{className:"dt dt--fixed pt2"},a.createElement("label",{className:"dtc silver tracked ttu f7",style:{width:48}},"Size"),a.createElement("div",{className:"dtc truncate charcoal monospace"},ue(Number(l)))):null,a.createElement("div",{className:"dt dt--fixed pt2"},a.createElement("label",{className:"dtc silver tracked ttu f7",style:{width:48}},"Links"),a.createElement("div",{className:"dtc truncate charcoal"},h?a.createElement("code",null,h.length):"No Links")),a.createElement("div",{className:"dt dt--fixed pt2",style:{height:26}},a.createElement("label",{className:"dtc silver tracked ttu f7 v-mid",style:{width:48}},"Data"),a.createElement("div",{className:"dtc truncate mid-gray"},u?null:"No data")),u?a.createElement("div",{className:"pa3 mt2 bg-white f5 nl3 nr3 mh0-l overflow-x-auto"},a.createElement(q,{showMaxKeys:100,data:ve(u),theme:he,expandPaths:ye(c)})):null),h&&h.length?a.createElement("div",{className:"mv2 nl3 nr3 mh0-l"},a.createElement(ae,{links:h,onLinkClick:f})):null)}))},24799:(e,t,n)=>{"use strict";n.d(t,{T8:()=>gge,bd:()=>_ge,py:()=>Ns,b0:()=>nge});var r={};n.r(r),n.d(r,{dQ:()=>Qc,ci:()=>Kc,bytesToNumberBE:()=>zc,ty:()=>Vc,eV:()=>Wc,n$:()=>Xc,ql:()=>Gc,hexToBytes:()=>Zc,tL:()=>Hc,S5:()=>qc,FF:()=>el});var i={};n.r(i),n.d(i,{Ed25519PrivateKey:()=>Fu,Ed25519PublicKey:()=>Uu,generateKeyPair:()=>Zu,generateKeyPairFromSeed:()=>zu,unmarshalEd25519PrivateKey:()=>Ku,unmarshalEd25519PublicKey:()=>ju});var o={};n.r(o),n.d(o,{MAX_KEY_SIZE:()=>Xu,RsaPrivateKey:()=>eh,RsaPublicKey:()=>$u,fromJwk:()=>rh,generateKeyPair:()=>ih,unmarshalRsaPrivateKey:()=>th,unmarshalRsaPublicKey:()=>nh});var s={};n.r(s),n.d(s,{Secp256k1PrivateKey:()=>_h,Secp256k1PublicKey:()=>Sh,generateKeyPair:()=>Th,unmarshalSecp256k1PrivateKey:()=>Ih,unmarshalSecp256k1PublicKey:()=>Ch});var a={};n.r(a),n.d(a,{base32:()=>vf,base32hex:()=>Af,base32hexpad:()=>_f,base32hexpadupper:()=>If,base32hexupper:()=>Sf,base32pad:()=>wf,base32padupper:()=>Ef,base32upper:()=>bf,base32z:()=>Cf});var c={};n.r(c),n.d(c,{base58btc:()=>Tf,base58flickr:()=>kf});var l={};n.r(l),n.d(l,{base64:()=>Rf,base64pad:()=>xf,base64url:()=>Pf,base64urlpad:()=>Df});var u={};n.r(u),n.d(u,{base10:()=>Bf});var h={};n.r(h),n.d(h,{base16:()=>Lf,base16upper:()=>Mf});var d={};n.r(d),n.d(d,{base2:()=>Uf});var f={};n.r(f),n.d(f,{base256emoji:()=>Zf});var p={};n.r(p),n.d(p,{base36:()=>zf,base36upper:()=>Vf});var g={};n.r(g),n.d(g,{base8:()=>Hf});var y={};n.r(y),n.d(y,{identity:()=>qf});var m={};n.r(m),n.d(m,{code:()=>Yf,decode:()=>Xf,encode:()=>Jf,name:()=>Qf});var v={};n.r(v),n.d(v,{code:()=>ep,decode:()=>np,encode:()=>tp,name:()=>$f});var b={};n.r(b),n.d(b,{identity:()=>Tp});var w={};n.r(w),n.d(w,{sha256:()=>Pp,sha512:()=>Dp});var E={};n.r(E),n.d(E,{Ed25519PrivateKey:()=>mg,Ed25519PublicKey:()=>yg,generateKeyPair:()=>wg,generateKeyPairFromSeed:()=>Eg,unmarshalEd25519PrivateKey:()=>vg,unmarshalEd25519PublicKey:()=>bg});var A={};n.r(A),n.d(A,{MAX_KEY_SIZE:()=>Dg,RsaPrivateKey:()=>Ng,RsaPublicKey:()=>Og,fromJwk:()=>Mg,generateKeyPair:()=>Ug,unmarshalRsaPrivateKey:()=>Bg,unmarshalRsaPublicKey:()=>Lg});var S={};n.r(S),n.d(S,{Secp256k1PrivateKey:()=>jg,Secp256k1PublicKey:()=>Kg,generateKeyPair:()=>Vg,unmarshalSecp256k1PrivateKey:()=>Zg,unmarshalSecp256k1PublicKey:()=>zg});var _={};n.r(_),n.d(_,{base58btc:()=>uv,base58flickr:()=>hv});var I={};n.r(I),n.d(I,{base10:()=>dv});var C={};n.r(C),n.d(C,{base16:()=>fv,base16upper:()=>pv});var T={};n.r(T),n.d(T,{base2:()=>gv});var k={};n.r(k),n.d(k,{base256emoji:()=>bv});var R={};n.r(R),n.d(R,{base32:()=>wv,base32hex:()=>_v,base32hexpad:()=>Cv,base32hexpadupper:()=>Tv,base32hexupper:()=>Iv,base32pad:()=>Av,base32padupper:()=>Sv,base32upper:()=>Ev,base32z:()=>kv});var x={};n.r(x),n.d(x,{base36:()=>Rv,base36upper:()=>xv});var P={};n.r(P),n.d(P,{base64:()=>Pv,base64pad:()=>Dv,base64url:()=>Ov,base64urlpad:()=>Nv});var D={};n.r(D),n.d(D,{base8:()=>Bv});var O={};n.r(O),n.d(O,{identity:()=>Lv});var N={};n.r(N),n.d(N,{code:()=>Kv,decode:()=>Zv,encode:()=>jv,name:()=>Fv});var B={};n.r(B),n.d(B,{code:()=>Vv,decode:()=>qv,encode:()=>Hv,name:()=>zv});var L={};n.r(L),n.d(L,{identity:()=>mb});var M={};n.r(M),n.d(M,{sha256:()=>Eb,sha512:()=>Ab});var U={};n.r(U),n.d(U,{base58btc:()=>nw,base58flickr:()=>rw});var F={};n.r(F),n.d(F,{identity:()=>kw});var K={};n.r(K),n.d(K,{sha256:()=>Dw,sha512:()=>Ow});var j={};n.r(j),n.d(j,{base64:()=>jw,base64pad:()=>Zw,base64url:()=>zw,base64urlpad:()=>Vw});var Z={};n.r(Z),n.d(Z,{Ed25519PrivateKey:()=>$w,Ed25519PublicKey:()=>Xw,generateKeyPair:()=>nE,generateKeyPairFromSeed:()=>rE,unmarshalEd25519PrivateKey:()=>eE,unmarshalEd25519PublicKey:()=>tE});var z={};n.r(z),n.d(z,{MAX_KEY_SIZE:()=>dE,RsaPrivateKey:()=>pE,RsaPublicKey:()=>fE,fromJwk:()=>mE,generateKeyPair:()=>vE,unmarshalRsaPrivateKey:()=>gE,unmarshalRsaPublicKey:()=>yE});var V={};n.r(V),n.d(V,{Secp256k1PrivateKey:()=>EE,Secp256k1PublicKey:()=>wE,generateKeyPair:()=>_E,unmarshalSecp256k1PrivateKey:()=>AE,unmarshalSecp256k1PublicKey:()=>SE});var H={};n.r(H),n.d(H,{base10:()=>kE});var q={};n.r(q),n.d(q,{base16:()=>RE,base16upper:()=>xE});var G={};n.r(G),n.d(G,{base2:()=>PE});var W={};n.r(W),n.d(W,{base256emoji:()=>BE});var Q={};n.r(Q),n.d(Q,{base32:()=>LE,base32hex:()=>KE,base32hexpad:()=>ZE,base32hexpadupper:()=>zE,base32hexupper:()=>jE,base32pad:()=>UE,base32padupper:()=>FE,base32upper:()=>ME,base32z:()=>VE});var Y={};n.r(Y),n.d(Y,{base36:()=>HE,base36upper:()=>qE});var J={};n.r(J),n.d(J,{base8:()=>GE});var X={};n.r(X),n.d(X,{identity:()=>WE});var $={};n.r($),n.d($,{code:()=>XE,decode:()=>eA,encode:()=>$E,name:()=>JE});var ee={};n.r(ee),n.d(ee,{code:()=>nA,decode:()=>iA,encode:()=>rA,name:()=>tA});var te={};n.r(te),n.d(te,{base58btc:()=>DS,base58flickr:()=>OS});var ne={};n.r(ne),n.d(ne,{base10:()=>NS});var re={};n.r(re),n.d(re,{base16:()=>BS,base16upper:()=>LS});var ie={};n.r(ie),n.d(ie,{base2:()=>MS});var oe={};n.r(oe),n.d(oe,{base256emoji:()=>jS});var se={};n.r(se),n.d(se,{base32:()=>ZS,base32hex:()=>qS,base32hexpad:()=>WS,base32hexpadupper:()=>QS,base32hexupper:()=>GS,base32pad:()=>VS,base32padupper:()=>HS,base32upper:()=>zS,base32z:()=>YS});var ae={};n.r(ae),n.d(ae,{base36:()=>JS,base36upper:()=>XS});var ce={};n.r(ce),n.d(ce,{base64:()=>$S,base64pad:()=>e_,base64url:()=>t_,base64urlpad:()=>n_});var le={};n.r(le),n.d(le,{base8:()=>r_});var ue={};n.r(ue),n.d(ue,{identity:()=>i_});var he={};n.r(he),n.d(he,{code:()=>c_,decode:()=>u_,encode:()=>l_,name:()=>a_});var de={};n.r(de),n.d(de,{code:()=>d_,decode:()=>p_,encode:()=>f_,name:()=>h_});var fe={};n.r(fe),n.d(fe,{identity:()=>F_});var pe={};n.r(pe),n.d(pe,{sha256:()=>z_,sha512:()=>V_});var ge={};n.r(ge),n.d(ge,{base58btc:()=>II,base58flickr:()=>CI});var ye={};n.r(ye),n.d(ye,{identity:()=>JI});var me={};n.r(me),n.d(me,{sha256:()=>tC,sha512:()=>nC});var ve={};n.r(ve),n.d(ve,{base64:()=>uC,base64pad:()=>hC,base64url:()=>dC,base64urlpad:()=>fC});var be={};n.r(be),n.d(be,{Ed25519PrivateKey:()=>AC,Ed25519PublicKey:()=>EC,generateKeyPair:()=>IC,generateKeyPairFromSeed:()=>CC,unmarshalEd25519PrivateKey:()=>SC,unmarshalEd25519PublicKey:()=>_C});var we={};n.r(we),n.d(we,{MAX_KEY_SIZE:()=>BC,RsaPrivateKey:()=>MC,RsaPublicKey:()=>LC,fromJwk:()=>KC,generateKeyPair:()=>jC,unmarshalRsaPrivateKey:()=>UC,unmarshalRsaPublicKey:()=>FC});var Ee={};n.r(Ee),n.d(Ee,{Secp256k1PrivateKey:()=>VC,Secp256k1PublicKey:()=>zC,generateKeyPair:()=>GC,unmarshalSecp256k1PrivateKey:()=>HC,unmarshalSecp256k1PublicKey:()=>qC});var Ae={};n.r(Ae),n.d(Ae,{base10:()=>JC});var Se={};n.r(Se),n.d(Se,{base16:()=>XC,base16upper:()=>$C});var _e={};n.r(_e),n.d(_e,{base2:()=>eT});var Ie={};n.r(Ie),n.d(Ie,{base256emoji:()=>iT});var Ce={};n.r(Ce),n.d(Ce,{base32:()=>oT,base32hex:()=>lT,base32hexpad:()=>hT,base32hexpadupper:()=>dT,base32hexupper:()=>uT,base32pad:()=>aT,base32padupper:()=>cT,base32upper:()=>sT,base32z:()=>fT});var Te={};n.r(Te),n.d(Te,{base36:()=>pT,base36upper:()=>gT});var ke={};n.r(ke),n.d(ke,{base8:()=>yT});var Re={};n.r(Re),n.d(Re,{identity:()=>mT});var xe={};n.r(xe),n.d(xe,{code:()=>ET,decode:()=>ST,encode:()=>AT,name:()=>wT});var Pe={};n.r(Pe),n.d(Pe,{code:()=>IT,decode:()=>TT,encode:()=>CT,name:()=>_T});var De={};n.r(De),n.d(De,{base58btc:()=>Tk,base58flickr:()=>kk});var Oe={};n.r(Oe),n.d(Oe,{base10:()=>Rk});var Ne={};n.r(Ne),n.d(Ne,{base16:()=>xk,base16upper:()=>Pk});var Be={};n.r(Be),n.d(Be,{base2:()=>Dk});var Le={};n.r(Le),n.d(Le,{base256emoji:()=>Lk});var Me={};n.r(Me),n.d(Me,{base32:()=>Mk,base32hex:()=>jk,base32hexpad:()=>zk,base32hexpadupper:()=>Vk,base32hexupper:()=>Zk,base32pad:()=>Fk,base32padupper:()=>Kk,base32upper:()=>Uk,base32z:()=>Hk});var Ue={};n.r(Ue),n.d(Ue,{base36:()=>qk,base36upper:()=>Gk});var Fe={};n.r(Fe),n.d(Fe,{base64:()=>Wk,base64pad:()=>Qk,base64url:()=>Yk,base64urlpad:()=>Jk});var Ke={};n.r(Ke),n.d(Ke,{base8:()=>Xk});var je={};n.r(je),n.d(je,{identity:()=>$k});var Ze={};n.r(Ze),n.d(Ze,{code:()=>rR,decode:()=>oR,encode:()=>iR,name:()=>nR});var ze={};n.r(ze),n.d(ze,{code:()=>aR,decode:()=>lR,encode:()=>cR,name:()=>sR});var Ve={};n.r(Ve),n.d(Ve,{identity:()=>NR});var He={};n.r(He),n.d(He,{sha256:()=>UR,sha512:()=>FR});var qe={};n.r(qe),n.d(qe,{base58btc:()=>wP,base58flickr:()=>EP});var Ge={};n.r(Ge),n.d(Ge,{base10:()=>AP});var We={};n.r(We),n.d(We,{base16:()=>SP,base16upper:()=>_P});var Qe={};n.r(Qe),n.d(Qe,{base2:()=>IP});var Ye={};n.r(Ye),n.d(Ye,{base256emoji:()=>RP});var Je={};n.r(Je),n.d(Je,{base32:()=>xP,base32hex:()=>NP,base32hexpad:()=>LP,base32hexpadupper:()=>MP,base32hexupper:()=>BP,base32pad:()=>DP,base32padupper:()=>OP,base32upper:()=>PP,base32z:()=>UP});var Xe={};n.r(Xe),n.d(Xe,{base36:()=>FP,base36upper:()=>KP});var $e={};n.r($e),n.d($e,{base64:()=>jP,base64pad:()=>ZP,base64url:()=>zP,base64urlpad:()=>VP});var et={};n.r(et),n.d(et,{base8:()=>HP});var tt={};n.r(tt),n.d(tt,{identity:()=>qP});var nt={};n.r(nt),n.d(nt,{code:()=>YP,decode:()=>XP,encode:()=>JP,name:()=>QP});var rt={};n.r(rt),n.d(rt,{code:()=>eD,decode:()=>nD,encode:()=>tD,name:()=>$P});var it={};n.r(it),n.d(it,{identity:()=>TD});var ot={};n.r(ot),n.d(ot,{sha256:()=>PD,sha512:()=>DD});var st={};n.r(st),n.d(st,{base58btc:()=>FO,base58flickr:()=>KO});var at={};n.r(at),n.d(at,{base10:()=>jO});var ct={};n.r(ct),n.d(ct,{base16:()=>ZO,base16upper:()=>zO});var lt={};n.r(lt),n.d(lt,{base2:()=>VO});var ut={};n.r(ut),n.d(ut,{base256emoji:()=>WO});var ht={};n.r(ht),n.d(ht,{base32:()=>QO,base32hex:()=>$O,base32hexpad:()=>tN,base32hexpadupper:()=>nN,base32hexupper:()=>eN,base32pad:()=>JO,base32padupper:()=>XO,base32upper:()=>YO,base32z:()=>rN});var dt={};n.r(dt),n.d(dt,{base36:()=>iN,base36upper:()=>oN});var ft={};n.r(ft),n.d(ft,{base64:()=>sN,base64pad:()=>aN,base64url:()=>cN,base64urlpad:()=>lN});var pt={};n.r(pt),n.d(pt,{base8:()=>uN});var gt={};n.r(gt),n.d(gt,{identity:()=>hN});var yt={};n.r(yt),n.d(yt,{code:()=>gN,decode:()=>mN,encode:()=>yN,name:()=>pN});var mt={};n.r(mt),n.d(mt,{code:()=>bN,decode:()=>EN,encode:()=>wN,name:()=>vN});var vt={};n.r(vt),n.d(vt,{identity:()=>qN});var bt={};n.r(bt),n.d(bt,{sha256:()=>YN,sha512:()=>JN});var wt={};n.r(wt),n.d(wt,{Ed25519PrivateKey:()=>mM,Ed25519PublicKey:()=>yM,generateKeyPair:()=>wM,generateKeyPairFromSeed:()=>EM,unmarshalEd25519PrivateKey:()=>vM,unmarshalEd25519PublicKey:()=>bM});var Et={};n.r(Et),n.d(Et,{MAX_KEY_SIZE:()=>DM,RsaPrivateKey:()=>NM,RsaPublicKey:()=>OM,fromJwk:()=>MM,generateKeyPair:()=>UM,unmarshalRsaPrivateKey:()=>BM,unmarshalRsaPublicKey:()=>LM});var At={};n.r(At),n.d(At,{Secp256k1PrivateKey:()=>jM,Secp256k1PublicKey:()=>KM,generateKeyPair:()=>VM,unmarshalSecp256k1PrivateKey:()=>ZM,unmarshalSecp256k1PublicKey:()=>zM});var St={};n.r(St),n.d(St,{base58btc:()=>uK,base58flickr:()=>hK});var _t={};n.r(_t),n.d(_t,{identity:()=>LK});var It={};n.r(It),n.d(It,{sha256:()=>KK,sha512:()=>jK});var Ct={};n.r(Ct),n.d(Ct,{base64:()=>qK,base64pad:()=>GK,base64url:()=>WK,base64urlpad:()=>QK});var Tt={};n.r(Tt),n.d(Tt,{Ed25519PrivateKey:()=>ij,Ed25519PublicKey:()=>rj,generateKeyPair:()=>aj,generateKeyPairFromSeed:()=>cj,unmarshalEd25519PrivateKey:()=>oj,unmarshalEd25519PublicKey:()=>sj});var kt={};n.r(kt),n.d(kt,{MAX_KEY_SIZE:()=>bj,RsaPrivateKey:()=>Ej,RsaPublicKey:()=>wj,fromJwk:()=>_j,generateKeyPair:()=>Ij,unmarshalRsaPrivateKey:()=>Aj,unmarshalRsaPublicKey:()=>Sj});var Rt={};n.r(Rt),n.d(Rt,{Secp256k1PrivateKey:()=>kj,Secp256k1PublicKey:()=>Tj,generateKeyPair:()=>Pj,unmarshalSecp256k1PrivateKey:()=>Rj,unmarshalSecp256k1PublicKey:()=>xj});var xt={};n.r(xt),n.d(xt,{base10:()=>Lj});var Pt={};n.r(Pt),n.d(Pt,{base16:()=>Mj,base16upper:()=>Uj});var Dt={};n.r(Dt),n.d(Dt,{base2:()=>Fj});var Ot={};n.r(Ot),n.d(Ot,{base256emoji:()=>zj});var Nt={};n.r(Nt),n.d(Nt,{base32:()=>Vj,base32hex:()=>Wj,base32hexpad:()=>Yj,base32hexpadupper:()=>Jj,base32hexupper:()=>Qj,base32pad:()=>qj,base32padupper:()=>Gj,base32upper:()=>Hj,base32z:()=>Xj});var Bt={};n.r(Bt),n.d(Bt,{base36:()=>$j,base36upper:()=>eZ});var Lt={};n.r(Lt),n.d(Lt,{base8:()=>tZ});var Mt={};n.r(Mt),n.d(Mt,{identity:()=>nZ});var Ut={};n.r(Ut),n.d(Ut,{code:()=>sZ,decode:()=>cZ,encode:()=>aZ,name:()=>oZ});var Ft={};n.r(Ft),n.d(Ft,{code:()=>uZ,decode:()=>dZ,encode:()=>hZ,name:()=>lZ});var Kt={};n.r(Kt),n.d(Kt,{abortedError:()=>Az,closeFailedError:()=>yz,deleteFailedError:()=>bz,getFailedError:()=>vz,hasFailedError:()=>wz,notFoundError:()=>Ez,openFailedError:()=>gz,putFailedError:()=>mz});var jt={};n.r(jt),n.d(jt,{base32:()=>HV,base32hex:()=>QV,base32hexpad:()=>JV,base32hexpadupper:()=>XV,base32hexupper:()=>YV,base32pad:()=>GV,base32padupper:()=>WV,base32upper:()=>qV,base32z:()=>$V});var Zt={};n.r(Zt),n.d(Zt,{base58btc:()=>eH,base58flickr:()=>tH});var zt={};n.r(zt),n.d(zt,{base64:()=>nH,base64pad:()=>rH,base64url:()=>iH,base64urlpad:()=>oH});var Vt={};n.r(Vt),n.d(Vt,{sha256:()=>pq,sha512:()=>gq});var Ht={};n.r(Ht),n.d(Ht,{base36:()=>dQ,base36upper:()=>fQ});var qt={};n.r(qt),n.d(qt,{code:()=>bQ,decode:()=>EQ,encode:()=>wQ,name:()=>vQ});var Gt={};n.r(Gt),n.d(Gt,{code:()=>SQ,decode:()=>IQ,encode:()=>_Q,name:()=>AQ});var Wt={};n.r(Wt),n.d(Wt,{identity:()=>sY});var Qt={};n.r(Qt),n.d(Qt,{Ed25519PrivateKey:()=>TY,Ed25519PublicKey:()=>CY,generateKeyPair:()=>xY,generateKeyPairFromSeed:()=>PY,unmarshalEd25519PrivateKey:()=>kY,unmarshalEd25519PublicKey:()=>RY});var Yt={};n.r(Yt),n.d(Yt,{MAX_KEY_SIZE:()=>zY,RsaPrivateKey:()=>HY,RsaPublicKey:()=>VY,fromJwk:()=>WY,generateKeyPair:()=>QY,unmarshalRsaPrivateKey:()=>qY,unmarshalRsaPublicKey:()=>GY});var Jt={};n.r(Jt),n.d(Jt,{Secp256k1PrivateKey:()=>XY,Secp256k1PublicKey:()=>JY,generateKeyPair:()=>tJ,unmarshalSecp256k1PrivateKey:()=>$Y,unmarshalSecp256k1PublicKey:()=>eJ});var Xt={};n.r(Xt),n.d(Xt,{base58btc:()=>DJ,base58flickr:()=>OJ});var $t={};n.r($t),n.d($t,{identity:()=>iX});var en={};n.r(en),n.d(en,{sha256:()=>cX,sha512:()=>lX});var tn={};n.r(tn),n.d(tn,{base64:()=>pX,base64pad:()=>gX,base64url:()=>yX,base64urlpad:()=>mX});var nn={};n.r(nn),n.d(nn,{Ed25519PrivateKey:()=>CX,Ed25519PublicKey:()=>IX,generateKeyPair:()=>RX,generateKeyPairFromSeed:()=>xX,unmarshalEd25519PrivateKey:()=>TX,unmarshalEd25519PublicKey:()=>kX});var rn={};n.r(rn),n.d(rn,{MAX_KEY_SIZE:()=>ZX,RsaPrivateKey:()=>VX,RsaPublicKey:()=>zX,fromJwk:()=>GX,generateKeyPair:()=>WX,unmarshalRsaPrivateKey:()=>HX,unmarshalRsaPublicKey:()=>qX});var on={};n.r(on),n.d(on,{Secp256k1PrivateKey:()=>JX,Secp256k1PublicKey:()=>YX,generateKeyPair:()=>e$,unmarshalSecp256k1PrivateKey:()=>XX,unmarshalSecp256k1PublicKey:()=>$X});var sn={};n.r(sn),n.d(sn,{base32:()=>u$,base32hex:()=>p$,base32hexpad:()=>y$,base32hexpadupper:()=>m$,base32hexupper:()=>g$,base32pad:()=>d$,base32padupper:()=>f$,base32upper:()=>h$,base32z:()=>v$});var an={};n.r(an),n.d(an,{base10:()=>E$});var cn={};n.r(cn),n.d(cn,{base16:()=>A$,base16upper:()=>S$});var ln={};n.r(ln),n.d(ln,{base2:()=>_$});var un={};n.r(un),n.d(un,{base256emoji:()=>k$});var hn={};n.r(hn),n.d(hn,{base36:()=>R$,base36upper:()=>x$});var dn={};n.r(dn),n.d(dn,{base8:()=>P$});var fn={};n.r(fn),n.d(fn,{identity:()=>D$});var pn={};n.r(pn),n.d(pn,{code:()=>L$,decode:()=>U$,encode:()=>M$,name:()=>B$});var gn={};n.r(gn),n.d(gn,{code:()=>K$,decode:()=>Z$,encode:()=>j$,name:()=>F$});var yn={};n.r(yn),n.d(yn,{base10:()=>D0});var mn={};n.r(mn),n.d(mn,{base16:()=>O0,base16upper:()=>N0});var vn={};n.r(vn),n.d(vn,{base2:()=>B0});var bn={};n.r(bn),n.d(bn,{base256emoji:()=>F0});var wn={};n.r(wn),n.d(wn,{base8:()=>K0});var En={};n.r(En),n.d(En,{identity:()=>j0});var An={};n.r(An),n.d(An,{base58btc:()=>f1,base58flickr:()=>p1});var Sn={};n.r(Sn),n.d(Sn,{base10:()=>g1});var _n={};n.r(_n),n.d(_n,{base16:()=>y1,base16upper:()=>m1});var In={};n.r(In),n.d(In,{base2:()=>v1});var Cn={};n.r(Cn),n.d(Cn,{base256emoji:()=>A1});var Tn={};n.r(Tn),n.d(Tn,{base32:()=>S1,base32hex:()=>T1,base32hexpad:()=>R1,base32hexpadupper:()=>x1,base32hexupper:()=>k1,base32pad:()=>I1,base32padupper:()=>C1,base32upper:()=>_1,base32z:()=>P1});var kn={};n.r(kn),n.d(kn,{base36:()=>D1,base36upper:()=>O1});var Rn={};n.r(Rn),n.d(Rn,{base64:()=>N1,base64pad:()=>B1,base64url:()=>L1,base64urlpad:()=>M1});var xn={};n.r(xn),n.d(xn,{base8:()=>U1});var Pn={};n.r(Pn),n.d(Pn,{identity:()=>F1});var Dn={};n.r(Dn),n.d(Dn,{code:()=>z1,decode:()=>H1,encode:()=>V1,name:()=>Z1});var On={};n.r(On),n.d(On,{code:()=>G1,decode:()=>Q1,encode:()=>W1,name:()=>q1});var Nn={};n.r(Nn),n.d(Nn,{identity:()=>w2});var Bn={};n.r(Bn),n.d(Bn,{sha256:()=>_2,sha512:()=>I2});var Ln={};n.r(Ln),n.d(Ln,{base32:()=>L4,base32hex:()=>K4,base32hexpad:()=>Z4,base32hexpadupper:()=>z4,base32hexupper:()=>j4,base32pad:()=>U4,base32padupper:()=>F4,base32upper:()=>M4,base32z:()=>V4});var Mn={};n.r(Mn),n.d(Mn,{base58btc:()=>H4,base58flickr:()=>q4});var Un={};n.r(Un),n.d(Un,{base64:()=>G4,base64pad:()=>W4,base64url:()=>Q4,base64urlpad:()=>Y4});var Fn={};n.r(Fn),n.d(Fn,{base10:()=>i6});var Kn={};n.r(Kn),n.d(Kn,{base16:()=>o6,base16upper:()=>s6});var jn={};n.r(jn),n.d(jn,{base2:()=>a6});var Zn={};n.r(Zn),n.d(Zn,{base256emoji:()=>h6});var zn={};n.r(zn),n.d(zn,{base36:()=>d6,base36upper:()=>f6});var Vn={};n.r(Vn),n.d(Vn,{base8:()=>p6});var Hn={};n.r(Hn),n.d(Hn,{identity:()=>g6});var qn={};n.r(qn),n.d(qn,{code:()=>b6,decode:()=>E6,encode:()=>w6,name:()=>v6});var Gn={};n.r(Gn),n.d(Gn,{code:()=>S6,decode:()=>I6,encode:()=>_6,name:()=>A6});var Wn={};n.r(Wn),n.d(Wn,{identity:()=>Y6});var Qn={};n.r(Qn),n.d(Qn,{sha256:()=>e8,sha512:()=>t8});var Yn={};n.r(Yn),n.d(Yn,{Ed25519PrivateKey:()=>X7,Ed25519PublicKey:()=>J7,generateKeyPair:()=>t9,generateKeyPairFromSeed:()=>n9,unmarshalEd25519PrivateKey:()=>$7,unmarshalEd25519PublicKey:()=>e9});var Jn={};n.r(Jn),n.d(Jn,{MAX_KEY_SIZE:()=>p9,RsaPrivateKey:()=>y9,RsaPublicKey:()=>g9,fromJwk:()=>b9,generateKeyPair:()=>w9,unmarshalRsaPrivateKey:()=>m9,unmarshalRsaPublicKey:()=>v9});var Xn={};n.r(Xn),n.d(Xn,{Secp256k1PrivateKey:()=>S9,Secp256k1PublicKey:()=>A9,generateKeyPair:()=>C9,unmarshalSecp256k1PrivateKey:()=>_9,unmarshalSecp256k1PublicKey:()=>I9});var $n={};n.r($n),n.d($n,{base58btc:()=>W9,base58flickr:()=>Q9});var er={};n.r(er),n.d(er,{identity:()=>vee});var tr={};n.r(tr),n.d(tr,{sha256:()=>Aee,sha512:()=>See});var nr={};n.r(nr),n.d(nr,{base64:()=>Pee,base64pad:()=>Dee,base64url:()=>Oee,base64urlpad:()=>Nee});var rr={};n.r(rr),n.d(rr,{Ed25519PrivateKey:()=>Zee,Ed25519PublicKey:()=>jee,generateKeyPair:()=>Hee,generateKeyPairFromSeed:()=>qee,unmarshalEd25519PrivateKey:()=>zee,unmarshalEd25519PublicKey:()=>Vee});var ir={};n.r(ir),n.d(ir,{MAX_KEY_SIZE:()=>tte,RsaPrivateKey:()=>rte,RsaPublicKey:()=>nte,fromJwk:()=>ste,generateKeyPair:()=>ate,unmarshalRsaPrivateKey:()=>ite,unmarshalRsaPublicKey:()=>ote});var or={};n.r(or),n.d(or,{Secp256k1PrivateKey:()=>ute,Secp256k1PublicKey:()=>lte,generateKeyPair:()=>fte,unmarshalSecp256k1PrivateKey:()=>hte,unmarshalSecp256k1PublicKey:()=>dte});var sr={};n.r(sr),n.d(sr,{base10:()=>pte});var ar={};n.r(ar),n.d(ar,{base16:()=>gte,base16upper:()=>yte});var cr={};n.r(cr),n.d(cr,{base2:()=>mte});var lr={};n.r(lr),n.d(lr,{base256emoji:()=>Ete});var ur={};n.r(ur),n.d(ur,{base32:()=>Ate,base32hex:()=>Cte,base32hexpad:()=>kte,base32hexpadupper:()=>Rte,base32hexupper:()=>Tte,base32pad:()=>_te,base32padupper:()=>Ite,base32upper:()=>Ste,base32z:()=>xte});var hr={};n.r(hr),n.d(hr,{base36:()=>Pte,base36upper:()=>Dte});var dr={};n.r(dr),n.d(dr,{base8:()=>Ote});var fr={};n.r(fr),n.d(fr,{identity:()=>Nte});var pr={};n.r(pr),n.d(pr,{code:()=>Ute,decode:()=>Kte,encode:()=>Fte,name:()=>Mte});var gr={};n.r(gr),n.d(gr,{code:()=>Zte,decode:()=>Vte,encode:()=>zte,name:()=>jte});var yr={};n.r(yr),n.d(yr,{base32:()=>mre,base32hex:()=>Ere,base32hexpad:()=>Sre,base32hexpadupper:()=>_re,base32hexupper:()=>Are,base32pad:()=>bre,base32padupper:()=>wre,base32upper:()=>vre,base32z:()=>Ire});var mr={};n.r(mr),n.d(mr,{base58btc:()=>Cre,base58flickr:()=>Tre});var vr={};n.r(vr),n.d(vr,{base64:()=>kre,base64pad:()=>Rre,base64url:()=>xre,base64urlpad:()=>Pre});var br={};n.r(br),n.d(br,{base10:()=>Ure});var wr={};n.r(wr),n.d(wr,{base16:()=>Fre,base16upper:()=>Kre});var Er={};n.r(Er),n.d(Er,{base2:()=>jre});var Ar={};n.r(Ar),n.d(Ar,{base256emoji:()=>Hre});var Sr={};n.r(Sr),n.d(Sr,{base36:()=>qre,base36upper:()=>Gre});var _r={};n.r(_r),n.d(_r,{base8:()=>Wre});var Ir={};n.r(Ir),n.d(Ir,{identity:()=>Qre});var Cr={};n.r(Cr),n.d(Cr,{code:()=>$re,decode:()=>tie,encode:()=>eie,name:()=>Xre});var Tr={};n.r(Tr),n.d(Tr,{code:()=>rie,decode:()=>oie,encode:()=>iie,name:()=>nie});var kr={};n.r(kr),n.d(kr,{identity:()=>xie});var Rr={};n.r(Rr),n.d(Rr,{sha256:()=>Nie,sha512:()=>Bie});var xr={};n.r(xr),n.d(xr,{base32:()=>Doe,base32hex:()=>Loe,base32hexpad:()=>Uoe,base32hexpadupper:()=>Foe,base32hexupper:()=>Moe,base32pad:()=>Noe,base32padupper:()=>Boe,base32upper:()=>Ooe,base32z:()=>Koe});var Pr={};n.r(Pr),n.d(Pr,{base58btc:()=>joe,base58flickr:()=>Zoe});var Dr={};n.r(Dr),n.d(Dr,{base64:()=>zoe,base64pad:()=>Voe,base64url:()=>Hoe,base64urlpad:()=>qoe});var Or={};n.r(Or),n.d(Or,{base10:()=>wse});var Nr={};n.r(Nr),n.d(Nr,{base16:()=>Ese,base16upper:()=>Ase});var Br={};n.r(Br),n.d(Br,{base2:()=>Sse});var Lr={};n.r(Lr),n.d(Lr,{base256emoji:()=>Tse});var Mr={};n.r(Mr),n.d(Mr,{base36:()=>kse,base36upper:()=>Rse});var Ur={};n.r(Ur),n.d(Ur,{base8:()=>xse});var Fr={};n.r(Fr),n.d(Fr,{identity:()=>Pse});var Kr={};n.r(Kr),n.d(Kr,{code:()=>Bse,decode:()=>Mse,encode:()=>Lse,name:()=>Nse});var jr={};n.r(jr),n.d(jr,{code:()=>Fse,decode:()=>jse,encode:()=>Kse,name:()=>Use});var Zr={};n.r(Zr),n.d(Zr,{identity:()=>dae});var zr={};n.r(zr),n.d(zr,{sha256:()=>yae,sha512:()=>mae});var Vr={};n.r(Vr),n.d(Vr,{Ed25519PrivateKey:()=>zce,Ed25519PublicKey:()=>Zce,generateKeyPair:()=>qce,generateKeyPairFromSeed:()=>Gce,unmarshalEd25519PrivateKey:()=>Vce,unmarshalEd25519PublicKey:()=>Hce});var Hr={};n.r(Hr),n.d(Hr,{MAX_KEY_SIZE:()=>sle,RsaPrivateKey:()=>cle,RsaPublicKey:()=>ale,fromJwk:()=>hle,generateKeyPair:()=>dle,unmarshalRsaPrivateKey:()=>lle,unmarshalRsaPublicKey:()=>ule});var qr={};n.r(qr),n.d(qr,{Secp256k1PrivateKey:()=>gle,Secp256k1PublicKey:()=>ple,generateKeyPair:()=>vle,unmarshalSecp256k1PrivateKey:()=>yle,unmarshalSecp256k1PublicKey:()=>mle});var Gr=n(40791),Wr=n(99491),Qr=n(19264),Yr=n(48236);async function Jr(e){let t;switch(t="string"===typeof e?e:(0,Yr.Z)(e),t){case"dag-cbor":return Promise.resolve().then(n.bind(n,839));case"dag-pb":return Promise.resolve().then(n.bind(n,20099));case"git-raw":throw new Error("git-raw is unsupported until https://github.com/ipld/js-ipld-git is updated.");case"raw":return Promise.resolve().then(n.bind(n,57203));case"json":return Promise.resolve().then(n.bind(n,22171));case"dag-json":return Promise.resolve().then(n.bind(n,1315));case"dag-jose":return n.e(259).then(n.bind(n,79259));default:throw new Error("unsupported codec: ".concat(e,"=").concat(t))}}var Xr=n(14824);function $r(e){return e.startsWith("/")?e:"/".concat(e)}async function ei(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:18;const i=await Jr(t),o=await(0,Xr.C)(r),s=i.encode(n),a=await o.digest(s),c=Qr.CID.createV1(i.code,a);return e.blockstore.put(c,s)}var ti=n(839),ni=n(44253),ri=n(74561),ii=n.n(ri);const oi={SHA2_256:18,LENGTH:32,DAG_PB:112},si=40;function ai(e,t){if(!e.length)throw new Error("Unexpected end of data");const n=ii().decode(e);return t.seek(ii().decode.bytes),n}const ci={Null:e=>null===e?e:void 0,Int:e=>Number.isInteger(e)?e:void 0,Float:e=>"number"===typeof e&&Number.isFinite(e)?e:void 0,String:e=>"string"===typeof e?e:void 0,Bool:e=>"boolean"===typeof e?e:void 0,Bytes:e=>e instanceof Uint8Array?e:void 0,Link:e=>null!==e&&"object"===typeof e&&e.asCID===e?e:void 0,List:e=>Array.isArray(e)?e:void 0,Map:e=>null===e||"object"!==typeof e||e.asCID===e||Array.isArray(e)||e instanceof Uint8Array?void 0:e},li={"CarV1HeaderOrV2Pragma > roots (anon) > valueType (anon)":ci.Link,"CarV1HeaderOrV2Pragma > roots (anon)":e=>{if(void 0!==ci.List(e)){for(let t=0;t<e.length;t++){let n=e[t];if(n=li["CarV1HeaderOrV2Pragma > roots (anon) > valueType (anon)"](n),void 0===n)return;if(n!==e[t]){const n=e.slice(0,t);for(let r=t;r<e.length;r++){let t=e[r];if(t=li["CarV1HeaderOrV2Pragma > roots (anon) > valueType (anon)"](t),void 0===t)return;n.push(t)}return n}}return e}},Int:ci.Int,CarV1HeaderOrV2Pragma:e=>{if(void 0===ci.Map(e))return;const t=Object.entries(e);let n=e,r=1;for(let i=0;i<t.length;i++){const[o,s]=t[i];switch(o){case"roots":{const r=li["CarV1HeaderOrV2Pragma > roots (anon)"](e[o]);if(void 0===r)return;if(r!==s||n!==e){if(n===e){n={};for(let e=0;e<i;e++)n[t[e][0]]=t[e][1]}n.roots=r}}break;case"version":{r--;const a=li.Int(e[o]);if(void 0===a)return;if(a!==s||n!==e){if(n===e){n={};for(let e=0;e<i;e++)n[t[e][0]]=t[e][1]}n.version=a}}break;default:return}}return r>0?void 0:n}},ui={"CarV1HeaderOrV2Pragma > roots (anon) > valueType (anon)":ci.Link,"CarV1HeaderOrV2Pragma > roots (anon)":e=>{if(void 0!==ci.List(e)){for(let t=0;t<e.length;t++){let n=e[t];if(n=ui["CarV1HeaderOrV2Pragma > roots (anon) > valueType (anon)"](n),void 0===n)return;if(n!==e[t]){const n=e.slice(0,t);for(let r=t;r<e.length;r++){let t=e[r];if(t=ui["CarV1HeaderOrV2Pragma > roots (anon) > valueType (anon)"](t),void 0===t)return;n.push(t)}return n}}return e}},Int:ci.Int,CarV1HeaderOrV2Pragma:e=>{if(void 0===ci.Map(e))return;const t=Object.entries(e);let n=e,r=1;for(let i=0;i<t.length;i++){const[o,s]=t[i];switch(o){case"roots":{const r=ui["CarV1HeaderOrV2Pragma > roots (anon)"](s);if(void 0===r)return;if(r!==s||n!==e){if(n===e){n={};for(let e=0;e<i;e++)n[t[e][0]]=t[e][1]}n.roots=r}}break;case"version":{r--;const o=ui.Int(s);if(void 0===o)return;if(o!==s||n!==e){if(n===e){n={};for(let e=0;e<i;e++)n[t[e][0]]=t[e][1]}n.version=o}}break;default:return}}return r>0?void 0:n}},hi={toTyped:li.CarV1HeaderOrV2Pragma,toRepresentation:ui.CarV1HeaderOrV2Pragma};const di=["string","number","bigint","symbol"],fi=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function pi(e){if(null===e)return"null";if(void 0===e)return"undefined";if(!0===e||!1===e)return"boolean";const t=typeof e;if(di.includes(t))return t;if("function"===t)return"Function";if(Array.isArray(e))return"Array";if(function(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}(e))return"Buffer";const n=function(e){const t=Object.prototype.toString.call(e).slice(8,-1);if(fi.includes(t))return t;return}(e);return n||"Object"}class gi{constructor(e,t,n){this.major=e,this.majorEncoded=e<<5,this.name=t,this.terminal=n}toString(){return"Type[".concat(this.major,"].").concat(this.name)}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}}gi.uint=new gi(0,"uint",!0),gi.negint=new gi(1,"negint",!0),gi.bytes=new gi(2,"bytes",!0),gi.string=new gi(3,"string",!0),gi.array=new gi(4,"array",!1),gi.map=new gi(5,"map",!1),gi.tag=new gi(6,"tag",!1),gi.float=new gi(7,"float",!0),gi.false=new gi(7,"false",!0),gi.true=new gi(7,"true",!0),gi.null=new gi(7,"null",!0),gi.undefined=new gi(7,"undefined",!0),gi.break=new gi(7,"break",!0);class yi{constructor(e,t,n){this.type=e,this.value=t,this.encodedLength=n,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return"Token[".concat(this.type,"].").concat(this.value)}}const mi=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&"function"===typeof globalThis.Buffer.isBuffer,vi=new TextDecoder,bi=new TextEncoder;function wi(e){return mi&&globalThis.Buffer.isBuffer(e)}const Ei=mi?(e,t,n)=>n-t>64?globalThis.Buffer.from(e.subarray(t,n)).toString("utf8"):Ti(e,t,n):(e,t,n)=>n-t>64?vi.decode(e.subarray(t,n)):Ti(e,t,n),Ai=mi?e=>e.length>64?globalThis.Buffer.from(e):Ci(e):e=>e.length>64?bi.encode(e):Ci(e),Si=mi?(e,t,n)=>wi(e)?new Uint8Array(e.subarray(t,n)):e.slice(t,n):(e,t,n)=>e.slice(t,n),_i=mi?(e,t)=>(e=e.map((e=>e instanceof Uint8Array?e:globalThis.Buffer.from(e))),function(e){return e instanceof Uint8Array?wi(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e:Uint8Array.from(e)}(globalThis.Buffer.concat(e,t))):(e,t)=>{const n=new Uint8Array(t);let r=0;for(let i of e)r+i.length>n.length&&(i=i.subarray(0,n.length-r)),n.set(i,r),r+=i.length;return n},Ii=mi?e=>globalThis.Buffer.allocUnsafe(e):e=>new Uint8Array(e);function Ci(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t}function Ti(e,t,n){const r=[];for(;t<n;){const i=e[t];let o=null,s=i>239?4:i>223?3:i>191?2:1;if(t+s<=n){let n,r,a,c;switch(s){case 1:i<128&&(o=i);break;case 2:n=e[t+1],128===(192&n)&&(c=(31&i)<<6|63&n,c>127&&(o=c));break;case 3:n=e[t+1],r=e[t+2],128===(192&n)&&128===(192&r)&&(c=(15&i)<<12|(63&n)<<6|63&r,c>2047&&(c<55296||c>57343)&&(o=c));break;case 4:n=e[t+1],r=e[t+2],a=e[t+3],128===(192&n)&&128===(192&r)&&128===(192&a)&&(c=(15&i)<<18|(63&n)<<12|(63&r)<<6|63&a,c>65535&&c<1114112&&(o=c))}}null===o?(o=65533,s=1):o>65535&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|1023&o),r.push(o),t+=s}return function(e){const t=e.length;if(t<=ki)return String.fromCharCode.apply(String,e);let n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=ki));return n}(r)}const ki=4096;const Ri="CBOR decode error:",xi="CBOR encode error:",Pi=[];function Di(e,t,n){if(e.length-t<n)throw new Error("".concat(Ri," not enough data for type"))}Pi[23]=1,Pi[24]=2,Pi[25]=3,Pi[26]=5,Pi[27]=9;const Oi=[24,256,65536,4294967296,BigInt("18446744073709551616")];function Ni(e,t,n){Di(e,t,1);const r=e[t];if(!0===n.strict&&r<Oi[0])throw new Error("".concat(Ri," integer encoded in more bytes than necessary (strict decode)"));return r}function Bi(e,t,n){Di(e,t,2);const r=e[t]<<8|e[t+1];if(!0===n.strict&&r<Oi[1])throw new Error("".concat(Ri," integer encoded in more bytes than necessary (strict decode)"));return r}function Li(e,t,n){Di(e,t,4);const r=16777216*e[t]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];if(!0===n.strict&&r<Oi[2])throw new Error("".concat(Ri," integer encoded in more bytes than necessary (strict decode)"));return r}function Mi(e,t,n){Di(e,t,8);const r=16777216*e[t]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3],i=16777216*e[t+4]+(e[t+5]<<16)+(e[t+6]<<8)+e[t+7],o=(BigInt(r)<<BigInt(32))+BigInt(i);if(!0===n.strict&&o<Oi[3])throw new Error("".concat(Ri," integer encoded in more bytes than necessary (strict decode)"));if(o<=Number.MAX_SAFE_INTEGER)return Number(o);if(!0===n.allowBigInt)return o;throw new Error("".concat(Ri," integers outside of the safe integer range are not supported"))}function Ui(e,t){return Fi(e,0,t.value)}function Fi(e,t,n){if(n<Oi[0]){const r=Number(n);e.push([t|r])}else if(n<Oi[1]){const r=Number(n);e.push([24|t,r])}else if(n<Oi[2]){const r=Number(n);e.push([25|t,r>>>8,255&r])}else if(n<Oi[3]){const r=Number(n);e.push([26|t,r>>>24&255,r>>>16&255,r>>>8&255,255&r])}else{const r=BigInt(n);if(!(r<Oi[4]))throw new Error("".concat(Ri," encountered BigInt larger than allowable range"));{const n=[27|t,0,0,0,0,0,0,0];let i=Number(r&BigInt(4294967295)),o=Number(r>>BigInt(32)&BigInt(4294967295));n[8]=255&i,i>>=8,n[7]=255&i,i>>=8,n[6]=255&i,i>>=8,n[5]=255&i,n[4]=255&o,o>>=8,n[3]=255&o,o>>=8,n[2]=255&o,o>>=8,n[1]=255&o,e.push(n)}}}Ui.encodedSize=function(e){return Fi.encodedSize(e.value)},Fi.encodedSize=function(e){return e<Oi[0]?1:e<Oi[1]?2:e<Oi[2]?3:e<Oi[3]?5:9},Ui.compareTokens=function(e,t){return e.value<t.value?-1:e.value>t.value?1:0};const Ki=BigInt(-1),ji=BigInt(1);function Zi(e,t){const n=t.value,r="bigint"===typeof n?n*Ki-ji:-1*n-1;Fi(e,t.type.majorEncoded,r)}function zi(e,t,n,r){Di(e,t,n+r);const i=Si(e,t+n,t+n+r);return new yi(gi.bytes,i,n+r)}function Vi(e,t,n,r){return zi(e,t,1,n)}function Hi(e){return void 0===e.encodedBytes&&(e.encodedBytes=e.type===gi.string?Ai(e.value):e.value),e.encodedBytes}function qi(e,t){const n=Hi(t);Fi(e,t.type.majorEncoded,n.length),e.push(n)}function Gi(e,t,n,r,i){const o=n+r;Di(e,t,o);const s=new yi(gi.string,Ei(e,t+n,t+o),o);return!0===i.retainStringBytes&&(s.byteValue=Si(e,t+n,t+o)),s}function Wi(e,t,n,r){return Gi(e,t,1,n,r)}Zi.encodedSize=function(e){const t=e.value,n="bigint"===typeof t?t*Ki-ji:-1*t-1;return n<Oi[0]?1:n<Oi[1]?2:n<Oi[2]?3:n<Oi[3]?5:9},Zi.compareTokens=function(e,t){return e.value<t.value?1:e.value>t.value?-1:0},qi.encodedSize=function(e){const t=Hi(e);return Fi.encodedSize(t.length)+t.length},qi.compareTokens=function(e,t){return n=Hi(e),r=Hi(t),n.length<r.length?-1:n.length>r.length?1:function(e,t){if(wi(e)&&wi(t))return e.compare(t);for(let n=0;n<e.length;n++)if(e[n]!==t[n])return e[n]<t[n]?-1:1;return 0}(n,r);var n,r};const Qi=qi;function Yi(e,t,n,r){return new yi(gi.array,r,n)}function Ji(e,t,n,r){return Yi(0,0,1,n)}function Xi(e,t){Fi(e,gi.array.majorEncoded,t.value)}function $i(e,t,n,r){return new yi(gi.map,r,n)}function eo(e,t,n,r){return $i(0,0,1,n)}function to(e,t){Fi(e,gi.map.majorEncoded,t.value)}function no(e,t,n,r){return new yi(gi.tag,n,1)}function ro(e,t){Fi(e,gi.tag.majorEncoded,t.value)}Xi.compareTokens=Ui.compareTokens,Xi.encodedSize=function(e){return Fi.encodedSize(e.value)},to.compareTokens=Ui.compareTokens,to.encodedSize=function(e){return Fi.encodedSize(e.value)},ro.compareTokens=Ui.compareTokens,ro.encodedSize=function(e){return Fi.encodedSize(e.value)};const io=20,oo=21,so=22,ao=23;function co(e,t,n){if(n){if(!1===n.allowNaN&&Number.isNaN(e))throw new Error("".concat(Ri," NaN values are not supported"));if(!1===n.allowInfinity&&(e===1/0||e===-1/0))throw new Error("".concat(Ri," Infinity values are not supported"))}return new yi(gi.float,e,t)}function lo(e,t,n){const r=t.value;if(!1===r)e.push([gi.float.majorEncoded|io]);else if(!0===r)e.push([gi.float.majorEncoded|oo]);else if(null===r)e.push([gi.float.majorEncoded|so]);else if(void 0===r)e.push([gi.float.majorEncoded|ao]);else{let t,o=!1;n&&!0===n.float64||(po(r),t=go(fo,1),r===t||Number.isNaN(r)?(fo[0]=249,e.push(fo.slice(0,3)),o=!0):(yo(r),t=mo(fo,1),r===t&&(fo[0]=250,e.push(fo.slice(0,5)),o=!0))),o||(i=r,ho.setFloat64(0,i,!1),t=vo(fo,1),fo[0]=251,e.push(fo.slice(0,9)))}var i}lo.encodedSize=function(e,t){const n=e.value;if(!1===n||!0===n||null===n||void 0===n)return 1;if(!t||!0!==t.float64){po(n);let e=go(fo,1);if(n===e||Number.isNaN(n))return 3;if(yo(n),e=mo(fo,1),n===e)return 5}return 9};const uo=new ArrayBuffer(9),ho=new DataView(uo,1),fo=new Uint8Array(uo,0);function po(e){if(e===1/0)ho.setUint16(0,31744,!1);else if(e===-1/0)ho.setUint16(0,64512,!1);else if(Number.isNaN(e))ho.setUint16(0,32256,!1);else{ho.setFloat32(0,e);const t=ho.getUint32(0),n=(2139095040&t)>>23,r=8388607&t;if(255===n)ho.setUint16(0,31744,!1);else if(0===n)ho.setUint16(0,(2147483648&e)>>16|r>>13,!1);else{const e=n-127;e<-24?ho.setUint16(0,0):e<-14?ho.setUint16(0,(2147483648&t)>>16|1<<24+e,!1):ho.setUint16(0,(2147483648&t)>>16|e+15<<10|r>>13,!1)}}}function go(e,t){if(e.length-t<2)throw new Error("".concat(Ri," not enough data for float16"));const n=(e[t]<<8)+e[t+1];if(31744===n)return 1/0;if(64512===n)return-1/0;if(32256===n)return NaN;const r=n>>10&31,i=1023&n;let o;return o=0===r?i*2**-24:31!==r?(i+1024)*2**(r-25):0===i?1/0:NaN,32768&n?-o:o}function yo(e){ho.setFloat32(0,e,!1)}function mo(e,t){if(e.length-t<4)throw new Error("".concat(Ri," not enough data for float32"));const n=(e.byteOffset||0)+t;return new DataView(e.buffer,n,4).getFloat32(0,!1)}function vo(e,t){if(e.length-t<8)throw new Error("".concat(Ri," not enough data for float64"));const n=(e.byteOffset||0)+t;return new DataView(e.buffer,n,8).getFloat64(0,!1)}function bo(e,t,n){throw new Error("".concat(Ri," encountered invalid minor (").concat(n,") for major ").concat(e[t]>>>5))}function wo(e){return()=>{throw new Error("".concat(Ri," ").concat(e))}}lo.compareTokens=Ui.compareTokens;const Eo=[];for(let Ige=0;Ige<=23;Ige++)Eo[Ige]=bo;Eo[24]=function(e,t,n,r){return new yi(gi.uint,Ni(e,t+1,r),2)},Eo[25]=function(e,t,n,r){return new yi(gi.uint,Bi(e,t+1,r),3)},Eo[26]=function(e,t,n,r){return new yi(gi.uint,Li(e,t+1,r),5)},Eo[27]=function(e,t,n,r){return new yi(gi.uint,Mi(e,t+1,r),9)},Eo[28]=bo,Eo[29]=bo,Eo[30]=bo,Eo[31]=bo;for(let Ige=32;Ige<=55;Ige++)Eo[Ige]=bo;Eo[56]=function(e,t,n,r){return new yi(gi.negint,-1-Ni(e,t+1,r),2)},Eo[57]=function(e,t,n,r){return new yi(gi.negint,-1-Bi(e,t+1,r),3)},Eo[58]=function(e,t,n,r){return new yi(gi.negint,-1-Li(e,t+1,r),5)},Eo[59]=function(e,t,n,r){const i=Mi(e,t+1,r);if("bigint"!==typeof i){const e=-1-i;if(e>=Number.MIN_SAFE_INTEGER)return new yi(gi.negint,e,9)}if(!0!==r.allowBigInt)throw new Error("".concat(Ri," integers outside of the safe integer range are not supported"));return new yi(gi.negint,Ki-BigInt(i),9)},Eo[60]=bo,Eo[61]=bo,Eo[62]=bo,Eo[63]=bo;for(let Ige=64;Ige<=87;Ige++)Eo[Ige]=Vi;Eo[88]=function(e,t,n,r){return zi(e,t,2,Ni(e,t+1,r))},Eo[89]=function(e,t,n,r){return zi(e,t,3,Bi(e,t+1,r))},Eo[90]=function(e,t,n,r){return zi(e,t,5,Li(e,t+1,r))},Eo[91]=function(e,t,n,r){const i=Mi(e,t+1,r);if("bigint"===typeof i)throw new Error("".concat(Ri," 64-bit integer bytes lengths not supported"));return zi(e,t,9,i)},Eo[92]=bo,Eo[93]=bo,Eo[94]=bo,Eo[95]=wo("indefinite length bytes/strings are not supported");for(let Ige=96;Ige<=119;Ige++)Eo[Ige]=Wi;Eo[120]=function(e,t,n,r){return Gi(e,t,2,Ni(e,t+1,r),r)},Eo[121]=function(e,t,n,r){return Gi(e,t,3,Bi(e,t+1,r),r)},Eo[122]=function(e,t,n,r){return Gi(e,t,5,Li(e,t+1,r),r)},Eo[123]=function(e,t,n,r){const i=Mi(e,t+1,r);if("bigint"===typeof i)throw new Error("".concat(Ri," 64-bit integer string lengths not supported"));return Gi(e,t,9,i,r)},Eo[124]=bo,Eo[125]=bo,Eo[126]=bo,Eo[127]=wo("indefinite length bytes/strings are not supported");for(let Ige=128;Ige<=151;Ige++)Eo[Ige]=Ji;Eo[152]=function(e,t,n,r){return Yi(0,0,2,Ni(e,t+1,r))},Eo[153]=function(e,t,n,r){return Yi(0,0,3,Bi(e,t+1,r))},Eo[154]=function(e,t,n,r){return Yi(0,0,5,Li(e,t+1,r))},Eo[155]=function(e,t,n,r){const i=Mi(e,t+1,r);if("bigint"===typeof i)throw new Error("".concat(Ri," 64-bit integer array lengths not supported"));return Yi(0,0,9,i)},Eo[156]=bo,Eo[157]=bo,Eo[158]=bo,Eo[159]=function(e,t,n,r){if(!1===r.allowIndefinite)throw new Error("".concat(Ri," indefinite length items not allowed"));return Yi(0,0,1,1/0)};for(let Ige=160;Ige<=183;Ige++)Eo[Ige]=eo;Eo[184]=function(e,t,n,r){return $i(0,0,2,Ni(e,t+1,r))},Eo[185]=function(e,t,n,r){return $i(0,0,3,Bi(e,t+1,r))},Eo[186]=function(e,t,n,r){return $i(0,0,5,Li(e,t+1,r))},Eo[187]=function(e,t,n,r){const i=Mi(e,t+1,r);if("bigint"===typeof i)throw new Error("".concat(Ri," 64-bit integer map lengths not supported"));return $i(0,0,9,i)},Eo[188]=bo,Eo[189]=bo,Eo[190]=bo,Eo[191]=function(e,t,n,r){if(!1===r.allowIndefinite)throw new Error("".concat(Ri," indefinite length items not allowed"));return $i(0,0,1,1/0)};for(let Ige=192;Ige<=215;Ige++)Eo[Ige]=no;Eo[216]=function(e,t,n,r){return new yi(gi.tag,Ni(e,t+1,r),2)},Eo[217]=function(e,t,n,r){return new yi(gi.tag,Bi(e,t+1,r),3)},Eo[218]=function(e,t,n,r){return new yi(gi.tag,Li(e,t+1,r),5)},Eo[219]=function(e,t,n,r){return new yi(gi.tag,Mi(e,t+1,r),9)},Eo[220]=bo,Eo[221]=bo,Eo[222]=bo,Eo[223]=bo;for(let Ige=224;Ige<=243;Ige++)Eo[Ige]=wo("simple values are not supported");Eo[244]=bo,Eo[245]=bo,Eo[246]=bo,Eo[247]=function(e,t,n,r){if(!1===r.allowUndefined)throw new Error("".concat(Ri," undefined values are not supported"));return!0===r.coerceUndefinedToNull?new yi(gi.null,null,1):new yi(gi.undefined,void 0,1)},Eo[248]=wo("simple values are not supported"),Eo[249]=function(e,t,n,r){return co(go(e,t+1),3,r)},Eo[250]=function(e,t,n,r){return co(mo(e,t+1),5,r)},Eo[251]=function(e,t,n,r){return co(vo(e,t+1),9,r)},Eo[252]=bo,Eo[253]=bo,Eo[254]=bo,Eo[255]=function(e,t,n,r){if(!1===r.allowIndefinite)throw new Error("".concat(Ri," indefinite length items not allowed"));return new yi(gi.break,void 0,1)};const Ao=[];for(let Ige=0;Ige<24;Ige++)Ao[Ige]=new yi(gi.uint,Ige,1);for(let Ige=-1;Ige>=-24;Ige--)Ao[31-Ige]=new yi(gi.negint,Ige,1);Ao[64]=new yi(gi.bytes,new Uint8Array(0),1),Ao[96]=new yi(gi.string,"",1),Ao[128]=new yi(gi.array,0,1),Ao[160]=new yi(gi.map,0,1),Ao[244]=new yi(gi.false,!1,1),Ao[245]=new yi(gi.true,!0,1),Ao[246]=new yi(gi.null,null,1);function So(){const e=[];return e[gi.uint.major]=Ui,e[gi.negint.major]=Zi,e[gi.bytes.major]=qi,e[gi.string.major]=Qi,e[gi.array.major]=Xi,e[gi.map.major]=to,e[gi.tag.major]=ro,e[gi.float.major]=lo,e}So(),new class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:256;this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),null!==this._initReuseChunk&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let t=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){const n=t.length-(this.maxCursor-this.cursor)-1;t.set(e,n)}else{if(t){const e=t.length-(this.maxCursor-this.cursor)-1;e<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,e),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(t=Ii(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,null===this._initReuseChunk&&(this._initReuseChunk=t),t.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(){let e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(1===this.chunks.length){const n=this.chunks[0];t&&this.cursor>n.length/2?(e=this.cursor===n.length?n:n.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):e=Si(n,0,this.cursor)}else e=_i(this.chunks,this.cursor);return t&&this.reset(),e}};class _o{constructor(e,t){this.obj=e,this.parent=t}includes(e){let t=this;do{if(t.obj===e)return!0}while(t=t.parent);return!1}static createCheck(e,t){if(e&&e.includes(t))throw new Error("".concat(xi," object contains circular references"));return new _o(t,e)}}const Io={null:new yi(gi.null,null),undefined:new yi(gi.undefined,void 0),true:new yi(gi.true,!0),false:new yi(gi.false,!1),emptyArray:new yi(gi.array,0),emptyMap:new yi(gi.map,0)},Co={number:(e,t,n,r)=>Number.isInteger(e)&&Number.isSafeInteger(e)?new yi(e>=0?gi.uint:gi.negint,e):new yi(gi.float,e),bigint:(e,t,n,r)=>e>=BigInt(0)?new yi(gi.uint,e):new yi(gi.negint,e),Uint8Array:(e,t,n,r)=>new yi(gi.bytes,e),string:(e,t,n,r)=>new yi(gi.string,e),boolean:(e,t,n,r)=>e?Io.true:Io.false,null:(e,t,n,r)=>Io.null,undefined:(e,t,n,r)=>Io.undefined,ArrayBuffer:(e,t,n,r)=>new yi(gi.bytes,new Uint8Array(e)),DataView:(e,t,n,r)=>new yi(gi.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),Array(e,t,n,r){if(!e.length)return!0===n.addBreakTokens?[Io.emptyArray,new yi(gi.break)]:Io.emptyArray;r=_o.createCheck(r,e);const i=[];let o=0;for(const s of e)i[o++]=To(s,n,r);return n.addBreakTokens?[new yi(gi.array,e.length),i,new yi(gi.break)]:[new yi(gi.array,e.length),i]},Object(e,t,n,r){const i="Object"!==t,o=i?e.keys():Object.keys(e),s=i?e.size:o.length;if(!s)return!0===n.addBreakTokens?[Io.emptyMap,new yi(gi.break)]:Io.emptyMap;r=_o.createCheck(r,e);const a=[];let c=0;for(const l of o)a[c++]=[To(l,n,r),To(i?e.get(l):e[l],n,r)];return function(e,t){t.mapSorter&&e.sort(t.mapSorter)}(a,n),n.addBreakTokens?[new yi(gi.map,s),a,new yi(gi.break)]:[new yi(gi.map,s),a]}};Co.Map=Co.Object,Co.Buffer=Co.Uint8Array;for(const Ige of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))Co["".concat(Ige,"Array")]=Co.DataView;function To(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const r=pi(e),i=t&&t.typeEncoders&&t.typeEncoders[r]||Co[r];if("function"===typeof i){const o=i(e,r,t,n);if(null!=o)return o}const o=Co[r];if(!o)throw new Error("".concat(xi," unsupported type: ").concat(r));return o(e,r,t,n)}Symbol.for("DONE"),Symbol.for("BREAK");So();new yi(gi.map,2),new yi(gi.string,"version"),new yi(gi.uint,1),new yi(gi.string,"roots"),new yi(gi.tag,42);async function ko(e,t){const n=ai(await e.upTo(8),e);if(0===n)throw new Error("Invalid CAR header (zero length)");const r=await e.exactly(n,!0),i=(0,ti.decode)(r);if(void 0===hi.toTyped(i))throw new Error("Invalid CAR header format");if(1!==i.version&&2!==i.version||void 0!==t&&i.version!==t)throw new Error("Invalid CAR version: ".concat(i.version).concat(void 0!==t?" (expected ".concat(t,")"):""));if(1===i.version){if(!Array.isArray(i.roots))throw new Error("Invalid CAR header format");return i}if(void 0!==i.roots)throw new Error("Invalid CAR header format");const o=function(e){const t=new DataView(e.buffer,e.byteOffset,e.byteLength);let n=0;return{version:2,characteristics:[t.getBigUint64(n,!0),t.getBigUint64(n+=8,!0)],dataOffset:Number(t.getBigUint64(n+=8,!0)),dataSize:Number(t.getBigUint64(n+=8,!0)),indexOffset:Number(t.getBigUint64(n+=8,!0))}}(await e.exactly(si,!0));e.seek(o.dataOffset-e.pos);const s=await ko(e,1);return Object.assign(s,o)}async function Ro(e){const t=await e.exactly(2,!1);if(t[0]===oi.SHA2_256&&t[1]===oi.LENGTH){const t=await e.exactly(34,!0),n=ni.Jx(t);return Gr.CID.create(0,oi.DAG_PB,n)}const n=ai(await e.upTo(8),e);if(1!==n)throw new Error("Unexpected CID version (".concat(n,")"));const r=ai(await e.upTo(8),e),i=await e.exactly(function(e){ii().decode(e);const t=ii().decode.bytes,n=ii().decode(e.subarray(ii().decode.bytes));return t+ii().decode.bytes+n}(await e.upTo(8)),!0),o=ni.Jx(i);return Gr.CID.create(n,r,o)}async function xo(e){const t=e.pos;let n=ai(await e.upTo(8),e);if(0===n)throw new Error("Invalid CAR section (zero length)");n+=e.pos-t;return{cid:await Ro(e),length:n,blockLength:n-Number(e.pos-t)}}async function Po(e){const{cid:t,blockLength:n}=await xo(e);return{bytes:await e.exactly(n,!0),cid:t}}async function Do(e){const t=e.pos,{cid:n,length:r,blockLength:i}=await xo(e),o={cid:n,length:r,blockLength:i,offset:t,blockOffset:e.pos};return e.seek(o.blockLength),o}function Oo(e){const t=(async()=>{const t=await ko(e);if(2===t.version){const n=e.pos-t.dataOffset;e=function(e,t){let n=0;return{async upTo(r){let i=await e.upTo(r);return i.length+n>t&&(i=i.subarray(0,t-n)),i},async exactly(r){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=await e.exactly(r,i);if(o.length+n>t)throw new Error("Unexpected end of data");return i&&(n+=r),o},seek(t){n+=t,e.seek(t)},get pos(){return e.pos}}}(e,t.dataSize-n)}return t})();return{header:()=>t,async*blocks(){for(await t;(await e.upTo(8)).length>0;)yield await Po(e)},async*blocksIndex(){for(await t;(await e.upTo(8)).length>0;)yield await Do(e)}}}function No(e){let t=0;return{upTo:async n=>e.subarray(t,t+Math.min(n,e.length-t)),async exactly(n){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(n>e.length-t)throw new Error("Unexpected end of data");const i=e.subarray(t,t+n);return r&&(t+=n),i},seek(e){t+=e},get pos(){return t}}}function Bo(e){const t=e[Symbol.asyncIterator]();return function(e){let t=0,n=0,r=0,i=new Uint8Array(0);const o=async t=>{n=i.length-r;const o=[i.subarray(r)];for(;n<t;){const t=await e();if(null==t)break;n<0?t.length>n&&o.push(t.subarray(-n)):o.push(t),n+=t.length}i=new Uint8Array(o.reduce(((e,t)=>e+t.length),0));let s=0;for(const e of o)i.set(e,s),s+=e.length;r=0};return{upTo:async e=>(i.length-r<e&&await o(e),i.subarray(r,r+Math.min(i.length-r,e))),async exactly(e){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(i.length-r<e&&await o(e),i.length-r<e)throw new Error("Unexpected end of data");const s=i.subarray(r,r+e);return n&&(t+=e,r+=e),s},seek(e){t+=e,r+=e},get pos(){return t}}}((async function(){const e=await t.next();return e.done?null:e.value}))}Symbol.asyncIterator;class Lo{constructor(e,t,n){this._version=e,this._roots=t,this._iterable=n,this._decoded=!1}get version(){return this._version}async getRoots(){return this._roots}}class Mo extends Lo{[Symbol.asyncIterator](){if(this._decoded)throw new Error("Cannot decode more than once");if(!this._iterable)throw new Error("Block iterable not found");return this._decoded=!0,this._iterable[Symbol.asyncIterator]()}static async fromBytes(e){const{version:t,roots:n,iterator:r}=await Uo(e);return new Mo(t,n,r)}static async fromIterable(e){const{version:t,roots:n,iterator:r}=await Fo(e);return new Mo(t,n,r)}}Symbol.asyncIterator;async function Uo(e){if(!(e instanceof Uint8Array))throw new TypeError("fromBytes() requires a Uint8Array");return Ko(No(e))}async function Fo(e){if(!e||"function"!==typeof e[Symbol.asyncIterator])throw new TypeError("fromIterable() requires an async iterable");return Ko(Bo(e))}async function Ko(e){const t=Oo(e),{version:n,roots:r}=await t.header();return{version:n,roots:r,iterator:t.blocks()}}Symbol.asyncIterator;var jo=n(6966),Zo=n.n(jo);const zo=/(\/(ipns|ipfs|ipld)\/)?([^/]+)(\/.*)?/;function Vo(e){return null!=e}const Ho=e=>(t,n)=>{let r=e(t);const i=n.split("/").filter((e=>e));for(;i.length>0;){const e=i.shift();if(null==e)throw new Error("Not found");if(r=r[e],"undefined"===typeof r)throw new Error("Not found");if(null!=Qr.CID.asCID(r)){return{value:r,remainderPath:i.length>0?$r(i.join("/")):""}}}return{value:r,remainderPath:""}},qo={"dag-pb":async(e,t)=>{var n;if(!function(e){return Vo(e)&&"object"===typeof e&&null!=e.Data&&null!=e.Links}(e))throw new Error("node is not a PBNode");const r=t.split("/");let i=r.splice(1,1)[0];"Links"===i&&(i="".concat(i,"/").concat(r.splice(1,1)[0]));let o=r.join("/"),s=e.Links.find((e=>e.Name===i));if(null==s&&null!==(n=i)&&void 0!==n&&n.includes("Links")){const t=Number(i.split("/")[1]);s=e.Links[t]}let a=e;return null!=s?a=s:o=[i,...r].join("/").replace("//","/"),{value:a,remainderPath:o}}};class Go extends Error{constructor(e){super(),this.options=e,this.name=this.constructor.name}toString(e){return e(this.name,this.options)}}class Wo extends Go{}var Qo=n(20099),Yo=n(96156),Jo=n(67963),Xo=n.n(Jo),$o=n(90095),es=n.n($o),ts=n(48418),ns=n.n(ts),rs=n(97469),is=n.n(rs),os=n(21748),ss=n.n(os),as=n(4080),cs=n.n(as);is()._configure(),es()._configure(ns()),ss()._configure(cs());const ls=["uint64","int64","sint64","fixed64","sfixed64"];function us(e){return function(e){for(const t of ls){if(null==e[t])continue;const n=e[t];e[t]=function(){return BigInt(n.call(this).toString())}}return e}(new(es())(e))}function hs(){return function(e){for(const t of ls){if(null==e[t])continue;const n=e[t];e[t]=function(e){return n.call(this,e.toString())}}return e}(ss().create())}function ds(e,t){const n=us(e instanceof Uint8Array?e:e.subarray());return t.decode(n)}function fs(e,t){const n=hs();return t.encode(e,n,{lengthDelimited:!1}),n.finish()}var ps,gs,ys,ms;function vs(e,t,n,r){return{name:e,type:t,encode:n,decode:r}}function bs(e){function t(t){if(null==e[t.toString()])throw new Error("Invalid enum value");return e[t]}return vs("enum",ps.VARINT,(function(e,n){const r=t(e);n.int32(r)}),(function(e){return t(e.int32())}))}function ws(e,t){return vs("message",ps.LENGTH_DELIMITED,e,t)}!function(e){e[e.VARINT=0]="VARINT",e[e.BIT64=1]="BIT64",e[e.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",e[e.START_GROUP=3]="START_GROUP",e[e.END_GROUP=4]="END_GROUP",e[e.BIT32=5]="BIT32"}(ps||(ps={})),function(e){let t,n,r;!function(e){e.Raw="Raw",e.Directory="Directory",e.File="File",e.Metadata="Metadata",e.Symlink="Symlink",e.HAMTShard="HAMTShard"}(t=e.DataType||(e.DataType={})),function(e){e[e.Raw=0]="Raw",e[e.Directory=1]="Directory",e[e.File=2]="File",e[e.Metadata=3]="Metadata",e[e.Symlink=4]="Symlink",e[e.HAMTShard=5]="HAMTShard"}(n||(n={})),function(e){e.codec=()=>bs(n)}(t=e.DataType||(e.DataType={})),e.codec=()=>(null==r&&(r=ws((function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==r.lengthDelimited&&n.fork(),null!=t.Type&&(n.uint32(8),e.DataType.codec().encode(t.Type,n)),null!=t.Data&&(n.uint32(18),n.bytes(t.Data)),null!=t.filesize&&(n.uint32(24),n.uint64(t.filesize)),null!=t.blocksizes)for(const e of t.blocksizes)n.uint32(32),n.uint64(e);null!=t.hashType&&(n.uint32(40),n.uint64(t.hashType)),null!=t.fanout&&(n.uint32(48),n.uint64(t.fanout)),null!=t.mode&&(n.uint32(56),n.uint32(t.mode)),null!=t.mtime&&(n.uint32(66),ys.codec().encode(t.mtime,n)),!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={blocksizes:[]},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.Type=e.DataType.codec().decode(t);break;case 2:r.Data=t.bytes();break;case 3:r.filesize=t.uint64();break;case 4:r.blocksizes.push(t.uint64());break;case 5:r.hashType=t.uint64();break;case 6:r.fanout=t.uint64();break;case 7:r.mode=t.uint32();break;case 8:r.mtime=ys.codec().decode(t,t.uint32());break;default:t.skipType(7&n)}}return r}))),r),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(gs||(gs={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.Seconds&&(t.uint32(8),t.int64(e.Seconds)),null!=e.FractionalNanoseconds&&(t.uint32(21),t.fixed32(e.FractionalNanoseconds)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.Seconds=e.int64();break;case 2:n.FractionalNanoseconds=e.fixed32();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(ys||(ys={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.MimeType&&(t.uint32(10),t.string(e.MimeType)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();if(t>>>3===1)n.MimeType=e.string();else e.skipType(7&t)}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(ms||(ms={}));const Es={Raw:"raw",Directory:"directory",File:"file",Metadata:"metadata",Symlink:"symlink",HAMTShard:"hamt-sharded-directory"},As=["directory","hamt-sharded-directory"],Ss=parseInt("0644",8),_s=parseInt("0755",8);class Is{static unmarshal(e){var t,n;const r=gs.decode(e),i=new Is({type:Es[null!=r.Type?r.Type.toString():"File"],data:r.Data,blockSizes:r.blocksizes,mode:r.mode,mtime:null!=r.mtime?{secs:null!==(t=r.mtime.Seconds)&&void 0!==t?t:0n,nsecs:r.mtime.FractionalNanoseconds}:void 0,fanout:r.fanout});return i._originalMode=null!==(n=r.mode)&&void 0!==n?n:0,i}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{type:"file"};(0,Yo.Z)(this,"type",void 0),(0,Yo.Z)(this,"data",void 0),(0,Yo.Z)(this,"blockSizes",void 0),(0,Yo.Z)(this,"hashType",void 0),(0,Yo.Z)(this,"fanout",void 0),(0,Yo.Z)(this,"mtime",void 0),(0,Yo.Z)(this,"_mode",void 0),(0,Yo.Z)(this,"_originalMode",void 0);const{type:t,data:n,blockSizes:r,hashType:i,fanout:o,mtime:s,mode:a}=e;if(null!=t&&!Object.values(Es).includes(t))throw Xo()(new Error("Type: "+t+" is not valid"),"ERR_INVALID_TYPE");this.type=null!==t&&void 0!==t?t:"file",this.data=n,this.hashType=i,this.fanout=o,this.blockSizes=null!==r&&void 0!==r?r:[],this._originalMode=0,this.mode=a,this.mtime=s}set mode(e){this._mode=null==e?this.isDirectory()?_s:Ss:4095&e}get mode(){return this._mode}isDirectory(){return As.includes(this.type)}addBlockSize(e){this.blockSizes.push(e)}removeBlockSize(e){this.blockSizes.splice(e,1)}fileSize(){if(this.isDirectory())return 0n;let e=0n;return this.blockSizes.forEach((t=>{e+=t})),null!=this.data&&(e+=BigInt(this.data.length)),e}marshal(){let e;switch(this.type){case"raw":e=gs.DataType.Raw;break;case"directory":e=gs.DataType.Directory;break;case"file":e=gs.DataType.File;break;case"metadata":e=gs.DataType.Metadata;break;case"symlink":e=gs.DataType.Symlink;break;case"hamt-sharded-directory":e=gs.DataType.HAMTShard;break;default:throw Xo()(new Error("Type: ".concat(e," is not valid")),"ERR_INVALID_TYPE")}let t,n=this.data;var r;(null!=this.data&&0!==this.data.length||(n=void 0),null!=this.mode)&&(t=4294963200&this._originalMode|(null!==(r=this.mode)&&void 0!==r?r:0),t!==Ss||this.isDirectory()||(t=void 0),t===_s&&this.isDirectory()&&(t=void 0));let i;return null!=this.mtime&&(i={Seconds:this.mtime.secs,FractionalNanoseconds:this.mtime.nsecs}),gs.encode({Type:e,Data:n,filesize:this.isDirectory()?void 0:this.fileSize(),blocksizes:this.blockSizes,hashType:this.hashType,fanout:this.fanout,mode:t,mtime:i})}}var Cs=n(59536),Ts=n(19778).Buffer;function ks(e,t){const n=(0,Cs.uU)(t);return n===Qo.code?function(e,t,n){const r=(0,Cs.A$)(t);if(null==r)throw new Error("cidStr is null for cid: ".concat(t));let i="non-unixfs";const o=e.Data;if(null!=o)try{const n=Is.unmarshal(o),{type:s,data:a,blockSizes:c}=n;return i="unixfs",{cid:r,type:s,data:{type:s,data:a,blockSizes:c},links:Rs(e.Links,t),size:n.fileSize(),format:i}}catch(s){}return{cid:r,type:n,data:o,links:Rs(e.Links,t),format:i}}(e,t,n):function(e,t,n){const r=xs(e,t);return{cid:t,type:n,data:e,links:r,size:r.reduce(((e,t)=>{let{size:n}=t;return e+n}),BigInt(0)),format:"unknown"}}(e,t,null!==n&&void 0!==n?n:ti.code)}function Rs(e,t){return e.map(((e,n)=>{var r,i;return{path:e.Name||"Links/".concat(n),source:t,target:null!==(r=(0,Cs.A$)(e.Hash))&&void 0!==r?r:"",size:BigInt(null!==(i=e.Tsize)&&void 0!==i?i:0),index:n}}))}function xs(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!e||"object"!==typeof e||Ts.isBuffer(e)||"string"===typeof e)return[];const r=(0,Cs.SD)(e);if(r)return[{path:n,source:t,target:r.toString(),size:BigInt(0),index:0}];if(Array.isArray(e))return e.length?e.map(((e,r)=>xs(e,t,n?"".concat(n,"/").concat(r):"".concat(r)))).reduce(((e,t)=>e.concat(t))).filter((e=>Boolean(e))):[];const i=Object.keys(e);if(1===i.length&&"/"===i[0]){const r=(0,Cs.SD)(e["/"]);if(!r)return[];const i=r.toString();return e["/"]=i,[{path:n,source:t,target:i,size:BigInt(0),index:0}]}return i.length>0?i.map((r=>xs(e[r],t,n?"".concat(n,"/").concat(r):"".concat(r)))).reduce(((e,t)=>e.concat(t))).filter((e=>Boolean(e))):[]}async function Ps(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];const{value:o,remainderPath:s}=await Ds(e,t,n);if(null==t)throw new Error("sourceCid is null");const a=t.toString(),c=ks(o,a);r.push(c);const l=function(e,t){if(!e||"/"===e)return null;if(!t)return Os(e);if(!e.endsWith(t))throw new Error("Requested IPLD path should end with the remainder path",{fullPath:e,remainderPath:t});const n=e.substring(0,e.length-t.length);return Os(n)}(n,s),u=function(e,t){if(!t)return null;if(!e)return null;const{links:n}=e,r=n.find((e=>e.path===t));return r}(c,l);if(u)return i.push(u),Ps(e,u.target,s,r,i);return{targetNode:c,canonicalPath:n?"".concat(a).concat(n):a,localPath:n,nodes:r,pathBoundaries:i}}async function Ds(e,t,n){if(null==t)throw new Error("sourceCid is null");let r=Qr.CID.asCID(t);null===r&&(r=Qr.CID.parse(t));const i=await async function(e){const t=e.code;if(void 0===t)throw new Error("CID codec code is undefined for CID '".concat(e.toString(),"'"));const n=(0,Yr.Z)(t),r=await Jr(t),i=e=>{if(null!=r.decode)return r.decode(e);throw new Error("codec ".concat(t,"=").concat(n," does not have a decode function"))};return{decode:i,resolve:async(r,o)=>{if(null!=qo[n])try{return await qo[n](i(o),r)}catch(s){console.error(s),console.error("error resolving path for cid with codecResolverMap",e,r)}try{return Ho(i)(o,r)}catch(s){console.error("error resolving path for cid with resolveFn",e,r)}throw new Error("codec ".concat(t,"=").concat(n," does not have a resolve function"))}}}(r),o=await async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e4;const r=new AbortController;try{const i=setTimeout((()=>{r.abort("Request timed out")}),n),o=await e.blockstore.get(t,{signal:r.signal});return clearTimeout(i),o}catch(i){if(console.error("unable to get raw block",i),r.signal.aborted)throw new Wo({timeout:n/1e3});throw i}}(e,r),s=i.decode(o),a=await i.resolve(n||"/",o),{remainderPath:c,resolve:l}=a;return null!=(null===l||void 0===l?void 0:l.Hash)?await Ds(e,s.Hash,c):{value:s,remainderPath:c}}function Os(e){return e.startsWith("/")&&(e=e.substring(1)),e.endsWith("/")&&(e=e.substring(0,e.length-1)),e}BigInt.prototype.toJSON=function(){return this.toString()};const Ns=()=>{const e=(0,Wr.Jc)({name:"explore",actionBaseType:"EXPLORE",getPromise:async e=>{let{store:t}=e;const n=t.selectExplorePathFromHash();if(!n)return null;const r=function(e){const t=zo.exec(e);return t?{namespace:t[2],cidOrFqdn:t[3],rest:t[4],address:t[0]}:null}(n);if(!r)return null;const{cidOrFqdn:i,rest:o}=r;try{const e=Gr.CID.parse((e=>{if(e.startsWith("/ipfs/"))return e.slice(6);if(e.startsWith("/ipns/"))throw new Error("ipns not supported yet");return e.startsWith("/")?e.slice(1):e})(i)),{targetNode:r,canonicalPath:s,localPath:a,nodes:c,pathBoundaries:l}=await Ps(t.selectHelia(),e,o);return{path:n,targetNode:r,canonicalPath:s,localPath:a,nodes:c,pathBoundaries:l}}catch(s){return console.warn("Failed to resolve path",n,s),{path:n,error:s}}},staleAfter:1/0,checkIfOnline:!1});return e.selectExplorePathFromHash=(0,Wr.P1)("selectRouteInfo",(e=>{if(!e.url.startsWith("/explore"))return;const t=e.url.slice(8);return decodeURIComponent(t)})),e.reactExploreFetch=(0,Wr.P1)("selectHeliaReady","selectExploreIsLoading","selectExploreIsWaitingToRetry","selectExplorePathFromHash","selectExplore",((e,t,n,r,i)=>!(!e||t||n)&&(!(!r&&!i)&&((!i||r!==i.path)&&{actionCreator:"doFetchExplore"})))),e.doExploreLink=e=>t=>{let{store:n}=t;const{nodes:r,pathBoundaries:i}=n.selectExplore(),o=r[0].cid,s=i.map((e=>e.path));e&&e.path&&s.push(e.path),s.unshift(o);const a=s.map((e=>encodeURIComponent(e))).join("/"),c="#/explore/".concat(a);n.doUpdateHash(c)},e.doExploreUserProvidedPath=e=>t=>{let{store:n}=t;const r=e?"#/explore".concat($r(e)):"#/explore";n.doUpdateHash(r)},e.doUploadUserProvidedCar=(e,t)=>async n=>{let{store:r}=n;try{const n=await async function(e,t){const n=e.stream(),r=await Mo.fromIterable(Zo().source(n));for await(const{cid:i,bytes:o}of r)await t.blockstore.put(i,o);return(await r.getRoots())[0]}(e,await r.selectHelia()),i=n.toString()?"#/explore".concat($r(n.toString())):"#/explore";r.doUpdateHash(i);document.getElementById("car-loader-image").src=t}catch(i){console.error("Could not import car file",i)}},e};var Bs=n(80136),Ls=n(71403),Ms=n(1202),Us=n(69958);const Fs=Symbol.for("@achingbrain/uint8arraylist");function Ks(e,t){if(null==t||t<0)throw new RangeError("index is out of bounds");let n=0;for(const r of e){const e=n+r.byteLength;if(t<e)return{buf:r,index:t-n};n=e}throw new RangeError("index is out of bounds")}function js(e){return Boolean(null===e||void 0===e?void 0:e[Fs])}class Zs{constructor(){Object.defineProperty(this,Fs,{value:!0}),this.bufs=[],this.length=0;for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.length>0&&this.appendAll(t)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.appendAll(t)}appendAll(e){let t=0;for(const n of e)if(n instanceof Uint8Array)t+=n.byteLength,this.bufs.push(n);else{if(!js(n))throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");t+=n.byteLength,this.bufs.push(...n.bufs)}this.length+=t}prepend(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.prependAll(t)}prependAll(e){let t=0;for(const n of e.reverse())if(n instanceof Uint8Array)t+=n.byteLength,this.bufs.unshift(n);else{if(!js(n))throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");t+=n.byteLength,this.bufs.unshift(...n.bufs)}this.length+=t}get(e){const t=Ks(this.bufs,e);return t.buf[t.index]}set(e,t){const n=Ks(this.bufs,e);n.buf[n.index]=t}write(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(e instanceof Uint8Array)for(let n=0;n<e.length;n++)this.set(t+n,e[n]);else{if(!js(e))throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList");for(let n=0;n<e.length;n++)this.set(t+n,e.get(n))}}consume(e){if(e=Math.trunc(e),!(Number.isNaN(e)||e<=0)){if(e===this.byteLength)return this.bufs=[],void(this.length=0);for(;this.bufs.length>0;){if(!(e>=this.bufs[0].byteLength)){this.bufs[0]=this.bufs[0].subarray(e),this.length-=e;break}e-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift()}}}slice(e,t){const{bufs:n,length:r}=this._subList(e,t);return(0,Ls.z)(n,r)}subarray(e,t){const{bufs:n,length:r}=this._subList(e,t);return 1===n.length?n[0]:(0,Ls.z)(n,r)}sublist(e,t){const{bufs:n,length:r}=this._subList(e,t),i=new Zs;return i.length=r,i.bufs=n,i}_subList(e,t){var n,r;if(e=null!==(n=e)&&void 0!==n?n:0,t=null!==(r=t)&&void 0!==r?r:this.length,e<0&&(e=this.length+e),t<0&&(t=this.length+t),e<0||t>this.length)throw new RangeError("index is out of bounds");if(e===t)return{bufs:[],length:0};if(0===e&&t===this.length)return{bufs:[...this.bufs],length:this.length};const i=[];let o=0;for(let s=0;s<this.bufs.length;s++){const n=this.bufs[s],r=o,a=r+n.byteLength;if(o=a,e>=a)continue;const c=e>=r&&e<a,l=t>r&&t<=a;if(c&&l){if(e===r&&t===a){i.push(n);break}const o=e-r;i.push(n.subarray(o,o+(t-e)));break}if(c){if(0===e){i.push(n);continue}i.push(n.subarray(e-r))}else{if(l){if(t===a){i.push(n);break}i.push(n.subarray(0,t-r));break}i.push(n)}}return{bufs:i,length:t-e}}indexOf(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!js(e)&&!(e instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');const r=e instanceof Uint8Array?e:e.subarray();if(n=Number(null!==(t=n)&&void 0!==t?t:0),isNaN(n)&&(n=0),n<0&&(n=this.length+n),n<0&&(n=0),0===e.length)return n>this.length?this.length:n;const i=r.byteLength;if(0===i)throw new TypeError("search must be at least 1 byte long");const o=new Int32Array(256);for(let u=0;u<256;u++)o[u]=-1;for(let u=0;u<i;u++)o[r[u]]=u;const s=o,a=this.byteLength-r.byteLength,c=r.byteLength-1;let l;for(let u=n;u<=a;u+=l){l=0;for(let e=c;e>=0;e--){const t=this.get(u+e);if(r[e]!==t){l=Math.max(1,e-s[t]);break}}if(0===l)return u}return-1}getInt8(e){const t=this.subarray(e,e+1);return new DataView(t.buffer,t.byteOffset,t.byteLength).getInt8(0)}setInt8(e,t){const n=(0,Us.E)(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,t),this.write(n,e)}getInt16(e,t){const n=this.subarray(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,t)}setInt16(e,t,n){const r=(0,Us.u)(2);new DataView(r.buffer,r.byteOffset,r.byteLength).setInt16(0,t,n),this.write(r,e)}getInt32(e,t){const n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,t)}setInt32(e,t,n){const r=(0,Us.u)(4);new DataView(r.buffer,r.byteOffset,r.byteLength).setInt32(0,t,n),this.write(r,e)}getBigInt64(e,t){const n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,t)}setBigInt64(e,t,n){const r=(0,Us.u)(8);new DataView(r.buffer,r.byteOffset,r.byteLength).setBigInt64(0,t,n),this.write(r,e)}getUint8(e){const t=this.subarray(e,e+1);return new DataView(t.buffer,t.byteOffset,t.byteLength).getUint8(0)}setUint8(e,t){const n=(0,Us.E)(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,t),this.write(n,e)}getUint16(e,t){const n=this.subarray(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,t)}setUint16(e,t,n){const r=(0,Us.u)(2);new DataView(r.buffer,r.byteOffset,r.byteLength).setUint16(0,t,n),this.write(r,e)}getUint32(e,t){const n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,t)}setUint32(e,t,n){const r=(0,Us.u)(4);new DataView(r.buffer,r.byteOffset,r.byteLength).setUint32(0,t,n),this.write(r,e)}getBigUint64(e,t){const n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,t)}setBigUint64(e,t,n){const r=(0,Us.u)(8);new DataView(r.buffer,r.byteOffset,r.byteLength).setBigUint64(0,t,n),this.write(r,e)}getFloat32(e,t){const n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,t)}setFloat32(e,t,n){const r=(0,Us.u)(4);new DataView(r.buffer,r.byteOffset,r.byteLength).setFloat32(0,t,n),this.write(r,e)}getFloat64(e,t){const n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,t)}setFloat64(e,t,n){const r=(0,Us.u)(8);new DataView(r.buffer,r.byteOffset,r.byteLength).setFloat64(0,t,n),this.write(r,e)}equals(e){if(null==e)return!1;if(!(e instanceof Zs))return!1;if(e.bufs.length!==this.bufs.length)return!1;for(let t=0;t<this.bufs.length;t++)if(!(0,Ms.f)(this.bufs[t],e.bufs[t]))return!1;return!0}static fromUint8Arrays(e,t){const n=new Zs;return n.bufs=e,null==t&&(t=e.reduce(((e,t)=>e+t.byteLength),0)),n.length=t,n}}function zs(e){return null!=e[Symbol.asyncIterator]}const Vs=e=>{const t=Bs.P$(e),n=(0,Us.E)(t);return Bs.cv(e,n),Vs.bytes=t,n};Vs.bytes=0;var Hs;!function(e){e[e.LENGTH=0]="LENGTH",e[e.DATA=1]="DATA"}(Hs||(Hs={}));const qs=e=>{const t=Bs.Jx(e);return qs.bytes=Bs.P$(t),t};function Gs(e,t){var n,r,i;const o=new Zs;let s=Hs.LENGTH,a=-1;const c=null!==(n=null===t||void 0===t?void 0:t.lengthDecoder)&&void 0!==n?n:qs,l=null!==(r=null===t||void 0===t?void 0:t.maxLengthLength)&&void 0!==r?r:8,u=null!==(i=null===t||void 0===t?void 0:t.maxDataLength)&&void 0!==i?i:4194304;function*h(){for(;o.byteLength>0;){if(s===Hs.LENGTH)try{if(a=c(o),a<0)throw Xo()(new Error("invalid message length"),"ERR_INVALID_MSG_LENGTH");if(a>u)throw Xo()(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");const e=c.bytes;o.consume(e),null!=(null===t||void 0===t?void 0:t.onLength)&&t.onLength(a),s=Hs.DATA}catch(e){if(e instanceof RangeError){if(o.byteLength>l)throw Xo()(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG");break}throw e}if(s===Hs.DATA){if(o.byteLength<a)break;const e=o.sublist(0,a);o.consume(a),null!=(null===t||void 0===t?void 0:t.onData)&&t.onData(e),yield e,s=Hs.LENGTH}}}return zs(e)?async function*(){for await(const t of e)o.append(t),yield*h();if(o.byteLength>0)throw Xo()(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}():function*(){for(const t of e)o.append(t),yield*h();if(o.byteLength>0)throw Xo()(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}()}function Ws(){const e={};return e.promise=new Promise(((t,n)=>{e.resolve=t,e.reject=n})),e}qs.bytes=0,Gs.fromReader=(e,t)=>{let n=1;return Gs(async function*(){for(;;)try{const{done:t,value:r}=await e.next(n);if(!0===t)return;null!=r&&(yield r)}catch(t){if("ERR_UNDER_READ"===t.code)return{done:!0,value:null};throw t}finally{n=1}}(),{...null!==t&&void 0!==t?t:{},onLength:e=>{n=e}})};class Qs extends Error{constructor(e,t){super(null!==e&&void 0!==e?e:"The operation was aborted"),(0,Yo.Z)(this,"type",void 0),(0,Yo.Z)(this,"code",void 0),this.type="aborted",this.name="AbortError",this.code=null!==t&&void 0!==t?t:"ABORT_ERR"}}async function Ys(e,t,n){if(null==t)return e;if(t.aborted)return Promise.reject(new Qs(null===n||void 0===n?void 0:n.errorMessage,null===n||void 0===n?void 0:n.errorCode));let r;const i=new Qs(null===n||void 0===n?void 0:n.errorMessage,null===n||void 0===n?void 0:n.errorCode);try{return await Promise.race([e,new Promise(((e,n)=>{r=()=>{n(i)},t.addEventListener("abort",r)}))])}finally{null!=r&&t.removeEventListener("abort",r)}}class Js{constructor(){(0,Yo.Z)(this,"needNext",void 0),(0,Yo.Z)(this,"haveNext",void 0),(0,Yo.Z)(this,"ended",void 0),(0,Yo.Z)(this,"nextResult",void 0),this.ended=!1,this.needNext=Ws(),this.needNext.resolve(),this.haveNext=Ws()}[Symbol.asyncIterator](){return this}async next(){if(null==this.nextResult&&await this.haveNext.promise,null==this.nextResult)throw new Error("Have next but next was undefined");const e=this.nextResult;return this.nextResult=void 0,this.needNext.resolve(),this.needNext=Ws(),e}async throw(e){this.ended=!0,null!=e&&this.haveNext.reject(e);return{done:!0,value:void 0}}async return(){const e={done:!0,value:void 0};return await this._push(void 0),e}async push(e,t){await this._push(e,t)}async end(e,t){null!=e?await this.throw(e):await this._push(void 0,t)}async _push(e,t){if(null!=e&&this.ended)throw new Error("Cannot push value onto an ended pushable");null!=this.nextResult&&await this.needNext.promise,null!=e?this.nextResult={done:!1,value:e}:(this.ended=!0,this.nextResult={done:!0,value:void 0}),this.haveNext.resolve(),this.haveNext=Ws(),await Ys(this.needNext.promise,null===t||void 0===t?void 0:t.signal,t)}}class Xs extends Error{constructor(e,t){super(e),(0,Yo.Z)(this,"code",void 0),this.code=t}}class $s extends Xs{constructor(e){super(e,"ABORT_ERR"),(0,Yo.Z)(this,"type",void 0),this.type="aborted"}}function ea(e,t){const n=new Js;e.sink(n).catch((async e=>{await n.end(e)})),e.sink=async e=>{for await(const t of e)await n.push(t);await n.end()};let r=e.source;null!=e.source[Symbol.iterator]?r=e.source[Symbol.iterator]():null!=e.source[Symbol.asyncIterator]&&(r=e.source[Symbol.asyncIterator]());const i=new Zs,o={read:async(e,t)=>{var n;let o;null===t||void 0===t||null===(n=t.signal)||void 0===n||n.throwIfAborted();const s=new Promise(((e,n)=>{var r;o=()=>{n(new $s("Read aborted"))},null===t||void 0===t||null===(r=t.signal)||void 0===r||r.addEventListener("abort",o)}));try{if(null==e){const{done:e,value:t}=await Promise.race([r.next(),s]);return!0===e?new Zs:t}for(;i.byteLength<e;){const{value:e,done:t}=await Promise.race([r.next(),s]);if(!0===t)throw new Xs("unexpected end of input","ERR_UNEXPECTED_EOF");i.append(e)}const t=i.sublist(0,e);return i.consume(e),t}finally{var a;if(null!=o)null===t||void 0===t||null===(a=t.signal)||void 0===a||a.removeEventListener("abort",o)}},write:async(e,t)=>{var r;null===t||void 0===t||null===(r=t.signal)||void 0===r||r.throwIfAborted(),e instanceof Uint8Array?await n.push(e,t):await n.push(e.subarray(),t)},unwrap:()=>{if(i.byteLength>0){const n=e.source;e.source=async function*(){!1===(null===t||void 0===t?void 0:t.yieldBytes)?yield i:yield*i,yield*n}()}return e}};return o}function ta(e){return null!=e[Symbol.asyncIterator]}const na=e=>{const t=Bs.P$(e),n=(0,Us.E)(t);return Bs.cv(e,n),na.bytes=t,n};function ra(e,t){var n,r;const i=null!==(r=(t=null!==(n=t)&&void 0!==n?n:{}).lengthEncoder)&&void 0!==r?r:na;function*o(e){const t=i(e.byteLength);t instanceof Uint8Array?yield t:yield*t,e instanceof Uint8Array?yield e:yield*e}return ta(e)?async function*(){for await(const t of e)yield*o(t)}():function*(){for(const t of e)yield*o(t)}()}na.bytes=0,ra.single=(e,t)=>{var n,r;const i=null!==(r=(t=null!==(n=t)&&void 0!==n?n:{}).lengthEncoder)&&void 0!==r?r:na;return new Zs(i(e.byteLength),e)};var ia;!function(e){e[e.LENGTH=0]="LENGTH",e[e.DATA=1]="DATA"}(ia||(ia={}));const oa=e=>{const t=Bs.Jx(e);return oa.bytes=Bs.P$(t),t};function sa(e,t){var n,r,i;const o=new Zs;let s=ia.LENGTH,a=-1;const c=null!==(n=null===t||void 0===t?void 0:t.lengthDecoder)&&void 0!==n?n:oa,l=null!==(r=null===t||void 0===t?void 0:t.maxLengthLength)&&void 0!==r?r:8,u=null!==(i=null===t||void 0===t?void 0:t.maxDataLength)&&void 0!==i?i:4194304;function*h(){for(;o.byteLength>0;){if(s===ia.LENGTH)try{if(a=c(o),a<0)throw Xo()(new Error("invalid message length"),"ERR_INVALID_MSG_LENGTH");if(a>u)throw Xo()(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");const e=c.bytes;o.consume(e),null!=(null===t||void 0===t?void 0:t.onLength)&&t.onLength(a),s=ia.DATA}catch(e){if(e instanceof RangeError){if(o.byteLength>l)throw Xo()(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG");break}throw e}if(s===ia.DATA){if(o.byteLength<a)break;const e=o.sublist(0,a);o.consume(a),null!=(null===t||void 0===t?void 0:t.onData)&&t.onData(e),yield e,s=ia.LENGTH}}}return ta(e)?async function*(){for await(const t of e)o.append(t),yield*h();if(o.byteLength>0)throw Xo()(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}():function*(){for(const t of e)o.append(t),yield*h();if(o.byteLength>0)throw Xo()(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}()}oa.bytes=0,sa.fromReader=(e,t)=>{let n=1;return sa(async function*(){for(;;)try{const{done:t,value:r}=await e.next(n);if(!0===t)return;null!=r&&(yield r)}catch(t){if("ERR_UNDER_READ"===t.code)return{done:!0,value:null};throw t}finally{n=1}}(),{...null!==t&&void 0!==t?t:{},onLength:e=>{n=e}})};class aa extends Error{constructor(e,t){super(e),(0,Yo.Z)(this,"code",void 0),this.code=t}}const ca=e=>Bs.Jx(e);function la(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=ea(e,t);null!=t.maxDataLength&&null==t.maxLengthLength&&(t.maxLengthLength=Bs.P$(t.maxDataLength));const r={read:async e=>{var r;let i=-1;const o=new Zs,s=null!==(r=null===t||void 0===t?void 0:t.lengthDecoder)&&void 0!==r?r:ca;for(;;){o.append(await n.read(1,e));try{i=s(o)}catch(a){if(a instanceof RangeError)continue;throw a}if(null!=(null===t||void 0===t?void 0:t.maxLengthLength)&&o.byteLength>t.maxLengthLength)throw new aa("message length length too long","ERR_MSG_LENGTH_TOO_LONG");if(i>-1)break}if(null!=(null===t||void 0===t?void 0:t.maxDataLength)&&i>t.maxDataLength)throw new aa("message length too long","ERR_MSG_DATA_TOO_LONG");return n.read(i,e)},write:async(e,r)=>{await n.write(ra.single(e,t),r)},writeV:async(e,r)=>{const i=new Zs(...e.map((e=>ra.single(e,t))));await n.write(i,r)},unwrap:()=>n.unwrap()};return r}function ua(){const e=Ws();let t=!1;return{sink:async n=>{if(t)throw new Error("already piped");t=!0,e.resolve(n)},source:async function*(){const t=await e.promise;yield*t}()}}ca.bytes=0;class ha{constructor(e){if((0,Yo.Z)(this,"buffer",void 0),(0,Yo.Z)(this,"mask",void 0),(0,Yo.Z)(this,"top",void 0),(0,Yo.Z)(this,"btm",void 0),(0,Yo.Z)(this,"next",void 0),!(e>0)||0!==(e-1&e))throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];if(void 0!==e)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return void 0===this.buffer[this.btm]}}class da{constructor(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,Yo.Z)(this,"size",void 0),(0,Yo.Z)(this,"hwm",void 0),(0,Yo.Z)(this,"head",void 0),(0,Yo.Z)(this,"tail",void 0),this.hwm=null!==(e=t.splitLimit)&&void 0!==e?e:16,this.head=new ha(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return null!=(null===e||void 0===e?void 0:e.byteLength)?e.byteLength:1}push(e){if(null!=(null===e||void 0===e?void 0:e.value)&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){const t=this.head;this.head=t.next=new ha(2*this.head.buffer.length),this.head.push(e)}}shift(){var e;let t=this.tail.shift();if(void 0===t&&null!=this.tail.next){const e=this.tail.next;this.tail.next=null,this.tail=e,t=this.tail.shift()}return null!=(null===(e=t)||void 0===e?void 0:e.value)&&(this.size-=this.calculateSize(t.value)),t}isEmpty(){return this.head.isEmpty()}}class fa extends Error{constructor(e,t){super(null!==e&&void 0!==e?e:"The operation was aborted"),(0,Yo.Z)(this,"type",void 0),(0,Yo.Z)(this,"code",void 0),this.type="aborted",this.code=null!==t&&void 0!==t?t:"ABORT_ERR"}}function pa(){return ga((e=>{const t=e.shift();if(null==t)return{done:!0};if(null!=t.error)throw t.error;return{done:!0===t.done,value:t.value}}),arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function ga(e,t){var n;let r,i,o,s=(t=null!==(n=t)&&void 0!==n?n:{}).onEnd,a=new da,c=Ws();const l=e=>null!=i?i(e):(a.push(e),r),u=e=>{var n;if(o)return r;if(!0!==(null===(n=t)||void 0===n?void 0:n.objectMode)&&null==(null===e||void 0===e?void 0:e.byteLength))throw new Error("objectMode was not true but tried to push non-Uint8Array value");return l({done:!1,value:e})},h=e=>o?r:(o=!0,null!=e?(e=>(a=new da,null!=i?i({error:e}):(a.push({error:e}),r)))(e):l({done:!0}));if(r={[Symbol.asyncIterator](){return this},next:async()=>{try{return a.isEmpty()?o?{done:!0}:await new Promise(((t,n)=>{i=o=>{i=null,a.push(o);try{t(e(a))}catch(s){n(s)}return r}})):e(a)}finally{a.isEmpty()&&queueMicrotask((()=>{c.resolve(),c=Ws()}))}},return:()=>(a=new da,h(),{done:!0}),throw:e=>(h(e),{done:!0}),push:u,end:h,get readableLength(){return a.size},onEmpty:async e=>{const t=null===e||void 0===e?void 0:e.signal;if(null===t||void 0===t||t.throwIfAborted(),a.isEmpty())return;let n,r;null!=t&&(n=new Promise(((e,n)=>{r=()=>{n(new fa)},t.addEventListener("abort",r)})));try{await Promise.race([c.promise,n])}finally{null!=r&&null!=t&&(null===t||void 0===t||t.removeEventListener("abort",r))}}},null==s)return r;const d=r;return r={[Symbol.asyncIterator](){return this},next:()=>d.next(),throw:e=>(d.throw(e),null!=s&&(s(e),s=void 0),{done:!0}),return:()=>(d.return(),null!=s&&(s(),s=void 0),{done:!0}),push:u,end:e=>(d.end(e),null!=s&&(s(e),s=void 0),r),get readableLength(){return d.readableLength},onEmpty:e=>d.onEmpty(e)},r}const ya=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=[];for(const i of t)null==i[Symbol.asyncIterator]&&r.push(i);return r.length===t.length?function*(){for(const e of r)yield*e}():async function*(){const e=pa({objectMode:!0});Promise.resolve().then((async()=>{try{await Promise.all(t.map((async t=>{for await(const n of t)e.push(n)}))),e.end()}catch(n){e.end(n)}})),yield*e}()};function ma(e){if(null==e)throw new Error("Empty pipeline");if(Ea(e)){const t=e;e=()=>t.source}else if(wa(e)||ba(e)){const t=e;e=()=>t}for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=[e,...n];if(i.length>1&&Ea(i[i.length-1])&&(i[i.length-1]=i[i.length-1].sink),i.length>2)for(let o=1;o<i.length-1;o++)Ea(i[o])&&(i[o]=Aa(i[o]));return va(...i)}const va=function(){let e;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(;n.length>0;)e=n.shift()(e);return e},ba=e=>null!=(null===e||void 0===e?void 0:e[Symbol.asyncIterator]),wa=e=>null!=(null===e||void 0===e?void 0:e[Symbol.iterator]),Ea=e=>null!=e&&(null!=e.sink&&null!=e.source),Aa=e=>t=>{const n=e.sink(t);if(null!=(null===n||void 0===n?void 0:n.then)){const t=pa({objectMode:!0});let r;n.then((()=>{t.end()}),(e=>{t.end(e)}));const i=e.source;if(ba(i))r=async function*(){yield*i,t.end()};else{if(!wa(i))throw new Error("Unknown duplex source type - must be Iterable or AsyncIterable");r=function*(){yield*i,t.end()}}return ya(t,r())}return e.source};var Sa,_a;const Ia=65535,Ca=Boolean(null===(Sa=globalThis.process)||void 0===Sa||null===(_a=Sa.env)||void 0===_a?void 0:_a.DUMP_SESSION_KEYS),Ta=e=>e instanceof Uint8Array,ka=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),Ra=e=>new DataView(e.buffer,e.byteOffset,e.byteLength);if(!(68===new Uint8Array(new Uint32Array([287454020]).buffer)[0]))throw new Error("Non little-endian hardware is not supported");function xa(e){if("string"!==typeof e)throw new Error("utf8ToBytes expected string, got ".concat(typeof e));return new Uint8Array((new TextEncoder).encode(e))}function Pa(e){if("string"===typeof e)e=xa(e);else{if(!Ta(e))throw new Error("expected Uint8Array, got ".concat(typeof e));e=e.slice()}return e}const Da=e=>"[object Object]"===Object.prototype.toString.call(e)&&e.constructor===Object;function Oa(e,t){if(!(e instanceof Uint8Array))throw new Error("Uint8Array expected");if("number"===typeof t&&e.length!==t)throw new Error("Uint8Array length ".concat(t," expected"))}const Na=(e,t)=>(Object.assign(t,e),t);function Ba(e,t,n,r){if("function"===typeof e.setBigUint64)return e.setBigUint64(t,n,r);const i=BigInt(32),o=BigInt(4294967295),s=Number(n>>i&o),a=Number(n&o),c=r?4:0,l=r?0:4;e.setUint32(t+c,s,r),e.setUint32(t+l,a,r)}function La(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("Wrong positive integer: ".concat(e))}function Ma(e){if("boolean"!==typeof e)throw new Error("Expected boolean, not ".concat(e))}function Ua(e){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(n.length>0&&!n.includes(e.length))throw new Error("Expected Uint8Array of length ".concat(n,", not of length=").concat(e.length))}function Fa(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Ka(e,t){Ua(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least ".concat(n))}const ja=(e,t)=>255&e[t++]|(255&e[t++])<<8;class Za{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,Oa(e=Pa(e),32);const t=ja(e,0),n=ja(e,2),r=ja(e,4),i=ja(e,6),o=ja(e,8),s=ja(e,10),a=ja(e,12),c=ja(e,14);this.r[0]=8191&t,this.r[1]=8191&(t>>>13|n<<3),this.r[2]=7939&(n>>>10|r<<6),this.r[3]=8191&(r>>>7|i<<9),this.r[4]=255&(i>>>4|o<<12),this.r[5]=o>>>1&8190,this.r[6]=8191&(o>>>14|s<<2),this.r[7]=8065&(s>>>11|a<<5),this.r[8]=8191&(a>>>8|c<<8),this.r[9]=c>>>5&127;for(let l=0;l<8;l++)this.pad[l]=ja(e,16+2*l)}process(e,t){const n=arguments.length>2&&void 0!==arguments[2]&&arguments[2]?0:2048,{h:r,r:i}=this,o=i[0],s=i[1],a=i[2],c=i[3],l=i[4],u=i[5],h=i[6],d=i[7],f=i[8],p=i[9],g=ja(e,t+0),y=ja(e,t+2),m=ja(e,t+4),v=ja(e,t+6),b=ja(e,t+8),w=ja(e,t+10),E=ja(e,t+12),A=ja(e,t+14);let S=r[0]+(8191&g),_=r[1]+(8191&(g>>>13|y<<3)),I=r[2]+(8191&(y>>>10|m<<6)),C=r[3]+(8191&(m>>>7|v<<9)),T=r[4]+(8191&(v>>>4|b<<12)),k=r[5]+(b>>>1&8191),R=r[6]+(8191&(b>>>14|w<<2)),x=r[7]+(8191&(w>>>11|E<<5)),P=r[8]+(8191&(E>>>8|A<<8)),D=r[9]+(A>>>5|n),O=0,N=O+S*o+_*(5*p)+I*(5*f)+C*(5*d)+T*(5*h);O=N>>>13,N&=8191,N+=k*(5*u)+R*(5*l)+x*(5*c)+P*(5*a)+D*(5*s),O+=N>>>13,N&=8191;let B=O+S*s+_*o+I*(5*p)+C*(5*f)+T*(5*d);O=B>>>13,B&=8191,B+=k*(5*h)+R*(5*u)+x*(5*l)+P*(5*c)+D*(5*a),O+=B>>>13,B&=8191;let L=O+S*a+_*s+I*o+C*(5*p)+T*(5*f);O=L>>>13,L&=8191,L+=k*(5*d)+R*(5*h)+x*(5*u)+P*(5*l)+D*(5*c),O+=L>>>13,L&=8191;let M=O+S*c+_*a+I*s+C*o+T*(5*p);O=M>>>13,M&=8191,M+=k*(5*f)+R*(5*d)+x*(5*h)+P*(5*u)+D*(5*l),O+=M>>>13,M&=8191;let U=O+S*l+_*c+I*a+C*s+T*o;O=U>>>13,U&=8191,U+=k*(5*p)+R*(5*f)+x*(5*d)+P*(5*h)+D*(5*u),O+=U>>>13,U&=8191;let F=O+S*u+_*l+I*c+C*a+T*s;O=F>>>13,F&=8191,F+=k*o+R*(5*p)+x*(5*f)+P*(5*d)+D*(5*h),O+=F>>>13,F&=8191;let K=O+S*h+_*u+I*l+C*c+T*a;O=K>>>13,K&=8191,K+=k*s+R*o+x*(5*p)+P*(5*f)+D*(5*d),O+=K>>>13,K&=8191;let j=O+S*d+_*h+I*u+C*l+T*c;O=j>>>13,j&=8191,j+=k*a+R*s+x*o+P*(5*p)+D*(5*f),O+=j>>>13,j&=8191;let Z=O+S*f+_*d+I*h+C*u+T*l;O=Z>>>13,Z&=8191,Z+=k*c+R*a+x*s+P*o+D*(5*p),O+=Z>>>13,Z&=8191;let z=O+S*p+_*f+I*d+C*h+T*u;O=z>>>13,z&=8191,z+=k*l+R*c+x*a+P*s+D*o,O+=z>>>13,z&=8191,O=(O<<2)+O|0,O=O+N|0,N=8191&O,O>>>=13,B+=O,r[0]=N,r[1]=B,r[2]=L,r[3]=M,r[4]=U,r[5]=F,r[6]=K,r[7]=j,r[8]=Z,r[9]=z}finalize(){const{h:e,pad:t}=this,n=new Uint16Array(10);let r=e[1]>>>13;e[1]&=8191;for(let s=2;s<10;s++)e[s]+=r,r=e[s]>>>13,e[s]&=8191;e[0]+=5*r,r=e[0]>>>13,e[0]&=8191,e[1]+=r,r=e[1]>>>13,e[1]&=8191,e[2]+=r,n[0]=e[0]+5,r=n[0]>>>13,n[0]&=8191;for(let s=1;s<10;s++)n[s]=e[s]+r,r=n[s]>>>13,n[s]&=8191;n[9]-=8192;let i=(1^r)-1;for(let s=0;s<10;s++)n[s]&=i;i=~i;for(let s=0;s<10;s++)e[s]=e[s]&i|n[s];e[0]=65535&(e[0]|e[1]<<13),e[1]=65535&(e[1]>>>3|e[2]<<10),e[2]=65535&(e[2]>>>6|e[3]<<7),e[3]=65535&(e[3]>>>9|e[4]<<4),e[4]=65535&(e[4]>>>12|e[5]<<1|e[6]<<14),e[5]=65535&(e[6]>>>2|e[7]<<11),e[6]=65535&(e[7]>>>5|e[8]<<8),e[7]=65535&(e[8]>>>8|e[9]<<5);let o=e[0]+t[0];e[0]=65535&o;for(let s=1;s<8;s++)o=(e[s]+t[s]|0)+(o>>>16)|0,e[s]=65535&o}update(e){Fa(this);const{buffer:t,blockLen:n}=this,r=(e=Pa(e)).length;for(let i=0;i<r;){const o=Math.min(n-this.pos,r-i);if(o!==n)t.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===n&&(this.process(t,0,!1),this.pos=0);else for(;n<=r-i;i+=n)this.process(e,i)}return this}destroy(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}digestInto(e){Fa(this),Ka(e,this),this.finished=!0;const{buffer:t,h:n}=this;let{pos:r}=this;if(r){for(t[r++]=1;r<16;r++)t[r]=0;this.process(t,0,!0)}this.finalize();let i=0;for(let o=0;o<8;o++)e[i++]=n[o]>>>0,e[i++]=n[o]>>>8;return e}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}}const za=function(e){const t=(t,n)=>e(n).update(Pa(t)).digest(),n=e(new Uint8Array(32));return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=t=>e(t),t}((e=>new Za(e))),Va=xa("expand 16-byte k"),Ha=xa("expand 32-byte k"),qa=ka(Va),Ga=ka(Ha);function Wa(e,t){return e<<t|e>>>32-t}function Qa(e){return e.byteOffset%4===0}const Ya=64,Ja=16,Xa=2**32-1,$a=new Uint32Array;function ec(e,t){const{allowShortKeys:n,extendNonceFn:r,counterLength:i,counterRight:o,rounds:s}=function(e,t){if(void 0!==t&&("object"!==typeof t||!Da(t)))throw new Error("options must be object or undefined");return Object.assign(e,t)}({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if("function"!==typeof e)throw new Error("core must be a function");return La(i),La(s),Ma(o),Ma(n),function(t,a,c,l){let u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;Ua(t),Ua(a),Ua(c);const h=c.length;if(l||(l=new Uint8Array(h)),Ua(l),La(u),u<0||u>=Xa)throw new Error("arx: counter overflow");if(l.length<h)throw new Error("arx: output (".concat(l.length,") is shorter than data (").concat(h,")"));const d=[];let f,p,g=t.length;if(32===g)f=t.slice(),d.push(f),p=Ga;else{if(16!==g||!n)throw new Error("arx: invalid 32-byte key, got length=".concat(g));f=new Uint8Array(32),f.set(t),f.set(t,16),p=qa,d.push(f)}Qa(a)||(a=a.slice(),d.push(a));const y=ka(f);if(r){if(24!==a.length)throw new Error("arx: extended nonce must be 24 bytes");r(p,y,ka(a.subarray(0,16)),y),a=a.subarray(16)}const m=16-i;if(m!==a.length)throw new Error("arx: nonce must be ".concat(m," or 16 bytes"));if(12!==m){const e=new Uint8Array(12);e.set(a,o?0:12-a.length),a=e,d.push(a)}const v=ka(a);for(!function(e,t,n,r,i,o,s,a){const c=i.length,l=new Uint8Array(Ya),u=ka(l),h=Qa(i)&&Qa(o),d=h?ka(i):$a,f=h?ka(o):$a;for(let p=0;p<c;s++){if(e(t,n,r,u,s,a),s>=Xa)throw new Error("arx: counter overflow");const g=Math.min(Ya,c-p);if(h&&g===Ya){const e=p/4;if(p%4!==0)throw new Error("arx: invalid block position");for(let t,n=0;n<Ja;n++)t=e+n,f[t]=d[t]^u[n];p+=Ya}else{for(let e,t=0;t<g;t++)e=p+t,o[e]=i[e]^l[t];p+=g}}}(e,p,y,v,c,l,u,s);d.length>0;)d.pop().fill(0);return l}}function tc(e,t,n,r,i){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:20,s=e[0],a=e[1],c=e[2],l=e[3],u=t[0],h=t[1],d=t[2],f=t[3],p=t[4],g=t[5],y=t[6],m=t[7],v=i,b=n[0],w=n[1],E=n[2],A=s,S=a,_=c,I=l,C=u,T=h,k=d,R=f,x=p,P=g,D=y,O=m,N=v,B=b,L=w,M=E;for(let F=0;F<o;F+=2)A=A+C|0,N=Wa(N^A,16),x=x+N|0,C=Wa(C^x,12),A=A+C|0,N=Wa(N^A,8),x=x+N|0,C=Wa(C^x,7),S=S+T|0,B=Wa(B^S,16),P=P+B|0,T=Wa(T^P,12),S=S+T|0,B=Wa(B^S,8),P=P+B|0,T=Wa(T^P,7),_=_+k|0,L=Wa(L^_,16),D=D+L|0,k=Wa(k^D,12),_=_+k|0,L=Wa(L^_,8),D=D+L|0,k=Wa(k^D,7),I=I+R|0,M=Wa(M^I,16),O=O+M|0,R=Wa(R^O,12),I=I+R|0,M=Wa(M^I,8),O=O+M|0,R=Wa(R^O,7),A=A+T|0,M=Wa(M^A,16),D=D+M|0,T=Wa(T^D,12),A=A+T|0,M=Wa(M^A,8),D=D+M|0,T=Wa(T^D,7),S=S+k|0,N=Wa(N^S,16),O=O+N|0,k=Wa(k^O,12),S=S+k|0,N=Wa(N^S,8),O=O+N|0,k=Wa(k^O,7),_=_+R|0,B=Wa(B^_,16),x=x+B|0,R=Wa(R^x,12),_=_+R|0,B=Wa(B^_,8),x=x+B|0,R=Wa(R^x,7),I=I+C|0,L=Wa(L^I,16),P=P+L|0,C=Wa(C^P,12),I=I+C|0,L=Wa(L^I,8),P=P+L|0,C=Wa(C^P,7);let U=0;r[U++]=s+A|0,r[U++]=a+S|0,r[U++]=c+_|0,r[U++]=l+I|0,r[U++]=u+C|0,r[U++]=h+T|0,r[U++]=d+k|0,r[U++]=f+R|0,r[U++]=p+x|0,r[U++]=g+P|0,r[U++]=y+D|0,r[U++]=m+O|0,r[U++]=v+N|0,r[U++]=b+B|0,r[U++]=w+L|0,r[U++]=E+M|0}const nc=ec(tc,{counterRight:!1,counterLength:4,allowShortKeys:!1}),rc=ec(tc,{counterRight:!1,counterLength:8,extendNonceFn:function(e,t,n,r){let i=e[0],o=e[1],s=e[2],a=e[3],c=t[0],l=t[1],u=t[2],h=t[3],d=t[4],f=t[5],p=t[6],g=t[7],y=n[0],m=n[1],v=n[2],b=n[3];for(let E=0;E<20;E+=2)i=i+c|0,y=Wa(y^i,16),d=d+y|0,c=Wa(c^d,12),i=i+c|0,y=Wa(y^i,8),d=d+y|0,c=Wa(c^d,7),o=o+l|0,m=Wa(m^o,16),f=f+m|0,l=Wa(l^f,12),o=o+l|0,m=Wa(m^o,8),f=f+m|0,l=Wa(l^f,7),s=s+u|0,v=Wa(v^s,16),p=p+v|0,u=Wa(u^p,12),s=s+u|0,v=Wa(v^s,8),p=p+v|0,u=Wa(u^p,7),a=a+h|0,b=Wa(b^a,16),g=g+b|0,h=Wa(h^g,12),a=a+h|0,b=Wa(b^a,8),g=g+b|0,h=Wa(h^g,7),i=i+l|0,b=Wa(b^i,16),p=p+b|0,l=Wa(l^p,12),i=i+l|0,b=Wa(b^i,8),p=p+b|0,l=Wa(l^p,7),o=o+u|0,y=Wa(y^o,16),g=g+y|0,u=Wa(u^g,12),o=o+u|0,y=Wa(y^o,8),g=g+y|0,u=Wa(u^g,7),s=s+h|0,m=Wa(m^s,16),d=d+m|0,h=Wa(h^d,12),s=s+h|0,m=Wa(m^s,8),d=d+m|0,h=Wa(h^d,7),a=a+c|0,v=Wa(v^a,16),f=f+v|0,c=Wa(c^f,12),a=a+c|0,v=Wa(v^a,8),f=f+v|0,c=Wa(c^f,7);let w=0;r[w++]=i,r[w++]=o,r[w++]=s,r[w++]=a,r[w++]=y,r[w++]=m,r[w++]=v,r[w++]=b},allowShortKeys:!1}),ic=new Uint8Array(16),oc=(e,t)=>{e.update(t);const n=t.length%16;n&&e.update(ic.subarray(n))},sc=new Uint8Array(32);function ac(e,t,n,r,i){const o=e(t,n,sc),s=za.create(o);i&&oc(s,i),oc(s,r);const a=new Uint8Array(16),c=Ra(a);Ba(c,0,BigInt(i?i.length:0),!0),Ba(c,8,BigInt(r.length),!0),s.update(a);const l=s.digest();return o.fill(0),l}const cc=e=>(t,n,r)=>{const i=16;return Oa(t,32),Oa(n),{encrypt:(o,s)=>{const a=o.length,c=a+i;s?Oa(s,c):s=new Uint8Array(c),e(t,n,o,s,1);const l=ac(e,t,n,s.subarray(0,-16),r);return s.set(l,a),s},decrypt:(o,s)=>{const a=o.length,c=a-i;if(a<i)throw new Error("encrypted data must be at least ".concat(i," bytes"));s?Oa(s,c):s=new Uint8Array(c);const l=o.subarray(0,-16);if(!function(e,t){if(e.length!==t.length)throw new Error("equalBytes: Different size of Uint8Arrays");let n=!0;for(let r=0;r<e.length;r++)n&&(n=e[r]===t[r]);return n}(o.subarray(-16),ac(e,t,n,l,r)))throw new Error("invalid tag");return e(t,n,l,s,1),s}}},lc=Na({blockSize:64,nonceLength:12,tagLength:16},cc(nc));cc(rc);function uc(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("Wrong positive integer: ".concat(e))}function hc(e){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(n.length>0&&!n.includes(e.length))throw new Error("Expected Uint8Array of length ".concat(n,", not of length=").concat(e.length))}function dc(e){if("function"!==typeof e||"function"!==typeof e.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");uc(e.outputLen),uc(e.blockLen)}function fc(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function pc(e,t){hc(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least ".concat(n))}const gc="object"===typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,yc=e=>e instanceof Uint8Array,mc=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),vc=(e,t)=>e<<32-t|e>>>t;if(!(68===new Uint8Array(new Uint32Array([287454020]).buffer)[0]))throw new Error("Non little-endian hardware is not supported");function bc(e){if("string"!==typeof e)throw new Error("utf8ToBytes expected string, got ".concat(typeof e));return new Uint8Array((new TextEncoder).encode(e))}function wc(e){if("string"===typeof e&&(e=bc(e)),!yc(e))throw new Error("expected Uint8Array, got ".concat(typeof e));return e}function Ec(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=new Uint8Array(t.reduce(((e,t)=>e+t.length),0));let i=0;return t.forEach((e=>{if(!yc(e))throw new Error("Uint8Array expected");r.set(e,i),i+=e.length})),r}class Ac{clone(){return this._cloneInto()}}function Sc(e){const t=t=>e().update(wc(t)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function _c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;if(gc&&"function"===typeof gc.getRandomValues)return gc.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}class Ic extends Ac{constructor(e,t,n,r){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=mc(this.buffer)}update(e){fc(this);const{view:t,buffer:n,blockLen:r}=this,i=(e=wc(e)).length;for(let o=0;o<i;){const s=Math.min(r-this.pos,i-o);if(s!==r)n.set(e.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===r&&(this.process(t,0),this.pos=0);else{const t=mc(e);for(;r<=i-o;o+=r)this.process(t,o)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){fc(this),pc(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:r,isLE:i}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>r-o&&(this.process(n,0),o=0);for(let u=o;u<r;u++)t[u]=0;!function(e,t,n,r){if("function"===typeof e.setBigUint64)return e.setBigUint64(t,n,r);const i=BigInt(32),o=BigInt(4294967295),s=Number(n>>i&o),a=Number(n&o),c=r?4:0,l=r?0:4;e.setUint32(t+c,s,r),e.setUint32(t+l,a,r)}(n,r-8,BigInt(8*this.length),i),this.process(n,0);const s=mc(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,l=this.get();if(c>l.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<c;u++)s.setUint32(4*u,l[u],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:r,finished:i,destroyed:o,pos:s}=this;return e.length=r,e.pos=s,e.finished=i,e.destroyed=o,r%t&&e.buffer.set(n),e}}const Cc=BigInt(2**32-1),Tc=BigInt(32);function kc(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?{h:Number(e&Cc),l:Number(e>>Tc&Cc)}:{h:0|Number(e>>Tc&Cc),l:0|Number(e&Cc)}}const Rc={fromBig:kc,split:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=new Uint32Array(e.length),r=new Uint32Array(e.length);for(let i=0;i<e.length;i++){const{h:o,l:s}=kc(e[i],t);[n[i],r[i]]=[o,s]}return[n,r]},toBig:(e,t)=>BigInt(e>>>0)<<Tc|BigInt(t>>>0),shrSH:(e,t,n)=>e>>>n,shrSL:(e,t,n)=>e<<32-n|t>>>n,rotrSH:(e,t,n)=>e>>>n|t<<32-n,rotrSL:(e,t,n)=>e<<32-n|t>>>n,rotrBH:(e,t,n)=>e<<64-n|t>>>n-32,rotrBL:(e,t,n)=>e>>>n-32|t<<64-n,rotr32H:(e,t)=>t,rotr32L:(e,t)=>e,rotlSH:(e,t,n)=>e<<n|t>>>32-n,rotlSL:(e,t,n)=>t<<n|e>>>32-n,rotlBH:(e,t,n)=>t<<n-32|e>>>64-n,rotlBL:(e,t,n)=>e<<n-32|t>>>64-n,add:function(e,t,n,r){const i=(t>>>0)+(r>>>0);return{h:e+n+(i/2**32|0)|0,l:0|i}},add3L:(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),add3H:(e,t,n,r)=>t+n+r+(e/2**32|0)|0,add4L:(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),add4H:(e,t,n,r,i)=>t+n+r+i+(e/2**32|0)|0,add5H:(e,t,n,r,i,o)=>t+n+r+i+o+(e/2**32|0)|0,add5L:(e,t,n,r,i)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(i>>>0)},[xc,Pc]=(()=>Rc.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((e=>BigInt(e)))))(),Dc=new Uint32Array(80),Oc=new Uint32Array(80);class Nc extends Ic{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:n,Bl:r,Ch:i,Cl:o,Dh:s,Dl:a,Eh:c,El:l,Fh:u,Fl:h,Gh:d,Gl:f,Hh:p,Hl:g}=this;return[e,t,n,r,i,o,s,a,c,l,u,h,d,f,p,g]}set(e,t,n,r,i,o,s,a,c,l,u,h,d,f,p,g){this.Ah=0|e,this.Al=0|t,this.Bh=0|n,this.Bl=0|r,this.Ch=0|i,this.Cl=0|o,this.Dh=0|s,this.Dl=0|a,this.Eh=0|c,this.El=0|l,this.Fh=0|u,this.Fl=0|h,this.Gh=0|d,this.Gl=0|f,this.Hh=0|p,this.Hl=0|g}process(e,t){for(let v=0;v<16;v++,t+=4)Dc[v]=e.getUint32(t),Oc[v]=e.getUint32(t+=4);for(let v=16;v<80;v++){const e=0|Dc[v-15],t=0|Oc[v-15],n=Rc.rotrSH(e,t,1)^Rc.rotrSH(e,t,8)^Rc.shrSH(e,t,7),r=Rc.rotrSL(e,t,1)^Rc.rotrSL(e,t,8)^Rc.shrSL(e,t,7),i=0|Dc[v-2],o=0|Oc[v-2],s=Rc.rotrSH(i,o,19)^Rc.rotrBH(i,o,61)^Rc.shrSH(i,o,6),a=Rc.rotrSL(i,o,19)^Rc.rotrBL(i,o,61)^Rc.shrSL(i,o,6),c=Rc.add4L(r,a,Oc[v-7],Oc[v-16]),l=Rc.add4H(c,n,s,Dc[v-7],Dc[v-16]);Dc[v]=0|l,Oc[v]=0|c}let{Ah:n,Al:r,Bh:i,Bl:o,Ch:s,Cl:a,Dh:c,Dl:l,Eh:u,El:h,Fh:d,Fl:f,Gh:p,Gl:g,Hh:y,Hl:m}=this;for(let v=0;v<80;v++){const e=Rc.rotrSH(u,h,14)^Rc.rotrSH(u,h,18)^Rc.rotrBH(u,h,41),t=Rc.rotrSL(u,h,14)^Rc.rotrSL(u,h,18)^Rc.rotrBL(u,h,41),b=u&d^~u&p,w=h&f^~h&g,E=Rc.add5L(m,t,w,Pc[v],Oc[v]),A=Rc.add5H(E,y,e,b,xc[v],Dc[v]),S=0|E,_=Rc.rotrSH(n,r,28)^Rc.rotrBH(n,r,34)^Rc.rotrBH(n,r,39),I=Rc.rotrSL(n,r,28)^Rc.rotrBL(n,r,34)^Rc.rotrBL(n,r,39),C=n&i^n&s^i&s,T=r&o^r&a^o&a;y=0|p,m=0|g,p=0|d,g=0|f,d=0|u,f=0|h,({h:u,l:h}=Rc.add(0|c,0|l,0|A,0|S)),c=0|s,l=0|a,s=0|i,a=0|o,i=0|n,o=0|r;const k=Rc.add3L(S,I,T);n=Rc.add3H(k,A,_,C),r=0|k}({h:n,l:r}=Rc.add(0|this.Ah,0|this.Al,0|n,0|r)),({h:i,l:o}=Rc.add(0|this.Bh,0|this.Bl,0|i,0|o)),({h:s,l:a}=Rc.add(0|this.Ch,0|this.Cl,0|s,0|a)),({h:c,l:l}=Rc.add(0|this.Dh,0|this.Dl,0|c,0|l)),({h:u,l:h}=Rc.add(0|this.Eh,0|this.El,0|u,0|h)),({h:d,l:f}=Rc.add(0|this.Fh,0|this.Fl,0|d,0|f)),({h:p,l:g}=Rc.add(0|this.Gh,0|this.Gl,0|p,0|g)),({h:y,l:m}=Rc.add(0|this.Hh,0|this.Hl,0|y,0|m)),this.set(n,r,i,o,s,a,c,l,u,h,d,f,p,g,y,m)}roundClean(){Dc.fill(0),Oc.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const Bc=Sc((()=>new Nc)),Lc=(BigInt(0),BigInt(1)),Mc=BigInt(2),Uc=e=>e instanceof Uint8Array,Fc=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function Kc(e){if(!Uc(e))throw new Error("Uint8Array expected");let t="";for(let n=0;n<e.length;n++)t+=Fc[e[n]];return t}function jc(e){if("string"!==typeof e)throw new Error("hex string expected, got "+typeof e);return BigInt(""===e?"0":"0x".concat(e))}function Zc(e){if("string"!==typeof e)throw new Error("hex string expected, got "+typeof e);const t=e.length;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(t/2);for(let r=0;r<n.length;r++){const t=2*r,i=e.slice(t,t+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");n[r]=o}return n}function zc(e){return jc(Kc(e))}function Vc(e){if(!Uc(e))throw new Error("Uint8Array expected");return jc(Kc(Uint8Array.from(e).reverse()))}function Hc(e,t){return Zc(e.toString(16).padStart(2*t,"0"))}function qc(e,t){return Hc(e,t).reverse()}function Gc(e,t,n){let r;if("string"===typeof t)try{r=Zc(t)}catch(o){throw new Error("".concat(e,' must be valid hex string, got "').concat(t,'". Cause: ').concat(o))}else{if(!Uc(t))throw new Error("".concat(e," must be hex string or Uint8Array"));r=Uint8Array.from(t)}const i=r.length;if("number"===typeof n&&i!==n)throw new Error("".concat(e," expected ").concat(n," bytes, got ").concat(i));return r}function Wc(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=new Uint8Array(t.reduce(((e,t)=>e+t.length),0));let i=0;return t.forEach((e=>{if(!Uc(e))throw new Error("Uint8Array expected");r.set(e,i),i+=e.length})),r}const Qc=e=>(Mc<<BigInt(e-1))-Lc,Yc=e=>new Uint8Array(e),Jc=e=>Uint8Array.from(e);function Xc(e,t,n){if("number"!==typeof e||e<2)throw new Error("hashLen must be a number");if("number"!==typeof t||t<2)throw new Error("qByteLen must be a number");if("function"!==typeof n)throw new Error("hmacFn must be a function");let r=Yc(e),i=Yc(e),o=0;const s=()=>{r.fill(1),i.fill(0),o=0},a=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return n(i,r,...t)},c=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Yc();i=a(Jc([0]),e),r=a(),0!==e.length&&(i=a(Jc([1]),e),r=a())},l=()=>{if(o++>=1e3)throw new Error("drbg: tried 1000 values");let e=0;const n=[];for(;e<t;){r=a();const t=r.slice();n.push(t),e+=r.length}return Wc(...n)};return(e,t)=>{let n;for(s(),c(e);!(n=t(l()));)c();return s(),n}}const $c={bigint:e=>"bigint"===typeof e,function:e=>"function"===typeof e,boolean:e=>"boolean"===typeof e,string:e=>"string"===typeof e,stringOrUint8Array:e=>"string"===typeof e||e instanceof Uint8Array,isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"===typeof e&&Number.isSafeInteger(e.outputLen)};function el(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=(t,n,r)=>{const i=$c[n];if("function"!==typeof i)throw new Error('Invalid validator "'.concat(n,'", expected function'));const o=e[t];if((!r||void 0!==o)&&!i(o,e))throw new Error("Invalid param ".concat(String(t),"=").concat(o," (").concat(typeof o,"), expected ").concat(n))};for(const[i,o]of Object.entries(t))r(i,o,!1);for(const[i,o]of Object.entries(n))r(i,o,!0);return e}const tl=BigInt(0),nl=BigInt(1),rl=BigInt(2),il=BigInt(3),ol=BigInt(4),sl=BigInt(5),al=BigInt(8);BigInt(9),BigInt(16);function cl(e,t){const n=e%t;return n>=tl?n:t+n}function ll(e,t,n){if(n<=tl||t<tl)throw new Error("Expected power/modulo > 0");if(n===nl)return tl;let r=nl;for(;t>tl;)t&nl&&(r=r*e%n),e=e*e%n,t>>=nl;return r}function ul(e,t,n){let r=e;for(;t-- >tl;)r*=r,r%=n;return r}function hl(e,t){if(e===tl||t<=tl)throw new Error("invert: expected positive integers, got n=".concat(e," mod=").concat(t));let n=cl(e,t),r=t,i=tl,o=nl,s=nl,a=tl;for(;n!==tl;){const e=r/n,t=r%n,c=i-s*e,l=o-a*e;r=n,n=t,i=s,o=a,s=c,a=l}if(r!==nl)throw new Error("invert: does not exist");return cl(i,t)}function dl(e){if(e%ol===il){const t=(e+nl)/ol;return function(e,n){const r=e.pow(n,t);if(!e.eql(e.sqr(r),n))throw new Error("Cannot find square root");return r}}if(e%al===sl){const t=(e-sl)/al;return function(e,n){const r=e.mul(n,rl),i=e.pow(r,t),o=e.mul(n,i),s=e.mul(e.mul(o,rl),i),a=e.mul(o,e.sub(s,e.ONE));if(!e.eql(e.sqr(a),n))throw new Error("Cannot find square root");return a}}return function(e){const t=(e-nl)/rl;let n,r,i;for(n=e-nl,r=0;n%rl===tl;n/=rl,r++);for(i=rl;i<e&&ll(i,t,e)!==e-nl;i++);if(1===r){const t=(e+nl)/ol;return function(e,n){const r=e.pow(n,t);if(!e.eql(e.sqr(r),n))throw new Error("Cannot find square root");return r}}const o=(n+nl)/rl;return function(e,s){if(e.pow(s,t)===e.neg(e.ONE))throw new Error("Cannot find square root");let a=r,c=e.pow(e.mul(e.ONE,i),n),l=e.pow(s,o),u=e.pow(s,n);for(;!e.eql(u,e.ONE);){if(e.eql(u,e.ZERO))return e.ZERO;let t=1;for(let r=e.sqr(u);t<a&&!e.eql(r,e.ONE);t++)r=e.sqr(r);const n=e.pow(c,nl<<BigInt(a-t-1));c=e.sqr(n),l=e.mul(l,n),u=e.mul(u,c),a=t}return l}}(e)}const fl=(e,t)=>(cl(e,t)&nl)===nl,pl=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function gl(e,t){const n=void 0!==t?t:e.toString(2).length;return{nBitLength:n,nByteLength:Math.ceil(n/8)}}function yl(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(e<=tl)throw new Error("Expected Field ORDER > 0, got ".concat(e));const{nBitLength:i,nByteLength:o}=gl(e,t);if(o>2048)throw new Error("Field lengths over 2048 bytes are not supported");const s=dl(e),a=Object.freeze({ORDER:e,BITS:i,BYTES:o,MASK:Qc(i),ZERO:tl,ONE:nl,create:t=>cl(t,e),isValid:t=>{if("bigint"!==typeof t)throw new Error("Invalid field element: expected bigint, got ".concat(typeof t));return tl<=t&&t<e},is0:e=>e===tl,isOdd:e=>(e&nl)===nl,neg:t=>cl(-t,e),eql:(e,t)=>e===t,sqr:t=>cl(t*t,e),add:(t,n)=>cl(t+n,e),sub:(t,n)=>cl(t-n,e),mul:(t,n)=>cl(t*n,e),pow:(e,t)=>function(e,t,n){if(n<tl)throw new Error("Expected power > 0");if(n===tl)return e.ONE;if(n===nl)return t;let r=e.ONE,i=t;for(;n>tl;)n&nl&&(r=e.mul(r,i)),i=e.sqr(i),n>>=nl;return r}(a,e,t),div:(t,n)=>cl(t*hl(n,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>hl(t,e),sqrt:r.sqrt||(e=>s(a,e)),invertBatch:e=>function(e,t){const n=new Array(t.length),r=t.reduce(((t,r,i)=>e.is0(r)?t:(n[i]=t,e.mul(t,r))),e.ONE),i=e.inv(r);return t.reduceRight(((t,r,i)=>e.is0(r)?t:(n[i]=e.mul(t,n[i]),e.mul(t,r))),i),n}(a,e),cmov:(e,t,n)=>n?t:e,toBytes:e=>n?qc(e,o):Hc(e,o),fromBytes:e=>{if(e.length!==o)throw new Error("Fp.fromBytes: expected ".concat(o,", got ").concat(e.length));return n?Vc(e):zc(e)}});return Object.freeze(a)}function ml(e){if("bigint"!==typeof e)throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function vl(e){const t=ml(e);return t+Math.ceil(t/2)}const bl=BigInt(0),wl=BigInt(1);function El(e,t){const n=(e,t)=>{const n=t.negate();return e?n:t},r=e=>({windows:Math.ceil(t/e)+1,windowSize:2**(e-1)});return{constTimeNegate:n,unsafeLadder(t,n){let r=e.ZERO,i=t;for(;n>bl;)n&wl&&(r=r.add(i)),i=i.double(),n>>=wl;return r},precomputeWindow(e,t){const{windows:n,windowSize:i}=r(t),o=[];let s=e,a=s;for(let r=0;r<n;r++){a=s,o.push(a);for(let e=1;e<i;e++)a=a.add(s),o.push(a);s=a.double()}return o},wNAF(t,i,o){const{windows:s,windowSize:a}=r(t);let c=e.ZERO,l=e.BASE;const u=BigInt(2**t-1),h=2**t,d=BigInt(t);for(let e=0;e<s;e++){const t=e*a;let r=Number(o&u);o>>=d,r>a&&(r-=h,o+=wl);const s=t,f=t+Math.abs(r)-1,p=e%2!==0,g=r<0;0===r?l=l.add(n(p,i[s])):c=c.add(n(g,i[f]))}return{p:c,f:l}},wNAFCached(e,t,n,r){const i=e._WINDOW_SIZE||1;let o=t.get(e);return o||(o=this.precomputeWindow(e,i),1!==i&&t.set(e,r(o))),this.wNAF(i,o,n)}}}function Al(e){return function(e){const t=pl.reduce(((e,t)=>(e[t]="function",e)),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"});el(e,t)}(e.Fp),el(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...gl(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}const Sl=BigInt(0),_l=BigInt(1),Il=BigInt(2),Cl=BigInt(8),Tl={zip215:!0};function kl(e){const t=function(e){const t=Al(e);return el(e,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}(e),{Fp:n,n:r,prehash:i,hash:o,randomBytes:s,nByteLength:a,h:c}=t,l=Il<<BigInt(8*a)-_l,u=n.create,h=t.uvRatio||((e,t)=>{try{return{isValid:!0,value:n.sqrt(e*n.inv(t))}}catch(r){return{isValid:!1,value:Sl}}}),d=t.adjustScalarBytes||(e=>e),f=t.domain||((e,t,n)=>{if(t.length||n)throw new Error("Contexts/pre-hash are not supported");return e}),p=e=>"bigint"===typeof e&&Sl<e,g=(e,t)=>p(e)&&p(t)&&e<t,y=e=>e===Sl||g(e,l);function m(e,t){if(g(e,t))return e;throw new Error("Expected valid scalar < ".concat(t,", got ").concat(typeof e," ").concat(e))}function v(e){return e===Sl?e:m(e,r)}const b=new Map;function w(e){if(!(e instanceof E))throw new Error("ExtendedPoint expected")}class E{constructor(e,t,n,r){if(this.ex=e,this.ey=t,this.ez=n,this.et=r,!y(e))throw new Error("x required");if(!y(t))throw new Error("y required");if(!y(n))throw new Error("z required");if(!y(r))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(e){if(e instanceof E)throw new Error("extended point not allowed");const{x:t,y:n}=e||{};if(!y(t)||!y(n))throw new Error("invalid affine point");return new E(t,n,_l,u(t*n))}static normalizeZ(e){const t=n.invertBatch(e.map((e=>e.ez)));return e.map(((e,n)=>e.toAffine(t[n]))).map(E.fromAffine)}_setWindowSize(e){this._WINDOW_SIZE=e,b.delete(this)}assertValidity(){const{a:e,d:n}=t;if(this.is0())throw new Error("bad point: ZERO");const{ex:r,ey:i,ez:o,et:s}=this,a=u(r*r),c=u(i*i),l=u(o*o),h=u(l*l),d=u(a*e);if(u(l*u(d+c))!==u(h+u(n*u(a*c))))throw new Error("bad point: equation left != right (1)");if(u(r*i)!==u(o*s))throw new Error("bad point: equation left != right (2)")}equals(e){w(e);const{ex:t,ey:n,ez:r}=this,{ex:i,ey:o,ez:s}=e,a=u(t*s),c=u(i*r),l=u(n*s),h=u(o*r);return a===c&&l===h}is0(){return this.equals(E.ZERO)}negate(){return new E(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){const{a:e}=t,{ex:n,ey:r,ez:i}=this,o=u(n*n),s=u(r*r),a=u(Il*u(i*i)),c=u(e*o),l=n+r,h=u(u(l*l)-o-s),d=c+s,f=d-a,p=c-s,g=u(h*f),y=u(d*p),m=u(h*p),v=u(f*d);return new E(g,y,v,m)}add(e){w(e);const{a:n,d:r}=t,{ex:i,ey:o,ez:s,et:a}=this,{ex:c,ey:l,ez:h,et:d}=e;if(n===BigInt(-1)){const e=u((o-i)*(l+c)),t=u((o+i)*(l-c)),n=u(t-e);if(n===Sl)return this.double();const r=u(s*Il*d),f=u(a*Il*h),p=f+r,g=t+e,y=f-r,m=u(p*n),v=u(g*y),b=u(p*y),w=u(n*g);return new E(m,v,w,b)}const f=u(i*c),p=u(o*l),g=u(a*r*d),y=u(s*h),m=u((i+o)*(c+l)-f-p),v=y-g,b=y+g,A=u(p-n*f),S=u(m*v),_=u(b*A),I=u(m*A),C=u(v*b);return new E(S,_,C,I)}subtract(e){return this.add(e.negate())}wNAF(e){return _.wNAFCached(this,b,e,E.normalizeZ)}multiply(e){const{p:t,f:n}=this.wNAF(m(e,r));return E.normalizeZ([t,n])[0]}multiplyUnsafe(e){let t=v(e);return t===Sl?S:this.equals(S)||t===_l?this:this.equals(A)?this.wNAF(t).p:_.unsafeLadder(this,t)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return _.unsafeLadder(this,r).is0()}toAffine(e){const{ex:t,ey:r,ez:i}=this,o=this.is0();null==e&&(e=o?Cl:n.inv(i));const s=u(t*e),a=u(r*e),c=u(i*e);if(o)return{x:Sl,y:_l};if(c!==_l)throw new Error("invZ was invalid");return{x:s,y:a}}clearCofactor(){const{h:e}=t;return e===_l?this:this.multiplyUnsafe(e)}static fromHex(e){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{d:i,a:o}=t,s=n.BYTES,a=(e=Gc("pointHex",e,s)).slice(),c=e[s-1];a[s-1]=-129&c;const d=Vc(a);d===Sl||m(d,r?l:n.ORDER);const f=u(d*d),p=u(f-_l),g=u(i*f-o);let{isValid:y,value:v}=h(p,g);if(!y)throw new Error("Point.fromHex: invalid y coordinate");const b=(v&_l)===_l,w=0!==(128&c);if(!r&&v===Sl&&w)throw new Error("Point.fromHex: x=0 and x_0=1");return w!==b&&(v=u(-v)),E.fromAffine({x:v,y:d})}static fromPrivateKey(e){return T(e).point}toRawBytes(){const{x:e,y:t}=this.toAffine(),r=qc(t,n.BYTES);return r[r.length-1]|=e&_l?128:0,r}toHex(){return Kc(this.toRawBytes())}}E.BASE=new E(t.Gx,t.Gy,_l,u(t.Gx*t.Gy)),E.ZERO=new E(Sl,_l,_l,Sl);const{BASE:A,ZERO:S}=E,_=El(E,8*a);function I(e){return cl(e,r)}function C(e){return I(Vc(e))}function T(e){const t=a;e=Gc("private key",e,t);const n=Gc("hashed private key",o(e),2*t),r=d(n.slice(0,t)),i=n.slice(t,2*t),s=C(r),c=A.multiply(s),l=c.toRawBytes();return{head:r,prefix:i,scalar:s,point:c,pointBytes:l}}function k(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Uint8Array;for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const s=Wc(...n);return C(o(f(s,Gc("context",e),!!i)))}const R=Tl;A._setWindowSize(8);const x={getExtendedPublicKey:T,randomPrivateKey:()=>s(n.BYTES),precompute(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:E.BASE;return t._setWindowSize(e),t.multiply(BigInt(3)),t}};return{CURVE:t,getPublicKey:function(e){return T(e).pointBytes},sign:function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e=Gc("message",e),i&&(e=i(e));const{prefix:o,scalar:s,pointBytes:c}=T(t),l=k(r.context,o,e),u=A.multiply(l).toRawBytes(),h=I(l+k(r.context,u,c,e)*s);return v(h),Gc("result",Wc(u,qc(h,n.BYTES)),2*a)},verify:function(e,t,r){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:R;const{context:s,zip215:a}=o,c=n.BYTES;e=Gc("signature",e,2*c),t=Gc("message",t),i&&(t=i(t));const l=Vc(e.slice(c,2*c));let u,h,d;try{u=E.fromHex(r,a),h=E.fromHex(e.slice(0,c),a),d=A.multiplyUnsafe(l)}catch(p){return!1}if(!a&&u.isSmallOrder())return!1;const f=k(s,h.toRawBytes(),u.toRawBytes(),t);return h.add(u.multiplyUnsafe(f)).subtract(d).clearCofactor().equals(E.ZERO)},ExtendedPoint:E,utils:x}}const Rl=BigInt(0),xl=BigInt(1);function Pl(e){const t=(el(n=e,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...n}));var n;const{P:r}=t,i=e=>cl(e,r),o=t.montgomeryBits,s=Math.ceil(o/8),a=t.nByteLength,c=t.adjustScalarBytes||(e=>e),l=t.powPminus2||(e=>ll(e,r-BigInt(2),r));function u(e,t,n){const r=i(e*(t-n));return[t=i(t-r),n=i(n+r)]}function h(e){if("bigint"===typeof e&&Rl<=e&&e<r)return e;throw new Error("Expected valid scalar 0 < scalar < CURVE.P")}const d=(t.a-BigInt(2))/BigInt(4);function f(e){return qc(i(e),s)}function p(e,t){const n=function(e){const t=Gc("u coordinate",e,s);return a===s&&(t[a-1]&=127),Vc(t)}(t),r=function(e){const t=Gc("scalar",e);if(t.length!==s&&t.length!==a)throw new Error("Expected ".concat(s," or ").concat(a," bytes, got ").concat(t.length));return Vc(c(t))}(e),p=function(e,t){const n=h(e),r=h(t),s=n;let a,c=xl,f=Rl,p=n,g=xl,y=Rl;for(let l=BigInt(o-1);l>=Rl;l--){const e=r>>l&xl;y^=e,a=u(y,c,p),c=a[0],p=a[1],a=u(y,f,g),f=a[0],g=a[1],y=e;const t=c+f,n=i(t*t),o=c-f,h=i(o*o),m=n-h,v=p+g,b=i((p-g)*t),w=i(v*o),E=b+w,A=b-w;p=i(E*E),g=i(s*i(A*A)),c=i(n*h),f=i(m*(n+i(d*m)))}a=u(y,c,p),c=a[0],p=a[1],a=u(y,f,g),f=a[0],g=a[1];const m=l(f);return i(c*m)}(n,r);if(p===Rl)throw new Error("Invalid private or public key received");return f(p)}const g=f(t.Gu);function y(e){return p(e,g)}return{scalarMult:p,scalarMultBase:y,getSharedSecret:(e,t)=>p(e,t),getPublicKey:e=>y(e),utils:{randomPrivateKey:()=>t.randomBytes(t.nByteLength)},GuBytes:g}}const Dl=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Ol=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),Nl=(BigInt(0),BigInt(1)),Bl=BigInt(2),Ll=BigInt(5),Ml=BigInt(10),Ul=BigInt(20),Fl=BigInt(40),Kl=BigInt(80);function jl(e){const t=Dl,n=e*e%t*e%t,r=ul(n,Bl,t)*n%t,i=ul(r,Nl,t)*e%t,o=ul(i,Ll,t)*i%t,s=ul(o,Ml,t)*o%t,a=ul(s,Ul,t)*s%t,c=ul(a,Fl,t)*a%t,l=ul(c,Kl,t)*c%t,u=ul(l,Kl,t)*c%t,h=ul(u,Ml,t)*o%t;return{pow_p_5_8:ul(h,Bl,t)*e%t,b2:n}}function Zl(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function zl(e,t){const n=Dl,r=cl(t*t*t,n),i=cl(r*r*t,n);let o=cl(e*r*jl(e*i).pow_p_5_8,n);const s=cl(t*o*o,n),a=o,c=cl(o*Ol,n),l=s===e,u=s===cl(-e,n),h=s===cl(-e*Ol,n);return l&&(o=a),(u||h)&&(o=c),fl(o,n)&&(o=cl(-o,n)),{isValid:l||u,value:o}}const Vl=yl(Dl,void 0,!0),Hl={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Vl,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:Bc,randomBytes:_c,adjustScalarBytes:Zl,uvRatio:zl},ql=kl(Hl);function Gl(e,t,n){if(t.length>255)throw new Error("Context is too big");return Ec(bc("SigEd25519 no Ed25519 collisions"),new Uint8Array([n?1:0,t.length]),t,e)}const Wl=(()=>Pl({P:Dl,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:e=>{const t=Dl,{pow_p_5_8:n,b2:r}=jl(e);return cl(ul(n,BigInt(3),t)*r,t)},adjustScalarBytes:Zl,randomBytes:_c}))();const Ql=(Vl.ORDER+BigInt(3))/BigInt(8);Vl.pow(Bl,Ql),Vl.sqrt(Vl.neg(Vl.ONE)),Vl.ORDER,BigInt(5),BigInt(8),BigInt(486662);!function(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");const n=e.sqrt(t);e.isOdd(n)&&e.neg(n)}(Vl,Vl.neg(BigInt(486664)));BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");class Yl extends Ac{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,dc(e);const n=wc(t);if(this.iHash=e.create(),"function"!==typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const r=this.blockLen,i=new Uint8Array(r);i.set(n.length>r?e.create().update(n).digest():n);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),i.fill(0)}update(e){return fc(this),this.iHash.update(e),this}digestInto(e){fc(this),hc(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:r,destroyed:i,blockLen:o,outputLen:s}=this;return e.finished=r,e.destroyed=i,e.blockLen=o,e.outputLen=s,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Jl=(e,t,n)=>new Yl(e,t).update(n).digest();function Xl(e,t,n){return dc(e),void 0===n&&(n=new Uint8Array(e.outputLen)),Jl(e,wc(n),wc(t))}Jl.create=(e,t)=>new Yl(e,t);const $l=new Uint8Array([0]),eu=new Uint8Array;function tu(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:32;if(dc(e),uc(r),r>255*e.outputLen)throw new Error("Length should be <= 255*HashLen");const i=Math.ceil(r/e.outputLen);void 0===n&&(n=eu);const o=new Uint8Array(i*e.outputLen),s=Jl.create(e,t),a=s._cloneInto(),c=new Uint8Array(s.outputLen);for(let l=0;l<i;l++)$l[0]=l+1,a.update(0===l?eu:c).update(n).update($l).digestInto(c),o.set(c,e.outputLen*l),s._cloneInto(a);return s.destroy(),a.destroy(),c.fill(0),$l.fill(0),o.slice(0,r)}const nu=(e,t,n)=>e&t^e&n^t&n,ru=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),iu=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ou=new Uint32Array(64);class su extends Ic{constructor(){super(64,32,8,!1),this.A=0|iu[0],this.B=0|iu[1],this.C=0|iu[2],this.D=0|iu[3],this.E=0|iu[4],this.F=0|iu[5],this.G=0|iu[6],this.H=0|iu[7]}get(){const{A:e,B:t,C:n,D:r,E:i,F:o,G:s,H:a}=this;return[e,t,n,r,i,o,s,a]}set(e,t,n,r,i,o,s,a){this.A=0|e,this.B=0|t,this.C=0|n,this.D=0|r,this.E=0|i,this.F=0|o,this.G=0|s,this.H=0|a}process(e,t){for(let h=0;h<16;h++,t+=4)ou[h]=e.getUint32(t,!1);for(let h=16;h<64;h++){const e=ou[h-15],t=ou[h-2],n=vc(e,7)^vc(e,18)^e>>>3,r=vc(t,17)^vc(t,19)^t>>>10;ou[h]=r+ou[h-7]+n+ou[h-16]|0}let{A:n,B:r,C:i,D:o,E:s,F:a,G:c,H:l}=this;for(let h=0;h<64;h++){const e=l+(vc(s,6)^vc(s,11)^vc(s,25))+((u=s)&a^~u&c)+ru[h]+ou[h]|0,t=(vc(n,2)^vc(n,13)^vc(n,22))+nu(n,r,i)|0;l=c,c=a,a=s,s=o+e|0,o=i,i=r,r=n,n=e+t|0}var u;n=n+this.A|0,r=r+this.B|0,i=i+this.C|0,o=o+this.D|0,s=s+this.E|0,a=a+this.F|0,c=c+this.G|0,l=l+this.H|0,this.set(n,r,i,o,s,a,c,l)}roundClean(){ou.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const au=Sc((()=>new su)),cu={hashSHA256:e=>au(e.subarray()),getHKDF(e,t){const n=Xl(au,t,e),r=tu(au,n,void 0,96);return[r.subarray(0,32),r.subarray(32,64),r.subarray(64,96)]},generateX25519KeyPair(){const e=Wl.utils.randomPrivateKey();return{publicKey:Wl.getPublicKey(e),privateKey:e}},generateX25519KeyPairFromSeed:e=>({publicKey:Wl.getPublicKey(e),privateKey:e}),generateX25519SharedKey:(e,t)=>Wl.getSharedSecret(e.subarray(),t.subarray()),chaCha20Poly1305Encrypt:(e,t,n,r)=>lc(r,t,n).encrypt(e.subarray()),chaCha20Poly1305Decrypt:(e,t,n,r,i)=>lc(r,t,n).decrypt(e.subarray(),i)},lu=e=>{const t=(0,Us.E)(2);return new DataView(t.buffer,t.byteOffset,t.byteLength).setUint16(0,e,!1),t};lu.bytes=2;const uu=e=>{if(e.length<2)throw RangeError("Could not decode int16BE");return e instanceof Uint8Array?new DataView(e.buffer,e.byteOffset,e.byteLength).getUint16(0,!1):e.getUint16(0)};uu.bytes=2;class hu extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected Peer"),(0,Yo.Z)(this,"code",void 0),this.code=hu.code}}(0,Yo.Z)(hu,"code","ERR_UNEXPECTED_PEER");class du extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid crypto exchange"),(0,Yo.Z)(this,"code",void 0),this.code=du.code}}(0,Yo.Z)(du,"code","ERR_INVALID_CRYPTO_EXCHANGE");n(85049),n(29835);var fu=n(7619),pu=n(60392),gu=n.n(pu),yu=n(80540),mu=n(39984),vu=n(46847),bu=n(56324),wu=n(63877),Eu=n.n(wu),Au=(n(3055),n(18601));function Su(e,t){let n=Uint8Array.from(e.abs().toByteArray());if(n=0===n[0]?n.subarray(1):n,null!=t){if(n.length>t)throw new Error("byte array longer than desired length");n=(0,Ls.z)([new Uint8Array(t-n.length),n])}return(0,Au.B)(n,"base64url")}function _u(e){const t=function(e,t){let n=(0,yu.m)(e,"base64urlpad");if(null!=t){if(n.length>t)throw new Error("byte array longer than desired length");n=(0,Ls.z)([new Uint8Array(t-n.length),n])}return n}(e);return new(gu().jsbn.BigInteger)((0,Au.B)(t,"base16"),16)}function Iu(e){return null!=e&&("function"===typeof e.then&&"function"===typeof e.catch&&"function"===typeof e.finally)}const Cu=32,Tu=64,ku=32;function Ru(e,t){const n=new Uint8Array(Tu);for(let r=0;r<ku;r++)n[r]=e[r],n[ku+r]=t[r];return n}var xu=n(98117);const Pu={get(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:globalThis).crypto;if(null==e||null==e.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p/blob/main/packages/crypto/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}},Du={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};async function Ou(e,t){const n=function(e){var t,n,r,i,o,s;const a=null!==(t=null===e||void 0===e?void 0:e.algorithm)&&void 0!==t?t:"AES-GCM";let c=null!==(n=null===e||void 0===e?void 0:e.keyLength)&&void 0!==n?n:16;const l=null!==(r=null===e||void 0===e?void 0:e.nonceLength)&&void 0!==r?r:12,u=null!==(i=null===e||void 0===e?void 0:e.digest)&&void 0!==i?i:"SHA-256",h=null!==(o=null===e||void 0===e?void 0:e.saltLength)&&void 0!==o?o:16,d=null!==(s=null===e||void 0===e?void 0:e.iterations)&&void 0!==s?s:32767,f=Pu.get();return c*=8,{encrypt:async function(e,t){const n=f.getRandomValues(new Uint8Array(h)),r=f.getRandomValues(new Uint8Array(l)),i={name:a,iv:r};let o;if("string"===typeof t&&(t=(0,yu.m)(t)),0===t.length){o=await f.subtle.importKey("jwk",Du,{name:"AES-GCM"},!0,["encrypt"]);try{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);o=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["encrypt"])}catch{o=await f.subtle.importKey("jwk",Du,{name:"AES-GCM"},!0,["encrypt"])}}else{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);o=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["encrypt"])}const s=await f.subtle.encrypt(i,o,e);return(0,Ls.z)([n,i.iv,new Uint8Array(s)])},decrypt:async function(e,t){const n=e.subarray(0,h),r=e.subarray(h,h+l),i=e.subarray(h+l),o={name:a,iv:r};let s;if("string"===typeof t&&(t=(0,yu.m)(t)),0===t.length)try{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);s=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["decrypt"])}catch{s=await f.subtle.importKey("jwk",Du,{name:"AES-GCM"},!0,["decrypt"])}else{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);s=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["decrypt"])}const p=await f.subtle.decrypt(o,s,i);return new Uint8Array(p)}}}(),r=await n.encrypt(e,t);return xu.base64.encode(r)}var Nu,Bu,Lu,Mu;!function(e){e.RSA="RSA",e.Ed25519="Ed25519",e.Secp256k1="Secp256k1"}(Nu||(Nu={})),function(e){e[e.RSA=0]="RSA",e[e.Ed25519=1]="Ed25519",e[e.Secp256k1=2]="Secp256k1"}(Bu||(Bu={})),function(e){e.codec=()=>bs(Bu)}(Nu||(Nu={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),Nu.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.Type=Nu.codec().decode(e);break;case 2:n.Data=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(Lu||(Lu={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),Nu.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.Type=Nu.codec().decode(e);break;case 2:n.Data=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(Mu||(Mu={}));class Uu{constructor(e){(0,Yo.Z)(this,"_key",void 0),this._key=Vu(e,Cu)}verify(e,t){return function(e,t,n){return ql.verify(t,n instanceof Uint8Array?n:n.subarray(),e)}(this._key,t,e)}marshal(){return this._key}get bytes(){return Lu.encode({Type:Nu.Ed25519,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}hash(){const e=bu.sha256.digest(this.bytes);return Iu(e)?e.then((e=>{let{bytes:t}=e;return t})):e.bytes}}class Fu{constructor(e,t){(0,Yo.Z)(this,"_key",void 0),(0,Yo.Z)(this,"_publicKey",void 0),this._key=Vu(e,Tu),this._publicKey=Vu(t,Cu)}sign(e){return function(e,t){const n=e.subarray(0,ku);return ql.sign(t instanceof Uint8Array?t:t.subarray(),n)}(this._key,e)}get public(){return new Uu(this._publicKey)}marshal(){return this._key}get bytes(){return Mu.encode({Type:Nu.Ed25519,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const e=bu.sha256.digest(this.bytes);let t;return Iu(e)?({bytes:t}=await e):t=e.bytes,t}async id(){const e=vu.identity.digest(this.public.bytes);return mu.base58btc.encode(e.bytes).substring(1)}async export(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"libp2p-key";if("libp2p-key"===t)return Ou(this.bytes,e);throw new fu.sv("export format '".concat(t,"' is not supported"),"ERR_INVALID_EXPORT_FORMAT")}}function Ku(e){if(e.length>Tu){const t=(e=Vu(e,Tu+Cu)).subarray(0,Tu),n=e.subarray(Tu,e.length);return new Fu(t,n)}const t=(e=Vu(e,Tu)).subarray(0,Tu),n=e.subarray(Cu);return new Fu(t,n)}function ju(e){return e=Vu(e,Cu),new Uu(e)}async function Zu(){const{privateKey:e,publicKey:t}=function(){const e=ql.utils.randomPrivateKey(),t=ql.getPublicKey(e);return{privateKey:Ru(e,t),publicKey:t}}();return new Fu(e,t)}async function zu(e){const{privateKey:t,publicKey:n}=function(e){if(e.length!==ku)throw new TypeError('"seed" must be 32 bytes in length.');if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');const t=e,n=ql.getPublicKey(t);return{privateKey:Ru(t,n),publicKey:n}}(e);return new Fu(t,n)}function Vu(e,t){var n;if((e=Uint8Array.from(null!==(n=e)&&void 0!==n?n:[])).length!==t)throw new fu.sv("Key must be a Uint8Array of length ".concat(t,", got ").concat(e.length),"ERR_INVALID_KEY_TYPE");return e}const Hu={"P-256":256,"P-384":384,"P-521":521};Object.keys(Hu).join(" / ");n(34770);n(25493);function qu(e,t){return t.map((t=>_u(e[t])))}async function Gu(e){const t=[await Pu.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await Qu(e)],n=await Wu({privateKey:t[0],publicKey:t[1]});return{privateKey:n[0],publicKey:n[1]}}async function Wu(e){if(null==e.privateKey||null==e.publicKey)throw new fu.sv("Private and public key are required","ERR_INVALID_PARAMETERS");return Promise.all([Pu.get().subtle.exportKey("jwk",e.privateKey),Pu.get().subtle.exportKey("jwk",e.publicKey)])}async function Qu(e){return Pu.get().subtle.importKey("jwk",{kty:e.kty,n:e.n,e:e.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function Yu(e,t,n,r){const i=t?function(e){return gu().pki.setRsaPublicKey(...qu(e,["n","e"]))}(e):function(e){return gu().pki.setRsaPrivateKey(...qu(e,["n","e","d","p","q","dp","dq","qi"]))}(e),o=r((0,Au.B)(n instanceof Uint8Array?n:n.subarray(),"ascii"),i);return(0,yu.m)(o,"ascii")}function Ju(e){if("RSA"!==e.kty)throw new fu.sv("invalid key type","ERR_INVALID_KEY_TYPE");if(null==e.n)throw new fu.sv("invalid key modulus","ERR_INVALID_KEY_MODULUS");return 8*(0,yu.m)(e.n,"base64url").length}const Xu=8192;class $u{constructor(e){(0,Yo.Z)(this,"_key",void 0),this._key=e}verify(e,t){return async function(e,t,n){const r=await Pu.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return Pu.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},r,t,n instanceof Uint8Array?n:n.subarray())}(this._key,t,e)}marshal(){return function(e){if(null==e.n||null==e.e)throw new fu.sv("JWK was missing components","ERR_INVALID_PARAMETERS");const t=gu().pki.publicKeyToAsn1({n:_u(e.n),e:_u(e.e)});return(0,yu.m)(gu().asn1.toDer(t).getBytes(),"ascii")}(this._key)}get bytes(){return Lu.encode({Type:Nu.RSA,Data:this.marshal()}).subarray()}encrypt(e){return Yu(this._key,!0,e,((e,t)=>t.encrypt(e)))}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}hash(){const e=bu.sha256.digest(this.bytes);return Iu(e)?e.then((e=>{let{bytes:t}=e;return t})):e.bytes}}class eh{constructor(e,t){(0,Yo.Z)(this,"_key",void 0),(0,Yo.Z)(this,"_publicKey",void 0),this._key=e,this._publicKey=t}genSecret(){return function(e){if(isNaN(e)||e<=0)throw new fu.sv("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return _c(e)}(16)}sign(e){return async function(e,t){const n=await Pu.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),r=await Pu.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},n,t instanceof Uint8Array?t:t.subarray());return new Uint8Array(r,0,r.byteLength)}(this._key,e)}get public(){if(null==this._publicKey)throw new fu.sv("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new $u(this._publicKey)}decrypt(e){return Yu(this._key,!1,e,((e,t)=>t.decrypt(e)))}marshal(){return function(e){if(null==e.n||null==e.e||null==e.d||null==e.p||null==e.q||null==e.dp||null==e.dq||null==e.qi)throw new fu.sv("JWK was missing components","ERR_INVALID_PARAMETERS");const t=gu().pki.privateKeyToAsn1({n:_u(e.n),e:_u(e.e),d:_u(e.d),p:_u(e.p),q:_u(e.q),dP:_u(e.dp),dQ:_u(e.dq),qInv:_u(e.qi)});return(0,yu.m)(gu().asn1.toDer(t).getBytes(),"ascii")}(this._key)}get bytes(){return Mu.encode({Type:Nu.RSA,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}hash(){const e=bu.sha256.digest(this.bytes);return Iu(e)?e.then((e=>{let{bytes:t}=e;return t})):e.bytes}async id(){const e=await this.public.hash();return(0,Au.B)(e,"base58btc")}async export(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"pkcs-8";if("pkcs-8"===t){const t=new(gu().util.ByteBuffer)(this.marshal()),n=gu().asn1.fromDer(t),r=gu().pki.privateKeyFromAsn1(n),i={algorithm:"aes256",count:1e4,saltSize:16,prfAlgorithm:"sha512"};return gu().pki.encryptRsaPrivateKey(r,e,i)}if("libp2p-key"===t)return Ou(this.bytes,e);throw new fu.sv("export format '".concat(t,"' is not supported"),"ERR_INVALID_EXPORT_FORMAT")}}async function th(e){const t=function(e){const t=gu().asn1.fromDer((0,Au.B)(e,"ascii")),n=gu().pki.privateKeyFromAsn1(t);return{kty:"RSA",n:Su(n.n),e:Su(n.e),d:Su(n.d),p:Su(n.p),q:Su(n.q),dp:Su(n.dP),dq:Su(n.dQ),qi:Su(n.qInv),alg:"RS256"}}(e);if(Ju(t)>Xu)throw new fu.sv("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const n=await Gu(t);return new eh(n.privateKey,n.publicKey)}function nh(e){const t=function(e){const t=gu().asn1.fromDer((0,Au.B)(e,"ascii")),n=gu().pki.publicKeyFromAsn1(t);return{kty:"RSA",n:Su(n.n),e:Su(n.e)}}(e);if(Ju(t)>Xu)throw new fu.sv("key size is too large","ERR_KEY_SIZE_TOO_LARGE");return new $u(t)}async function rh(e){if(Ju(e)>Xu)throw new fu.sv("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const t=await Gu(e);return new eh(t.privateKey,t.publicKey)}async function ih(e){if(e>Xu)throw new fu.sv("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const t=await async function(e){const t=await Pu.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),n=await Wu(t);return{privateKey:n[0],publicKey:n[1]}}(e);return new eh(t.privateKey,t.publicKey)}const{bytesToNumberBE:oh,hexToBytes:sh}=r,ah={Err:class extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")}},_parseInt(e){const{Err:t}=ah;if(e.length<2||2!==e[0])throw new t("Invalid signature integer tag");const n=e[1],r=e.subarray(2,n+2);if(!n||r.length!==n)throw new t("Invalid signature integer: wrong length");if(128&r[0])throw new t("Invalid signature integer: negative");if(0===r[0]&&!(128&r[1]))throw new t("Invalid signature integer: unnecessary leading zero");return{d:oh(r),l:e.subarray(n+2)}},toSig(e){const{Err:t}=ah,n="string"===typeof e?sh(e):e;if(!(n instanceof Uint8Array))throw new Error("ui8a expected");let r=n.length;if(r<2||48!=n[0])throw new t("Invalid signature tag");if(n[1]!==r-2)throw new t("Invalid signature: incorrect length");const{d:i,l:o}=ah._parseInt(n.subarray(2)),{d:s,l:a}=ah._parseInt(o);if(a.length)throw new t("Invalid signature: left bytes after parsing");return{r:i,s:s}},hexFromSig(e){const t=e=>8&Number.parseInt(e[0],16)?"00"+e:e,n=e=>{const t=e.toString(16);return 1&t.length?"0".concat(t):t},r=t(n(e.s)),i=t(n(e.r)),o=r.length/2,s=i.length/2,a=n(o),c=n(s);return"30".concat(n(s+o+4),"02").concat(c).concat(i,"02").concat(a).concat(r)}},ch=BigInt(0),lh=BigInt(1),uh=(BigInt(2),BigInt(3));BigInt(4);function hh(e){const t=function(e){const t=Al(e);el(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:n,Fp:r,a:i}=t;if(n){if(!r.eql(i,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!==typeof n||"bigint"!==typeof n.beta||"function"!==typeof n.splitScalar)throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}(e),{Fp:n}=t,r=t.toBytes||((e,t,r)=>{const i=t.toAffine();return Wc(Uint8Array.from([4]),n.toBytes(i.x),n.toBytes(i.y))}),i=t.fromBytes||(e=>{const t=e.subarray(1);return{x:n.fromBytes(t.subarray(0,n.BYTES)),y:n.fromBytes(t.subarray(n.BYTES,2*n.BYTES))}});function o(e){const{a:r,b:i}=t,o=n.sqr(e),s=n.mul(o,e);return n.add(n.add(s,n.mul(e,r)),i)}if(!n.eql(n.sqr(t.Gy),o(t.Gx)))throw new Error("bad generator point: equation left != right");function s(e){return"bigint"===typeof e&&ch<e&&e<t.n}function a(e){if(!s(e))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(e){const{allowedPrivateKeyLengths:n,nByteLength:r,wrapPrivateKey:i,n:o}=t;if(n&&"bigint"!==typeof e){if(e instanceof Uint8Array&&(e=Kc(e)),"string"!==typeof e||!n.includes(e.length))throw new Error("Invalid key");e=e.padStart(2*r,"0")}let s;try{s="bigint"===typeof e?e:zc(Gc("private key",e,r))}catch(c){throw new Error("private key must be ".concat(r," bytes, hex or bigint, not ").concat(typeof e))}return i&&(s=cl(s,o)),a(s),s}const l=new Map;function u(e){if(!(e instanceof h))throw new Error("ProjectivePoint expected")}class h{constructor(e,t,r){if(this.px=e,this.py=t,this.pz=r,null==e||!n.isValid(e))throw new Error("x required");if(null==t||!n.isValid(t))throw new Error("y required");if(null==r||!n.isValid(r))throw new Error("z required")}static fromAffine(e){const{x:t,y:r}=e||{};if(!e||!n.isValid(t)||!n.isValid(r))throw new Error("invalid affine point");if(e instanceof h)throw new Error("projective point not allowed");const i=e=>n.eql(e,n.ZERO);return i(t)&&i(r)?h.ZERO:new h(t,r,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){const t=n.invertBatch(e.map((e=>e.pz)));return e.map(((e,n)=>e.toAffine(t[n]))).map(h.fromAffine)}static fromHex(e){const t=h.fromAffine(i(Gc("pointHex",e)));return t.assertValidity(),t}static fromPrivateKey(e){return h.BASE.multiply(c(e))}_setWindowSize(e){this._WINDOW_SIZE=e,l.delete(this)}assertValidity(){if(this.is0()){if(t.allowInfinityPoint&&!n.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:e,y:r}=this.toAffine();if(!n.isValid(e)||!n.isValid(r))throw new Error("bad point: x or y not FE");const i=n.sqr(r),s=o(e);if(!n.eql(i,s))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:e}=this.toAffine();if(n.isOdd)return!n.isOdd(e);throw new Error("Field doesn't support isOdd")}equals(e){u(e);const{px:t,py:r,pz:i}=this,{px:o,py:s,pz:a}=e,c=n.eql(n.mul(t,a),n.mul(o,i)),l=n.eql(n.mul(r,a),n.mul(s,i));return c&&l}negate(){return new h(this.px,n.neg(this.py),this.pz)}double(){const{a:e,b:r}=t,i=n.mul(r,uh),{px:o,py:s,pz:a}=this;let c=n.ZERO,l=n.ZERO,u=n.ZERO,d=n.mul(o,o),f=n.mul(s,s),p=n.mul(a,a),g=n.mul(o,s);return g=n.add(g,g),u=n.mul(o,a),u=n.add(u,u),c=n.mul(e,u),l=n.mul(i,p),l=n.add(c,l),c=n.sub(f,l),l=n.add(f,l),l=n.mul(c,l),c=n.mul(g,c),u=n.mul(i,u),p=n.mul(e,p),g=n.sub(d,p),g=n.mul(e,g),g=n.add(g,u),u=n.add(d,d),d=n.add(u,d),d=n.add(d,p),d=n.mul(d,g),l=n.add(l,d),p=n.mul(s,a),p=n.add(p,p),d=n.mul(p,g),c=n.sub(c,d),u=n.mul(p,f),u=n.add(u,u),u=n.add(u,u),new h(c,l,u)}add(e){u(e);const{px:r,py:i,pz:o}=this,{px:s,py:a,pz:c}=e;let l=n.ZERO,d=n.ZERO,f=n.ZERO;const p=t.a,g=n.mul(t.b,uh);let y=n.mul(r,s),m=n.mul(i,a),v=n.mul(o,c),b=n.add(r,i),w=n.add(s,a);b=n.mul(b,w),w=n.add(y,m),b=n.sub(b,w),w=n.add(r,o);let E=n.add(s,c);return w=n.mul(w,E),E=n.add(y,v),w=n.sub(w,E),E=n.add(i,o),l=n.add(a,c),E=n.mul(E,l),l=n.add(m,v),E=n.sub(E,l),f=n.mul(p,w),l=n.mul(g,v),f=n.add(l,f),l=n.sub(m,f),f=n.add(m,f),d=n.mul(l,f),m=n.add(y,y),m=n.add(m,y),v=n.mul(p,v),w=n.mul(g,w),m=n.add(m,v),v=n.sub(y,v),v=n.mul(p,v),w=n.add(w,v),y=n.mul(m,w),d=n.add(d,y),y=n.mul(E,w),l=n.mul(b,l),l=n.sub(l,y),y=n.mul(b,m),f=n.mul(E,f),f=n.add(f,y),new h(l,d,f)}subtract(e){return this.add(e.negate())}is0(){return this.equals(h.ZERO)}wNAF(e){return f.wNAFCached(this,l,e,(e=>{const t=n.invertBatch(e.map((e=>e.pz)));return e.map(((e,n)=>e.toAffine(t[n]))).map(h.fromAffine)}))}multiplyUnsafe(e){const r=h.ZERO;if(e===ch)return r;if(a(e),e===lh)return this;const{endo:i}=t;if(!i)return f.unsafeLadder(this,e);let{k1neg:o,k1:s,k2neg:c,k2:l}=i.splitScalar(e),u=r,d=r,p=this;for(;s>ch||l>ch;)s&lh&&(u=u.add(p)),l&lh&&(d=d.add(p)),p=p.double(),s>>=lh,l>>=lh;return o&&(u=u.negate()),c&&(d=d.negate()),d=new h(n.mul(d.px,i.beta),d.py,d.pz),u.add(d)}multiply(e){a(e);let r,i,o=e;const{endo:s}=t;if(s){const{k1neg:e,k1:t,k2neg:a,k2:c}=s.splitScalar(o);let{p:l,f:u}=this.wNAF(t),{p:d,f:p}=this.wNAF(c);l=f.constTimeNegate(e,l),d=f.constTimeNegate(a,d),d=new h(n.mul(d.px,s.beta),d.py,d.pz),r=l.add(d),i=u.add(p)}else{const{p:e,f:t}=this.wNAF(o);r=e,i=t}return h.normalizeZ([r,i])[0]}multiplyAndAddUnsafe(e,t,n){const r=h.BASE,i=(e,t)=>t!==ch&&t!==lh&&e.equals(r)?e.multiply(t):e.multiplyUnsafe(t),o=i(this,t).add(i(e,n));return o.is0()?void 0:o}toAffine(e){const{px:t,py:r,pz:i}=this,o=this.is0();null==e&&(e=o?n.ONE:n.inv(i));const s=n.mul(t,e),a=n.mul(r,e),c=n.mul(i,e);if(o)return{x:n.ZERO,y:n.ZERO};if(!n.eql(c,n.ONE))throw new Error("invZ was invalid");return{x:s,y:a}}isTorsionFree(){const{h:e,isTorsionFree:n}=t;if(e===lh)return!0;if(n)return n(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:e,clearCofactor:n}=t;return e===lh?this:n?n(h,this):this.multiplyUnsafe(t.h)}toRawBytes(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.assertValidity(),r(h,this,e)}toHex(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return Kc(this.toRawBytes(e))}}h.BASE=new h(t.Gx,t.Gy,n.ONE),h.ZERO=new h(n.ZERO,n.ONE,n.ZERO);const d=t.nBitLength,f=El(h,t.endo?Math.ceil(d/2):d);return{CURVE:t,ProjectivePoint:h,normPrivateKeyToScalar:c,weierstrassEquation:o,isWithinCurveOrder:s}}function dh(e){const t=function(e){const t=Al(e);return el(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}(e),{Fp:n,n:r}=t,i=n.BYTES+1,o=2*n.BYTES+1;function s(e){return cl(e,r)}function a(e){return hl(e,r)}const{ProjectivePoint:c,normPrivateKeyToScalar:l,weierstrassEquation:u,isWithinCurveOrder:h}=hh({...t,toBytes(e,t,r){const i=t.toAffine(),o=n.toBytes(i.x),s=Wc;return r?s(Uint8Array.from([t.hasEvenY()?2:3]),o):s(Uint8Array.from([4]),o,n.toBytes(i.y))},fromBytes(e){const t=e.length,r=e[0],s=e.subarray(1);if(t!==i||2!==r&&3!==r){if(t===o&&4===r){return{x:n.fromBytes(s.subarray(0,n.BYTES)),y:n.fromBytes(s.subarray(n.BYTES,2*n.BYTES))}}throw new Error("Point of length ".concat(t," was invalid. Expected ").concat(i," compressed bytes or ").concat(o," uncompressed bytes"))}{const e=zc(s);if(!(ch<(a=e)&&a<n.ORDER))throw new Error("Point is not on curve");const t=u(e);let i=n.sqrt(t);return 1===(1&r)!==((i&lh)===lh)&&(i=n.neg(i)),{x:e,y:i}}var a}}),d=e=>Kc(Hc(e,t.nByteLength));function f(e){return e>r>>lh}const p=(e,t,n)=>zc(e.slice(t,n));class g{constructor(e,t,n){this.r=e,this.s=t,this.recovery=n,this.assertValidity()}static fromCompact(e){const n=t.nByteLength;return e=Gc("compactSignature",e,2*n),new g(p(e,0,n),p(e,n,2*n))}static fromDER(e){const{r:t,s:n}=ah.toSig(Gc("DER",e));return new g(t,n)}assertValidity(){if(!h(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!h(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(e){return new g(this.r,this.s,e)}recoverPublicKey(e){const{r:r,s:i,recovery:o}=this,l=b(Gc("msgHash",e));if(null==o||![0,1,2,3].includes(o))throw new Error("recovery id invalid");const u=2===o||3===o?r+t.n:r;if(u>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const h=0===(1&o)?"02":"03",f=c.fromHex(h+d(u)),p=a(u),g=s(-l*p),y=s(i*p),m=c.BASE.multiplyAndAddUnsafe(f,g,y);if(!m)throw new Error("point at infinify");return m.assertValidity(),m}hasHighS(){return f(this.s)}normalizeS(){return this.hasHighS()?new g(this.r,s(-this.s),this.recovery):this}toDERRawBytes(){return Zc(this.toDERHex())}toDERHex(){return ah.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Zc(this.toCompactHex())}toCompactHex(){return d(this.r)+d(this.s)}}const y={isValidPrivateKey(e){try{return l(e),!0}catch(t){return!1}},normPrivateKeyToScalar:l,randomPrivateKey:()=>{const e=vl(t.n);return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=e.length,i=ml(t),o=vl(t);if(r<16||r<o||r>1024)throw new Error("expected ".concat(o,"-1024 bytes of input, got ").concat(r));const s=cl(n?zc(e):Vc(e),t-nl)+nl;return n?qc(s,i):Hc(s,i)}(t.randomBytes(e),t.n)},precompute(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.BASE;return t._setWindowSize(e),t.multiply(BigInt(3)),t}};function m(e){const t=e instanceof Uint8Array,n="string"===typeof e,r=(t||n)&&e.length;return t?r===i||r===o:n?r===2*i||r===2*o:e instanceof c}const v=t.bits2int||function(e){const n=zc(e),r=8*e.length-t.nBitLength;return r>0?n>>BigInt(r):n},b=t.bits2int_modN||function(e){return s(v(e))},w=Qc(t.nBitLength);function E(e){if("bigint"!==typeof e)throw new Error("bigint expected");if(!(ch<=e&&e<w))throw new Error("bigint expected < 2^".concat(t.nBitLength));return Hc(e,t.nByteLength)}function A(e,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:S;if(["recovered","canonical"].some((e=>e in i)))throw new Error("sign() legacy options not supported");const{hash:o,randomBytes:u}=t;let{lowS:d,prehash:p,extraEntropy:y}=i;null==d&&(d=!0),e=Gc("msgHash",e),p&&(e=Gc("prehashed msgHash",o(e)));const m=b(e),w=l(r),A=[E(w),E(m)];if(null!=y){const e=!0===y?u(n.BYTES):y;A.push(Gc("extraEntropy",e))}const _=Wc(...A),I=m;return{seed:_,k2sig:function(e){const t=v(e);if(!h(t))return;const n=a(t),r=c.BASE.multiply(t).toAffine(),i=s(r.x);if(i===ch)return;const o=s(n*s(I+i*w));if(o===ch)return;let l=(r.x===i?0:2)|Number(r.y&lh),u=o;return d&&f(o)&&(u=function(e){return f(e)?s(-e):e}(o),l^=1),new g(i,u,l)}}}const S={lowS:t.lowS,prehash:!1},_={lowS:t.lowS,prehash:!1};return c.BASE._setWindowSize(8),{CURVE:t,getPublicKey:function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return c.fromPrivateKey(e).toRawBytes(t)},getSharedSecret:function(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(m(e))throw new Error("first arg must be private key");if(!m(t))throw new Error("second arg must be public key");return c.fromHex(t).multiply(l(e)).toRawBytes(n)},sign:function(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:S;const{seed:i,k2sig:o}=A(e,n,r),s=t;return Xc(s.hash.outputLen,s.nByteLength,s.hmac)(i,o)},verify:function(e,n,r){var i;let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:_;const l=e;if(n=Gc("msgHash",n),r=Gc("publicKey",r),"strict"in o)throw new Error("options.strict was renamed to lowS");const{lowS:u,prehash:h}=o;let d,f;try{if("string"===typeof l||l instanceof Uint8Array)try{d=g.fromDER(l)}catch(S){if(!(S instanceof ah.Err))throw S;d=g.fromCompact(l)}else{if("object"!==typeof l||"bigint"!==typeof l.r||"bigint"!==typeof l.s)throw new Error("PARSE");{const{r:e,s:t}=l;d=new g(e,t)}}f=c.fromHex(r)}catch(I){if("PARSE"===I.message)throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(u&&d.hasHighS())return!1;h&&(n=t.hash(n));const{r:p,s:y}=d,m=b(n),v=a(y),w=s(m*v),E=s(p*v),A=null===(i=c.BASE.multiplyAndAddUnsafe(f,w,E))||void 0===i?void 0:i.toAffine();return!!A&&s(A.x)===p},ProjectivePoint:c,Signature:g,utils:y}}function fh(e){return{hash:e,hmac:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return Jl(e,t,Ec(...r))},randomBytes:_c}}const ph=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),gh=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),yh=BigInt(1),mh=BigInt(2),vh=(e,t)=>(e+t/mh)/t;function bh(e){const t=ph,n=BigInt(3),r=BigInt(6),i=BigInt(11),o=BigInt(22),s=BigInt(23),a=BigInt(44),c=BigInt(88),l=e*e*e%t,u=l*l*e%t,h=ul(u,n,t)*u%t,d=ul(h,n,t)*u%t,f=ul(d,mh,t)*l%t,p=ul(f,i,t)*f%t,g=ul(p,o,t)*p%t,y=ul(g,a,t)*g%t,m=ul(y,c,t)*y%t,v=ul(m,a,t)*g%t,b=ul(v,n,t)*u%t,w=ul(b,s,t)*p%t,E=ul(w,r,t)*l%t,A=ul(E,mh,t);if(!wh.eql(wh.sqr(A),e))throw new Error("Cannot find square root");return A}const wh=yl(ph,void 0,void 0,{sqrt:bh}),Eh=function(e,t){const n=t=>dh({...e,...fh(t)});return Object.freeze({...n(t),create:n})}({a:BigInt(0),b:BigInt(7),Fp:wh,n:gh,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{const t=gh,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-yh*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=n,s=BigInt("0x100000000000000000000000000000000"),a=vh(o*e,t),c=vh(-r*e,t);let l=cl(e-a*n-c*i,t),u=cl(-a*r-c*o,t);const h=l>s,d=u>s;if(h&&(l=t-l),d&&(u=t-u),l>s||u>s)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:h,k1:l,k2neg:d,k2:u}}}},au);BigInt(0);Eh.ProjectivePoint;function Ah(e){try{Eh.ProjectivePoint.fromHex(e)}catch(t){throw new fu.sv(String(t),"ERR_INVALID_PUBLIC_KEY")}}class Sh{constructor(e){(0,Yo.Z)(this,"_key",void 0),Ah(e),this._key=e}verify(e,t){return function(e,t,n){const r=bu.sha256.digest(n instanceof Uint8Array?n:n.subarray());if(Iu(r))return r.then((n=>{let{digest:r}=n;return Eh.verify(t,r,e)})).catch((e=>{throw new fu.sv(String(e),"ERR_INVALID_INPUT")}));try{return Eh.verify(t,r.digest,e)}catch(i){throw new fu.sv(String(i),"ERR_INVALID_INPUT")}}(this._key,t,e)}marshal(){return e=this._key,Eh.ProjectivePoint.fromHex(e).toRawBytes(!0);var e}get bytes(){return Lu.encode({Type:Nu.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const e=bu.sha256.digest(this.bytes);let t;return Iu(e)?({bytes:t}=await e):t=e.bytes,t}}class _h{constructor(e,t){(0,Yo.Z)(this,"_key",void 0),(0,Yo.Z)(this,"_publicKey",void 0),this._key=e,this._publicKey=null!==t&&void 0!==t?t:function(e){try{return Eh.getPublicKey(e,!0)}catch(t){throw new fu.sv(String(t),"ERR_INVALID_PRIVATE_KEY")}}(e),function(e){try{Eh.getPublicKey(e,!0)}catch(t){throw new fu.sv(String(t),"ERR_INVALID_PRIVATE_KEY")}}(this._key),Ah(this._publicKey)}sign(e){return function(e,t){const n=bu.sha256.digest(t instanceof Uint8Array?t:t.subarray());if(Iu(n))return n.then((t=>{let{digest:n}=t;return Eh.sign(n,e).toDERRawBytes()})).catch((e=>{throw new fu.sv(String(e),"ERR_INVALID_INPUT")}));try{return Eh.sign(n.digest,e).toDERRawBytes()}catch(r){throw new fu.sv(String(r),"ERR_INVALID_INPUT")}}(this._key,e)}get public(){return new Sh(this._publicKey)}marshal(){return this._key}get bytes(){return Mu.encode({Type:Nu.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}hash(){const e=bu.sha256.digest(this.bytes);return Iu(e)?e.then((e=>{let{bytes:t}=e;return t})):e.bytes}async id(){const e=await this.public.hash();return(0,Au.B)(e,"base58btc")}async export(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"libp2p-key";if("libp2p-key"===t)return Ou(this.bytes,e);throw new fu.sv("export format '".concat(t,"' is not supported"),"ERR_INVALID_EXPORT_FORMAT")}}function Ih(e){return new _h(e)}function Ch(e){return new Sh(e)}async function Th(){const e=Eh.utils.randomPrivateKey();return new _h(e)}const kh={rsa:o,ed25519:i,secp256k1:s};function Rh(e){const t=Object.keys(kh).join(" / ");return new fu.sv("invalid or unsupported key type ".concat(e,". Must be ").concat(t),"ERR_UNSUPPORTED_KEY_TYPE")}function xh(e){var t,n;const r=Lu.decode(e),i=null!==(t=r.Data)&&void 0!==t?t:new Uint8Array;switch(r.Type){case Nu.RSA:return kh.rsa.unmarshalRsaPublicKey(i);case Nu.Ed25519:return kh.ed25519.unmarshalEd25519PublicKey(i);case Nu.Secp256k1:return kh.secp256k1.unmarshalSecp256k1PublicKey(i);default:throw Rh(null!==(n=r.Type)&&void 0!==n?n:"unknown")}}async function Ph(e){var t,n;const r=Mu.decode(e),i=null!==(t=r.Data)&&void 0!==t?t:new Uint8Array;switch(r.Type){case Nu.RSA:return kh.rsa.unmarshalRsaPrivateKey(i);case Nu.Ed25519:return kh.ed25519.unmarshalEd25519PrivateKey(i);case Nu.Secp256k1:return kh.secp256k1.unmarshalSecp256k1PrivateKey(i);default:throw Rh(null!==(n=r.Type)&&void 0!==n?n:"RSA")}}var Dh=n(3734);const Oh=Symbol.for("nodejs.util.inspect.custom"),Nh=Object.values(Dh.gh).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)),Dh.gh.identity.decoder),Bh=114,Lh=36,Mh=37;class Uh{constructor(e){(0,Yo.Z)(this,"type",void 0),(0,Yo.Z)(this,"multihash",void 0),(0,Yo.Z)(this,"privateKey",void 0),(0,Yo.Z)(this,"publicKey",void 0),(0,Yo.Z)(this,"string",void 0),(0,Yo.Z)(this,fu.Cs,!0),this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return"PeerId(".concat(this.toString(),")")}toString(){return null==this.string&&(this.string=mu.base58btc.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return Gr.CID.createV1(Bh,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){var t;if(e instanceof Uint8Array)return(0,Ms.f)(this.multihash.bytes,e);if("string"===typeof e)return Zh(e).equals(this);if(null!=(null===e||void 0===e||null===(t=e.multihash)||void 0===t?void 0:t.bytes))return(0,Ms.f)(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[Oh](){return"PeerId(".concat(this.toString(),")")}}class Fh extends Uh{constructor(e){super({...e,type:"RSA"}),(0,Yo.Z)(this,"type","RSA"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.publicKey}}class Kh extends Uh{constructor(e){super({...e,type:"Ed25519"}),(0,Yo.Z)(this,"type","Ed25519"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.multihash.digest}}class jh extends Uh{constructor(e){super({...e,type:"secp256k1"}),(0,Yo.Z)(this,"type","secp256k1"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.multihash.digest}}function Zh(e,t){var n;if(t=null!==(n=t)&&void 0!==n?n:Nh,"1"===e.charAt(0)||"Q"===e.charAt(0)){const t=ni.Jx(mu.base58btc.decode("z".concat(e)));return e.startsWith("12D")?new Kh({multihash:t}):e.startsWith("16U")?new jh({multihash:t}):new Fh({multihash:t})}return function(e){try{const t=ni.Jx(e);if(t.code===vu.identity.code){if(t.digest.length===Lh)return new Kh({multihash:t});if(t.digest.length===Mh)return new jh({multihash:t})}if(t.code===bu.sha256.code)return new Fh({multihash:t})}catch{return function(e){if(null==e||null==e.multihash||null==e.version||1===e.version&&e.code!==Bh)throw new Error("Supplied PeerID CID is invalid");const t=e.multihash;if(t.code===bu.sha256.code)return new Fh({multihash:e.multihash});if(t.code===vu.identity.code){if(t.digest.length===Lh)return new Kh({multihash:e.multihash});if(t.digest.length===Mh)return new jh({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}(Gr.CID.decode(e))}throw new Error("Supplied PeerID CID is invalid")}(Nh.decode(e))}async function zh(e,t){return e.length===Lh?new Kh({multihash:ni.Ue(vu.identity.code,e),privateKey:t}):e.length===Mh?new jh({multihash:ni.Ue(vu.identity.code,e),privateKey:t}):new Fh({multihash:await bu.sha256.digest(e),publicKey:e,privateKey:t})}var Vh,Hh;async function qh(e,t,n){const r=await async function(e,t){if(null==e.privateKey)throw new Error("PrivateKey was missing from PeerId");return(await Ph(e.privateKey)).sign(t)}(e,Qh(t));if(null==e.publicKey)throw new Error("PublicKey was missing from local PeerId");return function(e,t,n){return Hh.encode({identityKey:e,identitySig:t,extensions:null!==n&&void 0!==n?n:{webtransportCerthashes:[]}}).subarray()}(e.publicKey,r,n)}async function Gh(e){return zh(e.identityKey)}function Wh(e){return Hh.decode(e)}function Qh(e){const t=(0,yu.m)("noise-libp2p-static-key:");return e instanceof Uint8Array?(0,Ls.z)([t,e],t.length+e.length):(e.prepend(t),e)}async function Yh(e,t,n){const r=await zh(t.identityKey);if(!r.equals(n))throw new Error("Payload identity key ".concat(r.toString()," does not match expected remote peer ").concat(n.toString()));const i=Qh(e);if(null==r.publicKey)throw new Error("PublicKey was missing from PeerId");if(null==t.identitySig)throw new Error("Signature was missing from message");const o=xh(r.publicKey);if(!await o.verify(i,t.identitySig))throw new Error("Static key doesn't match to peer that signed payload!");return r}function Jh(e){return!!(e instanceof Uint8Array||js(e))&&32===e.byteLength}!function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==n.lengthDelimited&&t.fork(),null!=e.webtransportCerthashes)for(const r of e.webtransportCerthashes)t.uint32(10),t.bytes(r);!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={webtransportCerthashes:[]},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();if(t>>>3===1)n.webtransportCerthashes.push(e.bytes());else e.skipType(7&t)}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(Vh||(Vh={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.identityKey&&e.identityKey.byteLength>0&&(t.uint32(10),t.bytes(e.identityKey)),null!=e.identitySig&&e.identitySig.byteLength>0&&(t.uint32(18),t.bytes(e.identitySig)),null!=e.extensions&&(t.uint32(34),Vh.codec().encode(e.extensions,t)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={identityKey:(0,Us.u)(0),identitySig:(0,Us.u)(0)},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.identityKey=e.bytes();break;case 2:n.identitySig=e.bytes();break;case 4:n.extensions=Vh.codec().decode(e,e.uint32());break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(Hh||(Hh={}));var Xh=n(27929);class $h{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;(0,Yo.Z)(this,"n",void 0),(0,Yo.Z)(this,"bytes",void 0),(0,Yo.Z)(this,"view",void 0),this.n=e,this.bytes=(0,Us.u)(12),this.view=new DataView(this.bytes.buffer,this.bytes.byteOffset,this.bytes.byteLength),this.view.setUint32(4,e,!0)}increment(){this.n++,this.view.setUint32(4,this.n,!0)}getBytes(){return this.bytes}getUint64(){return this.n}assertValue(){if(this.n>4294967295)throw new Error("Cipherstate has reached maximum n, a new handshake must be performed")}}class ed{constructor(e,t){(0,Yo.Z)(this,"crypto",void 0),(0,Yo.Z)(this,"log",void 0),this.log=e.logger.forComponent("libp2p:noise:abstract-handshake"),this.crypto=t}encryptWithAd(e,t,n){const r=this.encrypt(e.k,e.n,t,n);return e.n.increment(),r}decryptWithAd(e,t,n,r){const{plaintext:i,valid:o}=this.decrypt(e.k,e.n,t,n,r);return o&&e.n.increment(),{plaintext:i,valid:o}}hasKey(e){return!this.isEmptyKey(e.k)}createEmptyKey(){return(0,Us.u)(32)}isEmptyKey(e){const t=this.createEmptyKey();return(0,Ms.f)(t,e)}encrypt(e,t,n,r){return t.assertValue(),this.crypto.chaCha20Poly1305Encrypt(r,t.getBytes(),n,e)}encryptAndHash(e,t){let n;return n=this.hasKey(e.cs)?this.encryptWithAd(e.cs,e.h,t):t,this.mixHash(e,n),n}decrypt(e,t,n,r,i){t.assertValue();const o=this.crypto.chaCha20Poly1305Decrypt(r,t.getBytes(),n,e,i);return o?{plaintext:o,valid:!0}:{plaintext:(0,Us.u)(0),valid:!1}}decryptAndHash(e,t){let n,r=!0;return this.hasKey(e.cs)?({plaintext:n,valid:r}=this.decryptWithAd(e.cs,e.h,t)):n=t,this.mixHash(e,t),{plaintext:n,valid:r}}dh(e,t){try{const n=this.crypto.generateX25519SharedKey(e,t);return 32===n.length?n:n.subarray(0,32)}catch(n){const e=n;return this.log.error("error deriving shared key",e),(0,Us.u)(32)}}mixHash(e,t){e.h=this.getHash(e.h,t)}getHash(e,t){return this.crypto.hashSHA256(new Zs(e,t))}mixKey(e,t){const[n,r]=this.crypto.getHKDF(e.ck,t);e.cs=this.initializeKey(r),e.ck=n}initializeKey(e){return{k:e,n:new $h}}initializeSymmetric(e){const t=(0,Xh.mL)(e,"utf-8"),n=this.hashProtocolName(t),r=n,i=this.createEmptyKey();return{cs:this.initializeKey(i),ck:r,h:n}}hashProtocolName(e){if(e.length<=32){const t=(0,Us.u)(32);return t.set(e),t}return this.getHash(e,(0,Us.u)(0))}split(e){const[t,n]=this.crypto.getHKDF(e.ck,(0,Us.u)(0));return{cs1:this.initializeKey(t),cs2:this.initializeKey(n)}}writeMessageRegular(e,t){const n=this.encryptWithAd(e,(0,Us.u)(0),t);return{ne:this.createEmptyKey(),ns:(0,Us.u)(0),ciphertext:n}}readMessageRegular(e,t){return this.decryptWithAd(e,(0,Us.u)(0),t.ciphertext)}}class td extends ed{initializeInitiator(e,t,n,r){const i=this.initializeSymmetric("Noise_XX_25519_ChaChaPoly_SHA256");this.mixHash(i,e);return{ss:i,s:t,rs:n,psk:r,re:(0,Us.u)(32)}}initializeResponder(e,t,n,r){const i=this.initializeSymmetric("Noise_XX_25519_ChaChaPoly_SHA256");this.mixHash(i,e);return{ss:i,s:t,rs:n,psk:r,re:(0,Us.u)(32)}}writeMessageA(e,t,n){const r=(0,Us.u)(0);e.e=void 0!==n?n:this.crypto.generateX25519KeyPair();const i=e.e.publicKey;this.mixHash(e.ss,i);return{ne:i,ns:r,ciphertext:this.encryptAndHash(e.ss,t)}}writeMessageB(e,t){e.e=this.crypto.generateX25519KeyPair();const n=e.e.publicKey;this.mixHash(e.ss,n),this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));const r=e.s.publicKey,i=this.encryptAndHash(e.ss,r);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));return{ne:n,ns:i,ciphertext:this.encryptAndHash(e.ss,t)}}writeMessageC(e,t){const n=e.s.publicKey,r=this.encryptAndHash(e.ss,n);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));const i=this.encryptAndHash(e.ss,t),o={ne:this.createEmptyKey(),ns:r,ciphertext:i},{cs1:s,cs2:a}=this.split(e.ss);return{h:e.ss.h,messageBuffer:o,cs1:s,cs2:a}}readMessageA(e,t){return Jh(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),this.decryptAndHash(e.ss,t.ciphertext)}readMessageB(e,t){if(Jh(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));const{plaintext:n,valid:r}=this.decryptAndHash(e.ss,t.ns);r&&Jh(n)&&(e.rs=n),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));const{plaintext:i,valid:o}=this.decryptAndHash(e.ss,t.ciphertext);return{plaintext:i,valid:r&&o}}readMessageC(e,t){const{plaintext:n,valid:r}=this.decryptAndHash(e.ss,t.ns);if(r&&Jh(n)&&(e.rs=n),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));const{plaintext:i,valid:o}=this.decryptAndHash(e.ss,t.ciphertext),{cs1:s,cs2:a}=this.split(e.ss);return{h:e.ss.h,plaintext:i,valid:r&&o,cs1:s,cs2:a}}initSession(e,t,n){const r=this.createEmptyKey(),i=(0,Us.u)(32);let o;return o=e?this.initializeInitiator(t,n,i,r):this.initializeResponder(t,n,i,r),{hs:o,i:e,mc:0}}sendMessage(e,t,n){let r;if(0===e.mc)r=this.writeMessageA(e.hs,t,n);else if(1===e.mc)r=this.writeMessageB(e.hs,t);else if(2===e.mc){const{h:n,messageBuffer:i,cs1:o,cs2:s}=this.writeMessageC(e.hs,t);r=i,e.h=n,e.cs1=o,e.cs2=s}else{if(!(e.mc>2))throw new Error("Session invalid.");if(e.i){if(!e.cs1)throw new Error("CS1 (cipher state) is not defined");r=this.writeMessageRegular(e.cs1,t)}else{if(!e.cs2)throw new Error("CS2 (cipher state) is not defined");r=this.writeMessageRegular(e.cs2,t)}}return e.mc++,r}recvMessage(e,t){let n=(0,Us.u)(0),r=!1;if(0===e.mc)({plaintext:n,valid:r}=this.readMessageA(e.hs,t));else if(1===e.mc)({plaintext:n,valid:r}=this.readMessageB(e.hs,t));else if(2===e.mc){const{h:i,plaintext:o,valid:s,cs1:a,cs2:c}=this.readMessageC(e.hs,t);n=o,r=s,e.h=i,e.cs1=a,e.cs2=c}return e.mc++,{plaintext:n,valid:r}}}function nd(e,t){t.enabled&&Ca&&(e?(t("LOCAL_PUBLIC_EPHEMERAL_KEY ".concat((0,Au.B)(e.publicKey,"hex"))),t("LOCAL_PRIVATE_EPHEMERAL_KEY ".concat((0,Au.B)(e.privateKey,"hex")))):t("Missing local ephemeral keys."))}function rd(e,t){t.enabled&&Ca&&t("REMOTE_EPHEMERAL_PUBLIC_KEY ".concat((0,Au.B)(e.subarray(),"hex")))}class id{constructor(e,t,n,r,i,o,s,a,c){(0,Yo.Z)(this,"isInitiator",void 0),(0,Yo.Z)(this,"session",void 0),(0,Yo.Z)(this,"remotePeer",void 0),(0,Yo.Z)(this,"remoteExtensions",{webtransportCerthashes:[]}),(0,Yo.Z)(this,"payload",void 0),(0,Yo.Z)(this,"connection",void 0),(0,Yo.Z)(this,"xx",void 0),(0,Yo.Z)(this,"staticKeypair",void 0),(0,Yo.Z)(this,"prologue",void 0),(0,Yo.Z)(this,"log",void 0),this.log=e.logger.forComponent("libp2p:noise:xxhandshake"),this.isInitiator=t,this.payload=n,this.prologue=r,this.staticKeypair=o,this.connection=s,a&&(this.remotePeer=a),this.xx=null!==c&&void 0!==c?c:new td(e,i),this.session=this.xx.initSession(this.isInitiator,this.prologue,this.staticKeypair)}async propose(){if(function(e,t){t.enabled&&Ca&&(t("LOCAL_STATIC_PUBLIC_KEY ".concat((0,Au.B)(e.publicKey,"hex"))),t("LOCAL_STATIC_PRIVATE_KEY ".concat((0,Au.B)(e.privateKey,"hex"))))}(this.session.hs.s,this.log),this.isInitiator){this.log.trace("Stage 0 - Initiator starting to send first message.");const e=this.xx.sendMessage(this.session,(0,Us.u)(0));await this.connection.write(function(e){return new Zs(e.ne,e.ciphertext)}(e)),this.log.trace("Stage 0 - Initiator finished sending first message."),nd(this.session.hs.e,this.log)}else{this.log.trace("Stage 0 - Responder waiting to receive first message...");const e=function(e){if(e.length<32)throw new Error("Cannot decode stage 0 MessageBuffer: length less than 32 bytes.");return{ne:e.subarray(0,32),ciphertext:e.subarray(32,e.length),ns:(0,Us.u)(0)}}((await this.connection.read()).subarray()),{valid:t}=this.xx.recvMessage(this.session,e);if(!t)throw new du("xx handshake stage 0 validation fail");this.log.trace("Stage 0 - Responder received first message."),rd(this.session.hs.re,this.log)}}async exchange(){if(this.isInitiator){this.log.trace("Stage 1 - Initiator waiting to receive first message from responder...");const t=function(e){if(e.length<80)throw new Error("Cannot decode stage 1 MessageBuffer: length less than 80 bytes.");return{ne:e.subarray(0,32),ns:e.subarray(32,80),ciphertext:e.subarray(80,e.length)}}((await this.connection.read()).subarray()),{plaintext:n,valid:r}=this.xx.recvMessage(this.session,t);if(!r)throw new du("xx handshake stage 1 validation fail");this.log.trace("Stage 1 - Initiator received the message."),rd(this.session.hs.re,this.log),function(e,t){t.enabled&&Ca&&t("REMOTE_STATIC_PUBLIC_KEY ".concat((0,Au.B)(e.subarray(),"hex")))}(this.session.hs.rs,this.log),this.log.trace("Initiator going to check remote's signature...");try{const e=Wh(n);this.remotePeer=this.remotePeer||await Gh(e),await Yh(this.session.hs.rs,e,this.remotePeer),this.setRemoteNoiseExtension(e.extensions)}catch(e){throw new hu("Error occurred while verifying signed payload: ".concat(e.message))}this.log.trace("All good with the signature!")}else{this.log.trace("Stage 1 - Responder sending out first message with signed payload and static key.");const e=this.xx.sendMessage(this.session,this.payload);await this.connection.write(function(e){return new Zs(e.ne,e.ns,e.ciphertext)}(e)),this.log.trace("Stage 1 - Responder sent the second handshake message with signed payload."),nd(this.session.hs.e,this.log)}}async finish(){if(this.isInitiator){this.log.trace("Stage 2 - Initiator sending third handshake message.");const e=this.xx.sendMessage(this.session,this.payload);await this.connection.write(function(e){return new Zs(e.ns,e.ciphertext)}(e)),this.log.trace("Stage 2 - Initiator sent message with signed payload.")}else{this.log.trace("Stage 2 - Responder waiting for third handshake message...");const t=function(e){if(e.length<48)throw new Error("Cannot decode stage 2 MessageBuffer: length less than 48 bytes.");return{ne:(0,Us.u)(0),ns:e.subarray(0,48),ciphertext:e.subarray(48,e.length)}}((await this.connection.read()).subarray()),{plaintext:n,valid:r}=this.xx.recvMessage(this.session,t);if(!r)throw new du("xx handshake stage 2 validation fail");this.log.trace("Stage 2 - Responder received the message, finished handshake.");try{const e=Wh(n);this.remotePeer=this.remotePeer||await Gh(e),await Yh(this.session.hs.rs,e,this.remotePeer),this.setRemoteNoiseExtension(e.extensions)}catch(e){throw new hu("Error occurred while verifying signed payload: ".concat(e.message))}}!function(e,t){t.enabled&&Ca&&(e.cs1&&e.cs2?(t("CIPHER_STATE_1 ".concat(e.cs1.n.getUint64()," ").concat((0,Au.B)(e.cs1.k,"hex"))),t("CIPHER_STATE_2 ".concat(e.cs2.n.getUint64()," ").concat((0,Au.B)(e.cs2.k,"hex")))):t("Missing cipher state."))}(this.session,this.log)}encrypt(e,t){const n=this.getCS(t);return this.xx.encryptWithAd(n,(0,Us.u)(0),e)}decrypt(e,t,n){const r=this.getCS(t,!1);return this.xx.decryptWithAd(r,(0,Us.u)(0),e,n)}getRemoteStaticKey(){return this.session.hs.rs}getCS(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!e.cs1||!e.cs2)throw new du("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?t?e.cs1:e.cs2:t?e.cs2:e.cs1}setRemoteNoiseExtension(e){e&&(this.remoteExtensions=e)}}class od{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,Yo.Z)(this,"protocol","/noise"),(0,Yo.Z)(this,"crypto",void 0),(0,Yo.Z)(this,"prologue",void 0),(0,Yo.Z)(this,"staticKeys",void 0),(0,Yo.Z)(this,"extensions",void 0),(0,Yo.Z)(this,"metrics",void 0),(0,Yo.Z)(this,"components",void 0);const{staticNoiseKey:n,extensions:r,crypto:i,prologueBytes:o}=t,{metrics:s}=e;this.components=e,this.crypto=null!==i&&void 0!==i?i:cu,this.extensions=r,this.metrics=s?function(e){return{xxHandshakeSuccesses:e.registerCounter("libp2p_noise_xxhandshake_successes_total",{help:"Total count of noise xxHandshakes successes_"}),xxHandshakeErrors:e.registerCounter("libp2p_noise_xxhandshake_error_total",{help:"Total count of noise xxHandshakes errors"}),encryptedPackets:e.registerCounter("libp2p_noise_encrypted_packets_total",{help:"Total count of noise encrypted packets successfully"}),decryptedPackets:e.registerCounter("libp2p_noise_decrypted_packets_total",{help:"Total count of noise decrypted packets"}),decryptErrors:e.registerCounter("libp2p_noise_decrypt_errors_total",{help:"Total count of noise decrypt errors"})}}(s):void 0,this.staticKeys=n?this.crypto.generateX25519KeyPairFromSeed(n):this.crypto.generateX25519KeyPair(),this.prologue=null!==o&&void 0!==o?o:(0,Us.u)(0)}async secureOutbound(e,t,n){const r=la(t,{lengthEncoder:lu,lengthDecoder:uu,maxDataLength:Ia}),i=await this.performHandshake({connection:r,isInitiator:!0,localPeer:e,remotePeer:n}),o=await this.createSecureConnection(r,i);return t.source=o.source,t.sink=o.sink,{conn:t,remoteExtensions:i.remoteExtensions,remotePeer:i.remotePeer}}async secureInbound(e,t,n){const r=la(t,{lengthEncoder:lu,lengthDecoder:uu,maxDataLength:Ia}),i=await this.performHandshake({connection:r,isInitiator:!1,localPeer:e,remotePeer:n}),o=await this.createSecureConnection(r,i);return t.source=o.source,t.sink=o.sink,{conn:t,remotePeer:i.remotePeer,remoteExtensions:i.remoteExtensions}}async performHandshake(e){const t=await qh(e.localPeer,this.staticKeys.publicKey,this.extensions);return this.performXXHandshake(e,t)}async performXXHandshake(e,t){const{isInitiator:n,remotePeer:r,connection:i}=e,o=new id(this.components,n,t,this.prologue,this.crypto,this.staticKeys,i,r);try{var s;await o.propose(),await o.exchange(),await o.finish(),null===(s=this.metrics)||void 0===s||s.xxHandshakeSuccesses.increment()}catch(c){var a;if(null===(a=this.metrics)||void 0===a||a.xxHandshakeErrors.increment(),c instanceof Error)throw c.message="Error occurred during XX handshake: ".concat(c.message),c}return o}async createSecureConnection(e,t){const[n,r]=function(){const e=ua(),t=ua();return[{source:e.source,sink:t.sink},{source:t.source,sink:e.sink}]}(),i=e.unwrap();return await ma(n,function(e,t){return async function*(n){for await(const r of n)for(let n=0;n<r.length;n+=65519){let i,o=n+65519;o>r.length&&(o=r.length),i=r instanceof Uint8Array?e.encrypt(r.subarray(n,o),e.session):e.encrypt(r.sublist(n,o),e.session),null===t||void 0===t||t.encryptedPackets.increment(),yield new Zs(lu(i.byteLength),i)}}}(t,this.metrics),i,(e=>Gs(e,{lengthDecoder:uu})),function(e,t){return async function*(n){for await(const r of n)for(let n=0;n<r.length;n+=Ia){let i=n+Ia;if(i>r.length&&(i=r.length),i-16<n)throw new Error("Invalid chunk");const o=r.sublist(n,i),s=r.subarray(n,i-16),{plaintext:a,valid:c}=e.decrypt(o,e.session,s);if(!c)throw null===t||void 0===t||t.decryptErrors.increment(),new Error("Failed to validate decrypted chunk");null===t||void 0===t||t.decryptedPackets.increment(),yield a}}}(t,this.metrics),n),r}}function sd(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>new od(t,e)}function ad(e){if(null!=e){if("function"===typeof e[Symbol.iterator])return e[Symbol.iterator]();if("function"===typeof e[Symbol.asyncIterator])return e[Symbol.asyncIterator]();if("function"===typeof e.next)return e}throw new Error("argument is not an iterator or iterable")}class cd{constructor(e){if((0,Yo.Z)(this,"buffer",void 0),(0,Yo.Z)(this,"mask",void 0),(0,Yo.Z)(this,"top",void 0),(0,Yo.Z)(this,"btm",void 0),(0,Yo.Z)(this,"next",void 0),!(e>0)||0!==(e-1&e))throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];if(void 0!==e)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return void 0===this.buffer[this.btm]}}class ld{constructor(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,Yo.Z)(this,"size",void 0),(0,Yo.Z)(this,"hwm",void 0),(0,Yo.Z)(this,"head",void 0),(0,Yo.Z)(this,"tail",void 0),this.hwm=null!==(e=t.splitLimit)&&void 0!==e?e:16,this.head=new cd(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return null!=(null===e||void 0===e?void 0:e.byteLength)?e.byteLength:1}push(e){if(null!=(null===e||void 0===e?void 0:e.value)&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){const t=this.head;this.head=t.next=new cd(2*this.head.buffer.length),this.head.push(e)}}shift(){var e;let t=this.tail.shift();if(void 0===t&&null!=this.tail.next){const e=this.tail.next;this.tail.next=null,this.tail=e,t=this.tail.shift()}return null!=(null===(e=t)||void 0===e?void 0:e.value)&&(this.size-=this.calculateSize(t.value)),t}isEmpty(){return this.head.isEmpty()}}class ud extends Error{constructor(e,t){super(null!==e&&void 0!==e?e:"The operation was aborted"),(0,Yo.Z)(this,"type",void 0),(0,Yo.Z)(this,"code",void 0),this.type="aborted",this.code=null!==t&&void 0!==t?t:"ABORT_ERR"}}function hd(e,t){var n;let r,i,o,s=(t=null!==(n=t)&&void 0!==n?n:{}).onEnd,a=new ld,c=Ws();const l=e=>null!=i?i(e):(a.push(e),r),u=e=>{var n;if(o)return r;if(!0!==(null===(n=t)||void 0===n?void 0:n.objectMode)&&null==(null===e||void 0===e?void 0:e.byteLength))throw new Error("objectMode was not true but tried to push non-Uint8Array value");return l({done:!1,value:e})},h=e=>o?r:(o=!0,null!=e?(e=>(a=new ld,null!=i?i({error:e}):(a.push({error:e}),r)))(e):l({done:!0}));if(r={[Symbol.asyncIterator](){return this},next:async()=>{try{return a.isEmpty()?o?{done:!0}:await new Promise(((t,n)=>{i=o=>{i=null,a.push(o);try{t(e(a))}catch(s){n(s)}return r}})):e(a)}finally{a.isEmpty()&&queueMicrotask((()=>{c.resolve(),c=Ws()}))}},return:()=>(a=new ld,h(),{done:!0}),throw:e=>(h(e),{done:!0}),push:u,end:h,get readableLength(){return a.size},onEmpty:async e=>{const t=null===e||void 0===e?void 0:e.signal;if(null===t||void 0===t||t.throwIfAborted(),a.isEmpty())return;let n,r;null!=t&&(n=new Promise(((e,n)=>{r=()=>{n(new ud)},t.addEventListener("abort",r)})));try{await Promise.race([c.promise,n])}finally{null!=r&&null!=t&&(null===t||void 0===t||t.removeEventListener("abort",r))}}},null==s)return r;const d=r;return r={[Symbol.asyncIterator](){return this},next:()=>d.next(),throw:e=>(d.throw(e),null!=s&&(s(e),s=void 0),{done:!0}),return:()=>(d.return(),null!=s&&(s(),s=void 0),{done:!0}),push:u,end:e=>(d.end(e),null!=s&&(s(e),s=void 0),r),get readableLength(){return d.readableLength},onEmpty:e=>d.onEmpty(e)},r}var dd=n(9963);const fd="ERR_INVALID_FRAME",pd="ERR_UNREQUESTED_PING",gd="ERR_NOT_MATCHING_PING",yd="ERR_STREAM_ALREADY_EXISTS",md="ERR_DECODE_INVALID_VERSION",vd="ERR_BOTH_CLIENTS",bd="ERR_RECV_WINDOW_EXCEEDED",wd=new Set([fd,pd,gd,yd,md,vd,bd]),Ed="ERR_INVALID_CONFIG",Ad="ERR_MUXER_LOCAL_CLOSED",Sd="ERR_MUXER_REMOTE_CLOSED",_d=262144,Id={enableKeepAlive:!0,keepAliveInterval:3e4,maxInboundStreams:1e3,maxOutboundStreams:1e3,initialStreamWindowSize:_d,maxStreamWindowSize:16777216,maxMessageSize:65536};var Cd,Td;!function(e){e[e.Data=0]="Data",e[e.WindowUpdate=1]="WindowUpdate",e[e.Ping=2]="Ping",e[e.GoAway=3]="GoAway"}(Cd||(Cd={})),function(e){e[e.SYN=1]="SYN",e[e.ACK=2]="ACK",e[e.FIN=4]="FIN",e[e.RST=8]="RST"}(Td||(Td={}));Object.values(Td).filter((e=>"string"!==typeof e));var kd;!function(e){e[e.NormalTermination=0]="NormalTermination",e[e.ProtocolError=1]="ProtocolError",e[e.InternalError=2]="InternalError"}(kd||(kd={}));const Rd=2**24;class xd{constructor(e){(0,Yo.Z)(this,"source",void 0),(0,Yo.Z)(this,"buffer",void 0),(0,Yo.Z)(this,"frameInProgress",void 0),this.source=function(e){if(void 0!==e[Symbol.iterator]){const t=e[Symbol.iterator]();return t.return=void 0,{[Symbol.iterator]:()=>t}}if(void 0!==e[Symbol.asyncIterator]){const t=e[Symbol.asyncIterator]();return t.return=void 0,{[Symbol.asyncIterator]:()=>t}}throw new Error("a source must be either an iterable or an async iterable")}(e),this.buffer=new Zs,this.frameInProgress=!1}async*emitFrames(){for await(const e of this.source)for(this.buffer.append(e);;){const e=this.readHeader();if(void 0===e)break;const{type:t,length:n}=e;t===Cd.Data?(this.frameInProgress=!0,yield{header:e,readData:this.readBytes.bind(this,n)}):yield{header:e}}}readHeader(){if(this.frameInProgress)throw new fu.sv("decoding frame already in progress","ERR_DECODE_IN_PROGRESS");if(this.buffer.length<12)return;const e=function(e){if(0!==e[0])throw new fu.sv("Invalid frame version",md);return{type:e[1],flag:(e[2]<<8)+e[3],streamID:e[4]*Rd+(e[5]<<16)+(e[6]<<8)+e[7],length:e[8]*Rd+(e[9]<<16)+(e[10]<<8)+e[11]}}(this.buffer.subarray(0,12));return this.buffer.consume(12),e}async readBytes(e){if(this.buffer.length<e)for await(const n of this.source)if(this.buffer.append(n),this.buffer.length>=e)break;const t=this.buffer.sublist(0,e);return this.buffer.consume(e),this.frameInProgress=!1,t}}function Pd(e){const t=new Uint8Array(12);return t[1]=e.type,t[2]=e.flag>>>8,t[3]=e.flag,t[4]=e.streamID>>>24,t[5]=e.streamID>>>16,t[6]=e.streamID>>>8,t[7]=e.streamID,t[8]=e.length>>>24,t[9]=e.length>>>16,t[10]=e.length>>>8,t[11]=e.length,t}class Dd{constructor(e){if((0,Yo.Z)(this,"buffer",void 0),(0,Yo.Z)(this,"mask",void 0),(0,Yo.Z)(this,"top",void 0),(0,Yo.Z)(this,"btm",void 0),(0,Yo.Z)(this,"next",void 0),!(e>0)||0!==(e-1&e))throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];if(void 0!==e)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return void 0===this.buffer[this.btm]}}class Od{constructor(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,Yo.Z)(this,"size",void 0),(0,Yo.Z)(this,"hwm",void 0),(0,Yo.Z)(this,"head",void 0),(0,Yo.Z)(this,"tail",void 0),this.hwm=null!==(e=t.splitLimit)&&void 0!==e?e:16,this.head=new Dd(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return null!=(null===e||void 0===e?void 0:e.byteLength)?e.byteLength:1}push(e){if(null!=(null===e||void 0===e?void 0:e.value)&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){const t=this.head;this.head=t.next=new Dd(2*this.head.buffer.length),this.head.push(e)}}shift(){var e;let t=this.tail.shift();if(void 0===t&&null!=this.tail.next){const e=this.tail.next;this.tail.next=null,this.tail=e,t=this.tail.shift()}return null!=(null===(e=t)||void 0===e?void 0:e.value)&&(this.size-=this.calculateSize(t.value)),t}isEmpty(){return this.head.isEmpty()}}class Nd extends Error{constructor(e,t){super(null!==e&&void 0!==e?e:"The operation was aborted"),(0,Yo.Z)(this,"type",void 0),(0,Yo.Z)(this,"code",void 0),this.type="aborted",this.code=null!==t&&void 0!==t?t:"ABORT_ERR"}}function Bd(e,t){var n;let r,i,o,s=(t=null!==(n=t)&&void 0!==n?n:{}).onEnd,a=new Od,c=Ws();const l=e=>null!=i?i(e):(a.push(e),r),u=e=>{var n;if(o)return r;if(!0!==(null===(n=t)||void 0===n?void 0:n.objectMode)&&null==(null===e||void 0===e?void 0:e.byteLength))throw new Error("objectMode was not true but tried to push non-Uint8Array value");return l({done:!1,value:e})},h=e=>o?r:(o=!0,null!=e?(e=>(a=new Od,null!=i?i({error:e}):(a.push({error:e}),r)))(e):l({done:!0}));if(r={[Symbol.asyncIterator](){return this},next:async()=>{try{return a.isEmpty()?o?{done:!0}:await new Promise(((t,n)=>{i=o=>{i=null,a.push(o);try{t(e(a))}catch(s){n(s)}return r}})):e(a)}finally{a.isEmpty()&&queueMicrotask((()=>{c.resolve(),c=Ws()}))}},return:()=>(a=new Od,h(),{done:!0}),throw:e=>(h(e),{done:!0}),push:u,end:h,get readableLength(){return a.size},onEmpty:async e=>{const t=null===e||void 0===e?void 0:e.signal;if(null===t||void 0===t||t.throwIfAborted(),a.isEmpty())return;let n,r;null!=t&&(n=new Promise(((e,n)=>{r=()=>{n(new Nd)},t.addEventListener("abort",r)})));try{await Promise.race([c.promise,n])}finally{null!=r&&null!=t&&(null===t||void 0===t||t.removeEventListener("abort",r))}}},null==s)return r;const d=r;return r={[Symbol.asyncIterator](){return this},next:()=>d.next(),throw:e=>(d.throw(e),null!=s&&(s(e),s=void 0),{done:!0}),return:()=>(d.return(),null!=s&&(s(),s=void 0),{done:!0}),push:u,end:e=>(d.end(e),null!=s&&(s(e),s=void 0),r),get readableLength(){return d.readableLength},onEmpty:e=>d.onEmpty(e)},r}function Ld(e,t){var n,r;const i=null===(n=(r=ad(e)).return)||void 0===n?void 0:n.call(r);var o;null!=(o=i)&&"function"===typeof o.then&&"function"===typeof o.catch&&"function"===typeof o.finally&&i.catch((e=>{t.error("could not cause iterator to return",e)}))}function Md(e){return null!=e&&("function"===typeof e.then&&"function"===typeof e.catch&&"function"===typeof e.finally)}class Ud{constructor(e){var t,n;(0,Yo.Z)(this,"id",void 0),(0,Yo.Z)(this,"direction",void 0),(0,Yo.Z)(this,"timeline",void 0),(0,Yo.Z)(this,"protocol",void 0),(0,Yo.Z)(this,"metadata",void 0),(0,Yo.Z)(this,"source",void 0),(0,Yo.Z)(this,"status",void 0),(0,Yo.Z)(this,"readStatus",void 0),(0,Yo.Z)(this,"writeStatus",void 0),(0,Yo.Z)(this,"log",void 0),(0,Yo.Z)(this,"sinkController",void 0),(0,Yo.Z)(this,"sinkEnd",void 0),(0,Yo.Z)(this,"closed",void 0),(0,Yo.Z)(this,"endErr",void 0),(0,Yo.Z)(this,"streamSource",void 0),(0,Yo.Z)(this,"onEnd",void 0),(0,Yo.Z)(this,"onCloseRead",void 0),(0,Yo.Z)(this,"onCloseWrite",void 0),(0,Yo.Z)(this,"onReset",void 0),(0,Yo.Z)(this,"onAbort",void 0),(0,Yo.Z)(this,"sendCloseWriteTimeout",void 0),this.sinkController=new AbortController,this.sinkEnd=Ws(),this.closed=Ws(),this.log=e.log,this.status="open",this.readStatus="ready",this.writeStatus="ready",this.id=e.id,this.metadata=null!==(t=e.metadata)&&void 0!==t?t:{},this.direction=e.direction,this.timeline={open:Date.now()},this.sendCloseWriteTimeout=null!==(n=e.sendCloseWriteTimeout)&&void 0!==n?n:5e3,this.onEnd=e.onEnd,this.onCloseRead=null===e||void 0===e?void 0:e.onCloseRead,this.onCloseWrite=null===e||void 0===e?void 0:e.onCloseWrite,this.onReset=null===e||void 0===e?void 0:e.onReset,this.onAbort=null===e||void 0===e?void 0:e.onAbort,this.source=this.streamSource=function(){return Bd((e=>{const t=e.shift();if(null==t)return{done:!0};if(null!=t.error)throw t.error;return{done:!0===t.done,value:t.value}}),arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}({onEnd:e=>{null!=e?this.log.trace("source ended with error",e):this.log.trace("source ended"),this.onSourceEnd(e)}}),this.sink=this.sink.bind(this)}async sink(e){if("ready"!==this.writeStatus)throw new fu.sv('writable end state is "'.concat(this.writeStatus,'" not "ready"'),"ERR_SINK_INVALID_STATE");try{this.writeStatus="writing";const t={signal:this.sinkController.signal};if("outbound"===this.direction){const e=this.sendNewStream(t);Md(e)&&await e}const n=()=>{Ld(e,this.log)};try{this.sinkController.signal.addEventListener("abort",n),this.log.trace("sink reading from source");for await(let n of e){n=n instanceof Uint8Array?new Zs(n):n;const e=this.sendData(n,t);Md(e)&&await e}}finally{this.sinkController.signal.removeEventListener("abort",n)}this.log.trace('sink finished reading from source, write status is "%s"',this.writeStatus),"writing"===this.writeStatus&&(this.writeStatus="closing",this.log.trace("send close write to remote"),await this.sendCloseWrite({signal:AbortSignal.timeout(this.sendCloseWriteTimeout)}),this.writeStatus="closed"),this.onSinkEnd()}catch(t){throw this.log.trace("sink ended with error, calling abort with error",t),this.abort(t),t}finally{this.log.trace("resolve sink end"),this.sinkEnd.resolve()}}onSourceEnd(e){var t;null==this.timeline.closeRead&&(this.timeline.closeRead=Date.now(),this.readStatus="closed",null!=e&&null==this.endErr&&(this.endErr=e),null===(t=this.onCloseRead)||void 0===t||t.call(this),null!=this.timeline.closeWrite?(this.log.trace("source and sink ended"),this.timeline.close=Date.now(),"aborted"!==this.status&&"reset"!==this.status&&(this.status="closed"),null!=this.onEnd&&this.onEnd(this.endErr),this.closed.resolve()):this.log.trace("source ended, waiting for sink to end"))}onSinkEnd(e){var t;null==this.timeline.closeWrite&&(this.timeline.closeWrite=Date.now(),this.writeStatus="closed",null!=e&&null==this.endErr&&(this.endErr=e),null===(t=this.onCloseWrite)||void 0===t||t.call(this),null!=this.timeline.closeRead?(this.log.trace("sink and source ended"),this.timeline.close=Date.now(),"aborted"!==this.status&&"reset"!==this.status&&(this.status="closed"),null!=this.onEnd&&this.onEnd(this.endErr),this.closed.resolve()):this.log.trace("sink ended, waiting for source to end"))}async close(e){this.log.trace("closing gracefully"),this.status="closing",await Promise.all([this.closeRead(e),this.closeWrite(e)]),await Ys(this.closed.promise,null===e||void 0===e?void 0:e.signal),this.status="closed",this.log.trace("closed gracefully")}async closeRead(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("closing"===this.readStatus||"closed"===this.readStatus)return;this.log.trace('closing readable end of stream with starting read status "%s"',this.readStatus);const t=this.readStatus;this.readStatus="closing","reset"!==this.status&&"aborted"!==this.status&&null==this.timeline.closeRead&&(this.log.trace("send close read to remote"),await this.sendCloseRead(e)),"ready"===t&&(this.log.trace("ending internal source queue with %d queued bytes",this.streamSource.readableLength),this.streamSource.end()),this.log.trace("closed readable end of stream")}async closeWrite(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"closing"!==this.writeStatus&&"closed"!==this.writeStatus&&(this.log.trace('closing writable end of stream with starting write status "%s"',this.writeStatus),"ready"===this.writeStatus&&(this.log.trace("sink was never sunk, sink an empty array"),await Ys(this.sink([]),e.signal)),"writing"===this.writeStatus&&await new Promise(((t,n)=>{queueMicrotask((()=>{this.log.trace("aborting source passed to .sink"),this.sinkController.abort(),Ys(this.sinkEnd.promise,e.signal).then(t,n)}))})),this.writeStatus="closed",this.log.trace("closed writable end of stream"))}abort(e){var t;if("closed"===this.status||"aborted"===this.status||"reset"===this.status)return;this.log("abort with error",e),this.log("try to send reset to remote");const n=this.sendReset();Md(n)&&n.catch((e=>{this.log.error("error sending reset message",e)})),this.status="aborted",this.timeline.abort=Date.now(),this._closeSinkAndSource(e),null===(t=this.onAbort)||void 0===t||t.call(this,e)}reset(){var e;if("closed"===this.status||"aborted"===this.status||"reset"===this.status)return;const t=new fu.sv("stream reset","ERR_STREAM_RESET");this.status="reset",this.timeline.reset=Date.now(),this._closeSinkAndSource(t),null===(e=this.onReset)||void 0===e||e.call(this)}_closeSinkAndSource(e){this._closeSink(e),this._closeSource(e)}_closeSink(e){"writing"===this.writeStatus&&(this.log.trace("end sink source"),this.sinkController.abort()),this.onSinkEnd(e)}_closeSource(e){"closing"!==this.readStatus&&"closed"!==this.readStatus&&(this.log.trace("ending source with %d bytes to be read by consumer",this.streamSource.readableLength),this.readStatus="closing",this.streamSource.end(e))}remoteCloseWrite(){"closing"!==this.readStatus&&"closed"!==this.readStatus?(this.log.trace("remote close write"),this._closeSource()):this.log("received remote close write but local source is already closed")}remoteCloseRead(){"closing"!==this.writeStatus&&"closed"!==this.writeStatus?(this.log.trace("remote close read"),this._closeSink()):this.log("received remote close read but local sink is already closed")}destroy(){"closed"!==this.status&&"aborted"!==this.status&&"reset"!==this.status?(this.log.trace("stream destroyed"),this._closeSinkAndSource()):this.log("received destroy but we are already closed")}sourcePush(e){this.streamSource.push(e)}sourceReadableLength(){return this.streamSource.readableLength}}const Fd=function(e){const[t,n]=null!=e[Symbol.asyncIterator]?[e[Symbol.asyncIterator](),Symbol.asyncIterator]:[e[Symbol.iterator](),Symbol.iterator],r=[];return{peek:()=>t.next(),push:e=>{r.push(e)},next:()=>r.length>0?{done:!1,value:r.shift()}:t.next(),[n](){return this}}};function Kd(e){return null!=(null===e||void 0===e?void 0:e.then)}const jd=function(e,t){if(null!=e[Symbol.asyncIterator])return async function*(){for await(const n of e){const e=t(n);Kd(e)&&await e,yield n}}();const n=Fd(e),{value:r,done:i}=n.next();if(!0===i)return function*(){}();const o=t(r);if("function"===typeof(null===o||void 0===o?void 0:o.then))return async function*(){yield r;for await(const e of n){const n=t(e);Kd(n)&&await n,yield e}}();const s=t;return function*(){yield r;for(const e of n)s(e),yield e}()};var Zd;!function(e){e[e.Init=0]="Init",e[e.SYNSent=1]="SYNSent",e[e.SYNReceived=2]="SYNReceived",e[e.Established=3]="Established",e[e.Finished=4]="Finished"}(Zd||(Zd={}));class zd extends Ud{constructor(e){super({...e,onEnd:t=>{var n;this.state=Zd.Finished,null===(n=e.onEnd)||void 0===n||n.call(e,t)}}),(0,Yo.Z)(this,"name",void 0),(0,Yo.Z)(this,"state",void 0),(0,Yo.Z)(this,"config",void 0),(0,Yo.Z)(this,"_id",void 0),(0,Yo.Z)(this,"sendWindowCapacity",void 0),(0,Yo.Z)(this,"sendWindowCapacityUpdate",void 0),(0,Yo.Z)(this,"recvWindow",void 0),(0,Yo.Z)(this,"recvWindowCapacity",void 0),(0,Yo.Z)(this,"epochStart",void 0),(0,Yo.Z)(this,"getRTT",void 0),(0,Yo.Z)(this,"sendFrame",void 0),this.config=e.config,this._id=parseInt(e.id,10),this.name=e.name,this.state=e.state,this.sendWindowCapacity=_d,this.recvWindow=this.config.initialStreamWindowSize,this.recvWindowCapacity=this.recvWindow,this.epochStart=Date.now(),this.getRTT=e.getRTT,this.sendFrame=e.sendFrame,this.source=jd(this.source,(()=>{this.sendWindowUpdate()}))}async sendNewStream(){}async sendData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(e=e.sublist();0!==e.byteLength;){if(0===this.sendWindowCapacity&&await this.waitForSendWindowCapacity(t),"open"!==this.status)return;const n=Math.min(this.sendWindowCapacity,this.config.maxMessageSize-12,e.length),r=this.getSendFlags();this.sendFrame({type:Cd.Data,flag:r,streamID:this._id,length:n},e.sublist(0,n)),this.sendWindowCapacity-=n,e.consume(n)}}async sendReset(){this.sendFrame({type:Cd.WindowUpdate,flag:Td.RST,streamID:this._id,length:0})}async sendCloseWrite(){const e=this.getSendFlags()|Td.FIN;this.sendFrame({type:Cd.WindowUpdate,flag:e,streamID:this._id,length:0})}async sendCloseRead(){}async waitForSendWindowCapacity(){var e;let t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.sendWindowCapacity>0)return;const i=()=>{"open"===this.status?n(new fu.sv("stream aborted","ERR_STREAM_ABORT")):t()};null===(e=r.signal)||void 0===e||e.addEventListener("abort",i);try{await new Promise(((e,r)=>{this.sendWindowCapacityUpdate=()=>{e()},n=r,t=e}))}finally{var o;null===(o=r.signal)||void 0===o||o.removeEventListener("abort",i)}}handleWindowUpdate(e){var t;null===(t=this.log)||void 0===t||t.trace("stream received window update id=%s",this._id),this.processFlags(e.flag);const n=this.sendWindowCapacity;var r;(this.sendWindowCapacity+=e.length,0===n&&e.length>0)&&(null===(r=this.sendWindowCapacityUpdate)||void 0===r||r.call(this))}async handleData(e,t){var n;if(null===(n=this.log)||void 0===n||n.trace("stream received data id=%s",this._id),this.processFlags(e.flag),this.recvWindowCapacity<e.length)throw new fu.sv("receive window exceeded",bd,{available:this.recvWindowCapacity,recv:e.length});const r=await t();this.recvWindowCapacity-=e.length,this.sourcePush(r)}processFlags(e){(e&Td.ACK)===Td.ACK&&this.state===Zd.SYNSent&&(this.state=Zd.Established),(e&Td.FIN)===Td.FIN&&this.remoteCloseWrite(),(e&Td.RST)===Td.RST&&this.reset()}getSendFlags(){switch(this.state){case Zd.Init:return this.state=Zd.SYNSent,Td.SYN;case Zd.SYNReceived:return this.state=Zd.Established,Td.ACK;default:return 0}}sendWindowUpdate(){const e=this.getSendFlags(),t=Date.now(),n=this.getRTT();if(0===e&&n>-1&&t-this.epochStart<4*n&&(this.recvWindow=Math.min(2*this.recvWindow,this.config.maxStreamWindowSize)),this.recvWindowCapacity>=this.recvWindow&&0===e)return;const r=this.recvWindow-this.recvWindowCapacity;this.recvWindowCapacity=this.recvWindow,this.epochStart=t,this.sendFrame({type:Cd.WindowUpdate,flag:e,streamID:this._id,length:r})}}const Vd="/yamux/1.0.0";class Hd{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,Yo.Z)(this,"protocol",Vd),(0,Yo.Z)(this,"_components",void 0),(0,Yo.Z)(this,"_init",void 0),this._components=e,this._init=t}createStreamMuxer(e){return new qd(this._components,{...this._init,...e})}}class qd{constructor(e,t){var n;(0,Yo.Z)(this,"protocol",Vd),(0,Yo.Z)(this,"source",void 0),(0,Yo.Z)(this,"sink",void 0),(0,Yo.Z)(this,"config",void 0),(0,Yo.Z)(this,"log",void 0),(0,Yo.Z)(this,"logger",void 0),(0,Yo.Z)(this,"closeController",void 0),(0,Yo.Z)(this,"nextStreamID",void 0),(0,Yo.Z)(this,"_streams",void 0),(0,Yo.Z)(this,"nextPingID",void 0),(0,Yo.Z)(this,"activePing",void 0),(0,Yo.Z)(this,"rtt",void 0),(0,Yo.Z)(this,"client",void 0),(0,Yo.Z)(this,"localGoAway",void 0),(0,Yo.Z)(this,"remoteGoAway",void 0),(0,Yo.Z)(this,"numInboundStreams",void 0),(0,Yo.Z)(this,"numOutboundStreams",void 0),(0,Yo.Z)(this,"onIncomingStream",void 0),(0,Yo.Z)(this,"onStreamEnd",void 0),this.client="outbound"===t.direction,this.config={...Id,...t},this.logger=e.logger,this.log=this.logger.forComponent("libp2p:yamux"),function(e){if(e.keepAliveInterval<=0)throw new dd.sv("keep-alive interval must be positive",Ed);if(e.maxInboundStreams<0)throw new dd.sv("max inbound streams must be larger or equal 0",Ed);if(e.maxOutboundStreams<0)throw new dd.sv("max outbound streams must be larger or equal 0",Ed);if(e.initialStreamWindowSize<_d)throw new dd.sv("InitialStreamWindowSize must be larger or equal 256 kB",Ed);if(e.maxStreamWindowSize<e.initialStreamWindowSize)throw new dd.sv("MaxStreamWindowSize must be larger than the InitialStreamWindowSize",Ed);if(e.maxStreamWindowSize>2**32-1)throw new dd.sv("MaxStreamWindowSize must be less than equal MAX_UINT32",Ed);if(e.maxMessageSize<1024)throw new dd.sv("MaxMessageSize must be greater than a kilobyte",Ed)}(this.config),this.closeController=new AbortController,(0,fu.Wp)(1/0,this.closeController.signal),this.onIncomingStream=t.onIncomingStream,this.onStreamEnd=t.onStreamEnd,this._streams=new Map,this.source=function(){return hd((e=>{const t=e.shift();if(null==t)return{done:!0};if(null!=t.error)throw t.error;return{done:!0===t.done,value:t.value}}),arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}({onEnd:()=>{var e;null===(e=this.log)||void 0===e||e.trace("muxer source ended"),this._streams.forEach((e=>{e.destroy()}))}}),this.sink=async e=>{var t;const n=()=>{const t=ad(e);if(null!=t.return){const e=t.return();null!=(n=e)&&"function"===typeof n.then&&e.catch((e=>{var t;null===(t=this.log)||void 0===t||t.call(this,"could not cause sink source to return",e)}))}var n};let r,i;try{const t=new xd(e);try{this.closeController.signal.addEventListener("abort",n);for await(const e of t.emitFrames())await this.handleFrame(e.header,e.readData)}finally{this.closeController.signal.removeEventListener("abort",n)}r=kd.NormalTermination}catch(a){const e=a.code;var o,s;if(wd.has(e))null===(o=this.log)||void 0===o||o.error("protocol error in sink",a),r=kd.ProtocolError;else null===(s=this.log)||void 0===s||s.error("internal error in sink",a),r=kd.InternalError;i=a}null===(t=this.log)||void 0===t||t.trace("muxer sink ended"),null!=i?this.abort(i,r):await this.close({reason:r})},this.numInboundStreams=0,this.numOutboundStreams=0,this.nextStreamID=this.client?1:2,this.nextPingID=0,this.rtt=-1,null===(n=this.log)||void 0===n||n.trace("muxer created"),this.config.enableKeepAlive&&this.keepAliveLoop().catch((e=>{var t;return null===(t=this.log)||void 0===t?void 0:t.error("keepalive error: %s",e)})),this.ping().catch((e=>{var t;return null===(t=this.log)||void 0===t?void 0:t.error("ping error: %s",e)}))}get streams(){return Array.from(this._streams.values())}newStream(e){var t;if(void 0!==this.remoteGoAway)throw new fu.sv("muxer closed remotely",Sd);if(void 0!==this.localGoAway)throw new fu.sv("muxer closed locally",Ad);const n=this.nextStreamID;if(this.nextStreamID+=2,this.numOutboundStreams>=this.config.maxOutboundStreams)throw new fu.sv("max outbound streams exceeded","ERROR_MAX_OUTBOUND_STREAMS_EXCEEDED");null===(t=this.log)||void 0===t||t.trace("new outgoing stream id=%s",n);const r=this._newStream(n,e,Zd.Init,"outbound");return this._streams.set(n,r),this.numOutboundStreams++,r.sendWindowUpdate(),r}async ping(){if(void 0!==this.remoteGoAway)throw new fu.sv("muxer closed remotely",Sd);if(void 0!==this.localGoAway)throw new fu.sv("muxer closed locally",Ad);if(void 0===this.activePing){let e=()=>{};this.activePing={id:this.nextPingID++,promise:new Promise(((t,n)=>{const r=()=>{n(new fu.sv("muxer closed locally",Ad))};this.closeController.signal.addEventListener("abort",r,{once:!0}),e=()=>{this.closeController.signal.removeEventListener("abort",r),t()}})),resolve:e};const t=Date.now();this.sendPing(this.activePing.id);try{await this.activePing.promise}finally{delete this.activePing}const n=Date.now();this.rtt=n-t}else await this.activePing.promise;return this.rtt}getRTT(){return this.rtt}async close(){var e,t,n;let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.closeController.signal.aborted)return;const i=null!==(e=null===(t=r)||void 0===t?void 0:t.reason)&&void 0!==e?e:kd.NormalTermination;if(null===(n=this.log)||void 0===n||n.trace("muxer close reason=%s",i),null==r.signal){const e=AbortSignal.timeout(500);(0,fu.Wp)(1/0,e),r={...r,signal:e}}try{await Promise.all([...this._streams.values()].map((async e=>e.close(r)))),this.sendGoAway(i),this._closeMuxer()}catch(o){this.abort(o)}}abort(e,t){var n,r;if(!this.closeController.signal.aborted){t=null!==(n=t)&&void 0!==n?n:kd.InternalError,null===(r=this.log)||void 0===r||r.error("muxer abort reason=%s error=%s",t,e);for(const t of this._streams.values())t.abort(e);this.sendGoAway(t),this._closeMuxer()}}isClosed(){return this.closeController.signal.aborted}_closeMuxer(){this.closeController.abort(),this.source.end()}_newStream(e,t,n,r){if(null!=this._streams.get(e))throw new fu.sv("Stream already exists",yd,{id:e});const i=new zd({id:e.toString(),name:t,state:n,direction:r,sendFrame:this.sendFrame.bind(this),onEnd:()=>{var t;this.closeStream(e),null===(t=this.onStreamEnd)||void 0===t||t.call(this,i)},log:this.logger.forComponent("libp2p:yamux:".concat(r,":").concat(e)),config:this.config,getRTT:this.getRTT.bind(this)});return i}closeStream(e){this.client===(e%2===0)?this.numInboundStreams--:this.numOutboundStreams--,this._streams.delete(e)}async keepAliveLoop(){var e;const t=new Promise(((e,t)=>{this.closeController.signal.addEventListener("abort",t,{once:!0})}));for(null===(e=this.log)||void 0===e||e.trace("muxer keepalive enabled interval=%s",this.config.keepAliveInterval);;){let e;try{await Promise.race([t,new Promise((t=>{e=setTimeout(t,this.config.keepAliveInterval)}))]),this.ping().catch((e=>{var t;return null===(t=this.log)||void 0===t?void 0:t.error("ping error: %s",e)}))}catch(n){return void clearInterval(e)}}}async handleFrame(e,t){var n;const{streamID:r,type:i,length:o}=e;if(null===(n=this.log)||void 0===n||n.trace("received frame %o",e),0===r)switch(i){case Cd.Ping:return void this.handlePing(e);case Cd.GoAway:return void this.handleGoAway(o);default:throw new fu.sv("Invalid frame type",fd,{header:e})}else switch(e.type){case Cd.Data:case Cd.WindowUpdate:return void await this.handleStreamMessage(e,t);default:throw new fu.sv("Invalid frame type",fd,{header:e})}}handlePing(e){if(e.flag===Td.SYN){var t;null===(t=this.log)||void 0===t||t.trace("received ping request pingId=%s",e.length),this.sendPing(e.length,Td.ACK)}else{if(e.flag!==Td.ACK)throw new fu.sv("Invalid frame flag",fd,{header:e});var n;null===(n=this.log)||void 0===n||n.trace("received ping response pingId=%s",e.length),this.handlePingResponse(e.length)}}handlePingResponse(e){if(void 0===this.activePing)throw new fu.sv("ping not requested",pd);if(this.activePing.id!==e)throw new fu.sv("ping doesn't match our id",gd);this.activePing.resolve()}handleGoAway(e){var t,n;null===(t=this.log)||void 0===t||t.trace("received GoAway reason=%s",null!==(n=kd[e])&&void 0!==n?n:"unknown"),this.remoteGoAway=e;for(const r of this._streams.values())r.reset();this._closeMuxer()}async handleStreamMessage(e,t){const{streamID:n,flag:r,type:i}=e;(r&Td.SYN)===Td.SYN&&this.incomingStream(n);const o=this._streams.get(n);if(void 0!==o)switch(i){case Cd.WindowUpdate:return void o.handleWindowUpdate(e);case Cd.Data:if(void 0===t)throw new Error("unreachable");return void await o.handleData(e,t);default:throw new Error("unreachable")}else if(i===Cd.Data){var s;if(null===(s=this.log)||void 0===s||s.call(this,"discarding data for stream id=%s",n),void 0===t)throw new Error("unreachable");await t()}else{var a;null===(a=this.log)||void 0===a||a.call(this,"frame for missing stream id=%s",n)}}incomingStream(e){var t,n,r;if(this.client!==(e%2===0))throw new fu.sv("both endpoints are clients",vd);if(this._streams.has(e))return;if(null===(t=this.log)||void 0===t||t.trace("new incoming stream id=%s",e),void 0!==this.localGoAway)return void this.sendFrame({type:Cd.WindowUpdate,flag:Td.RST,streamID:e,length:0});if(this.numInboundStreams>=this.config.maxInboundStreams)return null===(r=this.log)||void 0===r||r.call(this,"maxIncomingStreams exceeded, forcing stream reset"),void this.sendFrame({type:Cd.WindowUpdate,flag:Td.RST,streamID:e,length:0});const i=this._newStream(e,void 0,Zd.SYNReceived,"inbound");this.numInboundStreams++,this._streams.set(e,i),null===(n=this.onIncomingStream)||void 0===n||n.call(this,i)}sendFrame(e,t){var n;if(null===(n=this.log)||void 0===n||n.trace("sending frame %o",e),e.type===Cd.Data){if(void 0===t)throw new fu.sv("invalid frame",fd);this.source.push(new Zs(Pd(e),t))}else this.source.push(Pd(e))}sendPing(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Td.SYN;var n,r;t===Td.SYN?null===(n=this.log)||void 0===n||n.trace("sending ping request pingId=%s",e):null===(r=this.log)||void 0===r||r.trace("sending ping response pingId=%s",e);this.sendFrame({type:Cd.Ping,flag:t,streamID:0,length:e})}sendGoAway(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:kd.NormalTermination;null===(e=this.log)||void 0===e||e.call(this,"sending GoAway reason=%s",kd[t]),this.localGoAway=t,this.sendFrame({type:Cd.GoAway,flag:0,streamID:0,length:t})}}function Gd(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>new Hd(t,e)}var Wd=n(97723);function Qd(e,t){(0,Wd.Z)(e,t),t.add(e)}function Yd(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}const Jd=Symbol.for("@libp2p/content-routing");class Xd extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"The operation was aborted"),(0,Yo.Z)(this,"code",void 0),(0,Yo.Z)(this,"type",void 0),this.code=Xd.code,this.type=Xd.type}}(0,Yo.Z)(Xd,"code","ABORT_ERR"),(0,Yo.Z)(Xd,"type","aborted");class $d extends Error{constructor(e,t,n){var r;super(e),(0,Yo.Z)(this,"code",void 0),(0,Yo.Z)(this,"props",void 0),this.code=t,this.name=null!==(r=null===n||void 0===n?void 0:n.name)&&void 0!==r?r:"CodeError",this.props=null!==n&&void 0!==n?n:{}}}class ef extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected Peer"),(0,Yo.Z)(this,"code",void 0),this.code=ef.code}}(0,Yo.Z)(ef,"code","ERR_UNEXPECTED_PEER");class tf extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid crypto exchange"),(0,Yo.Z)(this,"code",void 0),this.code=tf.code}}(0,Yo.Z)(tf,"code","ERR_INVALID_CRYPTO_EXCHANGE");class nf extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid crypto transmission"),(0,Yo.Z)(this,"code",void 0),this.code=nf.code}}(0,Yo.Z)(nf,"code","ERR_INVALID_CRYPTO_TRANSMISSION");const rf=Symbol.for("@libp2p/peer-routing");var of=n(18392),sf=n.n(of);var af=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==n[s])throw new TypeError(o+" is ambiguous");n[s]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var r=0,i=0;e[t]===c;)r++,t++;for(var o=(e.length-t)*l+1>>>0,s=new Uint8Array(o);e[t];){var u=n[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=o-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*s[d]>>>0,s[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=o-i;f!==o&&0===s[f];)f++;for(var p=new Uint8Array(r+(o-f)),g=r;f!==o;)p[g++]=s[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,o=t.length;i!==o&&0===t[i];)i++,n++;for(var s=(o-i)*u+1>>>0,l=new Uint8Array(s);i!==o;){for(var h=t[i],d=0,f=s-1;(0!==h||d<r)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");r=d,i++}for(var p=s-r;p!==s&&0===l[p];)p++;for(var g=c.repeat(n);p<s;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:h,decode:function(e){var n=h(e);if(n)return n;throw new Error("Non-".concat(t," character"))}}};const cf=af,lf=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class uf{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(e));throw Error("Unknown type, must be binary type")}}class hf{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(e),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return ff(this,e)}}class df{constructor(e){this.decoders=e}or(e){return ff(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(e),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}}const ff=(e,t)=>new df({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class pf{constructor(e,t,n,r){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=r,this.encoder=new uf(e,t,n),this.decoder=new hf(e,t,r)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const gf=e=>{let{name:t,prefix:n,encode:r,decode:i}=e;return new pf(t,n,r,i)},yf=e=>{let{prefix:t,name:n,alphabet:r}=e;const{encode:i,decode:o}=cf(r,n);return gf({prefix:t,name:n,encode:i,decode:e=>lf(o(e))})},mf=e=>{let{name:t,prefix:n,bitsPerChar:r,alphabet:i}=e;return gf({prefix:n,name:t,encode:e=>((e,t,n)=>{const r="="===t[t.length-1],i=(1<<n)-1;let o="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>n;)s-=n,o+=t[i&a>>s];if(s&&(o+=t[i&a<<n-s]),r)for(;o.length*n&7;)o+="=";return o})(e,i,r),decode:e=>((e,t,n,r)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*n/8|0);let a=0,c=0,l=0;for(let u=0;u<o;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError("Non-".concat(r," character"));c=c<<n|t,a+=n,a>=8&&(a-=8,s[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s})(e,i,r,t)})},vf=mf({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),bf=mf({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),wf=mf({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Ef=mf({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Af=mf({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Sf=mf({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),_f=mf({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),If=mf({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Cf=mf({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Tf=yf({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),kf=yf({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Rf=mf({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),xf=mf({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Pf=mf({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Df=mf({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function Of(e){let t=function(e){const t=()=>{};return t.enabled=!1,t.color="",t.diff=0,t.log=()=>{},t.namespace=e,t.destroy=()=>!0,t.extend=()=>t,t}("".concat(e,":trace"));return sf().enabled("".concat(e,":trace"))&&null!=sf().names.map((e=>e.toString())).find((e=>e.includes(":trace")))&&(t=sf()("".concat(e,":trace"))),Object.assign(sf()(e),{error:sf()("".concat(e,":error")),trace:t})}sf().formatters.b=e=>null==e?"undefined":Tf.baseEncode(e),sf().formatters.t=e=>null==e?"undefined":vf.baseEncode(e),sf().formatters.m=e=>null==e?"undefined":Rf.baseEncode(e),sf().formatters.p=e=>null==e?"undefined":e.toString(),sf().formatters.c=e=>null==e?"undefined":e.toString(),sf().formatters.k=e=>null==e?"undefined":e.toString(),sf().formatters.a=e=>null==e?"undefined":e.toString();const Nf=Symbol.for("@libp2p/peer-id");const Bf=yf({prefix:"9",name:"base10",alphabet:"0123456789"}),Lf=mf({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Mf=mf({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Uf=mf({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Ff=Array.from("\ud83d\ude80\ud83e\ude90\u2604\ud83d\udef0\ud83c\udf0c\ud83c\udf11\ud83c\udf12\ud83c\udf13\ud83c\udf14\ud83c\udf15\ud83c\udf16\ud83c\udf17\ud83c\udf18\ud83c\udf0d\ud83c\udf0f\ud83c\udf0e\ud83d\udc09\u2600\ud83d\udcbb\ud83d\udda5\ud83d\udcbe\ud83d\udcbf\ud83d\ude02\u2764\ud83d\ude0d\ud83e\udd23\ud83d\ude0a\ud83d\ude4f\ud83d\udc95\ud83d\ude2d\ud83d\ude18\ud83d\udc4d\ud83d\ude05\ud83d\udc4f\ud83d\ude01\ud83d\udd25\ud83e\udd70\ud83d\udc94\ud83d\udc96\ud83d\udc99\ud83d\ude22\ud83e\udd14\ud83d\ude06\ud83d\ude44\ud83d\udcaa\ud83d\ude09\u263a\ud83d\udc4c\ud83e\udd17\ud83d\udc9c\ud83d\ude14\ud83d\ude0e\ud83d\ude07\ud83c\udf39\ud83e\udd26\ud83c\udf89\ud83d\udc9e\u270c\u2728\ud83e\udd37\ud83d\ude31\ud83d\ude0c\ud83c\udf38\ud83d\ude4c\ud83d\ude0b\ud83d\udc97\ud83d\udc9a\ud83d\ude0f\ud83d\udc9b\ud83d\ude42\ud83d\udc93\ud83e\udd29\ud83d\ude04\ud83d\ude00\ud83d\udda4\ud83d\ude03\ud83d\udcaf\ud83d\ude48\ud83d\udc47\ud83c\udfb6\ud83d\ude12\ud83e\udd2d\u2763\ud83d\ude1c\ud83d\udc8b\ud83d\udc40\ud83d\ude2a\ud83d\ude11\ud83d\udca5\ud83d\ude4b\ud83d\ude1e\ud83d\ude29\ud83d\ude21\ud83e\udd2a\ud83d\udc4a\ud83e\udd73\ud83d\ude25\ud83e\udd24\ud83d\udc49\ud83d\udc83\ud83d\ude33\u270b\ud83d\ude1a\ud83d\ude1d\ud83d\ude34\ud83c\udf1f\ud83d\ude2c\ud83d\ude43\ud83c\udf40\ud83c\udf37\ud83d\ude3b\ud83d\ude13\u2b50\u2705\ud83e\udd7a\ud83c\udf08\ud83d\ude08\ud83e\udd18\ud83d\udca6\u2714\ud83d\ude23\ud83c\udfc3\ud83d\udc90\u2639\ud83c\udf8a\ud83d\udc98\ud83d\ude20\u261d\ud83d\ude15\ud83c\udf3a\ud83c\udf82\ud83c\udf3b\ud83d\ude10\ud83d\udd95\ud83d\udc9d\ud83d\ude4a\ud83d\ude39\ud83d\udde3\ud83d\udcab\ud83d\udc80\ud83d\udc51\ud83c\udfb5\ud83e\udd1e\ud83d\ude1b\ud83d\udd34\ud83d\ude24\ud83c\udf3c\ud83d\ude2b\u26bd\ud83e\udd19\u2615\ud83c\udfc6\ud83e\udd2b\ud83d\udc48\ud83d\ude2e\ud83d\ude46\ud83c\udf7b\ud83c\udf43\ud83d\udc36\ud83d\udc81\ud83d\ude32\ud83c\udf3f\ud83e\udde1\ud83c\udf81\u26a1\ud83c\udf1e\ud83c\udf88\u274c\u270a\ud83d\udc4b\ud83d\ude30\ud83e\udd28\ud83d\ude36\ud83e\udd1d\ud83d\udeb6\ud83d\udcb0\ud83c\udf53\ud83d\udca2\ud83e\udd1f\ud83d\ude41\ud83d\udea8\ud83d\udca8\ud83e\udd2c\u2708\ud83c\udf80\ud83c\udf7a\ud83e\udd13\ud83d\ude19\ud83d\udc9f\ud83c\udf31\ud83d\ude16\ud83d\udc76\ud83e\udd74\u25b6\u27a1\u2753\ud83d\udc8e\ud83d\udcb8\u2b07\ud83d\ude28\ud83c\udf1a\ud83e\udd8b\ud83d\ude37\ud83d\udd7a\u26a0\ud83d\ude45\ud83d\ude1f\ud83d\ude35\ud83d\udc4e\ud83e\udd32\ud83e\udd20\ud83e\udd27\ud83d\udccc\ud83d\udd35\ud83d\udc85\ud83e\uddd0\ud83d\udc3e\ud83c\udf52\ud83d\ude17\ud83e\udd11\ud83c\udf0a\ud83e\udd2f\ud83d\udc37\u260e\ud83d\udca7\ud83d\ude2f\ud83d\udc86\ud83d\udc46\ud83c\udfa4\ud83d\ude47\ud83c\udf51\u2744\ud83c\udf34\ud83d\udca3\ud83d\udc38\ud83d\udc8c\ud83d\udccd\ud83e\udd40\ud83e\udd22\ud83d\udc45\ud83d\udca1\ud83d\udca9\ud83d\udc50\ud83d\udcf8\ud83d\udc7b\ud83e\udd10\ud83e\udd2e\ud83c\udfbc\ud83e\udd75\ud83d\udea9\ud83c\udf4e\ud83c\udf4a\ud83d\udc7c\ud83d\udc8d\ud83d\udce3\ud83e\udd42"),Kf=Ff.reduce(((e,t,n)=>(e[n]=t,e)),[]),jf=Ff.reduce(((e,t,n)=>(e[t.codePointAt(0)]=n,e)),[]);const Zf=gf({prefix:"\ud83d\ude80",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=Kf[t]),"")},decode:function(e){const t=[];for(const n of e){const e=jf[n.codePointAt(0)];if(void 0===e)throw new Error("Non-base256emoji character: ".concat(n));t.push(e)}return new Uint8Array(t)}}),zf=yf({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Vf=yf({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Hf=mf({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),qf=gf({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),Gf=new TextEncoder,Wf=new TextDecoder,Qf="json",Yf=512,Jf=e=>Gf.encode(JSON.stringify(e)),Xf=e=>JSON.parse(Wf.decode(e)),$f="raw",ep=85,tp=e=>lf(e),np=e=>lf(e);var rp=function e(t,n,r){n=n||[];var i=r=r||0;for(;t>=sp;)n[r++]=255&t|ip,t/=128;for(;t&op;)n[r++]=255&t|ip,t>>>=7;return n[r]=0|t,e.bytes=r-i+1,n},ip=128,op=-128,sp=Math.pow(2,31);var ap=function e(t,n){var r,i=0,o=0,s=n=n||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");r=t[s++],i+=o<28?(r&lp)<<o:(r&lp)*Math.pow(2,o),o+=7}while(r>=cp);return e.bytes=s-n,i},cp=128,lp=127;var up=Math.pow(2,7),hp=Math.pow(2,14),dp=Math.pow(2,21),fp=Math.pow(2,28),pp=Math.pow(2,35),gp=Math.pow(2,42),yp=Math.pow(2,49),mp=Math.pow(2,56),vp=Math.pow(2,63);const bp={encode:rp,decode:ap,encodingLength:function(e){return e<up?1:e<hp?2:e<dp?3:e<fp?4:e<pp?5:e<gp?6:e<yp?7:e<mp?8:e<vp?9:10}},wp=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return[bp.decode(e,t),bp.decode.bytes]},Ep=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return bp.encode(e,t,n),t},Ap=e=>bp.encodingLength(e),Sp=(e,t)=>{const n=t.byteLength,r=Ap(e),i=r+Ap(n),o=new Uint8Array(i+n);return Ep(e,o,0),Ep(n,o,r),o.set(t,i),new Ip(e,n,t,o)},_p=e=>{const t=lf(e),[n,r]=wp(t),[i,o]=wp(t.subarray(r)),s=t.subarray(r+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new Ip(n,i,s,t)};class Ip{constructor(e,t,n,r){this.code=e,this.size=t,this.digest=n,this.bytes=r}}const Cp=lf,Tp={code:0,name:"identity",encode:Cp,digest:e=>Sp(0,Cp(e))},kp=e=>{let{name:t,code:n,encode:r}=e;return new Rp(t,n,r)};class Rp{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Sp(this.code,t):t.then((e=>Sp(this.code,e)))}throw Error("Unknown type, must be binary type")}}const xp=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Pp=kp({name:"sha2-256",code:18,encode:xp("SHA-256")}),Dp=kp({name:"sha2-512",code:19,encode:xp("SHA-512")}),Op=(e,t)=>{const{bytes:n,version:r}=e;return 0===r?Up(n,Bp(e),t||Tf.encoder):Fp(n,Bp(e),t||vf.encoder)},Np=new WeakMap,Bp=e=>{const t=Np.get(e);if(null==t){const t=new Map;return Np.set(e,t),t}return t};class Lp{constructor(e,t,n,r){this.code=t,this.version=e,this.multihash=n,this.bytes=r,this["/"]=r}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==Kp)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==jp)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Lp.createV0(t)}default:throw Error("Can not convert CID version ".concat(this.version," to version 0. This is a bug please report"))}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=Sp(e,t);return Lp.createV1(this.code,n)}case 1:return this;default:throw Error("Can not convert CID version ".concat(this.version," to version 1. This is a bug please report"))}}equals(e){return Lp.equals(this,e)}static equals(e,t){const n=t;return n&&e.code===n.code&&e.version===n.version&&((e,t)=>{if(e===t)return!0;{const n=t;return e.code===n.code&&e.size===n.size&&n.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0})(e.bytes,n.bytes)}})(e.multihash,n.multihash)}toString(e){return Op(this,e)}toJSON(){return{"/":Op(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID(".concat(this.toString(),")")}static asCID(e){if(null==e)return null;const t=e;if(t instanceof Lp)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:n,multihash:r,bytes:i}=t;return new Lp(e,n,r,i||Zp(e,n,r.bytes))}if(!0===t[zp]){const{version:e,multihash:n,code:r}=t,i=_p(n);return Lp.create(e,r,i)}return null}static create(e,t,n){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==Kp)throw new Error("Version 0 CID must use dag-pb (code: ".concat(Kp,") block encoding"));return new Lp(e,t,n,n.bytes);case 1:{const r=Zp(e,t,n.bytes);return new Lp(e,t,n,r)}default:throw new Error("Invalid version")}}static createV0(e){return Lp.create(0,Kp,e)}static createV1(e,t){return Lp.create(1,e,t)}static decode(e){const[t,n]=Lp.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=Lp.inspectBytes(e),n=t.size-t.multihashSize,r=lf(e.subarray(n,n+t.multihashSize));if(r.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=r.subarray(t.multihashSize-t.digestSize),o=new Ip(t.multihashCode,t.digestSize,i,r);return[0===t.version?Lp.createV0(o):Lp.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[n,r]=wp(e.subarray(t));return t+=r,n};let r=n(),i=Kp;if(18===r?(r=0,t=0):i=n(),0!==r&&1!==r)throw new RangeError("Invalid CID version ".concat(r));const o=t,s=n(),a=n(),c=t+a;return{version:r,codec:i,multihashCode:s,digestSize:a,multihashSize:c-o,size:c}}static parse(e,t){const[n,r]=Mp(e,t),i=Lp.decode(r);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return Bp(i).set(n,e),i}}const Mp=(e,t)=>{switch(e[0]){case"Q":{const n=t||Tf;return[Tf.prefix,n.decode("".concat(Tf.prefix).concat(e))]}case Tf.prefix:{const n=t||Tf;return[Tf.prefix,n.decode(e)]}case vf.prefix:{const n=t||vf;return[vf.prefix,n.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},Up=(e,t,n)=>{const{prefix:r}=n;if(r!==Tf.prefix)throw Error("Cannot string encode V0 in ".concat(n.name," encoding"));const i=t.get(r);if(null==i){const i=n.encode(e).slice(1);return t.set(r,i),i}return i},Fp=(e,t,n)=>{const{prefix:r}=n,i=t.get(r);if(null==i){const i=n.encode(e);return t.set(r,i),i}return i},Kp=112,jp=18,Zp=(e,t,n)=>{const r=Ap(e),i=r+Ap(t),o=new Uint8Array(i+n.byteLength);return Ep(e,o,0),Ep(t,o,r),o.set(n,i),o},zp=Symbol.for("@ipld/js-cid/CID"),Vp={...y,...d,...g,...u,...h,...a,...p,...c,...l,...f},Hp=Symbol.for("nodejs.util.inspect.custom"),qp=Object.values(Vp).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)),Vp.identity.decoder),Gp=114,Wp=36,Qp=37;class Yp{constructor(e){(0,Yo.Z)(this,"type",void 0),(0,Yo.Z)(this,"multihash",void 0),(0,Yo.Z)(this,"privateKey",void 0),(0,Yo.Z)(this,"publicKey",void 0),(0,Yo.Z)(this,"string",void 0),(0,Yo.Z)(this,Nf,!0),this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return"PeerId(".concat(this.toString(),")")}toString(){return null==this.string&&(this.string=Tf.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return Lp.createV1(Gp,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){var t;if(e instanceof Uint8Array)return(0,Ms.f)(this.multihash.bytes,e);if("string"===typeof e)return eg(e).equals(this);if(null!=(null===e||void 0===e||null===(t=e.multihash)||void 0===t?void 0:t.bytes))return(0,Ms.f)(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[Hp](){return"PeerId(".concat(this.toString(),")")}}class Jp extends Yp{constructor(e){super({...e,type:"RSA"}),(0,Yo.Z)(this,"type","RSA"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.publicKey}}class Xp extends Yp{constructor(e){super({...e,type:"Ed25519"}),(0,Yo.Z)(this,"type","Ed25519"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.multihash.digest}}class $p extends Yp{constructor(e){super({...e,type:"secp256k1"}),(0,Yo.Z)(this,"type","secp256k1"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.multihash.digest}}function eg(e,t){var n;if(t=null!==(n=t)&&void 0!==n?n:qp,"1"===e.charAt(0)||"Q"===e.charAt(0)){const t=_p(Tf.decode("z".concat(e)));return e.startsWith("12D")?new Xp({multihash:t}):e.startsWith("16U")?new $p({multihash:t}):new Jp({multihash:t})}return tg(qp.decode(e))}function tg(e){try{const t=_p(e);if(t.code===Tp.code){if(t.digest.length===Wp)return new Xp({multihash:t});if(t.digest.length===Qp)return new $p({multihash:t})}if(t.code===Pp.code)return new Jp({multihash:t})}catch{return function(e){if(null==e||null==e.multihash||null==e.version||1===e.version&&e.code!==Gp)throw new Error("Supplied PeerID CID is invalid");const t=e.multihash;if(t.code===Pp.code)return new Jp({multihash:e.multihash});if(t.code===Tp.code){if(t.digest.length===Wp)return new Xp({multihash:e.multihash});if(t.digest.length===Qp)return new $p({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}(Lp.decode(e))}throw new Error("Supplied PeerID CID is invalid")}var ng=n(95321);function rg(e){const t=new globalThis.AbortController;function n(){t.abort();for(const t of e)null!=(null===t||void 0===t?void 0:t.removeEventListener)&&t.removeEventListener("abort",n)}for(const i of e){if(!0===(null===i||void 0===i?void 0:i.aborted)){n();break}null!=(null===i||void 0===i?void 0:i.addEventListener)&&i.addEventListener("abort",n)}const r=t.signal;return r.clear=function(){for(const t of e)null!=(null===t||void 0===t?void 0:t.removeEventListener)&&t.removeEventListener("abort",n)},r}var ig=n(75584);const og=32,sg=64,ag=32;function cg(e,t){const n=new Uint8Array(sg);for(let r=0;r<ag;r++)n[r]=e[r],n[ag+r]=t[r];return n}const lg={get(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:globalThis).crypto;if(null==e||null==e.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}},ug={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};async function hg(e,t){const n=function(e){var t,n,r,i,o,s;const a=null!==(t=null===e||void 0===e?void 0:e.algorithm)&&void 0!==t?t:"AES-GCM";let c=null!==(n=null===e||void 0===e?void 0:e.keyLength)&&void 0!==n?n:16;const l=null!==(r=null===e||void 0===e?void 0:e.nonceLength)&&void 0!==r?r:12,u=null!==(i=null===e||void 0===e?void 0:e.digest)&&void 0!==i?i:"SHA-256",h=null!==(o=null===e||void 0===e?void 0:e.saltLength)&&void 0!==o?o:16,d=null!==(s=null===e||void 0===e?void 0:e.iterations)&&void 0!==s?s:32767,f=lg.get();return c*=8,{encrypt:async function(e,t){const n=f.getRandomValues(new Uint8Array(h)),r=f.getRandomValues(new Uint8Array(l)),i={name:a,iv:r};let o;if("string"===typeof t&&(t=(0,yu.m)(t)),0===t.length){o=await f.subtle.importKey("jwk",ug,{name:"AES-GCM"},!0,["encrypt"]);try{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);o=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["encrypt"])}catch{o=await f.subtle.importKey("jwk",ug,{name:"AES-GCM"},!0,["encrypt"])}}else{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);o=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["encrypt"])}const s=await f.subtle.encrypt(i,o,e);return(0,Ls.z)([n,i.iv,new Uint8Array(s)])},decrypt:async function(e,t){const n=e.subarray(0,h),r=e.subarray(h,h+l),i=e.subarray(h+l),o={name:a,iv:r};let s;if("string"===typeof t&&(t=(0,yu.m)(t)),0===t.length)try{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);s=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["decrypt"])}catch{s=await f.subtle.importKey("jwk",ug,{name:"AES-GCM"},!0,["decrypt"])}else{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);s=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["decrypt"])}const p=await f.subtle.decrypt(o,s,i);return new Uint8Array(p)}}}(),r=await n.encrypt(e,t);return Rf.encode(r)}var dg,fg,pg,gg;!function(e){e.RSA="RSA",e.Ed25519="Ed25519",e.Secp256k1="Secp256k1"}(dg||(dg={})),function(e){e[e.RSA=0]="RSA",e[e.Ed25519=1]="Ed25519",e[e.Secp256k1=2]="Secp256k1"}(fg||(fg={})),function(e){e.codec=()=>bs(fg)}(dg||(dg={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),dg.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.Type=dg.codec().decode(e);break;case 2:n.Data=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(pg||(pg={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),dg.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.Type=dg.codec().decode(e);break;case 2:n.Data=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(gg||(gg={}));class yg{constructor(e){(0,Yo.Z)(this,"_key",void 0),this._key=Ag(e,og)}async verify(e,t){return async function(e,t,n){return ql.verify(t,n,e)}(this._key,t,e)}marshal(){return this._key}get bytes(){return pg.encode({Type:dg.Ed25519,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await Pp.digest(this.bytes);return e}}class mg{constructor(e,t){(0,Yo.Z)(this,"_key",void 0),(0,Yo.Z)(this,"_publicKey",void 0),this._key=Ag(e,sg),this._publicKey=Ag(t,og)}async sign(e){return async function(e,t){const n=e.subarray(0,ag);return ql.sign(t,n)}(this._key,e)}get public(){return new yg(this._publicKey)}marshal(){return this._key}get bytes(){return gg.encode({Type:dg.Ed25519,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await Pp.digest(this.bytes);return e}async id(){const e=Tp.digest(this.public.bytes);return Tf.encode(e.bytes).substring(1)}async export(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"libp2p-key";if("libp2p-key"===t)return hg(this.bytes,e);throw new $d("export format '".concat(t,"' is not supported"),"ERR_INVALID_EXPORT_FORMAT")}}function vg(e){if(e.length>sg){const t=(e=Ag(e,sg+og)).subarray(0,sg),n=e.subarray(sg,e.length);return new mg(t,n)}const t=(e=Ag(e,sg)).subarray(0,sg),n=e.subarray(og);return new mg(t,n)}function bg(e){return e=Ag(e,og),new yg(e)}async function wg(){const{privateKey:e,publicKey:t}=await async function(){const e=ql.utils.randomPrivateKey(),t=ql.getPublicKey(e);return{privateKey:cg(e,t),publicKey:t}}();return new mg(e,t)}async function Eg(e){const{privateKey:t,publicKey:n}=await async function(e){if(e.length!==ag)throw new TypeError('"seed" must be 32 bytes in length.');if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');const t=e,n=ql.getPublicKey(t);return{privateKey:cg(t,n),publicKey:n}}(e);return new mg(t,n)}function Ag(e,t){var n;if((e=Uint8Array.from(null!==(n=e)&&void 0!==n?n:[])).length!==t)throw new $d("Key must be a Uint8Array of length ".concat(t,", got ").concat(e.length),"ERR_INVALID_KEY_TYPE");return e}function Sg(e,t){let n=Uint8Array.from(e.abs().toByteArray());if(n=0===n[0]?n.subarray(1):n,null!=t){if(n.length>t)throw new Error("byte array longer than desired length");n=(0,Ls.z)([new Uint8Array(t-n.length),n])}return(0,Au.B)(n,"base64url")}function _g(e){const t=function(e,t){let n=(0,yu.m)(e,"base64urlpad");if(null!=t){if(n.length>t)throw new Error("byte array longer than desired length");n=(0,Ls.z)([new Uint8Array(t-n.length),n])}return n}(e);return new(gu().jsbn.BigInteger)((0,Au.B)(t,"base16"),16)}const Ig={"P-256":256,"P-384":384,"P-521":521};Object.keys(Ig).join(" / ");function Cg(e,t){return t.map((t=>_g(e[t])))}async function Tg(e){const t=[await lg.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await Rg(e)],n=await kg({privateKey:t[0],publicKey:t[1]});return{privateKey:n[0],publicKey:n[1]}}async function kg(e){if(null==e.privateKey||null==e.publicKey)throw new $d("Private and public key are required","ERR_INVALID_PARAMETERS");return Promise.all([lg.get().subtle.exportKey("jwk",e.privateKey),lg.get().subtle.exportKey("jwk",e.publicKey)])}async function Rg(e){return lg.get().subtle.importKey("jwk",{kty:e.kty,n:e.n,e:e.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function xg(e,t,n,r){const i=t?function(e){return gu().pki.setRsaPublicKey(...Cg(e,["n","e"]))}(e):function(e){return gu().pki.setRsaPrivateKey(...Cg(e,["n","e","d","p","q","dp","dq","qi"]))}(e),o=r((0,Au.B)(Uint8Array.from(n),"ascii"),i);return(0,yu.m)(o,"ascii")}function Pg(e){if("RSA"!==e.kty)throw new $d("invalid key type","ERR_INVALID_KEY_TYPE");if(null==e.n)throw new $d("invalid key modulus","ERR_INVALID_KEY_MODULUS");return 8*(0,yu.m)(e.n,"base64url").length}const Dg=8192;class Og{constructor(e){(0,Yo.Z)(this,"_key",void 0),this._key=e}async verify(e,t){return async function(e,t,n){const r=await lg.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return lg.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},r,t,n)}(this._key,t,e)}marshal(){return function(e){if(null==e.n||null==e.e)throw new $d("JWK was missing components","ERR_INVALID_PARAMETERS");const t=gu().pki.publicKeyToAsn1({n:_g(e.n),e:_g(e.e)});return(0,yu.m)(gu().asn1.toDer(t).getBytes(),"ascii")}(this._key)}get bytes(){return pg.encode({Type:dg.RSA,Data:this.marshal()}).subarray()}encrypt(e){return xg(this._key,!0,e,((e,t)=>t.encrypt(e)))}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await Pp.digest(this.bytes);return e}}class Ng{constructor(e,t){(0,Yo.Z)(this,"_key",void 0),(0,Yo.Z)(this,"_publicKey",void 0),this._key=e,this._publicKey=t}genSecret(){return function(e){if(isNaN(e)||e<=0)throw new $d("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return _c(e)}(16)}async sign(e){return async function(e,t){const n=await lg.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),r=await lg.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},n,Uint8Array.from(t));return new Uint8Array(r,0,r.byteLength)}(this._key,e)}get public(){if(null==this._publicKey)throw new $d("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new Og(this._publicKey)}decrypt(e){return xg(this._key,!1,e,((e,t)=>t.decrypt(e)))}marshal(){return function(e){if(null==e.n||null==e.e||null==e.d||null==e.p||null==e.q||null==e.dp||null==e.dq||null==e.qi)throw new $d("JWK was missing components","ERR_INVALID_PARAMETERS");const t=gu().pki.privateKeyToAsn1({n:_g(e.n),e:_g(e.e),d:_g(e.d),p:_g(e.p),q:_g(e.q),dP:_g(e.dp),dQ:_g(e.dq),qInv:_g(e.qi)});return(0,yu.m)(gu().asn1.toDer(t).getBytes(),"ascii")}(this._key)}get bytes(){return gg.encode({Type:dg.RSA,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await Pp.digest(this.bytes);return e}async id(){const e=await this.public.hash();return(0,Au.B)(e,"base58btc")}async export(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"pkcs-8";if("pkcs-8"===t){const t=new(gu().util.ByteBuffer)(this.marshal()),n=gu().asn1.fromDer(t),r=gu().pki.privateKeyFromAsn1(n),i={algorithm:"aes256",count:1e4,saltSize:16,prfAlgorithm:"sha512"};return gu().pki.encryptRsaPrivateKey(r,e,i)}if("libp2p-key"===t)return hg(this.bytes,e);throw new $d("export format '".concat(t,"' is not supported"),"ERR_INVALID_EXPORT_FORMAT")}}async function Bg(e){const t=function(e){const t=gu().asn1.fromDer((0,Au.B)(e,"ascii")),n=gu().pki.privateKeyFromAsn1(t);return{kty:"RSA",n:Sg(n.n),e:Sg(n.e),d:Sg(n.d),p:Sg(n.p),q:Sg(n.q),dp:Sg(n.dP),dq:Sg(n.dQ),qi:Sg(n.qInv),alg:"RS256"}}(e);if(Pg(t)>Dg)throw new $d("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const n=await Tg(t);return new Ng(n.privateKey,n.publicKey)}function Lg(e){const t=function(e){const t=gu().asn1.fromDer((0,Au.B)(e,"ascii")),n=gu().pki.publicKeyFromAsn1(t);return{kty:"RSA",n:Sg(n.n),e:Sg(n.e)}}(e);if(Pg(t)>Dg)throw new $d("key size is too large","ERR_KEY_SIZE_TOO_LARGE");return new Og(t)}async function Mg(e){if(Pg(e)>Dg)throw new $d("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const t=await Tg(e);return new Ng(t.privateKey,t.publicKey)}async function Ug(e){if(e>Dg)throw new $d("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const t=await async function(e){const t=await lg.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),n=await kg(t);return{privateKey:n[0],publicKey:n[1]}}(e);return new Ng(t.privateKey,t.publicKey)}function Fg(e){try{Eh.ProjectivePoint.fromHex(e)}catch(t){throw new $d(String(t),"ERR_INVALID_PUBLIC_KEY")}}class Kg{constructor(e){(0,Yo.Z)(this,"_key",void 0),Fg(e),this._key=e}async verify(e,t){return async function(e,t,n){try{const{digest:r}=await Pp.digest(n);return Eh.verify(t,r,e)}catch(r){throw new $d(String(r),"ERR_INVALID_INPUT")}}(this._key,t,e)}marshal(){return e=this._key,Eh.ProjectivePoint.fromHex(e).toRawBytes(!0);var e}get bytes(){return pg.encode({Type:dg.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await Pp.digest(this.bytes);return e}}class jg{constructor(e,t){(0,Yo.Z)(this,"_key",void 0),(0,Yo.Z)(this,"_publicKey",void 0),this._key=e,this._publicKey=null!==t&&void 0!==t?t:function(e){try{return Eh.getPublicKey(e,!0)}catch(t){throw new $d(String(t),"ERR_INVALID_PRIVATE_KEY")}}(e),function(e){try{Eh.getPublicKey(e,!0)}catch(t){throw new $d(String(t),"ERR_INVALID_PRIVATE_KEY")}}(this._key),Fg(this._publicKey)}async sign(e){return async function(e,t){const{digest:n}=await Pp.digest(t);try{return Eh.sign(n,e).toDERRawBytes()}catch(r){throw new $d(String(r),"ERR_INVALID_INPUT")}}(this._key,e)}get public(){return new Kg(this._publicKey)}marshal(){return this._key}get bytes(){return gg.encode({Type:dg.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await Pp.digest(this.bytes);return e}async id(){const e=await this.public.hash();return(0,Au.B)(e,"base58btc")}async export(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"libp2p-key";if("libp2p-key"===t)return hg(this.bytes,e);throw new $d("export format '".concat(t,"' is not supported"),"ERR_INVALID_EXPORT_FORMAT")}}function Zg(e){return new jg(e)}function zg(e){return new Kg(e)}async function Vg(){const e=Eh.utils.randomPrivateKey();return new jg(e)}const Hg={rsa:A,ed25519:E,secp256k1:S};function qg(e){const t=Object.keys(Hg).join(" / ");return new $d("invalid or unsupported key type ".concat(e,". Must be ").concat(t),"ERR_UNSUPPORTED_KEY_TYPE")}function Gg(e){var t,n;const r=pg.decode(e),i=null!==(t=r.Data)&&void 0!==t?t:new Uint8Array;switch(r.Type){case dg.RSA:return Hg.rsa.unmarshalRsaPublicKey(i);case dg.Ed25519:return Hg.ed25519.unmarshalEd25519PublicKey(i);case dg.Secp256k1:return Hg.secp256k1.unmarshalSecp256k1PublicKey(i);default:throw qg(null!==(n=r.Type)&&void 0!==n?n:"unknown")}}const Wg="/",Qg=(new TextEncoder).encode(Wg);Qg[0];Symbol.toStringTag;var Yg,Jg=n(92244),Xg=n.n(Jg);!function(e){let t,n,r;!function(e){e.EOL="EOL"}(t=e.ValidityType||(e.ValidityType={})),function(e){e[e.EOL=0]="EOL"}(n||(n={})),function(e){e.codec=()=>bs(n)}(t=e.ValidityType||(e.ValidityType={})),e.codec=()=>(null==r&&(r=ws((function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==r.lengthDelimited&&n.fork(),null!=t.value&&(n.uint32(10),n.bytes(t.value)),null!=t.signatureV1&&(n.uint32(18),n.bytes(t.signatureV1)),null!=t.validityType&&(n.uint32(24),e.ValidityType.codec().encode(t.validityType,n)),null!=t.validity&&(n.uint32(34),n.bytes(t.validity)),null!=t.sequence&&(n.uint32(40),n.uint64(t.sequence)),null!=t.ttl&&(n.uint32(48),n.uint64(t.ttl)),null!=t.pubKey&&(n.uint32(58),n.bytes(t.pubKey)),null!=t.signatureV2&&(n.uint32(66),n.bytes(t.signatureV2)),null!=t.data&&(n.uint32(74),n.bytes(t.data)),!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.value=t.bytes();break;case 2:r.signatureV1=t.bytes();break;case 3:r.validityType=e.ValidityType.codec().decode(t);break;case 4:r.validity=t.bytes();break;case 5:r.sequence=t.uint64();break;case 6:r.ttl=t.uint64();break;case 7:r.pubKey=t.bytes();break;case 8:r.signatureV2=t.bytes();break;case 9:r.data=t.bytes();break;default:t.skipType(7&n)}}return r}))),r),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(Yg||(Yg={}));const $g=["string","number","bigint","symbol"],ey=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function ty(e){if(null===e)return"null";if(void 0===e)return"undefined";if(!0===e||!1===e)return"boolean";const t=typeof e;if($g.includes(t))return t;if("function"===t)return"Function";if(Array.isArray(e))return"Array";if(function(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}(e))return"Buffer";const n=function(e){const t=Object.prototype.toString.call(e).slice(8,-1);if(ey.includes(t))return t;return}(e);return n||"Object"}class ny{constructor(e,t,n){this.major=e,this.majorEncoded=e<<5,this.name=t,this.terminal=n}toString(){return"Type[".concat(this.major,"].").concat(this.name)}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}}ny.uint=new ny(0,"uint",!0),ny.negint=new ny(1,"negint",!0),ny.bytes=new ny(2,"bytes",!0),ny.string=new ny(3,"string",!0),ny.array=new ny(4,"array",!1),ny.map=new ny(5,"map",!1),ny.tag=new ny(6,"tag",!1),ny.float=new ny(7,"float",!0),ny.false=new ny(7,"false",!0),ny.true=new ny(7,"true",!0),ny.null=new ny(7,"null",!0),ny.undefined=new ny(7,"undefined",!0),ny.break=new ny(7,"break",!0);class ry{constructor(e,t,n){this.type=e,this.value=t,this.encodedLength=n,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return"Token[".concat(this.type,"].").concat(this.value)}}const iy=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&"function"===typeof globalThis.Buffer.isBuffer,oy=new TextDecoder,sy=new TextEncoder;function ay(e){return iy&&globalThis.Buffer.isBuffer(e)}const cy=iy?(e,t,n)=>n-t>64?globalThis.Buffer.from(e.subarray(t,n)).toString("utf8"):py(e,t,n):(e,t,n)=>n-t>64?oy.decode(e.subarray(t,n)):py(e,t,n),ly=iy?e=>e.length>64?globalThis.Buffer.from(e):fy(e):e=>e.length>64?sy.encode(e):fy(e),uy=iy?(e,t,n)=>ay(e)?new Uint8Array(e.subarray(t,n)):e.slice(t,n):(e,t,n)=>e.slice(t,n),hy=iy?(e,t)=>(e=e.map((e=>e instanceof Uint8Array?e:globalThis.Buffer.from(e))),function(e){return e instanceof Uint8Array?ay(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e:Uint8Array.from(e)}(globalThis.Buffer.concat(e,t))):(e,t)=>{const n=new Uint8Array(t);let r=0;for(let i of e)r+i.length>n.length&&(i=i.subarray(0,n.length-r)),n.set(i,r),r+=i.length;return n},dy=iy?e=>globalThis.Buffer.allocUnsafe(e):e=>new Uint8Array(e);function fy(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t}function py(e,t,n){const r=[];for(;t<n;){const i=e[t];let o=null,s=i>239?4:i>223?3:i>191?2:1;if(t+s<=n){let n,r,a,c;switch(s){case 1:i<128&&(o=i);break;case 2:n=e[t+1],128===(192&n)&&(c=(31&i)<<6|63&n,c>127&&(o=c));break;case 3:n=e[t+1],r=e[t+2],128===(192&n)&&128===(192&r)&&(c=(15&i)<<12|(63&n)<<6|63&r,c>2047&&(c<55296||c>57343)&&(o=c));break;case 4:n=e[t+1],r=e[t+2],a=e[t+3],128===(192&n)&&128===(192&r)&&128===(192&a)&&(c=(15&i)<<18|(63&n)<<12|(63&r)<<6|63&a,c>65535&&c<1114112&&(o=c))}}null===o?(o=65533,s=1):o>65535&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|1023&o),r.push(o),t+=s}return function(e){const t=e.length;if(t<=gy)return String.fromCharCode.apply(String,e);let n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=gy));return n}(r)}const gy=4096;const yy="CBOR decode error:",my="CBOR encode error:",vy=[];function by(e,t,n){if(e.length-t<n)throw new Error("".concat(yy," not enough data for type"))}vy[23]=1,vy[24]=2,vy[25]=3,vy[26]=5,vy[27]=9;const wy=[24,256,65536,4294967296,BigInt("18446744073709551616")];function Ey(e,t,n){by(e,t,1);const r=e[t];if(!0===n.strict&&r<wy[0])throw new Error("".concat(yy," integer encoded in more bytes than necessary (strict decode)"));return r}function Ay(e,t,n){by(e,t,2);const r=e[t]<<8|e[t+1];if(!0===n.strict&&r<wy[1])throw new Error("".concat(yy," integer encoded in more bytes than necessary (strict decode)"));return r}function Sy(e,t,n){by(e,t,4);const r=16777216*e[t]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];if(!0===n.strict&&r<wy[2])throw new Error("".concat(yy," integer encoded in more bytes than necessary (strict decode)"));return r}function _y(e,t,n){by(e,t,8);const r=16777216*e[t]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3],i=16777216*e[t+4]+(e[t+5]<<16)+(e[t+6]<<8)+e[t+7],o=(BigInt(r)<<BigInt(32))+BigInt(i);if(!0===n.strict&&o<wy[3])throw new Error("".concat(yy," integer encoded in more bytes than necessary (strict decode)"));if(o<=Number.MAX_SAFE_INTEGER)return Number(o);if(!0===n.allowBigInt)return o;throw new Error("".concat(yy," integers outside of the safe integer range are not supported"))}function Iy(e,t){return Cy(e,0,t.value)}function Cy(e,t,n){if(n<wy[0]){const r=Number(n);e.push([t|r])}else if(n<wy[1]){const r=Number(n);e.push([24|t,r])}else if(n<wy[2]){const r=Number(n);e.push([25|t,r>>>8,255&r])}else if(n<wy[3]){const r=Number(n);e.push([26|t,r>>>24&255,r>>>16&255,r>>>8&255,255&r])}else{const r=BigInt(n);if(!(r<wy[4]))throw new Error("".concat(yy," encountered BigInt larger than allowable range"));{const n=[27|t,0,0,0,0,0,0,0];let i=Number(r&BigInt(4294967295)),o=Number(r>>BigInt(32)&BigInt(4294967295));n[8]=255&i,i>>=8,n[7]=255&i,i>>=8,n[6]=255&i,i>>=8,n[5]=255&i,n[4]=255&o,o>>=8,n[3]=255&o,o>>=8,n[2]=255&o,o>>=8,n[1]=255&o,e.push(n)}}}Iy.encodedSize=function(e){return Cy.encodedSize(e.value)},Cy.encodedSize=function(e){return e<wy[0]?1:e<wy[1]?2:e<wy[2]?3:e<wy[3]?5:9},Iy.compareTokens=function(e,t){return e.value<t.value?-1:e.value>t.value?1:0};const Ty=BigInt(-1),ky=BigInt(1);function Ry(e,t){const n=t.value,r="bigint"===typeof n?n*Ty-ky:-1*n-1;Cy(e,t.type.majorEncoded,r)}function xy(e,t,n,r){by(e,t,n+r);const i=uy(e,t+n,t+n+r);return new ry(ny.bytes,i,n+r)}function Py(e,t,n,r){return xy(e,t,1,n)}function Dy(e){return void 0===e.encodedBytes&&(e.encodedBytes=e.type===ny.string?ly(e.value):e.value),e.encodedBytes}function Oy(e,t){const n=Dy(t);Cy(e,t.type.majorEncoded,n.length),e.push(n)}function Ny(e,t,n,r,i){const o=n+r;by(e,t,o);const s=new ry(ny.string,cy(e,t+n,t+o),o);return!0===i.retainStringBytes&&(s.byteValue=uy(e,t+n,t+o)),s}function By(e,t,n,r){return Ny(e,t,1,n,r)}Ry.encodedSize=function(e){const t=e.value,n="bigint"===typeof t?t*Ty-ky:-1*t-1;return n<wy[0]?1:n<wy[1]?2:n<wy[2]?3:n<wy[3]?5:9},Ry.compareTokens=function(e,t){return e.value<t.value?1:e.value>t.value?-1:0},Oy.encodedSize=function(e){const t=Dy(e);return Cy.encodedSize(t.length)+t.length},Oy.compareTokens=function(e,t){return n=Dy(e),r=Dy(t),n.length<r.length?-1:n.length>r.length?1:function(e,t){if(ay(e)&&ay(t))return e.compare(t);for(let n=0;n<e.length;n++)if(e[n]!==t[n])return e[n]<t[n]?-1:1;return 0}(n,r);var n,r};const Ly=Oy;function My(e,t,n,r){return new ry(ny.array,r,n)}function Uy(e,t,n,r){return My(0,0,1,n)}function Fy(e,t){Cy(e,ny.array.majorEncoded,t.value)}function Ky(e,t,n,r){return new ry(ny.map,r,n)}function jy(e,t,n,r){return Ky(0,0,1,n)}function Zy(e,t){Cy(e,ny.map.majorEncoded,t.value)}function zy(e,t,n,r){return new ry(ny.tag,n,1)}function Vy(e,t){Cy(e,ny.tag.majorEncoded,t.value)}Fy.compareTokens=Iy.compareTokens,Fy.encodedSize=function(e){return Cy.encodedSize(e.value)},Zy.compareTokens=Iy.compareTokens,Zy.encodedSize=function(e){return Cy.encodedSize(e.value)},Vy.compareTokens=Iy.compareTokens,Vy.encodedSize=function(e){return Cy.encodedSize(e.value)};const Hy=20,qy=21,Gy=22,Wy=23;function Qy(e,t,n){if(n){if(!1===n.allowNaN&&Number.isNaN(e))throw new Error("".concat(yy," NaN values are not supported"));if(!1===n.allowInfinity&&(e===1/0||e===-1/0))throw new Error("".concat(yy," Infinity values are not supported"))}return new ry(ny.float,e,t)}function Yy(e,t,n){const r=t.value;if(!1===r)e.push([ny.float.majorEncoded|Hy]);else if(!0===r)e.push([ny.float.majorEncoded|qy]);else if(null===r)e.push([ny.float.majorEncoded|Gy]);else if(void 0===r)e.push([ny.float.majorEncoded|Wy]);else{let t,o=!1;n&&!0===n.float64||(em(r),t=tm($y,1),r===t||Number.isNaN(r)?($y[0]=249,e.push($y.slice(0,3)),o=!0):(nm(r),t=rm($y,1),r===t&&($y[0]=250,e.push($y.slice(0,5)),o=!0))),o||(i=r,Xy.setFloat64(0,i,!1),t=im($y,1),$y[0]=251,e.push($y.slice(0,9)))}var i}Yy.encodedSize=function(e,t){const n=e.value;if(!1===n||!0===n||null===n||void 0===n)return 1;if(!t||!0!==t.float64){em(n);let e=tm($y,1);if(n===e||Number.isNaN(n))return 3;if(nm(n),e=rm($y,1),n===e)return 5}return 9};const Jy=new ArrayBuffer(9),Xy=new DataView(Jy,1),$y=new Uint8Array(Jy,0);function em(e){if(e===1/0)Xy.setUint16(0,31744,!1);else if(e===-1/0)Xy.setUint16(0,64512,!1);else if(Number.isNaN(e))Xy.setUint16(0,32256,!1);else{Xy.setFloat32(0,e);const t=Xy.getUint32(0),n=(2139095040&t)>>23,r=8388607&t;if(255===n)Xy.setUint16(0,31744,!1);else if(0===n)Xy.setUint16(0,(2147483648&e)>>16|r>>13,!1);else{const e=n-127;e<-24?Xy.setUint16(0,0):e<-14?Xy.setUint16(0,(2147483648&t)>>16|1<<24+e,!1):Xy.setUint16(0,(2147483648&t)>>16|e+15<<10|r>>13,!1)}}}function tm(e,t){if(e.length-t<2)throw new Error("".concat(yy," not enough data for float16"));const n=(e[t]<<8)+e[t+1];if(31744===n)return 1/0;if(64512===n)return-1/0;if(32256===n)return NaN;const r=n>>10&31,i=1023&n;let o;return o=0===r?i*2**-24:31!==r?(i+1024)*2**(r-25):0===i?1/0:NaN,32768&n?-o:o}function nm(e){Xy.setFloat32(0,e,!1)}function rm(e,t){if(e.length-t<4)throw new Error("".concat(yy," not enough data for float32"));const n=(e.byteOffset||0)+t;return new DataView(e.buffer,n,4).getFloat32(0,!1)}function im(e,t){if(e.length-t<8)throw new Error("".concat(yy," not enough data for float64"));const n=(e.byteOffset||0)+t;return new DataView(e.buffer,n,8).getFloat64(0,!1)}function om(e,t,n){throw new Error("".concat(yy," encountered invalid minor (").concat(n,") for major ").concat(e[t]>>>5))}function sm(e){return()=>{throw new Error("".concat(yy," ").concat(e))}}Yy.compareTokens=Iy.compareTokens;const am=[];for(let Ige=0;Ige<=23;Ige++)am[Ige]=om;am[24]=function(e,t,n,r){return new ry(ny.uint,Ey(e,t+1,r),2)},am[25]=function(e,t,n,r){return new ry(ny.uint,Ay(e,t+1,r),3)},am[26]=function(e,t,n,r){return new ry(ny.uint,Sy(e,t+1,r),5)},am[27]=function(e,t,n,r){return new ry(ny.uint,_y(e,t+1,r),9)},am[28]=om,am[29]=om,am[30]=om,am[31]=om;for(let Ige=32;Ige<=55;Ige++)am[Ige]=om;am[56]=function(e,t,n,r){return new ry(ny.negint,-1-Ey(e,t+1,r),2)},am[57]=function(e,t,n,r){return new ry(ny.negint,-1-Ay(e,t+1,r),3)},am[58]=function(e,t,n,r){return new ry(ny.negint,-1-Sy(e,t+1,r),5)},am[59]=function(e,t,n,r){const i=_y(e,t+1,r);if("bigint"!==typeof i){const e=-1-i;if(e>=Number.MIN_SAFE_INTEGER)return new ry(ny.negint,e,9)}if(!0!==r.allowBigInt)throw new Error("".concat(yy," integers outside of the safe integer range are not supported"));return new ry(ny.negint,Ty-BigInt(i),9)},am[60]=om,am[61]=om,am[62]=om,am[63]=om;for(let Ige=64;Ige<=87;Ige++)am[Ige]=Py;am[88]=function(e,t,n,r){return xy(e,t,2,Ey(e,t+1,r))},am[89]=function(e,t,n,r){return xy(e,t,3,Ay(e,t+1,r))},am[90]=function(e,t,n,r){return xy(e,t,5,Sy(e,t+1,r))},am[91]=function(e,t,n,r){const i=_y(e,t+1,r);if("bigint"===typeof i)throw new Error("".concat(yy," 64-bit integer bytes lengths not supported"));return xy(e,t,9,i)},am[92]=om,am[93]=om,am[94]=om,am[95]=sm("indefinite length bytes/strings are not supported");for(let Ige=96;Ige<=119;Ige++)am[Ige]=By;am[120]=function(e,t,n,r){return Ny(e,t,2,Ey(e,t+1,r),r)},am[121]=function(e,t,n,r){return Ny(e,t,3,Ay(e,t+1,r),r)},am[122]=function(e,t,n,r){return Ny(e,t,5,Sy(e,t+1,r),r)},am[123]=function(e,t,n,r){const i=_y(e,t+1,r);if("bigint"===typeof i)throw new Error("".concat(yy," 64-bit integer string lengths not supported"));return Ny(e,t,9,i,r)},am[124]=om,am[125]=om,am[126]=om,am[127]=sm("indefinite length bytes/strings are not supported");for(let Ige=128;Ige<=151;Ige++)am[Ige]=Uy;am[152]=function(e,t,n,r){return My(0,0,2,Ey(e,t+1,r))},am[153]=function(e,t,n,r){return My(0,0,3,Ay(e,t+1,r))},am[154]=function(e,t,n,r){return My(0,0,5,Sy(e,t+1,r))},am[155]=function(e,t,n,r){const i=_y(e,t+1,r);if("bigint"===typeof i)throw new Error("".concat(yy," 64-bit integer array lengths not supported"));return My(0,0,9,i)},am[156]=om,am[157]=om,am[158]=om,am[159]=function(e,t,n,r){if(!1===r.allowIndefinite)throw new Error("".concat(yy," indefinite length items not allowed"));return My(0,0,1,1/0)};for(let Ige=160;Ige<=183;Ige++)am[Ige]=jy;am[184]=function(e,t,n,r){return Ky(0,0,2,Ey(e,t+1,r))},am[185]=function(e,t,n,r){return Ky(0,0,3,Ay(e,t+1,r))},am[186]=function(e,t,n,r){return Ky(0,0,5,Sy(e,t+1,r))},am[187]=function(e,t,n,r){const i=_y(e,t+1,r);if("bigint"===typeof i)throw new Error("".concat(yy," 64-bit integer map lengths not supported"));return Ky(0,0,9,i)},am[188]=om,am[189]=om,am[190]=om,am[191]=function(e,t,n,r){if(!1===r.allowIndefinite)throw new Error("".concat(yy," indefinite length items not allowed"));return Ky(0,0,1,1/0)};for(let Ige=192;Ige<=215;Ige++)am[Ige]=zy;am[216]=function(e,t,n,r){return new ry(ny.tag,Ey(e,t+1,r),2)},am[217]=function(e,t,n,r){return new ry(ny.tag,Ay(e,t+1,r),3)},am[218]=function(e,t,n,r){return new ry(ny.tag,Sy(e,t+1,r),5)},am[219]=function(e,t,n,r){return new ry(ny.tag,_y(e,t+1,r),9)},am[220]=om,am[221]=om,am[222]=om,am[223]=om;for(let Ige=224;Ige<=243;Ige++)am[Ige]=sm("simple values are not supported");am[244]=om,am[245]=om,am[246]=om,am[247]=function(e,t,n,r){if(!1===r.allowUndefined)throw new Error("".concat(yy," undefined values are not supported"));return!0===r.coerceUndefinedToNull?new ry(ny.null,null,1):new ry(ny.undefined,void 0,1)},am[248]=sm("simple values are not supported"),am[249]=function(e,t,n,r){return Qy(tm(e,t+1),3,r)},am[250]=function(e,t,n,r){return Qy(rm(e,t+1),5,r)},am[251]=function(e,t,n,r){return Qy(im(e,t+1),9,r)},am[252]=om,am[253]=om,am[254]=om,am[255]=function(e,t,n,r){if(!1===r.allowIndefinite)throw new Error("".concat(yy," indefinite length items not allowed"));return new ry(ny.break,void 0,1)};const cm=[];for(let Ige=0;Ige<24;Ige++)cm[Ige]=new ry(ny.uint,Ige,1);for(let Ige=-1;Ige>=-24;Ige--)cm[31-Ige]=new ry(ny.negint,Ige,1);cm[64]=new ry(ny.bytes,new Uint8Array(0),1),cm[96]=new ry(ny.string,"",1),cm[128]=new ry(ny.array,0,1),cm[160]=new ry(ny.map,0,1),cm[244]=new ry(ny.false,!1,1),cm[245]=new ry(ny.true,!0,1),cm[246]=new ry(ny.null,null,1);(function(){const e=[];e[ny.uint.major]=Iy,e[ny.negint.major]=Ry,e[ny.bytes.major]=Oy,e[ny.string.major]=Ly,e[ny.array.major]=Fy,e[ny.map.major]=Zy,e[ny.tag.major]=Vy,e[ny.float.major]=Yy})(),new class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:256;this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),null!==this._initReuseChunk&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let t=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){const n=t.length-(this.maxCursor-this.cursor)-1;t.set(e,n)}else{if(t){const e=t.length-(this.maxCursor-this.cursor)-1;e<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,e),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(t=dy(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,null===this._initReuseChunk&&(this._initReuseChunk=t),t.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(){let e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(1===this.chunks.length){const n=this.chunks[0];t&&this.cursor>n.length/2?(e=this.cursor===n.length?n:n.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):e=uy(n,0,this.cursor)}else e=hy(this.chunks,this.cursor);return t&&this.reset(),e}};class lm{constructor(e,t){this.obj=e,this.parent=t}includes(e){let t=this;do{if(t.obj===e)return!0}while(t=t.parent);return!1}static createCheck(e,t){if(e&&e.includes(t))throw new Error("".concat(my," object contains circular references"));return new lm(t,e)}}const um={null:new ry(ny.null,null),undefined:new ry(ny.undefined,void 0),true:new ry(ny.true,!0),false:new ry(ny.false,!1),emptyArray:new ry(ny.array,0),emptyMap:new ry(ny.map,0)},hm={number:(e,t,n,r)=>Number.isInteger(e)&&Number.isSafeInteger(e)?new ry(e>=0?ny.uint:ny.negint,e):new ry(ny.float,e),bigint:(e,t,n,r)=>e>=BigInt(0)?new ry(ny.uint,e):new ry(ny.negint,e),Uint8Array:(e,t,n,r)=>new ry(ny.bytes,e),string:(e,t,n,r)=>new ry(ny.string,e),boolean:(e,t,n,r)=>e?um.true:um.false,null:(e,t,n,r)=>um.null,undefined:(e,t,n,r)=>um.undefined,ArrayBuffer:(e,t,n,r)=>new ry(ny.bytes,new Uint8Array(e)),DataView:(e,t,n,r)=>new ry(ny.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),Array(e,t,n,r){if(!e.length)return!0===n.addBreakTokens?[um.emptyArray,new ry(ny.break)]:um.emptyArray;r=lm.createCheck(r,e);const i=[];let o=0;for(const s of e)i[o++]=dm(s,n,r);return n.addBreakTokens?[new ry(ny.array,e.length),i,new ry(ny.break)]:[new ry(ny.array,e.length),i]},Object(e,t,n,r){const i="Object"!==t,o=i?e.keys():Object.keys(e),s=i?e.size:o.length;if(!s)return!0===n.addBreakTokens?[um.emptyMap,new ry(ny.break)]:um.emptyMap;r=lm.createCheck(r,e);const a=[];let c=0;for(const l of o)a[c++]=[dm(l,n,r),dm(i?e.get(l):e[l],n,r)];return function(e,t){t.mapSorter&&e.sort(t.mapSorter)}(a,n),n.addBreakTokens?[new ry(ny.map,s),a,new ry(ny.break)]:[new ry(ny.map,s),a]}};hm.Map=hm.Object,hm.Buffer=hm.Uint8Array;for(const Ige of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))hm["".concat(Ige,"Array")]=hm.DataView;function dm(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const r=ty(e),i=t&&t.typeEncoders&&t.typeEncoders[r]||hm[r];if("function"===typeof i){const o=i(e,r,t,n);if(null!=o)return o}const o=hm[r];if(!o)throw new Error("".concat(my," unsupported type: ").concat(r));return o(e,r,t,n)}const fm={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class pm{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._pos=0,this.data=e,this.options=t}pos(){return this._pos}done(){return this._pos>=this.data.length}next(){const e=this.data[this._pos];let t=cm[e];if(void 0===t){const n=am[e];if(!n)throw new Error("".concat(yy," no decoder for major type ").concat(e>>>5," (byte 0x").concat(e.toString(16).padStart(2,"0"),")"));const r=31&e;t=n(this.data,this._pos,r,this.options)}return this._pos+=t.encodedLength,t}}const gm=Symbol.for("DONE"),ym=Symbol.for("BREAK");function mm(e,t){if(e.done())return gm;const n=e.next();if(n.type===ny.break)return ym;if(n.type.terminal)return n.value;if(n.type===ny.array)return function(e,t,n){const r=[];for(let i=0;i<e.value;i++){const o=mm(t,n);if(o===ym){if(e.value===1/0)break;throw new Error("".concat(yy," got unexpected break to lengthed array"))}if(o===gm)throw new Error("".concat(yy," found array but not enough entries (got ").concat(i,", expected ").concat(e.value,")"));r[i]=o}return r}(n,e,t);if(n.type===ny.map)return function(e,t,n){const r=!0===n.useMaps,i=r?void 0:{},o=r?new Map:void 0;for(let s=0;s<e.value;s++){const a=mm(t,n);if(a===ym){if(e.value===1/0)break;throw new Error("".concat(yy," got unexpected break to lengthed map"))}if(a===gm)throw new Error("".concat(yy," found map but not enough entries (got ").concat(s," [no key], expected ").concat(e.value,")"));if(!0!==r&&"string"!==typeof a)throw new Error("".concat(yy," non-string keys not supported (got ").concat(typeof a,")"));if(!0===n.rejectDuplicateMapKeys&&(r&&o.has(a)||!r&&a in i))throw new Error("".concat(yy,' found repeat map key "').concat(a,'"'));const c=mm(t,n);if(c===gm)throw new Error("".concat(yy," found map but not enough entries (got ").concat(s," [no value], expected ").concat(e.value,")"));r?o.set(a,c):i[a]=c}return r?o:i}(n,e,t);if(n.type===ny.tag){if(t.tags&&"function"===typeof t.tags[n.value]){const r=mm(e,t);return t.tags[n.value](r)}throw new Error("".concat(yy," tag not supported (").concat(n.value,")"))}throw new Error("unsupported")}function vm(e,t){const[n,r]=function(e,t){if(!(e instanceof Uint8Array))throw new Error("".concat(yy," data to decode must be a Uint8Array"));const n=(t=Object.assign({},fm,t)).tokenizer||new pm(e,t),r=mm(n,t);if(r===gm)throw new Error("".concat(yy," did not find any content to decode"));if(r===ym)throw new Error("".concat(yy," got unexpected break"));return[r,e.subarray(n.pos())]}(e,t);if(r.length>0)throw new Error("".concat(yy," too many terminals, data makes no sense"));return n}const bm="ERR_UNRECOGNIZED_VALIDITY",wm="ERR_SIGNATURE_VERIFICATION",Em="ERR_UNRECOGNIZED_FORMAT",Am="ERR_UNDEFINED_PARAMETER",Sm=Of("ipns:utils"),_m=(0,yu.m)("/ipns/");const Im=async(e,t)=>{if(null==t||null==e){const e=new Error("one or more of the provided parameters are not defined");throw Sm.error(e),Xo()(e,Am)}let n;if(null!=t.pubKey){try{n=Gg(t.pubKey)}catch(r){throw Sm.error(r),r}if(!(await async function(e,t){return e.length===Wp?new Xp({multihash:Sp(Tp.code,e),privateKey:t}):e.length===Qp?new $p({multihash:Sp(Tp.code,e),privateKey:t}):new Jp({multihash:await Pp.digest(e),publicKey:e,privateKey:t})}(t.pubKey)).equals(e))throw Xo()(new Error("Embedded public key did not match PeerID"),"ERR_INVALID_EMBEDDED_KEY")}else null!=e.publicKey&&(n=Gg(e.publicKey));if(null!=n)return n;throw Xo()(new Error("no public key is available"),Am)},Cm=e=>"signatureV1"in e?Yg.encode({value:(0,yu.m)(e.value),signatureV1:e.signatureV1,validityType:e.validityType,validity:(0,yu.m)(e.validity.toString()),sequence:e.sequence,ttl:e.ttl,pubKey:e.pubKey,signatureV2:e.signatureV2,data:e.data}):Yg.encode({pubKey:e.pubKey,signatureV2:e.signatureV2,data:e.data});function Tm(e){const t=Yg.decode(e);if(null!=t.sequence&&(t.sequence=BigInt(t.sequence)),null!=t.ttl&&(t.ttl=BigInt(t.ttl)),null==t.signatureV2||null==t.data)throw Xo()(new Error("missing data or signatureV2"),wm);const n=km(t.data),r=Rm(n.Value);let i;try{i=Xg().fromDate(function(e){const t=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),n=String(e).trim().match(t);if(null==n)throw new Error("Invalid format");const r=parseInt(n[1],10),i=parseInt(n[2],10)-1,o=parseInt(n[3],10),s=parseInt(n[4],10),a=parseInt(n[5],10),c=parseInt(n[6],10),l=parseInt(n[7].padEnd(6,"0").slice(0,3),10);return new Date(Date.UTC(r,i,o,s,a,c,l))}((0,Au.B)(n.Validity)))}catch(o){throw Sm.error("unrecognized validity format (not an rfc3339 format)"),Xo()(new Error("unrecognized validity format (not an rfc3339 format)"),Em)}if(null!=t.value&&null!=t.signatureV1)return xm(t),{value:r,validityType:Yg.ValidityType.EOL,validity:i,sequence:n.Sequence,ttl:n.TTL,pubKey:t.pubKey,signatureV1:t.signatureV1,signatureV2:t.signatureV2,data:t.data};if(null!=t.signatureV2)return{value:r,validityType:Yg.ValidityType.EOL,validity:i,sequence:n.Sequence,ttl:n.TTL,pubKey:t.pubKey,signatureV2:t.signatureV2,data:t.data};throw new Error("invalid record: does not include signatureV1 or signatureV2")}const km=e=>{const t=vm(e);if(0!==t.ValidityType)throw Xo()(new Error("Unknown validity type"),bm);return t.ValidityType=Yg.ValidityType.EOL,Number.isInteger(t.Sequence)&&(t.Sequence=BigInt(t.Sequence)),Number.isInteger(t.TTL)&&(t.TTL=BigInt(t.TTL)),t},Rm=e=>{if(null!=e){if(null!=(t=e)&&Boolean(t[Nf]))return"/ipns/".concat(e.toCID().toString(zf));if(e instanceof Uint8Array){const t=(0,Au.B)(e);t.startsWith("/")&&(e=t)}const n=e.toString().trim();if(n.startsWith("/")&&n.length>1)return n;const r=Lp.asCID(e);if(null!=r)return 114===r.code?"/ipns/".concat(r.toString(zf)):"/ipfs/".concat(r.toV1().toString());try{return e instanceof Uint8Array?"/ipfs/".concat(Lp.decode(e).toV1().toString()):"/ipfs/".concat(Lp.parse(n).toV1().toString())}catch{}}var t;throw Xo()(new Error("Value must be a valid content path starting with /"),"ERR_INVALID_VALUE")},xm=e=>{var t,n;if(null==e.data)throw Xo()(new Error("Record data is missing"),"ERR_INVALID_RECORD_DATA");const r=km(e.data);if(!(0,Ms.f)(r.Value,null!==(t=e.value)&&void 0!==t?t:new Uint8Array(0)))throw Xo()(new Error('Field "value" did not match between protobuf and CBOR'),wm);if(!(0,Ms.f)(r.Validity,null!==(n=e.validity)&&void 0!==n?n:new Uint8Array(0)))throw Xo()(new Error('Field "validity" did not match between protobuf and CBOR'),wm);if(r.ValidityType!==e.validityType)throw Xo()(new Error('Field "validityType" did not match between protobuf and CBOR'),wm);if(r.Sequence!==e.sequence)throw Xo()(new Error('Field "sequence" did not match between protobuf and CBOR'),wm);if(r.TTL!==e.ttl)throw Xo()(new Error('Field "ttl" did not match between protobuf and CBOR'),wm)};Of("ipns"),Tp.code;const Pm=Of("ipns:validator"),Dm=async(e,t)=>{const n=Tm(t);let r;try{const t=(e=>{const t=(0,yu.m)("ipns-signature:");return(0,Ls.z)([t,e])})(n.data);r=await e.verify(t,n.signatureV2)}catch(i){r=!1}if(!r)throw Pm.error("record signature verification failed"),Xo()(new Error("record signature verification failed"),wm);if(n.validityType===Yg.ValidityType.EOL){if(n.validity.toDate().getTime()<Date.now())throw Pm.error("record has expired"),Xo()(new Error("record has expired"),"ERR_IPNS_EXPIRED_RECORD")}else if(null!=n.validityType)throw Pm.error("unrecognized validity type"),Xo()(new Error("unrecognized validity type"),bm);Pm("ipns record for %b is valid",n.value)};async function Om(e,t){if(t.byteLength>10240)throw Xo()(new Error("record too large"),"ERR_RECORD_TOO_LARGE");const n=(e=>tg(e.slice(_m.length)))(e),r=Tm(t),i=await Im(n,r);await Dm(i,t)}async function*Nm(e){const t=/\r?\n/,n=new TextDecoder("utf8");let r="";for await(let o of e){var i;"string"===typeof o&&(o=(new TextEncoder).encode(o)),r+=n.decode(o,{stream:!0});const e=r.split(t);r=null!==(i=e.pop())&&void 0!==i?i:"";for(let t=0;t<e.length;t++)yield JSON.parse(e[t])}r+=n.decode(),""!==r&&(yield JSON.parse(r))}var Bm=n(68702);const Lm=function(e){if(null!=e[Symbol.asyncIterator])return(async()=>{for await(const t of e)return t})();for(const t of e)return t};const Mm=function(e){const[t,n]=null!=e[Symbol.asyncIterator]?[e[Symbol.asyncIterator](),Symbol.asyncIterator]:[e[Symbol.iterator](),Symbol.iterator],r=[];return{peek:()=>t.next(),push:e=>{r.push(e)},next:()=>r.length>0?{done:!1,value:r.shift()}:t.next(),[n](){return this}}};const Um=function(e,t){if(null!=e[Symbol.asyncIterator])return async function*(){for await(const n of e)yield t(n)}();const n=Mm(e),{value:r,done:i}=n.next();if(!0===i)return function*(){}();const o=t(r);if("function"===typeof o.then)return async function*(){yield await o;for await(const e of n)yield t(e)}();const s=t;return function*(){yield o;for(const e of n)yield s(e)}()},Fm=(0,yu.m)("/ipns/");function Km(e){return(0,Ms.f)(e.subarray(0,Fm.byteLength),Fm)}const jm=e=>tg(e.slice(Fm.length));class Zm{constructor(e){(0,Yo.Z)(this,"client",void 0),this.client=e}findProviders(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){yield*Um(t.client.getProviders(e,n),(e=>{var t;return{id:e.ID,multiaddrs:null!==(t=e.Addrs)&&void 0!==t?t:[],protocols:[]}}))}()}catch(n){return Promise.reject(n)}}async provide(){}async put(e,t,n){if(!Km(e))return;const r=jm(e),i=Tm(t);await this.client.putIPNS(r,i,n)}async get(e,t){if(!Km(e))throw new $d("Not found","ERR_NOT_FOUND");const n=jm(e);try{const e=await this.client.getIPNS(n,t);return Cm(e)}catch(r){if("ERR_BAD_RESPONSE"===r.code)throw new $d("Not found","ERR_NOT_FOUND");throw r}}}class zm{constructor(e){(0,Yo.Z)(this,"client",void 0),this.client=e}async findPeer(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=await Lm(this.client.getPeers(e,t));if(null!=n)return{id:n.ID,multiaddrs:n.Addrs,protocols:[]};throw new $d("Not found","ERR_NOT_FOUND")}getClosestPeers(e){try{return async function*(){}()}catch(t){return Promise.reject(t)}}}const Vm=Of("delegated-routing-v1-http-api-client"),Hm=4,qm=3e4;var Gm=new WeakSet,Wm=new WeakSet;class Qm{constructor(e){var t,n;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Qd(this,Wm),Qd(this,Gm),(0,Yo.Z)(this,"started",void 0),(0,Yo.Z)(this,"httpQueue",void 0),(0,Yo.Z)(this,"shutDownController",void 0),(0,Yo.Z)(this,"clientUrl",void 0),(0,Yo.Z)(this,"timeout",void 0),(0,Yo.Z)(this,"contentRouting",void 0),(0,Yo.Z)(this,"peerRouting",void 0),this.started=!1,this.shutDownController=new AbortController,this.httpQueue=new Bm.Z({concurrency:null!==(t=r.concurrentRequests)&&void 0!==t?t:Hm}),this.clientUrl=e instanceof URL?e:new URL(e),this.timeout=null!==(n=r.timeout)&&void 0!==n?n:qm,this.contentRouting=new Zm(this),this.peerRouting=new zm(this)}get[Jd](){return this.contentRouting}get[rf](){return this.peerRouting}isStarted(){return this.started}start(){this.started=!0}stop(){this.httpQueue.clear(),this.shutDownController.abort(),this.started=!1}getProviders(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){Vm("getProviders starts: %c",e);const r=rg([t.shutDownController.signal,n.signal,AbortSignal.timeout(t.timeout)]),i=Ws(),o=Ws();t.httpQueue.add((async()=>(i.resolve(),o.promise)));try{await i.promise;const n="".concat(t.clientUrl,"routing/v1/providers/").concat(e.toString()),o={headers:{Accept:"application/x-ndjson"},signal:r},s=await fetch(n,o);if(null==s.body)throw new $d("Routing response had no body","ERR_BAD_RESPONSE");if("application/json"===s.headers.get("Content-Type")){const e=await s.json();for(const n of e.Providers){const e=Yd(t,Gm,Ym).call(t,n);null!=e&&(yield e)}}else for await(const e of Nm((0,ig.Z)(s.body))){const n=Yd(t,Gm,Ym).call(t,e);null!=n&&(yield n)}}catch(s){Vm.error("getProviders errored:",s)}finally{r.clear(),o.resolve(),Vm("getProviders finished: %c",e)}}()}catch(n){return Promise.reject(n)}}getPeers(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){Vm("getPeers starts: %c",e);const r=rg([t.shutDownController.signal,n.signal,AbortSignal.timeout(t.timeout)]),i=Ws(),o=Ws();t.httpQueue.add((async()=>(i.resolve(),o.promise)));try{await i.promise;const n="".concat(t.clientUrl,"routing/v1/peers/").concat(e.toCID().toString()),o={headers:{Accept:"application/x-ndjson"},signal:r},s=await fetch(n,o);if(null==s.body)throw new $d("Routing response had no body","ERR_BAD_RESPONSE");if("application/json"===s.headers.get("Content-Type")){const n=await s.json();for(const r of n.Peers){const n=Yd(t,Wm,Jm).call(t,e,r);null!=n&&(yield n)}}else for await(const r of Nm((0,ig.Z)(s.body))){const n=Yd(t,Wm,Jm).call(t,e,r);null!=n&&(yield n)}}catch(s){Vm.error("getPeers errored:",s)}finally{r.clear(),o.resolve(),Vm("getPeers finished: %c",e)}}()}catch(n){return Promise.reject(n)}}async getIPNS(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Vm("getIPNS starts: %c",e);const n=rg([this.shutDownController.signal,t.signal,AbortSignal.timeout(this.timeout)]),r=Ws(),i=Ws();this.httpQueue.add((async()=>(r.resolve(),i.promise)));try{await r.promise;const t="".concat(this.clientUrl,"routing/v1/ipns/").concat(e.toCID().toString()),i={headers:{Accept:"application/vnd.ipfs.ipns-record"},signal:n},o=await fetch(t,i);if(null==o.body)throw new $d("GET ipns response had no body","ERR_BAD_RESPONSE");const s=new Uint8Array(await o.arrayBuffer());return await Om((e=>(0,Ls.z)([_m,e.toBytes()]))(e),s),Tm(s)}finally{n.clear(),i.resolve(),Vm("getIPNS finished: %c",e)}}async putIPNS(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Vm("getIPNS starts: %c",e);const r=rg([this.shutDownController.signal,n.signal,AbortSignal.timeout(this.timeout)]),i=Ws(),o=Ws();this.httpQueue.add((async()=>(i.resolve(),o.promise)));try{await i.promise;const n=Cm(t),o="".concat(this.clientUrl,"routing/v1/ipns/").concat(e.toCID().toString()),s={method:"PUT",headers:{"Content-Type":"application/vnd.ipfs.ipns-record"},body:n,signal:r};if(200!==(await fetch(o,s)).status)throw new $d("PUT ipns response had status other than 200","ERR_BAD_RESPONSE")}finally{r.clear(),o.resolve(),Vm("getIPNS finished: %c",e)}}}function Ym(e){var t;return"peer"===e.Schema?(e.ID=eg(e.ID),e.Addrs=e.Addrs.map(ng.HM),e.Protocols=null!==(t=e.Protocols)&&void 0!==t?t:[],e):"bitswap"===e.Schema?{Schema:"peer",ID:eg(e.ID),Addrs:e.Addrs.map(ng.HM),Protocols:null!=e.Protocol?[e.Protocol]:[]}:null!=e.ID&&Array.isArray(e.Addrs)?{Schema:"peer",ID:eg(e.ID),Addrs:e.Addrs.map(ng.HM),Protocols:Array.isArray(e.Protocols)?e.Protocols:[]}:void 0}function Jm(e,t){if("peer"===t.Schema&&(t.ID=eg(t.ID),t.Addrs=t.Addrs.map(ng.HM),e.equals(t.ID)))return t}function Xm(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Qm(new URL(e),t)}var $m=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==n[s])throw new TypeError(o+" is ambiguous");n[s]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var r=0,i=0;e[t]===c;)r++,t++;for(var o=(e.length-t)*l+1>>>0,s=new Uint8Array(o);e[t];){var u=n[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=o-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*s[d]>>>0,s[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=o-i;f!==o&&0===s[f];)f++;for(var p=new Uint8Array(r+(o-f)),g=r;f!==o;)p[g++]=s[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,o=t.length;i!==o&&0===t[i];)i++,n++;for(var s=(o-i)*u+1>>>0,l=new Uint8Array(s);i!==o;){for(var h=t[i],d=0,f=s-1;(0!==h||d<r)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");r=d,i++}for(var p=s-r;p!==s&&0===l[p];)p++;for(var g=c.repeat(n);p<s;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:h,decode:function(e){var n=h(e);if(n)return n;throw new Error("Non-".concat(t," character"))}}};const ev=$m,tv=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class nv{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(e));throw Error("Unknown type, must be binary type")}}class rv{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(e),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return ov(this,e)}}class iv{constructor(e){this.decoders=e}or(e){return ov(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(e),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}}const ov=(e,t)=>new iv({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class sv{constructor(e,t,n,r){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=r,this.encoder=new nv(e,t,n),this.decoder=new rv(e,t,r)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const av=e=>{let{name:t,prefix:n,encode:r,decode:i}=e;return new sv(t,n,r,i)},cv=e=>{let{prefix:t,name:n,alphabet:r}=e;const{encode:i,decode:o}=ev(r,n);return av({prefix:t,name:n,encode:i,decode:e=>tv(o(e))})},lv=e=>{let{name:t,prefix:n,bitsPerChar:r,alphabet:i}=e;return av({prefix:n,name:t,encode:e=>((e,t,n)=>{const r="="===t[t.length-1],i=(1<<n)-1;let o="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>n;)s-=n,o+=t[i&a>>s];if(s&&(o+=t[i&a<<n-s]),r)for(;o.length*n&7;)o+="=";return o})(e,i,r),decode:e=>((e,t,n,r)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*n/8|0);let a=0,c=0,l=0;for(let u=0;u<o;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError("Non-".concat(r," character"));c=c<<n|t,a+=n,a>=8&&(a-=8,s[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s})(e,i,r,t)})},uv=cv({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),hv=cv({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),dv=cv({prefix:"9",name:"base10",alphabet:"0123456789"}),fv=lv({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),pv=lv({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),gv=lv({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),yv=Array.from("\ud83d\ude80\ud83e\ude90\u2604\ud83d\udef0\ud83c\udf0c\ud83c\udf11\ud83c\udf12\ud83c\udf13\ud83c\udf14\ud83c\udf15\ud83c\udf16\ud83c\udf17\ud83c\udf18\ud83c\udf0d\ud83c\udf0f\ud83c\udf0e\ud83d\udc09\u2600\ud83d\udcbb\ud83d\udda5\ud83d\udcbe\ud83d\udcbf\ud83d\ude02\u2764\ud83d\ude0d\ud83e\udd23\ud83d\ude0a\ud83d\ude4f\ud83d\udc95\ud83d\ude2d\ud83d\ude18\ud83d\udc4d\ud83d\ude05\ud83d\udc4f\ud83d\ude01\ud83d\udd25\ud83e\udd70\ud83d\udc94\ud83d\udc96\ud83d\udc99\ud83d\ude22\ud83e\udd14\ud83d\ude06\ud83d\ude44\ud83d\udcaa\ud83d\ude09\u263a\ud83d\udc4c\ud83e\udd17\ud83d\udc9c\ud83d\ude14\ud83d\ude0e\ud83d\ude07\ud83c\udf39\ud83e\udd26\ud83c\udf89\ud83d\udc9e\u270c\u2728\ud83e\udd37\ud83d\ude31\ud83d\ude0c\ud83c\udf38\ud83d\ude4c\ud83d\ude0b\ud83d\udc97\ud83d\udc9a\ud83d\ude0f\ud83d\udc9b\ud83d\ude42\ud83d\udc93\ud83e\udd29\ud83d\ude04\ud83d\ude00\ud83d\udda4\ud83d\ude03\ud83d\udcaf\ud83d\ude48\ud83d\udc47\ud83c\udfb6\ud83d\ude12\ud83e\udd2d\u2763\ud83d\ude1c\ud83d\udc8b\ud83d\udc40\ud83d\ude2a\ud83d\ude11\ud83d\udca5\ud83d\ude4b\ud83d\ude1e\ud83d\ude29\ud83d\ude21\ud83e\udd2a\ud83d\udc4a\ud83e\udd73\ud83d\ude25\ud83e\udd24\ud83d\udc49\ud83d\udc83\ud83d\ude33\u270b\ud83d\ude1a\ud83d\ude1d\ud83d\ude34\ud83c\udf1f\ud83d\ude2c\ud83d\ude43\ud83c\udf40\ud83c\udf37\ud83d\ude3b\ud83d\ude13\u2b50\u2705\ud83e\udd7a\ud83c\udf08\ud83d\ude08\ud83e\udd18\ud83d\udca6\u2714\ud83d\ude23\ud83c\udfc3\ud83d\udc90\u2639\ud83c\udf8a\ud83d\udc98\ud83d\ude20\u261d\ud83d\ude15\ud83c\udf3a\ud83c\udf82\ud83c\udf3b\ud83d\ude10\ud83d\udd95\ud83d\udc9d\ud83d\ude4a\ud83d\ude39\ud83d\udde3\ud83d\udcab\ud83d\udc80\ud83d\udc51\ud83c\udfb5\ud83e\udd1e\ud83d\ude1b\ud83d\udd34\ud83d\ude24\ud83c\udf3c\ud83d\ude2b\u26bd\ud83e\udd19\u2615\ud83c\udfc6\ud83e\udd2b\ud83d\udc48\ud83d\ude2e\ud83d\ude46\ud83c\udf7b\ud83c\udf43\ud83d\udc36\ud83d\udc81\ud83d\ude32\ud83c\udf3f\ud83e\udde1\ud83c\udf81\u26a1\ud83c\udf1e\ud83c\udf88\u274c\u270a\ud83d\udc4b\ud83d\ude30\ud83e\udd28\ud83d\ude36\ud83e\udd1d\ud83d\udeb6\ud83d\udcb0\ud83c\udf53\ud83d\udca2\ud83e\udd1f\ud83d\ude41\ud83d\udea8\ud83d\udca8\ud83e\udd2c\u2708\ud83c\udf80\ud83c\udf7a\ud83e\udd13\ud83d\ude19\ud83d\udc9f\ud83c\udf31\ud83d\ude16\ud83d\udc76\ud83e\udd74\u25b6\u27a1\u2753\ud83d\udc8e\ud83d\udcb8\u2b07\ud83d\ude28\ud83c\udf1a\ud83e\udd8b\ud83d\ude37\ud83d\udd7a\u26a0\ud83d\ude45\ud83d\ude1f\ud83d\ude35\ud83d\udc4e\ud83e\udd32\ud83e\udd20\ud83e\udd27\ud83d\udccc\ud83d\udd35\ud83d\udc85\ud83e\uddd0\ud83d\udc3e\ud83c\udf52\ud83d\ude17\ud83e\udd11\ud83c\udf0a\ud83e\udd2f\ud83d\udc37\u260e\ud83d\udca7\ud83d\ude2f\ud83d\udc86\ud83d\udc46\ud83c\udfa4\ud83d\ude47\ud83c\udf51\u2744\ud83c\udf34\ud83d\udca3\ud83d\udc38\ud83d\udc8c\ud83d\udccd\ud83e\udd40\ud83e\udd22\ud83d\udc45\ud83d\udca1\ud83d\udca9\ud83d\udc50\ud83d\udcf8\ud83d\udc7b\ud83e\udd10\ud83e\udd2e\ud83c\udfbc\ud83e\udd75\ud83d\udea9\ud83c\udf4e\ud83c\udf4a\ud83d\udc7c\ud83d\udc8d\ud83d\udce3\ud83e\udd42"),mv=yv.reduce(((e,t,n)=>(e[n]=t,e)),[]),vv=yv.reduce(((e,t,n)=>(e[t.codePointAt(0)]=n,e)),[]);const bv=av({prefix:"\ud83d\ude80",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=mv[t]),"")},decode:function(e){const t=[];for(const n of e){const e=vv[n.codePointAt(0)];if(void 0===e)throw new Error("Non-base256emoji character: ".concat(n));t.push(e)}return new Uint8Array(t)}}),wv=lv({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Ev=lv({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Av=lv({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Sv=lv({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),_v=lv({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Iv=lv({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Cv=lv({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Tv=lv({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),kv=lv({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Rv=cv({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),xv=cv({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Pv=lv({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Dv=lv({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Ov=lv({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Nv=lv({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Bv=lv({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),Lv=av({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),Mv=new TextEncoder,Uv=new TextDecoder,Fv="json",Kv=512,jv=e=>Mv.encode(JSON.stringify(e)),Zv=e=>JSON.parse(Uv.decode(e)),zv="raw",Vv=85,Hv=e=>tv(e),qv=e=>tv(e);var Gv=function e(t,n,r){n=n||[];var i=r=r||0;for(;t>=Yv;)n[r++]=255&t|Wv,t/=128;for(;t&Qv;)n[r++]=255&t|Wv,t>>>=7;return n[r]=0|t,e.bytes=r-i+1,n},Wv=128,Qv=-128,Yv=Math.pow(2,31);var Jv=function e(t,n){var r,i=0,o=0,s=n=n||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");r=t[s++],i+=o<28?(r&$v)<<o:(r&$v)*Math.pow(2,o),o+=7}while(r>=Xv);return e.bytes=s-n,i},Xv=128,$v=127;var eb=Math.pow(2,7),tb=Math.pow(2,14),nb=Math.pow(2,21),rb=Math.pow(2,28),ib=Math.pow(2,35),ob=Math.pow(2,42),sb=Math.pow(2,49),ab=Math.pow(2,56),cb=Math.pow(2,63);const lb={encode:Gv,decode:Jv,encodingLength:function(e){return e<eb?1:e<tb?2:e<nb?3:e<rb?4:e<ib?5:e<ob?6:e<sb?7:e<ab?8:e<cb?9:10}},ub=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return[lb.decode(e,t),lb.decode.bytes]},hb=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return lb.encode(e,t,n),t},db=e=>lb.encodingLength(e),fb=(e,t)=>{const n=t.byteLength,r=db(e),i=r+db(n),o=new Uint8Array(i+n);return hb(e,o,0),hb(n,o,r),o.set(t,i),new gb(e,n,t,o)},pb=e=>{const t=tv(e),[n,r]=ub(t),[i,o]=ub(t.subarray(r)),s=t.subarray(r+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new gb(n,i,s,t)};class gb{constructor(e,t,n,r){this.code=e,this.size=t,this.digest=n,this.bytes=r}}const yb=tv,mb={code:0,name:"identity",encode:yb,digest:e=>fb(0,yb(e))},vb=e=>{let{name:t,code:n,encode:r}=e;return new bb(t,n,r)};class bb{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?fb(this.code,t):t.then((e=>fb(this.code,e)))}throw Error("Unknown type, must be binary type")}}const wb=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Eb=vb({name:"sha2-256",code:18,encode:wb("SHA-256")}),Ab=vb({name:"sha2-512",code:19,encode:wb("SHA-512")}),Sb=(e,t)=>{const{bytes:n,version:r}=e;return 0===r?kb(n,Ib(e),t||uv.encoder):Rb(n,Ib(e),t||wv.encoder)},_b=new WeakMap,Ib=e=>{const t=_b.get(e);if(null==t){const t=new Map;return _b.set(e,t),t}return t};class Cb{constructor(e,t,n,r){this.code=t,this.version=e,this.multihash=n,this.bytes=r,this["/"]=r}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==xb)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==Pb)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Cb.createV0(t)}default:throw Error("Can not convert CID version ".concat(this.version," to version 0. This is a bug please report"))}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=fb(e,t);return Cb.createV1(this.code,n)}case 1:return this;default:throw Error("Can not convert CID version ".concat(this.version," to version 1. This is a bug please report"))}}equals(e){return Cb.equals(this,e)}static equals(e,t){const n=t;return n&&e.code===n.code&&e.version===n.version&&((e,t)=>{if(e===t)return!0;{const n=t;return e.code===n.code&&e.size===n.size&&n.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0})(e.bytes,n.bytes)}})(e.multihash,n.multihash)}toString(e){return Sb(this,e)}toJSON(){return{"/":Sb(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID(".concat(this.toString(),")")}static asCID(e){if(null==e)return null;const t=e;if(t instanceof Cb)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:n,multihash:r,bytes:i}=t;return new Cb(e,n,r,i||Db(e,n,r.bytes))}if(!0===t[Ob]){const{version:e,multihash:n,code:r}=t,i=pb(n);return Cb.create(e,r,i)}return null}static create(e,t,n){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==xb)throw new Error("Version 0 CID must use dag-pb (code: ".concat(xb,") block encoding"));return new Cb(e,t,n,n.bytes);case 1:{const r=Db(e,t,n.bytes);return new Cb(e,t,n,r)}default:throw new Error("Invalid version")}}static createV0(e){return Cb.create(0,xb,e)}static createV1(e,t){return Cb.create(1,e,t)}static decode(e){const[t,n]=Cb.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=Cb.inspectBytes(e),n=t.size-t.multihashSize,r=tv(e.subarray(n,n+t.multihashSize));if(r.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=r.subarray(t.multihashSize-t.digestSize),o=new gb(t.multihashCode,t.digestSize,i,r);return[0===t.version?Cb.createV0(o):Cb.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[n,r]=ub(e.subarray(t));return t+=r,n};let r=n(),i=xb;if(18===r?(r=0,t=0):i=n(),0!==r&&1!==r)throw new RangeError("Invalid CID version ".concat(r));const o=t,s=n(),a=n(),c=t+a;return{version:r,codec:i,multihashCode:s,digestSize:a,multihashSize:c-o,size:c}}static parse(e,t){const[n,r]=Tb(e,t),i=Cb.decode(r);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return Ib(i).set(n,e),i}}const Tb=(e,t)=>{switch(e[0]){case"Q":{const n=t||uv;return[uv.prefix,n.decode("".concat(uv.prefix).concat(e))]}case uv.prefix:{const n=t||uv;return[uv.prefix,n.decode(e)]}case wv.prefix:{const n=t||wv;return[wv.prefix,n.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},kb=(e,t,n)=>{const{prefix:r}=n;if(r!==uv.prefix)throw Error("Cannot string encode V0 in ".concat(n.name," encoding"));const i=t.get(r);if(null==i){const i=n.encode(e).slice(1);return t.set(r,i),i}return i},Rb=(e,t,n)=>{const{prefix:r}=n,i=t.get(r);if(null==i){const i=n.encode(e);return t.set(r,i),i}return i},xb=112,Pb=18,Db=(e,t,n)=>{const r=db(e),i=r+db(t),o=new Uint8Array(i+n.byteLength);return hb(e,o,0),hb(t,o,r),o.set(n,i),o},Ob=Symbol.for("@ipld/js-cid/CID"),Nb={...O,...T,...D,...I,...C,...R,...x,..._,...P,...k},Bb=Symbol.for("nodejs.util.inspect.custom"),Lb=Object.values(Nb).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)),Nb.identity.decoder),Mb=114,Ub=36,Fb=37;class Kb{constructor(e){(0,Yo.Z)(this,"type",void 0),(0,Yo.Z)(this,"multihash",void 0),(0,Yo.Z)(this,"privateKey",void 0),(0,Yo.Z)(this,"publicKey",void 0),(0,Yo.Z)(this,"string",void 0),(0,Yo.Z)(this,fu.Cs,!0),this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return"PeerId(".concat(this.toString(),")")}toString(){return null==this.string&&(this.string=uv.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return Cb.createV1(Mb,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){var t;if(e instanceof Uint8Array)return(0,Ms.f)(this.multihash.bytes,e);if("string"===typeof e)return function(e,t){var n;if(t=null!==(n=t)&&void 0!==n?n:Lb,"1"===e.charAt(0)||"Q"===e.charAt(0)){const t=pb(uv.decode("z".concat(e)));return e.startsWith("12D")?new Zb({multihash:t}):e.startsWith("16U")?new zb({multihash:t}):new jb({multihash:t})}return Vb(Lb.decode(e))}(e).equals(this);if(null!=(null===e||void 0===e||null===(t=e.multihash)||void 0===t?void 0:t.bytes))return(0,Ms.f)(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[Bb](){return"PeerId(".concat(this.toString(),")")}}class jb extends Kb{constructor(e){super({...e,type:"RSA"}),(0,Yo.Z)(this,"type","RSA"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.publicKey}}class Zb extends Kb{constructor(e){super({...e,type:"Ed25519"}),(0,Yo.Z)(this,"type","Ed25519"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.multihash.digest}}class zb extends Kb{constructor(e){super({...e,type:"secp256k1"}),(0,Yo.Z)(this,"type","secp256k1"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.multihash.digest}}function Vb(e){try{const t=pb(e);if(t.code===mb.code){if(t.digest.length===Ub)return new Zb({multihash:t});if(t.digest.length===Fb)return new zb({multihash:t})}if(t.code===Eb.code)return new jb({multihash:t})}catch{return function(e){if(null==e||null==e.multihash||null==e.version||1===e.version&&e.code!==Mb)throw new Error("Supplied PeerID CID is invalid");const t=e.multihash;if(t.code===Eb.code)return new jb({multihash:e.multihash});if(t.code===mb.code){if(t.digest.length===Ub)return new Zb({multihash:e.multihash});if(t.digest.length===Fb)return new zb({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}(Cb.decode(e))}throw new Error("Supplied PeerID CID is invalid")}var Hb=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==n[s])throw new TypeError(o+" is ambiguous");n[s]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var r=0,i=0;e[t]===c;)r++,t++;for(var o=(e.length-t)*l+1>>>0,s=new Uint8Array(o);e[t];){var u=n[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=o-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*s[d]>>>0,s[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=o-i;f!==o&&0===s[f];)f++;for(var p=new Uint8Array(r+(o-f)),g=r;f!==o;)p[g++]=s[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,o=t.length;i!==o&&0===t[i];)i++,n++;for(var s=(o-i)*u+1>>>0,l=new Uint8Array(s);i!==o;){for(var h=t[i],d=0,f=s-1;(0!==h||d<r)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");r=d,i++}for(var p=s-r;p!==s&&0===l[p];)p++;for(var g=c.repeat(n);p<s;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:h,decode:function(e){var n=h(e);if(n)return n;throw new Error("Non-".concat(t," character"))}}};const qb=Hb,Gb=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class Wb{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(e));throw Error("Unknown type, must be binary type")}}class Qb{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(e),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return Jb(this,e)}}class Yb{constructor(e){this.decoders=e}or(e){return Jb(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(e),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}}const Jb=(e,t)=>new Yb({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class Xb{constructor(e,t,n,r){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=r,this.encoder=new Wb(e,t,n),this.decoder=new Qb(e,t,r)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const $b=e=>{let{name:t,prefix:n,encode:r,decode:i}=e;return new Xb(t,n,r,i)},ew=e=>{let{prefix:t,name:n,alphabet:r}=e;const{encode:i,decode:o}=qb(r,n);return $b({prefix:t,name:n,encode:i,decode:e=>Gb(o(e))})},tw=e=>{let{name:t,prefix:n,bitsPerChar:r,alphabet:i}=e;return $b({prefix:n,name:t,encode:e=>((e,t,n)=>{const r="="===t[t.length-1],i=(1<<n)-1;let o="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>n;)s-=n,o+=t[i&a>>s];if(s&&(o+=t[i&a<<n-s]),r)for(;o.length*n&7;)o+="=";return o})(e,i,r),decode:e=>((e,t,n,r)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*n/8|0);let a=0,c=0,l=0;for(let u=0;u<o;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError("Non-".concat(r," character"));c=c<<n|t,a+=n,a>=8&&(a-=8,s[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s})(e,i,r,t)})},nw=ew({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),rw=ew({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var iw=function e(t,n,r){n=n||[];var i=r=r||0;for(;t>=aw;)n[r++]=255&t|ow,t/=128;for(;t&sw;)n[r++]=255&t|ow,t>>>=7;return n[r]=0|t,e.bytes=r-i+1,n},ow=128,sw=-128,aw=Math.pow(2,31);var cw=function e(t,n){var r,i=0,o=0,s=n=n||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");r=t[s++],i+=o<28?(r&uw)<<o:(r&uw)*Math.pow(2,o),o+=7}while(r>=lw);return e.bytes=s-n,i},lw=128,uw=127;var hw=Math.pow(2,7),dw=Math.pow(2,14),fw=Math.pow(2,21),pw=Math.pow(2,28),gw=Math.pow(2,35),yw=Math.pow(2,42),mw=Math.pow(2,49),vw=Math.pow(2,56),bw=Math.pow(2,63);const ww={encode:iw,decode:cw,encodingLength:function(e){return e<hw?1:e<dw?2:e<fw?3:e<pw?4:e<gw?5:e<yw?6:e<mw?7:e<vw?8:e<bw?9:10}},Ew=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return[ww.decode(e,t),ww.decode.bytes]},Aw=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ww.encode(e,t,n),t},Sw=e=>ww.encodingLength(e),_w=(e,t)=>{const n=t.byteLength,r=Sw(e),i=r+Sw(n),o=new Uint8Array(i+n);return Aw(e,o,0),Aw(n,o,r),o.set(t,i),new Cw(e,n,t,o)},Iw=e=>{const t=Gb(e),[n,r]=Ew(t),[i,o]=Ew(t.subarray(r)),s=t.subarray(r+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new Cw(n,i,s,t)};class Cw{constructor(e,t,n,r){this.code=e,this.size=t,this.digest=n,this.bytes=r}}const Tw=Gb,kw={code:0,name:"identity",encode:Tw,digest:e=>_w(0,Tw(e))},Rw=e=>{let{name:t,code:n,encode:r}=e;return new xw(t,n,r)};class xw{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?_w(this.code,t):t.then((e=>_w(this.code,e)))}throw Error("Unknown type, must be binary type")}}const Pw=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Dw=Rw({name:"sha2-256",code:18,encode:Pw("SHA-256")}),Ow=Rw({name:"sha2-512",code:19,encode:Pw("SHA-512")});function Nw(e,t){let n=Uint8Array.from(e.abs().toByteArray());if(n=0===n[0]?n.subarray(1):n,null!=t){if(n.length>t)throw new Error("byte array longer than desired length");n=(0,Ls.z)([new Uint8Array(t-n.length),n])}return(0,Au.B)(n,"base64url")}function Bw(e){const t=function(e,t){let n=(0,yu.m)(e,"base64urlpad");if(null!=t){if(n.length>t)throw new Error("byte array longer than desired length");n=(0,Ls.z)([new Uint8Array(t-n.length),n])}return n}(e);return new(gu().jsbn.BigInteger)((0,Au.B)(t,"base16"),16)}function Lw(e){return null!=e&&("function"===typeof e.then&&"function"===typeof e.catch&&"function"===typeof e.finally)}const Mw=32,Uw=64,Fw=32;function Kw(e,t){const n=new Uint8Array(Uw);for(let r=0;r<Fw;r++)n[r]=e[r],n[Fw+r]=t[r];return n}const jw=tw({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Zw=tw({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),zw=tw({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Vw=tw({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Hw={get(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:globalThis).crypto;if(null==e||null==e.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p/blob/main/packages/crypto/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}},qw={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};async function Gw(e,t){const n=function(e){var t,n,r,i,o,s;const a=null!==(t=null===e||void 0===e?void 0:e.algorithm)&&void 0!==t?t:"AES-GCM";let c=null!==(n=null===e||void 0===e?void 0:e.keyLength)&&void 0!==n?n:16;const l=null!==(r=null===e||void 0===e?void 0:e.nonceLength)&&void 0!==r?r:12,u=null!==(i=null===e||void 0===e?void 0:e.digest)&&void 0!==i?i:"SHA-256",h=null!==(o=null===e||void 0===e?void 0:e.saltLength)&&void 0!==o?o:16,d=null!==(s=null===e||void 0===e?void 0:e.iterations)&&void 0!==s?s:32767,f=Hw.get();return c*=8,{encrypt:async function(e,t){const n=f.getRandomValues(new Uint8Array(h)),r=f.getRandomValues(new Uint8Array(l)),i={name:a,iv:r};let o;if("string"===typeof t&&(t=(0,yu.m)(t)),0===t.length){o=await f.subtle.importKey("jwk",qw,{name:"AES-GCM"},!0,["encrypt"]);try{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);o=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["encrypt"])}catch{o=await f.subtle.importKey("jwk",qw,{name:"AES-GCM"},!0,["encrypt"])}}else{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);o=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["encrypt"])}const s=await f.subtle.encrypt(i,o,e);return(0,Ls.z)([n,i.iv,new Uint8Array(s)])},decrypt:async function(e,t){const n=e.subarray(0,h),r=e.subarray(h,h+l),i=e.subarray(h+l),o={name:a,iv:r};let s;if("string"===typeof t&&(t=(0,yu.m)(t)),0===t.length)try{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);s=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["decrypt"])}catch{s=await f.subtle.importKey("jwk",qw,{name:"AES-GCM"},!0,["decrypt"])}else{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);s=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["decrypt"])}const p=await f.subtle.decrypt(o,s,i);return new Uint8Array(p)}}}(),r=await n.encrypt(e,t);return jw.encode(r)}var Ww,Qw,Yw,Jw;!function(e){e.RSA="RSA",e.Ed25519="Ed25519",e.Secp256k1="Secp256k1"}(Ww||(Ww={})),function(e){e[e.RSA=0]="RSA",e[e.Ed25519=1]="Ed25519",e[e.Secp256k1=2]="Secp256k1"}(Qw||(Qw={})),function(e){e.codec=()=>bs(Qw)}(Ww||(Ww={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),Ww.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.Type=Ww.codec().decode(e);break;case 2:n.Data=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(Yw||(Yw={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),Ww.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.Type=Ww.codec().decode(e);break;case 2:n.Data=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(Jw||(Jw={}));class Xw{constructor(e){(0,Yo.Z)(this,"_key",void 0),this._key=iE(e,Mw)}verify(e,t){return function(e,t,n){return ql.verify(t,n instanceof Uint8Array?n:n.subarray(),e)}(this._key,t,e)}marshal(){return this._key}get bytes(){return Yw.encode({Type:Ww.Ed25519,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}hash(){const e=Dw.digest(this.bytes);return Lw(e)?e.then((e=>{let{bytes:t}=e;return t})):e.bytes}}class $w{constructor(e,t){(0,Yo.Z)(this,"_key",void 0),(0,Yo.Z)(this,"_publicKey",void 0),this._key=iE(e,Uw),this._publicKey=iE(t,Mw)}sign(e){return function(e,t){const n=e.subarray(0,Fw);return ql.sign(t instanceof Uint8Array?t:t.subarray(),n)}(this._key,e)}get public(){return new Xw(this._publicKey)}marshal(){return this._key}get bytes(){return Jw.encode({Type:Ww.Ed25519,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const e=Dw.digest(this.bytes);let t;return Lw(e)?({bytes:t}=await e):t=e.bytes,t}async id(){const e=kw.digest(this.public.bytes);return nw.encode(e.bytes).substring(1)}async export(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"libp2p-key";if("libp2p-key"===t)return Gw(this.bytes,e);throw new fu.sv("export format '".concat(t,"' is not supported"),"ERR_INVALID_EXPORT_FORMAT")}}function eE(e){if(e.length>Uw){const t=(e=iE(e,Uw+Mw)).subarray(0,Uw),n=e.subarray(Uw,e.length);return new $w(t,n)}const t=(e=iE(e,Uw)).subarray(0,Uw),n=e.subarray(Mw);return new $w(t,n)}function tE(e){return e=iE(e,Mw),new Xw(e)}async function nE(){const{privateKey:e,publicKey:t}=function(){const e=ql.utils.randomPrivateKey(),t=ql.getPublicKey(e);return{privateKey:Kw(e,t),publicKey:t}}();return new $w(e,t)}async function rE(e){const{privateKey:t,publicKey:n}=function(e){if(e.length!==Fw)throw new TypeError('"seed" must be 32 bytes in length.');if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');const t=e,n=ql.getPublicKey(t);return{privateKey:Kw(t,n),publicKey:n}}(e);return new $w(t,n)}function iE(e,t){var n;if((e=Uint8Array.from(null!==(n=e)&&void 0!==n?n:[])).length!==t)throw new fu.sv("Key must be a Uint8Array of length ".concat(t,", got ").concat(e.length),"ERR_INVALID_KEY_TYPE");return e}const oE={"P-256":256,"P-384":384,"P-521":521};Object.keys(oE).join(" / ");function sE(e,t){return t.map((t=>Bw(e[t])))}async function aE(e){const t=[await Hw.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await lE(e)],n=await cE({privateKey:t[0],publicKey:t[1]});return{privateKey:n[0],publicKey:n[1]}}async function cE(e){if(null==e.privateKey||null==e.publicKey)throw new fu.sv("Private and public key are required","ERR_INVALID_PARAMETERS");return Promise.all([Hw.get().subtle.exportKey("jwk",e.privateKey),Hw.get().subtle.exportKey("jwk",e.publicKey)])}async function lE(e){return Hw.get().subtle.importKey("jwk",{kty:e.kty,n:e.n,e:e.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function uE(e,t,n,r){const i=t?function(e){return gu().pki.setRsaPublicKey(...sE(e,["n","e"]))}(e):function(e){return gu().pki.setRsaPrivateKey(...sE(e,["n","e","d","p","q","dp","dq","qi"]))}(e),o=r((0,Au.B)(n instanceof Uint8Array?n:n.subarray(),"ascii"),i);return(0,yu.m)(o,"ascii")}function hE(e){if("RSA"!==e.kty)throw new fu.sv("invalid key type","ERR_INVALID_KEY_TYPE");if(null==e.n)throw new fu.sv("invalid key modulus","ERR_INVALID_KEY_MODULUS");return 8*(0,yu.m)(e.n,"base64url").length}const dE=8192;class fE{constructor(e){(0,Yo.Z)(this,"_key",void 0),this._key=e}verify(e,t){return async function(e,t,n){const r=await Hw.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return Hw.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},r,t,n instanceof Uint8Array?n:n.subarray())}(this._key,t,e)}marshal(){return function(e){if(null==e.n||null==e.e)throw new fu.sv("JWK was missing components","ERR_INVALID_PARAMETERS");const t=gu().pki.publicKeyToAsn1({n:Bw(e.n),e:Bw(e.e)});return(0,yu.m)(gu().asn1.toDer(t).getBytes(),"ascii")}(this._key)}get bytes(){return Yw.encode({Type:Ww.RSA,Data:this.marshal()}).subarray()}encrypt(e){return uE(this._key,!0,e,((e,t)=>t.encrypt(e)))}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}hash(){const e=Dw.digest(this.bytes);return Lw(e)?e.then((e=>{let{bytes:t}=e;return t})):e.bytes}}class pE{constructor(e,t){(0,Yo.Z)(this,"_key",void 0),(0,Yo.Z)(this,"_publicKey",void 0),this._key=e,this._publicKey=t}genSecret(){return function(e){if(isNaN(e)||e<=0)throw new fu.sv("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return _c(e)}(16)}sign(e){return async function(e,t){const n=await Hw.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),r=await Hw.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},n,t instanceof Uint8Array?t:t.subarray());return new Uint8Array(r,0,r.byteLength)}(this._key,e)}get public(){if(null==this._publicKey)throw new fu.sv("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new fE(this._publicKey)}decrypt(e){return uE(this._key,!1,e,((e,t)=>t.decrypt(e)))}marshal(){return function(e){if(null==e.n||null==e.e||null==e.d||null==e.p||null==e.q||null==e.dp||null==e.dq||null==e.qi)throw new fu.sv("JWK was missing components","ERR_INVALID_PARAMETERS");const t=gu().pki.privateKeyToAsn1({n:Bw(e.n),e:Bw(e.e),d:Bw(e.d),p:Bw(e.p),q:Bw(e.q),dP:Bw(e.dp),dQ:Bw(e.dq),qInv:Bw(e.qi)});return(0,yu.m)(gu().asn1.toDer(t).getBytes(),"ascii")}(this._key)}get bytes(){return Jw.encode({Type:Ww.RSA,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}hash(){const e=Dw.digest(this.bytes);return Lw(e)?e.then((e=>{let{bytes:t}=e;return t})):e.bytes}async id(){const e=await this.public.hash();return(0,Au.B)(e,"base58btc")}async export(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"pkcs-8";if("pkcs-8"===t){const t=new(gu().util.ByteBuffer)(this.marshal()),n=gu().asn1.fromDer(t),r=gu().pki.privateKeyFromAsn1(n),i={algorithm:"aes256",count:1e4,saltSize:16,prfAlgorithm:"sha512"};return gu().pki.encryptRsaPrivateKey(r,e,i)}if("libp2p-key"===t)return Gw(this.bytes,e);throw new fu.sv("export format '".concat(t,"' is not supported"),"ERR_INVALID_EXPORT_FORMAT")}}async function gE(e){const t=function(e){const t=gu().asn1.fromDer((0,Au.B)(e,"ascii")),n=gu().pki.privateKeyFromAsn1(t);return{kty:"RSA",n:Nw(n.n),e:Nw(n.e),d:Nw(n.d),p:Nw(n.p),q:Nw(n.q),dp:Nw(n.dP),dq:Nw(n.dQ),qi:Nw(n.qInv),alg:"RS256"}}(e);if(hE(t)>dE)throw new fu.sv("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const n=await aE(t);return new pE(n.privateKey,n.publicKey)}function yE(e){const t=function(e){const t=gu().asn1.fromDer((0,Au.B)(e,"ascii")),n=gu().pki.publicKeyFromAsn1(t);return{kty:"RSA",n:Nw(n.n),e:Nw(n.e)}}(e);if(hE(t)>dE)throw new fu.sv("key size is too large","ERR_KEY_SIZE_TOO_LARGE");return new fE(t)}async function mE(e){if(hE(e)>dE)throw new fu.sv("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const t=await aE(e);return new pE(t.privateKey,t.publicKey)}async function vE(e){if(e>dE)throw new fu.sv("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const t=await async function(e){const t=await Hw.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),n=await cE(t);return{privateKey:n[0],publicKey:n[1]}}(e);return new pE(t.privateKey,t.publicKey)}function bE(e){try{Eh.ProjectivePoint.fromHex(e)}catch(t){throw new fu.sv(String(t),"ERR_INVALID_PUBLIC_KEY")}}class wE{constructor(e){(0,Yo.Z)(this,"_key",void 0),bE(e),this._key=e}verify(e,t){return function(e,t,n){const r=Dw.digest(n instanceof Uint8Array?n:n.subarray());if(Lw(r))return r.then((n=>{let{digest:r}=n;return Eh.verify(t,r,e)})).catch((e=>{throw new fu.sv(String(e),"ERR_INVALID_INPUT")}));try{return Eh.verify(t,r.digest,e)}catch(i){throw new fu.sv(String(i),"ERR_INVALID_INPUT")}}(this._key,t,e)}marshal(){return e=this._key,Eh.ProjectivePoint.fromHex(e).toRawBytes(!0);var e}get bytes(){return Yw.encode({Type:Ww.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const e=Dw.digest(this.bytes);let t;return Lw(e)?({bytes:t}=await e):t=e.bytes,t}}class EE{constructor(e,t){(0,Yo.Z)(this,"_key",void 0),(0,Yo.Z)(this,"_publicKey",void 0),this._key=e,this._publicKey=null!==t&&void 0!==t?t:function(e){try{return Eh.getPublicKey(e,!0)}catch(t){throw new fu.sv(String(t),"ERR_INVALID_PRIVATE_KEY")}}(e),function(e){try{Eh.getPublicKey(e,!0)}catch(t){throw new fu.sv(String(t),"ERR_INVALID_PRIVATE_KEY")}}(this._key),bE(this._publicKey)}sign(e){return function(e,t){const n=Dw.digest(t instanceof Uint8Array?t:t.subarray());if(Lw(n))return n.then((t=>{let{digest:n}=t;return Eh.sign(n,e).toDERRawBytes()})).catch((e=>{throw new fu.sv(String(e),"ERR_INVALID_INPUT")}));try{return Eh.sign(n.digest,e).toDERRawBytes()}catch(r){throw new fu.sv(String(r),"ERR_INVALID_INPUT")}}(this._key,e)}get public(){return new wE(this._publicKey)}marshal(){return this._key}get bytes(){return Jw.encode({Type:Ww.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}hash(){const e=Dw.digest(this.bytes);return Lw(e)?e.then((e=>{let{bytes:t}=e;return t})):e.bytes}async id(){const e=await this.public.hash();return(0,Au.B)(e,"base58btc")}async export(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"libp2p-key";if("libp2p-key"===t)return Gw(this.bytes,e);throw new fu.sv("export format '".concat(t,"' is not supported"),"ERR_INVALID_EXPORT_FORMAT")}}function AE(e){return new EE(e)}function SE(e){return new wE(e)}async function _E(){const e=Eh.utils.randomPrivateKey();return new EE(e)}const IE={rsa:z,ed25519:Z,secp256k1:V};function CE(e){const t=Object.keys(IE).join(" / ");return new fu.sv("invalid or unsupported key type ".concat(e,". Must be ").concat(t),"ERR_UNSUPPORTED_KEY_TYPE")}function TE(e){if("rsa"===(e=e.toLowerCase())||"ed25519"===e||"secp256k1"===e)return IE[e];throw CE(e)}const kE=ew({prefix:"9",name:"base10",alphabet:"0123456789"}),RE=tw({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),xE=tw({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),PE=tw({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),DE=Array.from("\ud83d\ude80\ud83e\ude90\u2604\ud83d\udef0\ud83c\udf0c\ud83c\udf11\ud83c\udf12\ud83c\udf13\ud83c\udf14\ud83c\udf15\ud83c\udf16\ud83c\udf17\ud83c\udf18\ud83c\udf0d\ud83c\udf0f\ud83c\udf0e\ud83d\udc09\u2600\ud83d\udcbb\ud83d\udda5\ud83d\udcbe\ud83d\udcbf\ud83d\ude02\u2764\ud83d\ude0d\ud83e\udd23\ud83d\ude0a\ud83d\ude4f\ud83d\udc95\ud83d\ude2d\ud83d\ude18\ud83d\udc4d\ud83d\ude05\ud83d\udc4f\ud83d\ude01\ud83d\udd25\ud83e\udd70\ud83d\udc94\ud83d\udc96\ud83d\udc99\ud83d\ude22\ud83e\udd14\ud83d\ude06\ud83d\ude44\ud83d\udcaa\ud83d\ude09\u263a\ud83d\udc4c\ud83e\udd17\ud83d\udc9c\ud83d\ude14\ud83d\ude0e\ud83d\ude07\ud83c\udf39\ud83e\udd26\ud83c\udf89\ud83d\udc9e\u270c\u2728\ud83e\udd37\ud83d\ude31\ud83d\ude0c\ud83c\udf38\ud83d\ude4c\ud83d\ude0b\ud83d\udc97\ud83d\udc9a\ud83d\ude0f\ud83d\udc9b\ud83d\ude42\ud83d\udc93\ud83e\udd29\ud83d\ude04\ud83d\ude00\ud83d\udda4\ud83d\ude03\ud83d\udcaf\ud83d\ude48\ud83d\udc47\ud83c\udfb6\ud83d\ude12\ud83e\udd2d\u2763\ud83d\ude1c\ud83d\udc8b\ud83d\udc40\ud83d\ude2a\ud83d\ude11\ud83d\udca5\ud83d\ude4b\ud83d\ude1e\ud83d\ude29\ud83d\ude21\ud83e\udd2a\ud83d\udc4a\ud83e\udd73\ud83d\ude25\ud83e\udd24\ud83d\udc49\ud83d\udc83\ud83d\ude33\u270b\ud83d\ude1a\ud83d\ude1d\ud83d\ude34\ud83c\udf1f\ud83d\ude2c\ud83d\ude43\ud83c\udf40\ud83c\udf37\ud83d\ude3b\ud83d\ude13\u2b50\u2705\ud83e\udd7a\ud83c\udf08\ud83d\ude08\ud83e\udd18\ud83d\udca6\u2714\ud83d\ude23\ud83c\udfc3\ud83d\udc90\u2639\ud83c\udf8a\ud83d\udc98\ud83d\ude20\u261d\ud83d\ude15\ud83c\udf3a\ud83c\udf82\ud83c\udf3b\ud83d\ude10\ud83d\udd95\ud83d\udc9d\ud83d\ude4a\ud83d\ude39\ud83d\udde3\ud83d\udcab\ud83d\udc80\ud83d\udc51\ud83c\udfb5\ud83e\udd1e\ud83d\ude1b\ud83d\udd34\ud83d\ude24\ud83c\udf3c\ud83d\ude2b\u26bd\ud83e\udd19\u2615\ud83c\udfc6\ud83e\udd2b\ud83d\udc48\ud83d\ude2e\ud83d\ude46\ud83c\udf7b\ud83c\udf43\ud83d\udc36\ud83d\udc81\ud83d\ude32\ud83c\udf3f\ud83e\udde1\ud83c\udf81\u26a1\ud83c\udf1e\ud83c\udf88\u274c\u270a\ud83d\udc4b\ud83d\ude30\ud83e\udd28\ud83d\ude36\ud83e\udd1d\ud83d\udeb6\ud83d\udcb0\ud83c\udf53\ud83d\udca2\ud83e\udd1f\ud83d\ude41\ud83d\udea8\ud83d\udca8\ud83e\udd2c\u2708\ud83c\udf80\ud83c\udf7a\ud83e\udd13\ud83d\ude19\ud83d\udc9f\ud83c\udf31\ud83d\ude16\ud83d\udc76\ud83e\udd74\u25b6\u27a1\u2753\ud83d\udc8e\ud83d\udcb8\u2b07\ud83d\ude28\ud83c\udf1a\ud83e\udd8b\ud83d\ude37\ud83d\udd7a\u26a0\ud83d\ude45\ud83d\ude1f\ud83d\ude35\ud83d\udc4e\ud83e\udd32\ud83e\udd20\ud83e\udd27\ud83d\udccc\ud83d\udd35\ud83d\udc85\ud83e\uddd0\ud83d\udc3e\ud83c\udf52\ud83d\ude17\ud83e\udd11\ud83c\udf0a\ud83e\udd2f\ud83d\udc37\u260e\ud83d\udca7\ud83d\ude2f\ud83d\udc86\ud83d\udc46\ud83c\udfa4\ud83d\ude47\ud83c\udf51\u2744\ud83c\udf34\ud83d\udca3\ud83d\udc38\ud83d\udc8c\ud83d\udccd\ud83e\udd40\ud83e\udd22\ud83d\udc45\ud83d\udca1\ud83d\udca9\ud83d\udc50\ud83d\udcf8\ud83d\udc7b\ud83e\udd10\ud83e\udd2e\ud83c\udfbc\ud83e\udd75\ud83d\udea9\ud83c\udf4e\ud83c\udf4a\ud83d\udc7c\ud83d\udc8d\ud83d\udce3\ud83e\udd42"),OE=DE.reduce(((e,t,n)=>(e[n]=t,e)),[]),NE=DE.reduce(((e,t,n)=>(e[t.codePointAt(0)]=n,e)),[]);const BE=$b({prefix:"\ud83d\ude80",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=OE[t]),"")},decode:function(e){const t=[];for(const n of e){const e=NE[n.codePointAt(0)];if(void 0===e)throw new Error("Non-base256emoji character: ".concat(n));t.push(e)}return new Uint8Array(t)}}),LE=tw({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),ME=tw({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),UE=tw({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),FE=tw({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),KE=tw({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),jE=tw({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),ZE=tw({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),zE=tw({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),VE=tw({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),HE=ew({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),qE=ew({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),GE=tw({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),WE=$b({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),QE=new TextEncoder,YE=new TextDecoder,JE="json",XE=512,$E=e=>QE.encode(JSON.stringify(e)),eA=e=>JSON.parse(YE.decode(e)),tA="raw",nA=85,rA=e=>Gb(e),iA=e=>Gb(e),oA=(e,t)=>{const{bytes:n,version:r}=e;return 0===r?uA(n,aA(e),t||nw.encoder):hA(n,aA(e),t||LE.encoder)},sA=new WeakMap,aA=e=>{const t=sA.get(e);if(null==t){const t=new Map;return sA.set(e,t),t}return t};class cA{constructor(e,t,n,r){this.code=t,this.version=e,this.multihash=n,this.bytes=r,this["/"]=r}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==dA)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==fA)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return cA.createV0(t)}default:throw Error("Can not convert CID version ".concat(this.version," to version 0. This is a bug please report"))}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=_w(e,t);return cA.createV1(this.code,n)}case 1:return this;default:throw Error("Can not convert CID version ".concat(this.version," to version 1. This is a bug please report"))}}equals(e){return cA.equals(this,e)}static equals(e,t){const n=t;return n&&e.code===n.code&&e.version===n.version&&((e,t)=>{if(e===t)return!0;{const n=t;return e.code===n.code&&e.size===n.size&&n.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0})(e.bytes,n.bytes)}})(e.multihash,n.multihash)}toString(e){return oA(this,e)}toJSON(){return{"/":oA(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID(".concat(this.toString(),")")}static asCID(e){if(null==e)return null;const t=e;if(t instanceof cA)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:n,multihash:r,bytes:i}=t;return new cA(e,n,r,i||pA(e,n,r.bytes))}if(!0===t[gA]){const{version:e,multihash:n,code:r}=t,i=Iw(n);return cA.create(e,r,i)}return null}static create(e,t,n){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==dA)throw new Error("Version 0 CID must use dag-pb (code: ".concat(dA,") block encoding"));return new cA(e,t,n,n.bytes);case 1:{const r=pA(e,t,n.bytes);return new cA(e,t,n,r)}default:throw new Error("Invalid version")}}static createV0(e){return cA.create(0,dA,e)}static createV1(e,t){return cA.create(1,e,t)}static decode(e){const[t,n]=cA.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=cA.inspectBytes(e),n=t.size-t.multihashSize,r=Gb(e.subarray(n,n+t.multihashSize));if(r.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=r.subarray(t.multihashSize-t.digestSize),o=new Cw(t.multihashCode,t.digestSize,i,r);return[0===t.version?cA.createV0(o):cA.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[n,r]=Ew(e.subarray(t));return t+=r,n};let r=n(),i=dA;if(18===r?(r=0,t=0):i=n(),0!==r&&1!==r)throw new RangeError("Invalid CID version ".concat(r));const o=t,s=n(),a=n(),c=t+a;return{version:r,codec:i,multihashCode:s,digestSize:a,multihashSize:c-o,size:c}}static parse(e,t){const[n,r]=lA(e,t),i=cA.decode(r);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return aA(i).set(n,e),i}}const lA=(e,t)=>{switch(e[0]){case"Q":{const n=t||nw;return[nw.prefix,n.decode("".concat(nw.prefix).concat(e))]}case nw.prefix:{const n=t||nw;return[nw.prefix,n.decode(e)]}case LE.prefix:{const n=t||LE;return[LE.prefix,n.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},uA=(e,t,n)=>{const{prefix:r}=n;if(r!==nw.prefix)throw Error("Cannot string encode V0 in ".concat(n.name," encoding"));const i=t.get(r);if(null==i){const i=n.encode(e).slice(1);return t.set(r,i),i}return i},hA=(e,t,n)=>{const{prefix:r}=n,i=t.get(r);if(null==i){const i=n.encode(e);return t.set(r,i),i}return i},dA=112,fA=18,pA=(e,t,n)=>{const r=Sw(e),i=r+Sw(t),o=new Uint8Array(i+n.byteLength);return Aw(e,o,0),Aw(t,o,r),o.set(n,i),o},gA=Symbol.for("@ipld/js-cid/CID"),yA={...X,...G,...J,...H,...q,...Q,...Y,...U,...j,...W},mA=Symbol.for("nodejs.util.inspect.custom"),vA=Object.values(yA).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)),yA.identity.decoder),bA=114,wA=36,EA=37;class AA{constructor(e){(0,Yo.Z)(this,"type",void 0),(0,Yo.Z)(this,"multihash",void 0),(0,Yo.Z)(this,"privateKey",void 0),(0,Yo.Z)(this,"publicKey",void 0),(0,Yo.Z)(this,"string",void 0),(0,Yo.Z)(this,fu.Cs,!0),this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return"PeerId(".concat(this.toString(),")")}toString(){return null==this.string&&(this.string=nw.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return cA.createV1(bA,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){var t;if(e instanceof Uint8Array)return(0,Ms.f)(this.multihash.bytes,e);if("string"===typeof e)return function(e,t){var n;if(t=null!==(n=t)&&void 0!==n?n:vA,"1"===e.charAt(0)||"Q"===e.charAt(0)){const t=Iw(nw.decode("z".concat(e)));return e.startsWith("12D")?new _A({multihash:t}):e.startsWith("16U")?new IA({multihash:t}):new SA({multihash:t})}return function(e){try{const t=Iw(e);if(t.code===kw.code){if(t.digest.length===wA)return new _A({multihash:t});if(t.digest.length===EA)return new IA({multihash:t})}if(t.code===Dw.code)return new SA({multihash:t})}catch{return function(e){if(null==e||null==e.multihash||null==e.version||1===e.version&&e.code!==bA)throw new Error("Supplied PeerID CID is invalid");const t=e.multihash;if(t.code===Dw.code)return new SA({multihash:e.multihash});if(t.code===kw.code){if(t.digest.length===wA)return new _A({multihash:e.multihash});if(t.digest.length===EA)return new IA({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}(cA.decode(e))}throw new Error("Supplied PeerID CID is invalid")}(vA.decode(e))}(e).equals(this);if(null!=(null===e||void 0===e||null===(t=e.multihash)||void 0===t?void 0:t.bytes))return(0,Ms.f)(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[mA](){return"PeerId(".concat(this.toString(),")")}}class SA extends AA{constructor(e){super({...e,type:"RSA"}),(0,Yo.Z)(this,"type","RSA"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.publicKey}}class _A extends AA{constructor(e){super({...e,type:"Ed25519"}),(0,Yo.Z)(this,"type","Ed25519"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.multihash.digest}}class IA extends AA{constructor(e){super({...e,type:"secp256k1"}),(0,Yo.Z)(this,"type","secp256k1"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.multihash.digest}}var CA;!function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.id&&(t.uint32(10),t.bytes(e.id)),null!=e.pubKey&&(t.uint32(18),t.bytes(e.pubKey)),null!=e.privKey&&(t.uint32(26),t.bytes(e.privKey)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.id=e.bytes();break;case 2:n.pubKey=e.bytes();break;case 3:n.privKey=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(CA||(CA={}));const TA=async()=>{const e=await async function(e,t){return TE(e).generateKeyPair(null!==t&&void 0!==t?t:2048)}("Ed25519"),t=await kA(e);if("Ed25519"===t.type)return t;throw new Error('Generated unexpected PeerId type "'.concat(t.type,'"'))};async function kA(e){return async function(e,t){return e.length===wA?new _A({multihash:_w(kw.code,e),privateKey:t}):e.length===EA?new IA({multihash:_w(kw.code,e),privateKey:t}):new SA({multihash:await Dw.digest(e),publicKey:e,privateKey:t})}(function(e,t){var n;return TE(t=(null!==(n=t)&&void 0!==n?n:"rsa").toLowerCase()),e.bytes}(e.public),function(e,t){var n;return TE(t=(null!==(n=t)&&void 0!==n?n:"rsa").toLowerCase()),e.bytes}(e))}const RA=function(e){if(null!=e[Symbol.asyncIterator])return(async()=>{for await(const t of e)return t})();for(const t of e)return t};function xA(e){return null!=e[Symbol.asyncIterator]}const PA=e=>{const t=Bs.P$(e),n=(0,Us.E)(t);return Bs.cv(e,n),PA.bytes=t,n};function DA(e,t){var n,r;const i=null!==(r=(t=null!==(n=t)&&void 0!==n?n:{}).lengthEncoder)&&void 0!==r?r:PA;function*o(e){const t=i(e.byteLength);t instanceof Uint8Array?yield t:yield*t,e instanceof Uint8Array?yield e:yield*e}return xA(e)?async function*(){for await(const t of e)yield*o(t)}():function*(){for(const t of e)yield*o(t)}()}PA.bytes=0,DA.single=(e,t)=>{var n,r;const i=null!==(r=(t=null!==(n=t)&&void 0!==n?n:{}).lengthEncoder)&&void 0!==r?r:PA;return new Zs(i(e.byteLength),e)};var OA;!function(e){e[e.LENGTH=0]="LENGTH",e[e.DATA=1]="DATA"}(OA||(OA={}));const NA=e=>{const t=Bs.Jx(e);return NA.bytes=Bs.P$(t),t};function BA(e,t){var n,r,i;const o=new Zs;let s=OA.LENGTH,a=-1;const c=null!==(n=null===t||void 0===t?void 0:t.lengthDecoder)&&void 0!==n?n:NA,l=null!==(r=null===t||void 0===t?void 0:t.maxLengthLength)&&void 0!==r?r:8,u=null!==(i=null===t||void 0===t?void 0:t.maxDataLength)&&void 0!==i?i:4194304;function*h(){for(;o.byteLength>0;){if(s===OA.LENGTH)try{if(a=c(o),a<0)throw Xo()(new Error("invalid message length"),"ERR_INVALID_MSG_LENGTH");if(a>u)throw Xo()(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");const e=c.bytes;o.consume(e),null!=(null===t||void 0===t?void 0:t.onLength)&&t.onLength(a),s=OA.DATA}catch(e){if(e instanceof RangeError){if(o.byteLength>l)throw Xo()(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG");break}throw e}if(s===OA.DATA){if(o.byteLength<a)break;const e=o.sublist(0,a);o.consume(a),null!=(null===t||void 0===t?void 0:t.onData)&&t.onData(e),yield e,s=OA.LENGTH}}}return xA(e)?async function*(){for await(const t of e)o.append(t),yield*h();if(o.byteLength>0)throw Xo()(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}():function*(){for(const t of e)o.append(t),yield*h();if(o.byteLength>0)throw Xo()(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}()}NA.bytes=0,BA.fromReader=(e,t)=>{let n=1;return BA(async function*(){for(;;)try{const{done:t,value:r}=await e.next(n);if(!0===t)return;null!=r&&(yield r)}catch(t){if("ERR_UNDER_READ"===t.code)return{done:!0,value:null};throw t}finally{n=1}}(),{...null!==t&&void 0!==t?t:{},onLength:e=>{n=e}})};const LA=function(e){const[t,n]=null!=e[Symbol.asyncIterator]?[e[Symbol.asyncIterator](),Symbol.asyncIterator]:[e[Symbol.iterator](),Symbol.iterator],r=[];return{peek:()=>t.next(),push:e=>{r.push(e)},next:()=>r.length>0?{done:!1,value:r.shift()}:t.next(),[n](){return this}}};const MA=function(e,t){if(null!=e[Symbol.asyncIterator])return async function*(){for await(const n of e)yield t(n)}();const n=LA(e),{value:r,done:i}=n.next();if(!0===i)return function*(){}();const o=t(r);if("function"===typeof o.then)return async function*(){yield await o;for await(const e of n)yield t(e)}();const s=t;return function*(){yield o;for(const e of n)yield s(e)}()};var UA;const FA=null!==(UA=globalThis.CustomEvent)&&void 0!==UA?UA:Event;function KA(e){try{let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(n){let r=null!==(n=t.concurrency)&&void 0!==n?n:1/0;r<1&&(r=1/0);const i=null!=t.ordered&&t.ordered,o=new EventTarget,s=[];let a,c=Ws(),l=Ws(),u=!1,h=!1;function d(){var e;return i?null===(e=s[0])||void 0===e?void 0:e.done:Boolean(s.find((e=>e.done)))}function*f(){for(;s.length>0&&s[0].done;){const e=s[0];if(s.shift(),!e.ok)throw h=!0,c.resolve(),e.err;yield e.value,c.resolve()}}function*p(){for(;d();)for(let e=0;e<s.length;e++)if(s[e].done){const t=s[e];if(s.splice(e,1),e--,!t.ok)throw h=!0,c.resolve(),t.err;yield t.value,c.resolve()}}for(o.addEventListener("task-complete",(()=>{l.resolve()})),Promise.resolve().then((async()=>{try{for await(const t of e){if(s.length===r&&(c=Ws(),await c.promise),h)break;const e={done:!1};s.push(e),t().then((t=>{e.done=!0,e.ok=!0,e.value=t,o.dispatchEvent(new FA("task-complete"))}),(t=>{e.done=!0,e.err=t,o.dispatchEvent(new FA("task-complete"))}))}u=!0,o.dispatchEvent(new FA("task-complete"))}catch(t){a=t,o.dispatchEvent(new FA("task-complete"))}}));;){if(d()||(l=Ws(),await l.promise),null!=a)throw a;if(i?yield*f():yield*p(),u&&0===s.length)break}}()}catch(t){return Promise.reject(t)}}class jA{constructor(e){if((0,Yo.Z)(this,"buffer",void 0),(0,Yo.Z)(this,"mask",void 0),(0,Yo.Z)(this,"top",void 0),(0,Yo.Z)(this,"btm",void 0),(0,Yo.Z)(this,"next",void 0),!(e>0)||0!==(e-1&e))throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];if(void 0!==e)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return void 0===this.buffer[this.btm]}}class ZA{constructor(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,Yo.Z)(this,"size",void 0),(0,Yo.Z)(this,"hwm",void 0),(0,Yo.Z)(this,"head",void 0),(0,Yo.Z)(this,"tail",void 0),this.hwm=null!==(e=t.splitLimit)&&void 0!==e?e:16,this.head=new jA(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return null!=(null===e||void 0===e?void 0:e.byteLength)?e.byteLength:1}push(e){if(null!=(null===e||void 0===e?void 0:e.value)&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){const t=this.head;this.head=t.next=new jA(2*this.head.buffer.length),this.head.push(e)}}shift(){var e;let t=this.tail.shift();if(void 0===t&&null!=this.tail.next){const e=this.tail.next;this.tail.next=null,this.tail=e,t=this.tail.shift()}return null!=(null===(e=t)||void 0===e?void 0:e.value)&&(this.size-=this.calculateSize(t.value)),t}isEmpty(){return this.head.isEmpty()}}class zA extends Error{constructor(e,t){super(null!==e&&void 0!==e?e:"The operation was aborted"),(0,Yo.Z)(this,"type",void 0),(0,Yo.Z)(this,"code",void 0),this.type="aborted",this.code=null!==t&&void 0!==t?t:"ABORT_ERR"}}function VA(){return HA((e=>{const t=e.shift();if(null==t)return{done:!0};if(null!=t.error)throw t.error;return{done:!0===t.done,value:t.value}}),arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function HA(e,t){var n;let r,i,o,s=(t=null!==(n=t)&&void 0!==n?n:{}).onEnd,a=new ZA,c=Ws();const l=e=>null!=i?i(e):(a.push(e),r),u=e=>{var n;if(o)return r;if(!0!==(null===(n=t)||void 0===n?void 0:n.objectMode)&&null==(null===e||void 0===e?void 0:e.byteLength))throw new Error("objectMode was not true but tried to push non-Uint8Array value");return l({done:!1,value:e})},h=e=>o?r:(o=!0,null!=e?(e=>(a=new ZA,null!=i?i({error:e}):(a.push({error:e}),r)))(e):l({done:!0}));if(r={[Symbol.asyncIterator](){return this},next:async()=>{try{return a.isEmpty()?o?{done:!0}:await new Promise(((t,n)=>{i=o=>{i=null,a.push(o);try{t(e(a))}catch(s){n(s)}return r}})):e(a)}finally{a.isEmpty()&&queueMicrotask((()=>{c.resolve(),c=Ws()}))}},return:()=>(a=new ZA,h(),{done:!0}),throw:e=>(h(e),{done:!0}),push:u,end:h,get readableLength(){return a.size},onEmpty:async e=>{const t=null===e||void 0===e?void 0:e.signal;if(null===t||void 0===t||t.throwIfAborted(),a.isEmpty())return;let n,r;null!=t&&(n=new Promise(((e,n)=>{r=()=>{n(new zA)},t.addEventListener("abort",r)})));try{await Promise.race([c.promise,n])}finally{null!=r&&null!=t&&(null===t||void 0===t||t.removeEventListener("abort",r))}}},null==s)return r;const d=r;return r={[Symbol.asyncIterator](){return this},next:()=>d.next(),throw:e=>(d.throw(e),null!=s&&(s(e),s=void 0),{done:!0}),return:()=>(d.return(),null!=s&&(s(),s=void 0),{done:!0}),push:u,end:e=>(d.end(e),null!=s&&(s(e),s=void 0),r),get readableLength(){return d.readableLength},onEmpty:e=>d.onEmpty(e)},r}const qA=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=[];for(const i of t)null==i[Symbol.asyncIterator]&&r.push(i);return r.length===t.length?function*(){for(const e of r)yield*e}():async function*(){const e=VA({objectMode:!0});Promise.resolve().then((async()=>{try{await Promise.all(t.map((async t=>{for await(const n of t)e.push(n)}))),e.end()}catch(n){e.end(n)}})),yield*e}()};function GA(e){if(null==e)throw new Error("Empty pipeline");if(JA(e)){const t=e;e=()=>t.source}else if(YA(e)||QA(e)){const t=e;e=()=>t}for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=[e,...n];if(i.length>1&&JA(i[i.length-1])&&(i[i.length-1]=i[i.length-1].sink),i.length>2)for(let o=1;o<i.length-1;o++)JA(i[o])&&(i[o]=XA(i[o]));return WA(...i)}const WA=function(){let e;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(;n.length>0;)e=n.shift()(e);return e},QA=e=>null!=(null===e||void 0===e?void 0:e[Symbol.asyncIterator]),YA=e=>null!=(null===e||void 0===e?void 0:e[Symbol.iterator]),JA=e=>null!=e&&(null!=e.sink&&null!=e.source),XA=e=>t=>{const n=e.sink(t);if(null!=(null===n||void 0===n?void 0:n.then)){const t=VA({objectMode:!0});let r;n.then((()=>{t.end()}),(e=>{t.end(e)}));const i=e.source;if(QA(i))r=async function*(){yield*i,t.end()};else{if(!YA(i))throw new Error("Unknown duplex source type - must be Iterable or AsyncIterable");r=function*(){yield*i,t.end()}}return qA(t,r())}return e.source};var $A=n(27922);const eS="[a-fA-F\\d:]",tS=e=>e&&e.includeBoundaries?"(?:(?<=\\s|^)(?=".concat(eS,")|(?<=").concat(eS,")(?=\\s|$))"):"",nS="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",rS="[a-fA-F\\d]{1,4}",iS="\n(?:\n(?:".concat(rS,":){7}(?:").concat(rS,"|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8\n(?:").concat(rS,":){6}(?:").concat(nS,"|:").concat(rS,"|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4\n(?:").concat(rS,":){5}(?::").concat(nS,"|(?::").concat(rS,"){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4\n(?:").concat(rS,":){4}(?:(?::").concat(rS,"){0,1}:").concat(nS,"|(?::").concat(rS,"){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4\n(?:").concat(rS,":){3}(?:(?::").concat(rS,"){0,2}:").concat(nS,"|(?::").concat(rS,"){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4\n(?:").concat(rS,":){2}(?:(?::").concat(rS,"){0,3}:").concat(nS,"|(?::").concat(rS,"){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4\n(?:").concat(rS,":){1}(?:(?::").concat(rS,"){0,4}:").concat(nS,"|(?::").concat(rS,"){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4\n(?::(?:(?::").concat(rS,"){0,5}:").concat(nS,"|(?::").concat(rS,"){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4\n)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1\n").replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),oS=new RegExp("(?:^".concat(nS,"$)|(?:^").concat(iS,"$)")),sS=new RegExp("^".concat(nS,"$")),aS=new RegExp("^".concat(iS,"$")),cS=e=>e&&e.exact?oS:new RegExp("(?:".concat(tS(e)).concat(nS).concat(tS(e),")|(?:").concat(tS(e)).concat(iS).concat(tS(e),")"),"g");cS.v4=e=>e&&e.exact?sS:new RegExp("".concat(tS(e)).concat(nS).concat(tS(e)),"g"),cS.v6=e=>e&&e.exact?aS:new RegExp("".concat(tS(e)).concat(iS).concat(tS(e)),"g");const lS=cS;var uS=n(54636),hS=n(87201),dS=n.n(hS);const{isValid:fS,parse:pS}=dS(),gS=["0.0.0.0/8","10.0.0.0/8","100.64.0.0/10","127.0.0.0/8","169.254.0.0/16","172.16.0.0/12","192.0.0.0/24","192.0.0.0/29","192.0.0.8/32","192.0.0.9/32","192.0.0.10/32","192.0.0.170/32","192.0.0.171/32","192.0.2.0/24","192.31.196.0/24","192.52.193.0/24","192.88.99.0/24","192.168.0.0/16","192.175.48.0/24","198.18.0.0/15","198.51.100.0/24","203.0.113.0/24","240.0.0.0/4","255.255.255.255/32"].map((e=>new $A.Netmask(e)));function yS(e){return/^::$/.test(e)||/^::1$/.test(e)||/^::f{4}:([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(e)||/^::f{4}:0.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(e)||/^64:ff9b::([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(e)||/^100::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^2001::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^2001:2[0-9a-fA-F]:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^2001:db8:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^2002:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^f[c-d]([0-9a-fA-F]{2,2}):/i.test(e)||/^fe[8-9a-bA-B][0-9a-fA-F]:/i.test(e)||/^ff([0-9a-fA-F]{2,2}):/i.test(e)}const mS=e=>{if(fS(e)){const t=pS(e);if("ipv4"===t.kind())return function(e){for(let t of gS)if(t.contains(e))return!0;return!1}(t.toNormalizedString());if("ipv6"===t.kind())return yS(e)}else if((0,uS.h6)(e)&&lS.v6().test(e))return yS(e)};var vS;!function(e){let t,n,r,i,o,s,a,c;!function(e){e.DIAL="DIAL",e.DIAL_RESPONSE="DIAL_RESPONSE"}(t=e.MessageType||(e.MessageType={})),function(e){e[e.DIAL=0]="DIAL",e[e.DIAL_RESPONSE=1]="DIAL_RESPONSE"}(n||(n={})),function(e){e.codec=()=>bs(n)}(t=e.MessageType||(e.MessageType={})),function(e){e.OK="OK",e.E_DIAL_ERROR="E_DIAL_ERROR",e.E_DIAL_REFUSED="E_DIAL_REFUSED",e.E_BAD_REQUEST="E_BAD_REQUEST",e.E_INTERNAL_ERROR="E_INTERNAL_ERROR"}(r=e.ResponseStatus||(e.ResponseStatus={})),function(e){e[e.OK=0]="OK",e[e.E_DIAL_ERROR=100]="E_DIAL_ERROR",e[e.E_DIAL_REFUSED=101]="E_DIAL_REFUSED",e[e.E_BAD_REQUEST=200]="E_BAD_REQUEST",e[e.E_INTERNAL_ERROR=300]="E_INTERNAL_ERROR"}(i||(i={})),function(e){e.codec=()=>bs(i)}(r=e.ResponseStatus||(e.ResponseStatus={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==n.lengthDelimited&&t.fork(),null!=e.id&&(t.uint32(10),t.bytes(e.id)),null!=e.addrs)for(const r of e.addrs)t.uint32(18),t.bytes(r);!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={addrs:[]},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.id=e.bytes();break;case 2:n.addrs.push(e.bytes());break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(o=e.PeerInfo||(e.PeerInfo={})),function(t){let n;t.codec=()=>(null==n&&(n=ws((function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==r.lengthDelimited&&n.fork(),null!=t.peer&&(n.uint32(10),e.PeerInfo.codec().encode(t.peer,n)),!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();if(n>>>3===1)r.peer=e.PeerInfo.codec().decode(t,t.uint32());else t.skipType(7&n)}return r}))),n),t.encode=e=>fs(e,t.codec()),t.decode=e=>ds(e,t.codec())}(s=e.Dial||(e.Dial={})),function(t){let n;t.codec=()=>(null==n&&(n=ws((function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==r.lengthDelimited&&n.fork(),null!=t.status&&(n.uint32(8),e.ResponseStatus.codec().encode(t.status,n)),null!=t.statusText&&(n.uint32(18),n.string(t.statusText)),null!=t.addr&&(n.uint32(26),n.bytes(t.addr)),!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.status=e.ResponseStatus.codec().decode(t);break;case 2:r.statusText=t.string();break;case 3:r.addr=t.bytes();break;default:t.skipType(7&n)}}return r}))),n),t.encode=e=>fs(e,t.codec()),t.decode=e=>ds(e,t.codec())}(a=e.DialResponse||(e.DialResponse={})),e.codec=()=>(null==c&&(c=ws((function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==r.lengthDelimited&&n.fork(),null!=t.type&&(n.uint32(8),e.MessageType.codec().encode(t.type,n)),null!=t.dial&&(n.uint32(18),e.Dial.codec().encode(t.dial,n)),null!=t.dialResponse&&(n.uint32(26),e.DialResponse.codec().encode(t.dialResponse,n)),!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.type=e.MessageType.codec().decode(t);break;case 2:r.dial=e.Dial.codec().decode(t,t.uint32());break;case 3:r.dialResponse=e.DialResponse.codec().decode(t,t.uint32());break;default:t.skipType(7&n)}}return r}))),c),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(vS||(vS={}));class bS{constructor(e,t){var n,r,i,o,s,a;(0,Yo.Z)(this,"components",void 0),(0,Yo.Z)(this,"startupDelay",void 0),(0,Yo.Z)(this,"refreshInterval",void 0),(0,Yo.Z)(this,"protocol",void 0),(0,Yo.Z)(this,"timeout",void 0),(0,Yo.Z)(this,"maxInboundStreams",void 0),(0,Yo.Z)(this,"maxOutboundStreams",void 0),(0,Yo.Z)(this,"verifyAddressTimeout",void 0),(0,Yo.Z)(this,"started",void 0),(0,Yo.Z)(this,"log",void 0),this.components=e,this.log=e.logger.forComponent("libp2p:autonat"),this.started=!1,this.protocol="/".concat(null!==(n=t.protocolPrefix)&&void 0!==n?n:"libp2p","/").concat("autonat","/").concat("1.0.0"),this.timeout=null!==(r=t.timeout)&&void 0!==r?r:3e4,this.maxInboundStreams=null!==(i=t.maxInboundStreams)&&void 0!==i?i:1,this.maxOutboundStreams=null!==(o=t.maxOutboundStreams)&&void 0!==o?o:1,this.startupDelay=null!==(s=t.startupDelay)&&void 0!==s?s:5e3,this.refreshInterval=null!==(a=t.refreshInterval)&&void 0!==a?a:6e4,this._verifyExternalAddresses=this._verifyExternalAddresses.bind(this)}isStarted(){return this.started}async start(){this.started||(await this.components.registrar.handle(this.protocol,(e=>{this.handleIncomingAutonatStream(e).catch((e=>{this.log.error("error handling incoming autonat stream",e)}))}),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams}),this.verifyAddressTimeout=setTimeout(this._verifyExternalAddresses,this.startupDelay),this.started=!0)}async stop(){await this.components.registrar.unhandle(this.protocol),clearTimeout(this.verifyAddressTimeout),this.started=!1}async handleIncomingAutonatStream(e){const t=AbortSignal.timeout(this.timeout),n=()=>{e.stream.abort(new fu.sv("handleIncomingAutonatStream timeout",fu.l9))};t.addEventListener("abort",n,{once:!0}),(0,fu.Wp)(1/0,t);const r=this.components.addressManager.getAddresses().map((e=>e.toOptions().host));try{const n=this;await GA(e.stream,(e=>BA(e)),(async function*(i){const o=await RA(i);if(null==o)return n.log("no message received"),void(yield vS.encode({type:vS.MessageType.DIAL_RESPONSE,dialResponse:{status:vS.ResponseStatus.E_BAD_REQUEST,statusText:"No message was sent"}}));let s;try{s=vS.decode(o)}catch(f){return n.log.error("could not decode message",f),void(yield vS.encode({type:vS.MessageType.DIAL_RESPONSE,dialResponse:{status:vS.ResponseStatus.E_BAD_REQUEST,statusText:"Could not decode message"}}))}const a=s.dial;if(null==a)return n.log.error("dial was missing from message"),void(yield vS.encode({type:vS.MessageType.DIAL_RESPONSE,dialResponse:{status:vS.ResponseStatus.E_BAD_REQUEST,statusText:"No Dial message found in message"}}));let c;const l=a.peer;if(null==l||null==l.id)return n.log.error("PeerId missing from message"),void(yield vS.encode({type:vS.MessageType.DIAL_RESPONSE,dialResponse:{status:vS.ResponseStatus.E_BAD_REQUEST,statusText:"missing peer info"}}));try{c=Vb(l.id)}catch(f){return n.log.error("invalid PeerId",f),void(yield vS.encode({type:vS.MessageType.DIAL_RESPONSE,dialResponse:{status:vS.ResponseStatus.E_BAD_REQUEST,statusText:"bad peer id"}}))}if(n.log("incoming request from %p",c),!e.connection.remotePeer.equals(c))return n.log("target peer %p did not equal sending peer %p",c,e.connection.remotePeer),void(yield vS.encode({type:vS.MessageType.DIAL_RESPONSE,dialResponse:{status:vS.ResponseStatus.E_BAD_REQUEST,statusText:"peer id mismatch"}}));const u=l.addrs.map((e=>(0,ng.HM)(e))).filter((t=>{const r=t.toOptions().host===e.connection.remoteAddr.toOptions().host;return n.log.trace("request to dial %a was sent from %a is same host %s",t,e.connection.remoteAddr,r),r})).filter((e=>{var t;const r=e.toOptions().host,i=!(null!==(t=mS(r))&&void 0!==t&&t);return n.log.trace("host %s was public %s",r,i),i})).filter((e=>{const t=e.toOptions().host,i=!r.includes(t);return n.log.trace("host %s was not our host %s",t,i),i})).filter((e=>{const t=Boolean(n.components.transportManager.transportForMultiaddr(e));return n.log.trace("transport for %a is supported %s",e,t),t})).map((e=>(null==e.getPeerId()&&(e=e.encapsulate("/p2p/".concat(c.toString()))),e)));if(0===u.length)return n.log("no valid multiaddrs for %p in message",c),void(yield vS.encode({type:vS.MessageType.DIAL_RESPONSE,dialResponse:{status:vS.ResponseStatus.E_DIAL_REFUSED,statusText:"no dialable addresses"}}));n.log("dial multiaddrs %s for peer %p",u.map((e=>e.toString())).join(", "),c);let h="",d=u[0];for await(const e of u){let r;d=e;try{if(r=await n.components.connectionManager.openConnection(e,{signal:t}),!r.remoteAddr.equals(e))throw n.log.error("tried to dial %a but dialed %a",e,r.remoteAddr),new Error("Unexpected remote address");return n.log("Success %p",c),void(yield vS.encode({type:vS.MessageType.DIAL_RESPONSE,dialResponse:{status:vS.ResponseStatus.OK,addr:r.remoteAddr.decapsulateCode((0,ng.a_)("p2p").code).bytes}}))}catch(f){n.log("could not dial %p",c,f),h=f.message}finally{null!=r&&await r.close()}}yield vS.encode({type:vS.MessageType.DIAL_RESPONSE,dialResponse:{status:vS.ResponseStatus.E_DIAL_ERROR,statusText:h,addr:d.bytes}})}),(e=>DA(e)),e.stream)}catch(i){this.log.error("error handling incoming autonat stream",i)}finally{t.removeEventListener("abort",n)}}_verifyExternalAddresses(){this.verifyExternalAddresses().catch((e=>{this.log.error("error verifying external address",e)}))}async verifyExternalAddresses(){if(clearTimeout(this.verifyAddressTimeout),!this.isStarted())return;const e=this.components.addressManager,t=e.getObservedAddrs().filter((e=>{var t;const n=e.toOptions();return!(null!==(t=mS(n.host))&&void 0!==t&&t)}));if(0===t.length)return this.log("no public addresses found, not requesting verification"),void(this.verifyAddressTimeout=setTimeout(this._verifyExternalAddresses,this.refreshInterval));const n=AbortSignal.timeout(this.timeout);(0,fu.Wp)(1/0,n);const r=this;try{this.log("verify multiaddrs %s",t.map((e=>e.toString())).join(", "));const o=vS.encode({type:vS.MessageType.DIAL,dial:{peer:{id:this.components.peerId.toBytes(),addrs:t.map((e=>e.bytes))}}}),s=(await TA()).toBytes(),a={},c=[],l=async e=>{let t=()=>{};try{this.log("asking %p to verify multiaddr",e.id);const i=await r.components.connectionManager.openConnection(e.id,{signal:n}),s=await i.newStream(this.protocol,{signal:n});t=()=>{s.abort(new fu.sv("verifyAddress timeout",fu.l9))},n.addEventListener("abort",t,{once:!0});const a=await GA([o],(e=>DA(e)),s,(e=>BA(e)),(async e=>RA(e)));if(null==a)return void this.log("no response received from %p",i.remotePeer);const l=vS.decode(a);if(l.type!==vS.MessageType.DIAL_RESPONSE||null==l.dialResponse)return void this.log("invalid autonat response from %p",i.remotePeer);if(l.dialResponse.status===vS.ResponseStatus.OK){const e=i.remoteAddr.toOptions();let t;if(4===e.family){t=e.host.split(".")[0]}else{if(6!==e.family)return void this.log('remote address "%s" was not IP4 or IP6?',e.host);t=e.host.split(":")[0]}if(c.includes(t))return void this.log("already have response from network segment %d - %s",t,e.host);c.push(t)}return l.dialResponse}catch(i){this.log.error("error asking remote to verify multiaddr",i)}finally{n.removeEventListener("abort",t)}};for await(const r of KA(MA(this.components.peerRouting.getClosestPeers(s,{signal:n}),(e=>async()=>l(e))),{concurrency:4}))try{if(null==r)continue;const n=null==r.addr?t[0]:(0,ng.HM)(r.addr);if(this.log("autonat response for %a is %s",n,r.status),r.status===vS.ResponseStatus.E_BAD_REQUEST)continue;if(r.status===vS.ResponseStatus.E_DIAL_REFUSED)continue;if(null==r.addr&&t.length>1)continue;if(!t.some((e=>e.equals(n)))){this.log("peer reported %a as %s but it was not in our observed address list",n,r.status);continue}const i=n.toString();if(null==a[i]&&(a[i]={success:0,failure:0}),r.status===vS.ResponseStatus.OK?a[i].success++:r.status===vS.ResponseStatus.E_DIAL_ERROR&&a[i].failure++,4===a[i].success)return this.log("%a is externally dialable",n),void e.confirmObservedAddr(n);if(4===a[i].failure)return this.log("%a is not externally dialable",n),void e.removeObservedAddr(n)}catch(i){this.log.error("could not verify external address",i)}}finally{this.verifyAddressTimeout=setTimeout(this._verifyExternalAddresses,this.refreshInterval)}}}function wS(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>new bS(t,e)}var ES=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==n[s])throw new TypeError(o+" is ambiguous");n[s]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var r=0,i=0;e[t]===c;)r++,t++;for(var o=(e.length-t)*l+1>>>0,s=new Uint8Array(o);e[t];){var u=n[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=o-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*s[d]>>>0,s[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=o-i;f!==o&&0===s[f];)f++;for(var p=new Uint8Array(r+(o-f)),g=r;f!==o;)p[g++]=s[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,o=t.length;i!==o&&0===t[i];)i++,n++;for(var s=(o-i)*u+1>>>0,l=new Uint8Array(s);i!==o;){for(var h=t[i],d=0,f=s-1;(0!==h||d<r)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");r=d,i++}for(var p=s-r;p!==s&&0===l[p];)p++;for(var g=c.repeat(n);p<s;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:h,decode:function(e){var n=h(e);if(n)return n;throw new Error("Non-".concat(t," character"))}}};const AS=ES,SS=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class _S{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(e));throw Error("Unknown type, must be binary type")}}class IS{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(e),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return TS(this,e)}}class CS{constructor(e){this.decoders=e}or(e){return TS(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(e),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}}const TS=(e,t)=>new CS({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class kS{constructor(e,t,n,r){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=r,this.encoder=new _S(e,t,n),this.decoder=new IS(e,t,r)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const RS=e=>{let{name:t,prefix:n,encode:r,decode:i}=e;return new kS(t,n,r,i)},xS=e=>{let{prefix:t,name:n,alphabet:r}=e;const{encode:i,decode:o}=AS(r,n);return RS({prefix:t,name:n,encode:i,decode:e=>SS(o(e))})},PS=e=>{let{name:t,prefix:n,bitsPerChar:r,alphabet:i}=e;return RS({prefix:n,name:t,encode:e=>((e,t,n)=>{const r="="===t[t.length-1],i=(1<<n)-1;let o="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>n;)s-=n,o+=t[i&a>>s];if(s&&(o+=t[i&a<<n-s]),r)for(;o.length*n&7;)o+="=";return o})(e,i,r),decode:e=>((e,t,n,r)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*n/8|0);let a=0,c=0,l=0;for(let u=0;u<o;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError("Non-".concat(r," character"));c=c<<n|t,a+=n,a>=8&&(a-=8,s[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s})(e,i,r,t)})},DS=xS({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),OS=xS({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),NS=xS({prefix:"9",name:"base10",alphabet:"0123456789"}),BS=PS({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),LS=PS({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),MS=PS({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),US=Array.from("\ud83d\ude80\ud83e\ude90\u2604\ud83d\udef0\ud83c\udf0c\ud83c\udf11\ud83c\udf12\ud83c\udf13\ud83c\udf14\ud83c\udf15\ud83c\udf16\ud83c\udf17\ud83c\udf18\ud83c\udf0d\ud83c\udf0f\ud83c\udf0e\ud83d\udc09\u2600\ud83d\udcbb\ud83d\udda5\ud83d\udcbe\ud83d\udcbf\ud83d\ude02\u2764\ud83d\ude0d\ud83e\udd23\ud83d\ude0a\ud83d\ude4f\ud83d\udc95\ud83d\ude2d\ud83d\ude18\ud83d\udc4d\ud83d\ude05\ud83d\udc4f\ud83d\ude01\ud83d\udd25\ud83e\udd70\ud83d\udc94\ud83d\udc96\ud83d\udc99\ud83d\ude22\ud83e\udd14\ud83d\ude06\ud83d\ude44\ud83d\udcaa\ud83d\ude09\u263a\ud83d\udc4c\ud83e\udd17\ud83d\udc9c\ud83d\ude14\ud83d\ude0e\ud83d\ude07\ud83c\udf39\ud83e\udd26\ud83c\udf89\ud83d\udc9e\u270c\u2728\ud83e\udd37\ud83d\ude31\ud83d\ude0c\ud83c\udf38\ud83d\ude4c\ud83d\ude0b\ud83d\udc97\ud83d\udc9a\ud83d\ude0f\ud83d\udc9b\ud83d\ude42\ud83d\udc93\ud83e\udd29\ud83d\ude04\ud83d\ude00\ud83d\udda4\ud83d\ude03\ud83d\udcaf\ud83d\ude48\ud83d\udc47\ud83c\udfb6\ud83d\ude12\ud83e\udd2d\u2763\ud83d\ude1c\ud83d\udc8b\ud83d\udc40\ud83d\ude2a\ud83d\ude11\ud83d\udca5\ud83d\ude4b\ud83d\ude1e\ud83d\ude29\ud83d\ude21\ud83e\udd2a\ud83d\udc4a\ud83e\udd73\ud83d\ude25\ud83e\udd24\ud83d\udc49\ud83d\udc83\ud83d\ude33\u270b\ud83d\ude1a\ud83d\ude1d\ud83d\ude34\ud83c\udf1f\ud83d\ude2c\ud83d\ude43\ud83c\udf40\ud83c\udf37\ud83d\ude3b\ud83d\ude13\u2b50\u2705\ud83e\udd7a\ud83c\udf08\ud83d\ude08\ud83e\udd18\ud83d\udca6\u2714\ud83d\ude23\ud83c\udfc3\ud83d\udc90\u2639\ud83c\udf8a\ud83d\udc98\ud83d\ude20\u261d\ud83d\ude15\ud83c\udf3a\ud83c\udf82\ud83c\udf3b\ud83d\ude10\ud83d\udd95\ud83d\udc9d\ud83d\ude4a\ud83d\ude39\ud83d\udde3\ud83d\udcab\ud83d\udc80\ud83d\udc51\ud83c\udfb5\ud83e\udd1e\ud83d\ude1b\ud83d\udd34\ud83d\ude24\ud83c\udf3c\ud83d\ude2b\u26bd\ud83e\udd19\u2615\ud83c\udfc6\ud83e\udd2b\ud83d\udc48\ud83d\ude2e\ud83d\ude46\ud83c\udf7b\ud83c\udf43\ud83d\udc36\ud83d\udc81\ud83d\ude32\ud83c\udf3f\ud83e\udde1\ud83c\udf81\u26a1\ud83c\udf1e\ud83c\udf88\u274c\u270a\ud83d\udc4b\ud83d\ude30\ud83e\udd28\ud83d\ude36\ud83e\udd1d\ud83d\udeb6\ud83d\udcb0\ud83c\udf53\ud83d\udca2\ud83e\udd1f\ud83d\ude41\ud83d\udea8\ud83d\udca8\ud83e\udd2c\u2708\ud83c\udf80\ud83c\udf7a\ud83e\udd13\ud83d\ude19\ud83d\udc9f\ud83c\udf31\ud83d\ude16\ud83d\udc76\ud83e\udd74\u25b6\u27a1\u2753\ud83d\udc8e\ud83d\udcb8\u2b07\ud83d\ude28\ud83c\udf1a\ud83e\udd8b\ud83d\ude37\ud83d\udd7a\u26a0\ud83d\ude45\ud83d\ude1f\ud83d\ude35\ud83d\udc4e\ud83e\udd32\ud83e\udd20\ud83e\udd27\ud83d\udccc\ud83d\udd35\ud83d\udc85\ud83e\uddd0\ud83d\udc3e\ud83c\udf52\ud83d\ude17\ud83e\udd11\ud83c\udf0a\ud83e\udd2f\ud83d\udc37\u260e\ud83d\udca7\ud83d\ude2f\ud83d\udc86\ud83d\udc46\ud83c\udfa4\ud83d\ude47\ud83c\udf51\u2744\ud83c\udf34\ud83d\udca3\ud83d\udc38\ud83d\udc8c\ud83d\udccd\ud83e\udd40\ud83e\udd22\ud83d\udc45\ud83d\udca1\ud83d\udca9\ud83d\udc50\ud83d\udcf8\ud83d\udc7b\ud83e\udd10\ud83e\udd2e\ud83c\udfbc\ud83e\udd75\ud83d\udea9\ud83c\udf4e\ud83c\udf4a\ud83d\udc7c\ud83d\udc8d\ud83d\udce3\ud83e\udd42"),FS=US.reduce(((e,t,n)=>(e[n]=t,e)),[]),KS=US.reduce(((e,t,n)=>(e[t.codePointAt(0)]=n,e)),[]);const jS=RS({prefix:"\ud83d\ude80",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=FS[t]),"")},decode:function(e){const t=[];for(const n of e){const e=KS[n.codePointAt(0)];if(void 0===e)throw new Error("Non-base256emoji character: ".concat(n));t.push(e)}return new Uint8Array(t)}}),ZS=PS({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),zS=PS({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),VS=PS({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),HS=PS({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),qS=PS({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),GS=PS({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),WS=PS({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),QS=PS({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),YS=PS({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),JS=xS({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),XS=xS({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),$S=PS({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),e_=PS({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),t_=PS({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),n_=PS({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),r_=PS({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),i_=RS({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),o_=new TextEncoder,s_=new TextDecoder,a_="json",c_=512,l_=e=>o_.encode(JSON.stringify(e)),u_=e=>JSON.parse(s_.decode(e)),h_="raw",d_=85,f_=e=>SS(e),p_=e=>SS(e);var g_=function e(t,n,r){n=n||[];var i=r=r||0;for(;t>=v_;)n[r++]=255&t|y_,t/=128;for(;t&m_;)n[r++]=255&t|y_,t>>>=7;return n[r]=0|t,e.bytes=r-i+1,n},y_=128,m_=-128,v_=Math.pow(2,31);var b_=function e(t,n){var r,i=0,o=0,s=n=n||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");r=t[s++],i+=o<28?(r&E_)<<o:(r&E_)*Math.pow(2,o),o+=7}while(r>=w_);return e.bytes=s-n,i},w_=128,E_=127;var A_=Math.pow(2,7),S_=Math.pow(2,14),__=Math.pow(2,21),I_=Math.pow(2,28),C_=Math.pow(2,35),T_=Math.pow(2,42),k_=Math.pow(2,49),R_=Math.pow(2,56),x_=Math.pow(2,63);const P_={encode:g_,decode:b_,encodingLength:function(e){return e<A_?1:e<S_?2:e<__?3:e<I_?4:e<C_?5:e<T_?6:e<k_?7:e<R_?8:e<x_?9:10}},D_=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return[P_.decode(e,t),P_.decode.bytes]},O_=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return P_.encode(e,t,n),t},N_=e=>P_.encodingLength(e),B_=(e,t)=>{const n=t.byteLength,r=N_(e),i=r+N_(n),o=new Uint8Array(i+n);return O_(e,o,0),O_(n,o,r),o.set(t,i),new M_(e,n,t,o)},L_=e=>{const t=SS(e),[n,r]=D_(t),[i,o]=D_(t.subarray(r)),s=t.subarray(r+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new M_(n,i,s,t)};class M_{constructor(e,t,n,r){this.code=e,this.size=t,this.digest=n,this.bytes=r}}const U_=SS,F_={code:0,name:"identity",encode:U_,digest:e=>B_(0,U_(e))},K_=e=>{let{name:t,code:n,encode:r}=e;return new j_(t,n,r)};class j_{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?B_(this.code,t):t.then((e=>B_(this.code,e)))}throw Error("Unknown type, must be binary type")}}const Z_=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),z_=K_({name:"sha2-256",code:18,encode:Z_("SHA-256")}),V_=K_({name:"sha2-512",code:19,encode:Z_("SHA-512")}),H_=(e,t)=>{const{bytes:n,version:r}=e;return 0===r?Y_(n,G_(e),t||DS.encoder):J_(n,G_(e),t||ZS.encoder)},q_=new WeakMap,G_=e=>{const t=q_.get(e);if(null==t){const t=new Map;return q_.set(e,t),t}return t};class W_{constructor(e,t,n,r){this.code=t,this.version=e,this.multihash=n,this.bytes=r,this["/"]=r}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==X_)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==$_)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return W_.createV0(t)}default:throw Error("Can not convert CID version ".concat(this.version," to version 0. This is a bug please report"))}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=B_(e,t);return W_.createV1(this.code,n)}case 1:return this;default:throw Error("Can not convert CID version ".concat(this.version," to version 1. This is a bug please report"))}}equals(e){return W_.equals(this,e)}static equals(e,t){const n=t;return n&&e.code===n.code&&e.version===n.version&&((e,t)=>{if(e===t)return!0;{const n=t;return e.code===n.code&&e.size===n.size&&n.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0})(e.bytes,n.bytes)}})(e.multihash,n.multihash)}toString(e){return H_(this,e)}toJSON(){return{"/":H_(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID(".concat(this.toString(),")")}static asCID(e){if(null==e)return null;const t=e;if(t instanceof W_)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:n,multihash:r,bytes:i}=t;return new W_(e,n,r,i||eI(e,n,r.bytes))}if(!0===t[tI]){const{version:e,multihash:n,code:r}=t,i=L_(n);return W_.create(e,r,i)}return null}static create(e,t,n){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==X_)throw new Error("Version 0 CID must use dag-pb (code: ".concat(X_,") block encoding"));return new W_(e,t,n,n.bytes);case 1:{const r=eI(e,t,n.bytes);return new W_(e,t,n,r)}default:throw new Error("Invalid version")}}static createV0(e){return W_.create(0,X_,e)}static createV1(e,t){return W_.create(1,e,t)}static decode(e){const[t,n]=W_.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=W_.inspectBytes(e),n=t.size-t.multihashSize,r=SS(e.subarray(n,n+t.multihashSize));if(r.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=r.subarray(t.multihashSize-t.digestSize),o=new M_(t.multihashCode,t.digestSize,i,r);return[0===t.version?W_.createV0(o):W_.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[n,r]=D_(e.subarray(t));return t+=r,n};let r=n(),i=X_;if(18===r?(r=0,t=0):i=n(),0!==r&&1!==r)throw new RangeError("Invalid CID version ".concat(r));const o=t,s=n(),a=n(),c=t+a;return{version:r,codec:i,multihashCode:s,digestSize:a,multihashSize:c-o,size:c}}static parse(e,t){const[n,r]=Q_(e,t),i=W_.decode(r);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return G_(i).set(n,e),i}}const Q_=(e,t)=>{switch(e[0]){case"Q":{const n=t||DS;return[DS.prefix,n.decode("".concat(DS.prefix).concat(e))]}case DS.prefix:{const n=t||DS;return[DS.prefix,n.decode(e)]}case ZS.prefix:{const n=t||ZS;return[ZS.prefix,n.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},Y_=(e,t,n)=>{const{prefix:r}=n;if(r!==DS.prefix)throw Error("Cannot string encode V0 in ".concat(n.name," encoding"));const i=t.get(r);if(null==i){const i=n.encode(e).slice(1);return t.set(r,i),i}return i},J_=(e,t,n)=>{const{prefix:r}=n,i=t.get(r);if(null==i){const i=n.encode(e);return t.set(r,i),i}return i},X_=112,$_=18,eI=(e,t,n)=>{const r=N_(e),i=r+N_(t),o=new Uint8Array(i+n.byteLength);return O_(e,o,0),O_(t,o,r),o.set(n,i),o},tI=Symbol.for("@ipld/js-cid/CID"),nI={...ue,...ie,...le,...ne,...re,...se,...ae,...te,...ce,...oe},rI=Symbol.for("nodejs.util.inspect.custom"),iI=Object.values(nI).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)),nI.identity.decoder),oI=114,sI=36,aI=37;class cI{constructor(e){(0,Yo.Z)(this,"type",void 0),(0,Yo.Z)(this,"multihash",void 0),(0,Yo.Z)(this,"privateKey",void 0),(0,Yo.Z)(this,"publicKey",void 0),(0,Yo.Z)(this,"string",void 0),(0,Yo.Z)(this,fu.Cs,!0),this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return"PeerId(".concat(this.toString(),")")}toString(){return null==this.string&&(this.string=DS.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return W_.createV1(oI,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){var t;if(e instanceof Uint8Array)return(0,Ms.f)(this.multihash.bytes,e);if("string"===typeof e)return dI(e).equals(this);if(null!=(null===e||void 0===e||null===(t=e.multihash)||void 0===t?void 0:t.bytes))return(0,Ms.f)(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[rI](){return"PeerId(".concat(this.toString(),")")}}class lI extends cI{constructor(e){super({...e,type:"RSA"}),(0,Yo.Z)(this,"type","RSA"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.publicKey}}class uI extends cI{constructor(e){super({...e,type:"Ed25519"}),(0,Yo.Z)(this,"type","Ed25519"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.multihash.digest}}class hI extends cI{constructor(e){super({...e,type:"secp256k1"}),(0,Yo.Z)(this,"type","secp256k1"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.multihash.digest}}function dI(e,t){var n;if(t=null!==(n=t)&&void 0!==n?n:iI,"1"===e.charAt(0)||"Q"===e.charAt(0)){const t=L_(DS.decode("z".concat(e)));return e.startsWith("12D")?new uI({multihash:t}):e.startsWith("16U")?new hI({multihash:t}):new lI({multihash:t})}return fI(iI.decode(e))}function fI(e){try{const t=L_(e);if(t.code===F_.code){if(t.digest.length===sI)return new uI({multihash:t});if(t.digest.length===aI)return new hI({multihash:t})}if(t.code===z_.code)return new lI({multihash:t})}catch{return function(e){if(null==e||null==e.multihash||null==e.version||1===e.version&&e.code!==oI)throw new Error("Supplied PeerID CID is invalid");const t=e.multihash;if(t.code===z_.code)return new lI({multihash:e.multihash});if(t.code===F_.code){if(t.digest.length===sI)return new uI({multihash:e.multihash});if(t.digest.length===aI)return new hI({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}(W_.decode(e))}throw new Error("Supplied PeerID CID is invalid")}var pI=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==n[s])throw new TypeError(o+" is ambiguous");n[s]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var r=0,i=0;e[t]===c;)r++,t++;for(var o=(e.length-t)*l+1>>>0,s=new Uint8Array(o);e[t];){var u=n[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=o-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*s[d]>>>0,s[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=o-i;f!==o&&0===s[f];)f++;for(var p=new Uint8Array(r+(o-f)),g=r;f!==o;)p[g++]=s[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,o=t.length;i!==o&&0===t[i];)i++,n++;for(var s=(o-i)*u+1>>>0,l=new Uint8Array(s);i!==o;){for(var h=t[i],d=0,f=s-1;(0!==h||d<r)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");r=d,i++}for(var p=s-r;p!==s&&0===l[p];)p++;for(var g=c.repeat(n);p<s;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:h,decode:function(e){var n=h(e);if(n)return n;throw new Error("Non-".concat(t," character"))}}};const gI=pI,yI=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class mI{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(e));throw Error("Unknown type, must be binary type")}}class vI{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(e),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return wI(this,e)}}class bI{constructor(e){this.decoders=e}or(e){return wI(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(e),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}}const wI=(e,t)=>new bI({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class EI{constructor(e,t,n,r){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=r,this.encoder=new mI(e,t,n),this.decoder=new vI(e,t,r)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const AI=e=>{let{name:t,prefix:n,encode:r,decode:i}=e;return new EI(t,n,r,i)},SI=e=>{let{prefix:t,name:n,alphabet:r}=e;const{encode:i,decode:o}=gI(r,n);return AI({prefix:t,name:n,encode:i,decode:e=>yI(o(e))})},_I=e=>{let{name:t,prefix:n,bitsPerChar:r,alphabet:i}=e;return AI({prefix:n,name:t,encode:e=>((e,t,n)=>{const r="="===t[t.length-1],i=(1<<n)-1;let o="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>n;)s-=n,o+=t[i&a>>s];if(s&&(o+=t[i&a<<n-s]),r)for(;o.length*n&7;)o+="=";return o})(e,i,r),decode:e=>((e,t,n,r)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*n/8|0);let a=0,c=0,l=0;for(let u=0;u<o;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError("Non-".concat(r," character"));c=c<<n|t,a+=n,a>=8&&(a-=8,s[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s})(e,i,r,t)})},II=SI({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),CI=SI({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var TI=function e(t,n,r){n=n||[];var i=r=r||0;for(;t>=xI;)n[r++]=255&t|kI,t/=128;for(;t&RI;)n[r++]=255&t|kI,t>>>=7;return n[r]=0|t,e.bytes=r-i+1,n},kI=128,RI=-128,xI=Math.pow(2,31);var PI=function e(t,n){var r,i=0,o=0,s=n=n||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");r=t[s++],i+=o<28?(r&OI)<<o:(r&OI)*Math.pow(2,o),o+=7}while(r>=DI);return e.bytes=s-n,i},DI=128,OI=127;var NI=Math.pow(2,7),BI=Math.pow(2,14),LI=Math.pow(2,21),MI=Math.pow(2,28),UI=Math.pow(2,35),FI=Math.pow(2,42),KI=Math.pow(2,49),jI=Math.pow(2,56),ZI=Math.pow(2,63);const zI={encode:TI,decode:PI,encodingLength:function(e){return e<NI?1:e<BI?2:e<LI?3:e<MI?4:e<UI?5:e<FI?6:e<KI?7:e<jI?8:e<ZI?9:10}},VI=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return[zI.decode(e,t),zI.decode.bytes]},HI=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return zI.encode(e,t,n),t},qI=e=>zI.encodingLength(e),GI=(e,t)=>{const n=t.byteLength,r=qI(e),i=r+qI(n),o=new Uint8Array(i+n);return HI(e,o,0),HI(n,o,r),o.set(t,i),new QI(e,n,t,o)},WI=e=>{const t=yI(e),[n,r]=VI(t),[i,o]=VI(t.subarray(r)),s=t.subarray(r+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new QI(n,i,s,t)};class QI{constructor(e,t,n,r){this.code=e,this.size=t,this.digest=n,this.bytes=r}}const YI=yI,JI={code:0,name:"identity",encode:YI,digest:e=>GI(0,YI(e))},XI=e=>{let{name:t,code:n,encode:r}=e;return new $I(t,n,r)};class $I{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?GI(this.code,t):t.then((e=>GI(this.code,e)))}throw Error("Unknown type, must be binary type")}}const eC=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),tC=XI({name:"sha2-256",code:18,encode:eC("SHA-256")}),nC=XI({name:"sha2-512",code:19,encode:eC("SHA-512")});function rC(e,t){let n=Uint8Array.from(e.abs().toByteArray());if(n=0===n[0]?n.subarray(1):n,null!=t){if(n.length>t)throw new Error("byte array longer than desired length");n=(0,Ls.z)([new Uint8Array(t-n.length),n])}return(0,Au.B)(n,"base64url")}function iC(e){const t=function(e,t){let n=(0,yu.m)(e,"base64urlpad");if(null!=t){if(n.length>t)throw new Error("byte array longer than desired length");n=(0,Ls.z)([new Uint8Array(t-n.length),n])}return n}(e);return new(gu().jsbn.BigInteger)((0,Au.B)(t,"base16"),16)}function oC(e){return null!=e&&("function"===typeof e.then&&"function"===typeof e.catch&&"function"===typeof e.finally)}const sC=32,aC=64,cC=32;function lC(e,t){const n=new Uint8Array(aC);for(let r=0;r<cC;r++)n[r]=e[r],n[cC+r]=t[r];return n}const uC=_I({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),hC=_I({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),dC=_I({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),fC=_I({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),pC={get(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:globalThis).crypto;if(null==e||null==e.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p/blob/main/packages/crypto/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}},gC={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};async function yC(e,t){const n=function(e){var t,n,r,i,o,s;const a=null!==(t=null===e||void 0===e?void 0:e.algorithm)&&void 0!==t?t:"AES-GCM";let c=null!==(n=null===e||void 0===e?void 0:e.keyLength)&&void 0!==n?n:16;const l=null!==(r=null===e||void 0===e?void 0:e.nonceLength)&&void 0!==r?r:12,u=null!==(i=null===e||void 0===e?void 0:e.digest)&&void 0!==i?i:"SHA-256",h=null!==(o=null===e||void 0===e?void 0:e.saltLength)&&void 0!==o?o:16,d=null!==(s=null===e||void 0===e?void 0:e.iterations)&&void 0!==s?s:32767,f=pC.get();return c*=8,{encrypt:async function(e,t){const n=f.getRandomValues(new Uint8Array(h)),r=f.getRandomValues(new Uint8Array(l)),i={name:a,iv:r};let o;if("string"===typeof t&&(t=(0,yu.m)(t)),0===t.length){o=await f.subtle.importKey("jwk",gC,{name:"AES-GCM"},!0,["encrypt"]);try{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);o=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["encrypt"])}catch{o=await f.subtle.importKey("jwk",gC,{name:"AES-GCM"},!0,["encrypt"])}}else{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);o=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["encrypt"])}const s=await f.subtle.encrypt(i,o,e);return(0,Ls.z)([n,i.iv,new Uint8Array(s)])},decrypt:async function(e,t){const n=e.subarray(0,h),r=e.subarray(h,h+l),i=e.subarray(h+l),o={name:a,iv:r};let s;if("string"===typeof t&&(t=(0,yu.m)(t)),0===t.length)try{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);s=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["decrypt"])}catch{s=await f.subtle.importKey("jwk",gC,{name:"AES-GCM"},!0,["decrypt"])}else{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);s=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["decrypt"])}const p=await f.subtle.decrypt(o,s,i);return new Uint8Array(p)}}}(),r=await n.encrypt(e,t);return uC.encode(r)}var mC,vC,bC,wC;!function(e){e.RSA="RSA",e.Ed25519="Ed25519",e.Secp256k1="Secp256k1"}(mC||(mC={})),function(e){e[e.RSA=0]="RSA",e[e.Ed25519=1]="Ed25519",e[e.Secp256k1=2]="Secp256k1"}(vC||(vC={})),function(e){e.codec=()=>bs(vC)}(mC||(mC={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),mC.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.Type=mC.codec().decode(e);break;case 2:n.Data=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(bC||(bC={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),mC.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.Type=mC.codec().decode(e);break;case 2:n.Data=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(wC||(wC={}));class EC{constructor(e){(0,Yo.Z)(this,"_key",void 0),this._key=TC(e,sC)}verify(e,t){return function(e,t,n){return ql.verify(t,n instanceof Uint8Array?n:n.subarray(),e)}(this._key,t,e)}marshal(){return this._key}get bytes(){return bC.encode({Type:mC.Ed25519,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}hash(){const e=tC.digest(this.bytes);return oC(e)?e.then((e=>{let{bytes:t}=e;return t})):e.bytes}}class AC{constructor(e,t){(0,Yo.Z)(this,"_key",void 0),(0,Yo.Z)(this,"_publicKey",void 0),this._key=TC(e,aC),this._publicKey=TC(t,sC)}sign(e){return function(e,t){const n=e.subarray(0,cC);return ql.sign(t instanceof Uint8Array?t:t.subarray(),n)}(this._key,e)}get public(){return new EC(this._publicKey)}marshal(){return this._key}get bytes(){return wC.encode({Type:mC.Ed25519,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const e=tC.digest(this.bytes);let t;return oC(e)?({bytes:t}=await e):t=e.bytes,t}async id(){const e=JI.digest(this.public.bytes);return II.encode(e.bytes).substring(1)}async export(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"libp2p-key";if("libp2p-key"===t)return yC(this.bytes,e);throw new fu.sv("export format '".concat(t,"' is not supported"),"ERR_INVALID_EXPORT_FORMAT")}}function SC(e){if(e.length>aC){const t=(e=TC(e,aC+sC)).subarray(0,aC),n=e.subarray(aC,e.length);return new AC(t,n)}const t=(e=TC(e,aC)).subarray(0,aC),n=e.subarray(sC);return new AC(t,n)}function _C(e){return e=TC(e,sC),new EC(e)}async function IC(){const{privateKey:e,publicKey:t}=function(){const e=ql.utils.randomPrivateKey(),t=ql.getPublicKey(e);return{privateKey:lC(e,t),publicKey:t}}();return new AC(e,t)}async function CC(e){const{privateKey:t,publicKey:n}=function(e){if(e.length!==cC)throw new TypeError('"seed" must be 32 bytes in length.');if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');const t=e,n=ql.getPublicKey(t);return{privateKey:lC(t,n),publicKey:n}}(e);return new AC(t,n)}function TC(e,t){var n;if((e=Uint8Array.from(null!==(n=e)&&void 0!==n?n:[])).length!==t)throw new fu.sv("Key must be a Uint8Array of length ".concat(t,", got ").concat(e.length),"ERR_INVALID_KEY_TYPE");return e}const kC={"P-256":256,"P-384":384,"P-521":521};Object.keys(kC).join(" / ");function RC(e,t){return t.map((t=>iC(e[t])))}async function xC(e){const t=[await pC.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await DC(e)],n=await PC({privateKey:t[0],publicKey:t[1]});return{privateKey:n[0],publicKey:n[1]}}async function PC(e){if(null==e.privateKey||null==e.publicKey)throw new fu.sv("Private and public key are required","ERR_INVALID_PARAMETERS");return Promise.all([pC.get().subtle.exportKey("jwk",e.privateKey),pC.get().subtle.exportKey("jwk",e.publicKey)])}async function DC(e){return pC.get().subtle.importKey("jwk",{kty:e.kty,n:e.n,e:e.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function OC(e,t,n,r){const i=t?function(e){return gu().pki.setRsaPublicKey(...RC(e,["n","e"]))}(e):function(e){return gu().pki.setRsaPrivateKey(...RC(e,["n","e","d","p","q","dp","dq","qi"]))}(e),o=r((0,Au.B)(n instanceof Uint8Array?n:n.subarray(),"ascii"),i);return(0,yu.m)(o,"ascii")}function NC(e){if("RSA"!==e.kty)throw new fu.sv("invalid key type","ERR_INVALID_KEY_TYPE");if(null==e.n)throw new fu.sv("invalid key modulus","ERR_INVALID_KEY_MODULUS");return 8*(0,yu.m)(e.n,"base64url").length}const BC=8192;class LC{constructor(e){(0,Yo.Z)(this,"_key",void 0),this._key=e}verify(e,t){return async function(e,t,n){const r=await pC.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return pC.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},r,t,n instanceof Uint8Array?n:n.subarray())}(this._key,t,e)}marshal(){return function(e){if(null==e.n||null==e.e)throw new fu.sv("JWK was missing components","ERR_INVALID_PARAMETERS");const t=gu().pki.publicKeyToAsn1({n:iC(e.n),e:iC(e.e)});return(0,yu.m)(gu().asn1.toDer(t).getBytes(),"ascii")}(this._key)}get bytes(){return bC.encode({Type:mC.RSA,Data:this.marshal()}).subarray()}encrypt(e){return OC(this._key,!0,e,((e,t)=>t.encrypt(e)))}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}hash(){const e=tC.digest(this.bytes);return oC(e)?e.then((e=>{let{bytes:t}=e;return t})):e.bytes}}class MC{constructor(e,t){(0,Yo.Z)(this,"_key",void 0),(0,Yo.Z)(this,"_publicKey",void 0),this._key=e,this._publicKey=t}genSecret(){return function(e){if(isNaN(e)||e<=0)throw new fu.sv("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return _c(e)}(16)}sign(e){return async function(e,t){const n=await pC.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),r=await pC.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},n,t instanceof Uint8Array?t:t.subarray());return new Uint8Array(r,0,r.byteLength)}(this._key,e)}get public(){if(null==this._publicKey)throw new fu.sv("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new LC(this._publicKey)}decrypt(e){return OC(this._key,!1,e,((e,t)=>t.decrypt(e)))}marshal(){return function(e){if(null==e.n||null==e.e||null==e.d||null==e.p||null==e.q||null==e.dp||null==e.dq||null==e.qi)throw new fu.sv("JWK was missing components","ERR_INVALID_PARAMETERS");const t=gu().pki.privateKeyToAsn1({n:iC(e.n),e:iC(e.e),d:iC(e.d),p:iC(e.p),q:iC(e.q),dP:iC(e.dp),dQ:iC(e.dq),qInv:iC(e.qi)});return(0,yu.m)(gu().asn1.toDer(t).getBytes(),"ascii")}(this._key)}get bytes(){return wC.encode({Type:mC.RSA,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}hash(){const e=tC.digest(this.bytes);return oC(e)?e.then((e=>{let{bytes:t}=e;return t})):e.bytes}async id(){const e=await this.public.hash();return(0,Au.B)(e,"base58btc")}async export(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"pkcs-8";if("pkcs-8"===t){const t=new(gu().util.ByteBuffer)(this.marshal()),n=gu().asn1.fromDer(t),r=gu().pki.privateKeyFromAsn1(n),i={algorithm:"aes256",count:1e4,saltSize:16,prfAlgorithm:"sha512"};return gu().pki.encryptRsaPrivateKey(r,e,i)}if("libp2p-key"===t)return yC(this.bytes,e);throw new fu.sv("export format '".concat(t,"' is not supported"),"ERR_INVALID_EXPORT_FORMAT")}}async function UC(e){const t=function(e){const t=gu().asn1.fromDer((0,Au.B)(e,"ascii")),n=gu().pki.privateKeyFromAsn1(t);return{kty:"RSA",n:rC(n.n),e:rC(n.e),d:rC(n.d),p:rC(n.p),q:rC(n.q),dp:rC(n.dP),dq:rC(n.dQ),qi:rC(n.qInv),alg:"RS256"}}(e);if(NC(t)>BC)throw new fu.sv("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const n=await xC(t);return new MC(n.privateKey,n.publicKey)}function FC(e){const t=function(e){const t=gu().asn1.fromDer((0,Au.B)(e,"ascii")),n=gu().pki.publicKeyFromAsn1(t);return{kty:"RSA",n:rC(n.n),e:rC(n.e)}}(e);if(NC(t)>BC)throw new fu.sv("key size is too large","ERR_KEY_SIZE_TOO_LARGE");return new LC(t)}async function KC(e){if(NC(e)>BC)throw new fu.sv("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const t=await xC(e);return new MC(t.privateKey,t.publicKey)}async function jC(e){if(e>BC)throw new fu.sv("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const t=await async function(e){const t=await pC.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),n=await PC(t);return{privateKey:n[0],publicKey:n[1]}}(e);return new MC(t.privateKey,t.publicKey)}function ZC(e){try{Eh.ProjectivePoint.fromHex(e)}catch(t){throw new fu.sv(String(t),"ERR_INVALID_PUBLIC_KEY")}}class zC{constructor(e){(0,Yo.Z)(this,"_key",void 0),ZC(e),this._key=e}verify(e,t){return function(e,t,n){const r=tC.digest(n instanceof Uint8Array?n:n.subarray());if(oC(r))return r.then((n=>{let{digest:r}=n;return Eh.verify(t,r,e)})).catch((e=>{throw new fu.sv(String(e),"ERR_INVALID_INPUT")}));try{return Eh.verify(t,r.digest,e)}catch(i){throw new fu.sv(String(i),"ERR_INVALID_INPUT")}}(this._key,t,e)}marshal(){return e=this._key,Eh.ProjectivePoint.fromHex(e).toRawBytes(!0);var e}get bytes(){return bC.encode({Type:mC.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const e=tC.digest(this.bytes);let t;return oC(e)?({bytes:t}=await e):t=e.bytes,t}}class VC{constructor(e,t){(0,Yo.Z)(this,"_key",void 0),(0,Yo.Z)(this,"_publicKey",void 0),this._key=e,this._publicKey=null!==t&&void 0!==t?t:function(e){try{return Eh.getPublicKey(e,!0)}catch(t){throw new fu.sv(String(t),"ERR_INVALID_PRIVATE_KEY")}}(e),function(e){try{Eh.getPublicKey(e,!0)}catch(t){throw new fu.sv(String(t),"ERR_INVALID_PRIVATE_KEY")}}(this._key),ZC(this._publicKey)}sign(e){return function(e,t){const n=tC.digest(t instanceof Uint8Array?t:t.subarray());if(oC(n))return n.then((t=>{let{digest:n}=t;return Eh.sign(n,e).toDERRawBytes()})).catch((e=>{throw new fu.sv(String(e),"ERR_INVALID_INPUT")}));try{return Eh.sign(n.digest,e).toDERRawBytes()}catch(r){throw new fu.sv(String(r),"ERR_INVALID_INPUT")}}(this._key,e)}get public(){return new zC(this._publicKey)}marshal(){return this._key}get bytes(){return wC.encode({Type:mC.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}hash(){const e=tC.digest(this.bytes);return oC(e)?e.then((e=>{let{bytes:t}=e;return t})):e.bytes}async id(){const e=await this.public.hash();return(0,Au.B)(e,"base58btc")}async export(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"libp2p-key";if("libp2p-key"===t)return yC(this.bytes,e);throw new fu.sv("export format '".concat(t,"' is not supported"),"ERR_INVALID_EXPORT_FORMAT")}}function HC(e){return new VC(e)}function qC(e){return new zC(e)}async function GC(){const e=Eh.utils.randomPrivateKey();return new VC(e)}const WC={rsa:we,ed25519:be,secp256k1:Ee};function QC(e){const t=Object.keys(WC).join(" / ");return new fu.sv("invalid or unsupported key type ".concat(e,". Must be ").concat(t),"ERR_UNSUPPORTED_KEY_TYPE")}async function YC(e){var t,n;const r=wC.decode(e),i=null!==(t=r.Data)&&void 0!==t?t:new Uint8Array;switch(r.Type){case mC.RSA:return WC.rsa.unmarshalRsaPrivateKey(i);case mC.Ed25519:return WC.ed25519.unmarshalEd25519PrivateKey(i);case mC.Secp256k1:return WC.secp256k1.unmarshalSecp256k1PrivateKey(i);default:throw QC(null!==(n=r.Type)&&void 0!==n?n:"RSA")}}const JC=SI({prefix:"9",name:"base10",alphabet:"0123456789"}),XC=_I({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),$C=_I({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),eT=_I({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),tT=Array.from("\ud83d\ude80\ud83e\ude90\u2604\ud83d\udef0\ud83c\udf0c\ud83c\udf11\ud83c\udf12\ud83c\udf13\ud83c\udf14\ud83c\udf15\ud83c\udf16\ud83c\udf17\ud83c\udf18\ud83c\udf0d\ud83c\udf0f\ud83c\udf0e\ud83d\udc09\u2600\ud83d\udcbb\ud83d\udda5\ud83d\udcbe\ud83d\udcbf\ud83d\ude02\u2764\ud83d\ude0d\ud83e\udd23\ud83d\ude0a\ud83d\ude4f\ud83d\udc95\ud83d\ude2d\ud83d\ude18\ud83d\udc4d\ud83d\ude05\ud83d\udc4f\ud83d\ude01\ud83d\udd25\ud83e\udd70\ud83d\udc94\ud83d\udc96\ud83d\udc99\ud83d\ude22\ud83e\udd14\ud83d\ude06\ud83d\ude44\ud83d\udcaa\ud83d\ude09\u263a\ud83d\udc4c\ud83e\udd17\ud83d\udc9c\ud83d\ude14\ud83d\ude0e\ud83d\ude07\ud83c\udf39\ud83e\udd26\ud83c\udf89\ud83d\udc9e\u270c\u2728\ud83e\udd37\ud83d\ude31\ud83d\ude0c\ud83c\udf38\ud83d\ude4c\ud83d\ude0b\ud83d\udc97\ud83d\udc9a\ud83d\ude0f\ud83d\udc9b\ud83d\ude42\ud83d\udc93\ud83e\udd29\ud83d\ude04\ud83d\ude00\ud83d\udda4\ud83d\ude03\ud83d\udcaf\ud83d\ude48\ud83d\udc47\ud83c\udfb6\ud83d\ude12\ud83e\udd2d\u2763\ud83d\ude1c\ud83d\udc8b\ud83d\udc40\ud83d\ude2a\ud83d\ude11\ud83d\udca5\ud83d\ude4b\ud83d\ude1e\ud83d\ude29\ud83d\ude21\ud83e\udd2a\ud83d\udc4a\ud83e\udd73\ud83d\ude25\ud83e\udd24\ud83d\udc49\ud83d\udc83\ud83d\ude33\u270b\ud83d\ude1a\ud83d\ude1d\ud83d\ude34\ud83c\udf1f\ud83d\ude2c\ud83d\ude43\ud83c\udf40\ud83c\udf37\ud83d\ude3b\ud83d\ude13\u2b50\u2705\ud83e\udd7a\ud83c\udf08\ud83d\ude08\ud83e\udd18\ud83d\udca6\u2714\ud83d\ude23\ud83c\udfc3\ud83d\udc90\u2639\ud83c\udf8a\ud83d\udc98\ud83d\ude20\u261d\ud83d\ude15\ud83c\udf3a\ud83c\udf82\ud83c\udf3b\ud83d\ude10\ud83d\udd95\ud83d\udc9d\ud83d\ude4a\ud83d\ude39\ud83d\udde3\ud83d\udcab\ud83d\udc80\ud83d\udc51\ud83c\udfb5\ud83e\udd1e\ud83d\ude1b\ud83d\udd34\ud83d\ude24\ud83c\udf3c\ud83d\ude2b\u26bd\ud83e\udd19\u2615\ud83c\udfc6\ud83e\udd2b\ud83d\udc48\ud83d\ude2e\ud83d\ude46\ud83c\udf7b\ud83c\udf43\ud83d\udc36\ud83d\udc81\ud83d\ude32\ud83c\udf3f\ud83e\udde1\ud83c\udf81\u26a1\ud83c\udf1e\ud83c\udf88\u274c\u270a\ud83d\udc4b\ud83d\ude30\ud83e\udd28\ud83d\ude36\ud83e\udd1d\ud83d\udeb6\ud83d\udcb0\ud83c\udf53\ud83d\udca2\ud83e\udd1f\ud83d\ude41\ud83d\udea8\ud83d\udca8\ud83e\udd2c\u2708\ud83c\udf80\ud83c\udf7a\ud83e\udd13\ud83d\ude19\ud83d\udc9f\ud83c\udf31\ud83d\ude16\ud83d\udc76\ud83e\udd74\u25b6\u27a1\u2753\ud83d\udc8e\ud83d\udcb8\u2b07\ud83d\ude28\ud83c\udf1a\ud83e\udd8b\ud83d\ude37\ud83d\udd7a\u26a0\ud83d\ude45\ud83d\ude1f\ud83d\ude35\ud83d\udc4e\ud83e\udd32\ud83e\udd20\ud83e\udd27\ud83d\udccc\ud83d\udd35\ud83d\udc85\ud83e\uddd0\ud83d\udc3e\ud83c\udf52\ud83d\ude17\ud83e\udd11\ud83c\udf0a\ud83e\udd2f\ud83d\udc37\u260e\ud83d\udca7\ud83d\ude2f\ud83d\udc86\ud83d\udc46\ud83c\udfa4\ud83d\ude47\ud83c\udf51\u2744\ud83c\udf34\ud83d\udca3\ud83d\udc38\ud83d\udc8c\ud83d\udccd\ud83e\udd40\ud83e\udd22\ud83d\udc45\ud83d\udca1\ud83d\udca9\ud83d\udc50\ud83d\udcf8\ud83d\udc7b\ud83e\udd10\ud83e\udd2e\ud83c\udfbc\ud83e\udd75\ud83d\udea9\ud83c\udf4e\ud83c\udf4a\ud83d\udc7c\ud83d\udc8d\ud83d\udce3\ud83e\udd42"),nT=tT.reduce(((e,t,n)=>(e[n]=t,e)),[]),rT=tT.reduce(((e,t,n)=>(e[t.codePointAt(0)]=n,e)),[]);const iT=AI({prefix:"\ud83d\ude80",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=nT[t]),"")},decode:function(e){const t=[];for(const n of e){const e=rT[n.codePointAt(0)];if(void 0===e)throw new Error("Non-base256emoji character: ".concat(n));t.push(e)}return new Uint8Array(t)}}),oT=_I({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),sT=_I({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),aT=_I({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),cT=_I({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),lT=_I({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),uT=_I({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),hT=_I({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),dT=_I({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),fT=_I({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),pT=SI({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),gT=SI({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),yT=_I({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),mT=AI({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),vT=new TextEncoder,bT=new TextDecoder,wT="json",ET=512,AT=e=>vT.encode(JSON.stringify(e)),ST=e=>JSON.parse(bT.decode(e)),_T="raw",IT=85,CT=e=>yI(e),TT=e=>yI(e),kT=(e,t)=>{const{bytes:n,version:r}=e;return 0===r?OT(n,xT(e),t||II.encoder):NT(n,xT(e),t||oT.encoder)},RT=new WeakMap,xT=e=>{const t=RT.get(e);if(null==t){const t=new Map;return RT.set(e,t),t}return t};class PT{constructor(e,t,n,r){this.code=t,this.version=e,this.multihash=n,this.bytes=r,this["/"]=r}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==BT)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==LT)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return PT.createV0(t)}default:throw Error("Can not convert CID version ".concat(this.version," to version 0. This is a bug please report"))}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=GI(e,t);return PT.createV1(this.code,n)}case 1:return this;default:throw Error("Can not convert CID version ".concat(this.version," to version 1. This is a bug please report"))}}equals(e){return PT.equals(this,e)}static equals(e,t){const n=t;return n&&e.code===n.code&&e.version===n.version&&((e,t)=>{if(e===t)return!0;{const n=t;return e.code===n.code&&e.size===n.size&&n.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0})(e.bytes,n.bytes)}})(e.multihash,n.multihash)}toString(e){return kT(this,e)}toJSON(){return{"/":kT(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID(".concat(this.toString(),")")}static asCID(e){if(null==e)return null;const t=e;if(t instanceof PT)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:n,multihash:r,bytes:i}=t;return new PT(e,n,r,i||MT(e,n,r.bytes))}if(!0===t[UT]){const{version:e,multihash:n,code:r}=t,i=WI(n);return PT.create(e,r,i)}return null}static create(e,t,n){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==BT)throw new Error("Version 0 CID must use dag-pb (code: ".concat(BT,") block encoding"));return new PT(e,t,n,n.bytes);case 1:{const r=MT(e,t,n.bytes);return new PT(e,t,n,r)}default:throw new Error("Invalid version")}}static createV0(e){return PT.create(0,BT,e)}static createV1(e,t){return PT.create(1,e,t)}static decode(e){const[t,n]=PT.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=PT.inspectBytes(e),n=t.size-t.multihashSize,r=yI(e.subarray(n,n+t.multihashSize));if(r.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=r.subarray(t.multihashSize-t.digestSize),o=new QI(t.multihashCode,t.digestSize,i,r);return[0===t.version?PT.createV0(o):PT.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[n,r]=VI(e.subarray(t));return t+=r,n};let r=n(),i=BT;if(18===r?(r=0,t=0):i=n(),0!==r&&1!==r)throw new RangeError("Invalid CID version ".concat(r));const o=t,s=n(),a=n(),c=t+a;return{version:r,codec:i,multihashCode:s,digestSize:a,multihashSize:c-o,size:c}}static parse(e,t){const[n,r]=DT(e,t),i=PT.decode(r);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return xT(i).set(n,e),i}}const DT=(e,t)=>{switch(e[0]){case"Q":{const n=t||II;return[II.prefix,n.decode("".concat(II.prefix).concat(e))]}case II.prefix:{const n=t||II;return[II.prefix,n.decode(e)]}case oT.prefix:{const n=t||oT;return[oT.prefix,n.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},OT=(e,t,n)=>{const{prefix:r}=n;if(r!==II.prefix)throw Error("Cannot string encode V0 in ".concat(n.name," encoding"));const i=t.get(r);if(null==i){const i=n.encode(e).slice(1);return t.set(r,i),i}return i},NT=(e,t,n)=>{const{prefix:r}=n,i=t.get(r);if(null==i){const i=n.encode(e);return t.set(r,i),i}return i},BT=112,LT=18,MT=(e,t,n)=>{const r=qI(e),i=r+qI(t),o=new Uint8Array(i+n.byteLength);return HI(e,o,0),HI(t,o,r),o.set(n,i),o},UT=Symbol.for("@ipld/js-cid/CID"),FT={...Re,..._e,...ke,...Ae,...Se,...Ce,...Te,...ge,...ve,...Ie},KT=Symbol.for("nodejs.util.inspect.custom"),jT=Object.values(FT).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)),FT.identity.decoder),ZT=114,zT=36,VT=37;class HT{constructor(e){(0,Yo.Z)(this,"type",void 0),(0,Yo.Z)(this,"multihash",void 0),(0,Yo.Z)(this,"privateKey",void 0),(0,Yo.Z)(this,"publicKey",void 0),(0,Yo.Z)(this,"string",void 0),(0,Yo.Z)(this,fu.Cs,!0),this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return"PeerId(".concat(this.toString(),")")}toString(){return null==this.string&&(this.string=II.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return PT.createV1(ZT,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){var t;if(e instanceof Uint8Array)return(0,Ms.f)(this.multihash.bytes,e);if("string"===typeof e)return function(e,t){var n;if(t=null!==(n=t)&&void 0!==n?n:jT,"1"===e.charAt(0)||"Q"===e.charAt(0)){const t=WI(II.decode("z".concat(e)));return e.startsWith("12D")?new GT({multihash:t}):e.startsWith("16U")?new WT({multihash:t}):new qT({multihash:t})}return QT(jT.decode(e))}(e).equals(this);if(null!=(null===e||void 0===e||null===(t=e.multihash)||void 0===t?void 0:t.bytes))return(0,Ms.f)(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[KT](){return"PeerId(".concat(this.toString(),")")}}class qT extends HT{constructor(e){super({...e,type:"RSA"}),(0,Yo.Z)(this,"type","RSA"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.publicKey}}class GT extends HT{constructor(e){super({...e,type:"Ed25519"}),(0,Yo.Z)(this,"type","Ed25519"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.multihash.digest}}class WT extends HT{constructor(e){super({...e,type:"secp256k1"}),(0,Yo.Z)(this,"type","secp256k1"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.multihash.digest}}function QT(e){try{const t=WI(e);if(t.code===JI.code){if(t.digest.length===zT)return new GT({multihash:t});if(t.digest.length===VT)return new WT({multihash:t})}if(t.code===tC.code)return new qT({multihash:t})}catch{return function(e){if(null==e||null==e.multihash||null==e.version||1===e.version&&e.code!==ZT)throw new Error("Supplied PeerID CID is invalid");const t=e.multihash;if(t.code===tC.code)return new qT({multihash:e.multihash});if(t.code===JI.code){if(t.digest.length===zT)return new GT({multihash:e.multihash});if(t.digest.length===VT)return new WT({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}(PT.decode(e))}throw new Error("Supplied PeerID CID is invalid")}const YT="ERR_SIGNATURE_NOT_VALID";var JT;!function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.publicKey&&e.publicKey.byteLength>0&&(t.uint32(10),t.bytes(e.publicKey)),null!=e.payloadType&&e.payloadType.byteLength>0&&(t.uint32(18),t.bytes(e.payloadType)),null!=e.payload&&e.payload.byteLength>0&&(t.uint32(26),t.bytes(e.payload)),null!=e.signature&&e.signature.byteLength>0&&(t.uint32(42),t.bytes(e.signature)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={publicKey:new Uint8Array(0),payloadType:new Uint8Array(0),payload:new Uint8Array(0),signature:new Uint8Array(0)},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.publicKey=e.bytes();break;case 2:n.payloadType=e.bytes();break;case 3:n.payload=e.bytes();break;case 5:n.signature=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(JT||(JT={}));class XT{constructor(e){(0,Yo.Z)(this,"peerId",void 0),(0,Yo.Z)(this,"payloadType",void 0),(0,Yo.Z)(this,"payload",void 0),(0,Yo.Z)(this,"signature",void 0),(0,Yo.Z)(this,"marshaled",void 0);const{peerId:t,payloadType:n,payload:r,signature:i}=e;this.peerId=t,this.payloadType=n,this.payload=r,this.signature=i}marshal(){if(null==this.peerId.publicKey)throw new Error("Missing public key");return null==this.marshaled&&(this.marshaled=JT.encode({publicKey:this.peerId.publicKey,payloadType:this.payloadType,payload:this.payload.subarray(),signature:this.signature})),this.marshaled}equals(e){return(0,Ms.f)(this.marshal(),e.marshal())}async validate(e){const t=$T(e,this.payloadType,this.payload);if(null==this.peerId.publicKey)throw new Error("Missing public key");const n=function(e){var t,n;const r=bC.decode(e),i=null!==(t=r.Data)&&void 0!==t?t:new Uint8Array;switch(r.Type){case mC.RSA:return WC.rsa.unmarshalRsaPublicKey(i);case mC.Ed25519:return WC.ed25519.unmarshalEd25519PublicKey(i);case mC.Secp256k1:return WC.secp256k1.unmarshalSecp256k1PublicKey(i);default:throw QC(null!==(n=r.Type)&&void 0!==n?n:"unknown")}}(this.peerId.publicKey);return n.verify(t.subarray(),this.signature)}}(0,Yo.Z)(XT,"createFromProtobuf",(async e=>{const t=JT.decode(e),n=await async function(e,t){return e.length===zT?new GT({multihash:GI(JI.code,e),privateKey:t}):e.length===VT?new WT({multihash:GI(JI.code,e),privateKey:t}):new qT({multihash:await tC.digest(e),publicKey:e,privateKey:t})}(t.publicKey);return new XT({peerId:n,payloadType:t.payloadType,payload:t.payload,signature:t.signature})})),(0,Yo.Z)(XT,"seal",(async(e,t)=>{if(null==t.privateKey)throw new Error("Missing private key");const n=e.domain,r=e.codec,i=e.marshal(),o=$T(n,r,i),s=await YC(t.privateKey),a=await s.sign(o.subarray());return new XT({peerId:t,payloadType:r,payload:i,signature:a})})),(0,Yo.Z)(XT,"openAndCertify",(async(e,t)=>{const n=await XT.createFromProtobuf(e);if(!await n.validate(t))throw new fu.sv("envelope signature is not valid for the given domain",YT);return n}));const $T=(e,t,n)=>{const r=(0,yu.m)(e),i=Bs.cv(r.byteLength),o=Bs.cv(t.length),s=Bs.cv(n.length);return new Zs(i,r,o,t,s,n)};const ek=Uint8Array.from([3,1]);var tk;!function(e){let t,n;!function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.multiaddr&&e.multiaddr.byteLength>0&&(t.uint32(10),t.bytes(e.multiaddr)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={multiaddr:new Uint8Array(0)},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();if(t>>>3===1)n.multiaddr=e.bytes();else e.skipType(7&t)}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(t=e.AddressInfo||(e.AddressInfo={})),e.codec=()=>(null==n&&(n=ws((function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==r.lengthDelimited&&n.fork(),null!=t.peerId&&t.peerId.byteLength>0&&(n.uint32(10),n.bytes(t.peerId)),null!=t.seq&&0n!==t.seq&&(n.uint32(16),n.uint64(t.seq)),null!=t.addresses)for(const i of t.addresses)n.uint32(26),e.AddressInfo.codec().encode(i,n);!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={peerId:new Uint8Array(0),seq:0n,addresses:[]},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.peerId=t.bytes();break;case 2:r.seq=t.uint64();break;case 3:r.addresses.push(e.AddressInfo.codec().decode(t,t.uint32()));break;default:t.skipType(7&n)}}return r}))),n),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(tk||(tk={}));class nk{constructor(e){(0,Yo.Z)(this,"peerId",void 0),(0,Yo.Z)(this,"multiaddrs",void 0),(0,Yo.Z)(this,"seqNumber",void 0),(0,Yo.Z)(this,"domain",nk.DOMAIN),(0,Yo.Z)(this,"codec",nk.CODEC),(0,Yo.Z)(this,"marshaled",void 0);const{peerId:t,multiaddrs:n,seqNumber:r}=e;this.peerId=t,this.multiaddrs=null!==n&&void 0!==n?n:[],this.seqNumber=null!==r&&void 0!==r?r:BigInt(Date.now())}marshal(){return null==this.marshaled&&(this.marshaled=tk.encode({peerId:this.peerId.toBytes(),seq:BigInt(this.seqNumber),addresses:this.multiaddrs.map((e=>({multiaddr:e.bytes})))})),this.marshaled}equals(e){return e instanceof nk&&(!!this.peerId.equals(e.peerId)&&(this.seqNumber===e.seqNumber&&!!function(e,t){const n=(e,t)=>e.toString().localeCompare(t.toString());return e.length===t.length&&(t.sort(n),e.sort(n).every(((e,n)=>t[n].equals(e))))}(this.multiaddrs,e.multiaddrs)))}}function rk(e,t){const n=la(e,t),r={read:async(e,t)=>{const r=await n.read(t);return e.decode(r)},write:async(e,t,r)=>{await n.write(t.encode(e),r)},writeV:async(e,t,r)=>{await n.writeV(e.map((e=>t.encode(e))),r)},pb:e=>({read:async t=>r.read(e,t),write:async(t,n)=>r.write(t,e,n),writeV:async(t,n)=>r.writeV(t,e,n),unwrap:()=>r}),unwrap:()=>n.unwrap()};return r}(0,Yo.Z)(nk,"createFromProtobuf",(e=>{var t;const n=tk.decode(e),r=QT(n.peerId),i=(null!==(t=n.addresses)&&void 0!==t?t:[]).map((e=>(0,ng.HM)(e.multiaddr))),o=n.seq;return new nk({peerId:r,multiaddrs:i,seqNumber:o})})),(0,Yo.Z)(nk,"DOMAIN","libp2p-peer-record"),(0,Yo.Z)(nk,"CODEC",ek);BigInt(1<<17);const ik="/libp2p/circuit/relay/0.2.0/hop",ok="/libp2p/circuit/relay/0.2.0/stop",sk="ERR_RELAYED_DIAL";var ak,ck,lk,uk,hk,dk,fk,pk;function gk(e){const t=e*BigInt(1e3),n=(new Date).getTime();return Number(t-BigInt(n))}!function(e){let t,n,r;!function(e){e.RESERVE="RESERVE",e.CONNECT="CONNECT",e.STATUS="STATUS"}(t=e.Type||(e.Type={})),function(e){e[e.RESERVE=0]="RESERVE",e[e.CONNECT=1]="CONNECT",e[e.STATUS=2]="STATUS"}(n||(n={})),function(e){e.codec=()=>bs(n)}(t=e.Type||(e.Type={})),e.codec=()=>(null==r&&(r=ws((function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==r.lengthDelimited&&n.fork(),null!=t.type&&(n.uint32(8),e.Type.codec().encode(t.type,n)),null!=t.peer&&(n.uint32(18),lk.codec().encode(t.peer,n)),null!=t.reservation&&(n.uint32(26),uk.codec().encode(t.reservation,n)),null!=t.limit&&(n.uint32(34),hk.codec().encode(t.limit,n)),null!=t.status&&(n.uint32(40),dk.codec().encode(t.status,n)),!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.type=e.Type.codec().decode(t);break;case 2:r.peer=lk.codec().decode(t,t.uint32());break;case 3:r.reservation=uk.codec().decode(t,t.uint32());break;case 4:r.limit=hk.codec().decode(t,t.uint32());break;case 5:r.status=dk.codec().decode(t);break;default:t.skipType(7&n)}}return r}))),r),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(ak||(ak={})),function(e){let t,n,r;!function(e){e.CONNECT="CONNECT",e.STATUS="STATUS"}(t=e.Type||(e.Type={})),function(e){e[e.CONNECT=0]="CONNECT",e[e.STATUS=1]="STATUS"}(n||(n={})),function(e){e.codec=()=>bs(n)}(t=e.Type||(e.Type={})),e.codec=()=>(null==r&&(r=ws((function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==r.lengthDelimited&&n.fork(),null!=t.type&&(n.uint32(8),e.Type.codec().encode(t.type,n)),null!=t.peer&&(n.uint32(18),lk.codec().encode(t.peer,n)),null!=t.limit&&(n.uint32(26),hk.codec().encode(t.limit,n)),null!=t.status&&(n.uint32(32),dk.codec().encode(t.status,n)),!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.type=e.Type.codec().decode(t);break;case 2:r.peer=lk.codec().decode(t,t.uint32());break;case 3:r.limit=hk.codec().decode(t,t.uint32());break;case 4:r.status=dk.codec().decode(t);break;default:t.skipType(7&n)}}return r}))),r),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(ck||(ck={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==n.lengthDelimited&&t.fork(),null!=e.id&&e.id.byteLength>0&&(t.uint32(10),t.bytes(e.id)),null!=e.addrs)for(const r of e.addrs)t.uint32(18),t.bytes(r);!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={id:new Uint8Array(0),addrs:[]},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.id=e.bytes();break;case 2:n.addrs.push(e.bytes());break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(lk||(lk={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==n.lengthDelimited&&t.fork(),null!=e.expire&&0n!==e.expire&&(t.uint32(8),t.uint64(e.expire)),null!=e.addrs)for(const r of e.addrs)t.uint32(18),t.bytes(r);null!=e.voucher&&(t.uint32(26),t.bytes(e.voucher)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={expire:0n,addrs:[]},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.expire=e.uint64();break;case 2:n.addrs.push(e.bytes());break;case 3:n.voucher=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(uk||(uk={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.duration&&(t.uint32(8),t.uint32(e.duration)),null!=e.data&&(t.uint32(16),t.uint64(e.data)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.duration=e.uint32();break;case 2:n.data=e.uint64();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(hk||(hk={})),function(e){e.UNUSED="UNUSED",e.OK="OK",e.RESERVATION_REFUSED="RESERVATION_REFUSED",e.RESOURCE_LIMIT_EXCEEDED="RESOURCE_LIMIT_EXCEEDED",e.PERMISSION_DENIED="PERMISSION_DENIED",e.CONNECTION_FAILED="CONNECTION_FAILED",e.NO_RESERVATION="NO_RESERVATION",e.MALFORMED_MESSAGE="MALFORMED_MESSAGE",e.UNEXPECTED_MESSAGE="UNEXPECTED_MESSAGE"}(dk||(dk={})),function(e){e[e.UNUSED=0]="UNUSED",e[e.OK=100]="OK",e[e.RESERVATION_REFUSED=200]="RESERVATION_REFUSED",e[e.RESOURCE_LIMIT_EXCEEDED=201]="RESOURCE_LIMIT_EXCEEDED",e[e.PERMISSION_DENIED=202]="PERMISSION_DENIED",e[e.CONNECTION_FAILED=203]="CONNECTION_FAILED",e[e.NO_RESERVATION=204]="NO_RESERVATION",e[e.MALFORMED_MESSAGE=400]="MALFORMED_MESSAGE",e[e.UNEXPECTED_MESSAGE=401]="UNEXPECTED_MESSAGE"}(fk||(fk={})),function(e){e.codec=()=>bs(fk)}(dk||(dk={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.relay&&e.relay.byteLength>0&&(t.uint32(10),t.bytes(e.relay)),null!=e.peer&&e.peer.byteLength>0&&(t.uint32(18),t.bytes(e.peer)),null!=e.expiration&&0n!==e.expiration&&(t.uint32(24),t.uint64(e.expiration)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={relay:new Uint8Array(0),peer:new Uint8Array(0),expiration:0n},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.relay=e.bytes();break;case 2:n.peer=e.bytes();break;case 3:n.expiration=e.uint64();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(pk||(pk={}));n(99158);Object.prototype.toString,new Set(["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Load failed","Network request failed","fetch failed"]);var yk=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==n[s])throw new TypeError(o+" is ambiguous");n[s]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var r=0,i=0;e[t]===c;)r++,t++;for(var o=(e.length-t)*l+1>>>0,s=new Uint8Array(o);e[t];){var u=n[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=o-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*s[d]>>>0,s[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=o-i;f!==o&&0===s[f];)f++;for(var p=new Uint8Array(r+(o-f)),g=r;f!==o;)p[g++]=s[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,o=t.length;i!==o&&0===t[i];)i++,n++;for(var s=(o-i)*u+1>>>0,l=new Uint8Array(s);i!==o;){for(var h=t[i],d=0,f=s-1;(0!==h||d<r)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");r=d,i++}for(var p=s-r;p!==s&&0===l[p];)p++;for(var g=c.repeat(n);p<s;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:h,decode:function(e){var n=h(e);if(n)return n;throw new Error("Non-".concat(t," character"))}}};const mk=yk,vk=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class bk{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(e));throw Error("Unknown type, must be binary type")}}class wk{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(e),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return Ak(this,e)}}class Ek{constructor(e){this.decoders=e}or(e){return Ak(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(e),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}}const Ak=(e,t)=>new Ek({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class Sk{constructor(e,t,n,r){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=r,this.encoder=new bk(e,t,n),this.decoder=new wk(e,t,r)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const _k=e=>{let{name:t,prefix:n,encode:r,decode:i}=e;return new Sk(t,n,r,i)},Ik=e=>{let{prefix:t,name:n,alphabet:r}=e;const{encode:i,decode:o}=mk(r,n);return _k({prefix:t,name:n,encode:i,decode:e=>vk(o(e))})},Ck=e=>{let{name:t,prefix:n,bitsPerChar:r,alphabet:i}=e;return _k({prefix:n,name:t,encode:e=>((e,t,n)=>{const r="="===t[t.length-1],i=(1<<n)-1;let o="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>n;)s-=n,o+=t[i&a>>s];if(s&&(o+=t[i&a<<n-s]),r)for(;o.length*n&7;)o+="=";return o})(e,i,r),decode:e=>((e,t,n,r)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*n/8|0);let a=0,c=0,l=0;for(let u=0;u<o;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError("Non-".concat(r," character"));c=c<<n|t,a+=n,a>=8&&(a-=8,s[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s})(e,i,r,t)})},Tk=Ik({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),kk=Ik({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Rk=Ik({prefix:"9",name:"base10",alphabet:"0123456789"}),xk=Ck({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Pk=Ck({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Dk=Ck({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Ok=Array.from("\ud83d\ude80\ud83e\ude90\u2604\ud83d\udef0\ud83c\udf0c\ud83c\udf11\ud83c\udf12\ud83c\udf13\ud83c\udf14\ud83c\udf15\ud83c\udf16\ud83c\udf17\ud83c\udf18\ud83c\udf0d\ud83c\udf0f\ud83c\udf0e\ud83d\udc09\u2600\ud83d\udcbb\ud83d\udda5\ud83d\udcbe\ud83d\udcbf\ud83d\ude02\u2764\ud83d\ude0d\ud83e\udd23\ud83d\ude0a\ud83d\ude4f\ud83d\udc95\ud83d\ude2d\ud83d\ude18\ud83d\udc4d\ud83d\ude05\ud83d\udc4f\ud83d\ude01\ud83d\udd25\ud83e\udd70\ud83d\udc94\ud83d\udc96\ud83d\udc99\ud83d\ude22\ud83e\udd14\ud83d\ude06\ud83d\ude44\ud83d\udcaa\ud83d\ude09\u263a\ud83d\udc4c\ud83e\udd17\ud83d\udc9c\ud83d\ude14\ud83d\ude0e\ud83d\ude07\ud83c\udf39\ud83e\udd26\ud83c\udf89\ud83d\udc9e\u270c\u2728\ud83e\udd37\ud83d\ude31\ud83d\ude0c\ud83c\udf38\ud83d\ude4c\ud83d\ude0b\ud83d\udc97\ud83d\udc9a\ud83d\ude0f\ud83d\udc9b\ud83d\ude42\ud83d\udc93\ud83e\udd29\ud83d\ude04\ud83d\ude00\ud83d\udda4\ud83d\ude03\ud83d\udcaf\ud83d\ude48\ud83d\udc47\ud83c\udfb6\ud83d\ude12\ud83e\udd2d\u2763\ud83d\ude1c\ud83d\udc8b\ud83d\udc40\ud83d\ude2a\ud83d\ude11\ud83d\udca5\ud83d\ude4b\ud83d\ude1e\ud83d\ude29\ud83d\ude21\ud83e\udd2a\ud83d\udc4a\ud83e\udd73\ud83d\ude25\ud83e\udd24\ud83d\udc49\ud83d\udc83\ud83d\ude33\u270b\ud83d\ude1a\ud83d\ude1d\ud83d\ude34\ud83c\udf1f\ud83d\ude2c\ud83d\ude43\ud83c\udf40\ud83c\udf37\ud83d\ude3b\ud83d\ude13\u2b50\u2705\ud83e\udd7a\ud83c\udf08\ud83d\ude08\ud83e\udd18\ud83d\udca6\u2714\ud83d\ude23\ud83c\udfc3\ud83d\udc90\u2639\ud83c\udf8a\ud83d\udc98\ud83d\ude20\u261d\ud83d\ude15\ud83c\udf3a\ud83c\udf82\ud83c\udf3b\ud83d\ude10\ud83d\udd95\ud83d\udc9d\ud83d\ude4a\ud83d\ude39\ud83d\udde3\ud83d\udcab\ud83d\udc80\ud83d\udc51\ud83c\udfb5\ud83e\udd1e\ud83d\ude1b\ud83d\udd34\ud83d\ude24\ud83c\udf3c\ud83d\ude2b\u26bd\ud83e\udd19\u2615\ud83c\udfc6\ud83e\udd2b\ud83d\udc48\ud83d\ude2e\ud83d\ude46\ud83c\udf7b\ud83c\udf43\ud83d\udc36\ud83d\udc81\ud83d\ude32\ud83c\udf3f\ud83e\udde1\ud83c\udf81\u26a1\ud83c\udf1e\ud83c\udf88\u274c\u270a\ud83d\udc4b\ud83d\ude30\ud83e\udd28\ud83d\ude36\ud83e\udd1d\ud83d\udeb6\ud83d\udcb0\ud83c\udf53\ud83d\udca2\ud83e\udd1f\ud83d\ude41\ud83d\udea8\ud83d\udca8\ud83e\udd2c\u2708\ud83c\udf80\ud83c\udf7a\ud83e\udd13\ud83d\ude19\ud83d\udc9f\ud83c\udf31\ud83d\ude16\ud83d\udc76\ud83e\udd74\u25b6\u27a1\u2753\ud83d\udc8e\ud83d\udcb8\u2b07\ud83d\ude28\ud83c\udf1a\ud83e\udd8b\ud83d\ude37\ud83d\udd7a\u26a0\ud83d\ude45\ud83d\ude1f\ud83d\ude35\ud83d\udc4e\ud83e\udd32\ud83e\udd20\ud83e\udd27\ud83d\udccc\ud83d\udd35\ud83d\udc85\ud83e\uddd0\ud83d\udc3e\ud83c\udf52\ud83d\ude17\ud83e\udd11\ud83c\udf0a\ud83e\udd2f\ud83d\udc37\u260e\ud83d\udca7\ud83d\ude2f\ud83d\udc86\ud83d\udc46\ud83c\udfa4\ud83d\ude47\ud83c\udf51\u2744\ud83c\udf34\ud83d\udca3\ud83d\udc38\ud83d\udc8c\ud83d\udccd\ud83e\udd40\ud83e\udd22\ud83d\udc45\ud83d\udca1\ud83d\udca9\ud83d\udc50\ud83d\udcf8\ud83d\udc7b\ud83e\udd10\ud83e\udd2e\ud83c\udfbc\ud83e\udd75\ud83d\udea9\ud83c\udf4e\ud83c\udf4a\ud83d\udc7c\ud83d\udc8d\ud83d\udce3\ud83e\udd42"),Nk=Ok.reduce(((e,t,n)=>(e[n]=t,e)),[]),Bk=Ok.reduce(((e,t,n)=>(e[t.codePointAt(0)]=n,e)),[]);const Lk=_k({prefix:"\ud83d\ude80",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=Nk[t]),"")},decode:function(e){const t=[];for(const n of e){const e=Bk[n.codePointAt(0)];if(void 0===e)throw new Error("Non-base256emoji character: ".concat(n));t.push(e)}return new Uint8Array(t)}}),Mk=Ck({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Uk=Ck({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Fk=Ck({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Kk=Ck({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),jk=Ck({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Zk=Ck({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),zk=Ck({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Vk=Ck({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Hk=Ck({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),qk=Ik({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Gk=Ik({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Wk=Ck({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Qk=Ck({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Yk=Ck({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Jk=Ck({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Xk=Ck({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),$k=_k({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),eR=new TextEncoder,tR=new TextDecoder,nR="json",rR=512,iR=e=>eR.encode(JSON.stringify(e)),oR=e=>JSON.parse(tR.decode(e)),sR="raw",aR=85,cR=e=>vk(e),lR=e=>vk(e);var uR=function e(t,n,r){n=n||[];var i=r=r||0;for(;t>=fR;)n[r++]=255&t|hR,t/=128;for(;t&dR;)n[r++]=255&t|hR,t>>>=7;return n[r]=0|t,e.bytes=r-i+1,n},hR=128,dR=-128,fR=Math.pow(2,31);var pR=function e(t,n){var r,i=0,o=0,s=n=n||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");r=t[s++],i+=o<28?(r&yR)<<o:(r&yR)*Math.pow(2,o),o+=7}while(r>=gR);return e.bytes=s-n,i},gR=128,yR=127;var mR=Math.pow(2,7),vR=Math.pow(2,14),bR=Math.pow(2,21),wR=Math.pow(2,28),ER=Math.pow(2,35),AR=Math.pow(2,42),SR=Math.pow(2,49),_R=Math.pow(2,56),IR=Math.pow(2,63);const CR={encode:uR,decode:pR,encodingLength:function(e){return e<mR?1:e<vR?2:e<bR?3:e<wR?4:e<ER?5:e<AR?6:e<SR?7:e<_R?8:e<IR?9:10}},TR=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return[CR.decode(e,t),CR.decode.bytes]},kR=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return CR.encode(e,t,n),t},RR=e=>CR.encodingLength(e),xR=(e,t)=>{const n=t.byteLength,r=RR(e),i=r+RR(n),o=new Uint8Array(i+n);return kR(e,o,0),kR(n,o,r),o.set(t,i),new DR(e,n,t,o)},PR=e=>{const t=vk(e),[n,r]=TR(t),[i,o]=TR(t.subarray(r)),s=t.subarray(r+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new DR(n,i,s,t)};class DR{constructor(e,t,n,r){this.code=e,this.size=t,this.digest=n,this.bytes=r}}const OR=vk,NR={code:0,name:"identity",encode:OR,digest:e=>xR(0,OR(e))},BR=e=>{let{name:t,code:n,encode:r}=e;return new LR(t,n,r)};class LR{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?xR(this.code,t):t.then((e=>xR(this.code,e)))}throw Error("Unknown type, must be binary type")}}const MR=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),UR=BR({name:"sha2-256",code:18,encode:MR("SHA-256")}),FR=BR({name:"sha2-512",code:19,encode:MR("SHA-512")}),KR=(e,t)=>{const{bytes:n,version:r}=e;return 0===r?HR(n,ZR(e),t||Tk.encoder):qR(n,ZR(e),t||Mk.encoder)},jR=new WeakMap,ZR=e=>{const t=jR.get(e);if(null==t){const t=new Map;return jR.set(e,t),t}return t};class zR{constructor(e,t,n,r){this.code=t,this.version=e,this.multihash=n,this.bytes=r,this["/"]=r}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==GR)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==WR)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return zR.createV0(t)}default:throw Error("Can not convert CID version ".concat(this.version," to version 0. This is a bug please report"))}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=xR(e,t);return zR.createV1(this.code,n)}case 1:return this;default:throw Error("Can not convert CID version ".concat(this.version," to version 1. This is a bug please report"))}}equals(e){return zR.equals(this,e)}static equals(e,t){const n=t;return n&&e.code===n.code&&e.version===n.version&&((e,t)=>{if(e===t)return!0;{const n=t;return e.code===n.code&&e.size===n.size&&n.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0})(e.bytes,n.bytes)}})(e.multihash,n.multihash)}toString(e){return KR(this,e)}toJSON(){return{"/":KR(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID(".concat(this.toString(),")")}static asCID(e){if(null==e)return null;const t=e;if(t instanceof zR)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:n,multihash:r,bytes:i}=t;return new zR(e,n,r,i||QR(e,n,r.bytes))}if(!0===t[YR]){const{version:e,multihash:n,code:r}=t,i=PR(n);return zR.create(e,r,i)}return null}static create(e,t,n){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==GR)throw new Error("Version 0 CID must use dag-pb (code: ".concat(GR,") block encoding"));return new zR(e,t,n,n.bytes);case 1:{const r=QR(e,t,n.bytes);return new zR(e,t,n,r)}default:throw new Error("Invalid version")}}static createV0(e){return zR.create(0,GR,e)}static createV1(e,t){return zR.create(1,e,t)}static decode(e){const[t,n]=zR.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=zR.inspectBytes(e),n=t.size-t.multihashSize,r=vk(e.subarray(n,n+t.multihashSize));if(r.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=r.subarray(t.multihashSize-t.digestSize),o=new DR(t.multihashCode,t.digestSize,i,r);return[0===t.version?zR.createV0(o):zR.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[n,r]=TR(e.subarray(t));return t+=r,n};let r=n(),i=GR;if(18===r?(r=0,t=0):i=n(),0!==r&&1!==r)throw new RangeError("Invalid CID version ".concat(r));const o=t,s=n(),a=n(),c=t+a;return{version:r,codec:i,multihashCode:s,digestSize:a,multihashSize:c-o,size:c}}static parse(e,t){const[n,r]=VR(e,t),i=zR.decode(r);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return ZR(i).set(n,e),i}}const VR=(e,t)=>{switch(e[0]){case"Q":{const n=t||Tk;return[Tk.prefix,n.decode("".concat(Tk.prefix).concat(e))]}case Tk.prefix:{const n=t||Tk;return[Tk.prefix,n.decode(e)]}case Mk.prefix:{const n=t||Mk;return[Mk.prefix,n.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},HR=(e,t,n)=>{const{prefix:r}=n;if(r!==Tk.prefix)throw Error("Cannot string encode V0 in ".concat(n.name," encoding"));const i=t.get(r);if(null==i){const i=n.encode(e).slice(1);return t.set(r,i),i}return i},qR=(e,t,n)=>{const{prefix:r}=n,i=t.get(r);if(null==i){const i=n.encode(e);return t.set(r,i),i}return i},GR=112,WR=18,QR=(e,t,n)=>{const r=RR(e),i=r+RR(t),o=new Uint8Array(i+n.byteLength);return kR(e,o,0),kR(t,o,r),o.set(n,i),o},YR=Symbol.for("@ipld/js-cid/CID"),JR={...je,...Be,...Ke,...Oe,...Ne,...Me,...Ue,...De,...Fe,...Le},XR=Symbol.for("nodejs.util.inspect.custom"),$R=Object.values(JR).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)),JR.identity.decoder),ex=114,tx=36,nx=37;class rx{constructor(e){(0,Yo.Z)(this,"type",void 0),(0,Yo.Z)(this,"multihash",void 0),(0,Yo.Z)(this,"privateKey",void 0),(0,Yo.Z)(this,"publicKey",void 0),(0,Yo.Z)(this,"string",void 0),(0,Yo.Z)(this,fu.Cs,!0),this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return"PeerId(".concat(this.toString(),")")}toString(){return null==this.string&&(this.string=Tk.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return zR.createV1(ex,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){var t;if(e instanceof Uint8Array)return(0,Ms.f)(this.multihash.bytes,e);if("string"===typeof e)return ax(e).equals(this);if(null!=(null===e||void 0===e||null===(t=e.multihash)||void 0===t?void 0:t.bytes))return(0,Ms.f)(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[XR](){return"PeerId(".concat(this.toString(),")")}}class ix extends rx{constructor(e){super({...e,type:"RSA"}),(0,Yo.Z)(this,"type","RSA"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.publicKey}}class ox extends rx{constructor(e){super({...e,type:"Ed25519"}),(0,Yo.Z)(this,"type","Ed25519"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.multihash.digest}}class sx extends rx{constructor(e){super({...e,type:"secp256k1"}),(0,Yo.Z)(this,"type","secp256k1"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.multihash.digest}}function ax(e,t){var n;if(t=null!==(n=t)&&void 0!==n?n:$R,"1"===e.charAt(0)||"Q"===e.charAt(0)){const t=PR(Tk.decode("z".concat(e)));return e.startsWith("12D")?new ox({multihash:t}):e.startsWith("16U")?new sx({multihash:t}):new ix({multihash:t})}return function(e){try{const t=PR(e);if(t.code===NR.code){if(t.digest.length===tx)return new ox({multihash:t});if(t.digest.length===nx)return new sx({multihash:t})}if(t.code===UR.code)return new ix({multihash:t})}catch{return function(e){if(null==e||null==e.multihash||null==e.version||1===e.version&&e.code!==ex)throw new Error("Supplied PeerID CID is invalid");const t=e.multihash;if(t.code===UR.code)return new ix({multihash:e.multihash});if(t.code===NR.code){if(t.digest.length===tx)return new ox({multihash:e.multihash});if(t.digest.length===nx)return new sx({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}(zR.decode(e))}throw new Error("Supplied PeerID CID is invalid")}($R.decode(e))}function cx(e,t){const n={[Symbol.iterator]:()=>n,next:()=>{const n=e.next(),r=n.value;if(!0===n.done||null==r){return{done:!0,value:void 0}}return{done:!1,value:t(r)}}};return n}class lx{constructor(e){if((0,Yo.Z)(this,"map",void 0),this.map=new Map,null!=e)for(const[t,n]of e.entries())this.map.set(t.toString(),n)}[Symbol.iterator](){return this.entries()}clear(){this.map.clear()}delete(e){this.map.delete(e.toString())}entries(){return cx(this.map.entries(),(e=>[ax(e[0]),e[1]]))}forEach(e){this.map.forEach(((t,n)=>{e(t,ax(n),this)}))}get(e){return this.map.get(e.toString())}has(e){return this.map.has(e.toString())}set(e,t){this.map.set(e.toString(),t)}keys(){return cx(this.map.keys(),(e=>ax(e)))}values(){return this.map.values()}get size(){return this.map.size}}class ux{constructor(e){if((0,Yo.Z)(this,"set",void 0),this.set=new Set,null!=e)for(const t of e)this.set.add(t.toString())}get size(){return this.set.size}[Symbol.iterator](){return this.values()}add(e){this.set.add(e.toString())}clear(){this.set.clear()}delete(e){this.set.delete(e.toString())}entries(){return cx(this.set.entries(),(e=>{const t=ax(e[0]);return[t,t]}))}forEach(e){this.set.forEach((t=>{const n=ax(t);e(n,n,this)}))}has(e){return this.set.has(e.toString())}values(){return cx(this.set.values(),(e=>ax(e)))}intersection(e){const t=new ux;for(const n of e)this.has(n)&&t.add(n);return t}difference(e){const t=new ux;for(const n of this)e.has(n)||t.add(n);return t}union(e){const t=new ux;for(const n of e)t.add(n);for(const n of this)t.add(n);return t}}Symbol.iterator;class hx extends fu.Le{constructor(e){super(),(0,Yo.Z)(this,"peerId",void 0),(0,Yo.Z)(this,"peerStore",void 0),(0,Yo.Z)(this,"contentRouting",void 0),(0,Yo.Z)(this,"registrar",void 0),(0,Yo.Z)(this,"started",void 0),(0,Yo.Z)(this,"topologyId",void 0),(0,Yo.Z)(this,"log",void 0),this.log=e.logger.forComponent("libp2p:circuit-relay:discover-relays"),this.started=!1,this.peerId=e.peerId,this.peerStore=e.peerStore,this.contentRouting=e.contentRouting,this.registrar=e.registrar}isStarted(){return this.started}async start(){this.topologyId=await this.registrar.register(ik,{notifyOnTransient:!0,onConnect:e=>{this.safeDispatchEvent("relay:discover",{detail:e})}}),this.discover().catch((e=>{this.log.error("error listening on relays",e)})),this.started=!0}stop(){null!=this.topologyId&&this.registrar.unregister(this.topologyId),this.started=!1}async discover(){this.log("searching peer store for relays");const e=await this.peerStore.all({filters:[e=>e.protocols.includes(ik)],orders:[()=>Math.random()<.5?1:-1]});for(const n of e)this.log("found relay peer %p in content peer store",n.id),this.safeDispatchEvent("relay:discover",{detail:n.id});this.log("found %d relay peers in peer store",e.length);try{this.log("searching content routing for relays");const e=await async function(e){const t=(new TextEncoder).encode(e),n=await z_.digest(t);return W_.createV0(n)}("/libp2p/relay");let t=0;for await(const n of this.contentRouting.findProviders(e))if(n.multiaddrs.length>0&&!n.id.equals(this.peerId)){const e=n.id;t++,await this.peerStore.merge(e,{multiaddrs:n.multiaddrs}),this.log("found relay peer %p in content routing",e),this.safeDispatchEvent("relay:discover",{detail:e})}this.log("found %d relay peers in content routing",t)}catch(t){this.log.error("failed when finding relays on the network",t)}}}var dx=n(44743),fx=n(58271);var px=new WeakMap;class gx{constructor(){(0,dx.Z)(this,px,{writable:!0,value:[]})}enqueue(e,t){var n;const r=null===t||void 0===t?void 0:t.peerId,i=null!==(n=null===t||void 0===t?void 0:t.priority)&&void 0!==n?n:0;if(null==r)throw new fu.sv("missing peer id",fu.Mb);const o={priority:i,peerId:r,run:e};if(this.size>0&&(0,fx.Z)(this,px)[this.size-1].priority>=i)return void(0,fx.Z)(this,px).push(o);const s=function(e,t,n){let r=0,i=e.length;for(;i>0;){const o=Math.trunc(i/2);let s=r+o;n(e[s],t)<=0?(r=++s,i-=o+1):i=o}return r}((0,fx.Z)(this,px),o,((e,t)=>t.priority-e.priority));(0,fx.Z)(this,px).splice(s,0,o)}dequeue(){const e=(0,fx.Z)(this,px).shift();return null===e||void 0===e?void 0:e.run}filter(e){if(null!=e.peerId){const t=e.peerId;return(0,fx.Z)(this,px).filter((e=>t.equals(e.peerId))).map((e=>e.run))}return(0,fx.Z)(this,px).filter((t=>t.priority===e.priority)).map((e=>e.run))}get size(){return(0,fx.Z)(this,px).length}}class yx extends Bm.Z{constructor(){super({...arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},queueClass:gx})}hasJob(e){return this.sizeBy({peerId:e})>0}}var mx=new WeakSet,vx=new WeakSet;class bx extends fu.Le{constructor(e,t){var n,r,i,o;super(),Qd(this,vx),Qd(this,mx),(0,Yo.Z)(this,"peerId",void 0),(0,Yo.Z)(this,"connectionManager",void 0),(0,Yo.Z)(this,"transportManager",void 0),(0,Yo.Z)(this,"peerStore",void 0),(0,Yo.Z)(this,"events",void 0),(0,Yo.Z)(this,"reserveQueue",void 0),(0,Yo.Z)(this,"reservations",void 0),(0,Yo.Z)(this,"maxDiscoveredRelays",void 0),(0,Yo.Z)(this,"maxReservationQueueLength",void 0),(0,Yo.Z)(this,"reservationCompletionTimeout",void 0),(0,Yo.Z)(this,"started",void 0),(0,Yo.Z)(this,"log",void 0),this.log=e.logger.forComponent("libp2p:circuit-relay:transport:reservation-store"),this.peerId=e.peerId,this.connectionManager=e.connectionManager,this.transportManager=e.transportManager,this.peerStore=e.peerStore,this.events=e.events,this.reservations=new lx,this.maxDiscoveredRelays=null!==(n=null===t||void 0===t?void 0:t.discoverRelays)&&void 0!==n?n:0,this.maxReservationQueueLength=null!==(r=null===t||void 0===t?void 0:t.maxReservationQueueLength)&&void 0!==r?r:100,this.reservationCompletionTimeout=null!==(i=null===t||void 0===t?void 0:t.reservationCompletionTimeout)&&void 0!==i?i:1e4,this.started=!1,this.reserveQueue=new yx({concurrency:null!==(o=null===t||void 0===t?void 0:t.reservationConcurrency)&&void 0!==o?o:1}),this.events.addEventListener("peer:disconnect",(e=>{Yd(this,vx,Ex).call(this,e.detail)}))}isStarted(){return this.started}async start(){this.started=!0}async stop(){this.reserveQueue.clear(),this.reservations.forEach((e=>{let{timeout:t}=e;clearTimeout(t)})),this.reservations.clear(),this.started=!1}async addRelay(e,t){this.peerId.equals(e)?this.log("not trying to use self as relay"):this.reserveQueue.size>this.maxReservationQueueLength?this.log("not adding relay as the queue is full"):this.reserveQueue.hasJob(e)?this.log("relay peer is already in the reservation queue"):(this.log("add relay %p",e),await this.reserveQueue.add((async()=>{try{const n=this.reservations.get(e);if(null!=n){if(gk(n.reservation.expire)>6e5)return void this.log("already have reservation on relay peer %p and it expires in more than 10 minutes",e);clearTimeout(n.timeout),this.reservations.delete(e)}if("discovered"===t&&[...this.reservations.values()].reduce(((e,t)=>("discovered"===t.type&&e++,e)),0)>=this.maxDiscoveredRelays)return void this.log("already have enough discovered relays");const r=AbortSignal.timeout(this.reservationCompletionTimeout),i=await this.connectionManager.openConnection(e,{signal:r});if(i.remoteAddr.protoNames().includes("p2p-circuit"))return void this.log("not creating reservation over relayed connection");const o=await Yd(this,mx,wx).call(this,i,{signal:r});this.log("created reservation on relay peer %p",e);const s=gk(o.expire),a=Math.min(Math.max(s-3e5,3e4),Math.pow(2,31)-1),c=setTimeout((()=>{this.addRelay(e,t).catch((t=>{this.log.error("could not refresh reservation to relay %p",e,t)}))}),a);this.reservations.set(e,{timeout:c,reservation:o,type:t}),await this.peerStore.merge(e,{tags:{"circuit-relay-relay":{value:1,ttl:s}}}),await this.transportManager.listen([(0,ng.HM)("/p2p/".concat(e.toString(),"/p2p-circuit"))])}catch(n){this.log.error("could not reserve slot on %p",e,n);const t=this.reservations.get(e);null!=t&&clearTimeout(t.timeout),this.reservations.delete(e)}}),{peerId:e}))}hasReservation(e){return this.reservations.has(e)}getReservation(e){var t;return null===(t=this.reservations.get(e))||void 0===t?void 0:t.reservation}}async function wx(e,t){var n,r;null===(n=t.signal)||void 0===n||n.throwIfAborted(),this.log("requesting reservation from %p",e.remotePeer);const i=await e.newStream(ik,t),o=rk(i).pb(ak);let s;await o.write({type:ak.Type.RESERVE},t);try{s=await o.read(t)}catch(c){throw this.log.error("error parsing reserve message response from %p because",e.remotePeer,c),i.abort(c),c}finally{await i.close()}if(s.status===dk.OK&&null!=s.reservation){let t=!1;const n=e.remoteAddr.bytes;for(const e of s.reservation.addrs)if((0,Ms.f)(n,e)){t=!0;break}return t||s.reservation.addrs.push(n),s.reservation}const a="reservation failed with status ".concat(null!==(r=s.status)&&void 0!==r?r:"undefined");throw this.log.error(a),new Error(a)}function Ex(e){const t=this.reservations.get(e);null!=t&&(this.log("connection to relay %p closed, removing reservation from local store",e),clearTimeout(t.timeout),this.reservations.delete(e),this.safeDispatchEvent("relay:removed",{detail:e}),this.reservations.size<this.maxDiscoveredRelays&&(this.log("not enough relays %d/%d",this.reservations.size,this.maxDiscoveredRelays),this.safeDispatchEvent("relay:not-enough-relays",{})))}function Ax(e){const{stream:t,remoteAddr:n,logger:r}=e,i=r.forComponent("libp2p:stream:converter");let o=!1,s=!1;const a=t.close.bind(t);t.close=async e=>{await a(e),h(!0)};const c=t.abort.bind(t);t.abort=e=>{c(e),h(!0)};const l=t.sink.bind(t);t.sink=async e=>{try{await l(e)}catch(t){"aborted"!==t.type&&i(t)}finally{s=!0,h()}};const u={log:i,sink:t.sink,source:async function*(){try{for await(const e of t.source)e instanceof Uint8Array?yield e:yield*e}finally{o=!0,h()}}(),remoteAddr:n,timeline:{open:Date.now(),close:void 0},close:t.close,abort:t.abort};function h(e){!0===e&&(o=!0,s=!0),o&&s&&null==u.timeline.close&&(u.timeline.close=Date.now())}return u}const Sx=eP("dns4"),_x=eP("dns6"),Ix=eP("dnsaddr"),Cx=$x(eP("dns"),Ix,Sx,_x),Tx=$x(eP("ip4"),eP("ip6")),kx=$x(Xx(Tx,eP("tcp")),Xx(Cx,eP("tcp"))),Rx=Xx(Tx,eP("udp")),xx=Xx(Rx,eP("utp")),Px=Xx(Rx,eP("quic")),Dx=Xx(Rx,eP("quic-v1")),Ox=$x(Xx(kx,eP("ws")),Xx(Cx,eP("ws"))),Nx=$x(Xx(Ox,eP("p2p")),Ox),Bx=$x(Xx(kx,eP("wss")),Xx(Cx,eP("wss")),Xx(kx,eP("tls"),eP("ws")),Xx(Cx,eP("tls"),eP("ws"))),Lx=$x(Xx(Bx,eP("p2p")),Bx),Mx=$x(Xx(kx,eP("http")),Xx(Tx,eP("http")),Xx(Cx,eP("http"))),Ux=$x(Xx(kx,eP("https")),Xx(Tx,eP("https")),Xx(Cx,eP("https"))),Fx=Xx(Rx,eP("webrtc-direct"),eP("certhash")),Kx=$x(Xx(Fx,eP("p2p")),Fx),jx=Xx(Dx,eP("webtransport"),eP("certhash"),eP("certhash")),Zx=$x(Xx(jx,eP("p2p")),jx),zx=$x(Xx(Nx,eP("p2p-webrtc-star"),eP("p2p")),Xx(Lx,eP("p2p-webrtc-star"),eP("p2p")),Xx(Nx,eP("p2p-webrtc-star")),Xx(Lx,eP("p2p-webrtc-star"))),Vx=($x(Xx(Nx,eP("p2p-websocket-star"),eP("p2p")),Xx(Lx,eP("p2p-websocket-star"),eP("p2p")),Xx(Nx,eP("p2p-websocket-star")),Xx(Lx,eP("p2p-websocket-star"))),$x(Xx(Mx,eP("p2p-webrtc-direct"),eP("p2p")),Xx(Ux,eP("p2p-webrtc-direct"),eP("p2p")),Xx(Mx,eP("p2p-webrtc-direct")),Xx(Ux,eP("p2p-webrtc-direct")))),Hx=$x(Ox,Bx,Mx,Ux,zx,Vx,kx,xx,Px,Cx,Kx,Zx),qx=($x(Xx(Hx,eP("p2p-stardust"),eP("p2p")),Xx(Hx,eP("p2p-stardust"))),$x(Xx(Hx,eP("p2p")),zx,Vx,Kx,Zx,eP("p2p"))),Gx=$x(Xx(qx,eP("p2p-circuit"),qx),Xx(qx,eP("p2p-circuit")),Xx(eP("p2p-circuit"),qx),Xx(Hx,eP("p2p-circuit")),Xx(eP("p2p-circuit"),Hx),eP("p2p-circuit")),Wx=()=>$x(Xx(Gx,Wx),Gx),Qx=Wx(),Yx=$x(Xx(Qx,qx,Qx),Xx(qx,Qx),Xx(Qx,qx),Qx,qx);$x(Xx(Qx,eP("webrtc"),eP("p2p")),Xx(Qx,eP("webrtc")),Xx(Hx,eP("webrtc"),eP("p2p")),Xx(Hx,eP("webrtc")),eP("webrtc"));function Jx(e){return function(t){let n;try{n=(0,ng.HM)(t)}catch(i){return!1}const r=e(n.protoNames());return null!==r&&(!0===r||!1===r?r:0===r.length)}}function Xx(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];function r(e){if(e.length<t.length)return null;let n=e;return t.some((t=>(n="function"===typeof t?t().partialMatch(e):t.partialMatch(e),Array.isArray(n)&&(e=n),null===n))),n}return{toString:function(){return"{ "+t.join(" ")+" }"},input:t,matches:Jx(r),partialMatch:r}}function $x(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];function r(e){let n=null;return t.some((t=>{const r="function"===typeof t?t().partialMatch(e):t.partialMatch(e);return null!=r&&(n=r,!0)})),n}return{toString:function(){return"{ "+t.join(" ")+" }"},input:t,matches:Jx(r),partialMatch:r}}function eP(e){const t=e;return{toString:function(){return t},matches:function(e){let n;try{n=(0,ng.HM)(e)}catch(i){return!1}const r=n.protoNames();return 1===r.length&&r[0]===t},partialMatch:function(e){return 0===e.length?null:e[0]===t?e.slice(1):null}}}var tP=new WeakSet;class nP extends fu.Le{constructor(e){super(),Qd(this,tP),(0,Yo.Z)(this,"connectionManager",void 0),(0,Yo.Z)(this,"relayStore",void 0),(0,Yo.Z)(this,"listeningAddrs",void 0),(0,Yo.Z)(this,"log",void 0),(0,Yo.Z)(this,"_onRemoveRelayPeer",(e=>{Yd(this,tP,rP).call(this,e.detail)})),this.log=e.logger.forComponent("libp2p:circuit-relay:transport:listener"),this.connectionManager=e.connectionManager,this.relayStore=e.relayStore,this.listeningAddrs=new lx,this.relayStore.addEventListener("relay:removed",this._onRemoveRelayPeer)}async listen(e){this.log("listen on %a",e);const t=e.decapsulate("/p2p-circuit"),n=await this.connectionManager.openConnection(t);if(!this.relayStore.hasReservation(n.remotePeer))return this.log("making reservation on peer %p",n.remotePeer),void await this.relayStore.addRelay(n.remotePeer,"configured");const r=this.relayStore.getReservation(n.remotePeer);if(null==r)throw new fu.sv("Did not have reservation after making reservation","ERR_NO_RESERVATION");this.listeningAddrs.has(n.remotePeer)?this.log("already listening on relay %p",n.remotePeer):(this.listeningAddrs.set(n.remotePeer,r.addrs.map((e=>(0,ng.HM)(e).encapsulate("/p2p-circuit")))),this.safeDispatchEvent("listening",{}))}getAddrs(){return[...this.listeningAddrs.values()].flat()}async close(){}}function rP(e){const t=this.listeningAddrs.has(e);this.log("relay peer removed %p - had reservation",e,t),this.listeningAddrs.delete(e),t&&(this.log.trace("removing relay event listener for peer %p",e),this.relayStore.removeEventListener("relay:removed",this._onRemoveRelayPeer),this.safeDispatchEvent("close",{}))}const iP=300,oP=300,sP=3e4;class aP{constructor(e,t){var n,r,i;(0,Yo.Z)(this,"discovery",void 0),(0,Yo.Z)(this,"registrar",void 0),(0,Yo.Z)(this,"peerStore",void 0),(0,Yo.Z)(this,"connectionManager",void 0),(0,Yo.Z)(this,"transportManager",void 0),(0,Yo.Z)(this,"peerId",void 0),(0,Yo.Z)(this,"upgrader",void 0),(0,Yo.Z)(this,"addressManager",void 0),(0,Yo.Z)(this,"connectionGater",void 0),(0,Yo.Z)(this,"reservationStore",void 0),(0,Yo.Z)(this,"logger",void 0),(0,Yo.Z)(this,"maxInboundStopStreams",void 0),(0,Yo.Z)(this,"maxOutboundStopStreams",void 0),(0,Yo.Z)(this,"stopTimeout",void 0),(0,Yo.Z)(this,"started",void 0),(0,Yo.Z)(this,"log",void 0),(0,Yo.Z)(this,fu.SF,!0),(0,Yo.Z)(this,Symbol.toStringTag,"libp2p/circuit-relay-v2"),this.log=e.logger.forComponent("libp2p:circuit-relay:transport"),this.registrar=e.registrar,this.peerStore=e.peerStore,this.connectionManager=e.connectionManager,this.transportManager=e.transportManager,this.logger=e.logger,this.peerId=e.peerId,this.upgrader=e.upgrader,this.addressManager=e.addressManager,this.connectionGater=e.connectionGater,this.maxInboundStopStreams=null!==(n=t.maxInboundStopStreams)&&void 0!==n?n:iP,this.maxOutboundStopStreams=null!==(r=t.maxOutboundStopStreams)&&void 0!==r?r:oP,this.stopTimeout=null!==(i=t.stopTimeout)&&void 0!==i?i:sP,null!=t.discoverRelays&&t.discoverRelays>0&&(this.discovery=new hx(e),this.discovery.addEventListener("relay:discover",(e=>{this.reservationStore.addRelay(e.detail,"discovered").catch((t=>{this.log.error("could not add discovered relay %p",e.detail,t)}))}))),this.reservationStore=new bx(e,t),this.reservationStore.addEventListener("relay:not-enough-relays",(()=>{var e;null===(e=this.discovery)||void 0===e||e.discover().catch((e=>{this.log.error("could not discover relays",e)}))})),this.started=!1}isStarted(){return this.started}async start(){var e;await this.reservationStore.start(),await(null===(e=this.discovery)||void 0===e?void 0:e.start()),await this.registrar.handle(ok,(e=>{this.onStop(e).catch((t=>{this.log.error("error while handling STOP protocol",t),e.stream.abort(t)}))}),{maxInboundStreams:this.maxInboundStopStreams,maxOutboundStreams:this.maxOutboundStopStreams,runOnTransientConnection:!0}),this.started=!0}async stop(){var e;null===(e=this.discovery)||void 0===e||e.stop(),await this.reservationStore.stop(),await this.registrar.unhandle(ok),this.started=!1}async dial(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(1!==e.protoCodes().filter((e=>290===e)).length){const t="Invalid circuit relay address";throw this.log.error(t,e),new fu.sv(t,sk)}const n=e.toString().split("/p2p-circuit"),r=(0,ng.HM)(n[0]),i=(0,ng.HM)(n[n.length-1]),o=r.getPeerId(),s=i.getPeerId();if(null==o||null==s){const t="Circuit relay dial to ".concat(e.toString()," failed as address did not have peer ids");throw this.log.error(t),new fu.sv(t,sk)}const a=dI(o),c=dI(s);let l=!1;let u,h=this.connectionManager.getConnections(a)[0];null==h&&(await this.peerStore.merge(a,{multiaddrs:[r]}),h=await this.connectionManager.openConnection(a,t),l=!0);try{return u=await h.newStream(ik),await this.connectV2({stream:u,connection:h,destinationPeer:c,destinationAddr:i,relayAddr:r,ma:e,disconnectOnFailure:l})}catch(d){throw this.log.error("circuit relay dial to destination %p via relay %p failed",c,a,d),null!=u&&u.abort(d),l&&await h.close(),d}}async connectV2(e){let{stream:t,connection:n,destinationPeer:r,destinationAddr:i,relayAddr:o,ma:s,disconnectOnFailure:a}=e;try{const e=rk(t),n=e.pb(ak);await n.write({type:ak.Type.CONNECT,peer:{id:r.toBytes(),addrs:[(0,ng.HM)(i).bytes]}});const a=await n.read();var c,l;if(a.status!==dk.OK)throw new fu.sv("failed to connect via relay with status ".concat(null!==(c=null===a||void 0===a||null===(l=a.status)||void 0===l?void 0:l.toString())&&void 0!==c?c:"undefined"),"ERR_HOP_REQUEST_FAILED");const u=Ax({stream:e.unwrap(),remoteAddr:s,localAddr:o.encapsulate("/p2p-circuit/p2p/".concat(this.peerId.toString())),logger:this.logger});return this.log("new outbound transient connection %a",u.remoteAddr),await this.upgrader.upgradeOutbound(u,{transient:!0})}catch(u){throw this.log.error("Circuit relay dial to destination ".concat(r.toString()," via relay ").concat(n.remotePeer.toString()," failed"),u),a&&await n.close(),u}}createListener(e){return function(e){return new nP(e)}({connectionManager:this.connectionManager,relayStore:this.reservationStore,logger:this.logger})}filter(e){return(e=Array.isArray(e)?e:[e]).filter((e=>Qx.matches(e)))}async onStop(e){var t,n;let{connection:r,stream:i}=e;if(!this.reservationStore.hasReservation(r.remotePeer))try{this.log("dialed via relay we did not have a reservation on, start listening on that relay address"),await this.transportManager.listen([r.remoteAddr.encapsulate("/p2p-circuit")])}catch(d){this.log.error("failed to listen on a relay peer we were dialed via but did not have a reservation on",d)}const o=AbortSignal.timeout(this.stopTimeout),s=rk(i).pb(ck),a=await s.read({signal:o});if(this.log("new circuit relay v2 stop stream from %p with type %s",r.remotePeer,a.type),void 0===(null===a||void 0===a?void 0:a.type))return this.log.error("type was missing from circuit v2 stop protocol request from %s",r.remotePeer),await s.write({type:ck.Type.STATUS,status:dk.MALFORMED_MESSAGE},{signal:o}),void await i.close();if(a.type!==ck.Type.CONNECT)return this.log.error("invalid stop connect request via peer %p",r.remotePeer),await s.write({type:ck.Type.STATUS,status:dk.UNEXPECTED_MESSAGE},{signal:o}),void await i.close();if(!(e=>{if(null==e.peer)return!1;try{e.peer.addrs.forEach(ng.HM)}catch{return!1}return!0})(a))return this.log.error("invalid stop connect request via peer %p",r.remotePeer),await s.write({type:ck.Type.STATUS,status:dk.MALFORMED_MESSAGE},{signal:o}),void await i.close();const c=fI(a.peer.id);if(!0===await(null===(t=(n=this.connectionGater).denyInboundRelayedConnection)||void 0===t?void 0:t.call(n,r.remotePeer,c)))return this.log.error("connection gater denied inbound relayed connection from %p",r.remotePeer),await s.write({type:ck.Type.STATUS,status:dk.PERMISSION_DENIED},{signal:o}),void await i.close();this.log.trace("sending success response to %p",r.remotePeer),await s.write({type:ck.Type.STATUS,status:dk.OK},{signal:o});const l=r.remoteAddr.encapsulate("/p2p-circuit/p2p/".concat(c.toString())),u=this.addressManager.getAddresses()[0],h=Ax({stream:s.unwrap().unwrap(),remoteAddr:l,localAddr:u,logger:this.logger});this.log("new inbound transient connection %a",h.remoteAddr),await this.upgrader.upgradeInbound(h,{transient:!0}),this.log("%s connection %a upgraded","inbound",h.remoteAddr)}}function cP(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>new aP(t,e)}var lP=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==n[s])throw new TypeError(o+" is ambiguous");n[s]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var r=0,i=0;e[t]===c;)r++,t++;for(var o=(e.length-t)*l+1>>>0,s=new Uint8Array(o);e[t];){var u=n[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=o-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*s[d]>>>0,s[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=o-i;f!==o&&0===s[f];)f++;for(var p=new Uint8Array(r+(o-f)),g=r;f!==o;)p[g++]=s[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,o=t.length;i!==o&&0===t[i];)i++,n++;for(var s=(o-i)*u+1>>>0,l=new Uint8Array(s);i!==o;){for(var h=t[i],d=0,f=s-1;(0!==h||d<r)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");r=d,i++}for(var p=s-r;p!==s&&0===l[p];)p++;for(var g=c.repeat(n);p<s;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:h,decode:function(e){var n=h(e);if(n)return n;throw new Error("Non-".concat(t," character"))}}};const uP=lP,hP=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class dP{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(e));throw Error("Unknown type, must be binary type")}}class fP{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(e),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return gP(this,e)}}class pP{constructor(e){this.decoders=e}or(e){return gP(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(e),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}}const gP=(e,t)=>new pP({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class yP{constructor(e,t,n,r){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=r,this.encoder=new dP(e,t,n),this.decoder=new fP(e,t,r)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const mP=e=>{let{name:t,prefix:n,encode:r,decode:i}=e;return new yP(t,n,r,i)},vP=e=>{let{prefix:t,name:n,alphabet:r}=e;const{encode:i,decode:o}=uP(r,n);return mP({prefix:t,name:n,encode:i,decode:e=>hP(o(e))})},bP=e=>{let{name:t,prefix:n,bitsPerChar:r,alphabet:i}=e;return mP({prefix:n,name:t,encode:e=>((e,t,n)=>{const r="="===t[t.length-1],i=(1<<n)-1;let o="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>n;)s-=n,o+=t[i&a>>s];if(s&&(o+=t[i&a<<n-s]),r)for(;o.length*n&7;)o+="=";return o})(e,i,r),decode:e=>((e,t,n,r)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*n/8|0);let a=0,c=0,l=0;for(let u=0;u<o;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError("Non-".concat(r," character"));c=c<<n|t,a+=n,a>=8&&(a-=8,s[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s})(e,i,r,t)})},wP=vP({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),EP=vP({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),AP=vP({prefix:"9",name:"base10",alphabet:"0123456789"}),SP=bP({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),_P=bP({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),IP=bP({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),CP=Array.from("\ud83d\ude80\ud83e\ude90\u2604\ud83d\udef0\ud83c\udf0c\ud83c\udf11\ud83c\udf12\ud83c\udf13\ud83c\udf14\ud83c\udf15\ud83c\udf16\ud83c\udf17\ud83c\udf18\ud83c\udf0d\ud83c\udf0f\ud83c\udf0e\ud83d\udc09\u2600\ud83d\udcbb\ud83d\udda5\ud83d\udcbe\ud83d\udcbf\ud83d\ude02\u2764\ud83d\ude0d\ud83e\udd23\ud83d\ude0a\ud83d\ude4f\ud83d\udc95\ud83d\ude2d\ud83d\ude18\ud83d\udc4d\ud83d\ude05\ud83d\udc4f\ud83d\ude01\ud83d\udd25\ud83e\udd70\ud83d\udc94\ud83d\udc96\ud83d\udc99\ud83d\ude22\ud83e\udd14\ud83d\ude06\ud83d\ude44\ud83d\udcaa\ud83d\ude09\u263a\ud83d\udc4c\ud83e\udd17\ud83d\udc9c\ud83d\ude14\ud83d\ude0e\ud83d\ude07\ud83c\udf39\ud83e\udd26\ud83c\udf89\ud83d\udc9e\u270c\u2728\ud83e\udd37\ud83d\ude31\ud83d\ude0c\ud83c\udf38\ud83d\ude4c\ud83d\ude0b\ud83d\udc97\ud83d\udc9a\ud83d\ude0f\ud83d\udc9b\ud83d\ude42\ud83d\udc93\ud83e\udd29\ud83d\ude04\ud83d\ude00\ud83d\udda4\ud83d\ude03\ud83d\udcaf\ud83d\ude48\ud83d\udc47\ud83c\udfb6\ud83d\ude12\ud83e\udd2d\u2763\ud83d\ude1c\ud83d\udc8b\ud83d\udc40\ud83d\ude2a\ud83d\ude11\ud83d\udca5\ud83d\ude4b\ud83d\ude1e\ud83d\ude29\ud83d\ude21\ud83e\udd2a\ud83d\udc4a\ud83e\udd73\ud83d\ude25\ud83e\udd24\ud83d\udc49\ud83d\udc83\ud83d\ude33\u270b\ud83d\ude1a\ud83d\ude1d\ud83d\ude34\ud83c\udf1f\ud83d\ude2c\ud83d\ude43\ud83c\udf40\ud83c\udf37\ud83d\ude3b\ud83d\ude13\u2b50\u2705\ud83e\udd7a\ud83c\udf08\ud83d\ude08\ud83e\udd18\ud83d\udca6\u2714\ud83d\ude23\ud83c\udfc3\ud83d\udc90\u2639\ud83c\udf8a\ud83d\udc98\ud83d\ude20\u261d\ud83d\ude15\ud83c\udf3a\ud83c\udf82\ud83c\udf3b\ud83d\ude10\ud83d\udd95\ud83d\udc9d\ud83d\ude4a\ud83d\ude39\ud83d\udde3\ud83d\udcab\ud83d\udc80\ud83d\udc51\ud83c\udfb5\ud83e\udd1e\ud83d\ude1b\ud83d\udd34\ud83d\ude24\ud83c\udf3c\ud83d\ude2b\u26bd\ud83e\udd19\u2615\ud83c\udfc6\ud83e\udd2b\ud83d\udc48\ud83d\ude2e\ud83d\ude46\ud83c\udf7b\ud83c\udf43\ud83d\udc36\ud83d\udc81\ud83d\ude32\ud83c\udf3f\ud83e\udde1\ud83c\udf81\u26a1\ud83c\udf1e\ud83c\udf88\u274c\u270a\ud83d\udc4b\ud83d\ude30\ud83e\udd28\ud83d\ude36\ud83e\udd1d\ud83d\udeb6\ud83d\udcb0\ud83c\udf53\ud83d\udca2\ud83e\udd1f\ud83d\ude41\ud83d\udea8\ud83d\udca8\ud83e\udd2c\u2708\ud83c\udf80\ud83c\udf7a\ud83e\udd13\ud83d\ude19\ud83d\udc9f\ud83c\udf31\ud83d\ude16\ud83d\udc76\ud83e\udd74\u25b6\u27a1\u2753\ud83d\udc8e\ud83d\udcb8\u2b07\ud83d\ude28\ud83c\udf1a\ud83e\udd8b\ud83d\ude37\ud83d\udd7a\u26a0\ud83d\ude45\ud83d\ude1f\ud83d\ude35\ud83d\udc4e\ud83e\udd32\ud83e\udd20\ud83e\udd27\ud83d\udccc\ud83d\udd35\ud83d\udc85\ud83e\uddd0\ud83d\udc3e\ud83c\udf52\ud83d\ude17\ud83e\udd11\ud83c\udf0a\ud83e\udd2f\ud83d\udc37\u260e\ud83d\udca7\ud83d\ude2f\ud83d\udc86\ud83d\udc46\ud83c\udfa4\ud83d\ude47\ud83c\udf51\u2744\ud83c\udf34\ud83d\udca3\ud83d\udc38\ud83d\udc8c\ud83d\udccd\ud83e\udd40\ud83e\udd22\ud83d\udc45\ud83d\udca1\ud83d\udca9\ud83d\udc50\ud83d\udcf8\ud83d\udc7b\ud83e\udd10\ud83e\udd2e\ud83c\udfbc\ud83e\udd75\ud83d\udea9\ud83c\udf4e\ud83c\udf4a\ud83d\udc7c\ud83d\udc8d\ud83d\udce3\ud83e\udd42"),TP=CP.reduce(((e,t,n)=>(e[n]=t,e)),[]),kP=CP.reduce(((e,t,n)=>(e[t.codePointAt(0)]=n,e)),[]);const RP=mP({prefix:"\ud83d\ude80",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=TP[t]),"")},decode:function(e){const t=[];for(const n of e){const e=kP[n.codePointAt(0)];if(void 0===e)throw new Error("Non-base256emoji character: ".concat(n));t.push(e)}return new Uint8Array(t)}}),xP=bP({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),PP=bP({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),DP=bP({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),OP=bP({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),NP=bP({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),BP=bP({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),LP=bP({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),MP=bP({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),UP=bP({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),FP=vP({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),KP=vP({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),jP=bP({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),ZP=bP({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),zP=bP({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),VP=bP({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),HP=bP({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),qP=mP({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),GP=new TextEncoder,WP=new TextDecoder,QP="json",YP=512,JP=e=>GP.encode(JSON.stringify(e)),XP=e=>JSON.parse(WP.decode(e)),$P="raw",eD=85,tD=e=>hP(e),nD=e=>hP(e);var rD=function e(t,n,r){n=n||[];var i=r=r||0;for(;t>=sD;)n[r++]=255&t|iD,t/=128;for(;t&oD;)n[r++]=255&t|iD,t>>>=7;return n[r]=0|t,e.bytes=r-i+1,n},iD=128,oD=-128,sD=Math.pow(2,31);var aD=function e(t,n){var r,i=0,o=0,s=n=n||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");r=t[s++],i+=o<28?(r&lD)<<o:(r&lD)*Math.pow(2,o),o+=7}while(r>=cD);return e.bytes=s-n,i},cD=128,lD=127;var uD=Math.pow(2,7),hD=Math.pow(2,14),dD=Math.pow(2,21),fD=Math.pow(2,28),pD=Math.pow(2,35),gD=Math.pow(2,42),yD=Math.pow(2,49),mD=Math.pow(2,56),vD=Math.pow(2,63);const bD={encode:rD,decode:aD,encodingLength:function(e){return e<uD?1:e<hD?2:e<dD?3:e<fD?4:e<pD?5:e<gD?6:e<yD?7:e<mD?8:e<vD?9:10}},wD=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return[bD.decode(e,t),bD.decode.bytes]},ED=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return bD.encode(e,t,n),t},AD=e=>bD.encodingLength(e),SD=(e,t)=>{const n=t.byteLength,r=AD(e),i=r+AD(n),o=new Uint8Array(i+n);return ED(e,o,0),ED(n,o,r),o.set(t,i),new ID(e,n,t,o)},_D=e=>{const t=hP(e),[n,r]=wD(t),[i,o]=wD(t.subarray(r)),s=t.subarray(r+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new ID(n,i,s,t)};class ID{constructor(e,t,n,r){this.code=e,this.size=t,this.digest=n,this.bytes=r}}const CD=hP,TD={code:0,name:"identity",encode:CD,digest:e=>SD(0,CD(e))},kD=e=>{let{name:t,code:n,encode:r}=e;return new RD(t,n,r)};class RD{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?SD(this.code,t):t.then((e=>SD(this.code,e)))}throw Error("Unknown type, must be binary type")}}const xD=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),PD=kD({name:"sha2-256",code:18,encode:xD("SHA-256")}),DD=kD({name:"sha2-512",code:19,encode:xD("SHA-512")}),OD=(e,t)=>{const{bytes:n,version:r}=e;return 0===r?UD(n,BD(e),t||wP.encoder):FD(n,BD(e),t||xP.encoder)},ND=new WeakMap,BD=e=>{const t=ND.get(e);if(null==t){const t=new Map;return ND.set(e,t),t}return t};class LD{constructor(e,t,n,r){this.code=t,this.version=e,this.multihash=n,this.bytes=r,this["/"]=r}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==KD)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==jD)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return LD.createV0(t)}default:throw Error("Can not convert CID version ".concat(this.version," to version 0. This is a bug please report"))}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=SD(e,t);return LD.createV1(this.code,n)}case 1:return this;default:throw Error("Can not convert CID version ".concat(this.version," to version 1. This is a bug please report"))}}equals(e){return LD.equals(this,e)}static equals(e,t){const n=t;return n&&e.code===n.code&&e.version===n.version&&((e,t)=>{if(e===t)return!0;{const n=t;return e.code===n.code&&e.size===n.size&&n.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0})(e.bytes,n.bytes)}})(e.multihash,n.multihash)}toString(e){return OD(this,e)}toJSON(){return{"/":OD(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID(".concat(this.toString(),")")}static asCID(e){if(null==e)return null;const t=e;if(t instanceof LD)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:n,multihash:r,bytes:i}=t;return new LD(e,n,r,i||ZD(e,n,r.bytes))}if(!0===t[zD]){const{version:e,multihash:n,code:r}=t,i=_D(n);return LD.create(e,r,i)}return null}static create(e,t,n){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==KD)throw new Error("Version 0 CID must use dag-pb (code: ".concat(KD,") block encoding"));return new LD(e,t,n,n.bytes);case 1:{const r=ZD(e,t,n.bytes);return new LD(e,t,n,r)}default:throw new Error("Invalid version")}}static createV0(e){return LD.create(0,KD,e)}static createV1(e,t){return LD.create(1,e,t)}static decode(e){const[t,n]=LD.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=LD.inspectBytes(e),n=t.size-t.multihashSize,r=hP(e.subarray(n,n+t.multihashSize));if(r.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=r.subarray(t.multihashSize-t.digestSize),o=new ID(t.multihashCode,t.digestSize,i,r);return[0===t.version?LD.createV0(o):LD.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[n,r]=wD(e.subarray(t));return t+=r,n};let r=n(),i=KD;if(18===r?(r=0,t=0):i=n(),0!==r&&1!==r)throw new RangeError("Invalid CID version ".concat(r));const o=t,s=n(),a=n(),c=t+a;return{version:r,codec:i,multihashCode:s,digestSize:a,multihashSize:c-o,size:c}}static parse(e,t){const[n,r]=MD(e,t),i=LD.decode(r);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return BD(i).set(n,e),i}}const MD=(e,t)=>{switch(e[0]){case"Q":{const n=t||wP;return[wP.prefix,n.decode("".concat(wP.prefix).concat(e))]}case wP.prefix:{const n=t||wP;return[wP.prefix,n.decode(e)]}case xP.prefix:{const n=t||xP;return[xP.prefix,n.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},UD=(e,t,n)=>{const{prefix:r}=n;if(r!==wP.prefix)throw Error("Cannot string encode V0 in ".concat(n.name," encoding"));const i=t.get(r);if(null==i){const i=n.encode(e).slice(1);return t.set(r,i),i}return i},FD=(e,t,n)=>{const{prefix:r}=n,i=t.get(r);if(null==i){const i=n.encode(e);return t.set(r,i),i}return i},KD=112,jD=18,ZD=(e,t,n)=>{const r=AD(e),i=r+AD(t),o=new Uint8Array(i+n.byteLength);return ED(e,o,0),ED(t,o,r),o.set(n,i),o},zD=Symbol.for("@ipld/js-cid/CID"),VD={...tt,...Qe,...et,...Ge,...We,...Je,...Xe,...qe,...$e,...Ye},HD=Symbol.for("nodejs.util.inspect.custom"),qD=Object.values(VD).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)),VD.identity.decoder),GD=114,WD=36,QD=37;class YD{constructor(e){(0,Yo.Z)(this,"type",void 0),(0,Yo.Z)(this,"multihash",void 0),(0,Yo.Z)(this,"privateKey",void 0),(0,Yo.Z)(this,"publicKey",void 0),(0,Yo.Z)(this,"string",void 0),(0,Yo.Z)(this,fu.Cs,!0),this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return"PeerId(".concat(this.toString(),")")}toString(){return null==this.string&&(this.string=wP.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return LD.createV1(GD,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){var t;if(e instanceof Uint8Array)return(0,Ms.f)(this.multihash.bytes,e);if("string"===typeof e)return function(e,t){var n;if(t=null!==(n=t)&&void 0!==n?n:qD,"1"===e.charAt(0)||"Q"===e.charAt(0)){const t=_D(wP.decode("z".concat(e)));return e.startsWith("12D")?new XD({multihash:t}):e.startsWith("16U")?new $D({multihash:t}):new JD({multihash:t})}return function(e){try{const t=_D(e);if(t.code===TD.code){if(t.digest.length===WD)return new XD({multihash:t});if(t.digest.length===QD)return new $D({multihash:t})}if(t.code===PD.code)return new JD({multihash:t})}catch{return function(e){if(null==e||null==e.multihash||null==e.version||1===e.version&&e.code!==GD)throw new Error("Supplied PeerID CID is invalid");const t=e.multihash;if(t.code===PD.code)return new JD({multihash:e.multihash});if(t.code===TD.code){if(t.digest.length===WD)return new XD({multihash:e.multihash});if(t.digest.length===QD)return new $D({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}(LD.decode(e))}throw new Error("Supplied PeerID CID is invalid")}(qD.decode(e))}(e).equals(this);if(null!=(null===e||void 0===e||null===(t=e.multihash)||void 0===t?void 0:t.bytes))return(0,Ms.f)(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[HD](){return"PeerId(".concat(this.toString(),")")}}class JD extends YD{constructor(e){super({...e,type:"RSA"}),(0,Yo.Z)(this,"type","RSA"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.publicKey}}class XD extends YD{constructor(e){super({...e,type:"Ed25519"}),(0,Yo.Z)(this,"type","Ed25519"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.multihash.digest}}class $D extends YD{constructor(e){super({...e,type:"secp256k1"}),(0,Yo.Z)(this,"type","secp256k1"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.multihash.digest}}async function eO(e,t){return e.length===WD?new XD({multihash:SD(TD.code,e),privateKey:t}):e.length===QD?new $D({multihash:SD(TD.code,e),privateKey:t}):new JD({multihash:await PD.digest(e),publicKey:e,privateKey:t})}var tO=n(25546),nO=n(82193),rO=n.n(nO);const iO="object"===typeof window&&"object"===typeof document&&9===document.nodeType,oO=rO()(),sO=iO&&!oO,aO=oO&&!iO,cO=oO&&iO,lO="undefined"!==typeof globalThis.process&&"undefined"!==typeof globalThis.process.release&&"node"===globalThis.process.release.name&&!oO,uO="function"===typeof importScripts&&"undefined"!==typeof self&&"undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope,hO=("undefined"!==typeof globalThis.process&&"undefined"!==typeof globalThis.process.env&&globalThis.process.env.NODE_ENV,"undefined"!==typeof navigator&&"ReactNative"===navigator.product);var dO;!function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==n.lengthDelimited&&t.fork(),null!=e.protocolVersion&&(t.uint32(42),t.string(e.protocolVersion)),null!=e.agentVersion&&(t.uint32(50),t.string(e.agentVersion)),null!=e.publicKey&&(t.uint32(10),t.bytes(e.publicKey)),null!=e.listenAddrs)for(const r of e.listenAddrs)t.uint32(18),t.bytes(r);if(null!=e.observedAddr&&(t.uint32(34),t.bytes(e.observedAddr)),null!=e.protocols)for(const r of e.protocols)t.uint32(26),t.string(r);null!=e.signedPeerRecord&&(t.uint32(66),t.bytes(e.signedPeerRecord)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={listenAddrs:[],protocols:[]},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 5:n.protocolVersion=e.string();break;case 6:n.agentVersion=e.string();break;case 1:n.publicKey=e.bytes();break;case 2:n.listenAddrs.push(e.bytes());break;case 4:n.observedAddr=e.bytes();break;case 3:n.protocols.push(e.string());break;case 8:n.signedPeerRecord=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(dO||(dO={}));const fO=8192,pO="ipfs",gO=6e4,yO=1,mO=1,vO=1,bO=1,wO=10,EO=8192,AO=!0,SO=!0;var _O=new WeakSet;class IO{constructor(e){var t,n,r,i,o,s,a,c,l,u,h,d,f;let p=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Qd(this,_O),(0,Yo.Z)(this,"identifyProtocolStr",void 0),(0,Yo.Z)(this,"identifyPushProtocolStr",void 0),(0,Yo.Z)(this,"host",void 0),(0,Yo.Z)(this,"started",void 0),(0,Yo.Z)(this,"timeout",void 0),(0,Yo.Z)(this,"peerId",void 0),(0,Yo.Z)(this,"peerStore",void 0),(0,Yo.Z)(this,"registrar",void 0),(0,Yo.Z)(this,"connectionManager",void 0),(0,Yo.Z)(this,"addressManager",void 0),(0,Yo.Z)(this,"maxInboundStreams",void 0),(0,Yo.Z)(this,"maxOutboundStreams",void 0),(0,Yo.Z)(this,"maxPushIncomingStreams",void 0),(0,Yo.Z)(this,"maxPushOutgoingStreams",void 0),(0,Yo.Z)(this,"maxIdentifyMessageSize",void 0),(0,Yo.Z)(this,"maxObservedAddresses",void 0),(0,Yo.Z)(this,"events",void 0),(0,Yo.Z)(this,"runOnTransientConnection",void 0),(0,Yo.Z)(this,"log",void 0),this.started=!1,this.peerId=e.peerId,this.peerStore=e.peerStore,this.registrar=e.registrar,this.addressManager=e.addressManager,this.connectionManager=e.connectionManager,this.events=e.events,this.log=e.logger.forComponent("libp2p:identify"),this.identifyProtocolStr="/".concat(null!==(t=p.protocolPrefix)&&void 0!==t?t:pO,"/").concat("id","/").concat("1.0.0"),this.identifyPushProtocolStr="/".concat(null!==(n=p.protocolPrefix)&&void 0!==n?n:pO,"/").concat("id/push","/").concat("1.0.0"),this.timeout=null!==(r=p.timeout)&&void 0!==r?r:gO,this.maxInboundStreams=null!==(i=p.maxInboundStreams)&&void 0!==i?i:yO,this.maxOutboundStreams=null!==(o=p.maxOutboundStreams)&&void 0!==o?o:mO,this.maxPushIncomingStreams=null!==(s=p.maxPushIncomingStreams)&&void 0!==s?s:vO,this.maxPushOutgoingStreams=null!==(a=p.maxPushOutgoingStreams)&&void 0!==a?a:bO,this.maxIdentifyMessageSize=null!==(c=p.maxIdentifyMessageSize)&&void 0!==c?c:EO,this.maxObservedAddresses=null!==(l=p.maxObservedAddresses)&&void 0!==l?l:wO,this.runOnTransientConnection=null!==(u=p.runOnTransientConnection)&&void 0!==u?u:SO,this.host={protocolVersion:"".concat(null!==(h=p.protocolPrefix)&&void 0!==h?h:pO,"/").concat("0.1.0"),agentVersion:null!==(d=p.agentVersion)&&void 0!==d?d:"".concat(e.nodeInfo.name,"/").concat(e.nodeInfo.version)},(null!==(f=p.runOnConnectionOpen)&&void 0!==f?f:AO)&&e.events.addEventListener("connection:open",(e=>{const t=e.detail;this.identify(t).catch((e=>{this.log.error("error during identify trigged by connection:open",e)}))})),e.events.addEventListener("self:peer:update",(e=>{this.push().catch((e=>{this.log.error(e)}))})),this.host.agentVersion==="".concat(e.nodeInfo.name,"/").concat(e.nodeInfo.version)&&(lO||aO?this.host.agentVersion+=" UserAgent=".concat(globalThis.process.version):(sO||uO||cO||hO)&&(this.host.agentVersion+=" UserAgent=".concat(globalThis.navigator.userAgent)))}isStarted(){return this.started}async start(){this.started||(await this.peerStore.merge(this.peerId,{metadata:{AgentVersion:(0,yu.m)(this.host.agentVersion),ProtocolVersion:(0,yu.m)(this.host.protocolVersion)}}),await this.registrar.handle(this.identifyProtocolStr,(e=>{this._handleIdentify(e).catch((e=>{this.log.error(e)}))}),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams,runOnTransientConnection:this.runOnTransientConnection}),await this.registrar.handle(this.identifyPushProtocolStr,(e=>{this._handlePush(e).catch((e=>{this.log.error(e)}))}),{maxInboundStreams:this.maxPushIncomingStreams,maxOutboundStreams:this.maxPushOutgoingStreams,runOnTransientConnection:this.runOnTransientConnection}),this.started=!0)}async stop(){await this.registrar.unhandle(this.identifyProtocolStr),await this.registrar.unhandle(this.identifyPushProtocolStr),this.started=!1}async pushToConnections(e){var t,n;const r=this.addressManager.getAddresses().map((e=>e.decapsulateCode((0,ng.a_)("p2p").code))),i=new nk({peerId:this.peerId,multiaddrs:r}),o=await XT.seal(i,this.peerId),s=this.registrar.getProtocols(),a=await this.peerStore.get(this.peerId),c=(0,Au.B)(null!==(t=a.metadata.get("AgentVersion"))&&void 0!==t?t:(0,yu.m)(this.host.agentVersion)),l=(0,Au.B)(null!==(n=a.metadata.get("ProtocolVersion"))&&void 0!==n?n:(0,yu.m)(this.host.protocolVersion)),u=e.map((async e=>{let t;const n=AbortSignal.timeout(this.timeout);(0,fu.Wp)(1/0,n);try{var i;t=await e.newStream(this.identifyPushProtocolStr,{signal:n,runOnTransientConnection:this.runOnTransientConnection});const a=rk(t,{maxDataLength:null!==(i=this.maxIdentifyMessageSize)&&void 0!==i?i:fO}).pb(dO);await a.write({listenAddrs:r.map((e=>e.bytes)),signedPeerRecord:o.marshal(),protocols:s,agentVersion:c,protocolVersion:l},{signal:n}),await t.close({signal:n})}catch(u){var a;this.log.error("could not push identify update to peer",u),null===(a=t)||void 0===a||a.abort(u)}}));await Promise.all(u)}async push(){if(!this.isStarted())return;const e=[];await Promise.all(this.connectionManager.getConnections().map((async t=>{try{if(!(await this.peerStore.get(t.remotePeer)).protocols.includes(this.identifyPushProtocolStr))return;e.push(t)}catch(n){if(n.code!==fu.Vc)throw n}}))),await this.pushToConnections(e)}async _identify(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null==n.signal){const e=AbortSignal.timeout(this.timeout);(0,fu.Wp)(1/0,e),n={...n,signal:e}}try{var r;t=await e.newStream(this.identifyProtocolStr,{...n,runOnTransientConnection:this.runOnTransientConnection});const i=rk(t,{maxDataLength:null!==(r=this.maxIdentifyMessageSize)&&void 0!==r?r:fO}).pb(dO),o=await i.read(n);return await t.close(n),o}catch(o){var i;throw this.log.error("error while reading identify message",o),null===(i=t)||void 0===i||i.abort(o),o}}async identify(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=await this._identify(e,n),{publicKey:i,protocols:o,observedAddr:s}=r;if(null==i)throw new fu.sv("public key was missing from identify message","ERR_MISSING_PUBLIC_KEY");const a=await eO(i);if(!e.remotePeer.equals(a))throw new fu.sv("identified peer does not match the expected peer","ERR_INVALID_PEER");if(this.peerId.equals(a))throw new fu.sv("identified peer is our own peer id?","ERR_INVALID_PEER");const c=function(e){if(null!=e&&e.length>0)try{return(0,ng.HM)(e)}catch{}}(s);return this.log("identify completed for peer %p and protocols %o",a,o),this.log("our observed address is %a",c),null!=c&&this.addressManager.getObservedAddrs().length<(null!==(t=this.maxObservedAddresses)&&void 0!==t?t:1/0)&&(this.log("storing our observed address %a",c),this.addressManager.addObservedAddr(c)),Yd(this,_O,CO).call(this,e,r)}async _handleIdentify(e){const{connection:t,stream:n}=e,r=AbortSignal.timeout(this.timeout);(0,fu.Wp)(1/0,r);try{var i;const e=null!==(i=this.peerId.publicKey)&&void 0!==i?i:new Uint8Array(0),o=await this.peerStore.get(this.peerId),s=this.addressManager.getAddresses().map((e=>e.decapsulateCode((0,ng.a_)("p2p").code)));let a=o.peerRecordEnvelope;if(s.length>0&&null==a){const e=new nk({peerId:this.peerId,multiaddrs:s});a=(await XT.seal(e,this.peerId)).marshal().subarray()}let c=t.remoteAddr.bytes;tO.Iq.matches(t.remoteAddr)||(c=void 0);const l=rk(n).pb(dO);await l.write({protocolVersion:this.host.protocolVersion,agentVersion:this.host.agentVersion,publicKey:e,listenAddrs:s.map((e=>e.bytes)),signedPeerRecord:a,observedAddr:c,protocols:o.protocols},{signal:r}),await n.close({signal:r})}catch(o){this.log.error("could not respond to identify request",o),n.abort(o)}}async _handlePush(e){const{connection:t,stream:n}=e;try{var r;if(this.peerId.equals(t.remotePeer))throw new Error("received push from ourselves?");const e={signal:AbortSignal.timeout(this.timeout)},i=rk(n,{maxDataLength:null!==(r=this.maxIdentifyMessageSize)&&void 0!==r?r:fO}).pb(dO),o=await i.read(e);await n.close(e),await Yd(this,_O,CO).call(this,t,o)}catch(i){return this.log.error("received invalid message",i),void n.abort(i)}this.log("handled push from %p",t.remotePeer)}}async function CO(e,t){if(this.log("received identify from %p",e.remotePeer),null==t)throw new fu.sv("message was null or undefined","ERR_INVALID_MESSAGE");const n={};if(t.listenAddrs.length>0&&(n.addresses=t.listenAddrs.map((e=>({isCertified:!1,multiaddr:(0,ng.HM)(e)})))),t.protocols.length>0&&(n.protocols=t.protocols),null!=t.publicKey){n.publicKey=t.publicKey;if(!(await eO(t.publicKey)).equals(e.remotePeer))throw new fu.sv("public key did not match remote PeerId","ERR_INVALID_PUBLIC_KEY")}let r;if(null!=t.signedPeerRecord){this.log("received signedPeerRecord from %p",e.remotePeer);let i=t.signedPeerRecord;const s=await XT.openAndCertify(i,nk.DOMAIN);let a,c=nk.createFromProtobuf(s.payload);if(!c.peerId.equals(s.peerId))throw new fu.sv("signing key does not match PeerId in the PeerRecord","ERR_INVALID_SIGNING_KEY");if(!e.remotePeer.equals(c.peerId))throw new fu.sv("signing key does not match remote PeerId","ERR_INVALID_PEER_RECORD_KEY");try{a=await this.peerStore.get(c.peerId)}catch(o){if("ERR_NOT_FOUND"!==o.code)throw o}if(null!=a&&(n.metadata=a.metadata,null!=a.peerRecordEnvelope)){const e=await XT.createFromProtobuf(a.peerRecordEnvelope),t=nk.createFromProtobuf(e.payload);t.seqNumber>=c.seqNumber&&(this.log("sequence number was lower or equal to existing sequence number - stored: %d received: %d",t.seqNumber,c.seqNumber),c=t,i=a.peerRecordEnvelope)}n.peerRecordEnvelope=i,n.addresses=c.multiaddrs.map((e=>({isCertified:!0,multiaddr:e}))),r={seq:c.seqNumber,addresses:c.multiaddrs}}else this.log("%p did not send a signed peer record",e.remotePeer);if(this.log("patching %p with",e.remotePeer,n),await this.peerStore.patch(e.remotePeer,n),null!=t.agentVersion||null!=t.protocolVersion){const n={};null!=t.agentVersion&&(n.AgentVersion=(0,yu.m)(t.agentVersion)),null!=t.protocolVersion&&(n.ProtocolVersion=(0,yu.m)(t.protocolVersion)),this.log("merging %p metadata",e.remotePeer,n),await this.peerStore.merge(e.remotePeer,{metadata:n})}const i={peerId:e.remotePeer,protocolVersion:t.protocolVersion,agentVersion:t.agentVersion,publicKey:t.publicKey,listenAddrs:t.listenAddrs.map((e=>(0,ng.HM)(e))),observedAddr:null==t.observedAddr?void 0:(0,ng.HM)(t.observedAddr),protocols:t.protocols,signedPeerRecord:r,connection:e};return this.events.safeDispatchEvent("peer:identify",{detail:i}),i}function TO(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>new IO(t,e)}var kO=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==n[s])throw new TypeError(o+" is ambiguous");n[s]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var r=0,i=0;e[t]===c;)r++,t++;for(var o=(e.length-t)*l+1>>>0,s=new Uint8Array(o);e[t];){var u=n[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=o-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*s[d]>>>0,s[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=o-i;f!==o&&0===s[f];)f++;for(var p=new Uint8Array(r+(o-f)),g=r;f!==o;)p[g++]=s[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,o=t.length;i!==o&&0===t[i];)i++,n++;for(var s=(o-i)*u+1>>>0,l=new Uint8Array(s);i!==o;){for(var h=t[i],d=0,f=s-1;(0!==h||d<r)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");r=d,i++}for(var p=s-r;p!==s&&0===l[p];)p++;for(var g=c.repeat(n);p<s;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:h,decode:function(e){var n=h(e);if(n)return n;throw new Error("Non-".concat(t," character"))}}};const RO=kO,xO=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class PO{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(e));throw Error("Unknown type, must be binary type")}}class DO{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(e),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return NO(this,e)}}class OO{constructor(e){this.decoders=e}or(e){return NO(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(e),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}}const NO=(e,t)=>new OO({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class BO{constructor(e,t,n,r){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=r,this.encoder=new PO(e,t,n),this.decoder=new DO(e,t,r)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const LO=e=>{let{name:t,prefix:n,encode:r,decode:i}=e;return new BO(t,n,r,i)},MO=e=>{let{prefix:t,name:n,alphabet:r}=e;const{encode:i,decode:o}=RO(r,n);return LO({prefix:t,name:n,encode:i,decode:e=>xO(o(e))})},UO=e=>{let{name:t,prefix:n,bitsPerChar:r,alphabet:i}=e;return LO({prefix:n,name:t,encode:e=>((e,t,n)=>{const r="="===t[t.length-1],i=(1<<n)-1;let o="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>n;)s-=n,o+=t[i&a>>s];if(s&&(o+=t[i&a<<n-s]),r)for(;o.length*n&7;)o+="=";return o})(e,i,r),decode:e=>((e,t,n,r)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*n/8|0);let a=0,c=0,l=0;for(let u=0;u<o;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError("Non-".concat(r," character"));c=c<<n|t,a+=n,a>=8&&(a-=8,s[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s})(e,i,r,t)})},FO=MO({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),KO=MO({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),jO=MO({prefix:"9",name:"base10",alphabet:"0123456789"}),ZO=UO({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),zO=UO({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),VO=UO({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),HO=Array.from("\ud83d\ude80\ud83e\ude90\u2604\ud83d\udef0\ud83c\udf0c\ud83c\udf11\ud83c\udf12\ud83c\udf13\ud83c\udf14\ud83c\udf15\ud83c\udf16\ud83c\udf17\ud83c\udf18\ud83c\udf0d\ud83c\udf0f\ud83c\udf0e\ud83d\udc09\u2600\ud83d\udcbb\ud83d\udda5\ud83d\udcbe\ud83d\udcbf\ud83d\ude02\u2764\ud83d\ude0d\ud83e\udd23\ud83d\ude0a\ud83d\ude4f\ud83d\udc95\ud83d\ude2d\ud83d\ude18\ud83d\udc4d\ud83d\ude05\ud83d\udc4f\ud83d\ude01\ud83d\udd25\ud83e\udd70\ud83d\udc94\ud83d\udc96\ud83d\udc99\ud83d\ude22\ud83e\udd14\ud83d\ude06\ud83d\ude44\ud83d\udcaa\ud83d\ude09\u263a\ud83d\udc4c\ud83e\udd17\ud83d\udc9c\ud83d\ude14\ud83d\ude0e\ud83d\ude07\ud83c\udf39\ud83e\udd26\ud83c\udf89\ud83d\udc9e\u270c\u2728\ud83e\udd37\ud83d\ude31\ud83d\ude0c\ud83c\udf38\ud83d\ude4c\ud83d\ude0b\ud83d\udc97\ud83d\udc9a\ud83d\ude0f\ud83d\udc9b\ud83d\ude42\ud83d\udc93\ud83e\udd29\ud83d\ude04\ud83d\ude00\ud83d\udda4\ud83d\ude03\ud83d\udcaf\ud83d\ude48\ud83d\udc47\ud83c\udfb6\ud83d\ude12\ud83e\udd2d\u2763\ud83d\ude1c\ud83d\udc8b\ud83d\udc40\ud83d\ude2a\ud83d\ude11\ud83d\udca5\ud83d\ude4b\ud83d\ude1e\ud83d\ude29\ud83d\ude21\ud83e\udd2a\ud83d\udc4a\ud83e\udd73\ud83d\ude25\ud83e\udd24\ud83d\udc49\ud83d\udc83\ud83d\ude33\u270b\ud83d\ude1a\ud83d\ude1d\ud83d\ude34\ud83c\udf1f\ud83d\ude2c\ud83d\ude43\ud83c\udf40\ud83c\udf37\ud83d\ude3b\ud83d\ude13\u2b50\u2705\ud83e\udd7a\ud83c\udf08\ud83d\ude08\ud83e\udd18\ud83d\udca6\u2714\ud83d\ude23\ud83c\udfc3\ud83d\udc90\u2639\ud83c\udf8a\ud83d\udc98\ud83d\ude20\u261d\ud83d\ude15\ud83c\udf3a\ud83c\udf82\ud83c\udf3b\ud83d\ude10\ud83d\udd95\ud83d\udc9d\ud83d\ude4a\ud83d\ude39\ud83d\udde3\ud83d\udcab\ud83d\udc80\ud83d\udc51\ud83c\udfb5\ud83e\udd1e\ud83d\ude1b\ud83d\udd34\ud83d\ude24\ud83c\udf3c\ud83d\ude2b\u26bd\ud83e\udd19\u2615\ud83c\udfc6\ud83e\udd2b\ud83d\udc48\ud83d\ude2e\ud83d\ude46\ud83c\udf7b\ud83c\udf43\ud83d\udc36\ud83d\udc81\ud83d\ude32\ud83c\udf3f\ud83e\udde1\ud83c\udf81\u26a1\ud83c\udf1e\ud83c\udf88\u274c\u270a\ud83d\udc4b\ud83d\ude30\ud83e\udd28\ud83d\ude36\ud83e\udd1d\ud83d\udeb6\ud83d\udcb0\ud83c\udf53\ud83d\udca2\ud83e\udd1f\ud83d\ude41\ud83d\udea8\ud83d\udca8\ud83e\udd2c\u2708\ud83c\udf80\ud83c\udf7a\ud83e\udd13\ud83d\ude19\ud83d\udc9f\ud83c\udf31\ud83d\ude16\ud83d\udc76\ud83e\udd74\u25b6\u27a1\u2753\ud83d\udc8e\ud83d\udcb8\u2b07\ud83d\ude28\ud83c\udf1a\ud83e\udd8b\ud83d\ude37\ud83d\udd7a\u26a0\ud83d\ude45\ud83d\ude1f\ud83d\ude35\ud83d\udc4e\ud83e\udd32\ud83e\udd20\ud83e\udd27\ud83d\udccc\ud83d\udd35\ud83d\udc85\ud83e\uddd0\ud83d\udc3e\ud83c\udf52\ud83d\ude17\ud83e\udd11\ud83c\udf0a\ud83e\udd2f\ud83d\udc37\u260e\ud83d\udca7\ud83d\ude2f\ud83d\udc86\ud83d\udc46\ud83c\udfa4\ud83d\ude47\ud83c\udf51\u2744\ud83c\udf34\ud83d\udca3\ud83d\udc38\ud83d\udc8c\ud83d\udccd\ud83e\udd40\ud83e\udd22\ud83d\udc45\ud83d\udca1\ud83d\udca9\ud83d\udc50\ud83d\udcf8\ud83d\udc7b\ud83e\udd10\ud83e\udd2e\ud83c\udfbc\ud83e\udd75\ud83d\udea9\ud83c\udf4e\ud83c\udf4a\ud83d\udc7c\ud83d\udc8d\ud83d\udce3\ud83e\udd42"),qO=HO.reduce(((e,t,n)=>(e[n]=t,e)),[]),GO=HO.reduce(((e,t,n)=>(e[t.codePointAt(0)]=n,e)),[]);const WO=LO({prefix:"\ud83d\ude80",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=qO[t]),"")},decode:function(e){const t=[];for(const n of e){const e=GO[n.codePointAt(0)];if(void 0===e)throw new Error("Non-base256emoji character: ".concat(n));t.push(e)}return new Uint8Array(t)}}),QO=UO({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),YO=UO({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),JO=UO({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),XO=UO({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),$O=UO({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),eN=UO({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),tN=UO({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),nN=UO({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),rN=UO({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),iN=MO({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),oN=MO({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),sN=UO({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),aN=UO({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),cN=UO({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),lN=UO({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),uN=UO({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),hN=LO({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),dN=new TextEncoder,fN=new TextDecoder,pN="json",gN=512,yN=e=>dN.encode(JSON.stringify(e)),mN=e=>JSON.parse(fN.decode(e)),vN="raw",bN=85,wN=e=>xO(e),EN=e=>xO(e);var AN=function e(t,n,r){n=n||[];var i=r=r||0;for(;t>=IN;)n[r++]=255&t|SN,t/=128;for(;t&_N;)n[r++]=255&t|SN,t>>>=7;return n[r]=0|t,e.bytes=r-i+1,n},SN=128,_N=-128,IN=Math.pow(2,31);var CN=function e(t,n){var r,i=0,o=0,s=n=n||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");r=t[s++],i+=o<28?(r&kN)<<o:(r&kN)*Math.pow(2,o),o+=7}while(r>=TN);return e.bytes=s-n,i},TN=128,kN=127;var RN=Math.pow(2,7),xN=Math.pow(2,14),PN=Math.pow(2,21),DN=Math.pow(2,28),ON=Math.pow(2,35),NN=Math.pow(2,42),BN=Math.pow(2,49),LN=Math.pow(2,56),MN=Math.pow(2,63);const UN={encode:AN,decode:CN,encodingLength:function(e){return e<RN?1:e<xN?2:e<PN?3:e<DN?4:e<ON?5:e<NN?6:e<BN?7:e<LN?8:e<MN?9:10}},FN=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return[UN.decode(e,t),UN.decode.bytes]},KN=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return UN.encode(e,t,n),t},jN=e=>UN.encodingLength(e),ZN=(e,t)=>{const n=t.byteLength,r=jN(e),i=r+jN(n),o=new Uint8Array(i+n);return KN(e,o,0),KN(n,o,r),o.set(t,i),new VN(e,n,t,o)},zN=e=>{const t=xO(e),[n,r]=FN(t),[i,o]=FN(t.subarray(r)),s=t.subarray(r+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new VN(n,i,s,t)};class VN{constructor(e,t,n,r){this.code=e,this.size=t,this.digest=n,this.bytes=r}}const HN=xO,qN={code:0,name:"identity",encode:HN,digest:e=>ZN(0,HN(e))},GN=e=>{let{name:t,code:n,encode:r}=e;return new WN(t,n,r)};class WN{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?ZN(this.code,t):t.then((e=>ZN(this.code,e)))}throw Error("Unknown type, must be binary type")}}const QN=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),YN=GN({name:"sha2-256",code:18,encode:QN("SHA-256")}),JN=GN({name:"sha2-512",code:19,encode:QN("SHA-512")}),XN=(e,t)=>{const{bytes:n,version:r}=e;return 0===r?rB(n,eB(e),t||FO.encoder):iB(n,eB(e),t||QO.encoder)},$N=new WeakMap,eB=e=>{const t=$N.get(e);if(null==t){const t=new Map;return $N.set(e,t),t}return t};class tB{constructor(e,t,n,r){this.code=t,this.version=e,this.multihash=n,this.bytes=r,this["/"]=r}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==oB)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==sB)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return tB.createV0(t)}default:throw Error("Can not convert CID version ".concat(this.version," to version 0. This is a bug please report"))}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=ZN(e,t);return tB.createV1(this.code,n)}case 1:return this;default:throw Error("Can not convert CID version ".concat(this.version," to version 1. This is a bug please report"))}}equals(e){return tB.equals(this,e)}static equals(e,t){const n=t;return n&&e.code===n.code&&e.version===n.version&&((e,t)=>{if(e===t)return!0;{const n=t;return e.code===n.code&&e.size===n.size&&n.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0})(e.bytes,n.bytes)}})(e.multihash,n.multihash)}toString(e){return XN(this,e)}toJSON(){return{"/":XN(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID(".concat(this.toString(),")")}static asCID(e){if(null==e)return null;const t=e;if(t instanceof tB)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:n,multihash:r,bytes:i}=t;return new tB(e,n,r,i||aB(e,n,r.bytes))}if(!0===t[cB]){const{version:e,multihash:n,code:r}=t,i=zN(n);return tB.create(e,r,i)}return null}static create(e,t,n){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==oB)throw new Error("Version 0 CID must use dag-pb (code: ".concat(oB,") block encoding"));return new tB(e,t,n,n.bytes);case 1:{const r=aB(e,t,n.bytes);return new tB(e,t,n,r)}default:throw new Error("Invalid version")}}static createV0(e){return tB.create(0,oB,e)}static createV1(e,t){return tB.create(1,e,t)}static decode(e){const[t,n]=tB.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=tB.inspectBytes(e),n=t.size-t.multihashSize,r=xO(e.subarray(n,n+t.multihashSize));if(r.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=r.subarray(t.multihashSize-t.digestSize),o=new VN(t.multihashCode,t.digestSize,i,r);return[0===t.version?tB.createV0(o):tB.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[n,r]=FN(e.subarray(t));return t+=r,n};let r=n(),i=oB;if(18===r?(r=0,t=0):i=n(),0!==r&&1!==r)throw new RangeError("Invalid CID version ".concat(r));const o=t,s=n(),a=n(),c=t+a;return{version:r,codec:i,multihashCode:s,digestSize:a,multihashSize:c-o,size:c}}static parse(e,t){const[n,r]=nB(e,t),i=tB.decode(r);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return eB(i).set(n,e),i}}const nB=(e,t)=>{switch(e[0]){case"Q":{const n=t||FO;return[FO.prefix,n.decode("".concat(FO.prefix).concat(e))]}case FO.prefix:{const n=t||FO;return[FO.prefix,n.decode(e)]}case QO.prefix:{const n=t||QO;return[QO.prefix,n.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},rB=(e,t,n)=>{const{prefix:r}=n;if(r!==FO.prefix)throw Error("Cannot string encode V0 in ".concat(n.name," encoding"));const i=t.get(r);if(null==i){const i=n.encode(e).slice(1);return t.set(r,i),i}return i},iB=(e,t,n)=>{const{prefix:r}=n,i=t.get(r);if(null==i){const i=n.encode(e);return t.set(r,i),i}return i},oB=112,sB=18,aB=(e,t,n)=>{const r=jN(e),i=r+jN(t),o=new Uint8Array(i+n.byteLength);return KN(e,o,0),KN(t,o,r),o.set(n,i),o},cB=Symbol.for("@ipld/js-cid/CID"),lB={...gt,...lt,...pt,...at,...ct,...ht,...dt,...st,...ft,...ut},uB=Symbol.for("nodejs.util.inspect.custom"),hB=Object.values(lB).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)),lB.identity.decoder),dB=114,fB=36,pB=37;class gB{constructor(e){(0,Yo.Z)(this,"type",void 0),(0,Yo.Z)(this,"multihash",void 0),(0,Yo.Z)(this,"privateKey",void 0),(0,Yo.Z)(this,"publicKey",void 0),(0,Yo.Z)(this,"string",void 0),(0,Yo.Z)(this,fu.Cs,!0),this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return"PeerId(".concat(this.toString(),")")}toString(){return null==this.string&&(this.string=FO.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return tB.createV1(dB,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){var t;if(e instanceof Uint8Array)return(0,Ms.f)(this.multihash.bytes,e);if("string"===typeof e)return bB(e).equals(this);if(null!=(null===e||void 0===e||null===(t=e.multihash)||void 0===t?void 0:t.bytes))return(0,Ms.f)(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[uB](){return"PeerId(".concat(this.toString(),")")}}class yB extends gB{constructor(e){super({...e,type:"RSA"}),(0,Yo.Z)(this,"type","RSA"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.publicKey}}class mB extends gB{constructor(e){super({...e,type:"Ed25519"}),(0,Yo.Z)(this,"type","Ed25519"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.multihash.digest}}class vB extends gB{constructor(e){super({...e,type:"secp256k1"}),(0,Yo.Z)(this,"type","secp256k1"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.multihash.digest}}function bB(e,t){var n;if(t=null!==(n=t)&&void 0!==n?n:hB,"1"===e.charAt(0)||"Q"===e.charAt(0)){const t=zN(FO.decode("z".concat(e)));return e.startsWith("12D")?new mB({multihash:t}):e.startsWith("16U")?new vB({multihash:t}):new yB({multihash:t})}return function(e){try{const t=zN(e);if(t.code===qN.code){if(t.digest.length===fB)return new mB({multihash:t});if(t.digest.length===pB)return new vB({multihash:t})}if(t.code===YN.code)return new yB({multihash:t})}catch{return function(e){if(null==e||null==e.multihash||null==e.version||1===e.version&&e.code!==dB)throw new Error("Supplied PeerID CID is invalid");const t=e.multihash;if(t.code===YN.code)return new yB({multihash:e.multihash});if(t.code===qN.code){if(t.digest.length===fB)return new mB({multihash:e.multihash});if(t.digest.length===pB)return new vB({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}(tB.decode(e))}throw new Error("Supplied PeerID CID is invalid")}(hB.decode(e))}var wB;!function(e){e.ERR_ALREADY_ABORTED="ERR_ALREADY_ABORTED",e.ERR_DATA_CHANNEL="ERR_DATA_CHANNEL",e.ERR_CONNECTION_CLOSED="ERR_CONNECTION_CLOSED",e.ERR_HASH_NOT_SUPPORTED="ERR_HASH_NOT_SUPPORTED",e.ERR_INVALID_MULTIADDR="ERR_INVALID_MULTIADDR",e.ERR_INVALID_FINGERPRINT="ERR_INVALID_FINGERPRINT",e.ERR_INVALID_PARAMETERS="ERR_INVALID_PARAMETERS",e.ERR_NOT_IMPLEMENTED="ERR_NOT_IMPLEMENTED",e.ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS="ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS",e.ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS="ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS"}(wB||(wB={}));class EB extends fu.sv{constructor(e,t){super("WebRTC transport error: ".concat(e),null!==t&&void 0!==t?t:""),this.name="WebRTCTransportError"}}class AB extends EB{constructor(e,t){super("[stream: ".concat(e,"] data channel error: ").concat(t),wB.ERR_DATA_CHANNEL),this.name="WebRTC/DataChannelError"}}function SB(e,t){return new AB(e,t)}class _B extends EB{constructor(e){super("There was a problem with the Multiaddr which was passed in: ".concat(e),wB.ERR_INVALID_MULTIADDR),this.name="WebRTC/InappropriateMultiaddrError"}}function IB(e){return new _B(e)}class CB extends EB{constructor(e){super("There was a problem with a provided argument: ".concat(e),wB.ERR_INVALID_PARAMETERS),this.name="WebRTC/InvalidArgumentError"}}function TB(e){return new CB(e)}class kB extends EB{constructor(e,t){super('Invalid fingerprint "'.concat(e,'" within ').concat(t),wB.ERR_INVALID_FINGERPRINT),this.name="WebRTC/InvalidFingerprintError"}}function RB(e,t){return new kB(e,t)}class xB extends EB{constructor(e){super("A method (".concat(e,") was called though it has been intentionally left unimplemented."),wB.ERR_NOT_IMPLEMENTED),this.name="WebRTC/UnimplementedError"}}class PB extends EB{constructor(e){super("unsupported hash algorithm: ".concat(e),wB.ERR_HASH_NOT_SUPPORTED),this.name="WebRTC/UnsupportedHashAlgorithmError"}}var DB=n(1426),OB=function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},NB=function(e,t,n){this.name=e,this.version=t,this.os=n,this.type="browser"},BB=function(e){this.version=e,this.type="node",this.name="node",this.os=DB.platform},LB=function(e,t,n,r){this.name=e,this.version=t,this.os=n,this.bot=r,this.type="bot-device"},MB=function(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null},UB=function(){this.type="react-native",this.name="react-native",this.version=null,this.os=null},FB=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,KB=3,jB=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],ZB=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function zB(e){return e?HB(e):"undefined"===typeof document&&"undefined"!==typeof navigator&&"ReactNative"===navigator.product?new UB:"undefined"!==typeof navigator?HB(navigator.userAgent):function(){var e="undefined"!==typeof DB&&DB.version;return e?new BB(DB.version.slice(1)):null}()}function VB(e){return""!==e&&jB.reduce((function(t,n){var r=n[0],i=n[1];if(t)return t;var o=i.exec(e);return!!o&&[r,o]}),!1)}function HB(e){var t=VB(e);if(!t)return null;var n=t[0],r=t[1];if("searchbot"===n)return new MB;var i=r[1]&&r[1].split(".").join("_").split("_").slice(0,3);i?i.length<KB&&(i=OB(OB([],i,!0),function(e){for(var t=[],n=0;n<e;n++)t.push("0");return t}(KB-i.length),!0)):i=[];var o=i.join("."),s=function(e){for(var t=0,n=ZB.length;t<n;t++){var r=ZB[t],i=r[0];if(r[1].exec(e))return i}return null}(e),a=FB.exec(e);return a&&a[1]?new LB(n,o,s,a[1]):new NB(n,o,s)}class qB extends Error{constructor(e){super(e),this.name="TimeoutError"}}class GB extends Error{constructor(e){super(),this.name="AbortError",this.message=e}}const WB=e=>void 0===globalThis.DOMException?new GB(e):new DOMException(e),QB=e=>{const t=void 0===e.reason?WB("This operation was aborted."):e.reason;return t instanceof Error?t:WB(t)};function YB(e,t){const{milliseconds:n,fallback:r,message:i,customTimers:o={setTimeout:setTimeout,clearTimeout:clearTimeout}}=t;let s;const a=new Promise(((a,c)=>{if("number"!==typeof n||1!==Math.sign(n))throw new TypeError("Expected `milliseconds` to be a positive number, got `".concat(n,"`"));if(t.signal){const{signal:e}=t;e.aborted&&c(QB(e)),e.addEventListener("abort",(()=>{c(QB(e))}))}if(n===Number.POSITIVE_INFINITY)return void e.then(a,c);const l=new qB;s=o.setTimeout.call(void 0,(()=>{if(r)try{a(r())}catch(t){c(t)}else"function"===typeof e.cancel&&e.cancel(),!1===i?a():i instanceof Error?c(i):(l.message=null!==i&&void 0!==i?i:"Promise timed out after ".concat(n," milliseconds"),c(l))}),n),(async()=>{try{a(await e)}catch(t){c(t)}})()})).finally((()=>{a.clear()}));return a.clear=()=>{o.clearTimeout.call(void 0,s),s=void 0},a}const JB=zB(),XB=null!=JB&&"firefox"===JB.name,$B=async function*(){},eL=async e=>{},tL=3e4;class nL{constructor(e,t){(0,Yo.Z)(this,"log",void 0),(0,Yo.Z)(this,"peerConnection",void 0),(0,Yo.Z)(this,"remoteAddr",void 0),(0,Yo.Z)(this,"timeline",void 0),(0,Yo.Z)(this,"metrics",void 0),(0,Yo.Z)(this,"source",$B()),(0,Yo.Z)(this,"sink",eL),this.log=e.logger.forComponent("libp2p:webrtc:maconn"),this.remoteAddr=t.remoteAddr,this.timeline=t.timeline,this.peerConnection=t.peerConnection;const n=this.peerConnection.connectionState;this.peerConnection.onconnectionstatechange=()=>{this.log.trace("peer connection state change",this.peerConnection.connectionState,"initial state",n),"disconnected"!==this.peerConnection.connectionState&&"failed"!==this.peerConnection.connectionState&&"closed"!==this.peerConnection.connectionState||(this.timeline.close=Date.now())}}async close(e){var t;this.log.trace("closing connection"),this.peerConnection.close(),this.timeline.close=Date.now(),null===(t=this.metrics)||void 0===t||t.increment({close:!0})}abort(e){var t;this.log.error("closing connection due to error",e),this.peerConnection.close(),this.timeline.close=Date.now(),null===(t=this.metrics)||void 0===t||t.increment({abort:!0})}}function rL(e){return null!=e[Symbol.asyncIterator]}const iL=e=>{const t=Bs.P$(e),n=(0,Us.E)(t);return Bs.cv(e,n),iL.bytes=t,n};function oL(e,t){var n,r;const i=null!==(r=(t=null!==(n=t)&&void 0!==n?n:{}).lengthEncoder)&&void 0!==r?r:iL;function*o(e){const t=i(e.byteLength);t instanceof Uint8Array?yield t:yield*t,e instanceof Uint8Array?yield e:yield*e}return rL(e)?async function*(){for await(const t of e)yield*o(t)}():function*(){for(const t of e)yield*o(t)}()}iL.bytes=0,oL.single=(e,t)=>{var n,r;const i=null!==(r=(t=null!==(n=t)&&void 0!==n?n:{}).lengthEncoder)&&void 0!==r?r:iL;return new Zs(i(e.byteLength),e)};var sL;!function(e){e[e.LENGTH=0]="LENGTH",e[e.DATA=1]="DATA"}(sL||(sL={}));const aL=e=>{const t=Bs.Jx(e);return aL.bytes=Bs.P$(t),t};function cL(e,t){var n,r,i;const o=new Zs;let s=sL.LENGTH,a=-1;const c=null!==(n=null===t||void 0===t?void 0:t.lengthDecoder)&&void 0!==n?n:aL,l=null!==(r=null===t||void 0===t?void 0:t.maxLengthLength)&&void 0!==r?r:8,u=null!==(i=null===t||void 0===t?void 0:t.maxDataLength)&&void 0!==i?i:4194304;function*h(){for(;o.byteLength>0;){if(s===sL.LENGTH)try{if(a=c(o),a<0)throw Xo()(new Error("invalid message length"),"ERR_INVALID_MSG_LENGTH");if(a>u)throw Xo()(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");const e=c.bytes;o.consume(e),null!=(null===t||void 0===t?void 0:t.onLength)&&t.onLength(a),s=sL.DATA}catch(e){if(e instanceof RangeError){if(o.byteLength>l)throw Xo()(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG");break}throw e}if(s===sL.DATA){if(o.byteLength<a)break;const e=o.sublist(0,a);o.consume(a),null!=(null===t||void 0===t?void 0:t.onData)&&t.onData(e),yield e,s=sL.LENGTH}}}return rL(e)?async function*(){for await(const t of e)o.append(t),yield*h();if(o.byteLength>0)throw Xo()(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}():function*(){for(const t of e)o.append(t),yield*h();if(o.byteLength>0)throw Xo()(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}()}aL.bytes=0,cL.fromReader=(e,t)=>{let n=1;return cL(async function*(){for(;;)try{const{done:t,value:r}=await e.next(n);if(!0===t)return;null!=r&&(yield r)}catch(t){if("ERR_UNDER_READ"===t.code)return{done:!0,value:null};throw t}finally{n=1}}(),{...null!==t&&void 0!==t?t:{},onLength:e=>{n=e}})};class lL{constructor(e){if((0,Yo.Z)(this,"buffer",void 0),(0,Yo.Z)(this,"mask",void 0),(0,Yo.Z)(this,"top",void 0),(0,Yo.Z)(this,"btm",void 0),(0,Yo.Z)(this,"next",void 0),!(e>0)||0!==(e-1&e))throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];if(void 0!==e)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return void 0===this.buffer[this.btm]}}class uL{constructor(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,Yo.Z)(this,"size",void 0),(0,Yo.Z)(this,"hwm",void 0),(0,Yo.Z)(this,"head",void 0),(0,Yo.Z)(this,"tail",void 0),this.hwm=null!==(e=t.splitLimit)&&void 0!==e?e:16,this.head=new lL(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return null!=(null===e||void 0===e?void 0:e.byteLength)?e.byteLength:1}push(e){if(null!=(null===e||void 0===e?void 0:e.value)&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){const t=this.head;this.head=t.next=new lL(2*this.head.buffer.length),this.head.push(e)}}shift(){var e;let t=this.tail.shift();if(void 0===t&&null!=this.tail.next){const e=this.tail.next;this.tail.next=null,this.tail=e,t=this.tail.shift()}return null!=(null===(e=t)||void 0===e?void 0:e.value)&&(this.size-=this.calculateSize(t.value)),t}isEmpty(){return this.head.isEmpty()}}class hL extends Error{constructor(e,t){super(null!==e&&void 0!==e?e:"The operation was aborted"),(0,Yo.Z)(this,"type",void 0),(0,Yo.Z)(this,"code",void 0),this.type="aborted",this.code=null!==t&&void 0!==t?t:"ABORT_ERR"}}function dL(){return fL((e=>{const t=e.shift();if(null==t)return{done:!0};if(null!=t.error)throw t.error;return{done:!0===t.done,value:t.value}}),arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function fL(e,t){var n;let r,i,o,s=(t=null!==(n=t)&&void 0!==n?n:{}).onEnd,a=new uL,c=Ws();const l=e=>null!=i?i(e):(a.push(e),r),u=e=>{var n;if(o)return r;if(!0!==(null===(n=t)||void 0===n?void 0:n.objectMode)&&null==(null===e||void 0===e?void 0:e.byteLength))throw new Error("objectMode was not true but tried to push non-Uint8Array value");return l({done:!1,value:e})},h=e=>o?r:(o=!0,null!=e?(e=>(a=new uL,null!=i?i({error:e}):(a.push({error:e}),r)))(e):l({done:!0}));if(r={[Symbol.asyncIterator](){return this},next:async()=>{try{return a.isEmpty()?o?{done:!0}:await new Promise(((t,n)=>{i=o=>{i=null,a.push(o);try{t(e(a))}catch(s){n(s)}return r}})):e(a)}finally{a.isEmpty()&&queueMicrotask((()=>{c.resolve(),c=Ws()}))}},return:()=>(a=new uL,h(),{done:!0}),throw:e=>(h(e),{done:!0}),push:u,end:h,get readableLength(){return a.size},onEmpty:async e=>{const t=null===e||void 0===e?void 0:e.signal;if(null===t||void 0===t||t.throwIfAborted(),a.isEmpty())return;let n,r;null!=t&&(n=new Promise(((e,n)=>{r=()=>{n(new hL)},t.addEventListener("abort",r)})));try{await Promise.race([c.promise,n])}finally{null!=r&&null!=t&&(null===t||void 0===t||t.removeEventListener("abort",r))}}},null==s)return r;const d=r;return r={[Symbol.asyncIterator](){return this},next:()=>d.next(),throw:e=>(d.throw(e),null!=s&&(s(e),s=void 0),{done:!0}),return:()=>(d.return(),null!=s&&(s(),s=void 0),{done:!0}),push:u,end:e=>(d.end(e),null!=s&&(s(e),s=void 0),r),get readableLength(){return d.readableLength},onEmpty:e=>d.onEmpty(e)},r}const pL=e=>{const t=e.on||e.addListener||e.addEventListener,n=e.off||e.removeListener||e.removeEventListener;if(!t||!n)throw new TypeError("Emitter is not compatible");return{addListener:t.bind(e),removeListener:n.bind(e)}};function gL(e,t,n){"function"===typeof n&&(n={filter:n});const r=function(e,t,n){let r;const i=new Promise(((i,o)=>{var s;if(!((n={rejectionEvents:["error"],multiArgs:!1,resolveImmediately:!1,...n}).count>=0)||n.count!==Number.POSITIVE_INFINITY&&!Number.isInteger(n.count))throw new TypeError("The `count` option should be at least 0 or more");null===(s=n.signal)||void 0===s||s.throwIfAborted();const a=[t].flat(),c=[],{addListener:l,removeListener:u}=pL(e),h=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];const s=n.multiArgs?t:t[0];n.filter&&!n.filter(s)||(c.push(s),n.count===c.length&&(r(),i(c)))},d=e=>{r(),o(e)};r=()=>{for(const e of a)u(e,h);for(const e of n.rejectionEvents)u(e,d)};for(const e of a)l(e,h);for(const e of n.rejectionEvents)l(e,d);n.signal&&n.signal.addEventListener("abort",(()=>{d(n.signal.reason)}),{once:!0}),n.resolveImmediately&&i(c)}));if(i.cancel=r,"number"===typeof n.timeout){const e=YB(i,{milliseconds:n.timeout});return e.cancel=r,e}return i}(e,t,n={...n,count:1,resolveImmediately:!1}),i=r.then((e=>e[0]));return i.cancel=r.cancel,i}var yL;!function(e){let t,n,r;!function(e){e.FIN="FIN",e.STOP_SENDING="STOP_SENDING",e.RESET="RESET",e.FIN_ACK="FIN_ACK"}(t=e.Flag||(e.Flag={})),function(e){e[e.FIN=0]="FIN",e[e.STOP_SENDING=1]="STOP_SENDING",e[e.RESET=2]="RESET",e[e.FIN_ACK=3]="FIN_ACK"}(n||(n={})),function(e){e.codec=()=>bs(n)}(t=e.Flag||(e.Flag={})),e.codec=()=>(null==r&&(r=ws((function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==r.lengthDelimited&&n.fork(),null!=t.flag&&(n.uint32(8),e.Flag.codec().encode(t.flag,n)),null!=t.message&&(n.uint32(18),n.bytes(t.message)),!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.flag=e.Flag.codec().decode(t);break;case 2:r.message=t.bytes();break;default:t.skipType(7&n)}}return r}))),r),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(yL||(yL={}));class mL extends Ud{constructor(e){var t,n,r,i,o;const s=e.onEnd;switch(e.onEnd=e=>{this.log.trace("readable and writeable ends closed",this.status),Promise.resolve((async()=>{if(null==this.timeline.abort&&null===this.timeline.reset)try{await YB(this.receiveFinAck.promise,{milliseconds:this.finAckTimeout})}catch(e){this.log.error("error receiving FIN_ACK",e)}})).then((()=>{this.incomingData.end(),null===s||void 0===s||s(e)})).catch((e=>{this.log.error("error ending stream",e)}))},super(e),(0,Yo.Z)(this,"channel",void 0),(0,Yo.Z)(this,"incomingData",void 0),(0,Yo.Z)(this,"maxBufferedAmount",void 0),(0,Yo.Z)(this,"bufferedAmountLowEventTimeout",void 0),(0,Yo.Z)(this,"maxMessageSize",void 0),(0,Yo.Z)(this,"receiveFinAck",void 0),(0,Yo.Z)(this,"finAckTimeout",void 0),(0,Yo.Z)(this,"openTimeout",void 0),this.channel=e.channel,this.channel.binaryType="arraybuffer",this.incomingData=dL(),this.bufferedAmountLowEventTimeout=null!==(t=e.bufferedAmountLowEventTimeout)&&void 0!==t?t:3e4,this.maxBufferedAmount=null!==(n=e.maxBufferedAmount)&&void 0!==n?n:16777216,this.maxMessageSize=(null!==(r=e.maxMessageSize)&&void 0!==r?r:16384)-5-2,this.receiveFinAck=Ws(),this.finAckTimeout=null!==(i=e.closeTimeout)&&void 0!==i?i:5e3,this.openTimeout=null!==(o=e.openTimeout)&&void 0!==o?o:5e3,this.channel.readyState){case"open":this.timeline.open=(new Date).getTime();break;case"closed":case"closing":void 0!==this.timeline.close&&0!==this.timeline.close||(this.timeline.close=Date.now());break;case"connecting":break;default:throw this.log.error("unknown datachannel state %s",this.channel.readyState),new fu.sv("Unknown datachannel state","ERR_INVALID_STATE")}this.channel.onopen=e=>{this.timeline.open=(new Date).getTime()},this.channel.onclose=e=>{this.receiveFinAck.resolve(),this.close().catch((e=>{this.log.error("error closing stream after channel closed",e)}))},this.channel.onerror=e=>{const t=e.error;this.abort(t)},this.channel.onmessage=async e=>{const{data:t}=e;null!==t&&0!==t.byteLength&&this.incomingData.push(new Uint8Array(t,0,t.byteLength))};const a=this;Promise.resolve().then((async()=>{for await(const e of cL(this.incomingData)){const t=a.processIncomingProtobuf(e);null!=t&&a.sourcePush(new Zs(t))}})).catch((e=>{this.log.error("error processing incoming data channel messages",e)}))}sendNewStream(){}async _sendMessage(e){if((!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.channel.bufferedAmount>this.maxBufferedAmount)try{this.log('channel buffer is %d, wait for "bufferedamountlow" event',this.channel.bufferedAmount),await gL(this.channel,"bufferedamountlow",{timeout:this.bufferedAmountLowEventTimeout})}catch(t){if(t instanceof qB)throw new fu.sv("Timed out waiting for DataChannel buffer to clear after ".concat(this.bufferedAmountLowEventTimeout,"ms"),"ERR_BUFFER_CLEAR_TIMEOUT");throw t}if("closed"===this.channel.readyState||"closing"===this.channel.readyState)throw new fu.sv("Invalid datachannel state - ".concat(this.channel.readyState),"ERR_INVALID_STATE");"open"!==this.channel.readyState&&(this.log('channel state is "%s" and not "open", waiting for "open" event before sending data',this.channel.readyState),await gL(this.channel,"open",{timeout:this.openTimeout}),this.log('channel state is now "%s", sending data',this.channel.readyState)),this.channel.send(e.subarray())}async sendData(e){for(e=e.sublist();e.byteLength>0;){const t=Math.min(e.byteLength,this.maxMessageSize),n=e.subarray(0,t),r=yL.encode({message:n}),i=oL.single(r);await this._sendMessage(i),e.consume(t)}}async sendReset(){await this._sendFlag(yL.Flag.RESET)}async sendCloseWrite(e){if(await this._sendFlag(yL.Flag.FIN)){this.log.trace("awaiting FIN_ACK");try{await Ys(this.receiveFinAck.promise,null===e||void 0===e?void 0:e.signal,{errorMessage:"sending close-write was aborted before FIN_ACK was received",errorCode:"ERR_FIN_ACK_NOT_RECEIVED"})}catch(t){this.log.error("failed to await FIN_ACK",t)}}else this.log.trace("sending FIN failed, not awaiting FIN_ACK");this.receiveFinAck.resolve()}async sendCloseRead(){await this._sendFlag(yL.Flag.STOP_SENDING)}processIncomingProtobuf(e){const t=yL.decode(e);if(void 0!==t.flag&&(this.log.trace('incoming flag %s, write status "%s", read status "%s"',t.flag,this.writeStatus,this.readStatus),t.flag===yL.Flag.FIN&&(this.remoteCloseWrite(),this.log.trace("sending FIN_ACK"),this._sendFlag(yL.Flag.FIN_ACK).catch((e=>{this.log.error("error sending FIN_ACK immediately",e)}))),t.flag===yL.Flag.RESET&&this.reset(),t.flag===yL.Flag.STOP_SENDING&&this.remoteCloseRead(),t.flag===yL.Flag.FIN_ACK&&(this.log.trace("received FIN_ACK"),this.receiveFinAck.resolve())),"ready"===this.readStatus)return t.message}async _sendFlag(e){if("open"!==this.channel.readyState)return this.log.trace('not sending flag %s because channel is "%s" and not "open"',this.channel.readyState,e.toString()),!1;this.log.trace("sending flag %s",e.toString());const t=yL.encode({flag:e}),n=oL.single(t);try{return await this._sendMessage(n,!1),!0}catch(r){this.log.error("could not send flag %s",e.toString(),r)}return!1}}function vL(e){const{channel:t,direction:n}=e;return new mL({id:"inbound"===n?"i".concat(t.id):"r".concat(t.id),log:e.logger.forComponent("libp2p:webrtc:stream:".concat(n,":").concat(t.id)),...e})}const bL="/webrtc";class wL{constructor(e,t){var n,r;(0,Yo.Z)(this,"protocol",void 0),(0,Yo.Z)(this,"peerConnection",void 0),(0,Yo.Z)(this,"bufferedStreams",[]),(0,Yo.Z)(this,"metrics",void 0),(0,Yo.Z)(this,"dataChannelOptions",void 0),(0,Yo.Z)(this,"components",void 0),(0,Yo.Z)(this,"log",void 0),this.components=e,this.peerConnection=t.peerConnection,this.metrics=t.metrics,this.protocol=null!==(n=t.protocol)&&void 0!==n?n:bL,this.dataChannelOptions=null!==(r=t.dataChannelOptions)&&void 0!==r?r:{},this.log=e.logger.forComponent("libp2p:webrtc:datachannelmuxerfactory"),this.peerConnection.ondatachannel=t=>{let{channel:n}=t;if(this.log.trace('incoming early datachannel with channel id %d and label "%s"',n.id),"init"===n.label)return this.log.trace("closing early init channel"),void n.close();const r={},i=vL({channel:n,direction:"inbound",onEnd:e=>{r.onEnd(e)},logger:e.logger,...this.dataChannelOptions});r.stream=i,r.channel=n,r.onEnd=()=>{this.bufferedStreams=this.bufferedStreams.filter((e=>e.stream.id!==i.id))},this.bufferedStreams.push(r)}}createStreamMuxer(e){return new AL(this.components,{...e,peerConnection:this.peerConnection,dataChannelOptions:this.dataChannelOptions,metrics:this.metrics,streams:this.bufferedStreams,protocol:this.protocol})}}var EL=new WeakSet;class AL{constructor(e,t){var n,r;Qd(this,EL),(0,Yo.Z)(this,"init",void 0),(0,Yo.Z)(this,"streams",void 0),(0,Yo.Z)(this,"protocol",void 0),(0,Yo.Z)(this,"log",void 0),(0,Yo.Z)(this,"peerConnection",void 0),(0,Yo.Z)(this,"dataChannelOptions",void 0),(0,Yo.Z)(this,"metrics",void 0),(0,Yo.Z)(this,"logger",void 0),(0,Yo.Z)(this,"source",$B()),(0,Yo.Z)(this,"sink",eL),this.init=t,this.log=e.logger.forComponent("libp2p:webrtc:muxer"),this.logger=e.logger,this.streams=t.streams.map((e=>e.stream)),this.peerConnection=t.peerConnection,this.protocol=null!==(n=t.protocol)&&void 0!==n?n:bL,this.metrics=t.metrics,this.dataChannelOptions=null!==(r=t.dataChannelOptions)&&void 0!==r?r:{},this.peerConnection.ondatachannel=e=>{var n,r;let{channel:i}=e;if(this.log.trace("incoming datachannel with channel id %d",i.id),"init"===i.label)return this.log.trace("closing init channel"),void i.close();const o=vL({channel:i,direction:"inbound",onEnd:()=>{this.log("incoming channel %s ended with state %s",i.id,i.readyState),Yd(this,EL,SL).call(this,o,i)},logger:this.logger,...this.dataChannelOptions});this.streams.push(o),null===(n=this.metrics)||void 0===n||n.increment({incoming_stream:!0}),null===t||void 0===t||null===(r=t.onIncomingStream)||void 0===r||r.call(t,o)},this.init.streams.length>0&&queueMicrotask((()=>{this.init.streams.forEach((e=>{var t,n,r;e.onEnd=()=>{this.log("incoming early channel %s ended with state %s",e.channel.id,e.channel.readyState),Yd(this,EL,SL).call(this,e.stream,e.channel)},null===(t=this.metrics)||void 0===t||t.increment({incoming_stream:!0}),null===(n=this.init)||void 0===n||null===(r=n.onIncomingStream)||void 0===r||r.call(n,e.stream)}))}))}async close(e){try{await Promise.all(this.streams.map((async t=>t.close(e))))}catch(t){this.abort(t)}}abort(e){for(const t of this.streams)t.abort(e)}newStream(){var e;const t=this.peerConnection.createDataChannel("");this.log.trace("opened outgoing datachannel with channel id %s",t.id);const n=vL({channel:t,direction:"outbound",onEnd:()=>{this.log("outgoing channel %s ended with state %s",t.id,t.readyState),Yd(this,EL,SL).call(this,n,t)},logger:this.logger,...this.dataChannelOptions});return this.streams.push(n),null===(e=this.metrics)||void 0===e||e.increment({outgoing_stream:!0}),n}}function SL(e,t){var n,r,i;this.log.trace("stream %s %s %s onEnd",e.direction,e.id,e.protocol),function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:tL,r=arguments.length>3?arguments[3]:void 0;"open"===e.readyState&&Promise.resolve().then((async()=>{if(e.bufferedAmount>0){r.log("%s drain channel with %d buffered bytes",t,e.bufferedAmount);const i=Ws();let o=!1;e.bufferedAmountLowThreshold=0;const s=()=>{o||(r.log("%s drain channel closed before drain",t),i.resolve())};e.addEventListener("close",s,{once:!0}),e.addEventListener("bufferedamountlow",(()=>{o=!0,e.removeEventListener("close",s),i.resolve()})),await YB(i.promise,{milliseconds:n})}})).then((async()=>{"open"===e.readyState&&e.close()})).catch((e=>{r.log.error("error closing outbound stream",e)}))}(t,"".concat(e.direction," ").concat(e.id," ").concat(e.protocol),this.dataChannelOptions.drainTimeout,{log:this.log}),this.streams=this.streams.filter((t=>t.id!==e.id)),null===(n=this.metrics)||void 0===n||n.increment({stream_end:!0}),null===(r=this.init)||void 0===r||null===(i=r.onStreamEnd)||void 0===i||i.call(r,e)}const _L=globalThis.RTCPeerConnection,IL=globalThis.RTCSessionDescription,CL=globalThis.RTCIceCandidate;var TL;!function(e){let t,n,r;!function(e){e.SDP_OFFER="SDP_OFFER",e.SDP_ANSWER="SDP_ANSWER",e.ICE_CANDIDATE="ICE_CANDIDATE"}(t=e.Type||(e.Type={})),function(e){e[e.SDP_OFFER=0]="SDP_OFFER",e[e.SDP_ANSWER=1]="SDP_ANSWER",e[e.ICE_CANDIDATE=2]="ICE_CANDIDATE"}(n||(n={})),function(e){e.codec=()=>bs(n)}(t=e.Type||(e.Type={})),e.codec=()=>(null==r&&(r=ws((function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==r.lengthDelimited&&n.fork(),null!=t.type&&(n.uint32(8),e.Type.codec().encode(t.type,n)),null!=t.data&&(n.uint32(18),n.string(t.data)),!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.type=e.Type.codec().decode(t);break;case 2:r.data=t.string();break;default:t.skipType(7&n)}}return r}))),r),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(TL||(TL={}));const kL=async(e,t,n,r)=>{const i=new AbortController;e.promise.then((()=>{i.abort()}),(()=>{i.abort()}));const o=function(e){const t=new globalThis.AbortController;function n(){t.abort();for(const t of e)null!=(null===t||void 0===t?void 0:t.removeEventListener)&&t.removeEventListener("abort",n)}for(const i of e){if(!0===(null===i||void 0===i?void 0:i.aborted)){n();break}null!=(null===i||void 0===i?void 0:i.addEventListener)&&i.addEventListener("abort",n)}const r=t.signal;return r.clear=function(){for(const t of e)null!=(null===t||void 0===t?void 0:t.removeEventListener)&&t.removeEventListener("abort",n)},r}([i.signal,r.signal]),s=()=>{Ld(n.unwrap().unwrap().source,r.log)};o.addEventListener("abort",s);try{for(;;){var a;const i=await Promise.race([e.promise,n.read()]);if(null==i)break;if(i.type!==TL.Type.ICE_CANDIDATE)throw new fu.sv("ICE candidate message expected","ERR_NOT_ICE_CANDIDATE");const o=JSON.parse(null!==(a=i.data)&&void 0!==a?a:"null");if(""===o||null===o){r.log.trace("end-of-candidates received");continue}const s=new CL(o);r.log.trace("%s received new ICE candidate",r.direction,s);try{await t.addIceCandidate(s)}catch(c){r.log.error("%s bad candidate received",r.direction,o,c)}}}catch(c){r.log.error("%s error parsing ICE candidate",r.direction,c)}finally{o.removeEventListener("abort",s),o.clear()}};function RL(e,t){e[XB?"oniceconnectionstatechange":"onconnectionstatechange"]=n=>{switch(XB?e.iceConnectionState:e.connectionState){case"connected":t.resolve();break;case"failed":case"disconnected":case"closed":t.reject(new fu.sv("RTCPeerConnection was closed","ERR_CONNECTION_CLOSED_BEFORE_CONNECTED"))}}}async function xL(e){let{peerConnection:t,signal:n,metrics:r,multiaddr:i,connectionManager:o,transportManager:s,log:a}=e;const{baseAddr:c}=function(e){const t=e.toString().split(DL+"/");if(2!==t.length)throw new fu.sv("webrtc protocol was not present in multiaddr",wB.ERR_INVALID_MULTIADDR);if(!t[0].includes(OL))throw new fu.sv("p2p-circuit protocol was not present in multiaddr",wB.ERR_INVALID_MULTIADDR);let n=(0,ng.HM)(t[0]);const r=(0,ng.HM)("/"+t[1]).getPeerId();if(null==r)throw new fu.sv("destination peer id was missing",wB.ERR_INVALID_MULTIADDR);const i=n.protos().pop();if(void 0===i)throw new fu.sv("invalid multiaddr",wB.ERR_INVALID_MULTIADDR);"p2p"!==i.name&&(n=n.encapsulate("/p2p/".concat(r)));return{baseAddr:n,peerId:bB(r)}}(i);null===r||void 0===r||r.dialerEvents.increment({open:!0}),a.trace("dialing base address: %a",c);const l=c.getPeerId();if(null==l)throw new fu.sv("Relay peer was missing","ERR_INVALID_ADDRESS");const u=o.getConnections(bB(l));let h,d=!1;0===u.length?(h=await s.dial(c,{signal:n}),d=!0):h=u[0];try{const e=await h.newStream(NL,{signal:n,runOnTransientConnection:!0}),r=rk(e).pb(TL),o=Ws(),s=()=>{o.reject(new fu.sv("SDP handshake aborted","ERR_SDP_HANDSHAKE_ABORTED"))};try{RL(t,o),null===n||void 0===n||n.addEventListener("abort",s);const e=t.createDataChannel("init");t.onicecandidate=e=>{var t;let{candidate:i}=e;const o=JSON.stringify(null!==(t=null===i||void 0===i?void 0:i.toJSON())&&void 0!==t?t:null);a.trace("initiator sending ICE candidate %s",o),r.write({type:TL.Type.ICE_CANDIDATE,data:o},{signal:n}).catch((e=>{a.error("error sending ICE candidate",e)}))},t.onicecandidateerror=e=>{a("initiator ICE candidate error",e)};const c=await t.createOffer();a.trace("initiator send SDP offer %s",c.sdp),await r.write({type:TL.Type.SDP_OFFER,data:c.sdp},{signal:n}),await t.setLocalDescription(c).catch((e=>{throw a.error("could not execute setLocalDescription",e),new fu.sv("Failed to set localDescription","ERR_SDP_HANDSHAKE_FAILED")}));const l=await r.read({signal:n});if(l.type!==TL.Type.SDP_ANSWER)throw new fu.sv("remote should send an SDP answer","ERR_SDP_HANDSHAKE_FAILED");a.trace("initiator receive SDP answer %s",l.data);const u=new IL({type:"answer",sdp:l.data});return await t.setRemoteDescription(u).catch((e=>{throw a.error("could not execute setRemoteDescription",e),new fu.sv("Failed to set remoteDescription","ERR_SDP_HANDSHAKE_FAILED")})),a.trace("initiator read candidates until connected"),await kL(o,t,r,{direction:"initiator",signal:n,log:a}),a.trace("initiator connected, closing init channel"),e.close(),a.trace("initiator closing signalling stream"),await r.unwrap().unwrap().close({signal:n}),a.trace("initiator connected to remote address %s",i),{remoteAddress:i}}catch(f){throw t.close(),e.abort(f),f}finally{null===n||void 0===n||n.removeEventListener("abort",s),t.onicecandidate=null,t.onicecandidateerror=null}}finally{if(d)try{await h.close({signal:n})}catch(f){h.abort(f)}}}class PL extends fu.Le{constructor(e,t){super(),(0,Yo.Z)(this,"peerId",void 0),(0,Yo.Z)(this,"transportManager",void 0),(0,Yo.Z)(this,"shutdownController",void 0),this.peerId=e.peerId,this.transportManager=e.transportManager,this.shutdownController=t.shutdownController}async listen(){this.safeDispatchEvent("listening",{})}getAddrs(){return this.transportManager.getListeners().filter((e=>e!==this)).map((e=>e.getAddrs().filter((e=>Qx.matches(e))).map((e=>e.encapsulate("/webrtc/p2p/".concat(this.peerId)))))).flat()}async close(){this.shutdownController.abort(),this.safeDispatchEvent("close",{})}}const DL="/webrtc",OL="/p2p-circuit",NL="/webrtc-signaling/0.0.1";class BL{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,Yo.Z)(this,"components",void 0),(0,Yo.Z)(this,"init",void 0),(0,Yo.Z)(this,"log",void 0),(0,Yo.Z)(this,"_started",!1),(0,Yo.Z)(this,"metrics",void 0),(0,Yo.Z)(this,"shutdownController",void 0),(0,Yo.Z)(this,Symbol.toStringTag,"@libp2p/webrtc"),(0,Yo.Z)(this,fu.SF,!0),this.components=e,this.init=t,this.log=e.logger.forComponent("libp2p:webrtc"),this.shutdownController=new AbortController,null!=e.metrics&&(this.metrics={dialerEvents:e.metrics.registerCounterGroup("libp2p_webrtc_dialer_events_total",{label:"event",help:"Total count of WebRTC dialer events by type"}),listenerEvents:e.metrics.registerCounterGroup("libp2p_webrtc_listener_events_total",{label:"event",help:"Total count of WebRTC listener events by type"})})}isStarted(){return this._started}async start(){await this.components.registrar.handle(NL,(e=>{this._onProtocol(e).catch((t=>{this.log.error("failed to handle incoming connect from %p",e.connection.remotePeer,t)}))}),{runOnTransientConnection:!0}),this._started=!0}async stop(){await this.components.registrar.unhandle(NL),this._started=!1}createListener(e){return new PL(this.components,{shutdownController:this.shutdownController})}filter(e){return e.filter(tO.uF.exactMatch)}async dial(e,t){var n;this.log.trace("dialing address: %a",e);const r=new _L(this.init.rtcConfiguration),i=new wL(this.components,{peerConnection:r,dataChannelOptions:this.init.dataChannel}),{remoteAddress:o}=await xL({peerConnection:r,multiaddr:e,dataChannelOptions:this.init.dataChannel,signal:t.signal,connectionManager:this.components.connectionManager,transportManager:this.components.transportManager,log:this.log}),s=new nL(this.components,{peerConnection:r,timeline:{open:Date.now()},remoteAddr:o,metrics:null===(n=this.metrics)||void 0===n?void 0:n.dialerEvents}),a=await t.upgrader.upgradeOutbound(s,{skipProtection:!0,skipEncryption:!0,muxerFactory:i});return this._closeOnShutdown(r,s),a}async _onProtocol(e){var t;let{connection:n,stream:r}=e;const i=AbortSignal.timeout(null!==(t=this.init.inboundConnectionTimeout)&&void 0!==t?t:3e4),o=new _L(this.init.rtcConfiguration),s=new wL(this.components,{peerConnection:o,dataChannelOptions:this.init.dataChannel});try{var a;const{remoteAddress:e}=await async function(e){let{peerConnection:t,stream:n,signal:r,connection:i,log:o}=e;o.trace("new inbound signaling stream");const s=rk(n).pb(TL);try{const e=Ws(),n=Ws();r.onabort=()=>{e.reject(new fu.sv("Timed out while trying to connect","ERR_TIMEOUT"))},t.onicecandidate=t=>{let{candidate:i}=t;n.promise.then((async()=>{var e;const t=JSON.stringify(null!==(e=null===i||void 0===i?void 0:i.toJSON())&&void 0!==e?e:null);o.trace("recipient sending ICE candidate %s",t),await s.write({type:TL.Type.ICE_CANDIDATE,data:t},{signal:r})}),(t=>{o.error("cannot set candidate since sending answer failed",t),e.reject(t)}))},RL(t,e);const i=await s.read({signal:r});var a;if(i.type!==TL.Type.SDP_OFFER)throw new fu.sv("expected message type SDP_OFFER, received: ".concat(null!==(a=i.type)&&void 0!==a?a:"undefined"," "),"ERR_SDP_HANDSHAKE_FAILED");o.trace("recipient receive SDP offer %s",i.data);const c=new IL({type:"offer",sdp:i.data});await t.setRemoteDescription(c).catch((e=>{throw o.error("could not execute setRemoteDescription",e),new fu.sv("Failed to set remoteDescription","ERR_SDP_HANDSHAKE_FAILED")}));const l=await t.createAnswer().catch((e=>{throw o.error("could not execute createAnswer",e),n.reject(e),new fu.sv("Failed to create answer","ERR_SDP_HANDSHAKE_FAILED")}));o.trace("recipient send SDP answer %s",l.sdp),await s.write({type:TL.Type.SDP_ANSWER,data:l.sdp},{signal:r}),await t.setLocalDescription(l).catch((e=>{throw o.error("could not execute setLocalDescription",e),n.reject(e),new fu.sv("Failed to set localDescription","ERR_SDP_HANDSHAKE_FAILED")})),n.resolve(),o.trace("recipient read candidates until connected"),await kL(e,t,s,{direction:"recipient",signal:r,log:o}),o.trace("recipient connected, closing signaling stream"),await s.unwrap().unwrap().close({signal:r})}catch(l){if("connected"!==t.connectionState)throw o.error("error while handling signaling stream from peer %a",i.remoteAddr,l),t.close(),l;o("error while handling signaling stream from peer %a, ignoring as the RTCPeerConnection is already connected",i.remoteAddr,l)}const c=(0,ng.HM)("/webrtc/p2p/".concat(i.remoteAddr.getPeerId()));return o.trace("recipient connected to remote address %s",c),{remoteAddress:c}}({peerConnection:o,connection:n,stream:r,signal:i,log:this.log}),t=new nL(this.components,{peerConnection:o,timeline:{open:(new Date).getTime()},remoteAddr:e,metrics:null===(a=this.metrics)||void 0===a?void 0:a.listenerEvents});this._closeOnShutdown(o,t),await this.components.upgrader.upgradeInbound(t,{skipEncryption:!0,skipProtection:!0,muxerFactory:s}),await r.close({signal:i})}catch(c){throw r.abort(c),c}}_closeOnShutdown(e,t){const n=()=>{t.close().catch((e=>{this.log.error("could not close WebRTCMultiaddrConnection",e)}))};this.shutdownController.signal.addEventListener("abort",n),e.addEventListener("close",(()=>{this.shutdownController.signal.removeEventListener("abort",n)}))}}function LL(){const e=Ws();let t=!1;return{sink:async n=>{if(t)throw new Error("already piped");t=!0,e.resolve(n)},source:async function*(){const t=await e.promise;yield*t}()}}const ML=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=[];for(const i of t)null==i[Symbol.asyncIterator]&&r.push(i);return r.length===t.length?function*(){for(const e of r)yield*e}():async function*(){const e=dL({objectMode:!0});Promise.resolve().then((async()=>{try{await Promise.all(t.map((async t=>{for await(const n of t)e.push(n)}))),e.end()}catch(n){e.end(n)}})),yield*e}()};const UL=function(){let e;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(;n.length>0;)e=n.shift()(e);return e},FL=e=>null!=(null===e||void 0===e?void 0:e[Symbol.asyncIterator]),KL=e=>null!=(null===e||void 0===e?void 0:e[Symbol.iterator]),jL=e=>null!=e&&(null!=e.sink&&null!=e.source),ZL=e=>t=>{const n=e.sink(t);if(null!=(null===n||void 0===n?void 0:n.then)){const t=dL({objectMode:!0});let r;n.then((()=>{t.end()}),(e=>{t.end(e)}));const i=e.source;if(FL(i))r=async function*(){yield*i,t.end()};else{if(!KL(i))throw new Error("Unknown duplex source type - must be Iterable or AsyncIterable");r=function*(){yield*i,t.end()}}return ML(t,r())}return e.source};var zL,VL;const HL=65535,qL=Boolean(null===(zL=globalThis.process)||void 0===zL||null===(VL=zL.env)||void 0===VL?void 0:VL.DUMP_SESSION_KEYS),GL={hashSHA256:e=>au(e),getHKDF(e,t){const n=Xl(au,t,e),r=tu(au,n,void 0,96);return[r.subarray(0,32),r.subarray(32,64),r.subarray(64,96)]},generateX25519KeyPair(){const e=Wl.utils.randomPrivateKey();return{publicKey:Wl.getPublicKey(e),privateKey:e}},generateX25519KeyPairFromSeed:e=>({publicKey:Wl.getPublicKey(e),privateKey:e}),generateX25519SharedKey:(e,t)=>Wl.getSharedSecret(e,t),chaCha20Poly1305Encrypt:(e,t,n,r)=>lc(r,t,n).encrypt(e),chaCha20Poly1305Decrypt:(e,t,n,r,i)=>lc(r,t,n).decrypt(e,i)},WL=e=>{const t=(0,Us.E)(2);return new DataView(t.buffer,t.byteOffset,t.byteLength).setUint16(0,e,!1),t};WL.bytes=2;const QL=e=>{if(e.length<2)throw RangeError("Could not decode int16BE");return e instanceof Uint8Array?new DataView(e.buffer,e.byteOffset,e.byteLength).getUint16(0,!1):e.getUint16(0)};QL.bytes=2;class YL extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"The operation was aborted"),(0,Yo.Z)(this,"code",void 0),(0,Yo.Z)(this,"type",void 0),this.code=YL.code,this.type=YL.type}}(0,Yo.Z)(YL,"code","ABORT_ERR"),(0,Yo.Z)(YL,"type","aborted");class JL extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected Peer"),(0,Yo.Z)(this,"code",void 0),this.code=JL.code}}(0,Yo.Z)(JL,"code","ERR_UNEXPECTED_PEER");class XL extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid crypto exchange"),(0,Yo.Z)(this,"code",void 0),this.code=XL.code}}(0,Yo.Z)(XL,"code","ERR_INVALID_CRYPTO_EXCHANGE");class $L extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid crypto transmission"),(0,Yo.Z)(this,"code",void 0),this.code=$L.code}}(0,Yo.Z)($L,"code","ERR_INVALID_CRYPTO_TRANSMISSION");class eM extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"The operation was aborted"),(0,Yo.Z)(this,"code",void 0),(0,Yo.Z)(this,"type",void 0),this.code=eM.code,this.type=eM.type}}(0,Yo.Z)(eM,"code","ABORT_ERR"),(0,Yo.Z)(eM,"type","aborted");class tM extends Error{constructor(e,t,n){var r;super(e),(0,Yo.Z)(this,"code",void 0),(0,Yo.Z)(this,"props",void 0),this.code=t,this.name=null!==(r=null===n||void 0===n?void 0:n.name)&&void 0!==r?r:"CodeError",this.props=null!==n&&void 0!==n?n:{}}}class nM extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected Peer"),(0,Yo.Z)(this,"code",void 0),this.code=nM.code}}(0,Yo.Z)(nM,"code","ERR_UNEXPECTED_PEER");class rM extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid crypto exchange"),(0,Yo.Z)(this,"code",void 0),this.code=rM.code}}(0,Yo.Z)(rM,"code","ERR_INVALID_CRYPTO_EXCHANGE");class iM extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid crypto transmission"),(0,Yo.Z)(this,"code",void 0),this.code=iM.code}}(0,Yo.Z)(iM,"code","ERR_INVALID_CRYPTO_TRANSMISSION");const oM=32,sM=64,aM=32;function cM(e,t){const n=new Uint8Array(sM);for(let r=0;r<aM;r++)n[r]=e[r],n[aM+r]=t[r];return n}const lM={get(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:globalThis).crypto;if(null==e||null==e.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}},uM={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};async function hM(e,t){const n=function(e){var t,n,r,i,o,s;const a=null!==(t=null===e||void 0===e?void 0:e.algorithm)&&void 0!==t?t:"AES-GCM";let c=null!==(n=null===e||void 0===e?void 0:e.keyLength)&&void 0!==n?n:16;const l=null!==(r=null===e||void 0===e?void 0:e.nonceLength)&&void 0!==r?r:12,u=null!==(i=null===e||void 0===e?void 0:e.digest)&&void 0!==i?i:"SHA-256",h=null!==(o=null===e||void 0===e?void 0:e.saltLength)&&void 0!==o?o:16,d=null!==(s=null===e||void 0===e?void 0:e.iterations)&&void 0!==s?s:32767,f=lM.get();return c*=8,{encrypt:async function(e,t){const n=f.getRandomValues(new Uint8Array(h)),r=f.getRandomValues(new Uint8Array(l)),i={name:a,iv:r};let o;if("string"===typeof t&&(t=(0,yu.m)(t)),0===t.length){o=await f.subtle.importKey("jwk",uM,{name:"AES-GCM"},!0,["encrypt"]);try{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);o=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["encrypt"])}catch{o=await f.subtle.importKey("jwk",uM,{name:"AES-GCM"},!0,["encrypt"])}}else{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);o=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["encrypt"])}const s=await f.subtle.encrypt(i,o,e);return(0,Ls.z)([n,i.iv,new Uint8Array(s)])},decrypt:async function(e,t){const n=e.subarray(0,h),r=e.subarray(h,h+l),i=e.subarray(h+l),o={name:a,iv:r};let s;if("string"===typeof t&&(t=(0,yu.m)(t)),0===t.length)try{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);s=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["decrypt"])}catch{s=await f.subtle.importKey("jwk",uM,{name:"AES-GCM"},!0,["decrypt"])}else{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);s=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["decrypt"])}const p=await f.subtle.decrypt(o,s,i);return new Uint8Array(p)}}}(),r=await n.encrypt(e,t);return sN.encode(r)}var dM,fM,pM,gM;!function(e){e.RSA="RSA",e.Ed25519="Ed25519",e.Secp256k1="Secp256k1"}(dM||(dM={})),function(e){e[e.RSA=0]="RSA",e[e.Ed25519=1]="Ed25519",e[e.Secp256k1=2]="Secp256k1"}(fM||(fM={})),function(e){e.codec=()=>bs(fM)}(dM||(dM={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),dM.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.Type=dM.codec().decode(e);break;case 2:n.Data=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(pM||(pM={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),dM.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.Type=dM.codec().decode(e);break;case 2:n.Data=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(gM||(gM={}));class yM{constructor(e){(0,Yo.Z)(this,"_key",void 0),this._key=AM(e,oM)}async verify(e,t){return async function(e,t,n){return ql.verify(t,n,e)}(this._key,t,e)}marshal(){return this._key}get bytes(){return pM.encode({Type:dM.Ed25519,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await YN.digest(this.bytes);return e}}class mM{constructor(e,t){(0,Yo.Z)(this,"_key",void 0),(0,Yo.Z)(this,"_publicKey",void 0),this._key=AM(e,sM),this._publicKey=AM(t,oM)}async sign(e){return async function(e,t){const n=e.subarray(0,aM);return ql.sign(t,n)}(this._key,e)}get public(){return new yM(this._publicKey)}marshal(){return this._key}get bytes(){return gM.encode({Type:dM.Ed25519,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await YN.digest(this.bytes);return e}async id(){const e=qN.digest(this.public.bytes);return FO.encode(e.bytes).substring(1)}async export(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"libp2p-key";if("libp2p-key"===t)return hM(this.bytes,e);throw new tM("export format '".concat(t,"' is not supported"),"ERR_INVALID_EXPORT_FORMAT")}}function vM(e){if(e.length>sM){const t=(e=AM(e,sM+oM)).subarray(0,sM),n=e.subarray(sM,e.length);return new mM(t,n)}const t=(e=AM(e,sM)).subarray(0,sM),n=e.subarray(oM);return new mM(t,n)}function bM(e){return e=AM(e,oM),new yM(e)}async function wM(){const{privateKey:e,publicKey:t}=await async function(){const e=ql.utils.randomPrivateKey(),t=ql.getPublicKey(e);return{privateKey:cM(e,t),publicKey:t}}();return new mM(e,t)}async function EM(e){const{privateKey:t,publicKey:n}=await async function(e){if(e.length!==aM)throw new TypeError('"seed" must be 32 bytes in length.');if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');const t=e,n=ql.getPublicKey(t);return{privateKey:cM(t,n),publicKey:n}}(e);return new mM(t,n)}function AM(e,t){var n;if((e=Uint8Array.from(null!==(n=e)&&void 0!==n?n:[])).length!==t)throw new tM("Key must be a Uint8Array of length ".concat(t,", got ").concat(e.length),"ERR_INVALID_KEY_TYPE");return e}function SM(e,t){let n=Uint8Array.from(e.abs().toByteArray());if(n=0===n[0]?n.subarray(1):n,null!=t){if(n.length>t)throw new Error("byte array longer than desired length");n=(0,Ls.z)([new Uint8Array(t-n.length),n])}return(0,Au.B)(n,"base64url")}function _M(e){const t=function(e,t){let n=(0,yu.m)(e,"base64urlpad");if(null!=t){if(n.length>t)throw new Error("byte array longer than desired length");n=(0,Ls.z)([new Uint8Array(t-n.length),n])}return n}(e);return new(gu().jsbn.BigInteger)((0,Au.B)(t,"base16"),16)}const IM={"P-256":256,"P-384":384,"P-521":521};Object.keys(IM).join(" / ");function CM(e,t){return t.map((t=>_M(e[t])))}async function TM(e){const t=[await lM.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await RM(e)],n=await kM({privateKey:t[0],publicKey:t[1]});return{privateKey:n[0],publicKey:n[1]}}async function kM(e){if(null==e.privateKey||null==e.publicKey)throw new tM("Private and public key are required","ERR_INVALID_PARAMETERS");return Promise.all([lM.get().subtle.exportKey("jwk",e.privateKey),lM.get().subtle.exportKey("jwk",e.publicKey)])}async function RM(e){return lM.get().subtle.importKey("jwk",{kty:e.kty,n:e.n,e:e.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function xM(e,t,n,r){const i=t?function(e){return gu().pki.setRsaPublicKey(...CM(e,["n","e"]))}(e):function(e){return gu().pki.setRsaPrivateKey(...CM(e,["n","e","d","p","q","dp","dq","qi"]))}(e),o=r((0,Au.B)(Uint8Array.from(n),"ascii"),i);return(0,yu.m)(o,"ascii")}function PM(e){if("RSA"!==e.kty)throw new tM("invalid key type","ERR_INVALID_KEY_TYPE");if(null==e.n)throw new tM("invalid key modulus","ERR_INVALID_KEY_MODULUS");return 8*(0,yu.m)(e.n,"base64url").length}const DM=8192;class OM{constructor(e){(0,Yo.Z)(this,"_key",void 0),this._key=e}async verify(e,t){return async function(e,t,n){const r=await lM.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return lM.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},r,t,n)}(this._key,t,e)}marshal(){return function(e){if(null==e.n||null==e.e)throw new tM("JWK was missing components","ERR_INVALID_PARAMETERS");const t=gu().pki.publicKeyToAsn1({n:_M(e.n),e:_M(e.e)});return(0,yu.m)(gu().asn1.toDer(t).getBytes(),"ascii")}(this._key)}get bytes(){return pM.encode({Type:dM.RSA,Data:this.marshal()}).subarray()}encrypt(e){return xM(this._key,!0,e,((e,t)=>t.encrypt(e)))}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await YN.digest(this.bytes);return e}}class NM{constructor(e,t){(0,Yo.Z)(this,"_key",void 0),(0,Yo.Z)(this,"_publicKey",void 0),this._key=e,this._publicKey=t}genSecret(){return function(e){if(isNaN(e)||e<=0)throw new tM("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return _c(e)}(16)}async sign(e){return async function(e,t){const n=await lM.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),r=await lM.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},n,Uint8Array.from(t));return new Uint8Array(r,0,r.byteLength)}(this._key,e)}get public(){if(null==this._publicKey)throw new tM("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new OM(this._publicKey)}decrypt(e){return xM(this._key,!1,e,((e,t)=>t.decrypt(e)))}marshal(){return function(e){if(null==e.n||null==e.e||null==e.d||null==e.p||null==e.q||null==e.dp||null==e.dq||null==e.qi)throw new tM("JWK was missing components","ERR_INVALID_PARAMETERS");const t=gu().pki.privateKeyToAsn1({n:_M(e.n),e:_M(e.e),d:_M(e.d),p:_M(e.p),q:_M(e.q),dP:_M(e.dp),dQ:_M(e.dq),qInv:_M(e.qi)});return(0,yu.m)(gu().asn1.toDer(t).getBytes(),"ascii")}(this._key)}get bytes(){return gM.encode({Type:dM.RSA,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await YN.digest(this.bytes);return e}async id(){const e=await this.public.hash();return(0,Au.B)(e,"base58btc")}async export(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"pkcs-8";if("pkcs-8"===t){const t=new(gu().util.ByteBuffer)(this.marshal()),n=gu().asn1.fromDer(t),r=gu().pki.privateKeyFromAsn1(n),i={algorithm:"aes256",count:1e4,saltSize:16,prfAlgorithm:"sha512"};return gu().pki.encryptRsaPrivateKey(r,e,i)}if("libp2p-key"===t)return hM(this.bytes,e);throw new tM("export format '".concat(t,"' is not supported"),"ERR_INVALID_EXPORT_FORMAT")}}async function BM(e){const t=function(e){const t=gu().asn1.fromDer((0,Au.B)(e,"ascii")),n=gu().pki.privateKeyFromAsn1(t);return{kty:"RSA",n:SM(n.n),e:SM(n.e),d:SM(n.d),p:SM(n.p),q:SM(n.q),dp:SM(n.dP),dq:SM(n.dQ),qi:SM(n.qInv),alg:"RS256"}}(e);if(PM(t)>DM)throw new tM("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const n=await TM(t);return new NM(n.privateKey,n.publicKey)}function LM(e){const t=function(e){const t=gu().asn1.fromDer((0,Au.B)(e,"ascii")),n=gu().pki.publicKeyFromAsn1(t);return{kty:"RSA",n:SM(n.n),e:SM(n.e)}}(e);if(PM(t)>DM)throw new tM("key size is too large","ERR_KEY_SIZE_TOO_LARGE");return new OM(t)}async function MM(e){if(PM(e)>DM)throw new tM("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const t=await TM(e);return new NM(t.privateKey,t.publicKey)}async function UM(e){if(e>DM)throw new tM("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const t=await async function(e){const t=await lM.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),n=await kM(t);return{privateKey:n[0],publicKey:n[1]}}(e);return new NM(t.privateKey,t.publicKey)}function FM(e){try{Eh.ProjectivePoint.fromHex(e)}catch(t){throw new tM(String(t),"ERR_INVALID_PUBLIC_KEY")}}class KM{constructor(e){(0,Yo.Z)(this,"_key",void 0),FM(e),this._key=e}async verify(e,t){return async function(e,t,n){try{const{digest:r}=await YN.digest(n);return Eh.verify(t,r,e)}catch(r){throw new tM(String(r),"ERR_INVALID_INPUT")}}(this._key,t,e)}marshal(){return e=this._key,Eh.ProjectivePoint.fromHex(e).toRawBytes(!0);var e}get bytes(){return pM.encode({Type:dM.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await YN.digest(this.bytes);return e}}class jM{constructor(e,t){(0,Yo.Z)(this,"_key",void 0),(0,Yo.Z)(this,"_publicKey",void 0),this._key=e,this._publicKey=null!==t&&void 0!==t?t:function(e){try{return Eh.getPublicKey(e,!0)}catch(t){throw new tM(String(t),"ERR_INVALID_PRIVATE_KEY")}}(e),function(e){try{Eh.getPublicKey(e,!0)}catch(t){throw new tM(String(t),"ERR_INVALID_PRIVATE_KEY")}}(this._key),FM(this._publicKey)}async sign(e){return async function(e,t){const{digest:n}=await YN.digest(t);try{return Eh.sign(n,e).toDERRawBytes()}catch(r){throw new tM(String(r),"ERR_INVALID_INPUT")}}(this._key,e)}get public(){return new KM(this._publicKey)}marshal(){return this._key}get bytes(){return gM.encode({Type:dM.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await YN.digest(this.bytes);return e}async id(){const e=await this.public.hash();return(0,Au.B)(e,"base58btc")}async export(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"libp2p-key";if("libp2p-key"===t)return hM(this.bytes,e);throw new tM("export format '".concat(t,"' is not supported"),"ERR_INVALID_EXPORT_FORMAT")}}function ZM(e){return new jM(e)}function zM(e){return new KM(e)}async function VM(){const e=Eh.utils.randomPrivateKey();return new jM(e)}const HM={rsa:Et,ed25519:wt,secp256k1:At};function qM(e){const t=Object.keys(HM).join(" / ");return new tM("invalid or unsupported key type ".concat(e,". Must be ").concat(t),"ERR_UNSUPPORTED_KEY_TYPE")}async function GM(e){var t,n;const r=gM.decode(e),i=null!==(t=r.Data)&&void 0!==t?t:new Uint8Array;switch(r.Type){case dM.RSA:return HM.rsa.unmarshalRsaPrivateKey(i);case dM.Ed25519:return HM.ed25519.unmarshalEd25519PrivateKey(i);case dM.Secp256k1:return HM.secp256k1.unmarshalSecp256k1PrivateKey(i);default:throw qM(null!==(n=r.Type)&&void 0!==n?n:"RSA")}}const WM=Symbol.for("@libp2p/peer-id");const QM=Symbol.for("nodejs.util.inspect.custom"),YM=Object.values(lB).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)),lB.identity.decoder),JM=114,XM=36,$M=37;class eU{constructor(e){(0,Yo.Z)(this,"type",void 0),(0,Yo.Z)(this,"multihash",void 0),(0,Yo.Z)(this,"privateKey",void 0),(0,Yo.Z)(this,"publicKey",void 0),(0,Yo.Z)(this,"string",void 0),(0,Yo.Z)(this,WM,!0),this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return"PeerId(".concat(this.toString(),")")}toString(){return null==this.string&&(this.string=FO.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return tB.createV1(JM,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){var t;if(e instanceof Uint8Array)return(0,Ms.f)(this.multihash.bytes,e);if("string"===typeof e)return function(e,t){var n;if(t=null!==(n=t)&&void 0!==n?n:YM,"1"===e.charAt(0)||"Q"===e.charAt(0)){const t=zN(FO.decode("z".concat(e)));return e.startsWith("12D")?new nU({multihash:t}):e.startsWith("16U")?new rU({multihash:t}):new tU({multihash:t})}return function(e){try{const t=zN(e);if(t.code===qN.code){if(t.digest.length===XM)return new nU({multihash:t});if(t.digest.length===$M)return new rU({multihash:t})}if(t.code===YN.code)return new tU({multihash:t})}catch{return function(e){if(null==e||null==e.multihash||null==e.version||1===e.version&&e.code!==JM)throw new Error("Supplied PeerID CID is invalid");const t=e.multihash;if(t.code===YN.code)return new tU({multihash:e.multihash});if(t.code===qN.code){if(t.digest.length===XM)return new nU({multihash:e.multihash});if(t.digest.length===$M)return new rU({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}(tB.decode(e))}throw new Error("Supplied PeerID CID is invalid")}(YM.decode(e))}(e).equals(this);if(null!=(null===e||void 0===e||null===(t=e.multihash)||void 0===t?void 0:t.bytes))return(0,Ms.f)(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[QM](){return"PeerId(".concat(this.toString(),")")}}class tU extends eU{constructor(e){super({...e,type:"RSA"}),(0,Yo.Z)(this,"type","RSA"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.publicKey}}class nU extends eU{constructor(e){super({...e,type:"Ed25519"}),(0,Yo.Z)(this,"type","Ed25519"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.multihash.digest}}class rU extends eU{constructor(e){super({...e,type:"secp256k1"}),(0,Yo.Z)(this,"type","secp256k1"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.multihash.digest}}async function iU(e,t){return e.length===XM?new nU({multihash:ZN(qN.code,e),privateKey:t}):e.length===$M?new rU({multihash:ZN(qN.code,e),privateKey:t}):new tU({multihash:await YN.digest(e),publicKey:e,privateKey:t})}var oU,sU;async function aU(e,t,n){const r=await async function(e,t){if(null==e.privateKey)throw new Error("PrivateKey was missing from PeerId");return(await GM(e.privateKey)).sign(t)}(e,uU(t));if(null==e.publicKey)throw new Error("PublicKey was missing from local PeerId");return function(e,t,n){return sU.encode({identityKey:e,identitySig:t,extensions:null!==n&&void 0!==n?n:{webtransportCerthashes:[]}}).subarray()}(e.publicKey,r,n)}async function cU(e){return iU(e.identityKey)}function lU(e){return sU.decode(e)}function uU(e){const t=(0,yu.m)("noise-libp2p-static-key:");return(0,Ls.z)([t,e],t.length+e.length)}async function hU(e,t,n){const r=await iU(t.identityKey);if(!r.equals(n))throw new Error("Payload identity key ".concat(r.toString()," does not match expected remote peer ").concat(n.toString()));const i=uU(e);if(null==r.publicKey)throw new Error("PublicKey was missing from PeerId");if(null==t.identitySig)throw new Error("Signature was missing from message");const o=function(e){var t,n;const r=pM.decode(e),i=null!==(t=r.Data)&&void 0!==t?t:new Uint8Array;switch(r.Type){case dM.RSA:return HM.rsa.unmarshalRsaPublicKey(i);case dM.Ed25519:return HM.ed25519.unmarshalEd25519PublicKey(i);case dM.Secp256k1:return HM.secp256k1.unmarshalSecp256k1PublicKey(i);default:throw qM(null!==(n=r.Type)&&void 0!==n?n:"unknown")}}(r.publicKey);if(!await o.verify(i,t.identitySig))throw new Error("Static key doesn't match to peer that signed payload!");return r}function dU(e){return e instanceof Uint8Array&&32===e.length}function fU(e){let t=function(e){const t=()=>{};return t.enabled=!1,t.color="",t.diff=0,t.log=()=>{},t.namespace=e,t.destroy=()=>!0,t.extend=()=>t,t}("".concat(e,":trace"));return sf().enabled("".concat(e,":trace"))&&null!=sf().names.map((e=>e.toString())).find((e=>e.includes(":trace")))&&(t=sf()("".concat(e,":trace"))),Object.assign(sf()(e),{error:sf()("".concat(e,":error")),trace:t})}!function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==n.lengthDelimited&&t.fork(),null!=e.webtransportCerthashes)for(const r of e.webtransportCerthashes)t.uint32(10),t.bytes(r);!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={webtransportCerthashes:[]},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();if(t>>>3===1)n.webtransportCerthashes.push(e.bytes());else e.skipType(7&t)}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(oU||(oU={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.identityKey&&e.identityKey.byteLength>0&&(t.uint32(10),t.bytes(e.identityKey)),null!=e.identitySig&&e.identitySig.byteLength>0&&(t.uint32(18),t.bytes(e.identitySig)),null!=e.extensions&&(t.uint32(34),oU.codec().encode(e.extensions,t)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={identityKey:(0,Us.u)(0),identitySig:(0,Us.u)(0)},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.identityKey=e.bytes();break;case 2:n.identitySig=e.bytes();break;case 4:n.extensions=oU.codec().decode(e,e.uint32());break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(sU||(sU={})),sf().formatters.b=e=>null==e?"undefined":FO.baseEncode(e),sf().formatters.t=e=>null==e?"undefined":QO.baseEncode(e),sf().formatters.m=e=>null==e?"undefined":sN.baseEncode(e),sf().formatters.p=e=>null==e?"undefined":e.toString(),sf().formatters.c=e=>null==e?"undefined":e.toString(),sf().formatters.k=e=>null==e?"undefined":e.toString(),sf().formatters.a=e=>null==e?"undefined":e.toString();const pU=fU("libp2p:noise");let gU;function yU(e){e?(gU("LOCAL_PUBLIC_EPHEMERAL_KEY ".concat((0,Au.B)(e.publicKey,"hex"))),gU("LOCAL_PRIVATE_EPHEMERAL_KEY ".concat((0,Au.B)(e.privateKey,"hex")))):gU("Missing local ephemeral keys.")}function mU(e){gU("REMOTE_EPHEMERAL_PUBLIC_KEY ".concat((0,Au.B)(e,"hex")))}gU=qL?pU:Object.assign((()=>{}),{enabled:!1,trace:()=>{},error:()=>{}});class vU{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;(0,Yo.Z)(this,"n",void 0),(0,Yo.Z)(this,"bytes",void 0),(0,Yo.Z)(this,"view",void 0),this.n=e,this.bytes=(0,Us.u)(12),this.view=new DataView(this.bytes.buffer,this.bytes.byteOffset,this.bytes.byteLength),this.view.setUint32(4,e,!0)}increment(){this.n++,this.view.setUint32(4,this.n,!0)}getBytes(){return this.bytes}getUint64(){return this.n}assertValue(){if(this.n>4294967295)throw new Error("Cipherstate has reached maximum n, a new handshake must be performed")}}class bU{constructor(e){(0,Yo.Z)(this,"crypto",void 0),this.crypto=e}encryptWithAd(e,t,n){const r=this.encrypt(e.k,e.n,t,n);return e.n.increment(),r}decryptWithAd(e,t,n,r){const{plaintext:i,valid:o}=this.decrypt(e.k,e.n,t,n,r);return o&&e.n.increment(),{plaintext:i,valid:o}}hasKey(e){return!this.isEmptyKey(e.k)}createEmptyKey(){return(0,Us.u)(32)}isEmptyKey(e){const t=this.createEmptyKey();return(0,Ms.f)(t,e)}encrypt(e,t,n,r){return t.assertValue(),this.crypto.chaCha20Poly1305Encrypt(r,t.getBytes(),n,e)}encryptAndHash(e,t){let n;return n=this.hasKey(e.cs)?this.encryptWithAd(e.cs,e.h,t):t,this.mixHash(e,n),n}decrypt(e,t,n,r,i){t.assertValue();const o=this.crypto.chaCha20Poly1305Decrypt(r,t.getBytes(),n,e,i);return o?{plaintext:o,valid:!0}:{plaintext:(0,Us.u)(0),valid:!1}}decryptAndHash(e,t){let n,r=!0;return this.hasKey(e.cs)?({plaintext:n,valid:r}=this.decryptWithAd(e.cs,e.h,t)):n=t,this.mixHash(e,t),{plaintext:n,valid:r}}dh(e,t){try{const n=this.crypto.generateX25519SharedKey(e,t);return 32===n.length?n:n.subarray(0,32)}catch(n){const e=n;return pU.error(e),(0,Us.u)(32)}}mixHash(e,t){e.h=this.getHash(e.h,t)}getHash(e,t){return this.crypto.hashSHA256((0,Ls.z)([e,t],e.length+t.length))}mixKey(e,t){const[n,r]=this.crypto.getHKDF(e.ck,t);e.cs=this.initializeKey(r),e.ck=n}initializeKey(e){return{k:e,n:new vU}}initializeSymmetric(e){const t=(0,Xh.mL)(e,"utf-8"),n=this.hashProtocolName(t),r=n,i=this.createEmptyKey();return{cs:this.initializeKey(i),ck:r,h:n}}hashProtocolName(e){if(e.length<=32){const t=(0,Us.u)(32);return t.set(e),t}return this.getHash(e,(0,Us.u)(0))}split(e){const[t,n]=this.crypto.getHKDF(e.ck,(0,Us.u)(0));return{cs1:this.initializeKey(t),cs2:this.initializeKey(n)}}writeMessageRegular(e,t){const n=this.encryptWithAd(e,(0,Us.u)(0),t);return{ne:this.createEmptyKey(),ns:(0,Us.u)(0),ciphertext:n}}readMessageRegular(e,t){return this.decryptWithAd(e,(0,Us.u)(0),t.ciphertext)}}class wU extends bU{initializeInitiator(e,t,n,r){const i=this.initializeSymmetric("Noise_XX_25519_ChaChaPoly_SHA256");this.mixHash(i,e);return{ss:i,s:t,rs:n,psk:r,re:(0,Us.u)(32)}}initializeResponder(e,t,n,r){const i=this.initializeSymmetric("Noise_XX_25519_ChaChaPoly_SHA256");this.mixHash(i,e);return{ss:i,s:t,rs:n,psk:r,re:(0,Us.u)(32)}}writeMessageA(e,t,n){const r=(0,Us.u)(0);e.e=void 0!==n?n:this.crypto.generateX25519KeyPair();const i=e.e.publicKey;this.mixHash(e.ss,i);return{ne:i,ns:r,ciphertext:this.encryptAndHash(e.ss,t)}}writeMessageB(e,t){e.e=this.crypto.generateX25519KeyPair();const n=e.e.publicKey;this.mixHash(e.ss,n),this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));const r=e.s.publicKey,i=this.encryptAndHash(e.ss,r);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));return{ne:n,ns:i,ciphertext:this.encryptAndHash(e.ss,t)}}writeMessageC(e,t){const n=e.s.publicKey,r=this.encryptAndHash(e.ss,n);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));const i=this.encryptAndHash(e.ss,t),o={ne:this.createEmptyKey(),ns:r,ciphertext:i},{cs1:s,cs2:a}=this.split(e.ss);return{h:e.ss.h,messageBuffer:o,cs1:s,cs2:a}}readMessageA(e,t){return dU(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),this.decryptAndHash(e.ss,t.ciphertext)}readMessageB(e,t){if(dU(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));const{plaintext:n,valid:r}=this.decryptAndHash(e.ss,t.ns);r&&dU(n)&&(e.rs=n),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));const{plaintext:i,valid:o}=this.decryptAndHash(e.ss,t.ciphertext);return{plaintext:i,valid:r&&o}}readMessageC(e,t){const{plaintext:n,valid:r}=this.decryptAndHash(e.ss,t.ns);if(r&&dU(n)&&(e.rs=n),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));const{plaintext:i,valid:o}=this.decryptAndHash(e.ss,t.ciphertext),{cs1:s,cs2:a}=this.split(e.ss);return{h:e.ss.h,plaintext:i,valid:r&&o,cs1:s,cs2:a}}initSession(e,t,n){const r=this.createEmptyKey(),i=(0,Us.u)(32);let o;return o=e?this.initializeInitiator(t,n,i,r):this.initializeResponder(t,n,i,r),{hs:o,i:e,mc:0}}sendMessage(e,t,n){let r;if(0===e.mc)r=this.writeMessageA(e.hs,t,n);else if(1===e.mc)r=this.writeMessageB(e.hs,t);else if(2===e.mc){const{h:n,messageBuffer:i,cs1:o,cs2:s}=this.writeMessageC(e.hs,t);r=i,e.h=n,e.cs1=o,e.cs2=s}else{if(!(e.mc>2))throw new Error("Session invalid.");if(e.i){if(!e.cs1)throw new Error("CS1 (cipher state) is not defined");r=this.writeMessageRegular(e.cs1,t)}else{if(!e.cs2)throw new Error("CS2 (cipher state) is not defined");r=this.writeMessageRegular(e.cs2,t)}}return e.mc++,r}recvMessage(e,t){let n=(0,Us.u)(0),r=!1;if(0===e.mc)({plaintext:n,valid:r}=this.readMessageA(e.hs,t));else if(1===e.mc)({plaintext:n,valid:r}=this.readMessageB(e.hs,t));else if(2===e.mc){const{h:i,plaintext:o,valid:s,cs1:a,cs2:c}=this.readMessageC(e.hs,t);n=o,r=s,e.h=i,e.cs1=a,e.cs2=c}return e.mc++,{plaintext:n,valid:r}}}class EU{constructor(e,t,n,r,i,o,s,a){(0,Yo.Z)(this,"isInitiator",void 0),(0,Yo.Z)(this,"session",void 0),(0,Yo.Z)(this,"remotePeer",void 0),(0,Yo.Z)(this,"remoteExtensions",{webtransportCerthashes:[]}),(0,Yo.Z)(this,"payload",void 0),(0,Yo.Z)(this,"connection",void 0),(0,Yo.Z)(this,"xx",void 0),(0,Yo.Z)(this,"staticKeypair",void 0),(0,Yo.Z)(this,"prologue",void 0),this.isInitiator=e,this.payload=t,this.prologue=n,this.staticKeypair=i,this.connection=o,s&&(this.remotePeer=s),this.xx=null!==a&&void 0!==a?a:new wU(r),this.session=this.xx.initSession(this.isInitiator,this.prologue,this.staticKeypair)}async propose(){var e;if(e=this.session.hs.s,gU("LOCAL_STATIC_PUBLIC_KEY ".concat((0,Au.B)(e.publicKey,"hex"))),gU("LOCAL_STATIC_PRIVATE_KEY ".concat((0,Au.B)(e.privateKey,"hex"))),this.isInitiator){pU.trace("Stage 0 - Initiator starting to send first message.");const e=this.xx.sendMessage(this.session,(0,Us.u)(0));await this.connection.write(function(e){return(0,Ls.z)([e.ne,e.ciphertext],e.ne.length+e.ciphertext.length)}(e)),pU.trace("Stage 0 - Initiator finished sending first message."),yU(this.session.hs.e)}else{pU.trace("Stage 0 - Responder waiting to receive first message...");const e=function(e){if(e.length<32)throw new Error("Cannot decode stage 0 MessageBuffer: length less than 32 bytes.");return{ne:e.subarray(0,32),ciphertext:e.subarray(32,e.length),ns:(0,Us.u)(0)}}((await this.connection.read()).subarray()),{valid:t}=this.xx.recvMessage(this.session,e);if(!t)throw new XL("xx handshake stage 0 validation fail");pU.trace("Stage 0 - Responder received first message."),mU(this.session.hs.re)}}async exchange(){if(this.isInitiator){pU.trace("Stage 1 - Initiator waiting to receive first message from responder...");const n=function(e){if(e.length<80)throw new Error("Cannot decode stage 1 MessageBuffer: length less than 80 bytes.");return{ne:e.subarray(0,32),ns:e.subarray(32,80),ciphertext:e.subarray(80,e.length)}}((await this.connection.read()).subarray()),{plaintext:r,valid:i}=this.xx.recvMessage(this.session,n);if(!i)throw new XL("xx handshake stage 1 validation fail");pU.trace("Stage 1 - Initiator received the message."),mU(this.session.hs.re),e=this.session.hs.rs,gU("REMOTE_STATIC_PUBLIC_KEY ".concat((0,Au.B)(e,"hex"))),pU.trace("Initiator going to check remote's signature...");try{const e=lU(r);this.remotePeer=this.remotePeer||await cU(e),await hU(this.session.hs.rs,e,this.remotePeer),this.setRemoteNoiseExtension(e.extensions)}catch(t){throw new JL("Error occurred while verifying signed payload: ".concat(t.message))}pU.trace("All good with the signature!")}else{pU.trace("Stage 1 - Responder sending out first message with signed payload and static key.");const e=this.xx.sendMessage(this.session,this.payload);await this.connection.write(function(e){return(0,Ls.z)([e.ne,e.ns,e.ciphertext],e.ne.length+e.ns.length+e.ciphertext.length)}(e)),pU.trace("Stage 1 - Responder sent the second handshake message with signed payload."),yU(this.session.hs.e)}var e}async finish(){if(this.isInitiator){pU.trace("Stage 2 - Initiator sending third handshake message.");const e=this.xx.sendMessage(this.session,this.payload);await this.connection.write(function(e){return(0,Ls.z)([e.ns,e.ciphertext],e.ns.length+e.ciphertext.length)}(e)),pU.trace("Stage 2 - Initiator sent message with signed payload.")}else{pU.trace("Stage 2 - Responder waiting for third handshake message...");const e=function(e){if(e.length<48)throw new Error("Cannot decode stage 2 MessageBuffer: length less than 48 bytes.");return{ne:(0,Us.u)(0),ns:e.subarray(0,48),ciphertext:e.subarray(48,e.length)}}((await this.connection.read()).subarray()),{plaintext:n,valid:r}=this.xx.recvMessage(this.session,e);if(!r)throw new XL("xx handshake stage 2 validation fail");pU.trace("Stage 2 - Responder received the message, finished handshake.");try{const e=lU(n);this.remotePeer=this.remotePeer||await cU(e),await hU(this.session.hs.rs,e,this.remotePeer),this.setRemoteNoiseExtension(e.extensions)}catch(t){throw new JL("Error occurred while verifying signed payload: ".concat(t.message))}}var e;(e=this.session).cs1&&e.cs2?(gU("CIPHER_STATE_1 ".concat(e.cs1.n.getUint64()," ").concat((0,Au.B)(e.cs1.k,"hex"))),gU("CIPHER_STATE_2 ".concat(e.cs2.n.getUint64()," ").concat((0,Au.B)(e.cs2.k,"hex")))):gU("Missing cipher state.")}encrypt(e,t){const n=this.getCS(t);return this.xx.encryptWithAd(n,(0,Us.u)(0),e)}decrypt(e,t,n){const r=this.getCS(t,!1);return this.xx.decryptWithAd(r,(0,Us.u)(0),e,n)}getRemoteStaticKey(){return this.session.hs.rs}getCS(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!e.cs1||!e.cs2)throw new XL("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?t?e.cs1:e.cs2:t?e.cs2:e.cs1}setRemoteNoiseExtension(e){e&&(this.remoteExtensions=e)}}class AU{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,Yo.Z)(this,"protocol","/noise"),(0,Yo.Z)(this,"crypto",void 0),(0,Yo.Z)(this,"prologue",void 0),(0,Yo.Z)(this,"staticKeys",void 0),(0,Yo.Z)(this,"extensions",void 0),(0,Yo.Z)(this,"metrics",void 0);const{staticNoiseKey:t,extensions:n,crypto:r,prologueBytes:i,metrics:o}=e;this.crypto=null!==r&&void 0!==r?r:GL,this.extensions=n,this.metrics=o?function(e){return{xxHandshakeSuccesses:e.registerCounter("libp2p_noise_xxhandshake_successes_total",{help:"Total count of noise xxHandshakes successes_"}),xxHandshakeErrors:e.registerCounter("libp2p_noise_xxhandshake_error_total",{help:"Total count of noise xxHandshakes errors"}),encryptedPackets:e.registerCounter("libp2p_noise_encrypted_packets_total",{help:"Total count of noise encrypted packets successfully"}),decryptedPackets:e.registerCounter("libp2p_noise_decrypted_packets_total",{help:"Total count of noise decrypted packets"}),decryptErrors:e.registerCounter("libp2p_noise_decrypt_errors_total",{help:"Total count of noise decrypt errors"})}}(o):void 0,this.staticKeys=t?this.crypto.generateX25519KeyPairFromSeed(t):this.crypto.generateX25519KeyPair(),this.prologue=null!==i&&void 0!==i?i:(0,Us.u)(0)}async secureOutbound(e,t,n){const r=la(t,{lengthEncoder:WL,lengthDecoder:QL,maxDataLength:HL}),i=await this.performHandshake({connection:r,isInitiator:!0,localPeer:e,remotePeer:n});return{conn:await this.createSecureConnection(r,i),remoteExtensions:i.remoteExtensions,remotePeer:i.remotePeer}}async secureInbound(e,t,n){const r=la(t,{lengthEncoder:WL,lengthDecoder:QL,maxDataLength:HL}),i=await this.performHandshake({connection:r,isInitiator:!1,localPeer:e,remotePeer:n});return{conn:await this.createSecureConnection(r,i),remotePeer:i.remotePeer,remoteExtensions:i.remoteExtensions}}async performHandshake(e){const t=await aU(e.localPeer,this.staticKeys.publicKey,this.extensions);return this.performXXHandshake(e,t)}async performXXHandshake(e,t){const{isInitiator:n,remotePeer:r,connection:i}=e,o=new EU(n,t,this.prologue,this.crypto,this.staticKeys,i,r);try{var s;await o.propose(),await o.exchange(),await o.finish(),null===(s=this.metrics)||void 0===s||s.xxHandshakeSuccesses.increment()}catch(c){var a;if(null===(a=this.metrics)||void 0===a||a.xxHandshakeErrors.increment(),c instanceof Error)throw c.message="Error occurred during XX handshake: ".concat(c.message),c}return o}async createSecureConnection(e,t){const[n,r]=function(){const e=LL(),t=LL();return[{source:e.source,sink:t.sink},{source:t.source,sink:e.sink}]}(),i=e.unwrap();return await function(e){if(null==e)throw new Error("Empty pipeline");if(jL(e)){const t=e;e=()=>t.source}else if(KL(e)||FL(e)){const t=e;e=()=>t}for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=[e,...n];if(i.length>1&&jL(i[i.length-1])&&(i[i.length-1]=i[i.length-1].sink),i.length>2)for(let o=1;o<i.length-1;o++)jL(i[o])&&(i[o]=ZL(i[o]));return UL(...i)}(n,function(e,t){return async function*(n){for await(const r of n)for(let n=0;n<r.length;n+=65519){let i=n+65519;i>r.length&&(i=r.length);const o=e.encrypt(r.subarray(n,i),e.session);null===t||void 0===t||t.encryptedPackets.increment(),yield(0,Xh.zo)([WL(o.byteLength),o],2+o.byteLength)}}}(t,this.metrics),i,(e=>cL(e,{lengthDecoder:QL})),function(e,t){return async function*(n){for await(const r of n)for(let n=0;n<r.length;n+=HL){let i=n+HL;if(i>r.length&&(i=r.length),i-16<n)throw new Error("Invalid chunk");const o=r.subarray(n,i),s=r.subarray(n,i-16),{plaintext:a,valid:c}=e.decrypt(o,e.session,s);if(!c)throw null===t||void 0===t||t.decryptErrors.increment(),new Error("Failed to validate decrypted chunk");null===t||void 0===t||t.decryptedPackets.increment(),yield a}}}(t,this.metrics),n),r}}var SU=n(53765);const _U=Object.values(lB).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)));function IU(e,t){var n;const r=null===(n=e.getConfiguration().certificates)||void 0===n?void 0:n.at(0);if(null==r||null==r.getFingerprints){t.log.trace("fetching fingerprint from local SDP");const n=e.localDescription;if(null==n)return;return function(e){var t;const n=e.match(CU);return null===n||void 0===n||null===(t=n.groups)||void 0===t?void 0:t.fingerprint}(n.sdp)}if(t.log.trace("fetching fingerprint from local certificate"),0===r.getFingerprints().length)return;const i=r.getFingerprints()[0].value;if(null==i)throw RB("","no fingerprint on local certificate");return i}const CU=/^a=fingerprint:(?:\w+-[0-9]+)\s(?<fingerprint>(:?[0-9a-fA-F]{2})+)$/m;function TU(e){const t=e.stringTuples().filter((e=>e[0]===DU)).map((e=>e[1]))[0];if(void 0===t||""===t)throw IB("Couldn't find a certhash component of multiaddr: ".concat(e.toString()));return t}function kU(e){const t=_U.decode(e);return SU.decode(t)}function RU(e){switch(e){case"sha1":return"sha-1";case"sha2-256":return"sha-256";case"sha2-512":return"sha-512";default:throw new PB(e)}}function xU(e,t){const{host:n,port:r}=e.toOptions(),i=function(e){for(const t of e.protoNames())if(t.startsWith("ip"))return t.toUpperCase();return"IP6"}(e),[o]=function(e){const t=kU(TU(e)),n=RU(t.name),r=t.digest.reduce(((e,t)=>e+t.toString(16).padStart(2,"0")),""),i=r.match(/.{1,2}/g);if(null==i)throw RB(r,e.toString());return["".concat(n.toUpperCase()," ").concat(i.join(":").toUpperCase()),r]}(e);return"v=0\no=- 0 0 IN ".concat(i," ").concat(n,"\ns=-\nc=IN ").concat(i," ").concat(n,"\nt=0 0\na=ice-lite\nm=application ").concat(r," UDP/DTLS/SCTP webrtc-datachannel\na=mid:0\na=setup:passive\na=ice-ufrag:").concat(t,"\na=ice-pwd:").concat(t,"\na=fingerprint:").concat(o,"\na=sctp-port:5000\na=max-message-size:16384\na=candidate:1467250027 1 UDP 1467250027 ").concat(n," ").concat(r," typ host\r\n")}const PU=Array.from("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),DU=((0,ng.a_)("webrtc-direct").code,(0,ng.a_)("certhash").code);class OU{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,Yo.Z)(this,"log",void 0),(0,Yo.Z)(this,"metrics",void 0),(0,Yo.Z)(this,"components",void 0),(0,Yo.Z)(this,"init",void 0),(0,Yo.Z)(this,Symbol.toStringTag,"@libp2p/webrtc-direct"),(0,Yo.Z)(this,fu.SF,!0),this.log=e.logger.forComponent("libp2p:webrtc-direct"),this.components=e,this.init=t,null!=e.metrics&&(this.metrics={dialerEvents:e.metrics.registerCounterGroup("libp2p_webrtc-direct_dialer_events_total",{label:"event",help:"Total count of WebRTC-direct dial events by type"})})}async dial(e,t){const n=await this._connect(e,t);return this.log("dialing address: %a",e),n}createListener(e){throw new xB("WebRTCTransport.createListener")}filter(e){return e.filter(tO.Ih.exactMatch)}async _connect(e,t){const n=new AbortController,r=n.signal,i=e.getPeerId();if(null===i)throw IB("we need to have the remote's PeerId");const o=bB(i),s=kU(TU(e)),a=await _L.generateCertificate({name:"ECDSA",namedCurve:"P-256",hash:RU(s.name)}),c=new _L({certificates:[a]});try{var l,u,h,d;const i=new Promise(((e,t)=>{const n=c.createDataChannel("",{negotiated:!0,id:0}),r=setTimeout((()=>{var e;const r="Data channel was never opened: state: ".concat(n.readyState);this.log.error(r),null===(e=this.metrics)||void 0===e||e.dialerEvents.increment({open_error:!0}),t(SB("data",r))}),1e4);n.onopen=t=>{clearTimeout(r),e(n)},n.onerror=e=>{var n,i,o;clearTimeout(r);const s=null!==(n=null===(i=e.target)||void 0===i?void 0:i.toString())&&void 0!==n?n:"not specified",a="Error opening a data channel for handshaking: ".concat(s);this.log.error(a),null===(o=this.metrics)||void 0===o||o.dialerEvents.increment({unknown_error:!0}),t(SB("data",a))}})),a="libp2p+webrtc+v1/"+[...Array(32)].map((()=>PU.at(Math.floor(Math.random()*PU.length)))).join(""),f=function(e,t){if(void 0===e.sdp)throw TB("Can't munge a missing SDP");return e.sdp=e.sdp.replace(/\na=ice-ufrag:[^\n]*\n/,"\na=ice-ufrag:"+t+"\n").replace(/\na=ice-pwd:[^\n]*\n/,"\na=ice-pwd:"+t+"\n"),e}(await c.createOffer(),a);await c.setLocalDescription(f);const p=function(e,t){return{type:"answer",sdp:xU(e,t)}}(e,a);await c.setRemoteDescription(p);const g=await i,y=this.components.peerId,m=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return()=>new AU(e)}({prologueBytes:this.generateNoisePrologue(c,s.code,e)})(),v=vL({channel:g,direction:"inbound",logger:this.components.logger,...null!==(l=this.init.dataChannel)&&void 0!==l?l:{}}),b={...v,sink:v.sink.bind(v),source:async function*(){for await(const e of v.source)for(const t of e)yield t}()},w=new nL(this.components,{peerConnection:c,remoteAddr:e,timeline:{open:Date.now()},metrics:null===(u=this.metrics)||void 0===u?void 0:u.dialerEvents}),E=XB?"iceconnectionstatechange":"connectionstatechange";c.addEventListener(E,(()=>{switch(c.connectionState){case"failed":case"disconnected":case"closed":w.close().catch((e=>{this.log.error("error closing connection",e)})).finally((()=>{n.abort()}))}}),{signal:r}),null===(h=this.metrics)||void 0===h||h.dialerEvents.increment({peer_connection:!0});const A=new wL(this.components,{peerConnection:c,metrics:null===(d=this.metrics)||void 0===d?void 0:d.dialerEvents,dataChannelOptions:this.init.dataChannel});return await m.secureInbound(y,b,o),await t.upgrader.upgradeOutbound(w,{skipProtection:!0,skipEncryption:!0,muxerFactory:A})}catch(f){throw c.close(),f}}generateNoisePrologue(e,t,n){var r;if(0===(null===(r=e.getConfiguration().certificates)||void 0===r?void 0:r.length))throw TB("no local certificate");const i=IU(e,{log:this.log});if(null==i)throw TB("no local fingerprint found");const o=i.trim().toLowerCase().replaceAll(":",""),s=(0,yu.m)(o,"hex"),a=SU.encode(s,t),c=_U.decode(TU(n)),l=(0,yu.m)("libp2p-webrtc-noise:");return(0,Ls.z)([l,a,c])}}function NU(e){return t=>new OU(t,e)}class BU extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"The operation was aborted"),(0,Yo.Z)(this,"code",void 0),(0,Yo.Z)(this,"type",void 0),this.code=BU.code,this.type=BU.type}}(0,Yo.Z)(BU,"code","ABORT_ERR"),(0,Yo.Z)(BU,"type","aborted");class LU extends Error{constructor(e,t,n){var r;super(e),(0,Yo.Z)(this,"code",void 0),(0,Yo.Z)(this,"props",void 0),this.code=t,this.name=null!==(r=null===n||void 0===n?void 0:n.name)&&void 0!==r?r:"CodeError",this.props=null!==n&&void 0!==n?n:{}}}class MU extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected Peer"),(0,Yo.Z)(this,"code",void 0),this.code=MU.code}}(0,Yo.Z)(MU,"code","ERR_UNEXPECTED_PEER");class UU extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid crypto exchange"),(0,Yo.Z)(this,"code",void 0),this.code=UU.code}}(0,Yo.Z)(UU,"code","ERR_INVALID_CRYPTO_EXCHANGE");class FU extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid crypto transmission"),(0,Yo.Z)(this,"code",void 0),this.code=FU.code}}(0,Yo.Z)(FU,"code","ERR_INVALID_CRYPTO_TRANSMISSION");const KU=Symbol.for("@libp2p/transport");var jU;!function(e){e[e.FATAL_ALL=0]="FATAL_ALL",e[e.NO_FATAL=1]="NO_FATAL"}(jU||(jU={}));var ZU=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==n[s])throw new TypeError(o+" is ambiguous");n[s]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var r=0,i=0;e[t]===c;)r++,t++;for(var o=(e.length-t)*l+1>>>0,s=new Uint8Array(o);e[t];){var u=n[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=o-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*s[d]>>>0,s[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=o-i;f!==o&&0===s[f];)f++;for(var p=new Uint8Array(r+(o-f)),g=r;f!==o;)p[g++]=s[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,o=t.length;i!==o&&0===t[i];)i++,n++;for(var s=(o-i)*u+1>>>0,l=new Uint8Array(s);i!==o;){for(var h=t[i],d=0,f=s-1;(0!==h||d<r)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");r=d,i++}for(var p=s-r;p!==s&&0===l[p];)p++;for(var g=c.repeat(n);p<s;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:h,decode:function(e){var n=h(e);if(n)return n;throw new Error("Non-".concat(t," character"))}}};const zU=ZU;new Uint8Array(0);class VU{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(e));throw Error("Unknown type, must be binary type")}}class HU{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(e),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return GU(this,e)}}class qU{constructor(e){this.decoders=e}or(e){return GU(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(e),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}}const GU=(e,t)=>new qU({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class WU{constructor(e,t,n,r){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=r,this.encoder=new VU(e,t,n),this.decoder=new HU(e,t,r)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const QU=e=>{let{name:t,prefix:n,encode:r,decode:i}=e;return new WU(t,n,r,i)},YU=e=>{let{prefix:t,name:n,alphabet:r}=e;const{encode:i,decode:o}=zU(r,n);return QU({prefix:t,name:n,encode:i,decode:e=>(e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")})(o(e))})},JU=e=>{let{name:t,prefix:n,bitsPerChar:r,alphabet:i}=e;return QU({prefix:n,name:t,encode:e=>((e,t,n)=>{const r="="===t[t.length-1],i=(1<<n)-1;let o="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>n;)s-=n,o+=t[i&a>>s];if(s&&(o+=t[i&a<<n-s]),r)for(;o.length*n&7;)o+="=";return o})(e,i,r),decode:e=>((e,t,n,r)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*n/8|0);let a=0,c=0,l=0;for(let u=0;u<o;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError("Non-".concat(r," character"));c=c<<n|t,a+=n,a>=8&&(a-=8,s[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s})(e,i,r,t)})},XU=JU({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),$U=(JU({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),JU({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),JU({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),JU({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),JU({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),JU({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),JU({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),JU({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),YU({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"})),eF=(YU({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),JU({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}));JU({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),JU({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),JU({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function tF(e){let t=function(e){const t=()=>{};return t.enabled=!1,t.color="",t.diff=0,t.log=()=>{},t.namespace=e,t.destroy=()=>!0,t.extend=()=>t,t}("".concat(e,":trace"));return sf().enabled("".concat(e,":trace"))&&null!=sf().names.map((e=>e.toString())).find((e=>e.includes(":trace")))&&(t=sf()("".concat(e,":trace"))),Object.assign(sf()(e),{error:sf()("".concat(e,":error")),trace:t})}sf().formatters.b=e=>null==e?"undefined":$U.baseEncode(e),sf().formatters.t=e=>null==e?"undefined":XU.baseEncode(e),sf().formatters.m=e=>null==e?"undefined":eF.baseEncode(e),sf().formatters.p=e=>null==e?"undefined":e.toString(),sf().formatters.c=e=>null==e?"undefined":e.toString(),sf().formatters.k=e=>null==e?"undefined":e.toString(),sf().formatters.a=e=>null==e?"undefined":e.toString();var nF=n(96118);const rF=async e=>{if(e.readyState>=2)throw new Error("socket closed");1!==e.readyState&&await new Promise(((t,n)=>{function r(){e.removeEventListener("open",i),e.removeEventListener("error",o)}function i(){r(),t()}function o(t){var i;r(),n(null!==(i=t.error)&&void 0!==i?i:new Error("connect ECONNREFUSED ".concat(e.url)))}e.addEventListener("open",i),e.addEventListener("error",o)}))},iF=(e,t)=>{var n;(t=null!==(n=t)&&void 0!==n?n:{}).closeOnEnd=!1!==t.closeOnEnd;return async n=>{for await(const t of n){try{await rF(e)}catch(r){if("socket closed"===r.message)break;throw r}if(e.readyState===e.CLOSING||e.readyState===e.CLOSED)break;e.send(t)}null!=t.closeOnEnd&&e.readyState<=1&&await new Promise(((t,n)=>{e.addEventListener("close",(e=>{if(e.wasClean||1006===e.code)t();else{const t=Object.assign(new Error("ws error"),{event:e});n(t)}})),setTimeout((()=>{e.close()}))}))}};var oF=n(3634);function sF(e){var t;return e instanceof ArrayBuffer||"ArrayBuffer"===(null===e||void 0===e||null===(t=e.constructor)||void 0===t?void 0:t.name)&&"number"===typeof(null===e||void 0===e?void 0:e.byteLength)}const aF=(e,t)=>{var n;t=null!==(n=t)&&void 0!==n?n:{};const r=(e=>{e.binaryType="arraybuffer";const t=async()=>{await new Promise(((t,n)=>{if(i)return void t();if(null!=r)return void n(r);const o=t=>{e.removeEventListener("open",s),e.removeEventListener("error",a),t()},s=()=>{o(t)},a=t=>{o((()=>{var r;n(null!==(r=t.error)&&void 0!==r?r:new Error("connect ECONNREFUSED ".concat(e.url)))}))};e.addEventListener("open",s),e.addEventListener("error",a)}))},n=async function*(){const n=new oF.zN((t=>{let{push:n,stop:r,fail:i}=t;const o=e=>{let t=null;"string"===typeof e.data&&(t=(0,yu.m)(e.data)),sF(e.data)&&(t=new Uint8Array(e.data)),e.data instanceof Uint8Array&&(t=e.data),null!=t&&n(t)},s=e=>{var t;i(null!==(t=e.error)&&void 0!==t?t:new Error("Socket error"))};return e.addEventListener("message",o),e.addEventListener("error",s),e.addEventListener("close",r),()=>{e.removeEventListener("message",o),e.removeEventListener("error",s),e.removeEventListener("close",r)}}),{highWaterMark:1/0});await t();for await(const e of n)yield sF(e)?new Uint8Array(e):e}();let r,i=1===e.readyState;return e.addEventListener("open",(()=>{i=!0,r=null})),e.addEventListener("close",(()=>{i=!1,r=null})),e.addEventListener("error",(t=>{var n;i||(r=null!==(n=t.error)&&void 0!==n?n:new Error("connect ECONNREFUSED ".concat(e.url)))})),Object.assign(n,{connected:t})})(e);let i=t.remoteAddress,o=t.remotePort;if(null!=e.url)try{const t=new URL(e.url);i=t.hostname,o=parseInt(t.port,10)}catch{}if(null==i||null==o)throw new Error("Remote connection did not have address and/or port");return{sink:iF(e,t),source:r,connected:async()=>{await r.connected()},close:async()=>{e.readyState!==e.CONNECTING&&e.readyState!==e.OPEN||await new Promise((t=>{e.addEventListener("close",(()=>{t()})),e.close()}))},destroy:()=>{null!=e.terminate?e.terminate():e.close()},remoteAddress:i,remotePort:o,socket:e}},cF=WebSocket;var lF=n(16791);const uF={http:"ws",https:"wss"};function hF(e,t){var n;t=null!==(n=t)&&void 0!==n?n:{};const r=((e,t)=>(0,lF.relative)(e,t,uF,"ws"))(e,("undefined"===typeof window?"":window.location).toString()),i=new cF(r,t.websocket);return aF(i,t)}class dF extends Error{constructor(e,t){super(null!==e&&void 0!==e?e:"The operation was aborted"),this.type="aborted",this.code=null!==t&&void 0!==t?t:"ABORT_ERR"}}function fF(e,t,n){const r=null!==n&&void 0!==n?n:{},i=ad(e);return async function*(){let n;const o=()=>{null!=n&&n()};for(t.addEventListener("abort",o);;){let a;try{if(t.aborted){const{abortMessage:e,abortCode:t}=r;throw new dF(e,t)}const e=new Promise(((e,t)=>{n=()=>{const{abortMessage:e,abortCode:n}=r;t(new dF(e,n))}}));a=await Promise.race([e,i.next()]),n=null}catch(s){t.removeEventListener("abort",o);const n="aborted"===s.type&&t.aborted;if(n&&null!=r.onAbort&&r.onAbort(e),"function"===typeof i.return)try{const e=i.return();e instanceof Promise&&e.catch((e=>{null!=r.onReturnError&&r.onReturnError(e)}))}catch(s){null!=r.onReturnError&&r.onReturnError(s)}if(n&&!0===r.returnOnAbort)return;throw s}if(!0===a.done)break;yield a.value}t.removeEventListener("abort",o)}()}function pF(e,t,n){return r=>e(fF(r,t,n))}function gF(e,t,n){return{sink:pF(e.sink,t,{...n,onAbort:void 0}),source:fF(e.source,t,n)}}const yF=tF("libp2p:websockets:socket");const mF=tF("libp2p:websockets");class vF{constructor(e){(0,Yo.Z)(this,"init",void 0),(0,Yo.Z)(this,Symbol.toStringTag,"@libp2p/websockets"),(0,Yo.Z)(this,KU,!0),this.init=e}async dial(e,t){var n;mF("dialing %s",e),t=null!==(n=t)&&void 0!==n?n:{};const r=function(e,t,n){var r;const i={async sink(t){var r;null!=(null===(r=n)||void 0===r?void 0:r.signal)&&(t=fF(t,n.signal));try{await e.sink(t)}catch(i){"aborted"!==i.type&&yF.error(i)}},source:null!=(n=null!==(r=n)&&void 0!==r?r:{}).signal?fF(e.source,n.signal):e.source,remoteAddr:t,timeline:{open:Date.now()},async close(){var t;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r=Date.now();if(null==n.signal){const e=AbortSignal.timeout(500);n={...n,signal:e}}const o=()=>{const{host:e,port:t}=i.remoteAddr.toOptions();yF("timeout closing stream to %s:%s after %dms, destroying it manually",e,t,Date.now()-r),this.abort(new LU("Socket close timeout","ERR_SOCKET_CLOSE_TIMEOUT"))};null===(t=n.signal)||void 0===t||t.addEventListener("abort",o);try{await e.close()}catch(a){yF.error("error closing WebSocket gracefully",a),this.abort(a)}finally{var s;null===(s=n.signal)||void 0===s||s.removeEventListener("abort",o),i.timeline.close=Date.now()}},abort(t){const{host:n,port:r}=i.remoteAddr.toOptions();yF("timeout closing stream to %s:%s due to error",n,r,t),e.destroy(),i.timeline.close=Date.now()}};return e.socket.addEventListener("close",(()=>{null==i.timeline.close&&(i.timeline.close=Date.now())}),{once:!0}),i}(await this._connect(e,t),e);mF("new outbound connection %s",r.remoteAddr);const i=await t.upgrader.upgradeOutbound(r);return mF("outbound connection %s upgraded",r.remoteAddr),i}async _connect(e,t){var n;if(!0===(null===t||void 0===t||null===(n=t.signal)||void 0===n?void 0:n.aborted))throw new BU;const r=e.toOptions();mF("dialing %s:%s",r.host,r.port);const i=Ws(),o=hF((0,nF.k)(e),this.init);if(o.socket.addEventListener("error",(()=>{const t=new LU("Could not connect to ".concat(e.toString()),"ERR_CONNECTION_FAILED");mF.error("connection error:",t),i.reject(t)})),null==t.signal)return await Promise.race([o.connected(),i.promise]),mF("connected %s",e),o;let s;const a=new Promise(((e,n)=>{var r,i;s=()=>{n(new BU),o.close().catch((e=>{mF.error("error closing raw socket",e)}))},!0!==(null===t||void 0===t||null===(r=t.signal)||void 0===r?void 0:r.aborted)?null===t||void 0===t||null===(i=t.signal)||void 0===i||i.addEventListener("abort",s):s()}));try{await Promise.race([a,i.promise,o.connected()])}finally{var c;if(null!=s)null===t||void 0===t||null===(c=t.signal)||void 0===c||c.removeEventListener("abort",s)}return mF("connected %s",e),o}createListener(e){return function(){throw new Error("WebSocket Servers can not be created in the browser!")}(this.init)}filter(e){var t,n;return e=Array.isArray(e)?e:[e],null!=(null===(t=this.init)||void 0===t?void 0:t.filter)?null===(n=this.init)||void 0===n?void 0:n.filter(e):sO||uO?function(e){return e.filter((e=>{if(e.protoCodes().includes(290))return!1;const t=e.decapsulateCode(421);return Lx.matches(t)}))}(e):function(e){return e.filter((e=>{if(e.protoCodes().includes(290))return!1;const t=e.decapsulateCode(421);return Nx.matches(t)||Lx.matches(t)}))}(e)}}function bF(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return()=>new vF(e)}function wF(e){return null!=e[Symbol.asyncIterator]}const EF=e=>{const t=Bs.P$(e),n=(0,Us.E)(t);return Bs.cv(e,n),EF.bytes=t,n};EF.bytes=0;var AF;!function(e){e[e.LENGTH=0]="LENGTH",e[e.DATA=1]="DATA"}(AF||(AF={}));const SF=e=>{const t=Bs.Jx(e);return SF.bytes=Bs.P$(t),t};function _F(e,t){var n,r,i;const o=new Zs;let s=AF.LENGTH,a=-1;const c=null!==(n=null===t||void 0===t?void 0:t.lengthDecoder)&&void 0!==n?n:SF,l=null!==(r=null===t||void 0===t?void 0:t.maxLengthLength)&&void 0!==r?r:8,u=null!==(i=null===t||void 0===t?void 0:t.maxDataLength)&&void 0!==i?i:4194304;function*h(){for(;o.byteLength>0;){if(s===AF.LENGTH)try{if(a=c(o),a<0)throw Xo()(new Error("invalid message length"),"ERR_INVALID_MSG_LENGTH");if(a>u)throw Xo()(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");const e=c.bytes;o.consume(e),null!=(null===t||void 0===t?void 0:t.onLength)&&t.onLength(a),s=AF.DATA}catch(e){if(e instanceof RangeError){if(o.byteLength>l)throw Xo()(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG");break}throw e}if(s===AF.DATA){if(o.byteLength<a)break;const e=o.sublist(0,a);o.consume(a),null!=(null===t||void 0===t?void 0:t.onData)&&t.onData(e),yield e,s=AF.LENGTH}}}return wF(e)?async function*(){for await(const t of e)o.append(t),yield*h();if(o.byteLength>0)throw Xo()(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}():function*(){for(const t of e)o.append(t),yield*h();if(o.byteLength>0)throw Xo()(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}()}function IF(){const e=Ws();let t=!1;return{sink:async n=>{if(t)throw new Error("already piped");t=!0,e.resolve(n)},source:async function*(){const t=await e.promise;yield*t}()}}SF.bytes=0,_F.fromReader=(e,t)=>{let n=1;return _F(async function*(){for(;;)try{const{done:t,value:r}=await e.next(n);if(!0===t)return;null!=r&&(yield r)}catch(t){if("ERR_UNDER_READ"===t.code)return{done:!0,value:null};throw t}finally{n=1}}(),{...null!==t&&void 0!==t?t:{},onLength:e=>{n=e}})};class CF{constructor(e){if((0,Yo.Z)(this,"buffer",void 0),(0,Yo.Z)(this,"mask",void 0),(0,Yo.Z)(this,"top",void 0),(0,Yo.Z)(this,"btm",void 0),(0,Yo.Z)(this,"next",void 0),!(e>0)||0!==(e-1&e))throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];if(void 0!==e)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return void 0===this.buffer[this.btm]}}class TF{constructor(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,Yo.Z)(this,"size",void 0),(0,Yo.Z)(this,"hwm",void 0),(0,Yo.Z)(this,"head",void 0),(0,Yo.Z)(this,"tail",void 0),this.hwm=null!==(e=t.splitLimit)&&void 0!==e?e:16,this.head=new CF(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return null!=(null===e||void 0===e?void 0:e.byteLength)?e.byteLength:1}push(e){if(null!=(null===e||void 0===e?void 0:e.value)&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){const t=this.head;this.head=t.next=new CF(2*this.head.buffer.length),this.head.push(e)}}shift(){var e;let t=this.tail.shift();if(void 0===t&&null!=this.tail.next){const e=this.tail.next;this.tail.next=null,this.tail=e,t=this.tail.shift()}return null!=(null===(e=t)||void 0===e?void 0:e.value)&&(this.size-=this.calculateSize(t.value)),t}isEmpty(){return this.head.isEmpty()}}class kF extends Error{constructor(e,t){super(null!==e&&void 0!==e?e:"The operation was aborted"),(0,Yo.Z)(this,"type",void 0),(0,Yo.Z)(this,"code",void 0),this.type="aborted",this.code=null!==t&&void 0!==t?t:"ABORT_ERR"}}function RF(){return xF((e=>{const t=e.shift();if(null==t)return{done:!0};if(null!=t.error)throw t.error;return{done:!0===t.done,value:t.value}}),arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function xF(e,t){var n;let r,i,o,s=(t=null!==(n=t)&&void 0!==n?n:{}).onEnd,a=new TF,c=Ws();const l=e=>null!=i?i(e):(a.push(e),r),u=e=>{var n;if(o)return r;if(!0!==(null===(n=t)||void 0===n?void 0:n.objectMode)&&null==(null===e||void 0===e?void 0:e.byteLength))throw new Error("objectMode was not true but tried to push non-Uint8Array value");return l({done:!1,value:e})},h=e=>o?r:(o=!0,null!=e?(e=>(a=new TF,null!=i?i({error:e}):(a.push({error:e}),r)))(e):l({done:!0}));if(r={[Symbol.asyncIterator](){return this},next:async()=>{try{return a.isEmpty()?o?{done:!0}:await new Promise(((t,n)=>{i=o=>{i=null,a.push(o);try{t(e(a))}catch(s){n(s)}return r}})):e(a)}finally{a.isEmpty()&&queueMicrotask((()=>{c.resolve(),c=Ws()}))}},return:()=>(a=new TF,h(),{done:!0}),throw:e=>(h(e),{done:!0}),push:u,end:h,get readableLength(){return a.size},onEmpty:async e=>{const t=null===e||void 0===e?void 0:e.signal;if(null===t||void 0===t||t.throwIfAborted(),a.isEmpty())return;let n,r;null!=t&&(n=new Promise(((e,n)=>{r=()=>{n(new kF)},t.addEventListener("abort",r)})));try{await Promise.race([c.promise,n])}finally{null!=r&&null!=t&&(null===t||void 0===t||t.removeEventListener("abort",r))}}},null==s)return r;const d=r;return r={[Symbol.asyncIterator](){return this},next:()=>d.next(),throw:e=>(d.throw(e),null!=s&&(s(e),s=void 0),{done:!0}),return:()=>(d.return(),null!=s&&(s(),s=void 0),{done:!0}),push:u,end:e=>(d.end(e),null!=s&&(s(e),s=void 0),r),get readableLength(){return d.readableLength},onEmpty:e=>d.onEmpty(e)},r}const PF=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=[];for(const i of t)null==i[Symbol.asyncIterator]&&r.push(i);return r.length===t.length?function*(){for(const e of r)yield*e}():async function*(){const e=RF({objectMode:!0});Promise.resolve().then((async()=>{try{await Promise.all(t.map((async t=>{for await(const n of t)e.push(n)}))),e.end()}catch(n){e.end(n)}})),yield*e}()};const DF=function(){let e;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(;n.length>0;)e=n.shift()(e);return e},OF=e=>null!=(null===e||void 0===e?void 0:e[Symbol.asyncIterator]),NF=e=>null!=(null===e||void 0===e?void 0:e[Symbol.iterator]),BF=e=>null!=e&&(null!=e.sink&&null!=e.source),LF=e=>t=>{const n=e.sink(t);if(null!=(null===n||void 0===n?void 0:n.then)){const t=RF({objectMode:!0});let r;n.then((()=>{t.end()}),(e=>{t.end(e)}));const i=e.source;if(OF(i))r=async function*(){yield*i,t.end()};else{if(!NF(i))throw new Error("Unknown duplex source type - must be Iterable or AsyncIterable");r=function*(){yield*i,t.end()}}return PF(t,r())}return e.source};var MF,UF;const FF=65535,KF=Boolean(null===(MF=globalThis.process)||void 0===MF||null===(UF=MF.env)||void 0===UF?void 0:UF.DUMP_SESSION_KEYS),jF={hashSHA256:e=>au(e),getHKDF(e,t){const n=Xl(au,t,e),r=tu(au,n,void 0,96);return[r.subarray(0,32),r.subarray(32,64),r.subarray(64,96)]},generateX25519KeyPair(){const e=Wl.utils.randomPrivateKey();return{publicKey:Wl.getPublicKey(e),privateKey:e}},generateX25519KeyPairFromSeed:e=>({publicKey:Wl.getPublicKey(e),privateKey:e}),generateX25519SharedKey:(e,t)=>Wl.getSharedSecret(e,t),chaCha20Poly1305Encrypt:(e,t,n,r)=>lc(r,t,n).encrypt(e),chaCha20Poly1305Decrypt:(e,t,n,r,i)=>lc(r,t,n).decrypt(e,i)},ZF=e=>{const t=(0,Us.E)(2);return new DataView(t.buffer,t.byteOffset,t.byteLength).setUint16(0,e,!1),t};ZF.bytes=2;const zF=e=>{if(e.length<2)throw RangeError("Could not decode int16BE");return e instanceof Uint8Array?new DataView(e.buffer,e.byteOffset,e.byteLength).getUint16(0,!1):e.getUint16(0)};zF.bytes=2;class VF extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"The operation was aborted"),(0,Yo.Z)(this,"code",void 0),(0,Yo.Z)(this,"type",void 0),this.code=VF.code,this.type=VF.type}}(0,Yo.Z)(VF,"code","ABORT_ERR"),(0,Yo.Z)(VF,"type","aborted");class HF extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected Peer"),(0,Yo.Z)(this,"code",void 0),this.code=HF.code}}(0,Yo.Z)(HF,"code","ERR_UNEXPECTED_PEER");class qF extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid crypto exchange"),(0,Yo.Z)(this,"code",void 0),this.code=qF.code}}(0,Yo.Z)(qF,"code","ERR_INVALID_CRYPTO_EXCHANGE");class GF extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid crypto transmission"),(0,Yo.Z)(this,"code",void 0),this.code=GF.code}}(0,Yo.Z)(GF,"code","ERR_INVALID_CRYPTO_TRANSMISSION");class WF extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"The operation was aborted"),(0,Yo.Z)(this,"code",void 0),(0,Yo.Z)(this,"type",void 0),this.code=WF.code,this.type=WF.type}}(0,Yo.Z)(WF,"code","ABORT_ERR"),(0,Yo.Z)(WF,"type","aborted");class QF extends Error{constructor(e,t,n){var r;super(e),(0,Yo.Z)(this,"code",void 0),(0,Yo.Z)(this,"props",void 0),this.code=t,this.name=null!==(r=null===n||void 0===n?void 0:n.name)&&void 0!==r?r:"CodeError",this.props=null!==n&&void 0!==n?n:{}}}class YF extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected Peer"),(0,Yo.Z)(this,"code",void 0),this.code=YF.code}}(0,Yo.Z)(YF,"code","ERR_UNEXPECTED_PEER");class JF extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid crypto exchange"),(0,Yo.Z)(this,"code",void 0),this.code=JF.code}}(0,Yo.Z)(JF,"code","ERR_INVALID_CRYPTO_EXCHANGE");class XF extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid crypto transmission"),(0,Yo.Z)(this,"code",void 0),this.code=XF.code}}(0,Yo.Z)(XF,"code","ERR_INVALID_CRYPTO_TRANSMISSION");var $F=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==n[s])throw new TypeError(o+" is ambiguous");n[s]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var r=0,i=0;e[t]===c;)r++,t++;for(var o=(e.length-t)*l+1>>>0,s=new Uint8Array(o);e[t];){var u=n[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=o-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*s[d]>>>0,s[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=o-i;f!==o&&0===s[f];)f++;for(var p=new Uint8Array(r+(o-f)),g=r;f!==o;)p[g++]=s[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,o=t.length;i!==o&&0===t[i];)i++,n++;for(var s=(o-i)*u+1>>>0,l=new Uint8Array(s);i!==o;){for(var h=t[i],d=0,f=s-1;(0!==h||d<r)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");r=d,i++}for(var p=s-r;p!==s&&0===l[p];)p++;for(var g=c.repeat(n);p<s;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:h,decode:function(e){var n=h(e);if(n)return n;throw new Error("Non-".concat(t," character"))}}};const eK=$F,tK=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class nK{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(e));throw Error("Unknown type, must be binary type")}}class rK{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(e),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return oK(this,e)}}class iK{constructor(e){this.decoders=e}or(e){return oK(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(e),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}}const oK=(e,t)=>new iK({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class sK{constructor(e,t,n,r){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=r,this.encoder=new nK(e,t,n),this.decoder=new rK(e,t,r)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const aK=e=>{let{name:t,prefix:n,encode:r,decode:i}=e;return new sK(t,n,r,i)},cK=e=>{let{prefix:t,name:n,alphabet:r}=e;const{encode:i,decode:o}=eK(r,n);return aK({prefix:t,name:n,encode:i,decode:e=>tK(o(e))})},lK=e=>{let{name:t,prefix:n,bitsPerChar:r,alphabet:i}=e;return aK({prefix:n,name:t,encode:e=>((e,t,n)=>{const r="="===t[t.length-1],i=(1<<n)-1;let o="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>n;)s-=n,o+=t[i&a>>s];if(s&&(o+=t[i&a<<n-s]),r)for(;o.length*n&7;)o+="=";return o})(e,i,r),decode:e=>((e,t,n,r)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*n/8|0);let a=0,c=0,l=0;for(let u=0;u<o;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError("Non-".concat(r," character"));c=c<<n|t,a+=n,a>=8&&(a-=8,s[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s})(e,i,r,t)})},uK=cK({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),hK=cK({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var dK=function e(t,n,r){n=n||[];var i=r=r||0;for(;t>=gK;)n[r++]=255&t|fK,t/=128;for(;t&pK;)n[r++]=255&t|fK,t>>>=7;return n[r]=0|t,e.bytes=r-i+1,n},fK=128,pK=-128,gK=Math.pow(2,31);var yK=function e(t,n){var r,i=0,o=0,s=n=n||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");r=t[s++],i+=o<28?(r&vK)<<o:(r&vK)*Math.pow(2,o),o+=7}while(r>=mK);return e.bytes=s-n,i},mK=128,vK=127;var bK=Math.pow(2,7),wK=Math.pow(2,14),EK=Math.pow(2,21),AK=Math.pow(2,28),SK=Math.pow(2,35),_K=Math.pow(2,42),IK=Math.pow(2,49),CK=Math.pow(2,56),TK=Math.pow(2,63);const kK={encode:dK,decode:yK,encodingLength:function(e){return e<bK?1:e<wK?2:e<EK?3:e<AK?4:e<SK?5:e<_K?6:e<IK?7:e<CK?8:e<TK?9:10}},RK=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return[kK.decode(e,t),kK.decode.bytes]},xK=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return kK.encode(e,t,n),t},PK=e=>kK.encodingLength(e),DK=(e,t)=>{const n=t.byteLength,r=PK(e),i=r+PK(n),o=new Uint8Array(i+n);return xK(e,o,0),xK(n,o,r),o.set(t,i),new NK(e,n,t,o)},OK=e=>{const t=tK(e),[n,r]=RK(t),[i,o]=RK(t.subarray(r)),s=t.subarray(r+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new NK(n,i,s,t)};class NK{constructor(e,t,n,r){this.code=e,this.size=t,this.digest=n,this.bytes=r}}const BK=tK,LK={code:0,name:"identity",encode:BK,digest:e=>DK(0,BK(e))},MK=e=>{let{name:t,code:n,encode:r}=e;return new UK(t,n,r)};class UK{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?DK(this.code,t):t.then((e=>DK(this.code,e)))}throw Error("Unknown type, must be binary type")}}const FK=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),KK=MK({name:"sha2-256",code:18,encode:FK("SHA-256")}),jK=MK({name:"sha2-512",code:19,encode:FK("SHA-512")}),ZK=32,zK=64,VK=32;function HK(e,t){const n=new Uint8Array(zK);for(let r=0;r<VK;r++)n[r]=e[r],n[VK+r]=t[r];return n}const qK=lK({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),GK=lK({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),WK=lK({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),QK=lK({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),YK={get(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:globalThis).crypto;if(null==e||null==e.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}},JK={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};async function XK(e,t){const n=function(e){var t,n,r,i,o,s;const a=null!==(t=null===e||void 0===e?void 0:e.algorithm)&&void 0!==t?t:"AES-GCM";let c=null!==(n=null===e||void 0===e?void 0:e.keyLength)&&void 0!==n?n:16;const l=null!==(r=null===e||void 0===e?void 0:e.nonceLength)&&void 0!==r?r:12,u=null!==(i=null===e||void 0===e?void 0:e.digest)&&void 0!==i?i:"SHA-256",h=null!==(o=null===e||void 0===e?void 0:e.saltLength)&&void 0!==o?o:16,d=null!==(s=null===e||void 0===e?void 0:e.iterations)&&void 0!==s?s:32767,f=YK.get();return c*=8,{encrypt:async function(e,t){const n=f.getRandomValues(new Uint8Array(h)),r=f.getRandomValues(new Uint8Array(l)),i={name:a,iv:r};let o;if("string"===typeof t&&(t=(0,yu.m)(t)),0===t.length){o=await f.subtle.importKey("jwk",JK,{name:"AES-GCM"},!0,["encrypt"]);try{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);o=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["encrypt"])}catch{o=await f.subtle.importKey("jwk",JK,{name:"AES-GCM"},!0,["encrypt"])}}else{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);o=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["encrypt"])}const s=await f.subtle.encrypt(i,o,e);return(0,Ls.z)([n,i.iv,new Uint8Array(s)])},decrypt:async function(e,t){const n=e.subarray(0,h),r=e.subarray(h,h+l),i=e.subarray(h+l),o={name:a,iv:r};let s;if("string"===typeof t&&(t=(0,yu.m)(t)),0===t.length)try{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);s=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["decrypt"])}catch{s=await f.subtle.importKey("jwk",JK,{name:"AES-GCM"},!0,["decrypt"])}else{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);s=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["decrypt"])}const p=await f.subtle.decrypt(o,s,i);return new Uint8Array(p)}}}(),r=await n.encrypt(e,t);return qK.encode(r)}var $K,ej,tj,nj;!function(e){e.RSA="RSA",e.Ed25519="Ed25519",e.Secp256k1="Secp256k1"}($K||($K={})),function(e){e[e.RSA=0]="RSA",e[e.Ed25519=1]="Ed25519",e[e.Secp256k1=2]="Secp256k1"}(ej||(ej={})),function(e){e.codec=()=>bs(ej)}($K||($K={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),$K.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.Type=$K.codec().decode(e);break;case 2:n.Data=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(tj||(tj={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),$K.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.Type=$K.codec().decode(e);break;case 2:n.Data=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(nj||(nj={}));class rj{constructor(e){(0,Yo.Z)(this,"_key",void 0),this._key=lj(e,ZK)}async verify(e,t){return async function(e,t,n){return ql.verify(t,n,e)}(this._key,t,e)}marshal(){return this._key}get bytes(){return tj.encode({Type:$K.Ed25519,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await KK.digest(this.bytes);return e}}class ij{constructor(e,t){(0,Yo.Z)(this,"_key",void 0),(0,Yo.Z)(this,"_publicKey",void 0),this._key=lj(e,zK),this._publicKey=lj(t,ZK)}async sign(e){return async function(e,t){const n=e.subarray(0,VK);return ql.sign(t,n)}(this._key,e)}get public(){return new rj(this._publicKey)}marshal(){return this._key}get bytes(){return nj.encode({Type:$K.Ed25519,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await KK.digest(this.bytes);return e}async id(){const e=LK.digest(this.public.bytes);return uK.encode(e.bytes).substring(1)}async export(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"libp2p-key";if("libp2p-key"===t)return XK(this.bytes,e);throw new QF("export format '".concat(t,"' is not supported"),"ERR_INVALID_EXPORT_FORMAT")}}function oj(e){if(e.length>zK){const t=(e=lj(e,zK+ZK)).subarray(0,zK),n=e.subarray(zK,e.length);return new ij(t,n)}const t=(e=lj(e,zK)).subarray(0,zK),n=e.subarray(ZK);return new ij(t,n)}function sj(e){return e=lj(e,ZK),new rj(e)}async function aj(){const{privateKey:e,publicKey:t}=await async function(){const e=ql.utils.randomPrivateKey(),t=ql.getPublicKey(e);return{privateKey:HK(e,t),publicKey:t}}();return new ij(e,t)}async function cj(e){const{privateKey:t,publicKey:n}=await async function(e){if(e.length!==VK)throw new TypeError('"seed" must be 32 bytes in length.');if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');const t=e,n=ql.getPublicKey(t);return{privateKey:HK(t,n),publicKey:n}}(e);return new ij(t,n)}function lj(e,t){var n;if((e=Uint8Array.from(null!==(n=e)&&void 0!==n?n:[])).length!==t)throw new QF("Key must be a Uint8Array of length ".concat(t,", got ").concat(e.length),"ERR_INVALID_KEY_TYPE");return e}function uj(e,t){let n=Uint8Array.from(e.abs().toByteArray());if(n=0===n[0]?n.subarray(1):n,null!=t){if(n.length>t)throw new Error("byte array longer than desired length");n=(0,Ls.z)([new Uint8Array(t-n.length),n])}return(0,Au.B)(n,"base64url")}function hj(e){const t=function(e,t){let n=(0,yu.m)(e,"base64urlpad");if(null!=t){if(n.length>t)throw new Error("byte array longer than desired length");n=(0,Ls.z)([new Uint8Array(t-n.length),n])}return n}(e);return new(gu().jsbn.BigInteger)((0,Au.B)(t,"base16"),16)}const dj={"P-256":256,"P-384":384,"P-521":521};Object.keys(dj).join(" / ");function fj(e,t){return t.map((t=>hj(e[t])))}async function pj(e){const t=[await YK.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await yj(e)],n=await gj({privateKey:t[0],publicKey:t[1]});return{privateKey:n[0],publicKey:n[1]}}async function gj(e){if(null==e.privateKey||null==e.publicKey)throw new QF("Private and public key are required","ERR_INVALID_PARAMETERS");return Promise.all([YK.get().subtle.exportKey("jwk",e.privateKey),YK.get().subtle.exportKey("jwk",e.publicKey)])}async function yj(e){return YK.get().subtle.importKey("jwk",{kty:e.kty,n:e.n,e:e.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function mj(e,t,n,r){const i=t?function(e){return gu().pki.setRsaPublicKey(...fj(e,["n","e"]))}(e):function(e){return gu().pki.setRsaPrivateKey(...fj(e,["n","e","d","p","q","dp","dq","qi"]))}(e),o=r((0,Au.B)(Uint8Array.from(n),"ascii"),i);return(0,yu.m)(o,"ascii")}function vj(e){if("RSA"!==e.kty)throw new QF("invalid key type","ERR_INVALID_KEY_TYPE");if(null==e.n)throw new QF("invalid key modulus","ERR_INVALID_KEY_MODULUS");return 8*(0,yu.m)(e.n,"base64url").length}const bj=8192;class wj{constructor(e){(0,Yo.Z)(this,"_key",void 0),this._key=e}async verify(e,t){return async function(e,t,n){const r=await YK.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return YK.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},r,t,n)}(this._key,t,e)}marshal(){return function(e){if(null==e.n||null==e.e)throw new QF("JWK was missing components","ERR_INVALID_PARAMETERS");const t=gu().pki.publicKeyToAsn1({n:hj(e.n),e:hj(e.e)});return(0,yu.m)(gu().asn1.toDer(t).getBytes(),"ascii")}(this._key)}get bytes(){return tj.encode({Type:$K.RSA,Data:this.marshal()}).subarray()}encrypt(e){return mj(this._key,!0,e,((e,t)=>t.encrypt(e)))}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await KK.digest(this.bytes);return e}}class Ej{constructor(e,t){(0,Yo.Z)(this,"_key",void 0),(0,Yo.Z)(this,"_publicKey",void 0),this._key=e,this._publicKey=t}genSecret(){return function(e){if(isNaN(e)||e<=0)throw new QF("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return _c(e)}(16)}async sign(e){return async function(e,t){const n=await YK.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),r=await YK.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},n,Uint8Array.from(t));return new Uint8Array(r,0,r.byteLength)}(this._key,e)}get public(){if(null==this._publicKey)throw new QF("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new wj(this._publicKey)}decrypt(e){return mj(this._key,!1,e,((e,t)=>t.decrypt(e)))}marshal(){return function(e){if(null==e.n||null==e.e||null==e.d||null==e.p||null==e.q||null==e.dp||null==e.dq||null==e.qi)throw new QF("JWK was missing components","ERR_INVALID_PARAMETERS");const t=gu().pki.privateKeyToAsn1({n:hj(e.n),e:hj(e.e),d:hj(e.d),p:hj(e.p),q:hj(e.q),dP:hj(e.dp),dQ:hj(e.dq),qInv:hj(e.qi)});return(0,yu.m)(gu().asn1.toDer(t).getBytes(),"ascii")}(this._key)}get bytes(){return nj.encode({Type:$K.RSA,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await KK.digest(this.bytes);return e}async id(){const e=await this.public.hash();return(0,Au.B)(e,"base58btc")}async export(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"pkcs-8";if("pkcs-8"===t){const t=new(gu().util.ByteBuffer)(this.marshal()),n=gu().asn1.fromDer(t),r=gu().pki.privateKeyFromAsn1(n),i={algorithm:"aes256",count:1e4,saltSize:16,prfAlgorithm:"sha512"};return gu().pki.encryptRsaPrivateKey(r,e,i)}if("libp2p-key"===t)return XK(this.bytes,e);throw new QF("export format '".concat(t,"' is not supported"),"ERR_INVALID_EXPORT_FORMAT")}}async function Aj(e){const t=function(e){const t=gu().asn1.fromDer((0,Au.B)(e,"ascii")),n=gu().pki.privateKeyFromAsn1(t);return{kty:"RSA",n:uj(n.n),e:uj(n.e),d:uj(n.d),p:uj(n.p),q:uj(n.q),dp:uj(n.dP),dq:uj(n.dQ),qi:uj(n.qInv),alg:"RS256"}}(e);if(vj(t)>bj)throw new QF("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const n=await pj(t);return new Ej(n.privateKey,n.publicKey)}function Sj(e){const t=function(e){const t=gu().asn1.fromDer((0,Au.B)(e,"ascii")),n=gu().pki.publicKeyFromAsn1(t);return{kty:"RSA",n:uj(n.n),e:uj(n.e)}}(e);if(vj(t)>bj)throw new QF("key size is too large","ERR_KEY_SIZE_TOO_LARGE");return new wj(t)}async function _j(e){if(vj(e)>bj)throw new QF("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const t=await pj(e);return new Ej(t.privateKey,t.publicKey)}async function Ij(e){if(e>bj)throw new QF("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const t=await async function(e){const t=await YK.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),n=await gj(t);return{privateKey:n[0],publicKey:n[1]}}(e);return new Ej(t.privateKey,t.publicKey)}function Cj(e){try{Eh.ProjectivePoint.fromHex(e)}catch(t){throw new QF(String(t),"ERR_INVALID_PUBLIC_KEY")}}class Tj{constructor(e){(0,Yo.Z)(this,"_key",void 0),Cj(e),this._key=e}async verify(e,t){return async function(e,t,n){try{const{digest:r}=await KK.digest(n);return Eh.verify(t,r,e)}catch(r){throw new QF(String(r),"ERR_INVALID_INPUT")}}(this._key,t,e)}marshal(){return e=this._key,Eh.ProjectivePoint.fromHex(e).toRawBytes(!0);var e}get bytes(){return tj.encode({Type:$K.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await KK.digest(this.bytes);return e}}class kj{constructor(e,t){(0,Yo.Z)(this,"_key",void 0),(0,Yo.Z)(this,"_publicKey",void 0),this._key=e,this._publicKey=null!==t&&void 0!==t?t:function(e){try{return Eh.getPublicKey(e,!0)}catch(t){throw new QF(String(t),"ERR_INVALID_PRIVATE_KEY")}}(e),function(e){try{Eh.getPublicKey(e,!0)}catch(t){throw new QF(String(t),"ERR_INVALID_PRIVATE_KEY")}}(this._key),Cj(this._publicKey)}async sign(e){return async function(e,t){const{digest:n}=await KK.digest(t);try{return Eh.sign(n,e).toDERRawBytes()}catch(r){throw new QF(String(r),"ERR_INVALID_INPUT")}}(this._key,e)}get public(){return new Tj(this._publicKey)}marshal(){return this._key}get bytes(){return nj.encode({Type:$K.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await KK.digest(this.bytes);return e}async id(){const e=await this.public.hash();return(0,Au.B)(e,"base58btc")}async export(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"libp2p-key";if("libp2p-key"===t)return XK(this.bytes,e);throw new QF("export format '".concat(t,"' is not supported"),"ERR_INVALID_EXPORT_FORMAT")}}function Rj(e){return new kj(e)}function xj(e){return new Tj(e)}async function Pj(){const e=Eh.utils.randomPrivateKey();return new kj(e)}const Dj={rsa:kt,ed25519:Tt,secp256k1:Rt};function Oj(e){const t=Object.keys(Dj).join(" / ");return new QF("invalid or unsupported key type ".concat(e,". Must be ").concat(t),"ERR_UNSUPPORTED_KEY_TYPE")}async function Nj(e){var t,n;const r=nj.decode(e),i=null!==(t=r.Data)&&void 0!==t?t:new Uint8Array;switch(r.Type){case $K.RSA:return Dj.rsa.unmarshalRsaPrivateKey(i);case $K.Ed25519:return Dj.ed25519.unmarshalEd25519PrivateKey(i);case $K.Secp256k1:return Dj.secp256k1.unmarshalSecp256k1PrivateKey(i);default:throw Oj(null!==(n=r.Type)&&void 0!==n?n:"RSA")}}const Bj=Symbol.for("@libp2p/peer-id");const Lj=cK({prefix:"9",name:"base10",alphabet:"0123456789"}),Mj=lK({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Uj=lK({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Fj=lK({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Kj=Array.from("\ud83d\ude80\ud83e\ude90\u2604\ud83d\udef0\ud83c\udf0c\ud83c\udf11\ud83c\udf12\ud83c\udf13\ud83c\udf14\ud83c\udf15\ud83c\udf16\ud83c\udf17\ud83c\udf18\ud83c\udf0d\ud83c\udf0f\ud83c\udf0e\ud83d\udc09\u2600\ud83d\udcbb\ud83d\udda5\ud83d\udcbe\ud83d\udcbf\ud83d\ude02\u2764\ud83d\ude0d\ud83e\udd23\ud83d\ude0a\ud83d\ude4f\ud83d\udc95\ud83d\ude2d\ud83d\ude18\ud83d\udc4d\ud83d\ude05\ud83d\udc4f\ud83d\ude01\ud83d\udd25\ud83e\udd70\ud83d\udc94\ud83d\udc96\ud83d\udc99\ud83d\ude22\ud83e\udd14\ud83d\ude06\ud83d\ude44\ud83d\udcaa\ud83d\ude09\u263a\ud83d\udc4c\ud83e\udd17\ud83d\udc9c\ud83d\ude14\ud83d\ude0e\ud83d\ude07\ud83c\udf39\ud83e\udd26\ud83c\udf89\ud83d\udc9e\u270c\u2728\ud83e\udd37\ud83d\ude31\ud83d\ude0c\ud83c\udf38\ud83d\ude4c\ud83d\ude0b\ud83d\udc97\ud83d\udc9a\ud83d\ude0f\ud83d\udc9b\ud83d\ude42\ud83d\udc93\ud83e\udd29\ud83d\ude04\ud83d\ude00\ud83d\udda4\ud83d\ude03\ud83d\udcaf\ud83d\ude48\ud83d\udc47\ud83c\udfb6\ud83d\ude12\ud83e\udd2d\u2763\ud83d\ude1c\ud83d\udc8b\ud83d\udc40\ud83d\ude2a\ud83d\ude11\ud83d\udca5\ud83d\ude4b\ud83d\ude1e\ud83d\ude29\ud83d\ude21\ud83e\udd2a\ud83d\udc4a\ud83e\udd73\ud83d\ude25\ud83e\udd24\ud83d\udc49\ud83d\udc83\ud83d\ude33\u270b\ud83d\ude1a\ud83d\ude1d\ud83d\ude34\ud83c\udf1f\ud83d\ude2c\ud83d\ude43\ud83c\udf40\ud83c\udf37\ud83d\ude3b\ud83d\ude13\u2b50\u2705\ud83e\udd7a\ud83c\udf08\ud83d\ude08\ud83e\udd18\ud83d\udca6\u2714\ud83d\ude23\ud83c\udfc3\ud83d\udc90\u2639\ud83c\udf8a\ud83d\udc98\ud83d\ude20\u261d\ud83d\ude15\ud83c\udf3a\ud83c\udf82\ud83c\udf3b\ud83d\ude10\ud83d\udd95\ud83d\udc9d\ud83d\ude4a\ud83d\ude39\ud83d\udde3\ud83d\udcab\ud83d\udc80\ud83d\udc51\ud83c\udfb5\ud83e\udd1e\ud83d\ude1b\ud83d\udd34\ud83d\ude24\ud83c\udf3c\ud83d\ude2b\u26bd\ud83e\udd19\u2615\ud83c\udfc6\ud83e\udd2b\ud83d\udc48\ud83d\ude2e\ud83d\ude46\ud83c\udf7b\ud83c\udf43\ud83d\udc36\ud83d\udc81\ud83d\ude32\ud83c\udf3f\ud83e\udde1\ud83c\udf81\u26a1\ud83c\udf1e\ud83c\udf88\u274c\u270a\ud83d\udc4b\ud83d\ude30\ud83e\udd28\ud83d\ude36\ud83e\udd1d\ud83d\udeb6\ud83d\udcb0\ud83c\udf53\ud83d\udca2\ud83e\udd1f\ud83d\ude41\ud83d\udea8\ud83d\udca8\ud83e\udd2c\u2708\ud83c\udf80\ud83c\udf7a\ud83e\udd13\ud83d\ude19\ud83d\udc9f\ud83c\udf31\ud83d\ude16\ud83d\udc76\ud83e\udd74\u25b6\u27a1\u2753\ud83d\udc8e\ud83d\udcb8\u2b07\ud83d\ude28\ud83c\udf1a\ud83e\udd8b\ud83d\ude37\ud83d\udd7a\u26a0\ud83d\ude45\ud83d\ude1f\ud83d\ude35\ud83d\udc4e\ud83e\udd32\ud83e\udd20\ud83e\udd27\ud83d\udccc\ud83d\udd35\ud83d\udc85\ud83e\uddd0\ud83d\udc3e\ud83c\udf52\ud83d\ude17\ud83e\udd11\ud83c\udf0a\ud83e\udd2f\ud83d\udc37\u260e\ud83d\udca7\ud83d\ude2f\ud83d\udc86\ud83d\udc46\ud83c\udfa4\ud83d\ude47\ud83c\udf51\u2744\ud83c\udf34\ud83d\udca3\ud83d\udc38\ud83d\udc8c\ud83d\udccd\ud83e\udd40\ud83e\udd22\ud83d\udc45\ud83d\udca1\ud83d\udca9\ud83d\udc50\ud83d\udcf8\ud83d\udc7b\ud83e\udd10\ud83e\udd2e\ud83c\udfbc\ud83e\udd75\ud83d\udea9\ud83c\udf4e\ud83c\udf4a\ud83d\udc7c\ud83d\udc8d\ud83d\udce3\ud83e\udd42"),jj=Kj.reduce(((e,t,n)=>(e[n]=t,e)),[]),Zj=Kj.reduce(((e,t,n)=>(e[t.codePointAt(0)]=n,e)),[]);const zj=aK({prefix:"\ud83d\ude80",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=jj[t]),"")},decode:function(e){const t=[];for(const n of e){const e=Zj[n.codePointAt(0)];if(void 0===e)throw new Error("Non-base256emoji character: ".concat(n));t.push(e)}return new Uint8Array(t)}}),Vj=lK({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Hj=lK({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),qj=lK({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Gj=lK({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Wj=lK({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Qj=lK({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Yj=lK({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Jj=lK({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Xj=lK({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),$j=cK({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),eZ=cK({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),tZ=lK({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),nZ=aK({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),rZ=new TextEncoder,iZ=new TextDecoder,oZ="json",sZ=512,aZ=e=>rZ.encode(JSON.stringify(e)),cZ=e=>JSON.parse(iZ.decode(e)),lZ="raw",uZ=85,hZ=e=>tK(e),dZ=e=>tK(e),fZ=(e,t)=>{const{bytes:n,version:r}=e;return 0===r?vZ(n,gZ(e),t||uK.encoder):bZ(n,gZ(e),t||Vj.encoder)},pZ=new WeakMap,gZ=e=>{const t=pZ.get(e);if(null==t){const t=new Map;return pZ.set(e,t),t}return t};class yZ{constructor(e,t,n,r){this.code=t,this.version=e,this.multihash=n,this.bytes=r,this["/"]=r}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==wZ)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==EZ)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return yZ.createV0(t)}default:throw Error("Can not convert CID version ".concat(this.version," to version 0. This is a bug please report"))}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=DK(e,t);return yZ.createV1(this.code,n)}case 1:return this;default:throw Error("Can not convert CID version ".concat(this.version," to version 1. This is a bug please report"))}}equals(e){return yZ.equals(this,e)}static equals(e,t){const n=t;return n&&e.code===n.code&&e.version===n.version&&((e,t)=>{if(e===t)return!0;{const n=t;return e.code===n.code&&e.size===n.size&&n.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0})(e.bytes,n.bytes)}})(e.multihash,n.multihash)}toString(e){return fZ(this,e)}toJSON(){return{"/":fZ(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID(".concat(this.toString(),")")}static asCID(e){if(null==e)return null;const t=e;if(t instanceof yZ)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:n,multihash:r,bytes:i}=t;return new yZ(e,n,r,i||AZ(e,n,r.bytes))}if(!0===t[SZ]){const{version:e,multihash:n,code:r}=t,i=OK(n);return yZ.create(e,r,i)}return null}static create(e,t,n){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==wZ)throw new Error("Version 0 CID must use dag-pb (code: ".concat(wZ,") block encoding"));return new yZ(e,t,n,n.bytes);case 1:{const r=AZ(e,t,n.bytes);return new yZ(e,t,n,r)}default:throw new Error("Invalid version")}}static createV0(e){return yZ.create(0,wZ,e)}static createV1(e,t){return yZ.create(1,e,t)}static decode(e){const[t,n]=yZ.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=yZ.inspectBytes(e),n=t.size-t.multihashSize,r=tK(e.subarray(n,n+t.multihashSize));if(r.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=r.subarray(t.multihashSize-t.digestSize),o=new NK(t.multihashCode,t.digestSize,i,r);return[0===t.version?yZ.createV0(o):yZ.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[n,r]=RK(e.subarray(t));return t+=r,n};let r=n(),i=wZ;if(18===r?(r=0,t=0):i=n(),0!==r&&1!==r)throw new RangeError("Invalid CID version ".concat(r));const o=t,s=n(),a=n(),c=t+a;return{version:r,codec:i,multihashCode:s,digestSize:a,multihashSize:c-o,size:c}}static parse(e,t){const[n,r]=mZ(e,t),i=yZ.decode(r);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return gZ(i).set(n,e),i}}const mZ=(e,t)=>{switch(e[0]){case"Q":{const n=t||uK;return[uK.prefix,n.decode("".concat(uK.prefix).concat(e))]}case uK.prefix:{const n=t||uK;return[uK.prefix,n.decode(e)]}case Vj.prefix:{const n=t||Vj;return[Vj.prefix,n.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},vZ=(e,t,n)=>{const{prefix:r}=n;if(r!==uK.prefix)throw Error("Cannot string encode V0 in ".concat(n.name," encoding"));const i=t.get(r);if(null==i){const i=n.encode(e).slice(1);return t.set(r,i),i}return i},bZ=(e,t,n)=>{const{prefix:r}=n,i=t.get(r);if(null==i){const i=n.encode(e);return t.set(r,i),i}return i},wZ=112,EZ=18,AZ=(e,t,n)=>{const r=PK(e),i=r+PK(t),o=new Uint8Array(i+n.byteLength);return xK(e,o,0),xK(t,o,r),o.set(n,i),o},SZ=Symbol.for("@ipld/js-cid/CID"),_Z={...Mt,...Dt,...Lt,...xt,...Pt,...Nt,...Bt,...St,...Ct,...Ot},IZ=Symbol.for("nodejs.util.inspect.custom"),CZ=Object.values(_Z).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)),_Z.identity.decoder),TZ=114,kZ=36,RZ=37;class xZ{constructor(e){(0,Yo.Z)(this,"type",void 0),(0,Yo.Z)(this,"multihash",void 0),(0,Yo.Z)(this,"privateKey",void 0),(0,Yo.Z)(this,"publicKey",void 0),(0,Yo.Z)(this,"string",void 0),(0,Yo.Z)(this,Bj,!0),this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return"PeerId(".concat(this.toString(),")")}toString(){return null==this.string&&(this.string=uK.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return yZ.createV1(TZ,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){var t;if(e instanceof Uint8Array)return(0,Ms.f)(this.multihash.bytes,e);if("string"===typeof e)return function(e,t){var n;if(t=null!==(n=t)&&void 0!==n?n:CZ,"1"===e.charAt(0)||"Q"===e.charAt(0)){const t=OK(uK.decode("z".concat(e)));return e.startsWith("12D")?new DZ({multihash:t}):e.startsWith("16U")?new OZ({multihash:t}):new PZ({multihash:t})}return function(e){try{const t=OK(e);if(t.code===LK.code){if(t.digest.length===kZ)return new DZ({multihash:t});if(t.digest.length===RZ)return new OZ({multihash:t})}if(t.code===KK.code)return new PZ({multihash:t})}catch{return function(e){if(null==e||null==e.multihash||null==e.version||1===e.version&&e.code!==TZ)throw new Error("Supplied PeerID CID is invalid");const t=e.multihash;if(t.code===KK.code)return new PZ({multihash:e.multihash});if(t.code===LK.code){if(t.digest.length===kZ)return new DZ({multihash:e.multihash});if(t.digest.length===RZ)return new OZ({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}(yZ.decode(e))}throw new Error("Supplied PeerID CID is invalid")}(CZ.decode(e))}(e).equals(this);if(null!=(null===e||void 0===e||null===(t=e.multihash)||void 0===t?void 0:t.bytes))return(0,Ms.f)(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[IZ](){return"PeerId(".concat(this.toString(),")")}}class PZ extends xZ{constructor(e){super({...e,type:"RSA"}),(0,Yo.Z)(this,"type","RSA"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.publicKey}}class DZ extends xZ{constructor(e){super({...e,type:"Ed25519"}),(0,Yo.Z)(this,"type","Ed25519"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.multihash.digest}}class OZ extends xZ{constructor(e){super({...e,type:"secp256k1"}),(0,Yo.Z)(this,"type","secp256k1"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.multihash.digest}}async function NZ(e,t){return e.length===kZ?new DZ({multihash:DK(LK.code,e),privateKey:t}):e.length===RZ?new OZ({multihash:DK(LK.code,e),privateKey:t}):new PZ({multihash:await KK.digest(e),publicKey:e,privateKey:t})}var BZ,LZ;async function MZ(e,t,n){const r=await async function(e,t){if(null==e.privateKey)throw new Error("PrivateKey was missing from PeerId");return(await Nj(e.privateKey)).sign(t)}(e,KZ(t));if(null==e.publicKey)throw new Error("PublicKey was missing from local PeerId");return function(e,t,n){return LZ.encode({identityKey:e,identitySig:t,extensions:null!==n&&void 0!==n?n:{webtransportCerthashes:[]}}).subarray()}(e.publicKey,r,n)}async function UZ(e){return NZ(e.identityKey)}function FZ(e){return LZ.decode(e)}function KZ(e){const t=(0,yu.m)("noise-libp2p-static-key:");return(0,Ls.z)([t,e],t.length+e.length)}async function jZ(e,t,n){const r=await NZ(t.identityKey);if(!r.equals(n))throw new Error("Payload identity key ".concat(r.toString()," does not match expected remote peer ").concat(n.toString()));const i=KZ(e);if(null==r.publicKey)throw new Error("PublicKey was missing from PeerId");if(null==t.identitySig)throw new Error("Signature was missing from message");const o=function(e){var t,n;const r=tj.decode(e),i=null!==(t=r.Data)&&void 0!==t?t:new Uint8Array;switch(r.Type){case $K.RSA:return Dj.rsa.unmarshalRsaPublicKey(i);case $K.Ed25519:return Dj.ed25519.unmarshalEd25519PublicKey(i);case $K.Secp256k1:return Dj.secp256k1.unmarshalSecp256k1PublicKey(i);default:throw Oj(null!==(n=r.Type)&&void 0!==n?n:"unknown")}}(r.publicKey);if(!await o.verify(i,t.identitySig))throw new Error("Static key doesn't match to peer that signed payload!");return r}function ZZ(e){return e instanceof Uint8Array&&32===e.length}function zZ(e){let t=function(e){const t=()=>{};return t.enabled=!1,t.color="",t.diff=0,t.log=()=>{},t.namespace=e,t.destroy=()=>!0,t.extend=()=>t,t}("".concat(e,":trace"));return sf().enabled("".concat(e,":trace"))&&null!=sf().names.map((e=>e.toString())).find((e=>e.includes(":trace")))&&(t=sf()("".concat(e,":trace"))),Object.assign(sf()(e),{error:sf()("".concat(e,":error")),trace:t})}!function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==n.lengthDelimited&&t.fork(),null!=e.webtransportCerthashes)for(const r of e.webtransportCerthashes)t.uint32(10),t.bytes(r);!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={webtransportCerthashes:[]},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();if(t>>>3===1)n.webtransportCerthashes.push(e.bytes());else e.skipType(7&t)}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(BZ||(BZ={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.identityKey&&e.identityKey.byteLength>0&&(t.uint32(10),t.bytes(e.identityKey)),null!=e.identitySig&&e.identitySig.byteLength>0&&(t.uint32(18),t.bytes(e.identitySig)),null!=e.extensions&&(t.uint32(34),BZ.codec().encode(e.extensions,t)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={identityKey:(0,Us.u)(0),identitySig:(0,Us.u)(0)},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.identityKey=e.bytes();break;case 2:n.identitySig=e.bytes();break;case 4:n.extensions=BZ.codec().decode(e,e.uint32());break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(LZ||(LZ={})),sf().formatters.b=e=>null==e?"undefined":uK.baseEncode(e),sf().formatters.t=e=>null==e?"undefined":Vj.baseEncode(e),sf().formatters.m=e=>null==e?"undefined":qK.baseEncode(e),sf().formatters.p=e=>null==e?"undefined":e.toString(),sf().formatters.c=e=>null==e?"undefined":e.toString(),sf().formatters.k=e=>null==e?"undefined":e.toString(),sf().formatters.a=e=>null==e?"undefined":e.toString();const VZ=zZ("libp2p:noise");let HZ;function qZ(e){e?(HZ("LOCAL_PUBLIC_EPHEMERAL_KEY ".concat((0,Au.B)(e.publicKey,"hex"))),HZ("LOCAL_PRIVATE_EPHEMERAL_KEY ".concat((0,Au.B)(e.privateKey,"hex")))):HZ("Missing local ephemeral keys.")}function GZ(e){HZ("REMOTE_EPHEMERAL_PUBLIC_KEY ".concat((0,Au.B)(e,"hex")))}HZ=KF?VZ:Object.assign((()=>{}),{enabled:!1,trace:()=>{},error:()=>{}});class WZ{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;(0,Yo.Z)(this,"n",void 0),(0,Yo.Z)(this,"bytes",void 0),(0,Yo.Z)(this,"view",void 0),this.n=e,this.bytes=(0,Us.u)(12),this.view=new DataView(this.bytes.buffer,this.bytes.byteOffset,this.bytes.byteLength),this.view.setUint32(4,e,!0)}increment(){this.n++,this.view.setUint32(4,this.n,!0)}getBytes(){return this.bytes}getUint64(){return this.n}assertValue(){if(this.n>4294967295)throw new Error("Cipherstate has reached maximum n, a new handshake must be performed")}}class QZ{constructor(e){(0,Yo.Z)(this,"crypto",void 0),this.crypto=e}encryptWithAd(e,t,n){const r=this.encrypt(e.k,e.n,t,n);return e.n.increment(),r}decryptWithAd(e,t,n,r){const{plaintext:i,valid:o}=this.decrypt(e.k,e.n,t,n,r);return o&&e.n.increment(),{plaintext:i,valid:o}}hasKey(e){return!this.isEmptyKey(e.k)}createEmptyKey(){return(0,Us.u)(32)}isEmptyKey(e){const t=this.createEmptyKey();return(0,Ms.f)(t,e)}encrypt(e,t,n,r){return t.assertValue(),this.crypto.chaCha20Poly1305Encrypt(r,t.getBytes(),n,e)}encryptAndHash(e,t){let n;return n=this.hasKey(e.cs)?this.encryptWithAd(e.cs,e.h,t):t,this.mixHash(e,n),n}decrypt(e,t,n,r,i){t.assertValue();const o=this.crypto.chaCha20Poly1305Decrypt(r,t.getBytes(),n,e,i);return o?{plaintext:o,valid:!0}:{plaintext:(0,Us.u)(0),valid:!1}}decryptAndHash(e,t){let n,r=!0;return this.hasKey(e.cs)?({plaintext:n,valid:r}=this.decryptWithAd(e.cs,e.h,t)):n=t,this.mixHash(e,t),{plaintext:n,valid:r}}dh(e,t){try{const n=this.crypto.generateX25519SharedKey(e,t);return 32===n.length?n:n.subarray(0,32)}catch(n){const e=n;return VZ.error(e),(0,Us.u)(32)}}mixHash(e,t){e.h=this.getHash(e.h,t)}getHash(e,t){return this.crypto.hashSHA256((0,Ls.z)([e,t],e.length+t.length))}mixKey(e,t){const[n,r]=this.crypto.getHKDF(e.ck,t);e.cs=this.initializeKey(r),e.ck=n}initializeKey(e){return{k:e,n:new WZ}}initializeSymmetric(e){const t=(0,Xh.mL)(e,"utf-8"),n=this.hashProtocolName(t),r=n,i=this.createEmptyKey();return{cs:this.initializeKey(i),ck:r,h:n}}hashProtocolName(e){if(e.length<=32){const t=(0,Us.u)(32);return t.set(e),t}return this.getHash(e,(0,Us.u)(0))}split(e){const[t,n]=this.crypto.getHKDF(e.ck,(0,Us.u)(0));return{cs1:this.initializeKey(t),cs2:this.initializeKey(n)}}writeMessageRegular(e,t){const n=this.encryptWithAd(e,(0,Us.u)(0),t);return{ne:this.createEmptyKey(),ns:(0,Us.u)(0),ciphertext:n}}readMessageRegular(e,t){return this.decryptWithAd(e,(0,Us.u)(0),t.ciphertext)}}class YZ extends QZ{initializeInitiator(e,t,n,r){const i=this.initializeSymmetric("Noise_XX_25519_ChaChaPoly_SHA256");this.mixHash(i,e);return{ss:i,s:t,rs:n,psk:r,re:(0,Us.u)(32)}}initializeResponder(e,t,n,r){const i=this.initializeSymmetric("Noise_XX_25519_ChaChaPoly_SHA256");this.mixHash(i,e);return{ss:i,s:t,rs:n,psk:r,re:(0,Us.u)(32)}}writeMessageA(e,t,n){const r=(0,Us.u)(0);e.e=void 0!==n?n:this.crypto.generateX25519KeyPair();const i=e.e.publicKey;this.mixHash(e.ss,i);return{ne:i,ns:r,ciphertext:this.encryptAndHash(e.ss,t)}}writeMessageB(e,t){e.e=this.crypto.generateX25519KeyPair();const n=e.e.publicKey;this.mixHash(e.ss,n),this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));const r=e.s.publicKey,i=this.encryptAndHash(e.ss,r);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));return{ne:n,ns:i,ciphertext:this.encryptAndHash(e.ss,t)}}writeMessageC(e,t){const n=e.s.publicKey,r=this.encryptAndHash(e.ss,n);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));const i=this.encryptAndHash(e.ss,t),o={ne:this.createEmptyKey(),ns:r,ciphertext:i},{cs1:s,cs2:a}=this.split(e.ss);return{h:e.ss.h,messageBuffer:o,cs1:s,cs2:a}}readMessageA(e,t){return ZZ(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),this.decryptAndHash(e.ss,t.ciphertext)}readMessageB(e,t){if(ZZ(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));const{plaintext:n,valid:r}=this.decryptAndHash(e.ss,t.ns);r&&ZZ(n)&&(e.rs=n),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));const{plaintext:i,valid:o}=this.decryptAndHash(e.ss,t.ciphertext);return{plaintext:i,valid:r&&o}}readMessageC(e,t){const{plaintext:n,valid:r}=this.decryptAndHash(e.ss,t.ns);if(r&&ZZ(n)&&(e.rs=n),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));const{plaintext:i,valid:o}=this.decryptAndHash(e.ss,t.ciphertext),{cs1:s,cs2:a}=this.split(e.ss);return{h:e.ss.h,plaintext:i,valid:r&&o,cs1:s,cs2:a}}initSession(e,t,n){const r=this.createEmptyKey(),i=(0,Us.u)(32);let o;return o=e?this.initializeInitiator(t,n,i,r):this.initializeResponder(t,n,i,r),{hs:o,i:e,mc:0}}sendMessage(e,t,n){let r;if(0===e.mc)r=this.writeMessageA(e.hs,t,n);else if(1===e.mc)r=this.writeMessageB(e.hs,t);else if(2===e.mc){const{h:n,messageBuffer:i,cs1:o,cs2:s}=this.writeMessageC(e.hs,t);r=i,e.h=n,e.cs1=o,e.cs2=s}else{if(!(e.mc>2))throw new Error("Session invalid.");if(e.i){if(!e.cs1)throw new Error("CS1 (cipher state) is not defined");r=this.writeMessageRegular(e.cs1,t)}else{if(!e.cs2)throw new Error("CS2 (cipher state) is not defined");r=this.writeMessageRegular(e.cs2,t)}}return e.mc++,r}recvMessage(e,t){let n=(0,Us.u)(0),r=!1;if(0===e.mc)({plaintext:n,valid:r}=this.readMessageA(e.hs,t));else if(1===e.mc)({plaintext:n,valid:r}=this.readMessageB(e.hs,t));else if(2===e.mc){const{h:i,plaintext:o,valid:s,cs1:a,cs2:c}=this.readMessageC(e.hs,t);n=o,r=s,e.h=i,e.cs1=a,e.cs2=c}return e.mc++,{plaintext:n,valid:r}}}class JZ{constructor(e,t,n,r,i,o,s,a){(0,Yo.Z)(this,"isInitiator",void 0),(0,Yo.Z)(this,"session",void 0),(0,Yo.Z)(this,"remotePeer",void 0),(0,Yo.Z)(this,"remoteExtensions",{webtransportCerthashes:[]}),(0,Yo.Z)(this,"payload",void 0),(0,Yo.Z)(this,"connection",void 0),(0,Yo.Z)(this,"xx",void 0),(0,Yo.Z)(this,"staticKeypair",void 0),(0,Yo.Z)(this,"prologue",void 0),this.isInitiator=e,this.payload=t,this.prologue=n,this.staticKeypair=i,this.connection=o,s&&(this.remotePeer=s),this.xx=null!==a&&void 0!==a?a:new YZ(r),this.session=this.xx.initSession(this.isInitiator,this.prologue,this.staticKeypair)}async propose(){var e;if(e=this.session.hs.s,HZ("LOCAL_STATIC_PUBLIC_KEY ".concat((0,Au.B)(e.publicKey,"hex"))),HZ("LOCAL_STATIC_PRIVATE_KEY ".concat((0,Au.B)(e.privateKey,"hex"))),this.isInitiator){VZ.trace("Stage 0 - Initiator starting to send first message.");const e=this.xx.sendMessage(this.session,(0,Us.u)(0));await this.connection.write(function(e){return(0,Ls.z)([e.ne,e.ciphertext],e.ne.length+e.ciphertext.length)}(e)),VZ.trace("Stage 0 - Initiator finished sending first message."),qZ(this.session.hs.e)}else{VZ.trace("Stage 0 - Responder waiting to receive first message...");const e=function(e){if(e.length<32)throw new Error("Cannot decode stage 0 MessageBuffer: length less than 32 bytes.");return{ne:e.subarray(0,32),ciphertext:e.subarray(32,e.length),ns:(0,Us.u)(0)}}((await this.connection.read()).subarray()),{valid:t}=this.xx.recvMessage(this.session,e);if(!t)throw new qF("xx handshake stage 0 validation fail");VZ.trace("Stage 0 - Responder received first message."),GZ(this.session.hs.re)}}async exchange(){if(this.isInitiator){VZ.trace("Stage 1 - Initiator waiting to receive first message from responder...");const n=function(e){if(e.length<80)throw new Error("Cannot decode stage 1 MessageBuffer: length less than 80 bytes.");return{ne:e.subarray(0,32),ns:e.subarray(32,80),ciphertext:e.subarray(80,e.length)}}((await this.connection.read()).subarray()),{plaintext:r,valid:i}=this.xx.recvMessage(this.session,n);if(!i)throw new qF("xx handshake stage 1 validation fail");VZ.trace("Stage 1 - Initiator received the message."),GZ(this.session.hs.re),e=this.session.hs.rs,HZ("REMOTE_STATIC_PUBLIC_KEY ".concat((0,Au.B)(e,"hex"))),VZ.trace("Initiator going to check remote's signature...");try{const e=FZ(r);this.remotePeer=this.remotePeer||await UZ(e),await jZ(this.session.hs.rs,e,this.remotePeer),this.setRemoteNoiseExtension(e.extensions)}catch(t){throw new HF("Error occurred while verifying signed payload: ".concat(t.message))}VZ.trace("All good with the signature!")}else{VZ.trace("Stage 1 - Responder sending out first message with signed payload and static key.");const e=this.xx.sendMessage(this.session,this.payload);await this.connection.write(function(e){return(0,Ls.z)([e.ne,e.ns,e.ciphertext],e.ne.length+e.ns.length+e.ciphertext.length)}(e)),VZ.trace("Stage 1 - Responder sent the second handshake message with signed payload."),qZ(this.session.hs.e)}var e}async finish(){if(this.isInitiator){VZ.trace("Stage 2 - Initiator sending third handshake message.");const e=this.xx.sendMessage(this.session,this.payload);await this.connection.write(function(e){return(0,Ls.z)([e.ns,e.ciphertext],e.ns.length+e.ciphertext.length)}(e)),VZ.trace("Stage 2 - Initiator sent message with signed payload.")}else{VZ.trace("Stage 2 - Responder waiting for third handshake message...");const e=function(e){if(e.length<48)throw new Error("Cannot decode stage 2 MessageBuffer: length less than 48 bytes.");return{ne:(0,Us.u)(0),ns:e.subarray(0,48),ciphertext:e.subarray(48,e.length)}}((await this.connection.read()).subarray()),{plaintext:n,valid:r}=this.xx.recvMessage(this.session,e);if(!r)throw new qF("xx handshake stage 2 validation fail");VZ.trace("Stage 2 - Responder received the message, finished handshake.");try{const e=FZ(n);this.remotePeer=this.remotePeer||await UZ(e),await jZ(this.session.hs.rs,e,this.remotePeer),this.setRemoteNoiseExtension(e.extensions)}catch(t){throw new HF("Error occurred while verifying signed payload: ".concat(t.message))}}var e;(e=this.session).cs1&&e.cs2?(HZ("CIPHER_STATE_1 ".concat(e.cs1.n.getUint64()," ").concat((0,Au.B)(e.cs1.k,"hex"))),HZ("CIPHER_STATE_2 ".concat(e.cs2.n.getUint64()," ").concat((0,Au.B)(e.cs2.k,"hex")))):HZ("Missing cipher state.")}encrypt(e,t){const n=this.getCS(t);return this.xx.encryptWithAd(n,(0,Us.u)(0),e)}decrypt(e,t,n){const r=this.getCS(t,!1);return this.xx.decryptWithAd(r,(0,Us.u)(0),e,n)}getRemoteStaticKey(){return this.session.hs.rs}getCS(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!e.cs1||!e.cs2)throw new qF("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?t?e.cs1:e.cs2:t?e.cs2:e.cs1}setRemoteNoiseExtension(e){e&&(this.remoteExtensions=e)}}class XZ{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,Yo.Z)(this,"protocol","/noise"),(0,Yo.Z)(this,"crypto",void 0),(0,Yo.Z)(this,"prologue",void 0),(0,Yo.Z)(this,"staticKeys",void 0),(0,Yo.Z)(this,"extensions",void 0),(0,Yo.Z)(this,"metrics",void 0);const{staticNoiseKey:t,extensions:n,crypto:r,prologueBytes:i,metrics:o}=e;this.crypto=null!==r&&void 0!==r?r:jF,this.extensions=n,this.metrics=o?function(e){return{xxHandshakeSuccesses:e.registerCounter("libp2p_noise_xxhandshake_successes_total",{help:"Total count of noise xxHandshakes successes_"}),xxHandshakeErrors:e.registerCounter("libp2p_noise_xxhandshake_error_total",{help:"Total count of noise xxHandshakes errors"}),encryptedPackets:e.registerCounter("libp2p_noise_encrypted_packets_total",{help:"Total count of noise encrypted packets successfully"}),decryptedPackets:e.registerCounter("libp2p_noise_decrypted_packets_total",{help:"Total count of noise decrypted packets"}),decryptErrors:e.registerCounter("libp2p_noise_decrypt_errors_total",{help:"Total count of noise decrypt errors"})}}(o):void 0,this.staticKeys=t?this.crypto.generateX25519KeyPairFromSeed(t):this.crypto.generateX25519KeyPair(),this.prologue=null!==i&&void 0!==i?i:(0,Us.u)(0)}async secureOutbound(e,t,n){const r=la(t,{lengthEncoder:ZF,lengthDecoder:zF,maxDataLength:FF}),i=await this.performHandshake({connection:r,isInitiator:!0,localPeer:e,remotePeer:n});return{conn:await this.createSecureConnection(r,i),remoteExtensions:i.remoteExtensions,remotePeer:i.remotePeer}}async secureInbound(e,t,n){const r=la(t,{lengthEncoder:ZF,lengthDecoder:zF,maxDataLength:FF}),i=await this.performHandshake({connection:r,isInitiator:!1,localPeer:e,remotePeer:n});return{conn:await this.createSecureConnection(r,i),remotePeer:i.remotePeer,remoteExtensions:i.remoteExtensions}}async performHandshake(e){const t=await MZ(e.localPeer,this.staticKeys.publicKey,this.extensions);return this.performXXHandshake(e,t)}async performXXHandshake(e,t){const{isInitiator:n,remotePeer:r,connection:i}=e,o=new JZ(n,t,this.prologue,this.crypto,this.staticKeys,i,r);try{var s;await o.propose(),await o.exchange(),await o.finish(),null===(s=this.metrics)||void 0===s||s.xxHandshakeSuccesses.increment()}catch(c){var a;if(null===(a=this.metrics)||void 0===a||a.xxHandshakeErrors.increment(),c instanceof Error)throw c.message="Error occurred during XX handshake: ".concat(c.message),c}return o}async createSecureConnection(e,t){const[n,r]=function(){const e=IF(),t=IF();return[{source:e.source,sink:t.sink},{source:t.source,sink:e.sink}]}(),i=e.unwrap();return await function(e){if(null==e)throw new Error("Empty pipeline");if(BF(e)){const t=e;e=()=>t.source}else if(NF(e)||OF(e)){const t=e;e=()=>t}for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=[e,...n];if(i.length>1&&BF(i[i.length-1])&&(i[i.length-1]=i[i.length-1].sink),i.length>2)for(let o=1;o<i.length-1;o++)BF(i[o])&&(i[o]=LF(i[o]));return DF(...i)}(n,function(e,t){return async function*(n){for await(const r of n)for(let n=0;n<r.length;n+=65519){let i=n+65519;i>r.length&&(i=r.length);const o=e.encrypt(r.subarray(n,i),e.session);null===t||void 0===t||t.encryptedPackets.increment(),yield(0,Xh.zo)([ZF(o.byteLength),o],2+o.byteLength)}}}(t,this.metrics),i,(e=>_F(e,{lengthDecoder:zF})),function(e,t){return async function*(n){for await(const r of n)for(let n=0;n<r.length;n+=FF){let i=n+FF;if(i>r.length&&(i=r.length),i-16<n)throw new Error("Invalid chunk");const o=r.subarray(n,i),s=r.subarray(n,i-16),{plaintext:a,valid:c}=e.decrypt(o,e.session,s);if(!c)throw null===t||void 0===t||t.decryptErrors.increment(),new Error("Failed to validate decrypted chunk");null===t||void 0===t||t.decryptedPackets.increment(),yield a}}}(t,this.metrics),n),r}}async function $Z(e,t,n,r,i,o){const s=o.forComponent("libp2p:webtransport:stream:".concat(n,":").concat(t)),a=e.writable.getWriter(),c=e.readable.getReader();function l(){const e=r.findIndex((e=>e===f));-1!==e&&(r.splice(e,1),f.timeline.close=Date.now(),null===i||void 0===i||i(f))}await a.ready;let u=!1,h=!1;(async function(){const e=await a.closed.catch((e=>e));if(null!=e){const n=e.message;n.includes("aborted by the remote server")||n.includes("STOP_SENDING")||s.error("WebTransport writer closed unexpectedly: streamId=".concat(t," err=").concat(e.message))}u=!0,u&&h&&l()})().catch((()=>{s.error("WebTransport failed to cleanup closed stream")})),async function(){const e=await c.closed.catch((e=>e));null!=e&&s.error("WebTransport reader closed unexpectedly: streamId=".concat(t," err=").concat(e.message)),h=!0,u&&h&&l()}().catch((()=>{s.error("WebTransport failed to cleanup closed stream")}));let d=!1;const f={id:t,status:"open",writeStatus:"ready",readStatus:"ready",abort(e){u||(a.abort(e).catch((e=>{s.error("could not abort stream",e)})),u=!0),h=!0,this.status="aborted",this.writeStatus="closed",this.readStatus="closed",this.timeline.reset=this.timeline.close=this.timeline.closeRead=this.timeline.closeWrite=Date.now(),l()},async close(e){this.status="closing",await Promise.all([f.closeRead(e),f.closeWrite(e)]),l(),this.status="closed",this.timeline.close=Date.now()},async closeRead(e){if(!h){this.readStatus="closing";try{await c.cancel()}catch(t){!0===t.toString().includes("RESET_STREAM")&&(u=!0)}this.timeline.closeRead=Date.now(),this.readStatus="closed",h=!0}u&&l()},async closeWrite(e){if(!u){u=!0,this.writeStatus="closing";try{await a.close()}catch(t){!0===t.toString().includes("RESET_STREAM")&&(h=!0)}this.timeline.closeWrite=Date.now(),this.writeStatus="closed"}h&&l()},direction:n,timeline:{open:Date.now()},metadata:{},source:async function*(){for(;;){const e=await c.read();if(e.done)return h=!0,void(u&&l());yield new Zs(e.value)}}(),sink:async function(e){if(d)throw new Error("sink already called on stream");d=!0;try{this.writeStatus="writing";for await(const t of e)if(t instanceof Uint8Array)await a.write(t);else for(const e of t)await a.write(e);this.writeStatus="done"}finally{this.timeline.closeWrite=Date.now(),this.writeStatus="closed",await f.closeWrite()}},log:s};return f}function ez(){return{source:{[Symbol.asyncIterator]:()=>({next:async()=>new Promise((()=>{}))})},sink:async e=>new Promise((()=>{}))}}const tz=Symbol.for("nodejs.util.inspect.custom"),nz=Object.values(_Z).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)),_Z.identity.decoder),rz=114,iz=36,oz=37;class sz{constructor(e){(0,Yo.Z)(this,"type",void 0),(0,Yo.Z)(this,"multihash",void 0),(0,Yo.Z)(this,"privateKey",void 0),(0,Yo.Z)(this,"publicKey",void 0),(0,Yo.Z)(this,"string",void 0),(0,Yo.Z)(this,fu.Cs,!0),this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return"PeerId(".concat(this.toString(),")")}toString(){return null==this.string&&(this.string=uK.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return yZ.createV1(rz,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){var t;if(e instanceof Uint8Array)return(0,Ms.f)(this.multihash.bytes,e);if("string"===typeof e)return uz(e).equals(this);if(null!=(null===e||void 0===e||null===(t=e.multihash)||void 0===t?void 0:t.bytes))return(0,Ms.f)(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[tz](){return"PeerId(".concat(this.toString(),")")}}class az extends sz{constructor(e){super({...e,type:"RSA"}),(0,Yo.Z)(this,"type","RSA"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.publicKey}}class cz extends sz{constructor(e){super({...e,type:"Ed25519"}),(0,Yo.Z)(this,"type","Ed25519"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.multihash.digest}}class lz extends sz{constructor(e){super({...e,type:"secp256k1"}),(0,Yo.Z)(this,"type","secp256k1"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.multihash.digest}}function uz(e,t){var n;if(t=null!==(n=t)&&void 0!==n?n:nz,"1"===e.charAt(0)||"Q"===e.charAt(0)){const t=OK(uK.decode("z".concat(e)));return e.startsWith("12D")?new cz({multihash:t}):e.startsWith("16U")?new lz({multihash:t}):new az({multihash:t})}return function(e){try{const t=OK(e);if(t.code===LK.code){if(t.digest.length===iz)return new cz({multihash:t});if(t.digest.length===oz)return new lz({multihash:t})}if(t.code===KK.code)return new az({multihash:t})}catch{return function(e){if(null==e||null==e.multihash||null==e.version||1===e.version&&e.code!==rz)throw new Error("Supplied PeerID CID is invalid");const t=e.multihash;if(t.code===KK.code)return new az({multihash:e.multihash});if(t.code===LK.code){if(t.digest.length===iz)return new cz({multihash:e.multihash});if(t.digest.length===oz)return new lz({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}(yZ.decode(e))}throw new Error("Supplied PeerID CID is invalid")}(nz.decode(e))}const hz=Object.values(_Z).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)));function dz(e){var t;if(!tO.Mk.matches(e))throw new fu.sv("Invalid multiaddr, was not a WebTransport address","ERR_INVALID_MULTIADDR");const n=e.stringTuples(),r=n.filter((e=>{let[t,n]=e;return t===(0,ng.a_)("certhash").code})).map((e=>{let[t,n]=e;return r=null!==n&&void 0!==n?n:"",OK(hz.decode(r));var r})),i=n.filter((e=>{let[t,n]=e;return t===(0,ng.a_)("p2p").code})).map((e=>{let[t,n]=e;return uz(null!==n&&void 0!==n?n:"")}))[0],o=e.toOptions();let s=o.host;return 6===o.family&&null!==(t=s)&&void 0!==t&&t.includes(":")&&(s="[".concat(s,"]")),{url:"https://".concat(s,":").concat(o.port),certhashes:r,remotePeer:i}}class fz{constructor(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,Yo.Z)(this,"log",void 0),(0,Yo.Z)(this,"components",void 0),(0,Yo.Z)(this,"config",void 0),(0,Yo.Z)(this,"metrics",void 0),(0,Yo.Z)(this,Symbol.toStringTag,"@libp2p/webtransport"),(0,Yo.Z)(this,fu.SF,!0),this.log=e.logger.forComponent("libp2p:webtransport"),this.components=e,this.config={maxInboundStreams:null!==(t=n.maxInboundStreams)&&void 0!==t?t:1e3},null!=e.metrics&&(this.metrics={dialerEvents:e.metrics.registerCounterGroup("libp2p_webtransport_dialer_events_total",{label:"event",help:"Total count of WebTransport dialer events by type"})})}async dial(e,t){var n,r,i;null===(n=t)||void 0===n||null===(r=n.signal)||void 0===r||r.throwIfAborted(),this.log("dialing %s",e);const o=this.components.peerId;if(void 0===o)throw new Error("Need a local peerid");t=null!==(i=t)&&void 0!==i?i:{};const{url:s,certhashes:a,remotePeer:c}=dz(e);if(null==c)throw new Error("Need a target peerid");if(0===a.length)throw new Error("Expected multiaddr to contain certhashes");let l,u,h=()=>{},d=!1,f=!1,p=!1;try{var g,y,m,v;null===(g=this.metrics)||void 0===g||g.dialerEvents.increment({pending:!0});const n=new WebTransport("".concat(s,"/.well-known/libp2p-webtransport?type=noise"),{serverCertificateHashes:a.map((e=>({algorithm:"sha-256",value:e.digest})))});if(h=e=>{if(!d)try{var t;null===(t=this.metrics)||void 0===t||t.dialerEvents.increment({[e]:!0}),n.close()}catch(r){this.log.error("error closing wt session",r)}finally{null!=u&&(u.timeline.close=Date.now()),d=!0}},l=()=>{h(f?"noise_timeout":"ready_timeout")},null===(y=t.signal)||void 0===y||y.addEventListener("abort",l,{once:!0}),await Promise.race([n.closed,n.ready]),f=!0,null===(m=this.metrics)||void 0===m||m.dialerEvents.increment({ready:!0}),n.closed.catch((e=>{this.log.error("error on remote wt session close",e)})).finally((()=>{h("remote_close")})),!await this.authenticateWebTransport(n,o,c,a))throw new Error("Failed to authenticate webtransport");return null===(v=this.metrics)||void 0===v||v.dialerEvents.increment({open:!0}),u={close:async()=>{this.log("Closing webtransport"),h("close")},abort:e=>{this.log("aborting webtransport due to passed err",e),h("abort")},remoteAddr:e,timeline:{open:Date.now()},log:this.components.logger.forComponent("libp2p:webtransport:maconn"),...ez()},p=!0,await t.upgrader.upgradeOutbound(u,{skipEncryption:!0,muxerFactory:this.webtransportMuxer(n),skipProtection:!0})}catch(w){throw this.log.error("caught wt session err",w),h(p?"upgrade_error":f?"noise_error":"ready_error"),w}finally{var b;if(null!=l)null===(b=t.signal)||void 0===b||b.removeEventListener("abort",l)}}async authenticateWebTransport(e,t,n,r){var i;const o=await e.createBidirectionalStream(),s=o.writable.getWriter(),a=o.readable.getReader();await s.ready;const c={source:async function*(){for(;;){const e=await a.read();if(null!=e.value&&(yield e.value),e.done)break}}(),sink:async function(e){for await(const t of e)t instanceof Uint8Array?await s.write(t):await s.write(t.subarray())}},l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return()=>new XZ(e)}()(),{remoteExtensions:u}=await l.secureOutbound(t,c,n);if(s.close().catch((e=>{this.log.error("Failed to close authentication stream writer: ".concat(e.message))})),a.cancel().catch((e=>{this.log.error("Failed to close authentication stream reader: ".concat(e.message))})),h=null!==(i=null===u||void 0===u?void 0:u.webtransportCerthashes)&&void 0!==i?i:[],(d=r.map((e=>e.bytes))).filter((e=>Boolean(h.find((t=>(0,Ms.f)(e,t)))))).length!==d.length)throw new Error("Our certhashes are not a subset of the remote's reported certhashes");var h,d;return!0}webtransportMuxer(e){let t=0;const n=this.config,r=this;return{protocol:"webtransport",createStreamMuxer:i=>{"function"===typeof i&&(i={onIncomingStream:i});const o=[];(async function(){const s=e.incomingBidirectionalStreams.getReader();for(;;){const{done:e,value:h}=await s.read();if(e)break;if(o.length>=n.maxInboundStreams)h.writable.close().catch((e=>{r.log.error("Failed to close inbound stream that crossed our maxInboundStream limit: ".concat(e.message))})),h.readable.cancel().catch((e=>{r.log.error("Failed to close inbound stream that crossed our maxInboundStream limit: ".concat(e.message))}));else{var a,c,l,u;const e=await $Z(h,String(t++),"inbound",o,null===(a=i)||void 0===a?void 0:a.onStreamEnd,r.components.logger);o.push(e),null===(c=i)||void 0===c||null===(l=(u=c).onIncomingStream)||void 0===l||l.call(u,e)}}})().catch((()=>{this.log.error("WebTransport failed to receive incoming stream")}));return{protocol:"webtransport",streams:o,newStream:async n=>{var s,a,c;const l=await e.createBidirectionalStream(),u=await $Z(l,String(t++),null!==(s=null===(a=i)||void 0===a?void 0:a.direction)&&void 0!==s?s:"outbound",o,null===(c=i)||void 0===c?void 0:c.onStreamEnd,r.components.logger);return o.push(u),u},close:async e=>{this.log("Closing webtransport muxer"),await Promise.all(o.map((async t=>t.close(e))))},abort:e=>{this.log("Aborting webtransport muxer with err:",e);for(const t of o)t.abort(e)},...ez()}}}}createListener(e){throw new Error("Webtransport servers are not supported in Node or the browser")}filter(e){return e.filter(tO.Mk.exactMatch)}}function pz(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>new fz(t,e)}function gz(e){var t;return e=null!==(t=e)&&void 0!==t?t:new Error("Open failed"),Xo()(e,"ERR_OPEN_FAILED")}function yz(e){var t;return e=null!==(t=e)&&void 0!==t?t:new Error("Close failed"),Xo()(e,"ERR_CLOSE_FAILED")}function mz(e){var t;return e=null!==(t=e)&&void 0!==t?t:new Error("Put failed"),Xo()(e,"ERR_PUT_FAILED")}function vz(e){var t;return e=null!==(t=e)&&void 0!==t?t:new Error("Get failed"),Xo()(e,"ERR_GET_FAILED")}function bz(e){var t;return e=null!==(t=e)&&void 0!==t?t:new Error("Delete failed"),Xo()(e,"ERR_DELETE_FAILED")}function wz(e){var t;return e=null!==(t=e)&&void 0!==t?t:new Error("Has failed"),Xo()(e,"ERR_HAS_FAILED")}function Ez(e){var t;return e=null!==(t=e)&&void 0!==t?t:new Error("Not Found"),Xo()(e,"ERR_NOT_FOUND")}function Az(e){var t;return e=null!==(t=e)&&void 0!==t?t:new Error("Aborted"),Xo()(e,"ERR_ABORTED")}var Sz=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==n[s])throw new TypeError(o+" is ambiguous");n[s]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var r=0,i=0;e[t]===c;)r++,t++;for(var o=(e.length-t)*l+1>>>0,s=new Uint8Array(o);e[t];){var u=n[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=o-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*s[d]>>>0,s[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=o-i;f!==o&&0===s[f];)f++;for(var p=new Uint8Array(r+(o-f)),g=r;f!==o;)p[g++]=s[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,o=t.length;i!==o&&0===t[i];)i++,n++;for(var s=(o-i)*u+1>>>0,l=new Uint8Array(s);i!==o;){for(var h=t[i],d=0,f=s-1;(0!==h||d<r)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");r=d,i++}for(var p=s-r;p!==s&&0===l[p];)p++;for(var g=c.repeat(n);p<s;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:h,decode:function(e){var n=h(e);if(n)return n;throw new Error("Non-".concat(t," character"))}}};const _z=Sz,Iz=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class Cz{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(e));throw Error("Unknown type, must be binary type")}}class Tz{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(e),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return Rz(this,e)}}class kz{constructor(e){this.decoders=e}or(e){return Rz(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(e),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}}const Rz=(e,t)=>new kz({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class xz{constructor(e,t,n,r){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=r,this.encoder=new Cz(e,t,n),this.decoder=new Tz(e,t,r)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Pz=e=>{let{name:t,prefix:n,encode:r,decode:i}=e;return new xz(t,n,r,i)},Dz=e=>{let{prefix:t,name:n,alphabet:r}=e;const{encode:i,decode:o}=_z(r,n);return Pz({prefix:t,name:n,encode:i,decode:e=>Iz(o(e))})},Oz=e=>{let{name:t,prefix:n,bitsPerChar:r,alphabet:i}=e;return Pz({prefix:n,name:t,encode:e=>((e,t,n)=>{const r="="===t[t.length-1],i=(1<<n)-1;let o="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>n;)s-=n,o+=t[i&a>>s];if(s&&(o+=t[i&a<<n-s]),r)for(;o.length*n&7;)o+="=";return o})(e,i,r),decode:e=>((e,t,n,r)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*n/8|0);let a=0,c=0,l=0;for(let u=0;u<o;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError("Non-".concat(r," character"));c=c<<n|t,a+=n,a>=8&&(a-=8,s[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s})(e,i,r,t)})},Nz=Oz({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Bz=(Oz({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Oz({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Oz({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Oz({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Oz({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Oz({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Oz({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Oz({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Dz({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}));Dz({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Lz=function e(t,n,r){n=n||[];var i=r=r||0;for(;t>=Fz;)n[r++]=255&t|Mz,t/=128;for(;t&Uz;)n[r++]=255&t|Mz,t>>>=7;return n[r]=0|t,e.bytes=r-i+1,n},Mz=128,Uz=-128,Fz=Math.pow(2,31);var Kz=function e(t,n){var r,i=0,o=0,s=n=n||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");r=t[s++],i+=o<28?(r&Zz)<<o:(r&Zz)*Math.pow(2,o),o+=7}while(r>=jz);return e.bytes=s-n,i},jz=128,Zz=127;var zz=Math.pow(2,7),Vz=Math.pow(2,14),Hz=Math.pow(2,21),qz=Math.pow(2,28),Gz=Math.pow(2,35),Wz=Math.pow(2,42),Qz=Math.pow(2,49),Yz=Math.pow(2,56),Jz=Math.pow(2,63);const Xz={encode:Lz,decode:Kz,encodingLength:function(e){return e<zz?1:e<Vz?2:e<Hz?3:e<qz?4:e<Gz?5:e<Wz?6:e<Qz?7:e<Yz?8:e<Jz?9:10}},$z=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return[Xz.decode(e,t),Xz.decode.bytes]},eV=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Xz.encode(e,t,n),t},tV=e=>Xz.encodingLength(e),nV=e=>{const t=Iz(e),[n,r]=$z(t),[i,o]=$z(t.subarray(r)),s=t.subarray(r+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new rV(n,i,s,t)};class rV{constructor(e,t,n,r){this.code=e,this.size=t,this.digest=n,this.bytes=r}}const iV=(e,t)=>{const{bytes:n,version:r}=e;return 0===r?lV(n,sV(e),t||Bz.encoder):uV(n,sV(e),t||Nz.encoder)},oV=new WeakMap,sV=e=>{const t=oV.get(e);if(null==t){const t=new Map;return oV.set(e,t),t}return t};class aV{constructor(e,t,n,r){this.code=t,this.version=e,this.multihash=n,this.bytes=r,this["/"]=r}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==hV)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==dV)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return aV.createV0(t)}default:throw Error("Can not convert CID version ".concat(this.version," to version 0. This is a bug please report"))}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=((e,t)=>{const n=t.byteLength,r=tV(e),i=r+tV(n),o=new Uint8Array(i+n);return eV(e,o,0),eV(n,o,r),o.set(t,i),new rV(e,n,t,o)})(e,t);return aV.createV1(this.code,n)}case 1:return this;default:throw Error("Can not convert CID version ".concat(this.version," to version 1. This is a bug please report"))}}equals(e){return aV.equals(this,e)}static equals(e,t){const n=t;return n&&e.code===n.code&&e.version===n.version&&((e,t)=>{if(e===t)return!0;{const n=t;return e.code===n.code&&e.size===n.size&&n.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0})(e.bytes,n.bytes)}})(e.multihash,n.multihash)}toString(e){return iV(this,e)}toJSON(){return{"/":iV(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID(".concat(this.toString(),")")}static asCID(e){if(null==e)return null;const t=e;if(t instanceof aV)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:n,multihash:r,bytes:i}=t;return new aV(e,n,r,i||fV(e,n,r.bytes))}if(!0===t[pV]){const{version:e,multihash:n,code:r}=t,i=nV(n);return aV.create(e,r,i)}return null}static create(e,t,n){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==hV)throw new Error("Version 0 CID must use dag-pb (code: ".concat(hV,") block encoding"));return new aV(e,t,n,n.bytes);case 1:{const r=fV(e,t,n.bytes);return new aV(e,t,n,r)}default:throw new Error("Invalid version")}}static createV0(e){return aV.create(0,hV,e)}static createV1(e,t){return aV.create(1,e,t)}static decode(e){const[t,n]=aV.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=aV.inspectBytes(e),n=t.size-t.multihashSize,r=Iz(e.subarray(n,n+t.multihashSize));if(r.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=r.subarray(t.multihashSize-t.digestSize),o=new rV(t.multihashCode,t.digestSize,i,r);return[0===t.version?aV.createV0(o):aV.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[n,r]=$z(e.subarray(t));return t+=r,n};let r=n(),i=hV;if(18===r?(r=0,t=0):i=n(),0!==r&&1!==r)throw new RangeError("Invalid CID version ".concat(r));const o=t,s=n(),a=n(),c=t+a;return{version:r,codec:i,multihashCode:s,digestSize:a,multihashSize:c-o,size:c}}static parse(e,t){const[n,r]=cV(e,t),i=aV.decode(r);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return sV(i).set(n,e),i}}const cV=(e,t)=>{switch(e[0]){case"Q":{const n=t||Bz;return[Bz.prefix,n.decode("".concat(Bz.prefix).concat(e))]}case Bz.prefix:{const n=t||Bz;return[Bz.prefix,n.decode(e)]}case Nz.prefix:{const n=t||Nz;return[Nz.prefix,n.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},lV=(e,t,n)=>{const{prefix:r}=n;if(r!==Bz.prefix)throw Error("Cannot string encode V0 in ".concat(n.name," encoding"));const i=t.get(r);if(null==i){const i=n.encode(e).slice(1);return t.set(r,i),i}return i},uV=(e,t,n)=>{const{prefix:r}=n,i=t.get(r);if(null==i){const i=n.encode(e);return t.set(r,i),i}return i},hV=112,dV=18,fV=(e,t,n)=>{const r=tV(e),i=r+tV(t),o=new Uint8Array(i+n.byteLength);return eV(e,o,0),eV(t,o,r),o.set(n,i),o},pV=Symbol.for("@ipld/js-cid/CID");class gV{has(e,t){return Promise.reject(new Error(".has is not implemented"))}put(e,t,n){return Promise.reject(new Error(".put is not implemented"))}async*putMany(e,t){for await(const{cid:n,block:r}of e)await this.put(n,r,t),yield n}get(e,t){return Promise.reject(new Error(".get is not implemented"))}async*getMany(e,t){for await(const n of e)yield{cid:n,block:await this.get(n,t)}}async delete(e,t){await Promise.reject(new Error(".delete is not implemented"))}async*deleteMany(e,t){for await(const n of e)await this.delete(n,t),yield n}async*getAll(e){throw new Error(".getAll is not implemented")}}class yV extends gV{constructor(){super(),(0,Yo.Z)(this,"data",void 0),this.data=new Map}put(e,t){return this.data.set(Nz.encode(e.multihash.bytes),t),e}get(e){const t=this.data.get(Nz.encode(e.multihash.bytes));if(null==t)throw Ez();return t}has(e){return this.data.has(Nz.encode(e.multihash.bytes))}async delete(e){this.data.delete(Nz.encode(e.multihash.bytes))}async*getAll(){for(const[e,t]of this.data.entries())yield{cid:aV.createV1(85,nV(Nz.decode(e))),block:t}}}const mV=Oz({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});Oz({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Oz({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Oz({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function vV(e){let t=function(e){const t=()=>{};return t.enabled=!1,t.color="",t.diff=0,t.log=()=>{},t.namespace=e,t.destroy=()=>!0,t.extend=()=>t,t}("".concat(e,":trace"));return sf().enabled("".concat(e,":trace"))&&null!=sf().names.map((e=>e.toString())).find((e=>e.includes(":trace")))&&(t=sf()("".concat(e,":trace"))),Object.assign(sf()(e),{error:sf()("".concat(e,":error")),trace:t})}sf().formatters.b=e=>null==e?"undefined":Bz.baseEncode(e),sf().formatters.t=e=>null==e?"undefined":Nz.baseEncode(e),sf().formatters.m=e=>null==e?"undefined":mV.baseEncode(e),sf().formatters.p=e=>null==e?"undefined":e.toString(),sf().formatters.c=e=>null==e?"undefined":e.toString(),sf().formatters.k=e=>null==e?"undefined":e.toString(),sf().formatters.a=e=>null==e?"undefined":e.toString();vV("blockstore:core:tiered");const bV="/",wV=(new TextEncoder).encode(bV),EV=wV[0];class AV{constructor(e,t){if((0,Yo.Z)(this,"_buf",void 0),"string"===typeof e)this._buf=(0,yu.m)(e);else{if(!(e instanceof Uint8Array))throw new Error("Invalid key, should be String of Uint8Array");this._buf=e}if(null==t&&(t=!0),t&&this.clean(),0===this._buf.byteLength||this._buf[0]!==EV)throw new Error("Invalid key")}toString(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"utf8";return(0,Au.B)(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return"Key(".concat(this.toString(),")")}static withNamespaces(e){return new AV(e.join(bV))}static random(){return new AV(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21;return crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+((t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_")),"")}().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||"string"===typeof e?new AV(e):"function"===typeof e.uint8Array?new AV(e.uint8Array()):null}clean(){if(null!=this._buf&&0!==this._buf.byteLength||(this._buf=wV),this._buf[0]!==EV){const e=new Uint8Array(this._buf.byteLength+1);e.fill(EV,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===EV;)this._buf=this._buf.subarray(0,-1)}less(e){const t=this.list(),n=e.list();for(let r=0;r<t.length;r++){if(n.length<r+1)return!1;const e=t[r],i=n[r];if(e<i)return!0;if(e>i)return!1}return t.length<n.length}reverse(){return AV.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){const e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(bV).slice(1)}type(){return function(e){const t=e.split(":");if(t.length<2)return"";return t.slice(0,-1).join(":")}(this.baseNamespace())}name(){return function(e){const t=e.split(":");return t[t.length-1]}(this.baseNamespace())}instance(e){return new AV(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(bV)||(e+=bV),e+=this.type(),new AV(e)}parent(){const e=this.list();return 1===e.length?new AV(bV):new AV(e.slice(0,-1).join(bV))}child(e){return this.toString()===bV?e:e.toString()===bV?this:new AV(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()!==this.toString()&&e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()!==this.toString()&&this.toString().startsWith(e.toString())}isTopLevel(){return 1===this.list().length}concat(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return AV.withNamespaces([...this.namespaces(),...(r=t.map((e=>e.namespaces())),[].concat(...r))]);var r}}const SV="SHARDING";const _V=function(e){if(null!=e[Symbol.asyncIterator])return(async()=>{for await(const t of e);})();for(const t of e);};const IV=function(e){const[t,n]=null!=e[Symbol.asyncIterator]?[e[Symbol.asyncIterator](),Symbol.asyncIterator]:[e[Symbol.iterator](),Symbol.iterator],r=[];return{peek:()=>t.next(),push:e=>{r.push(e)},next:()=>r.length>0?{done:!1,value:r.shift()}:t.next(),[n](){return this}}};const CV=function(e,t){if(null!=e[Symbol.asyncIterator])return async function*(){for await(const n of e)await t(n)&&(yield n)}();const n=IV(e),{value:r,done:i}=n.next();if(!0===i)return function*(){}();const o=t(r);if("function"===typeof o.then)return async function*(){await o&&(yield r);for await(const e of n)await t(e)&&(yield e)}();const s=t;return function*(){!0===o&&(yield r);for(const e of n)s(e)&&(yield e)}()};const TV=function(e){if(null!=e[Symbol.asyncIterator])return(async()=>{const t=[];for await(const n of e)t.push(n);return t})();const t=[];for(const n of e)t.push(n);return t};const kV=function(e,t){return null!=e[Symbol.asyncIterator]?async function*(){const n=await TV(e);yield*n.sort(t)}():function*(){const n=TV(e);yield*n.sort(t)}()};const RV=function(e,t){return null!=e[Symbol.asyncIterator]?async function*(){let n=0;if(!(t<1))for await(const r of e)if(yield r,n++,n===t)return}():function*(){let n=0;if(!(t<1))for(const r of e)if(yield r,n++,n===t)return}()};class xV{put(e,t,n){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}putMany(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){for await(const{key:r,value:i}of e)await t.put(r,i,n),yield r}()}catch(n){return Promise.reject(n)}}getMany(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){for await(const r of e)yield{key:r,value:await t.get(r,n)}}()}catch(n){return Promise.reject(n)}}deleteMany(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){for await(const r of e)await t.delete(r,n),yield r}()}catch(n){return Promise.reject(n)}}batch(){let e=[],t=[];return{put(t,n){e.push({key:t,value:n})},delete(e){t.push(e)},commit:async n=>{await _V(this.putMany(e,n)),e=[],await _V(this.deleteMany(t,n)),t=[]}}}async*_all(e,t){throw new Error("._all is not implemented")}async*_allKeys(e,t){throw new Error("._allKeys is not implemented")}query(e,t){let n=this._all(e,t);if(null!=e.prefix){const t=e.prefix;n=CV(n,(e=>e.key.toString().startsWith(t)))}if(Array.isArray(e.filters)&&(n=e.filters.reduce(((e,t)=>CV(e,t)),n)),Array.isArray(e.orders)&&(n=e.orders.reduce(((e,t)=>kV(e,t)),n)),null!=e.offset){let t=0;const r=e.offset;n=CV(n,(()=>t++>=r))}return null!=e.limit&&(n=RV(n,e.limit)),n}queryKeys(e,t){let n=this._allKeys(e,t);if(null!=e.prefix){const t=e.prefix;n=CV(n,(e=>e.toString().startsWith(t)))}if(Array.isArray(e.filters)&&(n=e.filters.reduce(((e,t)=>CV(e,t)),n)),Array.isArray(e.orders)&&(n=e.orders.reduce(((e,t)=>kV(e,t)),n)),null!=e.offset){const t=e.offset;let r=0;n=CV(n,(()=>r++>=t))}return null!=e.limit&&(n=RV(n,e.limit)),n}}class PV extends xV{constructor(){super(),(0,Yo.Z)(this,"data",void 0),this.data=new Map}put(e,t){return this.data.set(e.toString(),t),e}get(e){const t=this.data.get(e.toString());if(null==t)throw function(e){var t;return e=null!==(t=e)&&void 0!==t?t:new Error("Not Found"),Xo()(e,"ERR_NOT_FOUND")}();return t}has(e){return this.data.has(e.toString())}delete(e){this.data.delete(e.toString())}*_all(){for(const[e,t]of this.data.entries())yield{key:new AV(e),value:t}}*_allKeys(){for(const e of this.data.keys())yield new AV(e)}}new AV(SV);var DV=n(85970);function OV(e){let t=function(e){const t=()=>{};return t.enabled=!1,t.color="",t.diff=0,t.log=()=>{},t.namespace=e,t.destroy=()=>!0,t.extend=()=>t,t}("".concat(e,":trace"));return sf().enabled("".concat(e,":trace"))&&null!=sf().names.map((e=>e.toString())).find((e=>e.includes(":trace")))&&(t=sf()("".concat(e,":trace"))),Object.assign(sf()(e),{error:sf()("".concat(e,":error")),trace:t})}sf().formatters.b=e=>null==e?"undefined":mu.base58btc.baseEncode(e),sf().formatters.t=e=>null==e?"undefined":DV.base32.baseEncode(e),sf().formatters.m=e=>null==e?"undefined":xu.base64.baseEncode(e),sf().formatters.p=e=>null==e?"undefined":e.toString(),sf().formatters.c=e=>null==e?"undefined":e.toString(),sf().formatters.k=e=>null==e?"undefined":e.toString(),sf().formatters.a=e=>null==e?"undefined":e.toString();OV("datastore:core:tiered");var NV=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==n[s])throw new TypeError(o+" is ambiguous");n[s]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var r=0,i=0;e[t]===c;)r++,t++;for(var o=(e.length-t)*l+1>>>0,s=new Uint8Array(o);e[t];){var u=n[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=o-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*s[d]>>>0,s[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=o-i;f!==o&&0===s[f];)f++;for(var p=new Uint8Array(r+(o-f)),g=r;f!==o;)p[g++]=s[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,o=t.length;i!==o&&0===t[i];)i++,n++;for(var s=(o-i)*u+1>>>0,l=new Uint8Array(s);i!==o;){for(var h=t[i],d=0,f=s-1;(0!==h||d<r)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");r=d,i++}for(var p=s-r;p!==s&&0===l[p];)p++;for(var g=c.repeat(n);p<s;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:h,decode:function(e){var n=h(e);if(n)return n;throw new Error("Non-".concat(t," character"))}}};const BV=NV,LV=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class MV{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(e));throw Error("Unknown type, must be binary type")}}class UV{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(e),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return KV(this,e)}}class FV{constructor(e){this.decoders=e}or(e){return KV(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(e),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}}const KV=(e,t)=>new FV({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class jV{constructor(e,t,n,r){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=r,this.encoder=new MV(e,t,n),this.decoder=new UV(e,t,r)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const ZV=e=>{let{name:t,prefix:n,encode:r,decode:i}=e;return new jV(t,n,r,i)},zV=e=>{let{prefix:t,name:n,alphabet:r}=e;const{encode:i,decode:o}=BV(r,n);return ZV({prefix:t,name:n,encode:i,decode:e=>LV(o(e))})},VV=e=>{let{name:t,prefix:n,bitsPerChar:r,alphabet:i}=e;return ZV({prefix:n,name:t,encode:e=>((e,t,n)=>{const r="="===t[t.length-1],i=(1<<n)-1;let o="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>n;)s-=n,o+=t[i&a>>s];if(s&&(o+=t[i&a<<n-s]),r)for(;o.length*n&7;)o+="=";return o})(e,i,r),decode:e=>((e,t,n,r)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*n/8|0);let a=0,c=0,l=0;for(let u=0;u<o;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError("Non-".concat(r," character"));c=c<<n|t,a+=n,a>=8&&(a-=8,s[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s})(e,i,r,t)})},HV=VV({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),qV=VV({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),GV=VV({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),WV=VV({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),QV=VV({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),YV=VV({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),JV=VV({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),XV=VV({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),$V=VV({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),eH=zV({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),tH=zV({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),nH=VV({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),rH=VV({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),iH=VV({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),oH=VV({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function sH(){return{forComponent:e=>aH(e)}}function aH(e){let t=function(e){const t=()=>{};return t.enabled=!1,t.color="",t.diff=0,t.log=()=>{},t.namespace=e,t.destroy=()=>!0,t.extend=()=>t,t}("".concat(e,":trace"));return sf().enabled("".concat(e,":trace"))&&null!=sf().names.map((e=>e.toString())).find((e=>e.includes(":trace")))&&(t=sf()("".concat(e,":trace"))),Object.assign(sf()(e),{error:sf()("".concat(e,":error")),trace:t})}sf().formatters.b=e=>null==e?"undefined":eH.baseEncode(e),sf().formatters.t=e=>null==e?"undefined":HV.baseEncode(e),sf().formatters.m=e=>null==e?"undefined":nH.baseEncode(e),sf().formatters.p=e=>null==e?"undefined":e.toString(),sf().formatters.c=e=>null==e?"undefined":e.toString(),sf().formatters.k=e=>null==e?"undefined":e.toString(),sf().formatters.a=e=>null==e?"undefined":e.toString();const cH="/",lH=(new TextEncoder).encode(cH),uH=lH[0];class hH{constructor(e,t){if((0,Yo.Z)(this,"_buf",void 0),"string"===typeof e)this._buf=(0,yu.m)(e);else{if(!(e instanceof Uint8Array))throw new Error("Invalid key, should be String of Uint8Array");this._buf=e}if(null==t&&(t=!0),t&&this.clean(),0===this._buf.byteLength||this._buf[0]!==uH)throw new Error("Invalid key")}toString(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"utf8";return(0,Au.B)(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return"Key(".concat(this.toString(),")")}static withNamespaces(e){return new hH(e.join(cH))}static random(){return new hH(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21;return crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+((t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_")),"")}().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||"string"===typeof e?new hH(e):"function"===typeof e.uint8Array?new hH(e.uint8Array()):null}clean(){if(null!=this._buf&&0!==this._buf.byteLength||(this._buf=lH),this._buf[0]!==uH){const e=new Uint8Array(this._buf.byteLength+1);e.fill(uH,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===uH;)this._buf=this._buf.subarray(0,-1)}less(e){const t=this.list(),n=e.list();for(let r=0;r<t.length;r++){if(n.length<r+1)return!1;const e=t[r],i=n[r];if(e<i)return!0;if(e>i)return!1}return t.length<n.length}reverse(){return hH.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){const e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(cH).slice(1)}type(){return function(e){const t=e.split(":");if(t.length<2)return"";return t.slice(0,-1).join(":")}(this.baseNamespace())}name(){return function(e){const t=e.split(":");return t[t.length-1]}(this.baseNamespace())}instance(e){return new hH(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(cH)||(e+=cH),e+=this.type(),new hH(e)}parent(){const e=this.list();return 1===e.length?new hH(cH):new hH(e.slice(0,-1).join(cH))}child(e){return this.toString()===cH?e:e.toString()===cH?this:new hH(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()!==this.toString()&&e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()!==this.toString()&&this.toString().startsWith(e.toString())}isTopLevel(){return 1===this.list().length}concat(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return hH.withNamespaces([...this.namespaces(),...(r=t.map((e=>e.namespaces())),[].concat(...r))]);var r}}const dH="SHARDING";const fH=function(e){if(null!=e[Symbol.asyncIterator])return(async()=>{for await(const t of e);})();for(const t of e);};const pH=function(e){const[t,n]=null!=e[Symbol.asyncIterator]?[e[Symbol.asyncIterator](),Symbol.asyncIterator]:[e[Symbol.iterator](),Symbol.iterator],r=[];return{peek:()=>t.next(),push:e=>{r.push(e)},next:()=>r.length>0?{done:!1,value:r.shift()}:t.next(),[n](){return this}}};const gH=function(e,t){if(null!=e[Symbol.asyncIterator])return async function*(){for await(const n of e)await t(n)&&(yield n)}();const n=pH(e),{value:r,done:i}=n.next();if(!0===i)return function*(){}();const o=t(r);if("function"===typeof o.then)return async function*(){await o&&(yield r);for await(const e of n)await t(e)&&(yield e)}();const s=t;return function*(){!0===o&&(yield r);for(const e of n)s(e)&&(yield e)}()};const yH=function(e,t){return null!=e[Symbol.asyncIterator]?async function*(){let n=0;if(!(t<1))for await(const r of e)if(yield r,n++,n===t)return}():function*(){let n=0;if(!(t<1))for(const r of e)if(yield r,n++,n===t)return}()};class mH{put(e,t,n){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}putMany(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){for await(const{key:r,value:i}of e)await t.put(r,i,n),yield r}()}catch(n){return Promise.reject(n)}}getMany(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){for await(const r of e)yield{key:r,value:await t.get(r,n)}}()}catch(n){return Promise.reject(n)}}deleteMany(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){for await(const r of e)await t.delete(r,n),yield r}()}catch(n){return Promise.reject(n)}}batch(){let e=[],t=[];return{put(t,n){e.push({key:t,value:n})},delete(e){t.push(e)},commit:async n=>{await fH(this.putMany(e,n)),e=[],await fH(this.deleteMany(t,n)),t=[]}}}async*_all(e,t){throw new Error("._all is not implemented")}async*_allKeys(e,t){throw new Error("._allKeys is not implemented")}query(e,t){let n=this._all(e,t);if(null!=e.prefix){const t=e.prefix;n=gH(n,(e=>e.key.toString().startsWith(t)))}if(Array.isArray(e.filters)&&(n=e.filters.reduce(((e,t)=>gH(e,t)),n)),Array.isArray(e.orders)&&(n=e.orders.reduce(((e,t)=>kV(e,t)),n)),null!=e.offset){let t=0;const r=e.offset;n=gH(n,(()=>t++>=r))}return null!=e.limit&&(n=yH(n,e.limit)),n}queryKeys(e,t){let n=this._allKeys(e,t);if(null!=e.prefix){const t=e.prefix;n=gH(n,(e=>e.toString().startsWith(t)))}if(Array.isArray(e.filters)&&(n=e.filters.reduce(((e,t)=>gH(e,t)),n)),Array.isArray(e.orders)&&(n=e.orders.reduce(((e,t)=>kV(e,t)),n)),null!=e.offset){const t=e.offset;let r=0;n=gH(n,(()=>r++>=t))}return null!=e.limit&&(n=yH(n,e.limit)),n}}class vH extends mH{constructor(){super(),(0,Yo.Z)(this,"data",void 0),this.data=new Map}put(e,t){return this.data.set(e.toString(),t),e}get(e){const t=this.data.get(e.toString());if(null==t)throw function(e){var t;return e=null!==(t=e)&&void 0!==t?t:new Error("Not Found"),Xo()(e,"ERR_NOT_FOUND")}();return t}has(e){return this.data.has(e.toString())}delete(e){this.data.delete(e.toString())}*_all(){for(const[e,t]of this.data.entries())yield{key:new hH(e),value:t}}*_allKeys(){for(const e of this.data.keys())yield new hH(e)}}new hH(dH);aH("datastore:core:tiered");function bH(e){return null!=e&&"function"===typeof e.start&&"function"===typeof e.stop}async function wH(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)bH(i)&&e.push(i);await Promise.all(e.map((async e=>{null!=e.beforeStart&&await e.beforeStart()}))),await Promise.all(e.map((async e=>{await e.start()}))),await Promise.all(e.map((async e=>{null!=e.afterStart&&await e.afterStart()})))}async function EH(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)bH(i)&&e.push(i);await Promise.all(e.map((async e=>{null!=e.beforeStop&&await e.beforeStop()}))),await Promise.all(e.map((async e=>{await e.stop()}))),await Promise.all(e.map((async e=>{null!=e.afterStop&&await e.afterStop()})))}class AH extends Event{constructor(e,t){super(e),this.detail=t}}function SH(e){const t=new globalThis.AbortController;function n(){t.abort();for(const t of e)null!=(null===t||void 0===t?void 0:t.removeEventListener)&&t.removeEventListener("abort",n)}for(const i of e){if(!0===(null===i||void 0===i?void 0:i.aborted)){n();break}null!=(null===i||void 0===i?void 0:i.addEventListener)&&i.addEventListener("abort",n)}const r=t.signal;return r.clear=function(){for(const t of e)null!=(null===t||void 0===t?void 0:t.removeEventListener)&&t.removeEventListener("abort",n)},r}var _H=function e(t,n,r){n=n||[];var i=r=r||0;for(;t>=TH;)n[r++]=255&t|IH,t/=128;for(;t&CH;)n[r++]=255&t|IH,t>>>=7;return n[r]=0|t,e.bytes=r-i+1,n},IH=128,CH=-128,TH=Math.pow(2,31);var kH=function e(t,n){var r,i=0,o=0,s=n=n||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");r=t[s++],i+=o<28?(r&xH)<<o:(r&xH)*Math.pow(2,o),o+=7}while(r>=RH);return e.bytes=s-n,i},RH=128,xH=127;var PH=Math.pow(2,7),DH=Math.pow(2,14),OH=Math.pow(2,21),NH=Math.pow(2,28),BH=Math.pow(2,35),LH=Math.pow(2,42),MH=Math.pow(2,49),UH=Math.pow(2,56),FH=Math.pow(2,63);const KH={encode:_H,decode:kH,encodingLength:function(e){return e<PH?1:e<DH?2:e<OH?3:e<NH?4:e<BH?5:e<LH?6:e<MH?7:e<UH?8:e<FH?9:10}},jH=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return[KH.decode(e,t),KH.decode.bytes]},ZH=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return KH.encode(e,t,n),t},zH=e=>KH.encodingLength(e),VH=(e,t)=>{const n=t.byteLength,r=zH(e),i=r+zH(n),o=new Uint8Array(i+n);return ZH(e,o,0),ZH(n,o,r),o.set(t,i),new qH(e,n,t,o)},HH=e=>{const t=LV(e),[n,r]=jH(t),[i,o]=jH(t.subarray(r)),s=t.subarray(r+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new qH(n,i,s,t)};class qH{constructor(e,t,n,r){this.code=e,this.size=t,this.digest=n,this.bytes=r}}const GH=(e,t)=>{const{bytes:n,version:r}=e;return 0===r?XH(n,QH(e),t||eH.encoder):$H(n,QH(e),t||HV.encoder)},WH=new WeakMap,QH=e=>{const t=WH.get(e);if(null==t){const t=new Map;return WH.set(e,t),t}return t};class YH{constructor(e,t,n,r){this.code=t,this.version=e,this.multihash=n,this.bytes=r,this["/"]=r}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==eq)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==tq)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return YH.createV0(t)}default:throw Error("Can not convert CID version ".concat(this.version," to version 0. This is a bug please report"))}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=VH(e,t);return YH.createV1(this.code,n)}case 1:return this;default:throw Error("Can not convert CID version ".concat(this.version," to version 1. This is a bug please report"))}}equals(e){return YH.equals(this,e)}static equals(e,t){const n=t;return n&&e.code===n.code&&e.version===n.version&&((e,t)=>{if(e===t)return!0;{const n=t;return e.code===n.code&&e.size===n.size&&n.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0})(e.bytes,n.bytes)}})(e.multihash,n.multihash)}toString(e){return GH(this,e)}toJSON(){return{"/":GH(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID(".concat(this.toString(),")")}static asCID(e){if(null==e)return null;const t=e;if(t instanceof YH)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:n,multihash:r,bytes:i}=t;return new YH(e,n,r,i||nq(e,n,r.bytes))}if(!0===t[rq]){const{version:e,multihash:n,code:r}=t,i=HH(n);return YH.create(e,r,i)}return null}static create(e,t,n){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==eq)throw new Error("Version 0 CID must use dag-pb (code: ".concat(eq,") block encoding"));return new YH(e,t,n,n.bytes);case 1:{const r=nq(e,t,n.bytes);return new YH(e,t,n,r)}default:throw new Error("Invalid version")}}static createV0(e){return YH.create(0,eq,e)}static createV1(e,t){return YH.create(1,e,t)}static decode(e){const[t,n]=YH.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=YH.inspectBytes(e),n=t.size-t.multihashSize,r=LV(e.subarray(n,n+t.multihashSize));if(r.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=r.subarray(t.multihashSize-t.digestSize),o=new qH(t.multihashCode,t.digestSize,i,r);return[0===t.version?YH.createV0(o):YH.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[n,r]=jH(e.subarray(t));return t+=r,n};let r=n(),i=eq;if(18===r?(r=0,t=0):i=n(),0!==r&&1!==r)throw new RangeError("Invalid CID version ".concat(r));const o=t,s=n(),a=n(),c=t+a;return{version:r,codec:i,multihashCode:s,digestSize:a,multihashSize:c-o,size:c}}static parse(e,t){const[n,r]=JH(e,t),i=YH.decode(r);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return QH(i).set(n,e),i}}const JH=(e,t)=>{switch(e[0]){case"Q":{const n=t||eH;return[eH.prefix,n.decode("".concat(eH.prefix).concat(e))]}case eH.prefix:{const n=t||eH;return[eH.prefix,n.decode(e)]}case HV.prefix:{const n=t||HV;return[HV.prefix,n.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},XH=(e,t,n)=>{const{prefix:r}=n;if(r!==eH.prefix)throw Error("Cannot string encode V0 in ".concat(n.name," encoding"));const i=t.get(r);if(null==i){const i=n.encode(e).slice(1);return t.set(r,i),i}return i},$H=(e,t,n)=>{const{prefix:r}=n,i=t.get(r);if(null==i){const i=n.encode(e);return t.set(r,i),i}return i},eq=112,tq=18,nq=(e,t,n)=>{const r=zH(e),i=r+zH(t),o=new Uint8Array(i+n.byteLength);return ZH(e,o,0),ZH(t,o,r),o.set(n,i),o},rq=Symbol.for("@ipld/js-cid/CID");class iq extends Map{constructor(e){super(),(0,Yo.Z)(this,"metric",void 0);const{name:t,metrics:n}=e;this.metric=n.registerMetric(t),this.updateComponentMetric()}set(e,t){return super.set(e,t),this.updateComponentMetric(),this}delete(e){const t=super.delete(e);return this.updateComponentMetric(),t}clear(){super.clear(),this.updateComponentMetric()}updateComponentMetric(){this.metric.update(this.size)}}function oq(e){const{name:t,metrics:n}=e;let r;return r=null!=n?new iq({name:t,metrics:n}):new Map,r}class sq extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"The operation was aborted"),(0,Yo.Z)(this,"code",void 0),(0,Yo.Z)(this,"type",void 0),this.code=sq.code,this.type=sq.type}}(0,Yo.Z)(sq,"code","ABORT_ERR"),(0,Yo.Z)(sq,"type","aborted");class aq extends Error{constructor(e,t,n){var r;super(e),(0,Yo.Z)(this,"code",void 0),(0,Yo.Z)(this,"props",void 0),this.code=t,this.name=null!==(r=null===n||void 0===n?void 0:n.name)&&void 0!==r?r:"CodeError",this.props=null!==n&&void 0!==n?n:{}}}class cq extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected Peer"),(0,Yo.Z)(this,"code",void 0),this.code=cq.code}}(0,Yo.Z)(cq,"code","ERR_UNEXPECTED_PEER");class lq extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid crypto exchange"),(0,Yo.Z)(this,"code",void 0),this.code=lq.code}}(0,Yo.Z)(lq,"code","ERR_INVALID_CRYPTO_EXCHANGE");class uq extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid crypto transmission"),(0,Yo.Z)(this,"code",void 0),this.code=uq.code}}(0,Yo.Z)(uq,"code","ERR_INVALID_CRYPTO_TRANSMISSION");const hq=e=>{let{name:t,code:n,encode:r}=e;return new dq(t,n,r)};class dq{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?VH(this.code,t):t.then((e=>VH(this.code,e)))}throw Error("Unknown type, must be binary type")}}const fq=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),pq=hq({name:"sha2-256",code:18,encode:fq("SHA-256")}),gq=hq({name:"sha2-512",code:19,encode:fq("SHA-512")});var yq=n(29806),mq=n.n(yq);class vq{constructor(e,t,n){(0,Yo.Z)(this,"_refCounter",void 0),(0,Yo.Z)(this,"cid",void 0),(0,Yo.Z)(this,"priority",void 0),(0,Yo.Z)(this,"wantType",void 0),this._refCounter=1,this.cid=e,this.priority=null!==t&&void 0!==t?t:1,this.wantType=n}inc(){this._refCounter+=1}dec(){this._refCounter=Math.max(0,this._refCounter-1)}hasRefs(){return this._refCounter>0}get[Symbol.toStringTag](){const e=this.cid.toString(eH);return"WantlistEntry <key: ".concat(e,", priority: ").concat(this.priority,", refs: ").concat(this._refCounter,">")}equals(e){return this._refCounter===e._refCounter&&this.cid.equals(e.cid)&&this.priority===e.priority&&this.wantType===e.wantType}}class bq{constructor(e,t,n,r,i){(0,Yo.Z)(this,"entry",void 0),(0,Yo.Z)(this,"cancel",void 0),(0,Yo.Z)(this,"sendDontHave",void 0),this.entry=new vq(e,t,n),this.cancel=Boolean(r),this.sendDontHave=Boolean(i)}get cid(){return this.entry.cid}set cid(e){this.entry.cid=e}get priority(){return this.entry.priority}set priority(e){this.entry.priority=e}get wantType(){return this.entry.wantType}set wantType(e){this.entry.wantType=e}get[Symbol.toStringTag](){const e=this.cid.toString(eH);return"BitswapMessageEntry ".concat(e," <cancel: ").concat(this.cancel,", priority: ").concat(this.priority,">")}equals(e){return this.cancel===e.cancel&&this.sendDontHave===e.sendDontHave&&this.wantType===e.wantType&&this.entry.equals(e.entry)}}const wq=(e,t)=>{const n=["bitswap"];return null!=t&&n.push(t),null!=e&&n.push("".concat(e.toString().slice(0,8))),aH(n.join(":"))},Eq=(e,t)=>{if(e.size!==t.size)return!1;for(const[n,r]of e){const e=t.get(n);if(void 0===e)return!1;if(r instanceof Uint8Array&&e instanceof Uint8Array&&!(0,Ms.f)(r,e))return!1;if(r instanceof bq&&e instanceof bq&&!r.equals(e))return!1}return!0};const Aq=function(e){let t=new Uint8Array(e.reduce(((e,t)=>e+ii().encodingLength(t)),0)),n=0;for(const r of e)t=ri.encode(r,t,n),n+=ii().encodingLength(r);return t};var Sq;!function(e){let t,n,r,i,o,s;!function(t){let n,r,i,o;!function(e){e.Block="Block",e.Have="Have"}(n=t.WantType||(t.WantType={})),function(e){e[e.Block=0]="Block",e[e.Have=1]="Have"}(r||(r={})),function(e){e.codec=()=>bs(r)}(n=t.WantType||(t.WantType={})),function(t){let i;t.codec=()=>(null==i&&(i=ws((function(t,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==i.lengthDelimited&&n.fork(),null!=t.block&&t.block.byteLength>0&&(n.uint32(10),n.bytes(t.block)),null!=t.priority&&0!==t.priority&&(n.uint32(16),n.int32(t.priority)),null!=t.cancel&&!1!==t.cancel&&(n.uint32(24),n.bool(t.cancel)),null!=t.wantType&&0!==r[t.wantType]&&(n.uint32(32),e.Wantlist.WantType.codec().encode(t.wantType,n)),null!=t.sendDontHave&&!1!==t.sendDontHave&&(n.uint32(40),n.bool(t.sendDontHave)),!1!==i.lengthDelimited&&n.ldelim()}),((t,r)=>{const i={block:new Uint8Array(0),priority:0,cancel:!1,wantType:n.Block,sendDontHave:!1},o=null==r?t.len:t.pos+r;for(;t.pos<o;){const n=t.uint32();switch(n>>>3){case 1:i.block=t.bytes();break;case 2:i.priority=t.int32();break;case 3:i.cancel=t.bool();break;case 4:i.wantType=e.Wantlist.WantType.codec().decode(t);break;case 5:i.sendDontHave=t.bool();break;default:t.skipType(7&n)}}return i}))),i),t.encode=e=>fs(e,t.codec()),t.decode=e=>ds(e,t.codec())}(i=t.Entry||(t.Entry={})),t.codec=()=>(null==o&&(o=ws((function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==r.lengthDelimited&&n.fork(),null!=t.entries)for(const i of t.entries)n.uint32(10),e.Wantlist.Entry.codec().encode(i,n);null!=t.full&&!1!==t.full&&(n.uint32(16),n.bool(t.full)),!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={entries:[],full:!1},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.entries.push(e.Wantlist.Entry.codec().decode(t,t.uint32()));break;case 2:r.full=t.bool();break;default:t.skipType(7&n)}}return r}))),o),t.encode=e=>fs(e,t.codec()),t.decode=e=>ds(e,t.codec())}(t=e.Wantlist||(e.Wantlist={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.prefix&&e.prefix.byteLength>0&&(t.uint32(10),t.bytes(e.prefix)),null!=e.data&&e.data.byteLength>0&&(t.uint32(18),t.bytes(e.data)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={prefix:new Uint8Array(0),data:new Uint8Array(0)},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.prefix=e.bytes();break;case 2:n.data=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(n=e.Block||(e.Block={})),function(e){e.Have="Have",e.DontHave="DontHave"}(r=e.BlockPresenceType||(e.BlockPresenceType={})),function(e){e[e.Have=0]="Have",e[e.DontHave=1]="DontHave"}(i||(i={})),function(e){e.codec=()=>bs(i)}(r=e.BlockPresenceType||(e.BlockPresenceType={})),function(t){let n;t.codec=()=>(null==n&&(n=ws((function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==r.lengthDelimited&&n.fork(),null!=t.cid&&t.cid.byteLength>0&&(n.uint32(10),n.bytes(t.cid)),null!=t.type&&0!==i[t.type]&&(n.uint32(16),e.BlockPresenceType.codec().encode(t.type,n)),!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const i={cid:new Uint8Array(0),type:r.Have},o=null==n?t.len:t.pos+n;for(;t.pos<o;){const n=t.uint32();switch(n>>>3){case 1:i.cid=t.bytes();break;case 2:i.type=e.BlockPresenceType.codec().decode(t);break;default:t.skipType(7&n)}}return i}))),n),t.encode=e=>fs(e,t.codec()),t.decode=e=>ds(e,t.codec())}(o=e.BlockPresence||(e.BlockPresence={})),e.codec=()=>(null==s&&(s=ws((function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==r.lengthDelimited&&n.fork(),null!=t.wantlist&&(n.uint32(10),e.Wantlist.codec().encode(t.wantlist,n)),null!=t.blocks)for(const e of t.blocks)n.uint32(18),n.bytes(e);if(null!=t.payload)for(const i of t.payload)n.uint32(26),e.Block.codec().encode(i,n);if(null!=t.blockPresences)for(const i of t.blockPresences)n.uint32(34),e.BlockPresence.codec().encode(i,n);null!=t.pendingBytes&&0!==t.pendingBytes&&(n.uint32(40),n.int32(t.pendingBytes)),!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={blocks:[],payload:[],blockPresences:[],pendingBytes:0},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.wantlist=e.Wantlist.codec().decode(t,t.uint32());break;case 2:r.blocks.push(t.bytes());break;case 3:r.payload.push(e.Block.codec().decode(t,t.uint32()));break;case 4:r.blockPresences.push(e.BlockPresence.codec().decode(t,t.uint32()));break;case 5:r.pendingBytes=t.int32();break;default:t.skipType(7&n)}}return r}))),s),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(Sq||(Sq={}));class _q{constructor(e){(0,Yo.Z)(this,"full",void 0),(0,Yo.Z)(this,"wantlist",void 0),(0,Yo.Z)(this,"blocks",void 0),(0,Yo.Z)(this,"blockPresences",void 0),(0,Yo.Z)(this,"pendingBytes",void 0),this.full=e,this.wantlist=new Map,this.blocks=new Map,this.blockPresences=new Map,this.pendingBytes=0}get empty(){return 0===this.blocks.size&&0===this.wantlist.size&&0===this.blockPresences.size}addEntry(e,t,n,r,i){null==n&&(n=_q.WantType.Block);const o=e.toString(eH),s=this.wantlist.get(o);null!=s?(s.wantType===n&&(s.priority=t),!0===r&&(s.cancel=Boolean(r)),!0===i&&(s.sendDontHave=Boolean(i)),n===_q.WantType.Block&&s.wantType===_q.WantType.Have&&(s.wantType=n)):this.wantlist.set(o,new bq(e,t,n,r,i))}addBlock(e,t){const n=e.toString(eH);this.blocks.set(n,t)}addHave(e){const t=e.toString(eH);this.blockPresences.has(t)||this.blockPresences.set(t,_q.BlockPresenceType.Have)}addDontHave(e){const t=e.toString(eH);this.blockPresences.has(t)||this.blockPresences.set(t,_q.BlockPresenceType.DontHave)}cancel(e){const t=e.toString(eH);this.wantlist.delete(t),this.addEntry(e,0,_q.WantType.Block,!0,!1)}setPendingBytes(e){this.pendingBytes=e}serializeToBitswap100(){return Sq.encode({wantlist:{entries:Array.from(this.wantlist.values()).map((e=>({block:e.cid.bytes,priority:Number(e.priority),cancel:Boolean(e.cancel),wantType:Sq.Wantlist.WantType.Block,sendDontHave:!1}))),full:Boolean(this.full)},blocks:Array.from(this.blocks.values())})}serializeToBitswap110(){const e={wantlist:{entries:Array.from(this.wantlist.values()).map((e=>({block:e.cid.bytes,priority:Number(e.priority),wantType:e.wantType,cancel:Boolean(e.cancel),sendDontHave:Boolean(e.sendDontHave)}))),full:Boolean(this.full)},blockPresences:[],payload:[],pendingBytes:this.pendingBytes,blocks:[]};for(const[t,n]of this.blocks.entries()){const r=YH.parse(t),i=r.version,o=r.code,s=r.multihash.code,a=r.multihash.digest.length,c=Aq([i,o,s,a]);e.payload.push({prefix:c,data:n})}for(const[t,n]of this.blockPresences)e.blockPresences.push({cid:YH.parse(t).bytes,type:n});return this.pendingBytes>0&&(e.pendingBytes=this.pendingBytes),Sq.encode(e)}equals(e){return!!(this.full===e.full&&this.pendingBytes===e.pendingBytes&&Eq(this.wantlist,e.wantlist)&&Eq(this.blocks,e.blocks)&&Eq(this.blockPresences,e.blockPresences))}get[Symbol.toStringTag](){const e=Array.from(this.wantlist.keys()),t=Array.from(this.blocks.keys());return"BitswapMessage <full: ".concat(this.full,", list: ").concat(e,", blocks: ").concat(t,">")}}(0,Yo.Z)(_q,"Entry",bq),(0,Yo.Z)(_q,"WantType",{Block:Sq.Wantlist.WantType.Block,Have:Sq.Wantlist.WantType.Have}),(0,Yo.Z)(_q,"BlockPresenceType",{Have:Sq.BlockPresenceType.Have,DontHave:Sq.BlockPresenceType.DontHave}),(0,Yo.Z)(_q,"deserialize",(async(e,t)=>{var n,r;const i=Sq.decode(e),o=!0===(null===(n=i.wantlist)||void 0===n?void 0:n.full),s=new _q(o);return null===(r=i.wantlist)||void 0===r||r.entries.forEach((e=>{var t;if(null==e.block)return;const n=YH.decode(e.block);s.addEntry(n,null!==(t=e.priority)&&void 0!==t?t:0,e.wantType,Boolean(e.cancel),Boolean(e.sendDontHave))})),i.blockPresences.forEach((e=>{if(null==e.cid)return;const t=YH.decode(e.cid);e.type===_q.BlockPresenceType.Have?s.addHave(t):s.addDontHave(t)})),i.blocks.length>0?(await Promise.all(i.blocks.map((async e=>{const t=await pq.digest(e),n=YH.createV0(t);s.addBlock(n,e)}))),s):i.payload.length>0?(await Promise.all(i.payload.map((async e=>{if(null==e.prefix||null==e.data)return;const n=mq()(e.prefix),r=n[0],i=n[1],o=n[2],a=o===pq.code?pq:await(null===t||void 0===t?void 0:t.getHasher(o));if(null==a)throw new aq("Unknown hash algorithm","ERR_UNKNOWN_HASH_ALG");const c=await a.digest(e.data),l=YH.create(r,i,c);s.addBlock(l,e.data)}))),s.setPendingBytes(i.pendingBytes),s):s})),(0,Yo.Z)(_q,"blockPresenceSize",(e=>e.bytes.length+1));const Iq=Sq.Wantlist.WantType.Block,Cq=Sq.Wantlist.WantType.Have;class Tq{constructor(e,t){(0,Yo.Z)(this,"set",void 0),(0,Yo.Z)(this,"_stats",void 0),this.set=null!=t?oq({name:"ipfs_bitswap_wantlist",metrics:t.metrics}):new Map,this._stats=e}get length(){return this.set.size}add(e,t,n){const r=e.toString(eH),i=this.set.get(r);null!=i?(i.inc(),i.priority=t,i.wantType===Cq&&n===Iq&&(i.wantType=n)):(this.set.set(r,new vq(e,t,n)),null!=this._stats&&this._stats.push(void 0,"wantListSize",1))}remove(e){const t=e.toString(eH),n=this.set.get(t);null!=n&&(n.dec(),n.hasRefs()||(this.set.delete(t),null!=this._stats&&this._stats.push(void 0,"wantListSize",-1)))}removeForce(e){this.set.has(e)&&this.set.delete(e)}forEach(e){this.set.forEach(e)}entries(){return this.set.entries()}sortedEntries(){return new Map((e=e=>e[1].key,t=Array.from(this.set.entries()),Array.prototype.slice.call(t,0).sort(((t,n)=>{const r=e(t),i=e(n);return r<i?-1:r>i?1:0}))));var e,t}contains(e){const t=e.toString(eH);return this.set.has(t)}get(e){const t=e.toString(eH);return this.set.get(t)}}(0,Yo.Z)(Tq,"Entry",vq);class kq{constructor(e){(0,Yo.Z)(this,"partner",void 0),(0,Yo.Z)(this,"wantlist",void 0),(0,Yo.Z)(this,"exchangeCount",void 0),(0,Yo.Z)(this,"accounting",void 0),(0,Yo.Z)(this,"lastExchange",void 0),this.partner=e,this.wantlist=new Tq,this.exchangeCount=0,this.accounting={bytesSent:0,bytesRecv:0}}sentBytes(e){this.exchangeCount++,this.lastExchange=(new Date).getTime(),this.accounting.bytesSent+=e}receivedBytes(e){this.exchangeCount++,this.lastExchange=(new Date).getTime(),this.accounting.bytesRecv+=e}wants(e,t,n){this.wantlist.add(e,t,n)}cancelWant(e){this.wantlist.remove(e)}wantlistContains(e){return this.wantlist.get(e)}debtRatio(){return this.accounting.bytesSent/(this.accounting.bytesRecv+1)}}class Rq extends Map{constructor(e,t){super(),(0,Yo.Z)(this,"_cmp",void 0),(0,Yo.Z)(this,"_keys",void 0),this._cmp=null!==t&&void 0!==t?t:this._defaultSort,this._keys=[];for(const[n,r]of null!==e&&void 0!==e?e:[])this.set(n,r)}update(e){if(e<0||e>=this._keys.length)return;const t=this._keys[e];this._keys.splice(e,1);const n=this._find(t);this._keys.splice(n,0,t)}set(e,t){if(this.has(e)){const t=this.indexOf(e);this._keys.splice(t,1)}super.set(e,t);const n=this._find(e);return this._keys.splice(n,0,e),this}clear(){super.clear(),this._keys=[]}delete(e){if(!this.has(e))return!1;const t=this.indexOf(e);return this._keys.splice(t,1),super.delete(e)}indexOf(e){if(!this.has(e))return-1;const t=this._find(e);if(this._keys[t]===e)return t;for(let n=1;n<this._keys.length;n++){if(this._keys[t+n]===e)return t+n;if(this._keys[t-n]===e)return t-n}return-1}_find(e){let t=0,n=this._keys.length;for(;t<n;){const r=t+n>>>1,i=this._kCmp(this._keys[r],e);if(i<0)t=r+1;else{if(!(i>0))return r;n=r}}return t}*keys(){for(const e of this._keys)yield e}*values(){for(const e of this._keys)yield this.get(e)}*entries(){for(const e of this._keys)yield[e,this.get(e)]}*[Symbol.iterator](){yield*this.entries()}forEach(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;if(null!=e)for(const n of this._keys){const r=this.get(n);if(null==r)throw new Error("Value cannot be undefined");e.apply(t,[[n,r]])}}_defaultSort(e,t){return e[0]<t[0]?-1:t[0]<e[0]?1:0}_kCmp(e,t){return this._cmp([e,this.get(e)],[t,this.get(t)])}}const xq={hasNewInfo:()=>!1,merge(){}};class Pq{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xq;(0,Yo.Z)(this,"_taskMerger",void 0),(0,Yo.Z)(this,"_byPeer",void 0),this._taskMerger=e,this._byPeer=new Rq([],Dq.compare)}pushTasks(e,t){let n=this._byPeer.get(e.toString());null==n&&(n=new Dq(e,this._taskMerger)),n.pushTasks(t),this._byPeer.set(e.toString(),n)}popTasks(e){const t=this._head();if(void 0===t)return{tasks:[],pendingSize:0};const{tasks:n,pendingSize:r}=t.popTasks(e);if(0===n.length)return{tasks:n,pendingSize:r};const i=t.peerId;return t.isIdle()?this._byPeer.delete(i.toString()):this._byPeer.update(0),{peerId:i,tasks:n,pendingSize:r}}_head(){if(0!==this._byPeer.size)for(const[,e]of this._byPeer)return e}remove(e,t){const n=this._byPeer.get(t.toString());null===n||void 0===n||n.remove(e)}tasksDone(e,t){const n=this._byPeer.get(e.toString());if(null==n)return;const r=this._byPeer.indexOf(e.toString());for(const i of t)n.taskDone(i);this._byPeer.update(r)}}class Dq{constructor(e,t){(0,Yo.Z)(this,"peerId",void 0),(0,Yo.Z)(this,"_taskMerger",void 0),(0,Yo.Z)(this,"_activeTotalSize",void 0),(0,Yo.Z)(this,"_pending",void 0),(0,Yo.Z)(this,"_active",void 0),this.peerId=e,this._taskMerger=t,this._activeTotalSize=0,this._pending=new Oq,this._active=new Set}pushTasks(e){for(const t of e)this._pushTask(t)}_pushTask(e){if(!this._taskHasMoreInfoThanActiveTasks(e))return;const t=this._pending.get(e.topic);if(null!=t)return e.priority>t.priority&&this._pending.updatePriority(e.topic,e.priority),void this._taskMerger.merge(e,t);this._pending.add(e)}_taskHasMoreInfoThanActiveTasks(e){const t=[];for(const n of this._active)n.topic===e.topic&&t.push(n);return 0===t.length||this._taskMerger.hasNewInfo(e,t)}popTasks(e){let t=0;const n=[],r=this._pending.tasks();for(let i=0;i<r.length&&t<e;i++){const e=r[i];n.push(e),t+=e.size,this._pending.delete(e.topic),this._activeTotalSize+=e.size,this._active.add(e)}return{tasks:n,pendingSize:this._pending.totalSize}}taskDone(e){this._active.has(e)&&(this._activeTotalSize-=e.size,this._active.delete(e))}remove(e){this._pending.delete(e)}isIdle(){return 0===this._pending.length&&0===this._active.size}static compare(e,t){return 0===e[1]._pending.length?1:0===t[1]._pending.length?-1:e[1]._activeTotalSize===t[1]._activeTotalSize?t[1]._pending.length-e[1]._pending.length:e[1]._activeTotalSize-t[1]._activeTotalSize}}class Oq{constructor(){(0,Yo.Z)(this,"_tasks",void 0),this._tasks=new Rq([],this._compare)}get length(){return this._tasks.size}get totalSize(){return[...this._tasks.values()].reduce(((e,t)=>e+t.task.size),0)}get(e){var t,n;return null===(t=this._tasks)||void 0===t||null===(n=t.get(e))||void 0===n?void 0:n.task}add(e){this._tasks.set(e.topic,{created:Date.now(),task:e})}delete(e){this._tasks.delete(e)}tasks(){return[...this._tasks.values()].map((e=>e.task))}updatePriority(e,t){const n=this._tasks.get(e);if(null==n)return;const r=this._tasks.indexOf(e);n.task.priority=t,this._tasks.update(r)}_compare(e,t){return e[1].task.priority===t[1].task.priority?e[1].created-t[1].created:t[1].task.priority-e[1].task.priority}}const Nq={hasNewInfo(e,t){let n=!1,r=!1;for(const i of t)i.data.haveBlock&&(n=!0),i.data.isWantBlock&&(r=!0);return!(r||!e.data.isWantBlock)||!(n||!e.data.haveBlock)},merge(e,t){const n=e.data,r=t.data;!r.haveBlock&&n.haveBlock&&(r.haveBlock=n.haveBlock,r.blockSize=n.blockSize),!r.isWantBlock&&n.isWantBlock&&(r.isWantBlock=!0,r.haveBlock&&!n.haveBlock||(r.haveBlock=n.haveBlock,t.size=e.size)),r.isWantBlock&&r.haveBlock&&(t.size=r.blockSize)}},Bq=_q.WantType;class Lq{constructor(e,t,n,r,i){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};(0,Yo.Z)(this,"_log",void 0),(0,Yo.Z)(this,"blockstore",void 0),(0,Yo.Z)(this,"network",void 0),(0,Yo.Z)(this,"_stats",void 0),(0,Yo.Z)(this,"_opts",void 0),(0,Yo.Z)(this,"ledgerMap",void 0),(0,Yo.Z)(this,"_running",void 0),(0,Yo.Z)(this,"_requestQueue",void 0),this._log=wq(e,"engine"),this.blockstore=t,this.network=n,this._stats=r,this._opts=this._processOpts(o),this.ledgerMap=oq({name:"ipfs_bitswap_ledger_map",metrics:i.metrics}),this._running=!1,this._requestQueue=new Pq(Nq)}_processOpts(e){return{maxSizeReplaceHasWithBlock:1024,targetMessageSize:16384,...e}}_scheduleProcessTasks(){setTimeout((()=>{this._processTasks().catch((e=>{this._log.error("error processing stats",e)}))}))}async _processTasks(){if(!this._running)return;const{peerId:e,tasks:t,pendingSize:n}=this._requestQueue.popTasks(this._opts.targetMessageSize);if(0===t.length)return;const r=new _q(!1);r.setPendingBytes(n);const i=[],o=new Map;for(const c of t){const e=YH.parse(c.topic);c.data.haveBlock?c.data.isWantBlock?(i.push(e),o.set(c.topic,c.data)):r.addHave(e):r.addDontHave(e)}const s=await this._getBlocks(i);for(const[c,l]of o){const e=YH.parse(c),t=s.get(c);null!=t?r.addBlock(e,t):l.sendDontHave&&r.addDontHave(e)}if(r.empty)return null!=e&&this._requestQueue.tasksDone(e,t),void this._scheduleProcessTasks();try{null!=e&&await this.network.sendMessage(e,r);for(const[t,n]of s.entries())null!=e&&this.messageSent(e,YH.parse(t),n)}catch(a){this._log.error(a)}null!=e&&this._requestQueue.tasksDone(e,t),this._scheduleProcessTasks()}wantlistForPeer(e){const t=e.toString(),n=this.ledgerMap.get(t);return null!=n?n.wantlist.sortedEntries():new Map}ledgerForPeer(e){const t=e.toString(),n=this.ledgerMap.get(t);if(null!=n)return{peer:n.partner,value:n.debtRatio(),sent:n.accounting.bytesSent,recv:n.accounting.bytesRecv,exchanged:n.exchangeCount}}peers(){return Array.from(this.ledgerMap.values()).map((e=>e.partner))}receivedBlocks(e){if(0!==e.length){for(const t of this.ledgerMap.values())for(const{cid:n,block:r}of e){const e=t.wantlistContains(n);if(null==e)continue;const i=r.length,o=this._sendAsBlock(e.wantType,i);let s=i;o||(s=_q.blockPresenceSize(e.cid)),this._requestQueue.pushTasks(t.partner,[{topic:e.cid.toString(eH),priority:e.priority,size:s,data:{blockSize:i,isWantBlock:o,haveBlock:!0,sendDontHave:!1}}])}this._scheduleProcessTasks()}}async messageReceived(e,t){const n=this._findOrCreate(e);if(t.empty)return;if(t.full&&(n.wantlist=new Tq),this._updateBlockAccounting(t.blocks,n),0===t.wantlist.size)return void this._scheduleProcessTasks();const r=[],i=[];t.wantlist.forEach((e=>{e.cancel?(n.cancelWant(e.cid),r.push(e.cid)):(n.wants(e.cid,e.priority,e.wantType),i.push(e))})),this._cancelWants(e,r),await this._addWants(e,i),this._scheduleProcessTasks()}_cancelWants(e,t){for(const n of t)this._requestQueue.remove(n.toString(eH),e)}async _addWants(e,t){const n=await this._getBlockSizes(t.map((e=>e.cid))),r=[];for(const i of t){const t=i.cid.toString(eH),o=n.get(t);if(null==o)i.sendDontHave&&r.push({topic:t,priority:i.priority,size:_q.blockPresenceSize(i.cid),data:{isWantBlock:i.wantType===Bq.Block,blockSize:0,haveBlock:!1,sendDontHave:i.sendDontHave}});else{const e=this._sendAsBlock(i.wantType,o);let n=o;e||(n=_q.blockPresenceSize(i.cid)),r.push({topic:t,priority:i.priority,size:n,data:{isWantBlock:e,blockSize:o,haveBlock:!0,sendDontHave:i.sendDontHave}})}this._requestQueue.pushTasks(e,r)}}_sendAsBlock(e,t){return e===Bq.Block||t<=this._opts.maxSizeReplaceHasWithBlock}async _getBlockSizes(e){const t=await this._getBlocks(e);return new Map([...t].map((e=>{let[t,n]=e;return[t,n.length]})))}async _getBlocks(e){const t=new Map;return await Promise.all(e.map((async e=>{try{const n=await this.blockstore.get(e);t.set(e.toString(eH),n)}catch(n){"ERR_NOT_FOUND"!==n.code&&this._log.error("failed to query blockstore for %s: %s",e,n)}}))),t}_updateBlockAccounting(e,t){for(const n of e.values())this._log("got block (%s bytes)",n.length),t.receivedBytes(n.length)}messageSent(e,t,n){const r=this._findOrCreate(e);r.sentBytes(n.length),r.wantlist.remove(t)}numBytesSentTo(e){return this._findOrCreate(e).accounting.bytesSent}numBytesReceivedFrom(e){return this._findOrCreate(e).accounting.bytesRecv}peerDisconnected(e){this.ledgerMap.delete(e.toString())}_findOrCreate(e){const t=e.toString(),n=this.ledgerMap.get(t);if(null!=n)return n;const r=new kq(e);return this.ledgerMap.set(t,r),null!=this._stats&&this._stats.push(t,"peerCount",1),r}start(){this._running=!0}stop(){this._running=!1}}function Mq(e){return null!=e[Symbol.asyncIterator]}const Uq=e=>{const t=Bs.P$(e),n=(0,Us.E)(t);return Bs.cv(e,n),Uq.bytes=t,n};function Fq(e,t){var n,r;const i=null!==(r=(t=null!==(n=t)&&void 0!==n?n:{}).lengthEncoder)&&void 0!==r?r:Uq;function*o(e){const t=i(e.byteLength);t instanceof Uint8Array?yield t:yield*t,e instanceof Uint8Array?yield e:yield*e}return Mq(e)?async function*(){for await(const t of e)yield*o(t)}():function*(){for(const t of e)yield*o(t)}()}Uq.bytes=0,Fq.single=(e,t)=>{var n,r;const i=null!==(r=(t=null!==(n=t)&&void 0!==n?n:{}).lengthEncoder)&&void 0!==r?r:Uq;return new Zs(i(e.byteLength),e)};var Kq;!function(e){e[e.LENGTH=0]="LENGTH",e[e.DATA=1]="DATA"}(Kq||(Kq={}));const jq=e=>{const t=Bs.Jx(e);return jq.bytes=Bs.P$(t),t};function Zq(e,t){var n,r,i;const o=new Zs;let s=Kq.LENGTH,a=-1;const c=null!==(n=null===t||void 0===t?void 0:t.lengthDecoder)&&void 0!==n?n:jq,l=null!==(r=null===t||void 0===t?void 0:t.maxLengthLength)&&void 0!==r?r:8,u=null!==(i=null===t||void 0===t?void 0:t.maxDataLength)&&void 0!==i?i:4194304;function*h(){for(;o.byteLength>0;){if(s===Kq.LENGTH)try{if(a=c(o),a<0)throw Xo()(new Error("invalid message length"),"ERR_INVALID_MSG_LENGTH");if(a>u)throw Xo()(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");const e=c.bytes;o.consume(e),null!=(null===t||void 0===t?void 0:t.onLength)&&t.onLength(a),s=Kq.DATA}catch(e){if(e instanceof RangeError){if(o.byteLength>l)throw Xo()(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG");break}throw e}if(s===Kq.DATA){if(o.byteLength<a)break;const e=o.sublist(0,a);o.consume(a),null!=(null===t||void 0===t?void 0:t.onData)&&t.onData(e),yield e,s=Kq.LENGTH}}}return Mq(e)?async function*(){for await(const t of e)o.append(t),yield*h();if(o.byteLength>0)throw Xo()(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}():function*(){for(const t of e)o.append(t),yield*h();if(o.byteLength>0)throw Xo()(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}()}jq.bytes=0,Zq.fromReader=(e,t)=>{let n=1;return Zq(async function*(){for(;;)try{const{done:t,value:r}=await e.next(n);if(!0===t)return;null!=r&&(yield r)}catch(t){if("ERR_UNDER_READ"===t.code)return{done:!0,value:null};throw t}finally{n=1}}(),{...null!==t&&void 0!==t?t:{},onLength:e=>{n=e}})};const zq=function(e,t){if(null!=e[Symbol.asyncIterator])return async function*(){for await(const n of e)yield t(n)}();const n=pH(e),{value:r,done:i}=n.next();if(!0===i)return function*(){}();const o=t(r);if("function"===typeof o.then)return async function*(){yield await o;for await(const e of n)yield t(e)}();const s=t;return function*(){yield o;for(const e of n)yield s(e)}()};class Vq{constructor(e){if((0,Yo.Z)(this,"buffer",void 0),(0,Yo.Z)(this,"mask",void 0),(0,Yo.Z)(this,"top",void 0),(0,Yo.Z)(this,"btm",void 0),(0,Yo.Z)(this,"next",void 0),!(e>0)||0!==(e-1&e))throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];if(void 0!==e)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return void 0===this.buffer[this.btm]}}class Hq{constructor(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,Yo.Z)(this,"size",void 0),(0,Yo.Z)(this,"hwm",void 0),(0,Yo.Z)(this,"head",void 0),(0,Yo.Z)(this,"tail",void 0),this.hwm=null!==(e=t.splitLimit)&&void 0!==e?e:16,this.head=new Vq(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return null!=(null===e||void 0===e?void 0:e.byteLength)?e.byteLength:1}push(e){if(null!=(null===e||void 0===e?void 0:e.value)&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){const t=this.head;this.head=t.next=new Vq(2*this.head.buffer.length),this.head.push(e)}}shift(){var e;let t=this.tail.shift();if(void 0===t&&null!=this.tail.next){const e=this.tail.next;this.tail.next=null,this.tail=e,t=this.tail.shift()}return null!=(null===(e=t)||void 0===e?void 0:e.value)&&(this.size-=this.calculateSize(t.value)),t}isEmpty(){return this.head.isEmpty()}}class qq extends Error{constructor(e,t){super(null!==e&&void 0!==e?e:"The operation was aborted"),(0,Yo.Z)(this,"type",void 0),(0,Yo.Z)(this,"code",void 0),this.type="aborted",this.code=null!==t&&void 0!==t?t:"ABORT_ERR"}}function Gq(){return Wq((e=>{const t=e.shift();if(null==t)return{done:!0};if(null!=t.error)throw t.error;return{done:!0===t.done,value:t.value}}),arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function Wq(e,t){var n;let r,i,o,s=(t=null!==(n=t)&&void 0!==n?n:{}).onEnd,a=new Hq,c=Ws();const l=e=>null!=i?i(e):(a.push(e),r),u=e=>{var n;if(o)return r;if(!0!==(null===(n=t)||void 0===n?void 0:n.objectMode)&&null==(null===e||void 0===e?void 0:e.byteLength))throw new Error("objectMode was not true but tried to push non-Uint8Array value");return l({done:!1,value:e})},h=e=>o?r:(o=!0,null!=e?(e=>(a=new Hq,null!=i?i({error:e}):(a.push({error:e}),r)))(e):l({done:!0}));if(r={[Symbol.asyncIterator](){return this},next:async()=>{try{return a.isEmpty()?o?{done:!0}:await new Promise(((t,n)=>{i=o=>{i=null,a.push(o);try{t(e(a))}catch(s){n(s)}return r}})):e(a)}finally{a.isEmpty()&&queueMicrotask((()=>{c.resolve(),c=Ws()}))}},return:()=>(a=new Hq,h(),{done:!0}),throw:e=>(h(e),{done:!0}),push:u,end:h,get readableLength(){return a.size},onEmpty:async e=>{const t=null===e||void 0===e?void 0:e.signal;if(null===t||void 0===t||t.throwIfAborted(),a.isEmpty())return;let n,r;null!=t&&(n=new Promise(((e,n)=>{r=()=>{n(new qq)},t.addEventListener("abort",r)})));try{await Promise.race([c.promise,n])}finally{null!=r&&null!=t&&(null===t||void 0===t||t.removeEventListener("abort",r))}}},null==s)return r;const d=r;return r={[Symbol.asyncIterator](){return this},next:()=>d.next(),throw:e=>(d.throw(e),null!=s&&(s(e),s=void 0),{done:!0}),return:()=>(d.return(),null!=s&&(s(),s=void 0),{done:!0}),push:u,end:e=>(d.end(e),null!=s&&(s(e),s=void 0),r),get readableLength(){return d.readableLength},onEmpty:e=>d.onEmpty(e)},r}const Qq=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=[];for(const i of t)null==i[Symbol.asyncIterator]&&r.push(i);return r.length===t.length?function*(){for(const e of r)yield*e}():async function*(){const e=Gq({objectMode:!0});Promise.resolve().then((async()=>{try{await Promise.all(t.map((async t=>{for await(const n of t)e.push(n)}))),e.end()}catch(n){e.end(n)}})),yield*e}()};function Yq(e){if(null==e)throw new Error("Empty pipeline");if(eG(e)){const t=e;e=()=>t.source}else if($q(e)||Xq(e)){const t=e;e=()=>t}for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=[e,...n];if(i.length>1&&eG(i[i.length-1])&&(i[i.length-1]=i[i.length-1].sink),i.length>2)for(let o=1;o<i.length-1;o++)eG(i[o])&&(i[o]=tG(i[o]));return Jq(...i)}const Jq=function(){let e;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(;n.length>0;)e=n.shift()(e);return e},Xq=e=>null!=(null===e||void 0===e?void 0:e[Symbol.asyncIterator]),$q=e=>null!=(null===e||void 0===e?void 0:e[Symbol.iterator]),eG=e=>null!=e&&(null!=e.sink&&null!=e.source),tG=e=>t=>{const n=e.sink(t);if(null!=(null===n||void 0===n?void 0:n.then)){const t=Gq({objectMode:!0});let r;n.then((()=>{t.end()}),(e=>{t.end(e)}));const i=e.source;if(Xq(i))r=async function*(){yield*i,t.end()};else{if(!$q(i))throw new Error("Unknown duplex source type - must be Iterable or AsyncIterable");r=function*(){yield*i,t.end()}}return Qq(t,r())}return e.source};var nG=n(68363);const rG=Math.pow(2,31)-1,iG="/ipfs/bitswap/1.0.0",oG="/ipfs/bitswap/1.1.0",sG="/ipfs/bitswap/1.2.0";class aG{constructor(e,t,n){var r,i,o,s;let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};(0,Yo.Z)(this,"_log",void 0),(0,Yo.Z)(this,"_libp2p",void 0),(0,Yo.Z)(this,"_bitswap",void 0),(0,Yo.Z)(this,"_protocols",void 0),(0,Yo.Z)(this,"_stats",void 0),(0,Yo.Z)(this,"_running",void 0),(0,Yo.Z)(this,"_hashLoader",void 0),(0,Yo.Z)(this,"_maxInboundStreams",void 0),(0,Yo.Z)(this,"_maxOutboundStreams",void 0),(0,Yo.Z)(this,"_incomingStreamTimeout",void 0),(0,Yo.Z)(this,"_registrarIds",void 0),this._log=wq(e.peerId,"network"),this._libp2p=e,this._bitswap=t,this._protocols=[iG],!0!==a.b100Only&&(this._protocols.unshift(oG),this._protocols.unshift(sG)),this._stats=n,this._running=!1,this._onPeerConnect=this._onPeerConnect.bind(this),this._onPeerDisconnect=this._onPeerDisconnect.bind(this),this._onConnection=this._onConnection.bind(this),this._hashLoader=null!==(r=a.hashLoader)&&void 0!==r?r:{async getHasher(){throw new Error("Not implemented")}},this._maxInboundStreams=null!==(i=a.maxInboundStreams)&&void 0!==i?i:1024,this._maxOutboundStreams=null!==(o=a.maxOutboundStreams)&&void 0!==o?o:1024,this._incomingStreamTimeout=null!==(s=a.incomingStreamTimeout)&&void 0!==s?s:3e4}async start(){this._running=!0,await this._libp2p.handle(this._protocols,this._onConnection,{maxInboundStreams:this._maxInboundStreams,maxOutboundStreams:this._maxOutboundStreams});const e={onConnect:this._onPeerConnect,onDisconnect:this._onPeerDisconnect};this._registrarIds=[];for(const t of this._protocols)this._registrarIds.push(await this._libp2p.register(t,e));this._libp2p.getConnections().forEach((e=>{this._onPeerConnect(e.remotePeer)}))}async stop(){if(this._running=!1,await this._libp2p.unhandle(this._protocols),null!=this._registrarIds){for(const e of this._registrarIds)this._libp2p.unregister(e);this._registrarIds=[]}}_onConnection(e){if(!this._running)return;const{stream:t,connection:n}=e,r=new nG.TimeoutController(this._incomingStreamTimeout);Promise.resolve().then((async()=>{this._log("incoming new bitswap %s connection from %p",t.protocol,n.remotePeer);const e=()=>{t.abort(new aq("Incoming Bitswap stream timed out","ERR_TIMEOUT"))};let r=AbortSignal.timeout(this._incomingStreamTimeout);r.addEventListener("abort",e),await Yq(t,(e=>Zq(e)),(async t=>{for await(const o of t){try{const e=await _q.deserialize(o.subarray(),this._hashLoader);await this._bitswap._receiveMessage(n.remotePeer,e)}catch(i){this._bitswap._receiveError(i);break}r.removeEventListener("abort",e),r=AbortSignal.timeout(this._incomingStreamTimeout),r.addEventListener("abort",e)}})),await t.close({signal:r})})).catch((e=>{this._log(e),t.abort(e)})).finally((()=>{r.clear()}))}_onPeerConnect(e){this._bitswap._onPeerConnected(e)}_onPeerDisconnect(e){this._bitswap._onPeerDisconnected(e)}findProviders(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null===(t=n.onProgress)||void 0===t||t.call(n,new AH("bitswap:network:find-providers",e)),this._libp2p.contentRouting.findProviders(e,n)}async findAndConnect(e,t){await fH(yH(zq(this.findProviders(e,t),(async e=>this.connectTo(e.id,t).catch((e=>{this._log.error(e)})))),3)).catch((e=>{this._log.error(e)}))}async provide(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null===(t=n.onProgress)||void 0===t||t.call(n,new AH("bitswap:network:provide",e)),await this._libp2p.contentRouting.provide(e,n)}async sendMessage(e,t){var n;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this._running)throw new Error("network isn't running");const i=e.toString();this._log("sendMessage to %s",i,t),null===(n=r.onProgress)||void 0===n||n.call(r,new AH("bitswap:network:send-wantlist",e)),await this._writeMessage(e,t,r),this._updateSentStats(e,t.blocks)}async connectTo(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this._running)throw new Error("network isn't running");return null===(t=n.onProgress)||void 0===t||t.call(n,new AH("bitswap:network:dial",e)),this._libp2p.dial(e,n)}_updateSentStats(e,t){const n=e.toString();if(null!=this._stats){for(const e of t.values())this._stats.push(n,"dataSent",e.length);this._stats.push(n,"blocksSent",t.size)}}async _writeMessage(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=await this._libp2p.dialProtocol(e,[sG,oG,iG]);try{let e;switch(r.protocol){case iG:e=t.serializeToBitswap100();break;case oG:case sG:e=t.serializeToBitswap110();break;default:throw new Error("Unknown protocol: ".concat(r.protocol))}await Yq([e],(e=>Fq(e)),r),await r.close()}catch(o){var i;null===(i=n.onProgress)||void 0===i||i.call(n,new AH("bitswap:network:send-wantlist:error",{peer:e,error:o})),this._log(o),r.abort(o)}}}var cG=n(47465);const lG=e=>"unwant:".concat((0,Au.B)(e.multihash.bytes,"base64")),uG=e=>"block:".concat((0,Au.B)(e.multihash.bytes,"base64"));class hG extends cG.EventEmitter{constructor(e){super(),(0,Yo.Z)(this,"_log",void 0),this.setMaxListeners(1e3),this._log=wq(e,"notif")}hasBlock(e,t){const n=uG(e);this._log(n),this.emit(n,t)}async wantBlock(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null==e)throw new Error("Not a valid cid");const n=uG(e),r=lG(e);return this._log("wantBlock:".concat(e)),new Promise(((i,o)=>{var s;const a=()=>{var r;this.removeListener(n,c),null===(r=t.onProgress)||void 0===r||r.call(t,new AH("bitswap:want-block:unwant",e)),o(new Error("Block for ".concat(e," unwanted")))},c=n=>{var o;this.removeListener(r,a),null===(o=t.onProgress)||void 0===o||o.call(t,new AH("bitswap:want-block:block",e)),i(n)};this.once(r,a),this.once(n,c),null===(s=t.signal)||void 0===s||s.addEventListener("abort",(()=>{this.removeListener(n,c),this.removeListener(r,a),o(new Error("Want for ".concat(e," aborted")))}))}))}unwantBlock(e){const t=lG(e);this._log(t),this.emit(t)}}var dG=n(56755),fG=n.n(dG);class pG extends cG.EventEmitter{constructor(e,t){super(),(0,Yo.Z)(this,"_options",void 0),(0,Yo.Z)(this,"_queue",void 0),(0,Yo.Z)(this,"_stats",void 0),(0,Yo.Z)(this,"_frequencyLastTime",void 0),(0,Yo.Z)(this,"_frequencyAccumulators",void 0),(0,Yo.Z)(this,"_movingAverages",void 0),(0,Yo.Z)(this,"_enabled",void 0),(0,Yo.Z)(this,"_timeout",void 0),this._options=t,this._queue=[],this._stats={},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this),e.forEach((e=>{this._stats[e]=BigInt(0),this._movingAverages[e]={},this._options.movingAverageIntervals.forEach((t=>{(this._movingAverages[e][t]=fG()(t)).push(this._frequencyLastTime,0)}))})),this._enabled=this._options.enabled}enable(){this._enabled=!0}disable(){this._enabled=!1}stop(){null!=this._timeout&&clearTimeout(this._timeout)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}push(e,t){this._enabled&&(this._queue.push([e,t,Date.now()]),this._resetComputeTimeout())}_resetComputeTimeout(){null!=this._timeout&&clearTimeout(this._timeout),this._timeout=setTimeout(this._update,this._nextTimeout())}_nextTimeout(){const e=this._queue.length/this._options.computeThrottleMaxQueueSize;return Math.max(this._options.computeThrottleTimeout*(1-e),0)}_update(){if(this._timeout=void 0,this._queue.length>0){let e;for(;this._queue.length>0;){const t=e=this._queue.shift();null!=t&&this._applyOp(t)}null!=e&&this._updateFrequency(e[2]),this.emit("update",this._stats)}}_updateFrequency(e){const t=e-this._frequencyLastTime;t>0&&Object.keys(this._stats).forEach((n=>{this._updateFrequencyFor(n,t,e)})),this._frequencyLastTime=e}_updateFrequencyFor(e,t,n){var r;const i=null!==(r=this._frequencyAccumulators[e])&&void 0!==r?r:0;this._frequencyAccumulators[e]=0;const o=i/t*1e3;let s=this._movingAverages[e];null==s&&(s=this._movingAverages[e]={}),this._options.movingAverageIntervals.forEach((e=>{let t=s[e];null==t&&(t=s[e]=fG()(e)),t.push(n,o)}))}_applyOp(e){const t=e[0],n=e[1];if("number"!==typeof n)throw new Error("invalid increment number: ".concat(n));Object.prototype.hasOwnProperty.call(this._stats,t)||(this._stats[t]=BigInt(0)),this._stats[t]=BigInt(this._stats[t])+BigInt(n),null==this._frequencyAccumulators[t]&&(this._frequencyAccumulators[t]=0),this._frequencyAccumulators[t]+=n}}const gG={enabled:!1,computeThrottleTimeout:1e3,computeThrottleMaxQueueSize:1e3,movingAverageIntervals:[6e4,3e5,9e5]};class yG extends cG.EventEmitter{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:gG;super(),(0,Yo.Z)(this,"_initialCounters",void 0),(0,Yo.Z)(this,"_options",void 0),(0,Yo.Z)(this,"_enabled",void 0),(0,Yo.Z)(this,"_global",void 0),(0,Yo.Z)(this,"_peers",void 0);const r=Object.assign({},gG,n);if("number"!==typeof r.computeThrottleTimeout)throw new Error("need computeThrottleTimeout");if("number"!==typeof r.computeThrottleMaxQueueSize)throw new Error("need computeThrottleMaxQueueSize");this._initialCounters=t,this._options=r,this._enabled=this._options.enabled,this._global=new pG(t,r),this._global.on("update",(e=>this.emit("update",e))),this._peers=oq({name:"ipfs_bitswap_stats_peers",metrics:e.metrics})}enable(){this._enabled=!0,this._options.enabled=!0,this._global.enable()}disable(){this._enabled=!1,this._options.enabled=!1,this._global.disable()}stop(){this._enabled=!1,this._global.stop();for(const e of this._peers)e[1].stop()}get snapshot(){return this._global.snapshot}get movingAverages(){return this._global.movingAverages}forPeer(e){const t=e.toString();return this._peers.get(t)}push(e,t,n){if(this._enabled&&(this._global.push(t,n),null!=e)){let r=this._peers.get(e);null==r&&(r=new pG(this._initialCounters,this._options),this._peers.set(e,r)),r.push(t,n)}}disconnected(e){const t=e.toString(),n=this._peers.get(t);null!=n&&(n.stop(),this._peers.delete(t))}}var mG=function(e,t,n){var r=null,i=null,o=function(){r&&(clearTimeout(r),i=null,r=null)},s=function(){if(!t)return e.apply(this,arguments);var s=this,a=arguments,c=n&&!r;return o(),i=function(){e.apply(s,a)},r=setTimeout((function(){if(r=null,!c){var e=i;return i=null,e()}}),t),c?i():void 0};return s.cancel=o,s.flush=function(){var e=i;o(),e&&e()},s};class vG{constructor(e,t,n){(0,Yo.Z)(this,"peerId",void 0),(0,Yo.Z)(this,"refcnt",void 0),(0,Yo.Z)(this,"network",void 0),(0,Yo.Z)(this,"_entries",void 0),(0,Yo.Z)(this,"_log",void 0),this.peerId=t,this.network=n,this.refcnt=1,this._entries=[],this._log=wq(e,"msgqueue"),this.sendEntries=mG(this.sendEntries.bind(this),1)}addMessage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.empty||this.send(e,t)}addEntries(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._entries=this._entries.concat(e),this.sendEntries(t)}sendEntries(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(0===this._entries.length)return;const t=new _q(!1);this._entries.forEach((e=>{!0===e.cancel?t.cancel(e.cid):t.addEntry(e.cid,e.priority)})),this._entries=[],this.addMessage(t,e)}async send(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{await this.network.connectTo(this.peerId,t)}catch(n){return void this._log.error("cant connect to peer %p: %s",this.peerId,n.message)}this._log("sending message to peer %p",this.peerId),this.network.sendMessage(this.peerId,e,t).catch((e=>{this._log.error("send error",e)}))}}class bG{constructor(e,t,n,r){(0,Yo.Z)(this,"peers",void 0),(0,Yo.Z)(this,"wantlist",void 0),(0,Yo.Z)(this,"network",void 0),(0,Yo.Z)(this,"_peerId",void 0),(0,Yo.Z)(this,"_log",void 0),this.peers=oq({name:"ipfs_bitswap_want_manager_peers",metrics:r.metrics}),this.wantlist=new Tq(n,r),this.network=t,this._peerId=e,this._log=wq(e,"want")}_addEntries(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i=e.map(((e,n)=>new _q.Entry(e,rG-n,_q.WantType.Block,t)));i.forEach((e=>{e.cancel?!0===n?this.wantlist.removeForce(e.cid.toString(eH)):this.wantlist.remove(e.cid):(this._log("adding to wantlist"),this.wantlist.add(e.cid,e.priority))}));for(const o of this.peers.values())o.addEntries(i,r)}_startPeerHandler(e){let t=this.peers.get(e.toString());if(null!=t)return void t.refcnt++;t=new vG(this._peerId,e,this.network);const n=new _q(!0);for(const r of this.wantlist.entries())n.addEntry(r[1].cid,r[1].priority);return t.addMessage(n),this.peers.set(e.toString(),t),t}_stopPeerHandler(e){const t=this.peers.get(e.toString());null!=t&&(t.refcnt--,t.refcnt>0||this.peers.delete(e.toString()))}wantBlocks(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._addEntries(e,!1,!1,n),null===(t=n.signal)||void 0===t||t.addEventListener("abort",(()=>{this.cancelWants(e)}))}unwantBlocks(e){this._log("unwant blocks: %s",e.length),this._addEntries(e,!0,!0)}cancelWants(e){this._log("cancel wants: %s",e.length),this._addEntries(e,!0)}connectedPeers(){return Array.from(this.peers.keys())}connected(e){this._startPeerHandler(e)}disconnected(e){this._stopPeerHandler(e)}start(){}stop(){this.peers.forEach((e=>{this.disconnected(e.peerId)}))}}const wG={maxInboundStreams:1024,maxOutboundStreams:1024,incomingStreamTimeout:3e4,hashLoader:{async getHasher(){throw new Error("Not implemented")}},statsEnabled:!1,statsComputeThrottleTimeout:1e3,statsComputeThrottleMaxQueueSize:1e3},EG=["blocksReceived","dataReceived","dupBlksReceived","dupDataReceived","blocksSent","dataSent","providesBufferLength","wantListLength","peerCount"];class AG{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,Yo.Z)(this,"_libp2p",void 0),(0,Yo.Z)(this,"_log",void 0),(0,Yo.Z)(this,"stats",void 0),(0,Yo.Z)(this,"network",void 0),(0,Yo.Z)(this,"blockstore",void 0),(0,Yo.Z)(this,"engine",void 0),(0,Yo.Z)(this,"wm",void 0),(0,Yo.Z)(this,"notifications",void 0),(0,Yo.Z)(this,"started",void 0),this._libp2p=e,this._log=wq(this.peerId),n=Object.assign({},wG,n),this.stats=new yG(e,EG,{enabled:n.statsEnabled,computeThrottleTimeout:n.statsComputeThrottleTimeout,computeThrottleMaxQueueSize:n.statsComputeThrottleMaxQueueSize}),this.network=new aG(e,this,this.stats,{hashLoader:n.hashLoader,maxInboundStreams:n.maxInboundStreams,maxOutboundStreams:n.maxOutboundStreams,incomingStreamTimeout:n.incomingStreamTimeout}),this.blockstore=t,this.engine=new Lq(this.peerId,t,this.network,this.stats,e),this.wm=new bG(this.peerId,this.network,this.stats,e),this.notifications=new hG(this.peerId),this.started=!1}isStarted(){return this.started}get peerId(){return this._libp2p.peerId}async _receiveMessage(e,t){try{await this.engine.messageReceived(e,t)}catch(r){this._log("failed to receive message",t)}if(0===t.blocks.size)return;const n=[];for(const[i,o]of t.blocks.entries()){const e=YH.parse(i);n.push({wasWanted:this.wm.wantlist.contains(e),cid:e,data:o})}this.wm.cancelWants(n.filter((e=>{let{wasWanted:t}=e;return t})).map((e=>{let{cid:t}=e;return t}))),await Promise.all(n.map((async t=>{let{cid:n,wasWanted:r,data:i}=t;await this._handleReceivedBlock(e,n,i,r)})))}async _handleReceivedBlock(e,t,n,r){this._log("received block");const i=await this.blockstore.has(t);this._updateReceiveCounters(e.toString(),t,n,i),r&&await this.put(t,n)}_updateReceiveCounters(e,t,n,r){this.stats.push(e,"blocksReceived",1),this.stats.push(e,"dataReceived",n.length),r&&(this.stats.push(e,"dupBlksReceived",1),this.stats.push(e,"dupDataReceived",n.length))}_receiveError(e){this._log.error("ReceiveError",e)}_onPeerConnected(e){this.wm.connected(e)}_onPeerDisconnected(e){this.wm.disconnected(e),this.engine.peerDisconnected(e),this.stats.disconnected(e)}enableStats(){this.stats.enable()}disableStats(){this.stats.disable()}wantlistForPeer(e,t){return this.engine.wantlistForPeer(e)}ledgerForPeer(e){return this.engine.ledgerForPeer(e)}async want(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=async(e,t)=>(this.wm.wantBlocks([e],t),this.notifications.wantBlock(e,t));let r=!1;const i=async(e,t)=>{try{return await this.blockstore.get(e,t)}catch(i){if("ERR_NOT_FOUND"!==i.code)throw i;return r||(r=!0,this.network.findAndConnect(e,t).catch((e=>{this._log.error(e)}))),await n(e,t)}},o=new AbortController,s=SH([o.signal,t.signal]);try{return await Promise.race([this.notifications.wantBlock(e,{...t,signal:s}),i(e,{...t,signal:s})])}finally{o.abort(),s.clear()}}unwant(e){const t=Array.isArray(e)?e:[e];this.wm.unwantBlocks(t),t.forEach((e=>{this.notifications.unwantBlock(e)}))}cancelWants(e){this.wm.cancelWants(Array.isArray(e)?e:[e])}async put(e,t,n){await this.blockstore.put(e,t),this.notify(e,t)}async*putMany(e,t){yield*this.blockstore.putMany(jd(e,(e=>{let{cid:t,block:n}=e;this.notify(t,n)})),t)}notify(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.notifications.hasBlock(e,t),this.engine.receivedBlocks([{cid:e,block:t}]),this.network.provide(e,n).catch((e=>{this._log.error("Failed to provide: %s",e.message)}))}getWantlist(){return this.wm.wantlist.entries()}get peers(){return this.engine.peers()}async start(){this.wm.start(),await this.network.start(),this.engine.start(),this.started=!0}async stop(){this.stats.stop(),this.wm.stop(),await this.network.stop(),this.engine.stop(),this.started=!1}}class SG{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,Yo.Z)(this,"bitswap",void 0),(0,Yo.Z)(this,"started",void 0);const{libp2p:n,blockstore:r,hashers:i}=e;this.bitswap=function(e,t){return new AG(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})}(n,r,{hashLoader:{getHasher:async e=>{const t=i.find((t=>t.code===e||t.name===e));if(null!=t)return t;throw new Error('Could not load hasher for code/name "'.concat(e,'"'))}},...t}),this.started=!1}isStarted(){return this.started}async start(){await this.bitswap.start(),this.started=!0}async stop(){await this.bitswap.stop(),this.started=!1}announce(e,t,n){this.bitswap.notify(e,t,n)}async retrieve(e){let{validateFn:t,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.bitswap.want(e,n)}}function _G(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>new SG(t,e)}var IG=n(63914);function CG(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,(0,IG.Z)(e,t,"set"),n),n}var TG=new WeakMap,kG=new WeakMap,RG=new WeakMap,xG=new WeakMap;class PG{constructor(e){(0,Yo.Z)(this,"url",void 0),(0,dx.Z)(this,TG,{writable:!0,value:0}),(0,dx.Z)(this,kG,{writable:!0,value:0}),(0,dx.Z)(this,RG,{writable:!0,value:0}),(0,dx.Z)(this,xG,{writable:!0,value:0}),this.url=e instanceof URL?e:new URL(e)}async getRawBlock(e,t){const n=this.url;if(n.pathname="/ipfs/".concat(e.toString()),n.search="?format=raw",!0===(null===t||void 0===t?void 0:t.aborted))throw new Error("Signal to fetch raw block for CID ".concat(e," from gateway ").concat(this.url," was aborted prior to fetch"));try{var r,i;CG(this,TG,(r=(0,fx.Z)(this,TG),r++,r));const s=await fetch(n.toString(),{signal:t,headers:{Accept:"application/vnd.ipld.raw"},cache:"force-cache"});var o;if(!s.ok)throw CG(this,kG,(o=(0,fx.Z)(this,kG),o++,o)),new Error("unable to fetch raw block for CID ".concat(e," from gateway ").concat(this.url));return CG(this,xG,(i=(0,fx.Z)(this,xG),i++,i)),new Uint8Array(await s.arrayBuffer())}catch(a){var s;if(!0===(null===t||void 0===t?void 0:t.aborted))throw new Error("fetching raw block for CID ".concat(e," from gateway ").concat(this.url," was aborted"));throw CG(this,kG,(s=(0,fx.Z)(this,kG),s++,s)),new Error("unable to fetch raw block for CID ".concat(e))}}reliability(){return 0===(0,fx.Z)(this,TG)?1:(0,fx.Z)(this,RG)>0?-1/0:(0,fx.Z)(this,xG)/((0,fx.Z)(this,TG)+3*(0,fx.Z)(this,kG))}incrementInvalidBlocks(){var e;CG(this,RG,(e=(0,fx.Z)(this,RG),e++,e))}}const DG=aH("helia:trustless-gateway-block-broker");class OG{constructor(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,Yo.Z)(this,"gateways",void 0),this.gateways=(null!==(e=t.gateways)&&void 0!==e?e:NG).map((e=>new PG(e)))}async retrieve(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=this.gateways.sort(((e,t)=>t.reliability()-e.reliability())),r=[];for(const a of n){DG("getting block for %c from %s",e,a.url);try{const n=await a.getRawBlock(e,t.signal);DG.trace("got block for %c from %s",e,a.url);try{var i;await(null===(i=t.validateFn)||void 0===i?void 0:i.call(t,n))}catch(s){throw DG.error("failed to validate block for %c from %s",e,a.url,s),a.incrementInvalidBlocks(),new Error("unable to validate block for CID ".concat(e," from gateway ").concat(a.url))}return n}catch(s){var o;if(DG.error("failed to get block for %c from %s",e,a.url,s),s instanceof Error?r.push(s):r.push(new Error("unable to fetch raw block for CID ".concat(e," from gateway ").concat(a.url))),!0===(null===(o=t.signal)||void 0===o?void 0:o.aborted)){DG.trace("request aborted while fetching raw block for CID %c from gateway %s",e,a.url);break}}}throw new AggregateError(r,"unable to fetch raw block for CID ".concat(e," from any gateway"))}}const NG=["https://dweb.link","https://cf-ipfs.com","https://4everland.io","https://w3s.link"];function BG(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return()=>new OG(e)}const LG=["string","number","bigint","symbol"],MG=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function UG(e){if(null===e)return"null";if(void 0===e)return"undefined";if(!0===e||!1===e)return"boolean";const t=typeof e;if(LG.includes(t))return t;if("function"===t)return"Function";if(Array.isArray(e))return"Array";if(function(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}(e))return"Buffer";const n=function(e){const t=Object.prototype.toString.call(e).slice(8,-1);if(MG.includes(t))return t;return}(e);return n||"Object"}class FG{constructor(e,t,n){this.major=e,this.majorEncoded=e<<5,this.name=t,this.terminal=n}toString(){return"Type[".concat(this.major,"].").concat(this.name)}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}}FG.uint=new FG(0,"uint",!0),FG.negint=new FG(1,"negint",!0),FG.bytes=new FG(2,"bytes",!0),FG.string=new FG(3,"string",!0),FG.array=new FG(4,"array",!1),FG.map=new FG(5,"map",!1),FG.tag=new FG(6,"tag",!1),FG.float=new FG(7,"float",!0),FG.false=new FG(7,"false",!0),FG.true=new FG(7,"true",!0),FG.null=new FG(7,"null",!0),FG.undefined=new FG(7,"undefined",!0),FG.break=new FG(7,"break",!0);class KG{constructor(e,t,n){this.type=e,this.value=t,this.encodedLength=n,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return"Token[".concat(this.type,"].").concat(this.value)}}const jG=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&"function"===typeof globalThis.Buffer.isBuffer,ZG=new TextDecoder,zG=new TextEncoder;function VG(e){return jG&&globalThis.Buffer.isBuffer(e)}function HG(e){return e instanceof Uint8Array?VG(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e:Uint8Array.from(e)}const qG=jG?(e,t,n)=>n-t>64?globalThis.Buffer.from(e.subarray(t,n)).toString("utf8"):$G(e,t,n):(e,t,n)=>n-t>64?ZG.decode(e.subarray(t,n)):$G(e,t,n),GG=jG?e=>e.length>64?globalThis.Buffer.from(e):XG(e):e=>e.length>64?zG.encode(e):XG(e),WG=e=>Uint8Array.from(e),QG=jG?(e,t,n)=>VG(e)?new Uint8Array(e.subarray(t,n)):e.slice(t,n):(e,t,n)=>e.slice(t,n),YG=jG?(e,t)=>(e=e.map((e=>e instanceof Uint8Array?e:globalThis.Buffer.from(e))),HG(globalThis.Buffer.concat(e,t))):(e,t)=>{const n=new Uint8Array(t);let r=0;for(let i of e)r+i.length>n.length&&(i=i.subarray(0,n.length-r)),n.set(i,r),r+=i.length;return n},JG=jG?e=>globalThis.Buffer.allocUnsafe(e):e=>new Uint8Array(e);function XG(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t}function $G(e,t,n){const r=[];for(;t<n;){const i=e[t];let o=null,s=i>239?4:i>223?3:i>191?2:1;if(t+s<=n){let n,r,a,c;switch(s){case 1:i<128&&(o=i);break;case 2:n=e[t+1],128===(192&n)&&(c=(31&i)<<6|63&n,c>127&&(o=c));break;case 3:n=e[t+1],r=e[t+2],128===(192&n)&&128===(192&r)&&(c=(15&i)<<12|(63&n)<<6|63&r,c>2047&&(c<55296||c>57343)&&(o=c));break;case 4:n=e[t+1],r=e[t+2],a=e[t+3],128===(192&n)&&128===(192&r)&&128===(192&a)&&(c=(15&i)<<18|(63&n)<<12|(63&r)<<6|63&a,c>65535&&c<1114112&&(o=c))}}null===o?(o=65533,s=1):o>65535&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|1023&o),r.push(o),t+=s}return tW(r)}const eW=4096;function tW(e){const t=e.length;if(t<=eW)return String.fromCharCode.apply(String,e);let n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=eW));return n}class nW{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:256;this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),null!==this._initReuseChunk&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let t=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){const n=t.length-(this.maxCursor-this.cursor)-1;t.set(e,n)}else{if(t){const e=t.length-(this.maxCursor-this.cursor)-1;e<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,e),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(t=JG(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,null===this._initReuseChunk&&(this._initReuseChunk=t),t.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(){let e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(1===this.chunks.length){const n=this.chunks[0];t&&this.cursor>n.length/2?(e=this.cursor===n.length?n:n.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):e=QG(n,0,this.cursor)}else e=YG(this.chunks,this.cursor);return t&&this.reset(),e}}const rW="CBOR decode error:",iW="CBOR encode error:",oW=[];function sW(e,t,n){if(e.length-t<n)throw new Error("".concat(rW," not enough data for type"))}oW[23]=1,oW[24]=2,oW[25]=3,oW[26]=5,oW[27]=9;const aW=[24,256,65536,4294967296,BigInt("18446744073709551616")];function cW(e,t,n){sW(e,t,1);const r=e[t];if(!0===n.strict&&r<aW[0])throw new Error("".concat(rW," integer encoded in more bytes than necessary (strict decode)"));return r}function lW(e,t,n){sW(e,t,2);const r=e[t]<<8|e[t+1];if(!0===n.strict&&r<aW[1])throw new Error("".concat(rW," integer encoded in more bytes than necessary (strict decode)"));return r}function uW(e,t,n){sW(e,t,4);const r=16777216*e[t]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];if(!0===n.strict&&r<aW[2])throw new Error("".concat(rW," integer encoded in more bytes than necessary (strict decode)"));return r}function hW(e,t,n){sW(e,t,8);const r=16777216*e[t]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3],i=16777216*e[t+4]+(e[t+5]<<16)+(e[t+6]<<8)+e[t+7],o=(BigInt(r)<<BigInt(32))+BigInt(i);if(!0===n.strict&&o<aW[3])throw new Error("".concat(rW," integer encoded in more bytes than necessary (strict decode)"));if(o<=Number.MAX_SAFE_INTEGER)return Number(o);if(!0===n.allowBigInt)return o;throw new Error("".concat(rW," integers outside of the safe integer range are not supported"))}function dW(e,t){return fW(e,0,t.value)}function fW(e,t,n){if(n<aW[0]){const r=Number(n);e.push([t|r])}else if(n<aW[1]){const r=Number(n);e.push([24|t,r])}else if(n<aW[2]){const r=Number(n);e.push([25|t,r>>>8,255&r])}else if(n<aW[3]){const r=Number(n);e.push([26|t,r>>>24&255,r>>>16&255,r>>>8&255,255&r])}else{const r=BigInt(n);if(!(r<aW[4]))throw new Error("".concat(rW," encountered BigInt larger than allowable range"));{const n=[27|t,0,0,0,0,0,0,0];let i=Number(r&BigInt(4294967295)),o=Number(r>>BigInt(32)&BigInt(4294967295));n[8]=255&i,i>>=8,n[7]=255&i,i>>=8,n[6]=255&i,i>>=8,n[5]=255&i,n[4]=255&o,o>>=8,n[3]=255&o,o>>=8,n[2]=255&o,o>>=8,n[1]=255&o,e.push(n)}}}dW.encodedSize=function(e){return fW.encodedSize(e.value)},fW.encodedSize=function(e){return e<aW[0]?1:e<aW[1]?2:e<aW[2]?3:e<aW[3]?5:9},dW.compareTokens=function(e,t){return e.value<t.value?-1:e.value>t.value?1:0};const pW=BigInt(-1),gW=BigInt(1);function yW(e,t){const n=t.value,r="bigint"===typeof n?n*pW-gW:-1*n-1;fW(e,t.type.majorEncoded,r)}function mW(e,t,n,r){sW(e,t,n+r);const i=QG(e,t+n,t+n+r);return new KG(FG.bytes,i,n+r)}function vW(e,t,n,r){return mW(e,t,1,n)}function bW(e){return void 0===e.encodedBytes&&(e.encodedBytes=e.type===FG.string?GG(e.value):e.value),e.encodedBytes}function wW(e,t){const n=bW(t);fW(e,t.type.majorEncoded,n.length),e.push(n)}function EW(e,t,n,r,i){const o=n+r;sW(e,t,o);const s=new KG(FG.string,qG(e,t+n,t+o),o);return!0===i.retainStringBytes&&(s.byteValue=QG(e,t+n,t+o)),s}function AW(e,t,n,r){return EW(e,t,1,n,r)}yW.encodedSize=function(e){const t=e.value,n="bigint"===typeof t?t*pW-gW:-1*t-1;return n<aW[0]?1:n<aW[1]?2:n<aW[2]?3:n<aW[3]?5:9},yW.compareTokens=function(e,t){return e.value<t.value?1:e.value>t.value?-1:0},wW.encodedSize=function(e){const t=bW(e);return fW.encodedSize(t.length)+t.length},wW.compareTokens=function(e,t){return n=bW(e),r=bW(t),n.length<r.length?-1:n.length>r.length?1:function(e,t){if(VG(e)&&VG(t))return e.compare(t);for(let n=0;n<e.length;n++)if(e[n]!==t[n])return e[n]<t[n]?-1:1;return 0}(n,r);var n,r};const SW=wW;function _W(e,t,n,r){return new KG(FG.array,r,n)}function IW(e,t,n,r){return _W(0,0,1,n)}function CW(e,t){fW(e,FG.array.majorEncoded,t.value)}function TW(e,t,n,r){return new KG(FG.map,r,n)}function kW(e,t,n,r){return TW(0,0,1,n)}function RW(e,t){fW(e,FG.map.majorEncoded,t.value)}function xW(e,t,n,r){return new KG(FG.tag,n,1)}function PW(e,t){fW(e,FG.tag.majorEncoded,t.value)}CW.compareTokens=dW.compareTokens,CW.encodedSize=function(e){return fW.encodedSize(e.value)},RW.compareTokens=dW.compareTokens,RW.encodedSize=function(e){return fW.encodedSize(e.value)},PW.compareTokens=dW.compareTokens,PW.encodedSize=function(e){return fW.encodedSize(e.value)};const DW=20,OW=21,NW=22,BW=23;function LW(e,t,n){if(n){if(!1===n.allowNaN&&Number.isNaN(e))throw new Error("".concat(rW," NaN values are not supported"));if(!1===n.allowInfinity&&(e===1/0||e===-1/0))throw new Error("".concat(rW," Infinity values are not supported"))}return new KG(FG.float,e,t)}function MW(e,t,n){const r=t.value;if(!1===r)e.push([FG.float.majorEncoded|DW]);else if(!0===r)e.push([FG.float.majorEncoded|OW]);else if(null===r)e.push([FG.float.majorEncoded|NW]);else if(void 0===r)e.push([FG.float.majorEncoded|BW]);else{let t,o=!1;n&&!0===n.float64||(jW(r),t=ZW(KW,1),r===t||Number.isNaN(r)?(KW[0]=249,e.push(KW.slice(0,3)),o=!0):(zW(r),t=VW(KW,1),r===t&&(KW[0]=250,e.push(KW.slice(0,5)),o=!0))),o||(i=r,FW.setFloat64(0,i,!1),t=HW(KW,1),KW[0]=251,e.push(KW.slice(0,9)))}var i}MW.encodedSize=function(e,t){const n=e.value;if(!1===n||!0===n||null===n||void 0===n)return 1;if(!t||!0!==t.float64){jW(n);let e=ZW(KW,1);if(n===e||Number.isNaN(n))return 3;if(zW(n),e=VW(KW,1),n===e)return 5}return 9};const UW=new ArrayBuffer(9),FW=new DataView(UW,1),KW=new Uint8Array(UW,0);function jW(e){if(e===1/0)FW.setUint16(0,31744,!1);else if(e===-1/0)FW.setUint16(0,64512,!1);else if(Number.isNaN(e))FW.setUint16(0,32256,!1);else{FW.setFloat32(0,e);const t=FW.getUint32(0),n=(2139095040&t)>>23,r=8388607&t;if(255===n)FW.setUint16(0,31744,!1);else if(0===n)FW.setUint16(0,(2147483648&e)>>16|r>>13,!1);else{const e=n-127;e<-24?FW.setUint16(0,0):e<-14?FW.setUint16(0,(2147483648&t)>>16|1<<24+e,!1):FW.setUint16(0,(2147483648&t)>>16|e+15<<10|r>>13,!1)}}}function ZW(e,t){if(e.length-t<2)throw new Error("".concat(rW," not enough data for float16"));const n=(e[t]<<8)+e[t+1];if(31744===n)return 1/0;if(64512===n)return-1/0;if(32256===n)return NaN;const r=n>>10&31,i=1023&n;let o;return o=0===r?i*2**-24:31!==r?(i+1024)*2**(r-25):0===i?1/0:NaN,32768&n?-o:o}function zW(e){FW.setFloat32(0,e,!1)}function VW(e,t){if(e.length-t<4)throw new Error("".concat(rW," not enough data for float32"));const n=(e.byteOffset||0)+t;return new DataView(e.buffer,n,4).getFloat32(0,!1)}function HW(e,t){if(e.length-t<8)throw new Error("".concat(rW," not enough data for float64"));const n=(e.byteOffset||0)+t;return new DataView(e.buffer,n,8).getFloat64(0,!1)}function qW(e,t,n){throw new Error("".concat(rW," encountered invalid minor (").concat(n,") for major ").concat(e[t]>>>5))}function GW(e){return()=>{throw new Error("".concat(rW," ").concat(e))}}MW.compareTokens=dW.compareTokens;const WW=[];for(let Ige=0;Ige<=23;Ige++)WW[Ige]=qW;WW[24]=function(e,t,n,r){return new KG(FG.uint,cW(e,t+1,r),2)},WW[25]=function(e,t,n,r){return new KG(FG.uint,lW(e,t+1,r),3)},WW[26]=function(e,t,n,r){return new KG(FG.uint,uW(e,t+1,r),5)},WW[27]=function(e,t,n,r){return new KG(FG.uint,hW(e,t+1,r),9)},WW[28]=qW,WW[29]=qW,WW[30]=qW,WW[31]=qW;for(let Ige=32;Ige<=55;Ige++)WW[Ige]=qW;WW[56]=function(e,t,n,r){return new KG(FG.negint,-1-cW(e,t+1,r),2)},WW[57]=function(e,t,n,r){return new KG(FG.negint,-1-lW(e,t+1,r),3)},WW[58]=function(e,t,n,r){return new KG(FG.negint,-1-uW(e,t+1,r),5)},WW[59]=function(e,t,n,r){const i=hW(e,t+1,r);if("bigint"!==typeof i){const e=-1-i;if(e>=Number.MIN_SAFE_INTEGER)return new KG(FG.negint,e,9)}if(!0!==r.allowBigInt)throw new Error("".concat(rW," integers outside of the safe integer range are not supported"));return new KG(FG.negint,pW-BigInt(i),9)},WW[60]=qW,WW[61]=qW,WW[62]=qW,WW[63]=qW;for(let Ige=64;Ige<=87;Ige++)WW[Ige]=vW;WW[88]=function(e,t,n,r){return mW(e,t,2,cW(e,t+1,r))},WW[89]=function(e,t,n,r){return mW(e,t,3,lW(e,t+1,r))},WW[90]=function(e,t,n,r){return mW(e,t,5,uW(e,t+1,r))},WW[91]=function(e,t,n,r){const i=hW(e,t+1,r);if("bigint"===typeof i)throw new Error("".concat(rW," 64-bit integer bytes lengths not supported"));return mW(e,t,9,i)},WW[92]=qW,WW[93]=qW,WW[94]=qW,WW[95]=GW("indefinite length bytes/strings are not supported");for(let Ige=96;Ige<=119;Ige++)WW[Ige]=AW;WW[120]=function(e,t,n,r){return EW(e,t,2,cW(e,t+1,r),r)},WW[121]=function(e,t,n,r){return EW(e,t,3,lW(e,t+1,r),r)},WW[122]=function(e,t,n,r){return EW(e,t,5,uW(e,t+1,r),r)},WW[123]=function(e,t,n,r){const i=hW(e,t+1,r);if("bigint"===typeof i)throw new Error("".concat(rW," 64-bit integer string lengths not supported"));return EW(e,t,9,i,r)},WW[124]=qW,WW[125]=qW,WW[126]=qW,WW[127]=GW("indefinite length bytes/strings are not supported");for(let Ige=128;Ige<=151;Ige++)WW[Ige]=IW;WW[152]=function(e,t,n,r){return _W(0,0,2,cW(e,t+1,r))},WW[153]=function(e,t,n,r){return _W(0,0,3,lW(e,t+1,r))},WW[154]=function(e,t,n,r){return _W(0,0,5,uW(e,t+1,r))},WW[155]=function(e,t,n,r){const i=hW(e,t+1,r);if("bigint"===typeof i)throw new Error("".concat(rW," 64-bit integer array lengths not supported"));return _W(0,0,9,i)},WW[156]=qW,WW[157]=qW,WW[158]=qW,WW[159]=function(e,t,n,r){if(!1===r.allowIndefinite)throw new Error("".concat(rW," indefinite length items not allowed"));return _W(0,0,1,1/0)};for(let Ige=160;Ige<=183;Ige++)WW[Ige]=kW;WW[184]=function(e,t,n,r){return TW(0,0,2,cW(e,t+1,r))},WW[185]=function(e,t,n,r){return TW(0,0,3,lW(e,t+1,r))},WW[186]=function(e,t,n,r){return TW(0,0,5,uW(e,t+1,r))},WW[187]=function(e,t,n,r){const i=hW(e,t+1,r);if("bigint"===typeof i)throw new Error("".concat(rW," 64-bit integer map lengths not supported"));return TW(0,0,9,i)},WW[188]=qW,WW[189]=qW,WW[190]=qW,WW[191]=function(e,t,n,r){if(!1===r.allowIndefinite)throw new Error("".concat(rW," indefinite length items not allowed"));return TW(0,0,1,1/0)};for(let Ige=192;Ige<=215;Ige++)WW[Ige]=xW;WW[216]=function(e,t,n,r){return new KG(FG.tag,cW(e,t+1,r),2)},WW[217]=function(e,t,n,r){return new KG(FG.tag,lW(e,t+1,r),3)},WW[218]=function(e,t,n,r){return new KG(FG.tag,uW(e,t+1,r),5)},WW[219]=function(e,t,n,r){return new KG(FG.tag,hW(e,t+1,r),9)},WW[220]=qW,WW[221]=qW,WW[222]=qW,WW[223]=qW;for(let Ige=224;Ige<=243;Ige++)WW[Ige]=GW("simple values are not supported");WW[244]=qW,WW[245]=qW,WW[246]=qW,WW[247]=function(e,t,n,r){if(!1===r.allowUndefined)throw new Error("".concat(rW," undefined values are not supported"));return!0===r.coerceUndefinedToNull?new KG(FG.null,null,1):new KG(FG.undefined,void 0,1)},WW[248]=GW("simple values are not supported"),WW[249]=function(e,t,n,r){return LW(ZW(e,t+1),3,r)},WW[250]=function(e,t,n,r){return LW(VW(e,t+1),5,r)},WW[251]=function(e,t,n,r){return LW(HW(e,t+1),9,r)},WW[252]=qW,WW[253]=qW,WW[254]=qW,WW[255]=function(e,t,n,r){if(!1===r.allowIndefinite)throw new Error("".concat(rW," indefinite length items not allowed"));return new KG(FG.break,void 0,1)};const QW=[];for(let Ige=0;Ige<24;Ige++)QW[Ige]=new KG(FG.uint,Ige,1);for(let Ige=-1;Ige>=-24;Ige--)QW[31-Ige]=new KG(FG.negint,Ige,1);QW[64]=new KG(FG.bytes,new Uint8Array(0),1),QW[96]=new KG(FG.string,"",1),QW[128]=new KG(FG.array,0,1),QW[160]=new KG(FG.map,0,1),QW[244]=new KG(FG.false,!1,1),QW[245]=new KG(FG.true,!0,1),QW[246]=new KG(FG.null,null,1);const YW={float64:!1,mapSorter:function(e,t){const n=Array.isArray(e[0])?e[0][0]:e[0],r=Array.isArray(t[0])?t[0][0]:t[0];if(n.type!==r.type)return n.type.compare(r.type);const i=n.type.major,o=JW[i].compareTokens(n,r);0===o&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone");return o},quickEncodeToken:function(e){switch(e.type){case FG.false:return WG([244]);case FG.true:return WG([245]);case FG.null:return WG([246]);case FG.bytes:return e.value.length?void 0:WG([64]);case FG.string:return""===e.value?WG([96]):void 0;case FG.array:return 0===e.value?WG([128]):void 0;case FG.map:return 0===e.value?WG([160]):void 0;case FG.uint:return e.value<24?WG([Number(e.value)]):void 0;case FG.negint:if(e.value>=-24)return WG([31-Number(e.value)])}}};const JW=function(){const e=[];return e[FG.uint.major]=dW,e[FG.negint.major]=yW,e[FG.bytes.major]=wW,e[FG.string.major]=SW,e[FG.array.major]=CW,e[FG.map.major]=RW,e[FG.tag.major]=PW,e[FG.float.major]=MW,e}(),XW=new nW;class $W{constructor(e,t){this.obj=e,this.parent=t}includes(e){let t=this;do{if(t.obj===e)return!0}while(t=t.parent);return!1}static createCheck(e,t){if(e&&e.includes(t))throw new Error("".concat(iW," object contains circular references"));return new $W(t,e)}}const eQ={null:new KG(FG.null,null),undefined:new KG(FG.undefined,void 0),true:new KG(FG.true,!0),false:new KG(FG.false,!1),emptyArray:new KG(FG.array,0),emptyMap:new KG(FG.map,0)},tQ={number:(e,t,n,r)=>Number.isInteger(e)&&Number.isSafeInteger(e)?new KG(e>=0?FG.uint:FG.negint,e):new KG(FG.float,e),bigint:(e,t,n,r)=>e>=BigInt(0)?new KG(FG.uint,e):new KG(FG.negint,e),Uint8Array:(e,t,n,r)=>new KG(FG.bytes,e),string:(e,t,n,r)=>new KG(FG.string,e),boolean:(e,t,n,r)=>e?eQ.true:eQ.false,null:(e,t,n,r)=>eQ.null,undefined:(e,t,n,r)=>eQ.undefined,ArrayBuffer:(e,t,n,r)=>new KG(FG.bytes,new Uint8Array(e)),DataView:(e,t,n,r)=>new KG(FG.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),Array(e,t,n,r){if(!e.length)return!0===n.addBreakTokens?[eQ.emptyArray,new KG(FG.break)]:eQ.emptyArray;r=$W.createCheck(r,e);const i=[];let o=0;for(const s of e)i[o++]=nQ(s,n,r);return n.addBreakTokens?[new KG(FG.array,e.length),i,new KG(FG.break)]:[new KG(FG.array,e.length),i]},Object(e,t,n,r){const i="Object"!==t,o=i?e.keys():Object.keys(e),s=i?e.size:o.length;if(!s)return!0===n.addBreakTokens?[eQ.emptyMap,new KG(FG.break)]:eQ.emptyMap;r=$W.createCheck(r,e);const a=[];let c=0;for(const l of o)a[c++]=[nQ(l,n,r),nQ(i?e.get(l):e[l],n,r)];return function(e,t){t.mapSorter&&e.sort(t.mapSorter)}(a,n),n.addBreakTokens?[new KG(FG.map,s),a,new KG(FG.break)]:[new KG(FG.map,s),a]}};tQ.Map=tQ.Object,tQ.Buffer=tQ.Uint8Array;for(const Ige of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))tQ["".concat(Ige,"Array")]=tQ.DataView;function nQ(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const r=UG(e),i=t&&t.typeEncoders&&t.typeEncoders[r]||tQ[r];if("function"===typeof i){const o=i(e,r,t,n);if(null!=o)return o}const o=tQ[r];if(!o)throw new Error("".concat(iW," unsupported type: ").concat(r));return o(e,r,t,n)}function rQ(e,t,n,r){if(Array.isArray(t))for(const i of t)rQ(e,i,n,r);else n[t.type.major](e,t,r)}function iQ(e,t,n){const r=nQ(e,n);if(!Array.isArray(r)&&n.quickEncodeToken){const e=n.quickEncodeToken(r);if(e)return e;const i=t[r.type.major];if(i.encodedSize){const e=i.encodedSize(r,n),t=new nW(e);if(i(t,r,n),1!==t.chunks.length)throw new Error("Unexpected error: pre-calculated length for ".concat(r," was wrong"));return HG(t.chunks[0])}}return XW.reset(),rQ(XW,r,t,n),XW.toBytes(!0)}function oQ(e,t){return t=Object.assign({},YW,t),iQ(e,JW,t)}const sQ={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class aQ{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._pos=0,this.data=e,this.options=t}pos(){return this._pos}done(){return this._pos>=this.data.length}next(){const e=this.data[this._pos];let t=QW[e];if(void 0===t){const n=WW[e];if(!n)throw new Error("".concat(rW," no decoder for major type ").concat(e>>>5," (byte 0x").concat(e.toString(16).padStart(2,"0"),")"));const r=31&e;t=n(this.data,this._pos,r,this.options)}return this._pos+=t.encodedLength,t}}const cQ=Symbol.for("DONE"),lQ=Symbol.for("BREAK");function uQ(e,t){if(e.done())return cQ;const n=e.next();if(n.type===FG.break)return lQ;if(n.type.terminal)return n.value;if(n.type===FG.array)return function(e,t,n){const r=[];for(let i=0;i<e.value;i++){const o=uQ(t,n);if(o===lQ){if(e.value===1/0)break;throw new Error("".concat(rW," got unexpected break to lengthed array"))}if(o===cQ)throw new Error("".concat(rW," found array but not enough entries (got ").concat(i,", expected ").concat(e.value,")"));r[i]=o}return r}(n,e,t);if(n.type===FG.map)return function(e,t,n){const r=!0===n.useMaps,i=r?void 0:{},o=r?new Map:void 0;for(let s=0;s<e.value;s++){const a=uQ(t,n);if(a===lQ){if(e.value===1/0)break;throw new Error("".concat(rW," got unexpected break to lengthed map"))}if(a===cQ)throw new Error("".concat(rW," found map but not enough entries (got ").concat(s," [no key], expected ").concat(e.value,")"));if(!0!==r&&"string"!==typeof a)throw new Error("".concat(rW," non-string keys not supported (got ").concat(typeof a,")"));if(!0===n.rejectDuplicateMapKeys&&(r&&o.has(a)||!r&&a in i))throw new Error("".concat(rW,' found repeat map key "').concat(a,'"'));const c=uQ(t,n);if(c===cQ)throw new Error("".concat(rW," found map but not enough entries (got ").concat(s," [no value], expected ").concat(e.value,")"));r?o.set(a,c):i[a]=c}return r?o:i}(n,e,t);if(n.type===FG.tag){if(t.tags&&"function"===typeof t.tags[n.value]){const r=uQ(e,t);return t.tags[n.value](r)}throw new Error("".concat(rW," tag not supported (").concat(n.value,")"))}throw new Error("unsupported")}function hQ(e,t){const[n,r]=function(e,t){if(!(e instanceof Uint8Array))throw new Error("".concat(rW," data to decode must be a Uint8Array"));const n=(t=Object.assign({},sQ,t)).tokenizer||new aQ(e,t),r=uQ(n,t);if(r===cQ)throw new Error("".concat(rW," did not find any content to decode"));if(r===lQ)throw new Error("".concat(rW," got unexpected break"));return[r,e.subarray(n.pos())]}(e,t);if(r.length>0)throw new Error("".concat(rW," too many terminals, data makes no sense"));return n}const dQ=zV({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),fQ=zV({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var pQ=n(1315);FG.uint.major,FG.negint.major,FG.bytes.major,FG.string.major,FG.array.major,FG.map.major,FG.tag.major,FG.float.major;class gQ{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._pos=0,this.data=e,this.options=t,this.modeStack=["value"],this.lastToken=""}pos(){return this._pos}done(){return this._pos>=this.data.length}ch(){return this.data[this._pos]}currentMode(){return this.modeStack[this.modeStack.length-1]}skipWhitespace(){let e=this.ch();for(;32===e||9===e||13===e||10===e;)e=this.data[++this._pos]}expect(e){if(this.data.length-this._pos<e.length)throw new Error("".concat(rW," unexpected end of input at position ").concat(this._pos));for(let t=0;t<e.length;t++)if(this.data[this._pos++]!==e[t])throw new Error("".concat(rW," unexpected token at position ").concat(this._pos,", expected to find '").concat(String.fromCharCode(...e),"'"))}parseNumber(){const e=this._pos;let t=!1,n=!1;const r=e=>{for(;!this.done();){const t=this.ch();if(!e.includes(t))break;this._pos++}};if(45===this.ch()&&(t=!0,this._pos++),48===this.ch()){if(this._pos++,46!==this.ch())return new KG(FG.uint,0,this._pos-e);this._pos++,n=!0}if(r([48,49,50,51,52,53,54,55,56,57]),t&&this._pos===e+1)throw new Error("".concat(rW," unexpected token at position ").concat(this._pos));if(!this.done()&&46===this.ch()){if(n)throw new Error("".concat(rW," unexpected token at position ").concat(this._pos));n=!0,this._pos++,r([48,49,50,51,52,53,54,55,56,57])}this.done()||101!==this.ch()&&69!==this.ch()||(n=!0,this._pos++,this.done()||43!==this.ch()&&45!==this.ch()||this._pos++,r([48,49,50,51,52,53,54,55,56,57]));const i=String.fromCharCode.apply(null,this.data.subarray(e,this._pos)),o=parseFloat(i);return n?new KG(FG.float,o,this._pos-e):!0!==this.options.allowBigInt||Number.isSafeInteger(o)?new KG(o>=0?FG.uint:FG.negint,o,this._pos-e):new KG(o>=0?FG.uint:FG.negint,BigInt(i),this._pos-e)}parseString(){if(34!==this.ch())throw new Error("".concat(rW," unexpected character at position ").concat(this._pos,"; this shouldn't happen"));this._pos++;for(let i=this._pos,o=0;i<this.data.length&&o<65536;i++,o++){const e=this.data[i];if(92===e||e<32||e>=128)break;if(34===e){const e=String.fromCharCode.apply(null,this.data.subarray(this._pos,i));return this._pos=i+1,new KG(FG.string,e,o)}}const e=this._pos,t=[],n=()=>{if(this._pos+4>=this.data.length)throw new Error("".concat(rW," unexpected end of unicode escape sequence at position ").concat(this._pos));let e=0;for(let t=0;t<4;t++){let t=this.ch();if(t>=48&&t<=57)t-=48;else if(t>=97&&t<=102)t=t-97+10;else{if(!(t>=65&&t<=70))throw new Error("".concat(rW," unexpected unicode escape character at position ").concat(this._pos));t=t-65+10}e=16*e+t,this._pos++}return e},r=()=>{const e=this.ch();let n,r,i,o,s=null,a=e>239?4:e>223?3:e>191?2:1;if(this._pos+a>this.data.length)throw new Error("".concat(rW," unexpected unicode sequence at position ").concat(this._pos));switch(a){case 1:e<128&&(s=e);break;case 2:n=this.data[this._pos+1],128===(192&n)&&(o=(31&e)<<6|63&n,o>127&&(s=o));break;case 3:n=this.data[this._pos+1],r=this.data[this._pos+2],128===(192&n)&&128===(192&r)&&(o=(15&e)<<12|(63&n)<<6|63&r,o>2047&&(o<55296||o>57343)&&(s=o));break;case 4:n=this.data[this._pos+1],r=this.data[this._pos+2],i=this.data[this._pos+3],128===(192&n)&&128===(192&r)&&128===(192&i)&&(o=(15&e)<<18|(63&n)<<12|(63&r)<<6|63&i,o>65535&&o<1114112&&(s=o))}null===s?(s=65533,a=1):s>65535&&(s-=65536,t.push(s>>>10&1023|55296),s=56320|1023&s),t.push(s),this._pos+=a};for(;!this.done();){const i=this.ch();let o;switch(i){case 92:if(this._pos++,this.done())throw new Error("".concat(rW," unexpected string termination at position ").concat(this._pos));switch(o=this.ch(),this._pos++,o){case 34:case 39:case 92:case 47:t.push(o);break;case 98:t.push(8);break;case 116:t.push(9);break;case 110:t.push(10);break;case 102:t.push(12);break;case 114:t.push(13);break;case 117:t.push(n());break;default:throw new Error("".concat(rW," unexpected string escape character at position ").concat(this._pos))}break;case 34:return this._pos++,new KG(FG.string,tW(t),this._pos-e);default:if(i<32)throw new Error("".concat(rW," invalid control character at position ").concat(this._pos));i<128?(t.push(i),this._pos++):r()}}throw new Error("".concat(rW," unexpected end of string at position ").concat(this._pos))}parseValue(){switch(this.ch()){case 123:return this.modeStack.push("obj-start"),this._pos++,new KG(FG.map,1/0,1);case 91:return this.modeStack.push("array-start"),this._pos++,new KG(FG.array,1/0,1);case 34:return this.parseString();case 110:return this.expect([110,117,108,108]),new KG(FG.null,null,4);case 102:return this.expect([102,97,108,115,101]),new KG(FG.false,!1,5);case 116:return this.expect([116,114,117,101]),new KG(FG.true,!0,4);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.parseNumber();default:throw new Error("".concat(rW," unexpected character at position ").concat(this._pos))}}next(){switch(this.skipWhitespace(),this.currentMode()){case"value":return this.modeStack.pop(),this.parseValue();case"array-value":if(this.modeStack.pop(),93===this.ch())return this._pos++,this.skipWhitespace(),new KG(FG.break,void 0,1);if(44!==this.ch())throw new Error("".concat(rW," unexpected character at position ").concat(this._pos,", was expecting array delimiter but found '").concat(String.fromCharCode(this.ch()),"'"));return this._pos++,this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue();case"array-start":return this.modeStack.pop(),93===this.ch()?(this._pos++,this.skipWhitespace(),new KG(FG.break,void 0,1)):(this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue());case"obj-key":if(125===this.ch())return this.modeStack.pop(),this._pos++,this.skipWhitespace(),new KG(FG.break,void 0,1);if(44!==this.ch())throw new Error("".concat(rW," unexpected character at position ").concat(this._pos,", was expecting object delimiter but found '").concat(String.fromCharCode(this.ch()),"'"));this._pos++,this.skipWhitespace();case"obj-start":{if(this.modeStack.pop(),125===this.ch())return this._pos++,this.skipWhitespace(),new KG(FG.break,void 0,1);const e=this.parseString();if(this.skipWhitespace(),58!==this.ch())throw new Error("".concat(rW," unexpected character at position ").concat(this._pos,", was expecting key/value delimiter ':' but found '").concat(String.fromCharCode(this.ch()),"'"));return this._pos++,this.modeStack.push("obj-value"),e}case"obj-value":return this.modeStack.pop(),this.modeStack.push("obj-key"),this.skipWhitespace(),this.parseValue();default:throw new Error("".concat(rW," unexpected parse state at position ").concat(this._pos,"; this shouldn't happen"))}}}const yQ=new TextEncoder,mQ=new TextDecoder,vQ="json",bQ=512,wQ=e=>yQ.encode(JSON.stringify(e)),EQ=e=>JSON.parse(mQ.decode(e)),AQ="raw",SQ=85,_Q=e=>LV(e),IQ=e=>LV(e),CQ={codec:Qo.code,async*walk(e){const t=Qo.decode(e);yield*t.Links.map((e=>e.Hash))}},TQ={codec:SQ,async*walk(){}},kQ={codec:ti.code,async*walk(e){const t=[],n=[];n[42]=e=>{if(0!==e[0])throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");const n=YH.decode(e.subarray(1));return t.push(n),n},hQ(e,{tags:n}),yield*t}};class RQ extends gQ{constructor(e,t){super(e,t),(0,Yo.Z)(this,"tokenBuffer",void 0),this.tokenBuffer=[]}done(){return 0===this.tokenBuffer.length&&super.done()}_next(){return this.tokenBuffer.length>0?this.tokenBuffer.pop():super.next()}next(){const e=this._next();if(e.type===FG.map){const e=this._next();if(e.type===FG.string&&"/"===e.value){const e=this._next();if(e.type===FG.string){if(this._next().type!==FG.break)throw new Error("Invalid encoded CID form");return this.tokenBuffer.push(e),new KG(FG.tag,42,0)}if(e.type===FG.map){const e=this._next();if(e.type===FG.string&&"bytes"===e.value){const e=this._next();if(e.type===FG.string){for(let e=0;e<2;e++){if(this._next().type!==FG.break)throw new Error("Invalid encoded Bytes form")}const t=nH.decode("m".concat(e.value));return new KG(FG.bytes,t,e.value.length)}this.tokenBuffer.push(e)}this.tokenBuffer.push(e)}this.tokenBuffer.push(e)}this.tokenBuffer.push(e)}return e}}const xQ=[TQ,CQ,kQ,{codec:pQ.code,async*walk(e){const t=[],n=[];var r,i;n[42]=e=>{const n=YH.parse(e);return t.push(n),n},r=e,i={tags:n,tokenizer:new RQ(e,{tags:n,allowIndefinite:!0,allowUndefined:!0,allowNaN:!0,allowInfinity:!0,allowBigInt:!0,strict:!1,rejectDuplicateMapKeys:!1})},hQ(r,i=Object.assign({tokenizer:new gQ(r,i)},i)),yield*t}},{codec:bQ,async*walk(){}}],PQ="/pin/",DQ="/pinned-block/",OQ=dQ;function NQ(e){return 0===e.version&&(e=e.toV1()),new hH("".concat(PQ).concat(e.toString(OQ)))}var BQ=new WeakSet,LQ=new WeakSet;class MQ{constructor(e,t,n){Qd(this,LQ),Qd(this,BQ),(0,Yo.Z)(this,"datastore",void 0),(0,Yo.Z)(this,"blockstore",void 0),(0,Yo.Z)(this,"dagWalkers",void 0),this.datastore=e,this.blockstore=t,this.dagWalkers={},[...xQ,...n].forEach((e=>{this.dagWalkers[e.codec]=e}))}async add(e){var t,n;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=NQ(e);if(await this.datastore.has(i))throw new Error("Already pinned");const o=Math.round(null!==(t=r.depth)&&void 0!==t?t:1/0);if(o<0)throw new Error("Depth must be greater than or equal to 0");const s=new Bm.Z({concurrency:1});s.add((async()=>{await Yd(this,BQ,UQ).call(this,e,s,(t=>{null==t.pinnedBy.find((t=>(0,Ms.f)(t,e.bytes)))&&(t.pinCount++,t.pinnedBy.push(e.bytes))}),{...r,depth:o})}));const a=Ws();s.on("error",(e=>{s.clear(),a.reject(e)})),await Promise.race([s.onIdle(),a.promise]);const c={depth:o,metadata:null!==(n=r.metadata)&&void 0!==n?n:{}};return await this.datastore.put(i,oQ(c),r),{cid:e,...c}}async rm(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=NQ(e),r=hQ(await this.datastore.get(n,t));await this.datastore.delete(n,t);const i=new Bm.Z({concurrency:1});return i.add((async()=>{await Yd(this,BQ,UQ).call(this,e,i,(t=>{t.pinCount--,t.pinnedBy=t.pinnedBy.filter((t=>(0,Ms.f)(t,e.bytes)))}),{...t,depth:r.depth})})),await i.onIdle(),{cid:e,...r}}ls(){try{var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return async function*(){for await(const{key:n,value:r}of e.datastore.query({prefix:PQ+(null!=t.cid?"".concat(t.cid.toString(dQ)):"")},t)){const e=YH.parse(n.toString().substring(5),dQ),t=hQ(r);yield{cid:e,...t}}}()}catch(t){return Promise.reject(t)}}async isPinned(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=new hH("".concat(DQ).concat(OQ.encode(e.multihash.bytes)));return this.datastore.has(n,t)}}async function UQ(e,t,n,r){if(-1===r.depth)return;const i=this.dagWalkers[e.code];if(null==i)throw new Error("No dag walker found for cid codec ".concat(e.code));const o=await this.blockstore.get(e,r);await Yd(this,LQ,FQ).call(this,e,n,r);for await(const s of i.walk(o))t.add((async()=>{await Yd(this,BQ,UQ).call(this,s,t,n,{...r,depth:r.depth-1})}))}async function FQ(e,t,n){var r;const i=new hH("".concat(DQ).concat(OQ.encode(e.multihash.bytes)));let o={pinCount:0,pinnedBy:[]};try{o=hQ(await this.datastore.get(i,n))}catch(s){if("ERR_NOT_FOUND"!==s.code)throw s}t(o),0===o.pinCount&&await this.datastore.has(i)?await this.datastore.delete(i):(await this.datastore.put(i,oQ(o),n),null===(r=n.onProgress)||void 0===r||r.call(n,new AH("helia:pin:add",{detail:e})))}const KQ="lock:worker:request-read",jQ="lock:worker:release-read",ZQ="lock:master:grant-read",zQ="lock:worker:request-write",VQ="lock:worker:release-write",HQ="lock:master:grant-write",qQ={},GQ=e=>{e.addEventListener("message",(t=>{GQ.dispatchEvent("message",e,t)})),null!=e.port&&e.port.addEventListener("message",(t=>{GQ.dispatchEvent("message",e,t)}))};GQ.addEventListener=(e,t)=>{null==qQ[e]&&(qQ[e]=[]),qQ[e].push(t)},GQ.removeEventListener=(e,t)=>{null!=qQ[e]&&(qQ[e]=qQ[e].filter((e=>e===t)))},GQ.dispatchEvent=function(e,t,n){null!=qQ[e]&&qQ[e].forEach((e=>e(t,n)))};const WQ=GQ,QQ=(e,t,n,r,i)=>(o,s)=>{if(s.data.type!==n)return;const a={type:s.data.type,name:s.data.name,identifier:s.data.identifier};e.dispatchEvent(new MessageEvent(t,{data:{name:a.name,handler:async()=>(o.postMessage({type:i,name:a.name,identifier:a.identifier}),await new Promise((e=>{const t=n=>{if(null==n||null==n.data)return;const i=n.data.type,s=(n.data.name,n.data.identifier);i===r&&s===a.identifier&&(o.removeEventListener("message",t),e())};o.addEventListener("message",t)})))}}))},YQ=(e,t,n,r)=>async()=>{const i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21;return crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+((t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_")),"")}();return globalThis.postMessage({type:t,identifier:i,name:e}),await new Promise((t=>{const o=s=>{if(null==s||null==s.data)return;const a=s.data.type,c=s.data.identifier;a===n&&c===i&&(globalThis.removeEventListener("message",o),t((()=>{globalThis.postMessage({type:r,identifier:i,name:e})})))};globalThis.addEventListener("message",o)}))},JQ={singleProcess:!1},XQ={};let $Q;async function eY(e,t){let n;const r=new Promise((e=>{n=e}));return e.add((async()=>await YB((async()=>await new Promise((e=>{n((()=>{e()}))})))(),{milliseconds:t.timeout}))),await r}const tY={name:"lock",concurrency:1/0,timeout:846e5,singleProcess:!1};function nY(e){const t=Object.assign({},tY,e);return null==$Q&&($Q=(e=>{if(e=Object.assign({},JQ,e),Boolean(globalThis.document)||e.singleProcess){const e=new EventTarget;return WQ.addEventListener("message",QQ(e,"requestReadLock",KQ,jQ,ZQ)),WQ.addEventListener("message",QQ(e,"requestWriteLock",zQ,VQ,HQ)),e}return{isWorker:!0,readLock:e=>YQ(e,KQ,ZQ,jQ),writeLock:e=>YQ(e,zQ,HQ,VQ)}})(t),!0!==$Q.isWorker&&($Q.addEventListener("requestReadLock",(e=>{null!=XQ[e.data.name]&&XQ[e.data.name].readLock().then((async t=>await e.data.handler().finally((()=>t()))))})),$Q.addEventListener("requestWriteLock",(async e=>{null!=XQ[e.data.name]&&XQ[e.data.name].writeLock().then((async t=>await e.data.handler().finally((()=>t()))))})))),null==XQ[t.name]&&(XQ[t.name]=((e,t)=>{if(!0===$Q.isWorker)return{readLock:$Q.readLock(e,t),writeLock:$Q.writeLock(e,t)};const n=new Bm.Z({concurrency:1});let r;return{async readLock(){if(null!=r)return await eY(r,t);r=new Bm.Z({concurrency:t.concurrency,autoStart:!1});const e=r,i=eY(r,t);return n.add((async()=>(e.start(),await e.onIdle().then((()=>{r===e&&(r=null)}))))),await i},writeLock:async()=>(r=null,await eY(n,t))}})(t.name,t)),XQ[t.name]}class rY{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,Yo.Z)(this,"lock",void 0),(0,Yo.Z)(this,"child",void 0),(0,Yo.Z)(this,"pins",void 0),(0,Yo.Z)(this,"started",void 0),this.child=e,this.pins=t,this.lock=nY({singleProcess:n.holdGcLock}),this.started=!1}isStarted(){return this.started}async start(){await wH(this.child),this.started=!0}async stop(){await EH(this.child),this.started=!1}unwrap(){return this.child}async put(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=await this.lock.readLock();try{return await this.child.put(e,t,n)}finally{r()}}putMany(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){const r=await t.lock.readLock();try{yield*t.child.putMany(e,n)}finally{r()}}()}catch(n){return Promise.reject(n)}}async get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=await this.lock.readLock();try{return await this.child.get(e,t)}finally{n()}}getMany(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){const r=await t.lock.readLock();try{yield*t.child.getMany(e,n)}finally{r()}}()}catch(n){return Promise.reject(n)}}async delete(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=await this.lock.writeLock();try{if(await this.pins.isPinned(e))throw new Error("CID was pinned");await this.child.delete(e,t)}finally{n()}}deleteMany(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){const r=await t.lock.writeLock();try{const r=t;yield*t.child.deleteMany(async function*(){for await(const t of e){if(await r.pins.isPinned(t))throw new Error("CID was pinned");yield t}}(),n)}finally{r()}}()}catch(n){return Promise.reject(n)}}async has(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=await this.lock.readLock();try{return await this.child.has(e,t)}finally{n()}}getAll(){try{var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return async function*(){const n=await e.lock.readLock();try{yield*e.child.getAll(t)}finally{n()}}()}catch(t){return Promise.reject(t)}}}const iY=new hH("/version");const oY=LV,sY={code:0,name:"identity",encode:oY,digest:e=>VH(0,oY(e))};const aY=aH("helia:networked-storage");function cY(e){return"function"===typeof e.retrieve}function lY(e){return"function"===typeof e.announce}class uY{constructor(e,t){var n,r,i;(0,Yo.Z)(this,"child",void 0),(0,Yo.Z)(this,"blockRetrievers",void 0),(0,Yo.Z)(this,"blockAnnouncers",void 0),(0,Yo.Z)(this,"hashers",void 0),(0,Yo.Z)(this,"started",void 0),this.child=e,this.blockRetrievers=(null!==(n=t.blockBrokers)&&void 0!==n?n:[]).filter(cY),this.blockAnnouncers=(null!==(r=t.blockBrokers)&&void 0!==r?r:[]).filter(lY),this.hashers=null!==(i=t.hashers)&&void 0!==i?i:[],this.started=!1}isStarted(){return this.started}async start(){await wH(this.child,...new Set([...this.blockRetrievers,...this.blockAnnouncers])),this.started=!0}async stop(){await EH(this.child,...new Set([...this.blockRetrievers,...this.blockAnnouncers])),this.started=!1}unwrap(){return this.child}async put(e,t){var n,r;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var o;return await this.child.has(e)?(null===(o=i.onProgress)||void 0===o||o.call(i,new AH("blocks:put:duplicate",e)),e):(null===(n=i.onProgress)||void 0===n||n.call(i,new AH("blocks:put:providers:notify",e)),this.blockAnnouncers.forEach((n=>{n.announce(e,t,i)})),null===(r=i.onProgress)||void 0===r||r.call(i,new AH("blocks:put:blockstore:put",e)),this.child.put(e,t,i))}putMany(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(r){const i=gH(e,(async e=>{let{cid:r}=e;const i=await t.child.has(r);var o;i&&(null===(o=n.onProgress)||void 0===o||o.call(n,new AH("blocks:put-many:duplicate",r)));return!i})),o=jd(i,(e=>{var r;let{cid:i,block:o}=e;null===(r=n.onProgress)||void 0===r||r.call(n,new AH("blocks:put-many:providers:notify",i)),t.blockAnnouncers.forEach((e=>{e.announce(i,o,n)}))}));null===(r=n.onProgress)||void 0===r||r.call(n,new AH("blocks:put-many:blockstore:put-many")),yield*t.child.putMany(o,n)}()}catch(n){return Promise.reject(n)}}async get(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!0!==n.offline&&!await this.child.has(e)){var r,i,o;null===(r=n.onProgress)||void 0===r||r.call(n,new AH("blocks:get:providers:get",e));const t=await dY(e,this.blockRetrievers,this.hashers,n);return null===(i=n.onProgress)||void 0===i||i.call(n,new AH("blocks:get:blockstore:put",e)),await this.child.put(e,t,n),null===(o=n.onProgress)||void 0===o||o.call(n,new AH("blocks:get:providers:notify",e)),this.blockAnnouncers.forEach((r=>{r.announce(e,t,n)})),t}return null===(t=n.onProgress)||void 0===t||t.call(n,new AH("blocks:get:blockstore:get",e)),this.child.get(e,n)}getMany(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(r){null===(r=n.onProgress)||void 0===r||r.call(n,new AH("blocks:get-many:blockstore:get-many")),yield*t.child.getMany(jd(e,(async e=>{if(!0!==n.offline&&!await t.child.has(e)){var r,i,o;null===(r=n.onProgress)||void 0===r||r.call(n,new AH("blocks:get-many:providers:get",e));const s=await dY(e,t.blockRetrievers,t.hashers,n);null===(i=n.onProgress)||void 0===i||i.call(n,new AH("blocks:get-many:blockstore:put",e)),await t.child.put(e,s,n),null===(o=n.onProgress)||void 0===o||o.call(n,new AH("blocks:get-many:providers:notify",e)),t.blockAnnouncers.forEach((t=>{t.announce(e,s,n)}))}})))}()}catch(n){return Promise.reject(n)}}async delete(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null===(t=n.onProgress)||void 0===t||t.call(n,new AH("blocks:delete:blockstore:delete",e)),await this.child.delete(e,n)}deleteMany(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(r){null===(r=n.onProgress)||void 0===r||r.call(n,new AH("blocks:delete-many:blockstore:delete-many")),yield*t.child.deleteMany(async function*(){for await(const t of e)yield t}(),n)}()}catch(n){return Promise.reject(n)}}async has(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.child.has(e,t)}getAll(){try{var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return async function*(n){null===(n=t.onProgress)||void 0===n||n.call(t,new AH("blocks:get-all:blockstore:get-many")),yield*e.child.getAll(t)}()}catch(t){return Promise.reject(t)}}}const hY=(e,t)=>{const n=t.find((t=>t.code===e.multihash.code));if(null==n)throw new aq("No hasher configured for multihash code 0x".concat(e.multihash.code.toString(16),", please configure one. You can look up which hash this is at https://github.com/multiformats/multicodec/blob/master/table.csv"),"ERR_UNKNOWN_HASH_ALG");return async t=>{const r=await n.digest(t);if(!(0,Ms.f)(r.digest,e.multihash.digest))throw new aq("Hash of downloaded block did not match multihash from passed CID","ERR_HASH_MISMATCH")}};async function dY(e,t,n,r){const i=hY(e,n),o=SH([(new AbortController).signal,r.signal]);try{return await Promise.any(t.map((async t=>{try{let n=!1;const s=await t.retrieve(e,{...r,signal:o,validateFn:async e=>{await i(e),n=!0}});return n||await i(s),s}catch(n){throw aY.error("could not retrieve verified block for %c",e,n),n}})))}finally{o.clear()}}const fY=aH("helia");class pY{constructor(e){var t,n,r;(0,Yo.Z)(this,"libp2p",void 0),(0,Yo.Z)(this,"blockstore",void 0),(0,Yo.Z)(this,"datastore",void 0),(0,Yo.Z)(this,"pins",void 0);const i=function(){return[pq,gq,sY,...arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]]}(e.hashers),o={blockstore:e.blockstore,datastore:e.datastore,libp2p:e.libp2p,hashers:i},s=null!==(t=null===(n=e.blockBrokers)||void 0===n?void 0:n.map((e=>e(o))))&&void 0!==t?t:[_G()(o),BG()()],a=new uY(e.blockstore,{blockBrokers:s,hashers:i});this.pins=new MQ(e.datastore,a,null!==(r=e.dagWalkers)&&void 0!==r?r:[]),this.libp2p=e.libp2p,this.blockstore=new rY(a,this.pins,{holdGcLock:e.holdGcLock}),this.datastore=e.datastore}async start(){await async function(e){if(!await e.has(iY))return void await e.put(iY,(0,yu.m)("".concat(1)));const t=await e.get(iY),n=(0,Au.B)(t);if(1!==parseInt(n,10))throw new Error("Unknown datastore version, a datastore migration may be required")}(this.datastore),await wH(this.blockstore),await this.libp2p.start()}async stop(){await this.libp2p.stop(),await EH(this.blockstore)}async gc(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=await this.blockstore.lock.writeLock();try{const t=this,n=this.blockstore.unwrap();fY("gc start"),await fH(n.deleteMany(async function*(){for await(const{cid:s}of n.getAll())try{var r;if(await t.pins.isPinned(s,e))continue;yield s,null===(r=e.onProgress)||void 0===r||r.call(e,new AH("helia:gc:deleted",s))}catch(o){var i;fY.error("Error during gc",o),null===(i=e.onProgress)||void 0===i||i.call(e,new AH("helia:gc:error",o))}}()))}finally{t()}fY("gc finished")}}const gY=32,yY=64,mY=32;function vY(e,t){const n=new Uint8Array(yY);for(let r=0;r<mY;r++)n[r]=e[r],n[mY+r]=t[r];return n}const bY={get(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:globalThis).crypto;if(null==e||null==e.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}},wY={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};async function EY(e,t){const n=function(e){var t,n,r,i,o,s;const a=null!==(t=null===e||void 0===e?void 0:e.algorithm)&&void 0!==t?t:"AES-GCM";let c=null!==(n=null===e||void 0===e?void 0:e.keyLength)&&void 0!==n?n:16;const l=null!==(r=null===e||void 0===e?void 0:e.nonceLength)&&void 0!==r?r:12,u=null!==(i=null===e||void 0===e?void 0:e.digest)&&void 0!==i?i:"SHA-256",h=null!==(o=null===e||void 0===e?void 0:e.saltLength)&&void 0!==o?o:16,d=null!==(s=null===e||void 0===e?void 0:e.iterations)&&void 0!==s?s:32767,f=bY.get();return c*=8,{encrypt:async function(e,t){const n=f.getRandomValues(new Uint8Array(h)),r=f.getRandomValues(new Uint8Array(l)),i={name:a,iv:r};let o;if("string"===typeof t&&(t=(0,yu.m)(t)),0===t.length){o=await f.subtle.importKey("jwk",wY,{name:"AES-GCM"},!0,["encrypt"]);try{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);o=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["encrypt"])}catch{o=await f.subtle.importKey("jwk",wY,{name:"AES-GCM"},!0,["encrypt"])}}else{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);o=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["encrypt"])}const s=await f.subtle.encrypt(i,o,e);return(0,Ls.z)([n,i.iv,new Uint8Array(s)])},decrypt:async function(e,t){const n=e.subarray(0,h),r=e.subarray(h,h+l),i=e.subarray(h+l),o={name:a,iv:r};let s;if("string"===typeof t&&(t=(0,yu.m)(t)),0===t.length)try{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);s=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["decrypt"])}catch{s=await f.subtle.importKey("jwk",wY,{name:"AES-GCM"},!0,["decrypt"])}else{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);s=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["decrypt"])}const p=await f.subtle.decrypt(o,s,i);return new Uint8Array(p)}}}(),r=await n.encrypt(e,t);return nH.encode(r)}var AY,SY,_Y,IY;!function(e){e.RSA="RSA",e.Ed25519="Ed25519",e.Secp256k1="Secp256k1"}(AY||(AY={})),function(e){e[e.RSA=0]="RSA",e[e.Ed25519=1]="Ed25519",e[e.Secp256k1=2]="Secp256k1"}(SY||(SY={})),function(e){e.codec=()=>bs(SY)}(AY||(AY={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),AY.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.Type=AY.codec().decode(e);break;case 2:n.Data=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(_Y||(_Y={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),AY.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.Type=AY.codec().decode(e);break;case 2:n.Data=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(IY||(IY={}));class CY{constructor(e){(0,Yo.Z)(this,"_key",void 0),this._key=DY(e,gY)}async verify(e,t){return async function(e,t,n){return ql.verify(t,n,e)}(this._key,t,e)}marshal(){return this._key}get bytes(){return _Y.encode({Type:AY.Ed25519,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await pq.digest(this.bytes);return e}}class TY{constructor(e,t){(0,Yo.Z)(this,"_key",void 0),(0,Yo.Z)(this,"_publicKey",void 0),this._key=DY(e,yY),this._publicKey=DY(t,gY)}async sign(e){return async function(e,t){const n=e.subarray(0,mY);return ql.sign(t,n)}(this._key,e)}get public(){return new CY(this._publicKey)}marshal(){return this._key}get bytes(){return IY.encode({Type:AY.Ed25519,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await pq.digest(this.bytes);return e}async id(){const e=sY.digest(this.public.bytes);return eH.encode(e.bytes).substring(1)}async export(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"libp2p-key";if("libp2p-key"===t)return EY(this.bytes,e);throw new aq("export format '".concat(t,"' is not supported"),"ERR_INVALID_EXPORT_FORMAT")}}function kY(e){if(e.length>yY){const t=(e=DY(e,yY+gY)).subarray(0,yY),n=e.subarray(yY,e.length);return new TY(t,n)}const t=(e=DY(e,yY)).subarray(0,yY),n=e.subarray(gY);return new TY(t,n)}function RY(e){return e=DY(e,gY),new CY(e)}async function xY(){const{privateKey:e,publicKey:t}=await async function(){const e=ql.utils.randomPrivateKey(),t=ql.getPublicKey(e);return{privateKey:vY(e,t),publicKey:t}}();return new TY(e,t)}async function PY(e){const{privateKey:t,publicKey:n}=await async function(e){if(e.length!==mY)throw new TypeError('"seed" must be 32 bytes in length.');if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');const t=e,n=ql.getPublicKey(t);return{privateKey:vY(t,n),publicKey:n}}(e);return new TY(t,n)}function DY(e,t){var n;if((e=Uint8Array.from(null!==(n=e)&&void 0!==n?n:[])).length!==t)throw new aq("Key must be a Uint8Array of length ".concat(t,", got ").concat(e.length),"ERR_INVALID_KEY_TYPE");return e}function OY(e,t){let n=Uint8Array.from(e.abs().toByteArray());if(n=0===n[0]?n.subarray(1):n,null!=t){if(n.length>t)throw new Error("byte array longer than desired length");n=(0,Ls.z)([new Uint8Array(t-n.length),n])}return(0,Au.B)(n,"base64url")}function NY(e){const t=function(e,t){let n=(0,yu.m)(e,"base64urlpad");if(null!=t){if(n.length>t)throw new Error("byte array longer than desired length");n=(0,Ls.z)([new Uint8Array(t-n.length),n])}return n}(e);return new(gu().jsbn.BigInteger)((0,Au.B)(t,"base16"),16)}const BY={"P-256":256,"P-384":384,"P-521":521};Object.keys(BY).join(" / ");function LY(e){if(isNaN(e)||e<=0)throw new aq("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return _c(e)}function MY(e,t){return t.map((t=>NY(e[t])))}async function UY(e){const t=[await bY.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await KY(e)],n=await FY({privateKey:t[0],publicKey:t[1]});return{privateKey:n[0],publicKey:n[1]}}async function FY(e){if(null==e.privateKey||null==e.publicKey)throw new aq("Private and public key are required","ERR_INVALID_PARAMETERS");return Promise.all([bY.get().subtle.exportKey("jwk",e.privateKey),bY.get().subtle.exportKey("jwk",e.publicKey)])}async function KY(e){return bY.get().subtle.importKey("jwk",{kty:e.kty,n:e.n,e:e.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function jY(e,t,n,r){const i=t?function(e){return gu().pki.setRsaPublicKey(...MY(e,["n","e"]))}(e):function(e){return gu().pki.setRsaPrivateKey(...MY(e,["n","e","d","p","q","dp","dq","qi"]))}(e),o=r((0,Au.B)(Uint8Array.from(n),"ascii"),i);return(0,yu.m)(o,"ascii")}function ZY(e){if("RSA"!==e.kty)throw new aq("invalid key type","ERR_INVALID_KEY_TYPE");if(null==e.n)throw new aq("invalid key modulus","ERR_INVALID_KEY_MODULUS");return 8*(0,yu.m)(e.n,"base64url").length}const zY=8192;class VY{constructor(e){(0,Yo.Z)(this,"_key",void 0),this._key=e}async verify(e,t){return async function(e,t,n){const r=await bY.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return bY.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},r,t,n)}(this._key,t,e)}marshal(){return function(e){if(null==e.n||null==e.e)throw new aq("JWK was missing components","ERR_INVALID_PARAMETERS");const t=gu().pki.publicKeyToAsn1({n:NY(e.n),e:NY(e.e)});return(0,yu.m)(gu().asn1.toDer(t).getBytes(),"ascii")}(this._key)}get bytes(){return _Y.encode({Type:AY.RSA,Data:this.marshal()}).subarray()}encrypt(e){return jY(this._key,!0,e,((e,t)=>t.encrypt(e)))}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await pq.digest(this.bytes);return e}}class HY{constructor(e,t){(0,Yo.Z)(this,"_key",void 0),(0,Yo.Z)(this,"_publicKey",void 0),this._key=e,this._publicKey=t}genSecret(){return LY(16)}async sign(e){return async function(e,t){const n=await bY.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),r=await bY.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},n,Uint8Array.from(t));return new Uint8Array(r,0,r.byteLength)}(this._key,e)}get public(){if(null==this._publicKey)throw new aq("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new VY(this._publicKey)}decrypt(e){return jY(this._key,!1,e,((e,t)=>t.decrypt(e)))}marshal(){return function(e){if(null==e.n||null==e.e||null==e.d||null==e.p||null==e.q||null==e.dp||null==e.dq||null==e.qi)throw new aq("JWK was missing components","ERR_INVALID_PARAMETERS");const t=gu().pki.privateKeyToAsn1({n:NY(e.n),e:NY(e.e),d:NY(e.d),p:NY(e.p),q:NY(e.q),dP:NY(e.dp),dQ:NY(e.dq),qInv:NY(e.qi)});return(0,yu.m)(gu().asn1.toDer(t).getBytes(),"ascii")}(this._key)}get bytes(){return IY.encode({Type:AY.RSA,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await pq.digest(this.bytes);return e}async id(){const e=await this.public.hash();return(0,Au.B)(e,"base58btc")}async export(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"pkcs-8";if("pkcs-8"===t){const t=new(gu().util.ByteBuffer)(this.marshal()),n=gu().asn1.fromDer(t),r=gu().pki.privateKeyFromAsn1(n),i={algorithm:"aes256",count:1e4,saltSize:16,prfAlgorithm:"sha512"};return gu().pki.encryptRsaPrivateKey(r,e,i)}if("libp2p-key"===t)return EY(this.bytes,e);throw new aq("export format '".concat(t,"' is not supported"),"ERR_INVALID_EXPORT_FORMAT")}}async function qY(e){const t=function(e){const t=gu().asn1.fromDer((0,Au.B)(e,"ascii")),n=gu().pki.privateKeyFromAsn1(t);return{kty:"RSA",n:OY(n.n),e:OY(n.e),d:OY(n.d),p:OY(n.p),q:OY(n.q),dp:OY(n.dP),dq:OY(n.dQ),qi:OY(n.qInv),alg:"RS256"}}(e);if(ZY(t)>zY)throw new aq("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const n=await UY(t);return new HY(n.privateKey,n.publicKey)}function GY(e){const t=function(e){const t=gu().asn1.fromDer((0,Au.B)(e,"ascii")),n=gu().pki.publicKeyFromAsn1(t);return{kty:"RSA",n:OY(n.n),e:OY(n.e)}}(e);if(ZY(t)>zY)throw new aq("key size is too large","ERR_KEY_SIZE_TOO_LARGE");return new VY(t)}async function WY(e){if(ZY(e)>zY)throw new aq("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const t=await UY(e);return new HY(t.privateKey,t.publicKey)}async function QY(e){if(e>zY)throw new aq("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const t=await async function(e){const t=await bY.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),n=await FY(t);return{privateKey:n[0],publicKey:n[1]}}(e);return new HY(t.privateKey,t.publicKey)}function YY(e){try{Eh.ProjectivePoint.fromHex(e)}catch(t){throw new aq(String(t),"ERR_INVALID_PUBLIC_KEY")}}class JY{constructor(e){(0,Yo.Z)(this,"_key",void 0),YY(e),this._key=e}async verify(e,t){return async function(e,t,n){try{const{digest:r}=await pq.digest(n);return Eh.verify(t,r,e)}catch(r){throw new aq(String(r),"ERR_INVALID_INPUT")}}(this._key,t,e)}marshal(){return e=this._key,Eh.ProjectivePoint.fromHex(e).toRawBytes(!0);var e}get bytes(){return _Y.encode({Type:AY.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await pq.digest(this.bytes);return e}}class XY{constructor(e,t){(0,Yo.Z)(this,"_key",void 0),(0,Yo.Z)(this,"_publicKey",void 0),this._key=e,this._publicKey=null!==t&&void 0!==t?t:function(e){try{return Eh.getPublicKey(e,!0)}catch(t){throw new aq(String(t),"ERR_INVALID_PRIVATE_KEY")}}(e),function(e){try{Eh.getPublicKey(e,!0)}catch(t){throw new aq(String(t),"ERR_INVALID_PRIVATE_KEY")}}(this._key),YY(this._publicKey)}async sign(e){return async function(e,t){const{digest:n}=await pq.digest(t);try{return Eh.sign(n,e).toDERRawBytes()}catch(r){throw new aq(String(r),"ERR_INVALID_INPUT")}}(this._key,e)}get public(){return new JY(this._publicKey)}marshal(){return this._key}get bytes(){return IY.encode({Type:AY.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await pq.digest(this.bytes);return e}async id(){const e=await this.public.hash();return(0,Au.B)(e,"base58btc")}async export(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"libp2p-key";if("libp2p-key"===t)return EY(this.bytes,e);throw new aq("export format '".concat(t,"' is not supported"),"ERR_INVALID_EXPORT_FORMAT")}}function $Y(e){return new XY(e)}function eJ(e){return new JY(e)}async function tJ(){const e=Eh.utils.randomPrivateKey();return new XY(e)}const nJ={rsa:Yt,ed25519:Qt,secp256k1:Jt};function rJ(e){const t=Object.keys(nJ).join(" / ");return new aq("invalid or unsupported key type ".concat(e,". Must be ").concat(t),"ERR_UNSUPPORTED_KEY_TYPE")}function iJ(e){var t,n;const r=_Y.decode(e),i=null!==(t=r.Data)&&void 0!==t?t:new Uint8Array;switch(r.Type){case AY.RSA:return nJ.rsa.unmarshalRsaPublicKey(i);case AY.Ed25519:return nJ.ed25519.unmarshalEd25519PublicKey(i);case AY.Secp256k1:return nJ.secp256k1.unmarshalSecp256k1PublicKey(i);default:throw rJ(null!==(n=r.Type)&&void 0!==n?n:"unknown")}}async function oJ(e){var t,n;const r=IY.decode(e),i=null!==(t=r.Data)&&void 0!==t?t:new Uint8Array;switch(r.Type){case AY.RSA:return nJ.rsa.unmarshalRsaPrivateKey(i);case AY.Ed25519:return nJ.ed25519.unmarshalEd25519PrivateKey(i);case AY.Secp256k1:return nJ.secp256k1.unmarshalSecp256k1PrivateKey(i);default:throw rJ(null!==(n=r.Type)&&void 0!==n?n:"RSA")}}const sJ=Symbol.for("@libp2p/content-routing");var aJ,cJ=new WeakMap;class lJ extends EventTarget{constructor(){super(...arguments),(0,dx.Z)(this,cJ,{writable:!0,value:new Map})}listenerCount(e){const t=(0,fx.Z)(this,cJ).get(e);return null==t?0:t.length}addEventListener(e,t,n){var r;super.addEventListener(e,t,n);let i=(0,fx.Z)(this,cJ).get(e);null==i&&(i=[],(0,fx.Z)(this,cJ).set(e,i)),i.push({callback:t,once:null!==(r=!0!==n&&!1!==n&&(null===n||void 0===n?void 0:n.once))&&void 0!==r&&r})}removeEventListener(e,t,n){super.removeEventListener(e.toString(),null!==t&&void 0!==t?t:null,n);let r=(0,fx.Z)(this,cJ).get(e);null!=r&&(r=r.filter((e=>{let{callback:n}=e;return n!==t})),(0,fx.Z)(this,cJ).set(e,r))}dispatchEvent(e){const t=super.dispatchEvent(e);let n=(0,fx.Z)(this,cJ).get(e.type);return null==n||(n=n.filter((e=>{let{once:t}=e;return!t})),(0,fx.Z)(this,cJ).set(e.type,n)),t}safeDispatchEvent(e,t){return this.dispatchEvent(new hJ(e,t))}}class uJ extends Event{constructor(e,t){super(e,t),(0,Yo.Z)(this,"detail",void 0),this.detail=null===t||void 0===t?void 0:t.detail}}const hJ=null!==(aJ=globalThis.CustomEvent)&&void 0!==aJ?aJ:uJ,dJ=function(e){try{for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r]}catch{}},fJ=Symbol.for("@libp2p/peer-discovery"),pJ=Symbol.for("@libp2p/peer-routing");class gJ extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"The operation was aborted"),(0,Yo.Z)(this,"code",void 0),(0,Yo.Z)(this,"type",void 0),this.code=gJ.code,this.type=gJ.type}}(0,Yo.Z)(gJ,"code","ABORT_ERR"),(0,Yo.Z)(gJ,"type","aborted");class yJ extends Error{constructor(e,t,n){var r;super(e),(0,Yo.Z)(this,"code",void 0),(0,Yo.Z)(this,"props",void 0),this.code=t,this.name=null!==(r=null===n||void 0===n?void 0:n.name)&&void 0!==r?r:"CodeError",this.props=null!==n&&void 0!==n?n:{}}}class mJ extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected Peer"),(0,Yo.Z)(this,"code",void 0),this.code=mJ.code}}(0,Yo.Z)(mJ,"code","ERR_UNEXPECTED_PEER");class vJ extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid crypto exchange"),(0,Yo.Z)(this,"code",void 0),this.code=vJ.code}}(0,Yo.Z)(vJ,"code","ERR_INVALID_CRYPTO_EXCHANGE");class bJ extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid crypto transmission"),(0,Yo.Z)(this,"code",void 0),this.code=bJ.code}}(0,Yo.Z)(bJ,"code","ERR_INVALID_CRYPTO_TRANSMISSION");n(18605);const wJ={get(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:globalThis).crypto;if(null==e||null==e.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}};var EJ=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==n[s])throw new TypeError(o+" is ambiguous");n[s]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var r=0,i=0;e[t]===c;)r++,t++;for(var o=(e.length-t)*l+1>>>0,s=new Uint8Array(o);e[t];){var u=n[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=o-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*s[d]>>>0,s[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=o-i;f!==o&&0===s[f];)f++;for(var p=new Uint8Array(r+(o-f)),g=r;f!==o;)p[g++]=s[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,o=t.length;i!==o&&0===t[i];)i++,n++;for(var s=(o-i)*u+1>>>0,l=new Uint8Array(s);i!==o;){for(var h=t[i],d=0,f=s-1;(0!==h||d<r)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");r=d,i++}for(var p=s-r;p!==s&&0===l[p];)p++;for(var g=c.repeat(n);p<s;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:h,decode:function(e){var n=h(e);if(n)return n;throw new Error("Non-".concat(t," character"))}}};const AJ=EJ,SJ=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class _J{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(e));throw Error("Unknown type, must be binary type")}}class IJ{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(e),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return TJ(this,e)}}class CJ{constructor(e){this.decoders=e}or(e){return TJ(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(e),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}}const TJ=(e,t)=>new CJ({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class kJ{constructor(e,t,n,r){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=r,this.encoder=new _J(e,t,n),this.decoder=new IJ(e,t,r)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const RJ=e=>{let{name:t,prefix:n,encode:r,decode:i}=e;return new kJ(t,n,r,i)},xJ=e=>{let{prefix:t,name:n,alphabet:r}=e;const{encode:i,decode:o}=AJ(r,n);return RJ({prefix:t,name:n,encode:i,decode:e=>SJ(o(e))})},PJ=e=>{let{name:t,prefix:n,bitsPerChar:r,alphabet:i}=e;return RJ({prefix:n,name:t,encode:e=>((e,t,n)=>{const r="="===t[t.length-1],i=(1<<n)-1;let o="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>n;)s-=n,o+=t[i&a>>s];if(s&&(o+=t[i&a<<n-s]),r)for(;o.length*n&7;)o+="=";return o})(e,i,r),decode:e=>((e,t,n,r)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*n/8|0);let a=0,c=0,l=0;for(let u=0;u<o;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError("Non-".concat(r," character"));c=c<<n|t,a+=n,a>=8&&(a-=8,s[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s})(e,i,r,t)})},DJ=xJ({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),OJ=xJ({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var NJ=function e(t,n,r){n=n||[];var i=r=r||0;for(;t>=MJ;)n[r++]=255&t|BJ,t/=128;for(;t&LJ;)n[r++]=255&t|BJ,t>>>=7;return n[r]=0|t,e.bytes=r-i+1,n},BJ=128,LJ=-128,MJ=Math.pow(2,31);var UJ=function e(t,n){var r,i=0,o=0,s=n=n||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");r=t[s++],i+=o<28?(r&KJ)<<o:(r&KJ)*Math.pow(2,o),o+=7}while(r>=FJ);return e.bytes=s-n,i},FJ=128,KJ=127;var jJ=Math.pow(2,7),ZJ=Math.pow(2,14),zJ=Math.pow(2,21),VJ=Math.pow(2,28),HJ=Math.pow(2,35),qJ=Math.pow(2,42),GJ=Math.pow(2,49),WJ=Math.pow(2,56),QJ=Math.pow(2,63);const YJ={encode:NJ,decode:UJ,encodingLength:function(e){return e<jJ?1:e<ZJ?2:e<zJ?3:e<VJ?4:e<HJ?5:e<qJ?6:e<GJ?7:e<WJ?8:e<QJ?9:10}},JJ=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return[YJ.decode(e,t),YJ.decode.bytes]},XJ=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return YJ.encode(e,t,n),t},$J=e=>YJ.encodingLength(e),eX=(e,t)=>{const n=t.byteLength,r=$J(e),i=r+$J(n),o=new Uint8Array(i+n);return XJ(e,o,0),XJ(n,o,r),o.set(t,i),new nX(e,n,t,o)},tX=e=>{const t=SJ(e),[n,r]=JJ(t),[i,o]=JJ(t.subarray(r)),s=t.subarray(r+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new nX(n,i,s,t)};class nX{constructor(e,t,n,r){this.code=e,this.size=t,this.digest=n,this.bytes=r}}const rX=SJ,iX={code:0,name:"identity",encode:rX,digest:e=>eX(0,rX(e))},oX=e=>{let{name:t,code:n,encode:r}=e;return new sX(t,n,r)};class sX{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?eX(this.code,t):t.then((e=>eX(this.code,e)))}throw Error("Unknown type, must be binary type")}}const aX=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),cX=oX({name:"sha2-256",code:18,encode:aX("SHA-256")}),lX=oX({name:"sha2-512",code:19,encode:aX("SHA-512")}),uX=32,hX=64,dX=32;function fX(e,t){const n=new Uint8Array(hX);for(let r=0;r<dX;r++)n[r]=e[r],n[dX+r]=t[r];return n}const pX=PJ({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),gX=PJ({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),yX=PJ({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),mX=PJ({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),vX={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};function bX(e){var t,n,r,i,o,s;const a=null!==(t=null===e||void 0===e?void 0:e.algorithm)&&void 0!==t?t:"AES-GCM";let c=null!==(n=null===e||void 0===e?void 0:e.keyLength)&&void 0!==n?n:16;const l=null!==(r=null===e||void 0===e?void 0:e.nonceLength)&&void 0!==r?r:12,u=null!==(i=null===e||void 0===e?void 0:e.digest)&&void 0!==i?i:"SHA-256",h=null!==(o=null===e||void 0===e?void 0:e.saltLength)&&void 0!==o?o:16,d=null!==(s=null===e||void 0===e?void 0:e.iterations)&&void 0!==s?s:32767,f=wJ.get();c*=8;return{encrypt:async function(e,t){const n=f.getRandomValues(new Uint8Array(h)),r=f.getRandomValues(new Uint8Array(l)),i={name:a,iv:r};let o;if("string"===typeof t&&(t=(0,yu.m)(t)),0===t.length){o=await f.subtle.importKey("jwk",vX,{name:"AES-GCM"},!0,["encrypt"]);try{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);o=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["encrypt"])}catch{o=await f.subtle.importKey("jwk",vX,{name:"AES-GCM"},!0,["encrypt"])}}else{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);o=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["encrypt"])}const s=await f.subtle.encrypt(i,o,e);return(0,Ls.z)([n,i.iv,new Uint8Array(s)])},decrypt:async function(e,t){const n=e.subarray(0,h),r=e.subarray(h,h+l),i=e.subarray(h+l),o={name:a,iv:r};let s;if("string"===typeof t&&(t=(0,yu.m)(t)),0===t.length)try{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);s=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["decrypt"])}catch{s=await f.subtle.importKey("jwk",vX,{name:"AES-GCM"},!0,["decrypt"])}else{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);s=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["decrypt"])}const p=await f.subtle.decrypt(o,s,i);return new Uint8Array(p)}}}async function wX(e,t){const n=bX(),r=await n.encrypt(e,t);return pX.encode(r)}var EX,AX,SX,_X;!function(e){e.RSA="RSA",e.Ed25519="Ed25519",e.Secp256k1="Secp256k1"}(EX||(EX={})),function(e){e[e.RSA=0]="RSA",e[e.Ed25519=1]="Ed25519",e[e.Secp256k1=2]="Secp256k1"}(AX||(AX={})),function(e){e.codec=()=>bs(AX)}(EX||(EX={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),EX.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.Type=EX.codec().decode(e);break;case 2:n.Data=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(SX||(SX={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),EX.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.Type=EX.codec().decode(e);break;case 2:n.Data=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(_X||(_X={}));class IX{constructor(e){(0,Yo.Z)(this,"_key",void 0),this._key=PX(e,uX)}async verify(e,t){return async function(e,t,n){return ql.verify(t,n,e)}(this._key,t,e)}marshal(){return this._key}get bytes(){return SX.encode({Type:EX.Ed25519,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await cX.digest(this.bytes);return e}}class CX{constructor(e,t){(0,Yo.Z)(this,"_key",void 0),(0,Yo.Z)(this,"_publicKey",void 0),this._key=PX(e,hX),this._publicKey=PX(t,uX)}async sign(e){return async function(e,t){const n=e.subarray(0,dX);return ql.sign(t,n)}(this._key,e)}get public(){return new IX(this._publicKey)}marshal(){return this._key}get bytes(){return _X.encode({Type:EX.Ed25519,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await cX.digest(this.bytes);return e}async id(){const e=iX.digest(this.public.bytes);return DJ.encode(e.bytes).substring(1)}async export(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"libp2p-key";if("libp2p-key"===t)return wX(this.bytes,e);throw new yJ("export format '".concat(t,"' is not supported"),"ERR_INVALID_EXPORT_FORMAT")}}function TX(e){if(e.length>hX){const t=(e=PX(e,hX+uX)).subarray(0,hX),n=e.subarray(hX,e.length);return new CX(t,n)}const t=(e=PX(e,hX)).subarray(0,hX),n=e.subarray(uX);return new CX(t,n)}function kX(e){return e=PX(e,uX),new IX(e)}async function RX(){const{privateKey:e,publicKey:t}=await async function(){const e=ql.utils.randomPrivateKey(),t=ql.getPublicKey(e);return{privateKey:fX(e,t),publicKey:t}}();return new CX(e,t)}async function xX(e){const{privateKey:t,publicKey:n}=await async function(e){if(e.length!==dX)throw new TypeError('"seed" must be 32 bytes in length.');if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');const t=e,n=ql.getPublicKey(t);return{privateKey:fX(t,n),publicKey:n}}(e);return new CX(t,n)}function PX(e,t){var n;if((e=Uint8Array.from(null!==(n=e)&&void 0!==n?n:[])).length!==t)throw new yJ("Key must be a Uint8Array of length ".concat(t,", got ").concat(e.length),"ERR_INVALID_KEY_TYPE");return e}function DX(e,t){let n=Uint8Array.from(e.abs().toByteArray());if(n=0===n[0]?n.subarray(1):n,null!=t){if(n.length>t)throw new Error("byte array longer than desired length");n=(0,Ls.z)([new Uint8Array(t-n.length),n])}return(0,Au.B)(n,"base64url")}function OX(e){const t=function(e,t){let n=(0,yu.m)(e,"base64urlpad");if(null!=t){if(n.length>t)throw new Error("byte array longer than desired length");n=(0,Ls.z)([new Uint8Array(t-n.length),n])}return n}(e);return new(gu().jsbn.BigInteger)((0,Au.B)(t,"base16"),16)}const NX={"P-256":256,"P-384":384,"P-521":521};Object.keys(NX).join(" / ");function BX(e){if(isNaN(e)||e<=0)throw new yJ("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return _c(e)}function LX(e,t){return t.map((t=>OX(e[t])))}async function MX(e){const t=[await wJ.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await FX(e)],n=await UX({privateKey:t[0],publicKey:t[1]});return{privateKey:n[0],publicKey:n[1]}}async function UX(e){if(null==e.privateKey||null==e.publicKey)throw new yJ("Private and public key are required","ERR_INVALID_PARAMETERS");return Promise.all([wJ.get().subtle.exportKey("jwk",e.privateKey),wJ.get().subtle.exportKey("jwk",e.publicKey)])}async function FX(e){return wJ.get().subtle.importKey("jwk",{kty:e.kty,n:e.n,e:e.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function KX(e,t,n,r){const i=t?function(e){return gu().pki.setRsaPublicKey(...LX(e,["n","e"]))}(e):function(e){return gu().pki.setRsaPrivateKey(...LX(e,["n","e","d","p","q","dp","dq","qi"]))}(e),o=r((0,Au.B)(Uint8Array.from(n),"ascii"),i);return(0,yu.m)(o,"ascii")}function jX(e){if("RSA"!==e.kty)throw new yJ("invalid key type","ERR_INVALID_KEY_TYPE");if(null==e.n)throw new yJ("invalid key modulus","ERR_INVALID_KEY_MODULUS");return 8*(0,yu.m)(e.n,"base64url").length}const ZX=8192;class zX{constructor(e){(0,Yo.Z)(this,"_key",void 0),this._key=e}async verify(e,t){return async function(e,t,n){const r=await wJ.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return wJ.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},r,t,n)}(this._key,t,e)}marshal(){return function(e){if(null==e.n||null==e.e)throw new yJ("JWK was missing components","ERR_INVALID_PARAMETERS");const t=gu().pki.publicKeyToAsn1({n:OX(e.n),e:OX(e.e)});return(0,yu.m)(gu().asn1.toDer(t).getBytes(),"ascii")}(this._key)}get bytes(){return SX.encode({Type:EX.RSA,Data:this.marshal()}).subarray()}encrypt(e){return KX(this._key,!0,e,((e,t)=>t.encrypt(e)))}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await cX.digest(this.bytes);return e}}class VX{constructor(e,t){(0,Yo.Z)(this,"_key",void 0),(0,Yo.Z)(this,"_publicKey",void 0),this._key=e,this._publicKey=t}genSecret(){return BX(16)}async sign(e){return async function(e,t){const n=await wJ.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),r=await wJ.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},n,Uint8Array.from(t));return new Uint8Array(r,0,r.byteLength)}(this._key,e)}get public(){if(null==this._publicKey)throw new yJ("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new zX(this._publicKey)}decrypt(e){return KX(this._key,!1,e,((e,t)=>t.decrypt(e)))}marshal(){return function(e){if(null==e.n||null==e.e||null==e.d||null==e.p||null==e.q||null==e.dp||null==e.dq||null==e.qi)throw new yJ("JWK was missing components","ERR_INVALID_PARAMETERS");const t=gu().pki.privateKeyToAsn1({n:OX(e.n),e:OX(e.e),d:OX(e.d),p:OX(e.p),q:OX(e.q),dP:OX(e.dp),dQ:OX(e.dq),qInv:OX(e.qi)});return(0,yu.m)(gu().asn1.toDer(t).getBytes(),"ascii")}(this._key)}get bytes(){return _X.encode({Type:EX.RSA,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await cX.digest(this.bytes);return e}async id(){const e=await this.public.hash();return(0,Au.B)(e,"base58btc")}async export(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"pkcs-8";if("pkcs-8"===t){const t=new(gu().util.ByteBuffer)(this.marshal()),n=gu().asn1.fromDer(t),r=gu().pki.privateKeyFromAsn1(n),i={algorithm:"aes256",count:1e4,saltSize:16,prfAlgorithm:"sha512"};return gu().pki.encryptRsaPrivateKey(r,e,i)}if("libp2p-key"===t)return wX(this.bytes,e);throw new yJ("export format '".concat(t,"' is not supported"),"ERR_INVALID_EXPORT_FORMAT")}}async function HX(e){const t=function(e){const t=gu().asn1.fromDer((0,Au.B)(e,"ascii")),n=gu().pki.privateKeyFromAsn1(t);return{kty:"RSA",n:DX(n.n),e:DX(n.e),d:DX(n.d),p:DX(n.p),q:DX(n.q),dp:DX(n.dP),dq:DX(n.dQ),qi:DX(n.qInv),alg:"RS256"}}(e);if(jX(t)>ZX)throw new yJ("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const n=await MX(t);return new VX(n.privateKey,n.publicKey)}function qX(e){const t=function(e){const t=gu().asn1.fromDer((0,Au.B)(e,"ascii")),n=gu().pki.publicKeyFromAsn1(t);return{kty:"RSA",n:DX(n.n),e:DX(n.e)}}(e);if(jX(t)>ZX)throw new yJ("key size is too large","ERR_KEY_SIZE_TOO_LARGE");return new zX(t)}async function GX(e){if(jX(e)>ZX)throw new yJ("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const t=await MX(e);return new VX(t.privateKey,t.publicKey)}async function WX(e){if(e>ZX)throw new yJ("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const t=await async function(e){const t=await wJ.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),n=await UX(t);return{privateKey:n[0],publicKey:n[1]}}(e);return new VX(t.privateKey,t.publicKey)}function QX(e){try{Eh.ProjectivePoint.fromHex(e)}catch(t){throw new yJ(String(t),"ERR_INVALID_PUBLIC_KEY")}}class YX{constructor(e){(0,Yo.Z)(this,"_key",void 0),QX(e),this._key=e}async verify(e,t){return async function(e,t,n){try{const{digest:r}=await cX.digest(n);return Eh.verify(t,r,e)}catch(r){throw new yJ(String(r),"ERR_INVALID_INPUT")}}(this._key,t,e)}marshal(){return e=this._key,Eh.ProjectivePoint.fromHex(e).toRawBytes(!0);var e}get bytes(){return SX.encode({Type:EX.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await cX.digest(this.bytes);return e}}class JX{constructor(e,t){(0,Yo.Z)(this,"_key",void 0),(0,Yo.Z)(this,"_publicKey",void 0),this._key=e,this._publicKey=null!==t&&void 0!==t?t:function(e){try{return Eh.getPublicKey(e,!0)}catch(t){throw new yJ(String(t),"ERR_INVALID_PRIVATE_KEY")}}(e),function(e){try{Eh.getPublicKey(e,!0)}catch(t){throw new yJ(String(t),"ERR_INVALID_PRIVATE_KEY")}}(this._key),QX(this._publicKey)}async sign(e){return async function(e,t){const{digest:n}=await cX.digest(t);try{return Eh.sign(n,e).toDERRawBytes()}catch(r){throw new yJ(String(r),"ERR_INVALID_INPUT")}}(this._key,e)}get public(){return new YX(this._publicKey)}marshal(){return this._key}get bytes(){return _X.encode({Type:EX.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await cX.digest(this.bytes);return e}async id(){const e=await this.public.hash();return(0,Au.B)(e,"base58btc")}async export(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"libp2p-key";if("libp2p-key"===t)return wX(this.bytes,e);throw new yJ("export format '".concat(t,"' is not supported"),"ERR_INVALID_EXPORT_FORMAT")}}function XX(e){return new JX(e)}function $X(e){return new YX(e)}async function e$(){const e=Eh.utils.randomPrivateKey();return new JX(e)}const t$={rsa:rn,ed25519:nn,secp256k1:on};function n$(e){const t=Object.keys(t$).join(" / ");return new yJ("invalid or unsupported key type ".concat(e,". Must be ").concat(t),"ERR_UNSUPPORTED_KEY_TYPE")}function r$(e){if("rsa"===(e=e.toLowerCase())||"ed25519"===e||"secp256k1"===e)return t$[e];throw n$(e)}async function i$(e){var t,n;const r=_X.decode(e),i=null!==(t=r.Data)&&void 0!==t?t:new Uint8Array;switch(r.Type){case EX.RSA:return t$.rsa.unmarshalRsaPrivateKey(i);case EX.Ed25519:return t$.ed25519.unmarshalEd25519PrivateKey(i);case EX.Secp256k1:return t$.secp256k1.unmarshalSecp256k1PrivateKey(i);default:throw n$(null!==(n=r.Type)&&void 0!==n?n:"RSA")}}async function o$(e,t){try{const n=await async function(e,t){const n=pX.decode(e);return bX().decrypt(n,t)}(e,t);return await i$(n)}catch(i){}const n=gu().pki.decryptRsaPrivateKey(e,t);if(null===n)throw new yJ("Cannot read the key, most likely the password is wrong or not a RSA key","ERR_CANNOT_DECRYPT_PEM");let r=gu().asn1.toDer(gu().pki.privateKeyToAsn1(n));return r=(0,yu.m)(r.getBytes(),"ascii"),t$.rsa.unmarshalRsaPrivateKey(r)}var s$=n(16019),a$=n.n(s$);const c$={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function l$(e,t,n,r,i){if("sha1"!==i&&"sha2-256"!==i&&"sha2-512"!==i){const e=Object.keys(c$).join(" / ");throw new yJ("Hash '".concat(i,"' is unknown or not supported. Must be ").concat(e),"ERR_UNSUPPORTED_HASH_TYPE")}const o=c$[i],s=a$()(e,t,n,r,o);return Eu().encode64(s,null)}const u$=PJ({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),h$=PJ({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),d$=PJ({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),f$=PJ({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),p$=PJ({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),g$=PJ({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),y$=PJ({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),m$=PJ({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),v$=PJ({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});function b$(e){let t=function(e){const t=()=>{};return t.enabled=!1,t.color="",t.diff=0,t.log=()=>{},t.namespace=e,t.destroy=()=>!0,t.extend=()=>t,t}("".concat(e,":trace"));return sf().enabled("".concat(e,":trace"))&&null!=sf().names.map((e=>e.toString())).find((e=>e.includes(":trace")))&&(t=sf()("".concat(e,":trace"))),Object.assign(sf()(e),{error:sf()("".concat(e,":error")),trace:t})}sf().formatters.b=e=>null==e?"undefined":DJ.baseEncode(e),sf().formatters.t=e=>null==e?"undefined":u$.baseEncode(e),sf().formatters.m=e=>null==e?"undefined":pX.baseEncode(e),sf().formatters.p=e=>null==e?"undefined":e.toString(),sf().formatters.c=e=>null==e?"undefined":e.toString(),sf().formatters.k=e=>null==e?"undefined":e.toString(),sf().formatters.a=e=>null==e?"undefined":e.toString();const w$=Symbol.for("@libp2p/peer-id");const E$=xJ({prefix:"9",name:"base10",alphabet:"0123456789"}),A$=PJ({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),S$=PJ({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),_$=PJ({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),I$=Array.from("\ud83d\ude80\ud83e\ude90\u2604\ud83d\udef0\ud83c\udf0c\ud83c\udf11\ud83c\udf12\ud83c\udf13\ud83c\udf14\ud83c\udf15\ud83c\udf16\ud83c\udf17\ud83c\udf18\ud83c\udf0d\ud83c\udf0f\ud83c\udf0e\ud83d\udc09\u2600\ud83d\udcbb\ud83d\udda5\ud83d\udcbe\ud83d\udcbf\ud83d\ude02\u2764\ud83d\ude0d\ud83e\udd23\ud83d\ude0a\ud83d\ude4f\ud83d\udc95\ud83d\ude2d\ud83d\ude18\ud83d\udc4d\ud83d\ude05\ud83d\udc4f\ud83d\ude01\ud83d\udd25\ud83e\udd70\ud83d\udc94\ud83d\udc96\ud83d\udc99\ud83d\ude22\ud83e\udd14\ud83d\ude06\ud83d\ude44\ud83d\udcaa\ud83d\ude09\u263a\ud83d\udc4c\ud83e\udd17\ud83d\udc9c\ud83d\ude14\ud83d\ude0e\ud83d\ude07\ud83c\udf39\ud83e\udd26\ud83c\udf89\ud83d\udc9e\u270c\u2728\ud83e\udd37\ud83d\ude31\ud83d\ude0c\ud83c\udf38\ud83d\ude4c\ud83d\ude0b\ud83d\udc97\ud83d\udc9a\ud83d\ude0f\ud83d\udc9b\ud83d\ude42\ud83d\udc93\ud83e\udd29\ud83d\ude04\ud83d\ude00\ud83d\udda4\ud83d\ude03\ud83d\udcaf\ud83d\ude48\ud83d\udc47\ud83c\udfb6\ud83d\ude12\ud83e\udd2d\u2763\ud83d\ude1c\ud83d\udc8b\ud83d\udc40\ud83d\ude2a\ud83d\ude11\ud83d\udca5\ud83d\ude4b\ud83d\ude1e\ud83d\ude29\ud83d\ude21\ud83e\udd2a\ud83d\udc4a\ud83e\udd73\ud83d\ude25\ud83e\udd24\ud83d\udc49\ud83d\udc83\ud83d\ude33\u270b\ud83d\ude1a\ud83d\ude1d\ud83d\ude34\ud83c\udf1f\ud83d\ude2c\ud83d\ude43\ud83c\udf40\ud83c\udf37\ud83d\ude3b\ud83d\ude13\u2b50\u2705\ud83e\udd7a\ud83c\udf08\ud83d\ude08\ud83e\udd18\ud83d\udca6\u2714\ud83d\ude23\ud83c\udfc3\ud83d\udc90\u2639\ud83c\udf8a\ud83d\udc98\ud83d\ude20\u261d\ud83d\ude15\ud83c\udf3a\ud83c\udf82\ud83c\udf3b\ud83d\ude10\ud83d\udd95\ud83d\udc9d\ud83d\ude4a\ud83d\ude39\ud83d\udde3\ud83d\udcab\ud83d\udc80\ud83d\udc51\ud83c\udfb5\ud83e\udd1e\ud83d\ude1b\ud83d\udd34\ud83d\ude24\ud83c\udf3c\ud83d\ude2b\u26bd\ud83e\udd19\u2615\ud83c\udfc6\ud83e\udd2b\ud83d\udc48\ud83d\ude2e\ud83d\ude46\ud83c\udf7b\ud83c\udf43\ud83d\udc36\ud83d\udc81\ud83d\ude32\ud83c\udf3f\ud83e\udde1\ud83c\udf81\u26a1\ud83c\udf1e\ud83c\udf88\u274c\u270a\ud83d\udc4b\ud83d\ude30\ud83e\udd28\ud83d\ude36\ud83e\udd1d\ud83d\udeb6\ud83d\udcb0\ud83c\udf53\ud83d\udca2\ud83e\udd1f\ud83d\ude41\ud83d\udea8\ud83d\udca8\ud83e\udd2c\u2708\ud83c\udf80\ud83c\udf7a\ud83e\udd13\ud83d\ude19\ud83d\udc9f\ud83c\udf31\ud83d\ude16\ud83d\udc76\ud83e\udd74\u25b6\u27a1\u2753\ud83d\udc8e\ud83d\udcb8\u2b07\ud83d\ude28\ud83c\udf1a\ud83e\udd8b\ud83d\ude37\ud83d\udd7a\u26a0\ud83d\ude45\ud83d\ude1f\ud83d\ude35\ud83d\udc4e\ud83e\udd32\ud83e\udd20\ud83e\udd27\ud83d\udccc\ud83d\udd35\ud83d\udc85\ud83e\uddd0\ud83d\udc3e\ud83c\udf52\ud83d\ude17\ud83e\udd11\ud83c\udf0a\ud83e\udd2f\ud83d\udc37\u260e\ud83d\udca7\ud83d\ude2f\ud83d\udc86\ud83d\udc46\ud83c\udfa4\ud83d\ude47\ud83c\udf51\u2744\ud83c\udf34\ud83d\udca3\ud83d\udc38\ud83d\udc8c\ud83d\udccd\ud83e\udd40\ud83e\udd22\ud83d\udc45\ud83d\udca1\ud83d\udca9\ud83d\udc50\ud83d\udcf8\ud83d\udc7b\ud83e\udd10\ud83e\udd2e\ud83c\udfbc\ud83e\udd75\ud83d\udea9\ud83c\udf4e\ud83c\udf4a\ud83d\udc7c\ud83d\udc8d\ud83d\udce3\ud83e\udd42"),C$=I$.reduce(((e,t,n)=>(e[n]=t,e)),[]),T$=I$.reduce(((e,t,n)=>(e[t.codePointAt(0)]=n,e)),[]);const k$=RJ({prefix:"\ud83d\ude80",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=C$[t]),"")},decode:function(e){const t=[];for(const n of e){const e=T$[n.codePointAt(0)];if(void 0===e)throw new Error("Non-base256emoji character: ".concat(n));t.push(e)}return new Uint8Array(t)}}),R$=xJ({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),x$=xJ({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),P$=PJ({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),D$=RJ({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),O$=new TextEncoder,N$=new TextDecoder,B$="json",L$=512,M$=e=>O$.encode(JSON.stringify(e)),U$=e=>JSON.parse(N$.decode(e)),F$="raw",K$=85,j$=e=>SJ(e),Z$=e=>SJ(e),z$=(e,t)=>{const{bytes:n,version:r}=e;return 0===r?W$(n,H$(e),t||DJ.encoder):Q$(n,H$(e),t||u$.encoder)},V$=new WeakMap,H$=e=>{const t=V$.get(e);if(null==t){const t=new Map;return V$.set(e,t),t}return t};class q${constructor(e,t,n,r){this.code=t,this.version=e,this.multihash=n,this.bytes=r,this["/"]=r}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==Y$)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==J$)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return q$.createV0(t)}default:throw Error("Can not convert CID version ".concat(this.version," to version 0. This is a bug please report"))}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=eX(e,t);return q$.createV1(this.code,n)}case 1:return this;default:throw Error("Can not convert CID version ".concat(this.version," to version 1. This is a bug please report"))}}equals(e){return q$.equals(this,e)}static equals(e,t){const n=t;return n&&e.code===n.code&&e.version===n.version&&((e,t)=>{if(e===t)return!0;{const n=t;return e.code===n.code&&e.size===n.size&&n.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0})(e.bytes,n.bytes)}})(e.multihash,n.multihash)}toString(e){return z$(this,e)}toJSON(){return{"/":z$(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID(".concat(this.toString(),")")}static asCID(e){if(null==e)return null;const t=e;if(t instanceof q$)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:n,multihash:r,bytes:i}=t;return new q$(e,n,r,i||X$(e,n,r.bytes))}if(!0===t[$$]){const{version:e,multihash:n,code:r}=t,i=tX(n);return q$.create(e,r,i)}return null}static create(e,t,n){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==Y$)throw new Error("Version 0 CID must use dag-pb (code: ".concat(Y$,") block encoding"));return new q$(e,t,n,n.bytes);case 1:{const r=X$(e,t,n.bytes);return new q$(e,t,n,r)}default:throw new Error("Invalid version")}}static createV0(e){return q$.create(0,Y$,e)}static createV1(e,t){return q$.create(1,e,t)}static decode(e){const[t,n]=q$.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=q$.inspectBytes(e),n=t.size-t.multihashSize,r=SJ(e.subarray(n,n+t.multihashSize));if(r.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=r.subarray(t.multihashSize-t.digestSize),o=new nX(t.multihashCode,t.digestSize,i,r);return[0===t.version?q$.createV0(o):q$.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[n,r]=JJ(e.subarray(t));return t+=r,n};let r=n(),i=Y$;if(18===r?(r=0,t=0):i=n(),0!==r&&1!==r)throw new RangeError("Invalid CID version ".concat(r));const o=t,s=n(),a=n(),c=t+a;return{version:r,codec:i,multihashCode:s,digestSize:a,multihashSize:c-o,size:c}}static parse(e,t){const[n,r]=G$(e,t),i=q$.decode(r);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return H$(i).set(n,e),i}}const G$=(e,t)=>{switch(e[0]){case"Q":{const n=t||DJ;return[DJ.prefix,n.decode("".concat(DJ.prefix).concat(e))]}case DJ.prefix:{const n=t||DJ;return[DJ.prefix,n.decode(e)]}case u$.prefix:{const n=t||u$;return[u$.prefix,n.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},W$=(e,t,n)=>{const{prefix:r}=n;if(r!==DJ.prefix)throw Error("Cannot string encode V0 in ".concat(n.name," encoding"));const i=t.get(r);if(null==i){const i=n.encode(e).slice(1);return t.set(r,i),i}return i},Q$=(e,t,n)=>{const{prefix:r}=n,i=t.get(r);if(null==i){const i=n.encode(e);return t.set(r,i),i}return i},Y$=112,J$=18,X$=(e,t,n)=>{const r=$J(e),i=r+$J(t),o=new Uint8Array(i+n.byteLength);return XJ(e,o,0),XJ(t,o,r),o.set(n,i),o},$$=Symbol.for("@ipld/js-cid/CID"),e0={...fn,...ln,...dn,...an,...cn,...sn,...hn,...Xt,...tn,...un},t0=Symbol.for("nodejs.util.inspect.custom"),n0=Object.values(e0).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)),e0.identity.decoder),r0=114,i0=36,o0=37;class s0{constructor(e){(0,Yo.Z)(this,"type",void 0),(0,Yo.Z)(this,"multihash",void 0),(0,Yo.Z)(this,"privateKey",void 0),(0,Yo.Z)(this,"publicKey",void 0),(0,Yo.Z)(this,"string",void 0),(0,Yo.Z)(this,w$,!0),this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return"PeerId(".concat(this.toString(),")")}toString(){return null==this.string&&(this.string=DJ.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return q$.createV1(r0,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){var t;if(e instanceof Uint8Array)return(0,Ms.f)(this.multihash.bytes,e);if("string"===typeof e)return function(e,t){var n;if(t=null!==(n=t)&&void 0!==n?n:n0,"1"===e.charAt(0)||"Q"===e.charAt(0)){const t=tX(DJ.decode("z".concat(e)));return e.startsWith("12D")?new c0({multihash:t}):e.startsWith("16U")?new l0({multihash:t}):new a0({multihash:t})}return function(e){try{const t=tX(e);if(t.code===iX.code){if(t.digest.length===i0)return new c0({multihash:t});if(t.digest.length===o0)return new l0({multihash:t})}if(t.code===cX.code)return new a0({multihash:t})}catch{return function(e){if(null==e||null==e.multihash||null==e.version||1===e.version&&e.code!==r0)throw new Error("Supplied PeerID CID is invalid");const t=e.multihash;if(t.code===cX.code)return new a0({multihash:e.multihash});if(t.code===iX.code){if(t.digest.length===i0)return new c0({multihash:e.multihash});if(t.digest.length===o0)return new l0({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}(q$.decode(e))}throw new Error("Supplied PeerID CID is invalid")}(n0.decode(e))}(e).equals(this);if(null!=(null===e||void 0===e||null===(t=e.multihash)||void 0===t?void 0:t.bytes))return(0,Ms.f)(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[t0](){return"PeerId(".concat(this.toString(),")")}}class a0 extends s0{constructor(e){super({...e,type:"RSA"}),(0,Yo.Z)(this,"type","RSA"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.publicKey}}class c0 extends s0{constructor(e){super({...e,type:"Ed25519"}),(0,Yo.Z)(this,"type","Ed25519"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.multihash.digest}}class l0 extends s0{constructor(e){super({...e,type:"secp256k1"}),(0,Yo.Z)(this,"type","secp256k1"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.multihash.digest}}const u0="/",h0=(new TextEncoder).encode(u0),d0=h0[0];class f0{constructor(e,t){if((0,Yo.Z)(this,"_buf",void 0),"string"===typeof e)this._buf=(0,yu.m)(e);else{if(!(e instanceof Uint8Array))throw new Error("Invalid key, should be String of Uint8Array");this._buf=e}if(null==t&&(t=!0),t&&this.clean(),0===this._buf.byteLength||this._buf[0]!==d0)throw new Error("Invalid key")}toString(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"utf8";return(0,Au.B)(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return"Key(".concat(this.toString(),")")}static withNamespaces(e){return new f0(e.join(u0))}static random(){return new f0(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21;return crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+((t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_")),"")}().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||"string"===typeof e?new f0(e):"function"===typeof e.uint8Array?new f0(e.uint8Array()):null}clean(){if(null!=this._buf&&0!==this._buf.byteLength||(this._buf=h0),this._buf[0]!==d0){const e=new Uint8Array(this._buf.byteLength+1);e.fill(d0,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===d0;)this._buf=this._buf.subarray(0,-1)}less(e){const t=this.list(),n=e.list();for(let r=0;r<t.length;r++){if(n.length<r+1)return!1;const e=t[r],i=n[r];if(e<i)return!0;if(e>i)return!1}return t.length<n.length}reverse(){return f0.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){const e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(u0).slice(1)}type(){return function(e){const t=e.split(":");if(t.length<2)return"";return t.slice(0,-1).join(":")}(this.baseNamespace())}name(){return function(e){const t=e.split(":");return t[t.length-1]}(this.baseNamespace())}instance(e){return new f0(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(u0)||(e+=u0),e+=this.type(),new f0(e)}parent(){const e=this.list();return 1===e.length?new f0(u0):new f0(e.slice(0,-1).join(u0))}child(e){return this.toString()===u0?e:e.toString()===u0?this:new f0(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()!==this.toString()&&e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()!==this.toString()&&this.toString().startsWith(e.toString())}isTopLevel(){return 1===this.list().length}concat(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return f0.withNamespaces([...this.namespaces(),...(r=t.map((e=>e.namespaces())),[].concat(...r))]);var r}}var p0,g0=n(94804),y0=n(6327),m0=n.n(y0);!function(e){e.ERR_INVALID_PARAMETERS="ERR_INVALID_PARAMETERS",e.ERR_INVALID_KEY_NAME="ERR_INVALID_KEY_NAME",e.ERR_INVALID_KEY_TYPE="ERR_INVALID_KEY_TYPE",e.ERR_KEY_ALREADY_EXISTS="ERR_KEY_ALREADY_EXISTS",e.ERR_INVALID_KEY_SIZE="ERR_INVALID_KEY_SIZE",e.ERR_KEY_NOT_FOUND="ERR_KEY_NOT_FOUND",e.ERR_OLD_KEY_NAME_INVALID="ERR_OLD_KEY_NAME_INVALID",e.ERR_NEW_KEY_NAME_INVALID="ERR_NEW_KEY_NAME_INVALID",e.ERR_PASSWORD_REQUIRED="ERR_PASSWORD_REQUIRED",e.ERR_PEM_REQUIRED="ERR_PEM_REQUIRED",e.ERR_CANNOT_READ_KEY="ERR_CANNOT_READ_KEY",e.ERR_MISSING_PRIVATE_KEY="ERR_MISSING_PRIVATE_KEY",e.ERR_INVALID_OLD_PASS_TYPE="ERR_INVALID_OLD_PASS_TYPE",e.ERR_INVALID_NEW_PASS_TYPE="ERR_INVALID_NEW_PASS_TYPE",e.ERR_INVALID_PASS_LENGTH="ERR_INVALID_PASS_LENGTH"}(p0||(p0={}));const v0=b$("libp2p:keychain"),b0="/info/",w0=new WeakMap,E0=14,A0=16,S0=1e3,_0={dek:{keyLength:64,iterationCount:1e4,salt:"you should override this value with a crypto secure random number",hash:"sha2-512"}};function I0(e){return null!=e&&("string"===typeof e&&(e===m0()(e.trim())&&e.length>0))}async function C0(){const e=800*Math.random()+200;await new Promise((t=>setTimeout(t,e)))}function T0(e){return new f0("/pkcs8/"+e)}function k0(e){return new f0(b0+e)}class R0{constructor(e,t){var n,r,i,o,s,a,c,l,u,h;if((0,Yo.Z)(this,"components",void 0),(0,Yo.Z)(this,"init",void 0),this.components=e,this.init=(0,g0.Z)(_0,t),null!=this.init.pass&&(null===(n=this.init.pass)||void 0===n?void 0:n.length)<20)throw new Error("pass must be least 20 characters");if(null!=(null===(r=this.init.dek)||void 0===r?void 0:r.keyLength)&&this.init.dek.keyLength<E0)throw new Error("dek.keyLength must be least ".concat(E0," bytes"));if(null!=(null===(i=this.init.dek)||void 0===i||null===(o=i.salt)||void 0===o?void 0:o.length)&&this.init.dek.salt.length<A0)throw new Error("dek.saltLength must be least ".concat(A0," bytes"));if(null!=(null===(s=this.init.dek)||void 0===s?void 0:s.iterationCount)&&this.init.dek.iterationCount<S0)throw new Error("dek.iterationCount must be least ".concat(S0));const d=null!=this.init.pass&&null!=(null===(a=this.init.dek)||void 0===a?void 0:a.salt)?l$(this.init.pass,null===(c=this.init.dek)||void 0===c?void 0:c.salt,null===(l=this.init.dek)||void 0===l?void 0:l.iterationCount,null===(u=this.init.dek)||void 0===u?void 0:u.keyLength,null===(h=this.init.dek)||void 0===h?void 0:h.hash):"";w0.set(this,{dek:d})}static generateOptions(){const e=Object.assign({},_0),t=3*Math.ceil(A0/3);return e.dek.salt=(0,Au.B)(BX(t),"base64"),e}static get options(){return _0}async createKey(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2048;if(!I0(e)||"self"===e)throw await C0(),new yJ("Invalid key name",p0.ERR_INVALID_KEY_NAME);if("string"!==typeof t)throw await C0(),new yJ("Invalid key type",p0.ERR_INVALID_KEY_TYPE);const r=T0(e);if(await this.components.datastore.has(r))throw await C0(),new yJ("Key name already exists",p0.ERR_KEY_ALREADY_EXISTS);if("rsa"===t.toLowerCase())if(!Number.isSafeInteger(n)||n<2048)throw await C0(),new yJ("Invalid RSA key size",p0.ERR_INVALID_KEY_SIZE);let i;try{const o=await async function(e,t){return r$(e).generateKeyPair(null!==t&&void 0!==t?t:2048)}(t,n),s=await o.id(),a=w0.get(this);if(null==a)throw new yJ("dek missing",p0.ERR_INVALID_PARAMETERS);const c=a.dek,l=await o.export(c);i={name:e,id:s};const u=this.components.datastore.batch();u.put(r,(0,yu.m)(l)),u.put(k0(e),(0,yu.m)(JSON.stringify(i))),await u.commit()}catch(o){throw await C0(),o}return i}async listKeys(){const e={prefix:b0},t=[];for await(const n of this.components.datastore.query(e))t.push(JSON.parse((0,Au.B)(n.value)));return t}async findKeyById(e){try{const t=(await this.listKeys()).find((t=>t.id===e));if(null==t)throw new yJ("Key with id '".concat(e,"' does not exist."),p0.ERR_KEY_NOT_FOUND);return t}catch(t){throw await C0(),t}}async findKeyByName(e){if(!I0(e))throw await C0(),new yJ("Invalid key name '".concat(e,"'"),p0.ERR_INVALID_KEY_NAME);const t=k0(e);try{const e=await this.components.datastore.get(t);return JSON.parse((0,Au.B)(e))}catch(n){throw await C0(),v0.error(n),new yJ("Key '".concat(e,"' does not exist."),p0.ERR_KEY_NOT_FOUND)}}async removeKey(e){if(!I0(e)||"self"===e)throw await C0(),new yJ("Invalid key name '".concat(e,"'"),p0.ERR_INVALID_KEY_NAME);const t=T0(e),n=await this.findKeyByName(e),r=this.components.datastore.batch();return r.delete(t),r.delete(k0(e)),await r.commit(),n}async renameKey(e,t){if(!I0(e)||"self"===e)throw await C0(),new yJ("Invalid old key name '".concat(e,"'"),p0.ERR_OLD_KEY_NAME_INVALID);if(!I0(t)||"self"===t)throw await C0(),new yJ("Invalid new key name '".concat(t,"'"),p0.ERR_NEW_KEY_NAME_INVALID);const n=T0(e),r=T0(t),i=k0(e),o=k0(t);if(await this.components.datastore.has(r))throw await C0(),new yJ("Key '".concat(t,"' already exists"),p0.ERR_KEY_ALREADY_EXISTS);try{const e=await this.components.datastore.get(n),s=await this.components.datastore.get(i),a=JSON.parse((0,Au.B)(s));a.name=t;const c=this.components.datastore.batch();return c.put(r,e),c.put(o,(0,yu.m)(JSON.stringify(a))),c.delete(n),c.delete(i),await c.commit(),a}catch(s){throw await C0(),s}}async exportKey(e,t){if(!I0(e))throw await C0(),new yJ("Invalid key name '".concat(e,"'"),p0.ERR_INVALID_KEY_NAME);if(null==t)throw await C0(),new yJ("Password is required",p0.ERR_PASSWORD_REQUIRED);const n=T0(e);try{const e=await this.components.datastore.get(n),r=(0,Au.B)(e),i=w0.get(this);if(null==i)throw new yJ("dek missing",p0.ERR_INVALID_PARAMETERS);const o=i.dek,s=await o$(r,o);return await s.export(t)}catch(r){throw await C0(),r}}async exportPeerId(e){const t="temporary-password",n=await this.exportKey(e,t),r=await o$(n,t);return async function(e,t){return e.length===i0?new c0({multihash:eX(iX.code,e),privateKey:t}):e.length===o0?new l0({multihash:eX(iX.code,e),privateKey:t}):new a0({multihash:await cX.digest(e),publicKey:e,privateKey:t})}(r.public.bytes,r.bytes)}async importKey(e,t,n){if(!I0(e)||"self"===e)throw await C0(),new yJ("Invalid key name '".concat(e,"'"),p0.ERR_INVALID_KEY_NAME);if(null==t)throw await C0(),new yJ("PEM encoded key is required",p0.ERR_PEM_REQUIRED);const r=T0(e);if(await this.components.datastore.has(r))throw await C0(),new yJ("Key '".concat(e,"' already exists"),p0.ERR_KEY_ALREADY_EXISTS);let i,o;try{i=await o$(t,n)}catch(c){throw await C0(),new yJ("Cannot read the key, most likely the password is wrong",p0.ERR_CANNOT_READ_KEY)}try{o=await i.id();const e=w0.get(this);if(null==e)throw new yJ("dek missing",p0.ERR_INVALID_PARAMETERS);const n=e.dek;t=await i.export(n)}catch(c){throw await C0(),c}const s={name:e,id:o},a=this.components.datastore.batch();return a.put(r,(0,yu.m)(t)),a.put(k0(e),(0,yu.m)(JSON.stringify(s))),await a.commit(),s}async importPeer(e,t){try{if(!I0(e))throw new yJ("Invalid key name '".concat(e,"'"),p0.ERR_INVALID_KEY_NAME);if(null==t)throw new yJ("PeerId is required",p0.ERR_MISSING_PRIVATE_KEY);if(null==t.privateKey)throw new yJ("PeerId.privKey is required",p0.ERR_MISSING_PRIVATE_KEY);const n=await i$(t.privateKey),r=T0(e);if(await this.components.datastore.has(r))throw await C0(),new yJ("Key '".concat(e,"' already exists"),p0.ERR_KEY_ALREADY_EXISTS);const i=w0.get(this);if(null==i)throw new yJ("dek missing",p0.ERR_INVALID_PARAMETERS);const o=i.dek,s=await n.export(o),a={name:e,id:t.toString()},c=this.components.datastore.batch();return c.put(r,(0,yu.m)(s)),c.put(k0(e),(0,yu.m)(JSON.stringify(a))),await c.commit(),a}catch(n){throw await C0(),n}}async getPrivateKey(e){if(!I0(e))throw await C0(),new yJ("Invalid key name '".concat(e,"'"),p0.ERR_INVALID_KEY_NAME);try{const t=T0(e),n=await this.components.datastore.get(t);return(0,Au.B)(n)}catch(t){throw await C0(),v0.error(t),new yJ("Key '".concat(e,"' does not exist."),p0.ERR_KEY_NOT_FOUND)}}async rotateKeychainPass(e,t){var n,r,i,o;if("string"!==typeof e)throw await C0(),new yJ("Invalid old pass type '".concat(typeof e,"'"),p0.ERR_INVALID_OLD_PASS_TYPE);if("string"!==typeof t)throw await C0(),new yJ("Invalid new pass type '".concat(typeof t,"'"),p0.ERR_INVALID_NEW_PASS_TYPE);if(t.length<20)throw await C0(),new yJ("Invalid pass length ".concat(t.length),p0.ERR_INVALID_PASS_LENGTH);v0("recreating keychain");const s=w0.get(this);if(null==s)throw new yJ("dek missing",p0.ERR_INVALID_PARAMETERS);const a=s.dek;this.init.pass=t;const c=null!=t&&null!=(null===(n=this.init.dek)||void 0===n?void 0:n.salt)?l$(t,this.init.dek.salt,null===(r=this.init.dek)||void 0===r?void 0:r.iterationCount,null===(i=this.init.dek)||void 0===i?void 0:i.keyLength,null===(o=this.init.dek)||void 0===o?void 0:o.hash):"";w0.set(this,{dek:c});const l=await this.listKeys();for(const u of l){const e=await this.components.datastore.get(T0(u.name)),t=(0,Au.B)(e),n=await o$(t,a),r=c.toString(),i=await n.export(r),o=this.components.datastore.batch(),s={name:u.name,id:u.id};o.put(T0(u.name),(0,yu.m)(i)),o.put(k0(u.name),(0,yu.m)(JSON.stringify(s))),await o.commit()}v0("keychain reconstructed")}}const x0=Symbol.for("@libp2p/peer-id");function P0(e){return null!=e&&Boolean(e[x0])}const D0=zV({prefix:"9",name:"base10",alphabet:"0123456789"}),O0=VV({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),N0=VV({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),B0=VV({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),L0=Array.from("\ud83d\ude80\ud83e\ude90\u2604\ud83d\udef0\ud83c\udf0c\ud83c\udf11\ud83c\udf12\ud83c\udf13\ud83c\udf14\ud83c\udf15\ud83c\udf16\ud83c\udf17\ud83c\udf18\ud83c\udf0d\ud83c\udf0f\ud83c\udf0e\ud83d\udc09\u2600\ud83d\udcbb\ud83d\udda5\ud83d\udcbe\ud83d\udcbf\ud83d\ude02\u2764\ud83d\ude0d\ud83e\udd23\ud83d\ude0a\ud83d\ude4f\ud83d\udc95\ud83d\ude2d\ud83d\ude18\ud83d\udc4d\ud83d\ude05\ud83d\udc4f\ud83d\ude01\ud83d\udd25\ud83e\udd70\ud83d\udc94\ud83d\udc96\ud83d\udc99\ud83d\ude22\ud83e\udd14\ud83d\ude06\ud83d\ude44\ud83d\udcaa\ud83d\ude09\u263a\ud83d\udc4c\ud83e\udd17\ud83d\udc9c\ud83d\ude14\ud83d\ude0e\ud83d\ude07\ud83c\udf39\ud83e\udd26\ud83c\udf89\ud83d\udc9e\u270c\u2728\ud83e\udd37\ud83d\ude31\ud83d\ude0c\ud83c\udf38\ud83d\ude4c\ud83d\ude0b\ud83d\udc97\ud83d\udc9a\ud83d\ude0f\ud83d\udc9b\ud83d\ude42\ud83d\udc93\ud83e\udd29\ud83d\ude04\ud83d\ude00\ud83d\udda4\ud83d\ude03\ud83d\udcaf\ud83d\ude48\ud83d\udc47\ud83c\udfb6\ud83d\ude12\ud83e\udd2d\u2763\ud83d\ude1c\ud83d\udc8b\ud83d\udc40\ud83d\ude2a\ud83d\ude11\ud83d\udca5\ud83d\ude4b\ud83d\ude1e\ud83d\ude29\ud83d\ude21\ud83e\udd2a\ud83d\udc4a\ud83e\udd73\ud83d\ude25\ud83e\udd24\ud83d\udc49\ud83d\udc83\ud83d\ude33\u270b\ud83d\ude1a\ud83d\ude1d\ud83d\ude34\ud83c\udf1f\ud83d\ude2c\ud83d\ude43\ud83c\udf40\ud83c\udf37\ud83d\ude3b\ud83d\ude13\u2b50\u2705\ud83e\udd7a\ud83c\udf08\ud83d\ude08\ud83e\udd18\ud83d\udca6\u2714\ud83d\ude23\ud83c\udfc3\ud83d\udc90\u2639\ud83c\udf8a\ud83d\udc98\ud83d\ude20\u261d\ud83d\ude15\ud83c\udf3a\ud83c\udf82\ud83c\udf3b\ud83d\ude10\ud83d\udd95\ud83d\udc9d\ud83d\ude4a\ud83d\ude39\ud83d\udde3\ud83d\udcab\ud83d\udc80\ud83d\udc51\ud83c\udfb5\ud83e\udd1e\ud83d\ude1b\ud83d\udd34\ud83d\ude24\ud83c\udf3c\ud83d\ude2b\u26bd\ud83e\udd19\u2615\ud83c\udfc6\ud83e\udd2b\ud83d\udc48\ud83d\ude2e\ud83d\ude46\ud83c\udf7b\ud83c\udf43\ud83d\udc36\ud83d\udc81\ud83d\ude32\ud83c\udf3f\ud83e\udde1\ud83c\udf81\u26a1\ud83c\udf1e\ud83c\udf88\u274c\u270a\ud83d\udc4b\ud83d\ude30\ud83e\udd28\ud83d\ude36\ud83e\udd1d\ud83d\udeb6\ud83d\udcb0\ud83c\udf53\ud83d\udca2\ud83e\udd1f\ud83d\ude41\ud83d\udea8\ud83d\udca8\ud83e\udd2c\u2708\ud83c\udf80\ud83c\udf7a\ud83e\udd13\ud83d\ude19\ud83d\udc9f\ud83c\udf31\ud83d\ude16\ud83d\udc76\ud83e\udd74\u25b6\u27a1\u2753\ud83d\udc8e\ud83d\udcb8\u2b07\ud83d\ude28\ud83c\udf1a\ud83e\udd8b\ud83d\ude37\ud83d\udd7a\u26a0\ud83d\ude45\ud83d\ude1f\ud83d\ude35\ud83d\udc4e\ud83e\udd32\ud83e\udd20\ud83e\udd27\ud83d\udccc\ud83d\udd35\ud83d\udc85\ud83e\uddd0\ud83d\udc3e\ud83c\udf52\ud83d\ude17\ud83e\udd11\ud83c\udf0a\ud83e\udd2f\ud83d\udc37\u260e\ud83d\udca7\ud83d\ude2f\ud83d\udc86\ud83d\udc46\ud83c\udfa4\ud83d\ude47\ud83c\udf51\u2744\ud83c\udf34\ud83d\udca3\ud83d\udc38\ud83d\udc8c\ud83d\udccd\ud83e\udd40\ud83e\udd22\ud83d\udc45\ud83d\udca1\ud83d\udca9\ud83d\udc50\ud83d\udcf8\ud83d\udc7b\ud83e\udd10\ud83e\udd2e\ud83c\udfbc\ud83e\udd75\ud83d\udea9\ud83c\udf4e\ud83c\udf4a\ud83d\udc7c\ud83d\udc8d\ud83d\udce3\ud83e\udd42"),M0=L0.reduce(((e,t,n)=>(e[n]=t,e)),[]),U0=L0.reduce(((e,t,n)=>(e[t.codePointAt(0)]=n,e)),[]);const F0=ZV({prefix:"\ud83d\ude80",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=M0[t]),"")},decode:function(e){const t=[];for(const n of e){const e=U0[n.codePointAt(0)];if(void 0===e)throw new Error("Non-base256emoji character: ".concat(n));t.push(e)}return new Uint8Array(t)}}),K0=VV({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),j0=ZV({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),Z0={...En,...vn,...wn,...yn,...mn,...jt,...Ht,...Zt,...zt,...bn},z0=Symbol.for("nodejs.util.inspect.custom"),V0=Object.values(Z0).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)),Z0.identity.decoder),H0=114,q0=36,G0=37;class W0{constructor(e){(0,Yo.Z)(this,"type",void 0),(0,Yo.Z)(this,"multihash",void 0),(0,Yo.Z)(this,"privateKey",void 0),(0,Yo.Z)(this,"publicKey",void 0),(0,Yo.Z)(this,"string",void 0),(0,Yo.Z)(this,x0,!0),this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return"PeerId(".concat(this.toString(),")")}toString(){return null==this.string&&(this.string=eH.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return YH.createV1(H0,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){var t;if(e instanceof Uint8Array)return(0,Ms.f)(this.multihash.bytes,e);if("string"===typeof e)return X0(e).equals(this);if(null!=(null===e||void 0===e||null===(t=e.multihash)||void 0===t?void 0:t.bytes))return(0,Ms.f)(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[z0](){return"PeerId(".concat(this.toString(),")")}}class Q0 extends W0{constructor(e){super({...e,type:"RSA"}),(0,Yo.Z)(this,"type","RSA"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.publicKey}}class Y0 extends W0{constructor(e){super({...e,type:"Ed25519"}),(0,Yo.Z)(this,"type","Ed25519"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.multihash.digest}}class J0 extends W0{constructor(e){super({...e,type:"secp256k1"}),(0,Yo.Z)(this,"type","secp256k1"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.multihash.digest}}function X0(e,t){var n;if(t=null!==(n=t)&&void 0!==n?n:V0,"1"===e.charAt(0)||"Q"===e.charAt(0)){const t=HH(eH.decode("z".concat(e)));return e.startsWith("12D")?new Y0({multihash:t}):e.startsWith("16U")?new J0({multihash:t}):new Q0({multihash:t})}return $0(V0.decode(e))}function $0(e){try{const t=HH(e);if(t.code===sY.code){if(t.digest.length===q0)return new Y0({multihash:t});if(t.digest.length===G0)return new J0({multihash:t})}if(t.code===pq.code)return new Q0({multihash:t})}catch{return function(e){if(null==e||null==e.multihash||null==e.version||1===e.version&&e.code!==H0)throw new Error("Supplied PeerID CID is invalid");const t=e.multihash;if(t.code===pq.code)return new Q0({multihash:e.multihash});if(t.code===sY.code){if(t.digest.length===q0)return new Y0({multihash:e.multihash});if(t.digest.length===G0)return new J0({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}(YH.decode(e))}throw new Error("Supplied PeerID CID is invalid")}async function e1(e,t){return e.length===q0?new Y0({multihash:VH(sY.code,e),privateKey:t}):e.length===G0?new J0({multihash:VH(sY.code,e),privateKey:t}):new Q0({multihash:await pq.digest(e),publicKey:e,privateKey:t})}const t1=function(e){if(null!=e[Symbol.asyncIterator])return(async()=>{const t=[];for await(const n of e)t.push(n);return t})();const t=[];for(const n of e)t.push(n);return t};var n1=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==n[s])throw new TypeError(o+" is ambiguous");n[s]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var r=0,i=0;e[t]===c;)r++,t++;for(var o=(e.length-t)*l+1>>>0,s=new Uint8Array(o);e[t];){var u=n[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=o-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*s[d]>>>0,s[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=o-i;f!==o&&0===s[f];)f++;for(var p=new Uint8Array(r+(o-f)),g=r;f!==o;)p[g++]=s[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,o=t.length;i!==o&&0===t[i];)i++,n++;for(var s=(o-i)*u+1>>>0,l=new Uint8Array(s);i!==o;){for(var h=t[i],d=0,f=s-1;(0!==h||d<r)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");r=d,i++}for(var p=s-r;p!==s&&0===l[p];)p++;for(var g=c.repeat(n);p<s;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:h,decode:function(e){var n=h(e);if(n)return n;throw new Error("Non-".concat(t," character"))}}};const r1=n1,i1=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class o1{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(e));throw Error("Unknown type, must be binary type")}}class s1{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(e),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return c1(this,e)}}class a1{constructor(e){this.decoders=e}or(e){return c1(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(e),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}}const c1=(e,t)=>new a1({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class l1{constructor(e,t,n,r){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=r,this.encoder=new o1(e,t,n),this.decoder=new s1(e,t,r)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const u1=e=>{let{name:t,prefix:n,encode:r,decode:i}=e;return new l1(t,n,r,i)},h1=e=>{let{prefix:t,name:n,alphabet:r}=e;const{encode:i,decode:o}=r1(r,n);return u1({prefix:t,name:n,encode:i,decode:e=>i1(o(e))})},d1=e=>{let{name:t,prefix:n,bitsPerChar:r,alphabet:i}=e;return u1({prefix:n,name:t,encode:e=>((e,t,n)=>{const r="="===t[t.length-1],i=(1<<n)-1;let o="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>n;)s-=n,o+=t[i&a>>s];if(s&&(o+=t[i&a<<n-s]),r)for(;o.length*n&7;)o+="=";return o})(e,i,r),decode:e=>((e,t,n,r)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*n/8|0);let a=0,c=0,l=0;for(let u=0;u<o;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError("Non-".concat(r," character"));c=c<<n|t,a+=n,a>=8&&(a-=8,s[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s})(e,i,r,t)})},f1=h1({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),p1=h1({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),g1=h1({prefix:"9",name:"base10",alphabet:"0123456789"}),y1=d1({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),m1=d1({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),v1=d1({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),b1=Array.from("\ud83d\ude80\ud83e\ude90\u2604\ud83d\udef0\ud83c\udf0c\ud83c\udf11\ud83c\udf12\ud83c\udf13\ud83c\udf14\ud83c\udf15\ud83c\udf16\ud83c\udf17\ud83c\udf18\ud83c\udf0d\ud83c\udf0f\ud83c\udf0e\ud83d\udc09\u2600\ud83d\udcbb\ud83d\udda5\ud83d\udcbe\ud83d\udcbf\ud83d\ude02\u2764\ud83d\ude0d\ud83e\udd23\ud83d\ude0a\ud83d\ude4f\ud83d\udc95\ud83d\ude2d\ud83d\ude18\ud83d\udc4d\ud83d\ude05\ud83d\udc4f\ud83d\ude01\ud83d\udd25\ud83e\udd70\ud83d\udc94\ud83d\udc96\ud83d\udc99\ud83d\ude22\ud83e\udd14\ud83d\ude06\ud83d\ude44\ud83d\udcaa\ud83d\ude09\u263a\ud83d\udc4c\ud83e\udd17\ud83d\udc9c\ud83d\ude14\ud83d\ude0e\ud83d\ude07\ud83c\udf39\ud83e\udd26\ud83c\udf89\ud83d\udc9e\u270c\u2728\ud83e\udd37\ud83d\ude31\ud83d\ude0c\ud83c\udf38\ud83d\ude4c\ud83d\ude0b\ud83d\udc97\ud83d\udc9a\ud83d\ude0f\ud83d\udc9b\ud83d\ude42\ud83d\udc93\ud83e\udd29\ud83d\ude04\ud83d\ude00\ud83d\udda4\ud83d\ude03\ud83d\udcaf\ud83d\ude48\ud83d\udc47\ud83c\udfb6\ud83d\ude12\ud83e\udd2d\u2763\ud83d\ude1c\ud83d\udc8b\ud83d\udc40\ud83d\ude2a\ud83d\ude11\ud83d\udca5\ud83d\ude4b\ud83d\ude1e\ud83d\ude29\ud83d\ude21\ud83e\udd2a\ud83d\udc4a\ud83e\udd73\ud83d\ude25\ud83e\udd24\ud83d\udc49\ud83d\udc83\ud83d\ude33\u270b\ud83d\ude1a\ud83d\ude1d\ud83d\ude34\ud83c\udf1f\ud83d\ude2c\ud83d\ude43\ud83c\udf40\ud83c\udf37\ud83d\ude3b\ud83d\ude13\u2b50\u2705\ud83e\udd7a\ud83c\udf08\ud83d\ude08\ud83e\udd18\ud83d\udca6\u2714\ud83d\ude23\ud83c\udfc3\ud83d\udc90\u2639\ud83c\udf8a\ud83d\udc98\ud83d\ude20\u261d\ud83d\ude15\ud83c\udf3a\ud83c\udf82\ud83c\udf3b\ud83d\ude10\ud83d\udd95\ud83d\udc9d\ud83d\ude4a\ud83d\ude39\ud83d\udde3\ud83d\udcab\ud83d\udc80\ud83d\udc51\ud83c\udfb5\ud83e\udd1e\ud83d\ude1b\ud83d\udd34\ud83d\ude24\ud83c\udf3c\ud83d\ude2b\u26bd\ud83e\udd19\u2615\ud83c\udfc6\ud83e\udd2b\ud83d\udc48\ud83d\ude2e\ud83d\ude46\ud83c\udf7b\ud83c\udf43\ud83d\udc36\ud83d\udc81\ud83d\ude32\ud83c\udf3f\ud83e\udde1\ud83c\udf81\u26a1\ud83c\udf1e\ud83c\udf88\u274c\u270a\ud83d\udc4b\ud83d\ude30\ud83e\udd28\ud83d\ude36\ud83e\udd1d\ud83d\udeb6\ud83d\udcb0\ud83c\udf53\ud83d\udca2\ud83e\udd1f\ud83d\ude41\ud83d\udea8\ud83d\udca8\ud83e\udd2c\u2708\ud83c\udf80\ud83c\udf7a\ud83e\udd13\ud83d\ude19\ud83d\udc9f\ud83c\udf31\ud83d\ude16\ud83d\udc76\ud83e\udd74\u25b6\u27a1\u2753\ud83d\udc8e\ud83d\udcb8\u2b07\ud83d\ude28\ud83c\udf1a\ud83e\udd8b\ud83d\ude37\ud83d\udd7a\u26a0\ud83d\ude45\ud83d\ude1f\ud83d\ude35\ud83d\udc4e\ud83e\udd32\ud83e\udd20\ud83e\udd27\ud83d\udccc\ud83d\udd35\ud83d\udc85\ud83e\uddd0\ud83d\udc3e\ud83c\udf52\ud83d\ude17\ud83e\udd11\ud83c\udf0a\ud83e\udd2f\ud83d\udc37\u260e\ud83d\udca7\ud83d\ude2f\ud83d\udc86\ud83d\udc46\ud83c\udfa4\ud83d\ude47\ud83c\udf51\u2744\ud83c\udf34\ud83d\udca3\ud83d\udc38\ud83d\udc8c\ud83d\udccd\ud83e\udd40\ud83e\udd22\ud83d\udc45\ud83d\udca1\ud83d\udca9\ud83d\udc50\ud83d\udcf8\ud83d\udc7b\ud83e\udd10\ud83e\udd2e\ud83c\udfbc\ud83e\udd75\ud83d\udea9\ud83c\udf4e\ud83c\udf4a\ud83d\udc7c\ud83d\udc8d\ud83d\udce3\ud83e\udd42"),w1=b1.reduce(((e,t,n)=>(e[n]=t,e)),[]),E1=b1.reduce(((e,t,n)=>(e[t.codePointAt(0)]=n,e)),[]);const A1=u1({prefix:"\ud83d\ude80",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=w1[t]),"")},decode:function(e){const t=[];for(const n of e){const e=E1[n.codePointAt(0)];if(void 0===e)throw new Error("Non-base256emoji character: ".concat(n));t.push(e)}return new Uint8Array(t)}}),S1=d1({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),_1=d1({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),I1=d1({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),C1=d1({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),T1=d1({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),k1=d1({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),R1=d1({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),x1=d1({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),P1=d1({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),D1=h1({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),O1=h1({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),N1=d1({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),B1=d1({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),L1=d1({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),M1=d1({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),U1=d1({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),F1=u1({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),K1=new TextEncoder,j1=new TextDecoder,Z1="json",z1=512,V1=e=>K1.encode(JSON.stringify(e)),H1=e=>JSON.parse(j1.decode(e)),q1="raw",G1=85,W1=e=>i1(e),Q1=e=>i1(e);var Y1=function e(t,n,r){n=n||[];var i=r=r||0;for(;t>=$1;)n[r++]=255&t|J1,t/=128;for(;t&X1;)n[r++]=255&t|J1,t>>>=7;return n[r]=0|t,e.bytes=r-i+1,n},J1=128,X1=-128,$1=Math.pow(2,31);var e2=function e(t,n){var r,i=0,o=0,s=n=n||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");r=t[s++],i+=o<28?(r&n2)<<o:(r&n2)*Math.pow(2,o),o+=7}while(r>=t2);return e.bytes=s-n,i},t2=128,n2=127;var r2=Math.pow(2,7),i2=Math.pow(2,14),o2=Math.pow(2,21),s2=Math.pow(2,28),a2=Math.pow(2,35),c2=Math.pow(2,42),l2=Math.pow(2,49),u2=Math.pow(2,56),h2=Math.pow(2,63);const d2={encode:Y1,decode:e2,encodingLength:function(e){return e<r2?1:e<i2?2:e<o2?3:e<s2?4:e<a2?5:e<c2?6:e<l2?7:e<u2?8:e<h2?9:10}},f2=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return[d2.decode(e,t),d2.decode.bytes]},p2=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return d2.encode(e,t,n),t},g2=e=>d2.encodingLength(e),y2=(e,t)=>{const n=t.byteLength,r=g2(e),i=r+g2(n),o=new Uint8Array(i+n);return p2(e,o,0),p2(n,o,r),o.set(t,i),new v2(e,n,t,o)},m2=e=>{const t=i1(e),[n,r]=f2(t),[i,o]=f2(t.subarray(r)),s=t.subarray(r+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new v2(n,i,s,t)};class v2{constructor(e,t,n,r){this.code=e,this.size=t,this.digest=n,this.bytes=r}}const b2=i1,w2={code:0,name:"identity",encode:b2,digest:e=>y2(0,b2(e))},E2=e=>{let{name:t,code:n,encode:r}=e;return new A2(t,n,r)};class A2{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?y2(this.code,t):t.then((e=>y2(this.code,e)))}throw Error("Unknown type, must be binary type")}}const S2=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),_2=E2({name:"sha2-256",code:18,encode:S2("SHA-256")}),I2=E2({name:"sha2-512",code:19,encode:S2("SHA-512")}),C2=(e,t)=>{const{bytes:n,version:r}=e;return 0===r?P2(n,k2(e),t||f1.encoder):D2(n,k2(e),t||S1.encoder)},T2=new WeakMap,k2=e=>{const t=T2.get(e);if(null==t){const t=new Map;return T2.set(e,t),t}return t};class R2{constructor(e,t,n,r){this.code=t,this.version=e,this.multihash=n,this.bytes=r,this["/"]=r}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==O2)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==N2)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return R2.createV0(t)}default:throw Error("Can not convert CID version ".concat(this.version," to version 0. This is a bug please report"))}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=y2(e,t);return R2.createV1(this.code,n)}case 1:return this;default:throw Error("Can not convert CID version ".concat(this.version," to version 1. This is a bug please report"))}}equals(e){return R2.equals(this,e)}static equals(e,t){const n=t;return n&&e.code===n.code&&e.version===n.version&&((e,t)=>{if(e===t)return!0;{const n=t;return e.code===n.code&&e.size===n.size&&n.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0})(e.bytes,n.bytes)}})(e.multihash,n.multihash)}toString(e){return C2(this,e)}toJSON(){return{"/":C2(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID(".concat(this.toString(),")")}static asCID(e){if(null==e)return null;const t=e;if(t instanceof R2)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:n,multihash:r,bytes:i}=t;return new R2(e,n,r,i||B2(e,n,r.bytes))}if(!0===t[L2]){const{version:e,multihash:n,code:r}=t,i=m2(n);return R2.create(e,r,i)}return null}static create(e,t,n){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==O2)throw new Error("Version 0 CID must use dag-pb (code: ".concat(O2,") block encoding"));return new R2(e,t,n,n.bytes);case 1:{const r=B2(e,t,n.bytes);return new R2(e,t,n,r)}default:throw new Error("Invalid version")}}static createV0(e){return R2.create(0,O2,e)}static createV1(e,t){return R2.create(1,e,t)}static decode(e){const[t,n]=R2.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=R2.inspectBytes(e),n=t.size-t.multihashSize,r=i1(e.subarray(n,n+t.multihashSize));if(r.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=r.subarray(t.multihashSize-t.digestSize),o=new v2(t.multihashCode,t.digestSize,i,r);return[0===t.version?R2.createV0(o):R2.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[n,r]=f2(e.subarray(t));return t+=r,n};let r=n(),i=O2;if(18===r?(r=0,t=0):i=n(),0!==r&&1!==r)throw new RangeError("Invalid CID version ".concat(r));const o=t,s=n(),a=n(),c=t+a;return{version:r,codec:i,multihashCode:s,digestSize:a,multihashSize:c-o,size:c}}static parse(e,t){const[n,r]=x2(e,t),i=R2.decode(r);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return k2(i).set(n,e),i}}const x2=(e,t)=>{switch(e[0]){case"Q":{const n=t||f1;return[f1.prefix,n.decode("".concat(f1.prefix).concat(e))]}case f1.prefix:{const n=t||f1;return[f1.prefix,n.decode(e)]}case S1.prefix:{const n=t||S1;return[S1.prefix,n.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},P2=(e,t,n)=>{const{prefix:r}=n;if(r!==f1.prefix)throw Error("Cannot string encode V0 in ".concat(n.name," encoding"));const i=t.get(r);if(null==i){const i=n.encode(e).slice(1);return t.set(r,i),i}return i},D2=(e,t,n)=>{const{prefix:r}=n,i=t.get(r);if(null==i){const i=n.encode(e);return t.set(r,i),i}return i},O2=112,N2=18,B2=(e,t,n)=>{const r=g2(e),i=r+g2(t),o=new Uint8Array(i+n.byteLength);return p2(e,o,0),p2(t,o,r),o.set(n,i),o},L2=Symbol.for("@ipld/js-cid/CID"),M2={...Pn,...In,...xn,...Sn,..._n,...Tn,...kn,...An,...Rn,...Cn},U2=Symbol.for("nodejs.util.inspect.custom"),F2=Object.values(M2).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)),M2.identity.decoder),K2=114,j2=36,Z2=37;class z2{constructor(e){(0,Yo.Z)(this,"type",void 0),(0,Yo.Z)(this,"multihash",void 0),(0,Yo.Z)(this,"privateKey",void 0),(0,Yo.Z)(this,"publicKey",void 0),(0,Yo.Z)(this,"string",void 0),(0,Yo.Z)(this,fu.Cs,!0),this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return"PeerId(".concat(this.toString(),")")}toString(){return null==this.string&&(this.string=f1.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return R2.createV1(K2,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){var t;if(e instanceof Uint8Array)return(0,Ms.f)(this.multihash.bytes,e);if("string"===typeof e)return function(e,t){var n;if(t=null!==(n=t)&&void 0!==n?n:F2,"1"===e.charAt(0)||"Q"===e.charAt(0)){const t=m2(f1.decode("z".concat(e)));return e.startsWith("12D")?new H2({multihash:t}):e.startsWith("16U")?new q2({multihash:t}):new V2({multihash:t})}return G2(F2.decode(e))}(e).equals(this);if(null!=(null===e||void 0===e||null===(t=e.multihash)||void 0===t?void 0:t.bytes))return(0,Ms.f)(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[U2](){return"PeerId(".concat(this.toString(),")")}}class V2 extends z2{constructor(e){super({...e,type:"RSA"}),(0,Yo.Z)(this,"type","RSA"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.publicKey}}class H2 extends z2{constructor(e){super({...e,type:"Ed25519"}),(0,Yo.Z)(this,"type","Ed25519"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.multihash.digest}}class q2 extends z2{constructor(e){super({...e,type:"secp256k1"}),(0,Yo.Z)(this,"type","secp256k1"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.multihash.digest}}function G2(e){try{const t=m2(e);if(t.code===w2.code){if(t.digest.length===j2)return new H2({multihash:t});if(t.digest.length===Z2)return new q2({multihash:t})}if(t.code===_2.code)return new V2({multihash:t})}catch{return function(e){if(null==e||null==e.multihash||null==e.version||1===e.version&&e.code!==K2)throw new Error("Supplied PeerID CID is invalid");const t=e.multihash;if(t.code===_2.code)return new V2({multihash:e.multihash});if(t.code===w2.code){if(t.digest.length===j2)return new H2({multihash:e.multihash});if(t.digest.length===Z2)return new q2({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}(R2.decode(e))}throw new Error("Supplied PeerID CID is invalid")}const W2="lock:worker:request-read",Q2="lock:worker:release-read",Y2="lock:master:grant-read",J2="lock:worker:request-write",X2="lock:worker:release-write",$2="lock:master:grant-write",e3={},t3=e=>{e.addEventListener("message",(t=>{t3.dispatchEvent("message",e,t)})),null!=e.port&&e.port.addEventListener("message",(t=>{t3.dispatchEvent("message",e,t)}))};t3.addEventListener=(e,t)=>{null==e3[e]&&(e3[e]=[]),e3[e].push(t)},t3.removeEventListener=(e,t)=>{null!=e3[e]&&(e3[e]=e3[e].filter((e=>e===t)))},t3.dispatchEvent=function(e,t,n){null!=e3[e]&&e3[e].forEach((e=>e(t,n)))};const n3=t3,r3=(e,t,n,r,i)=>(o,s)=>{if(s.data.type!==n)return;const a={type:s.data.type,name:s.data.name,identifier:s.data.identifier};e.dispatchEvent(new MessageEvent(t,{data:{name:a.name,handler:async()=>(o.postMessage({type:i,name:a.name,identifier:a.identifier}),await new Promise((e=>{const t=n=>{if(null==n||null==n.data)return;const i=n.data.type,s=(n.data.name,n.data.identifier);i===r&&s===a.identifier&&(o.removeEventListener("message",t),e())};o.addEventListener("message",t)})))}}))},i3=(e,t,n,r)=>async()=>{const i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21;return crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+((t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_")),"")}();return globalThis.postMessage({type:t,identifier:i,name:e}),await new Promise((t=>{const o=s=>{if(null==s||null==s.data)return;const a=s.data.type,c=s.data.identifier;a===n&&c===i&&(globalThis.removeEventListener("message",o),t((()=>{globalThis.postMessage({type:r,identifier:i,name:e})})))};globalThis.addEventListener("message",o)}))},o3={singleProcess:!1},s3={};let a3;async function c3(e,t){let n;const r=new Promise((e=>{n=e}));return e.add((async()=>await YB((async()=>await new Promise((e=>{n((()=>{e()}))})))(),{milliseconds:t.timeout}))),await r}const l3={name:"lock",concurrency:1/0,timeout:846e5,singleProcess:!1};function u3(e){const t=Object.assign({},l3,e);return null==a3&&(a3=(e=>{if(e=Object.assign({},o3,e),Boolean(globalThis.document)||e.singleProcess){const e=new EventTarget;return n3.addEventListener("message",r3(e,"requestReadLock",W2,Q2,Y2)),n3.addEventListener("message",r3(e,"requestWriteLock",J2,X2,$2)),e}return{isWorker:!0,readLock:e=>i3(e,W2,Y2,Q2),writeLock:e=>i3(e,J2,$2,X2)}})(t),!0!==a3.isWorker&&(a3.addEventListener("requestReadLock",(e=>{null!=s3[e.data.name]&&s3[e.data.name].readLock().then((async t=>await e.data.handler().finally((()=>t()))))})),a3.addEventListener("requestWriteLock",(async e=>{null!=s3[e.data.name]&&s3[e.data.name].writeLock().then((async t=>await e.data.handler().finally((()=>t()))))})))),null==s3[t.name]&&(s3[t.name]=((e,t)=>{if(!0===a3.isWorker)return{readLock:a3.readLock(e,t),writeLock:a3.writeLock(e,t)};const n=new Bm.Z({concurrency:1});let r;return{async readLock(){if(null!=r)return await c3(r,t);r=new Bm.Z({concurrency:t.concurrency,autoStart:!1});const e=r,i=c3(r,t);return n.add((async()=>(e.start(),await e.onIdle().then((()=>{r===e&&(r=null)}))))),await i},writeLock:async()=>(r=null,await c3(n,t))}})(t.name,t)),s3[t.name]}const h3={ERR_INVALID_PARAMETERS:"ERR_INVALID_PARAMETERS"};var d3,f3,p3;function g3(e,t){var n;const r=d3.decode(t);null!=r.publicKey&&null==e.publicKey&&(e=function(e){if("RSA"===e.type)return new V2(e);if("Ed25519"===e.type)return new H2(e);if("secp256k1"===e.type)return new q2(e);throw new fu.sv("Not a PeerId","ERR_INVALID_PARAMETERS")}({...e,publicKey:e.publicKey}));const i=new Map,o=BigInt(Date.now());for(const[s,a]of r.tags.entries())null!=a.expiry&&a.expiry<o||i.set(s,a);return{...r,id:e,addresses:r.addresses.map((e=>{let{multiaddr:t,isCertified:n}=e;return{multiaddr:(0,ng.HM)(t),isCertified:null!==n&&void 0!==n&&n}})),metadata:r.metadata,peerRecordEnvelope:null!==(n=r.peerRecordEnvelope)&&void 0!==n?n:void 0,tags:i}}!function(e){let t,n,r;!function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.key&&""!==e.key&&(t.uint32(10),t.string(e.key)),null!=e.value&&e.value.byteLength>0&&(t.uint32(18),t.bytes(e.value)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={key:"",value:new Uint8Array(0)},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.key=e.string();break;case 2:n.value=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(t=e.Peer$metadataEntry||(e.Peer$metadataEntry={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.key&&""!==e.key&&(t.uint32(10),t.string(e.key)),null!=e.value&&(t.uint32(18),p3.codec().encode(e.value,t)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={key:""},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.key=e.string();break;case 2:n.value=p3.codec().decode(e,e.uint32());break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(n=e.Peer$tagsEntry||(e.Peer$tagsEntry={})),e.codec=()=>(null==r&&(r=ws((function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==r.lengthDelimited&&n.fork(),null!=t.addresses)for(const e of t.addresses)n.uint32(10),f3.codec().encode(e,n);if(null!=t.protocols)for(const e of t.protocols)n.uint32(18),n.string(e);if(null!=t.publicKey&&(n.uint32(34),n.bytes(t.publicKey)),null!=t.peerRecordEnvelope&&(n.uint32(42),n.bytes(t.peerRecordEnvelope)),null!=t.metadata&&0!==t.metadata.size)for(const[i,o]of t.metadata.entries())n.uint32(50),e.Peer$metadataEntry.codec().encode({key:i,value:o},n);if(null!=t.tags&&0!==t.tags.size)for(const[i,o]of t.tags.entries())n.uint32(58),e.Peer$tagsEntry.codec().encode({key:i,value:o},n);!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={addresses:[],protocols:[],metadata:new Map,tags:new Map},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.addresses.push(f3.codec().decode(t,t.uint32()));break;case 2:r.protocols.push(t.string());break;case 4:r.publicKey=t.bytes();break;case 5:r.peerRecordEnvelope=t.bytes();break;case 6:{const n=e.Peer$metadataEntry.codec().decode(t,t.uint32());r.metadata.set(n.key,n.value);break}case 7:{const n=e.Peer$tagsEntry.codec().decode(t,t.uint32());r.tags.set(n.key,n.value);break}default:t.skipType(7&n)}}return r}))),r),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(d3||(d3={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.multiaddr&&e.multiaddr.byteLength>0&&(t.uint32(10),t.bytes(e.multiaddr)),null!=e.isCertified&&(t.uint32(16),t.bool(e.isCertified)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={multiaddr:new Uint8Array(0)},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.multiaddr=e.bytes();break;case 2:n.isCertified=e.bool();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(f3||(f3={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.value&&0!==e.value&&(t.uint32(8),t.uint32(e.value)),null!=e.expiry&&(t.uint32(16),t.uint64(e.expiry)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={value:0},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.value=e.uint32();break;case 2:n.expiry=e.uint64();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(p3||(p3={}));const y3="/",m3=(new TextEncoder).encode(y3),v3=m3[0];class b3{constructor(e,t){if((0,Yo.Z)(this,"_buf",void 0),"string"===typeof e)this._buf=(0,yu.m)(e);else{if(!(e instanceof Uint8Array))throw new Error("Invalid key, should be String of Uint8Array");this._buf=e}if(null==t&&(t=!0),t&&this.clean(),0===this._buf.byteLength||this._buf[0]!==v3)throw new Error("Invalid key")}toString(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"utf8";return(0,Au.B)(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return"Key(".concat(this.toString(),")")}static withNamespaces(e){return new b3(e.join(y3))}static random(){return new b3(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21;return crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+((t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_")),"")}().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||"string"===typeof e?new b3(e):"function"===typeof e.uint8Array?new b3(e.uint8Array()):null}clean(){if(null!=this._buf&&0!==this._buf.byteLength||(this._buf=m3),this._buf[0]!==v3){const e=new Uint8Array(this._buf.byteLength+1);e.fill(v3,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===v3;)this._buf=this._buf.subarray(0,-1)}less(e){const t=this.list(),n=e.list();for(let r=0;r<t.length;r++){if(n.length<r+1)return!1;const e=t[r],i=n[r];if(e<i)return!0;if(e>i)return!1}return t.length<n.length}reverse(){return b3.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){const e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(y3).slice(1)}type(){return function(e){const t=e.split(":");if(t.length<2)return"";return t.slice(0,-1).join(":")}(this.baseNamespace())}name(){return function(e){const t=e.split(":");return t[t.length-1]}(this.baseNamespace())}instance(e){return new b3(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(y3)||(e+=y3),e+=this.type(),new b3(e)}parent(){const e=this.list();return 1===e.length?new b3(y3):new b3(e.slice(0,-1).join(y3))}child(e){return this.toString()===y3?e:e.toString()===y3?this:new b3(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()!==this.toString()&&e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()!==this.toString()&&this.toString().startsWith(e.toString())}isTopLevel(){return 1===this.list().length}concat(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return b3.withNamespaces([...this.namespaces(),...(r=t.map((e=>e.namespaces())),[].concat(...r))]);var r}}const w3="/peers/";function E3(e){if(!(0,fu.I$)(e)||null==e.type)throw new fu.sv("Invalid PeerId",h3.ERR_INVALID_PARAMETERS);const t=e.toCID().toString();return new b3("".concat(w3).concat(t))}async function A3(e,t,n){const r=new Map;for(const o of n){var i;if(null==o)continue;if(o.multiaddr instanceof Uint8Array&&(o.multiaddr=(0,ng.HM)(o.multiaddr)),!(0,ng.h2)(o.multiaddr))throw new fu.sv("Multiaddr was invalid",h3.ERR_INVALID_PARAMETERS);if(!await t(e,o.multiaddr))continue;const n=null!==(i=o.isCertified)&&void 0!==i&&i,s=o.multiaddr.toString(),a=r.get(s);null!=a?o.isCertified=a.isCertified||n:r.set(s,{multiaddr:o.multiaddr,isCertified:n})}return[...r.values()].sort(((e,t)=>e.multiaddr.toString().localeCompare(t.multiaddr.toString()))).map((e=>{let{isCertified:t,multiaddr:n}=e;return{isCertified:t,multiaddr:n.bytes}}))}async function S3(e,t,n,r){var i,o,s,a,c,l,u;if(null==t)throw new fu.sv("Invalid PeerData",h3.ERR_INVALID_PARAMETERS);if(null!=t.publicKey&&null!=e.publicKey&&!(0,Ms.f)(t.publicKey,e.publicKey))throw new fu.sv("publicKey bytes do not match peer id publicKey bytes",h3.ERR_INVALID_PARAMETERS);const h=r.existingPeer;if(null!=h&&!e.equals(h.id))throw new fu.sv("peer id did not match existing peer id",h3.ERR_INVALID_PARAMETERS);let d=null!==(i=null===h||void 0===h?void 0:h.addresses)&&void 0!==i?i:[],f=new Set(null!==(o=null===h||void 0===h?void 0:h.protocols)&&void 0!==o?o:[]),p=null!==(s=null===h||void 0===h?void 0:h.metadata)&&void 0!==s?s:new Map,g=null!==(a=null===h||void 0===h?void 0:h.tags)&&void 0!==a?a:new Map,y=null===h||void 0===h?void 0:h.peerRecordEnvelope;if("patch"===n){if(null==t.multiaddrs&&null==t.addresses||(d=[],null!=t.multiaddrs&&d.push(...t.multiaddrs.map((e=>({isCertified:!1,multiaddr:e})))),null!=t.addresses&&d.push(...t.addresses)),null!=t.protocols&&(f=new Set(t.protocols)),null!=t.metadata){p=_3(t.metadata instanceof Map?[...t.metadata.entries()]:Object.entries(t.metadata),{validate:I3})}if(null!=t.tags){g=_3(t.tags instanceof Map?[...t.tags.entries()]:Object.entries(t.tags),{validate:C3,map:T3})}null!=t.peerRecordEnvelope&&(y=t.peerRecordEnvelope)}if("merge"===n){if(null!=t.multiaddrs&&d.push(...t.multiaddrs.map((e=>({isCertified:!1,multiaddr:e})))),null!=t.addresses&&d.push(...t.addresses),null!=t.protocols&&(f=new Set([...f,...t.protocols])),null!=t.metadata){const e=t.metadata instanceof Map?[...t.metadata.entries()]:Object.entries(t.metadata);for(const[t,n]of e)null==n?p.delete(t):p.set(t,n);p=_3([...p.entries()],{validate:I3})}if(null!=t.tags){const e=t.tags instanceof Map?[...t.tags.entries()]:Object.entries(t.tags),n=new Map(g);for(const[t,r]of e)null==r?n.delete(t):n.set(t,r);g=_3([...n.entries()],{validate:C3,map:T3})}null!=t.peerRecordEnvelope&&(y=t.peerRecordEnvelope)}const m={addresses:await A3(e,null!==(c=r.addressFilter)&&void 0!==c?c:async()=>!0,d),protocols:[...f.values()].sort(((e,t)=>e.localeCompare(t))),metadata:p,tags:g,publicKey:null!==(l=null!==(u=null===h||void 0===h?void 0:h.id.publicKey)&&void 0!==u?u:t.publicKey)&&void 0!==l?l:e.publicKey,peerRecordEnvelope:y};return"RSA"!==e.type&&delete m.publicKey,m}function _3(e,t){const n=new Map;for(const[o,s]of e)null!=s&&t.validate(o,s);for(const[o,s]of e.sort(((e,t)=>{let[n]=e,[r]=t;return n.localeCompare(r)}))){var r,i;if(null!=s)n.set(o,null!==(r=null===(i=t.map)||void 0===i?void 0:i.call(t,o,s))&&void 0!==r?r:s)}return n}function I3(e,t){if("string"!==typeof e)throw new fu.sv("Metadata key must be a string",h3.ERR_INVALID_PARAMETERS);if(!(t instanceof Uint8Array))throw new fu.sv("Metadata value must be a Uint8Array",h3.ERR_INVALID_PARAMETERS)}function C3(e,t){if("string"!==typeof e)throw new fu.sv("Tag name must be a string",h3.ERR_INVALID_PARAMETERS);if(null!=t.value){if(parseInt("".concat(t.value),10)!==t.value)throw new fu.sv("Tag value must be an integer",h3.ERR_INVALID_PARAMETERS);if(t.value<0||t.value>100)throw new fu.sv("Tag value must be between 0-100",h3.ERR_INVALID_PARAMETERS)}if(null!=t.ttl){if(parseInt("".concat(t.ttl),10)!==t.ttl)throw new fu.sv("Tag ttl must be an integer",h3.ERR_INVALID_PARAMETERS);if(t.ttl<0)throw new fu.sv("Tag ttl must be between greater than 0",h3.ERR_INVALID_PARAMETERS)}}function T3(e,t){var n;let r;return null!=t.expiry&&(r=t.expiry),null!=t.ttl&&(r=BigInt(Date.now()+Number(t.ttl))),{value:null!==(n=t.value)&&void 0!==n?n:0,expiry:r}}function k3(e,t,n){const r=e.toString().split("/")[2],i=G2(S1.decode(r)),o=n.get(i);if(null!=o)return o;const s=g3(i,t);return n.set(i,s),s}var R3=new WeakSet,x3=new WeakSet;class P3{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Qd(this,x3),Qd(this,R3),(0,Yo.Z)(this,"peerId",void 0),(0,Yo.Z)(this,"datastore",void 0),(0,Yo.Z)(this,"lock",void 0),(0,Yo.Z)(this,"addressFilter",void 0),this.peerId=e.peerId,this.datastore=e.datastore,this.addressFilter=t.addressFilter,this.lock=u3({name:"peer-store",singleProcess:!0})}async has(e){return this.datastore.has(E3(e))}async delete(e){if(this.peerId.equals(e))throw new fu.sv("Cannot delete self peer",h3.ERR_INVALID_PARAMETERS);await this.datastore.delete(E3(e))}async load(e){return g3(e,await this.datastore.get(E3(e)))}async save(e,t){const{existingBuf:n,existingPeer:r}=await Yd(this,R3,D3).call(this,e),i=await S3(e,t,"patch",{addressFilter:this.addressFilter});return Yd(this,x3,O3).call(this,e,i,n,r)}async patch(e,t){const{existingBuf:n,existingPeer:r}=await Yd(this,R3,D3).call(this,e),i=await S3(e,t,"patch",{addressFilter:this.addressFilter,existingPeer:r});return Yd(this,x3,O3).call(this,e,i,n,r)}async merge(e,t){const{existingBuf:n,existingPeer:r}=await Yd(this,R3,D3).call(this,e),i=await S3(e,t,"merge",{addressFilter:this.addressFilter,existingPeer:r});return Yd(this,x3,O3).call(this,e,i,n,r)}async*all(e){const t=new lx;for await(const{key:n,value:r}of this.datastore.query(function(e,t){var n,r;return null==e?{}:{prefix:w3,filters:(null!==(n=e.filters)&&void 0!==n?n:[]).map((e=>n=>{let{key:r,value:i}=n;return e(k3(r,i,t))})),orders:(null!==(r=e.orders)&&void 0!==r?r:[]).map((e=>(n,r)=>e(k3(n.key,n.value,t),k3(r.key,r.value,t))))}}(null!==e&&void 0!==e?e:{},t))){const e=k3(n,r,t);e.id.equals(this.peerId)||(yield e)}}}async function D3(e){try{const t=await this.datastore.get(E3(e));return{existingBuf:t,existingPeer:g3(e,t)}}catch(t){if("ERR_NOT_FOUND"!==t.code)throw t}return{}}async function O3(e,t,n,r){const i=d3.encode(t);return null!=n&&(0,Ms.f)(i,n)?{peer:g3(e,i),previous:r,updated:!1}:(await this.datastore.put(E3(e),i),{peer:g3(e,i),previous:r,updated:!0})}var N3=new WeakSet;class B3{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Qd(this,N3),(0,Yo.Z)(this,"store",void 0),(0,Yo.Z)(this,"events",void 0),(0,Yo.Z)(this,"peerId",void 0),(0,Yo.Z)(this,"log",void 0),this.log=e.logger.forComponent("libp2p:peer-store"),this.events=e.events,this.peerId=e.peerId,this.store=new P3(e,t)}async forEach(e,t){this.log.trace("forEach await read lock");const n=await this.store.lock.readLock();this.log.trace("forEach got read lock");try{for await(const n of this.store.all(t))e(n)}finally{this.log.trace("forEach release read lock"),n()}}async all(e){this.log.trace("all await read lock");const t=await this.store.lock.readLock();this.log.trace("all got read lock");try{return await t1(this.store.all(e))}finally{this.log.trace("all release read lock"),t()}}async delete(e){this.log.trace("delete await write lock");const t=await this.store.lock.writeLock();this.log.trace("delete got write lock");try{await this.store.delete(e)}finally{this.log.trace("delete release write lock"),t()}}async has(e){this.log.trace("has await read lock");const t=await this.store.lock.readLock();this.log.trace("has got read lock");try{return await this.store.has(e)}finally{this.log.trace("has release read lock"),t()}}async get(e){this.log.trace("get await read lock");const t=await this.store.lock.readLock();this.log.trace("get got read lock");try{return await this.store.load(e)}finally{this.log.trace("get release read lock"),t()}}async save(e,t){this.log.trace("save await write lock");const n=await this.store.lock.writeLock();this.log.trace("save got write lock");try{const n=await this.store.save(e,t);return Yd(this,N3,L3).call(this,e,n),n.peer}finally{this.log.trace("save release write lock"),n()}}async patch(e,t){this.log.trace("patch await write lock");const n=await this.store.lock.writeLock();this.log.trace("patch got write lock");try{const n=await this.store.patch(e,t);return Yd(this,N3,L3).call(this,e,n),n.peer}finally{this.log.trace("patch release write lock"),n()}}async merge(e,t){this.log.trace("merge await write lock");const n=await this.store.lock.writeLock();this.log.trace("merge got write lock");try{const n=await this.store.merge(e,t);return Yd(this,N3,L3).call(this,e,n),n.peer}finally{this.log.trace("merge release write lock"),n()}}async consumePeerRecord(e,t){var n;const r=await XT.openAndCertify(e,nk.DOMAIN);if(!1===(null===t||void 0===t?void 0:t.equals(r.peerId)))return this.log("envelope peer id was not the expected peer id - expected: %p received: %p",t,r.peerId),!1;const i=nk.createFromProtobuf(r.payload);let o;try{o=await this.get(r.peerId)}catch(s){if("ERR_NOT_FOUND"!==s.code)throw s}if(null!=(null===(n=o)||void 0===n?void 0:n.peerRecordEnvelope)){const e=await XT.createFromProtobuf(o.peerRecordEnvelope),t=nk.createFromProtobuf(e.payload);if(t.seqNumber>=i.seqNumber)return this.log("sequence number was lower or equal to existing sequence number - stored: %d received: %d",t.seqNumber,i.seqNumber),!1}return await this.patch(i.peerId,{peerRecordEnvelope:e,addresses:i.multiaddrs.map((e=>({isCertified:!0,multiaddr:e})))}),!0}}function L3(e,t){t.updated&&(this.peerId.equals(e)?this.events.safeDispatchEvent("self:peer:update",{detail:t}):this.events.safeDispatchEvent("peer:update",{detail:t}))}const M3=aH("libp2p:address-manager"),U3=e=>e;function F3(e,t){const n=e.getPeerId();if(null!=n){X0(n).equals(t)&&(e=e.decapsulate((0,ng.HM)("/p2p/".concat(t.toString()))))}return e}class K3{constructor(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,Yo.Z)(this,"components",void 0),(0,Yo.Z)(this,"listen",void 0),(0,Yo.Z)(this,"announce",void 0),(0,Yo.Z)(this,"observed",void 0),(0,Yo.Z)(this,"announceFilter",void 0);const{listen:r=[],announce:i=[]}=n;this.components=e,this.listen=r.map((e=>e.toString())),this.announce=new Set(i.map((e=>e.toString()))),this.observed=new Map,this.announceFilter=null!==(t=n.announceFilter)&&void 0!==t?t:U3,this._updatePeerStoreAddresses=function(e,t){let n;return function(){clearTimeout(n),n=setTimeout((function(){n=void 0,e()}),t)}}(this._updatePeerStoreAddresses.bind(this),1e3),e.events.addEventListener("transport:listening",(()=>{this._updatePeerStoreAddresses()})),e.events.addEventListener("transport:close",(()=>{this._updatePeerStoreAddresses()}))}_updatePeerStoreAddresses(){const e=this.getAnnounceAddrs().concat(this.components.transportManager.getAddrs()).concat([...this.observed.entries()].filter((e=>{let[t,n]=e;return n.confident})).map((e=>{let[t]=e;return(0,ng.HM)(t)}))).map((e=>e.getPeerId()===this.components.peerId.toString()?e.decapsulate("/p2p/".concat(this.components.peerId.toString())):e));this.components.peerStore.patch(this.components.peerId,{multiaddrs:e}).catch((e=>{M3.error("error updating addresses",e)}))}getListenAddrs(){return Array.from(this.listen).map((e=>(0,ng.HM)(e)))}getAnnounceAddrs(){return Array.from(this.announce).map((e=>(0,ng.HM)(e)))}getObservedAddrs(){return Array.from(this.observed).map((e=>{let[t]=e;return(0,ng.HM)(t)}))}addObservedAddr(e){const t=(e=F3(e,this.components.peerId)).toString();this.observed.has(t)||this.observed.set(t,{confident:!1})}confirmObservedAddr(e){var t;const n=(e=F3(e,this.components.peerId)).toString(),r=(null!==(t=this.observed.get(n))&&void 0!==t?t:{confident:!1}).confident;this.observed.set(n,{confident:!0}),r||this._updatePeerStoreAddresses()}removeObservedAddr(e){const t=(e=F3(e,this.components.peerId)).toString();this.observed.delete(t)}getAddresses(){let e=this.getAnnounceAddrs().map((e=>e.toString()));0===e.length&&(e=this.components.transportManager.getAddrs().map((e=>e.toString()))),e=e.concat(Array.from(this.observed).filter((e=>{let[t,n]=e;return n.confident})).map((e=>{let[t]=e;return t})));const t=new Set(e);return this.announceFilter(Array.from(t).map((e=>(0,ng.HM)(e)))).map((e=>{var t;return!0===(null===(t=e.protos().pop())||void 0===t?void 0:t.path)||e.getPeerId()===this.components.peerId.toString()?e:e.encapsulate("/p2p/".concat(this.components.peerId.toString()))}))}}class j3{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,Yo.Z)(this,"components",{}),(0,Yo.Z)(this,"_started",!1),this.components={};for(const[t,n]of Object.entries(e))this.components[t]=n;null==this.components.logger&&(this.components.logger=sH())}isStarted(){return this._started}async _invokeStartableMethod(e){await Promise.all(Object.values(this.components).filter((e=>bH(e))).map((async t=>{var n;await(null===(n=t[e])||void 0===n?void 0:n.call(t))})))}async beforeStart(){await this._invokeStartableMethod("beforeStart")}async start(){await this._invokeStartableMethod("start"),this._started=!0}async afterStart(){await this._invokeStartableMethod("afterStart")}async beforeStop(){await this._invokeStartableMethod("beforeStop")}async stop(){await this._invokeStartableMethod("stop"),this._started=!1}async afterStop(){await this._invokeStartableMethod("afterStop")}}const Z3=["metrics","connectionProtector"],z3=["components","isStarted","beforeStart","start","afterStart","beforeStop","stop","afterStop","then","_invokeStartableMethod"];function V3(){return{denyDialPeer:async()=>!1,denyDialMultiaddr:async e=>{const t=e.stringTuples();return(4===t[0][0]||41===t[0][0])&&Boolean(mS("".concat(t[0][1])))},denyInboundConnection:async()=>!1,denyOutboundConnection:async()=>!1,denyInboundEncryptedConnection:async()=>!1,denyOutboundEncryptedConnection:async()=>!1,denyInboundUpgradedConnection:async()=>!1,denyOutboundUpgradedConnection:async()=>!1,filterMultiaddrForPeer:async()=>!0,...arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}}}const H3=Symbol.for("@libp2p/transport");var q3;function G3(e){try{const{address:t}=e.nodeAddress();return Boolean(mS(t))}catch{return!0}}function W3(e,t){const n=function(e,t){const n=G3(e.multiaddr),r=G3(t.multiaddr);return n&&!r?1:!n&&r?-1:0}(e,t);if(0!==n)return n;const r=function(e,t){const n=tO.dx.exactMatch(e.multiaddr),r=tO.dx.exactMatch(t.multiaddr);return n&&!r?1:!n&&r?-1:0}(e,t);if(0!==r)return r;const i=function(e,t){return e.isCertified&&!t.isCertified?-1:!e.isCertified&&t.isCertified?1:0}(e,t);return i}!function(e){e[e.FATAL_ALL=0]="FATAL_ALL",e[e.NO_FATAL=1]="NO_FATAL"}(q3||(q3={}));var Q3=n(67024),Y3=n(449),J3=n.n(Y3);function X3(e,t,n){return"".concat(e,"?name=").concat(t,"&type=").concat(n)}async function $3(e,t){const n=await fetch(e,{headers:new Headers({accept:"application/dns-json"}),signal:t});return await n.json()}function e5(e,t){return"".concat(t,"_").concat(e)}const t5=Object.assign(sf()("dns-over-http-resolver"),{error:sf()("dns-over-http-resolver:error")});const n5=class{constructor(){var e,t,n;let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,Yo.Z)(this,"_cache",void 0),(0,Yo.Z)(this,"_TXTcache",void 0),(0,Yo.Z)(this,"_servers",void 0),(0,Yo.Z)(this,"_request",void 0),(0,Yo.Z)(this,"_abortControllers",void 0),this._cache=new(J3())({max:null!==(e=null===r||void 0===r?void 0:r.maxCache)&&void 0!==e?e:100}),this._TXTcache=new(J3())({max:null!==(t=null===r||void 0===r?void 0:r.maxCache)&&void 0!==t?t:100}),this._servers=["https://cloudflare-dns.com/dns-query","https://dns.google/resolve"],this._request=null!==(n=r.request)&&void 0!==n?n:$3,this._abortControllers=[]}cancel(){this._abortControllers.forEach((e=>{e.abort()}))}getServers(){return this._servers}_getShuffledServers(){const e=[...this._servers];for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*t),r=e[t];e[t]=e[n],e[n]=r}return e}setServers(e){this._servers=e}async resolve(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"A";switch(t){case"A":return this.resolve4(e);case"AAAA":return this.resolve6(e);case"TXT":return this.resolveTxt(e);default:throw new Error("".concat(t," is not supported"))}}async resolve4(e){const t="A",n=this._cache.get(e5(e,t));if(null!=n)return n;let r=!1;for(const o of this._getShuffledServers()){const n=new AbortController;this._abortControllers.push(n);try{const r=await this._request(X3(o,e,t),n.signal),i=r.Answer.map((e=>e.data)),s=Math.min(...r.Answer.map((e=>e.TTL)));return this._cache.set(e5(e,t),i,{ttl:s}),i}catch(i){n.signal.aborted&&(r=!0),t5.error("".concat(o," could not resolve ").concat(e," record ").concat(t))}finally{this._abortControllers=this._abortControllers.filter((e=>e!==n))}}if(r)throw Object.assign(new Error("queryA ECANCELLED"),{code:"ECANCELLED"});throw new Error("Could not resolve ".concat(e," record ").concat(t))}async resolve6(e){const t="AAAA",n=this._cache.get(e5(e,t));if(null!=n)return n;let r=!1;for(const o of this._getShuffledServers()){const n=new AbortController;this._abortControllers.push(n);try{const r=await this._request(X3(o,e,t),n.signal),i=r.Answer.map((e=>e.data)),s=Math.min(...r.Answer.map((e=>e.TTL)));return this._cache.set(e5(e,t),i,{ttl:s}),i}catch(i){n.signal.aborted&&(r=!0),t5.error("".concat(o," could not resolve ").concat(e," record ").concat(t))}finally{this._abortControllers=this._abortControllers.filter((e=>e!==n))}}if(r)throw Object.assign(new Error("queryAaaa ECANCELLED"),{code:"ECANCELLED"});throw new Error("Could not resolve ".concat(e," record ").concat(t))}async resolveTxt(e){const t="TXT",n=this._TXTcache.get(e5(e,t));if(null!=n)return n;let r=!1;for(const o of this._getShuffledServers()){const n=new AbortController;this._abortControllers.push(n);try{const r=await this._request(X3(o,e,t),n.signal),i=r.Answer.map((e=>[e.data.replace(/['"]+/g,"")])),s=Math.min(...r.Answer.map((e=>e.TTL)));return this._TXTcache.set(e5(e,t),i,{ttl:s}),i}catch(i){n.signal.aborted&&(r=!0),t5.error("".concat(o," could not resolve ").concat(e," record ").concat(t))}finally{this._abortControllers=this._abortControllers.filter((e=>e!==n))}}if(r)throw Object.assign(new Error("queryTxt ECANCELLED"),{code:"ECANCELLED"});throw new Error("Could not resolve ".concat(e," record ").concat(t))}clearCache(){this._cache.clear(),this._TXTcache.clear()}},{code:r5}=(0,Q3.Ev)("dnsaddr");async function i5(e,t={}){const n=new n5;null!=t.signal&&t.signal.addEventListener("abort",(()=>{n.cancel()}));const r=e.getPeerId(),[,i]=e.stringTuples().find((([e])=>e===r5))??[];if(null==i)throw new Error("No hostname found in multiaddr");let o=(await n.resolveTxt(`_dnsaddr.${i}`)).flat().map((e=>e.split("=")[1])).filter(Boolean);return null!=r&&(o=o.filter((e=>e.includes(r)))),o}var o5,s5;!function(e){e.NOT_STARTED_YET="The libp2p node is not started yet",e.DHT_DISABLED="DHT is not available",e.PUBSUB_DISABLED="PubSub is not available",e.CONN_ENCRYPTION_REQUIRED="At least one connection encryption module is required",e.ERR_TRANSPORTS_REQUIRED="At least one transport module is required",e.ERR_PROTECTOR_REQUIRED="Private network is enforced, but no protector was provided",e.NOT_FOUND="Not found"}(o5||(o5={})),function(e){e.DHT_DISABLED="ERR_DHT_DISABLED",e.ERR_PUBSUB_DISABLED="ERR_PUBSUB_DISABLED",e.PUBSUB_NOT_STARTED="ERR_PUBSUB_NOT_STARTED",e.DHT_NOT_STARTED="ERR_DHT_NOT_STARTED",e.CONN_ENCRYPTION_REQUIRED="ERR_CONN_ENCRYPTION_REQUIRED",e.ERR_TRANSPORTS_REQUIRED="ERR_TRANSPORTS_REQUIRED",e.ERR_PROTECTOR_REQUIRED="ERR_PROTECTOR_REQUIRED",e.ERR_PEER_DIAL_INTERCEPTED="ERR_PEER_DIAL_INTERCEPTED",e.ERR_CONNECTION_INTERCEPTED="ERR_CONNECTION_INTERCEPTED",e.ERR_INVALID_PROTOCOLS_FOR_STREAM="ERR_INVALID_PROTOCOLS_FOR_STREAM",e.ERR_CONNECTION_ENDED="ERR_CONNECTION_ENDED",e.ERR_CONNECTION_FAILED="ERR_CONNECTION_FAILED",e.ERR_NODE_NOT_STARTED="ERR_NODE_NOT_STARTED",e.ERR_ALREADY_ABORTED="ERR_ALREADY_ABORTED",e.ERR_TOO_MANY_ADDRESSES="ERR_TOO_MANY_ADDRESSES",e.ERR_NO_VALID_ADDRESSES="ERR_NO_VALID_ADDRESSES",e.ERR_RELAYED_DIAL="ERR_RELAYED_DIAL",e.ERR_DIALED_SELF="ERR_DIALED_SELF",e.ERR_DISCOVERED_SELF="ERR_DISCOVERED_SELF",e.ERR_DUPLICATE_TRANSPORT="ERR_DUPLICATE_TRANSPORT",e.ERR_ENCRYPTION_FAILED="ERR_ENCRYPTION_FAILED",e.ERR_HOP_REQUEST_FAILED="ERR_HOP_REQUEST_FAILED",e.ERR_INVALID_KEY="ERR_INVALID_KEY",e.ERR_INVALID_MESSAGE="ERR_INVALID_MESSAGE",e.ERR_INVALID_PARAMETERS="ERR_INVALID_PARAMETERS",e.ERR_INVALID_PEER="ERR_INVALID_PEER",e.ERR_MUXER_UNAVAILABLE="ERR_MUXER_UNAVAILABLE",e.ERR_NOT_FOUND="ERR_NOT_FOUND",e.ERR_TIMEOUT="ERR_TIMEOUT",e.ERR_TRANSPORT_UNAVAILABLE="ERR_TRANSPORT_UNAVAILABLE",e.ERR_TRANSPORT_DIAL_FAILED="ERR_TRANSPORT_DIAL_FAILED",e.ERR_UNSUPPORTED_PROTOCOL="ERR_UNSUPPORTED_PROTOCOL",e.ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED="ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED",e.ERR_INVALID_MULTIADDR="ERR_INVALID_MULTIADDR",e.ERR_SIGNATURE_NOT_VALID="ERR_SIGNATURE_NOT_VALID",e.ERR_FIND_SELF="ERR_FIND_SELF",e.ERR_NO_ROUTERS_AVAILABLE="ERR_NO_ROUTERS_AVAILABLE",e.ERR_CONNECTION_NOT_MULTIPLEXED="ERR_CONNECTION_NOT_MULTIPLEXED",e.ERR_NO_DIAL_TOKENS="ERR_NO_DIAL_TOKENS",e.ERR_KEYCHAIN_REQUIRED="ERR_KEYCHAIN_REQUIRED",e.ERR_INVALID_CMS="ERR_INVALID_CMS",e.ERR_MISSING_KEYS="ERR_MISSING_KEYS",e.ERR_NO_KEY="ERR_NO_KEY",e.ERR_INVALID_KEY_NAME="ERR_INVALID_KEY_NAME",e.ERR_INVALID_KEY_TYPE="ERR_INVALID_KEY_TYPE",e.ERR_KEY_ALREADY_EXISTS="ERR_KEY_ALREADY_EXISTS",e.ERR_INVALID_KEY_SIZE="ERR_INVALID_KEY_SIZE",e.ERR_KEY_NOT_FOUND="ERR_KEY_NOT_FOUND",e.ERR_OLD_KEY_NAME_INVALID="ERR_OLD_KEY_NAME_INVALID",e.ERR_NEW_KEY_NAME_INVALID="ERR_NEW_KEY_NAME_INVALID",e.ERR_PASSWORD_REQUIRED="ERR_PASSWORD_REQUIRED",e.ERR_PEM_REQUIRED="ERR_PEM_REQUIRED",e.ERR_CANNOT_READ_KEY="ERR_CANNOT_READ_KEY",e.ERR_MISSING_PRIVATE_KEY="ERR_MISSING_PRIVATE_KEY",e.ERR_MISSING_PUBLIC_KEY="ERR_MISSING_PUBLIC_KEY",e.ERR_INVALID_OLD_PASS_TYPE="ERR_INVALID_OLD_PASS_TYPE",e.ERR_INVALID_NEW_PASS_TYPE="ERR_INVALID_NEW_PASS_TYPE",e.ERR_INVALID_PASS_LENGTH="ERR_INVALID_PASS_LENGTH",e.ERR_NOT_IMPLEMENTED="ERR_NOT_IMPLEMENTED",e.ERR_WRONG_PING_ACK="ERR_WRONG_PING_ACK",e.ERR_INVALID_RECORD="ERR_INVALID_RECORD",e.ERR_ALREADY_SUCCEEDED="ERR_ALREADY_SUCCEEDED",e.ERR_NO_HANDLER_FOR_PROTOCOL="ERR_NO_HANDLER_FOR_PROTOCOL",e.ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS="ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS",e.ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS="ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS",e.ERR_CONNECTION_DENIED="ERR_CONNECTION_DENIED",e.ERR_TRANSFER_LIMIT_EXCEEDED="ERR_TRANSFER_LIMIT_EXCEEDED"}(s5||(s5={}));const a5={addresses:{listen:[],announce:[],noAnnounce:[],announceFilter:e=>e},connectionManager:{resolvers:{dnsaddr:i5},addressSorter:W3},transportManager:{faultTolerance:q3.FATAL_ALL}};var c5=n(57896);const l5=aH("libp2p:get-peer");function u5(e){if(P0(e))return{peerId:e,multiaddrs:[]};let t;if(Array.isArray(e)||(e=[e]),e.length>0){const n=e[0].getPeerId();t=null==n?void 0:X0(n),e.forEach((e=>{if(!(0,ng.h2)(e))throw l5.error("multiaddr %s was invalid",e),new aq("Invalid Multiaddr",s5.ERR_INVALID_MULTIADDR);const n=e.getPeerId();if(null==n){if(null!=t)throw new aq("Multiaddrs must all have the same peer id or have no peer id",s5.ERR_INVALID_PARAMETERS)}else{const e=X0(n);if(null==t||!t.equals(e))throw new aq("Multiaddrs must all have the same peer id or have no peer id",s5.ERR_INVALID_PARAMETERS)}}))}return{peerId:t,multiaddrs:e}}var h5=new WeakMap;class d5{constructor(){(0,dx.Z)(this,h5,{writable:!0,value:[]})}enqueue(e,t){var n;const r=null===t||void 0===t?void 0:t.peerId,i=null!==(n=null===t||void 0===t?void 0:t.priority)&&void 0!==n?n:0;if(null==r)throw new aq("missing peer id",s5.ERR_INVALID_PARAMETERS);const o={priority:i,peerId:r,run:e};if(this.size>0&&(0,fx.Z)(this,h5)[this.size-1].priority>=i)return void(0,fx.Z)(this,h5).push(o);const s=function(e,t,n){let r=0,i=e.length;for(;i>0;){const o=Math.trunc(i/2);let s=r+o;n(e[s],t)<=0?(r=++s,i-=o+1):i=o}return r}((0,fx.Z)(this,h5),o,((e,t)=>t.priority-e.priority));(0,fx.Z)(this,h5).splice(s,0,o)}dequeue(){const e=(0,fx.Z)(this,h5).shift();return null===e||void 0===e?void 0:e.run}filter(e){if(null!=e.peerId){const t=e.peerId;return(0,fx.Z)(this,h5).filter((e=>t.equals(e.peerId))).map((e=>e.run))}return(0,fx.Z)(this,h5).filter((t=>t.priority===e.priority)).map((e=>e.run))}get size(){return(0,fx.Z)(this,h5).length}}class f5 extends Bm.Z{constructor(){super({...arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},queueClass:d5})}hasJob(e){return this.sizeBy({peerId:e})>0}}const p5=100,g5="last-dial-failure",y5={minConnections:5,maxQueueLength:100,autoDialConcurrency:25,autoDialPriority:0,autoDialInterval:5e3,autoDialPeerRetryThreshold:42e4,autoDialDiscoveredPeersDebounce:10};var m5=new WeakMap;class v5{constructor(e,t){var n,r,i,o,s,a,c;let l;(0,Yo.Z)(this,"connectionManager",void 0),(0,Yo.Z)(this,"peerStore",void 0),(0,Yo.Z)(this,"queue",void 0),(0,Yo.Z)(this,"minConnections",void 0),(0,Yo.Z)(this,"autoDialPriority",void 0),(0,Yo.Z)(this,"autoDialIntervalMs",void 0),(0,Yo.Z)(this,"autoDialMaxQueueLength",void 0),(0,Yo.Z)(this,"autoDialPeerRetryThresholdMs",void 0),(0,Yo.Z)(this,"autoDialDiscoveredPeersDebounce",void 0),(0,Yo.Z)(this,"autoDialInterval",void 0),(0,Yo.Z)(this,"started",void 0),(0,Yo.Z)(this,"running",void 0),(0,dx.Z)(this,m5,{writable:!0,value:void 0}),this.connectionManager=e.connectionManager,this.peerStore=e.peerStore,this.minConnections=null!==(n=t.minConnections)&&void 0!==n?n:y5.minConnections,this.autoDialPriority=null!==(r=t.autoDialPriority)&&void 0!==r?r:y5.autoDialPriority,this.autoDialIntervalMs=null!==(i=t.autoDialInterval)&&void 0!==i?i:y5.autoDialInterval,this.autoDialMaxQueueLength=null!==(o=t.maxQueueLength)&&void 0!==o?o:y5.maxQueueLength,this.autoDialPeerRetryThresholdMs=null!==(s=t.autoDialPeerRetryThreshold)&&void 0!==s?s:y5.autoDialPeerRetryThreshold,this.autoDialDiscoveredPeersDebounce=null!==(a=t.autoDialDiscoveredPeersDebounce)&&void 0!==a?a:y5.autoDialDiscoveredPeersDebounce,CG(this,m5,e.logger.forComponent("libp2p:connection-manager:auto-dial")),this.started=!1,this.running=!1,this.queue=new f5({concurrency:null!==(c=t.autoDialConcurrency)&&void 0!==c?c:y5.autoDialConcurrency}),this.queue.addListener("error",(e=>{(0,fx.Z)(this,m5).error("error during auto-dial",e)})),e.events.addEventListener("connection:close",(()=>{this.autoDial().catch((e=>{(0,fx.Z)(this,m5).error(e)}))})),e.events.addEventListener("peer:discovery",(()=>{clearTimeout(l),l=setTimeout((()=>{this.autoDial().catch((e=>{(0,fx.Z)(this,m5).error(e)}))}),this.autoDialDiscoveredPeersDebounce)}))}isStarted(){return this.started}start(){this.autoDialInterval=setTimeout((()=>{this.autoDial().catch((e=>{(0,fx.Z)(this,m5).error("error while autodialing",e)}))}),this.autoDialIntervalMs),this.started=!0}afterStart(){this.autoDial().catch((e=>{(0,fx.Z)(this,m5).error("error while autodialing",e)}))}stop(){this.queue.clear(),clearTimeout(this.autoDialInterval),this.started=!1,this.running=!1}async autoDial(){if(!this.started)return;const e=this.connectionManager.getConnectionsMap(),t=e.size;if(t>=this.minConnections)return void(this.minConnections>0&&(0,fx.Z)(this,m5).trace("have enough connections %d/%d",t,this.minConnections));if(this.queue.size>this.autoDialMaxQueueLength)return void(0,fx.Z)(this,m5).call(this,"not enough connections %d/%d but auto dial queue is full",t,this.minConnections);if(this.running)return void(0,fx.Z)(this,m5).call(this,"not enough connections %d/%d - but skipping autodial as it is already running",t,this.minConnections);this.running=!0,(0,fx.Z)(this,m5).call(this,"not enough connections %d/%d - will dial peers to increase the number of connections",t,this.minConnections);const n=new ux(this.connectionManager.getDialQueue().map((e=>e.peerId)).filter(Boolean)),r=await this.peerStore.all({filters:[t=>0===t.addresses.length?((0,fx.Z)(this,m5).trace("not autodialing %p because they have no addresses",t.id),!1):e.has(t.id)?((0,fx.Z)(this,m5).trace("not autodialing %p because they are already connected",t.id),!1):n.has(t.id)?((0,fx.Z)(this,m5).trace("not autodialing %p because they are already being dialed",t.id),!1):!this.queue.hasJob(t.id)||((0,fx.Z)(this,m5).trace("not autodialing %p because they are already being autodialed",t.id),!1)]}),i=r.sort((()=>Math.random()>.5?1:-1)),o=new lx;for(const a of i)o.has(a.id)||o.set(a.id,[...a.tags.values()].reduce(((e,t)=>e+t.value),0));const s=i.sort(((e,t)=>{var n,r;const i=null!==(n=o.get(e.id))&&void 0!==n?n:0,s=null!==(r=o.get(t.id))&&void 0!==r?r:0;return i>s?-1:i<s?1:0})).filter((e=>{const t=e.metadata.get(g5);if(null==t)return!0;const n=parseInt((0,Au.B)(t));return!!isNaN(n)||Date.now()-n>this.autoDialPeerRetryThresholdMs}));(0,fx.Z)(this,m5).call(this,"selected %d/%d peers to dial",s.length,r.length);for(const a of s)this.queue.add((async()=>{const e=this.connectionManager.getConnectionsMap().size;if(e>=this.minConnections)return(0,fx.Z)(this,m5).call(this,"got enough connections now %d/%d",e,this.minConnections),void this.queue.clear();(0,fx.Z)(this,m5).call(this,"connecting to a peerStore stored peer %p",a.id),await this.connectionManager.openConnection(a.id,{priority:this.autoDialPriority})}),{peerId:a.id}).catch((e=>{(0,fx.Z)(this,m5).error("could not connect to peerStore stored peer",e)}));this.running=!1,this.started&&(this.autoDialInterval=setTimeout((()=>{this.autoDial().catch((e=>{(0,fx.Z)(this,m5).error("error while autodialing",e)}))}),this.autoDialIntervalMs))}}const b5={maxConnections:p5,allow:[]};var w5=new WeakMap;class E5{constructor(e){var t,n;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,Yo.Z)(this,"maxConnections",void 0),(0,Yo.Z)(this,"connectionManager",void 0),(0,Yo.Z)(this,"peerStore",void 0),(0,Yo.Z)(this,"allow",void 0),(0,Yo.Z)(this,"events",void 0),(0,dx.Z)(this,w5,{writable:!0,value:void 0}),this.maxConnections=null!==(t=r.maxConnections)&&void 0!==t?t:b5.maxConnections,this.allow=null!==(n=r.allow)&&void 0!==n?n:b5.allow,this.connectionManager=e.connectionManager,this.peerStore=e.peerStore,this.events=e.events,CG(this,w5,e.logger.forComponent("libp2p:connection-manager:connection-pruner")),e.events.addEventListener("connection:open",(()=>{this.maybePruneConnections().catch((e=>{(0,fx.Z)(this,w5).error(e)}))}))}async maybePruneConnections(){const e=this.connectionManager.getConnections(),t=e.length,n=Math.max(t-this.maxConnections,0);if((0,fx.Z)(this,w5).call(this,"checking max connections limit %d/%d",t,this.maxConnections),t<=this.maxConnections)return;(0,fx.Z)(this,w5).call(this,"max connections limit exceeded %d/%d, pruning %d connection(s)",t,this.maxConnections,n);const r=new lx;for(const a of e){const e=a.remotePeer;if(!r.has(e)){r.set(e,0);try{const t=await this.peerStore.get(e);r.set(e,[...t.tags.values()].reduce(((e,t)=>e+t.value),0))}catch(s){"ERR_NOT_FOUND"!==s.code&&(0,fx.Z)(this,w5).error("error loading peer tags",s)}}}const i=e.sort(((e,t)=>{var n,i;const o=null!==(n=r.get(e.remotePeer))&&void 0!==n?n:0,s=null!==(i=r.get(t.remotePeer))&&void 0!==i?i:0;if(o>s)return 1;if(o<s)return-1;const a=e.timeline.open,c=t.timeline.open;return a<c?1:a>c?-1:0})),o=[];for(const a of i){(0,fx.Z)(this,w5).call(this,"too many connections open - closing a connection to %p",a.remotePeer);if(this.allow.some((e=>a.remoteAddr.toString().startsWith(e.toString())))||o.push(a),o.length===n)break}await Promise.all(o.map((async e=>{try{await e.close()}catch(s){(0,fx.Z)(this,w5).error(s)}}))),this.events.safeDispatchEvent("connection:prune",{detail:o})}}async function A5(e,t){if(!e.protoNames().includes("dnsaddr"))return[e];const n=await async function(e,t){try{e=(0,ng.HM)(e.toString());return await e.resolve(t)}catch(n){return t.log.error("multiaddr ".concat(e.toString()," could not be resolved"),n),[]}}(e,t),r=(await Promise.all(n.map((async e=>A5(e,t))))).flat().reduce(((e,t)=>(null==e.find((e=>e.equals(t)))&&e.push(t),e)),[]);return t.log("resolved %s to",e,r.map((e=>e.toString()))),r}const S5={addressSorter:W3,maxParallelDials:50,maxPeerAddrsToDial:25,maxParallelDialsPerPeer:1,dialTimeout:3e4,resolvers:{dnsaddr:i5}};var _5=new WeakMap;class I5{constructor(e){var t,n,r,i,o,s,a,c;let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,Yo.Z)(this,"pendingDials",void 0),(0,Yo.Z)(this,"queue",void 0),(0,Yo.Z)(this,"peerId",void 0),(0,Yo.Z)(this,"peerStore",void 0),(0,Yo.Z)(this,"connectionGater",void 0),(0,Yo.Z)(this,"transportManager",void 0),(0,Yo.Z)(this,"addressSorter",void 0),(0,Yo.Z)(this,"maxPeerAddrsToDial",void 0),(0,Yo.Z)(this,"maxParallelDialsPerPeer",void 0),(0,Yo.Z)(this,"dialTimeout",void 0),(0,Yo.Z)(this,"inProgressDialCount",void 0),(0,Yo.Z)(this,"pendingDialCount",void 0),(0,Yo.Z)(this,"shutDownController",void 0),(0,Yo.Z)(this,"connections",void 0),(0,dx.Z)(this,_5,{writable:!0,value:void 0}),this.addressSorter=null!==(t=l.addressSorter)&&void 0!==t?t:S5.addressSorter,this.maxPeerAddrsToDial=null!==(n=l.maxPeerAddrsToDial)&&void 0!==n?n:S5.maxPeerAddrsToDial,this.maxParallelDialsPerPeer=null!==(r=l.maxParallelDialsPerPeer)&&void 0!==r?r:S5.maxParallelDialsPerPeer,this.dialTimeout=null!==(i=l.dialTimeout)&&void 0!==i?i:S5.dialTimeout,this.connections=null!==(o=l.connections)&&void 0!==o?o:new lx,CG(this,_5,e.logger.forComponent("libp2p:connection-manager:dial-queue")),this.peerId=e.peerId,this.peerStore=e.peerStore,this.connectionGater=e.connectionGater,this.transportManager=e.transportManager,this.shutDownController=new AbortController,dJ(1/0,this.shutDownController.signal),this.pendingDialCount=null===(s=e.metrics)||void 0===s?void 0:s.registerMetric("libp2p_dialler_pending_dials"),this.inProgressDialCount=null===(a=e.metrics)||void 0===a?void 0:a.registerMetric("libp2p_dialler_in_progress_dials"),this.pendingDials=[];for(const[h,d]of Object.entries(null!==(u=l.resolvers)&&void 0!==u?u:{})){var u;ng.s_.set(h,d)}this.queue=new Bm.Z({concurrency:null!==(c=l.maxParallelDials)&&void 0!==c?c:S5.maxParallelDials}),this.queue.on("add",(()=>{var e,t;null===(e=this.pendingDialCount)||void 0===e||e.update(this.queue.size),null===(t=this.inProgressDialCount)||void 0===t||t.update(this.queue.pending)})),this.queue.on("active",(()=>{var e,t;null===(e=this.pendingDialCount)||void 0===e||e.update(this.queue.size),null===(t=this.inProgressDialCount)||void 0===t||t.update(this.queue.pending)})),this.queue.on("completed",(()=>{var e,t;null===(e=this.pendingDialCount)||void 0===e||e.update(this.queue.size),null===(t=this.inProgressDialCount)||void 0===t||t.update(this.queue.pending)})),this.queue.on("error",(e=>{var t,n;(0,fx.Z)(this,_5).error("error in dial queue",e),null===(t=this.pendingDialCount)||void 0===t||t.update(this.queue.size),null===(n=this.inProgressDialCount)||void 0===n||n.update(this.queue.pending)})),this.queue.on("empty",(()=>{var e,t;null===(e=this.pendingDialCount)||void 0===e||e.update(this.queue.size),null===(t=this.inProgressDialCount)||void 0===t||t.update(this.queue.pending)})),this.queue.on("idle",(()=>{var e,t;null===(e=this.pendingDialCount)||void 0===e||e.update(this.queue.size),null===(t=this.inProgressDialCount)||void 0===t||t.update(this.queue.pending)}))}stop(){this.shutDownController.abort()}async dial(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{peerId:n,multiaddrs:r}=u5(e),i=r.map((e=>({multiaddr:e,isCertified:!1}))),o=this.createDialAbortControllers(t.signal);let s;try{s=await this.calculateMultiaddrs(n,i,{...t,signal:o})}catch(h){throw o.clear(),h}let a=Array.from(this.connections.values()).flat().find((e=>!0!==t.force&&s.find((t=>t.multiaddr.equals(e.remoteAddr)))));if(null!=a)return(0,fx.Z)(this,_5).call(this,"already connected to %a",a.remoteAddr),a;const c=this.pendingDials.find((e=>!(null==e.peerId||null==n||!e.peerId.equals(n))||s.map((e=>{let{multiaddr:t}=e;return t.toString()})).join()===e.multiaddrs.map((e=>e.toString())).join()));if(null!=c)return(0,fx.Z)(this,_5).call(this,"joining existing dial target for %p",n),o.clear(),c.promise;(0,fx.Z)(this,_5).call(this,"creating dial target for",s.map((e=>{let{multiaddr:t}=e;return t.toString()})));const l={id:"".concat(parseInt(String(1e9*Math.random()),10).toString()).concat(Date.now()),status:"queued",peerId:n,multiaddrs:s.map((e=>{let{multiaddr:t}=e;return t}))};l.promise=this.performDial(l,{...t,signal:o}).finally((()=>{this.pendingDials=this.pendingDials.filter((e=>e.id!==l.id)),o.clear()})).catch((async e=>{if((0,fx.Z)(this,_5).error("dial failed to %s",l.multiaddrs.map((e=>e.toString())).join(", "),e),null!=n)try{await this.peerStore.patch(n,{metadata:{[g5]:(0,yu.m)(Date.now().toString())}})}catch(e){(0,fx.Z)(this,_5).error("could not update last dial failure key for %p",n,e)}if(o.aborted){throw new aq(e.message,s5.ERR_TIMEOUT)}throw e})),this.pendingDials.push(l);const u=await l.promise;return a=Array.from(this.connections.values()).flat().find((e=>!0!==t.force&&(e.id!==u.id&&e.remoteAddr.equals(u.remoteAddr)))),null!=a?((0,fx.Z)(this,_5).call(this,"already connected to %a",a.remoteAddr),await u.close(),a):((0,fx.Z)(this,_5).call(this,"connection opened to %a",u.remoteAddr),u)}createDialAbortControllers(e){const t=SH([AbortSignal.timeout(this.dialTimeout),this.shutDownController.signal,e]);try{null===dJ||void 0===dJ||dJ(1/0,t)}catch{}return t}async calculateMultiaddrs(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!=e){var r,i;if(this.peerId.equals(e))throw new aq("Tried to dial self",s5.ERR_DIALED_SELF);if(!0===await(null===(r=(i=this.connectionGater).denyDialPeer)||void 0===r?void 0:r.call(i,e)))throw new aq("The dial request is blocked by gater.allowDialPeer",s5.ERR_PEER_DIAL_INTERCEPTED);if(0===t.length){(0,fx.Z)(this,_5).call(this,"loading multiaddrs for %p",e);try{const n=await this.peerStore.get(e);t.push(...n.addresses),(0,fx.Z)(this,_5).call(this,"loaded multiaddrs for %p",e,t.map((e=>{let{multiaddr:t}=e;return t.toString()})))}catch(h){if(h.code!==s5.ERR_NOT_FOUND)throw h}}}let o=(await Promise.all(t.map((async e=>{const t=await A5(e.multiaddr,{...n,log:(0,fx.Z)(this,_5)});return 1===t.length&&t[0].equals(e.multiaddr)?e:t.map((e=>({multiaddr:e,isCertified:!1})))})))).flat();if(null!=e){const t="/p2p/".concat(e.toString());o=o.map((e=>{const n=e.multiaddr.protos().pop();return!0===(null===n||void 0===n?void 0:n.path)?e:null==e.multiaddr.getPeerId()?{multiaddr:e.multiaddr.encapsulate(t),isCertified:e.isCertified}:e}))}const s=o.filter((t=>{if(null==this.transportManager.transportForMultiaddr(t.multiaddr))return!1;const n=t.multiaddr.getPeerId();return null==e||null==n||e.equals(n)})),a=new Map;for(const d of s){const e=d.multiaddr.toString(),t=a.get(e);null==t?a.set(e,d):t.isCertified=t.isCertified||d.isCertified||!1}const c=[...a.values()];if((0===c.length||c.length>this.maxPeerAddrsToDial)&&((0,fx.Z)(this,_5).call(this,"addresses for %p before filtering",null!==e&&void 0!==e?e:"unknown peer",o.map((e=>{let{multiaddr:t}=e;return t.toString()}))),(0,fx.Z)(this,_5).call(this,"addresses for %p after filtering",null!==e&&void 0!==e?e:"unknown peer",c.map((e=>{let{multiaddr:t}=e;return t.toString()})))),0===c.length)throw new aq("The dial request has no valid addresses",s5.ERR_NO_VALID_ADDRESSES);if(c.length>this.maxPeerAddrsToDial)throw new aq("dial with more addresses than allowed",s5.ERR_TOO_MANY_ADDRESSES);const l=[];for(const d of c)null!=this.connectionGater.denyDialMultiaddr&&await this.connectionGater.denyDialMultiaddr(d.multiaddr)||l.push(d);const u=l.sort(this.addressSorter);if(0===u.length)throw new aq("The connection gater denied all addresses in the dial request",s5.ERR_NO_VALID_ADDRESSES);return u}async performDial(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e.multiaddrs.map((()=>new AbortController));try{const r=new Bm.Z({concurrency:this.maxParallelDialsPerPeer});r.on("error",(e=>{(0,fx.Z)(this,_5).error("error dialling",e)}));const i=await Promise.any(e.multiaddrs.map((async(i,o)=>{const s=n[o];if(null==s)throw new aq("dialAction did not come with an AbortController",s5.ERR_INVALID_PARAMETERS);const a=function(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const o of n)null!=o&&(dJ(1/0,o),e.push(o));const i=SH(e);return dJ(1/0,i),i}(s.signal,t.signal);a.addEventListener("abort",(()=>{(0,fx.Z)(this,_5).call(this,"dial to %a aborted",i)}));const c=Ws();return await r.add((async()=>{if(a.aborted)return(0,fx.Z)(this,_5).call(this,"dial to %a was aborted before reaching the head of the peer dial queue",i),void c.reject(new sq);await this.queue.add((async()=>{try{if(a.aborted)return(0,fx.Z)(this,_5).call(this,"dial to %a was aborted before reaching the head of the dial queue",i),void c.reject(new sq);e.status="active";const r=await this.transportManager.dial(i,{...t,signal:a});if(s.signal.aborted)return(0,fx.Z)(this,_5).call(this,"multiple dials succeeded, closing superfluous connection"),r.close().catch((e=>{(0,fx.Z)(this,_5).error("error closing superfluous connection",e)})),void c.reject(new sq);n[o]=void 0,n.forEach((e=>{void 0!==e&&e.abort()})),(0,fx.Z)(this,_5).call(this,"dial to %a succeeded",i),c.resolve(r)}catch(r){(0,fx.Z)(this,_5).error("error during dial of %a",i,r),c.reject(r)}}),{...t,signal:a}).catch((e=>{c.reject(e)}))}),{signal:a}).catch((e=>{c.reject(e)})).finally((()=>{a.clear()})),c.promise})));if(null==i)throw new aq("successful dial led to empty object returned from peer dial queue",s5.ERR_TRANSPORT_DIAL_FAILED);return e.status="success",i}catch(r){if(e.status="error",1===e.multiaddrs.length&&"AggregateError"===r.name)throw r.errors[0];throw r}}}const C5=5,T5=p5,k5=5,R5=10,x5=25,P5=0,D5=100;var O5=new WeakMap;class N5{constructor(e){var t,n,r,i,o,s,a,c,l,u,h,d,f,p,g;let y=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,Yo.Z)(this,"started",void 0),(0,Yo.Z)(this,"connections",void 0),(0,Yo.Z)(this,"allow",void 0),(0,Yo.Z)(this,"deny",void 0),(0,Yo.Z)(this,"maxIncomingPendingConnections",void 0),(0,Yo.Z)(this,"incomingPendingConnections",void 0),(0,Yo.Z)(this,"maxConnections",void 0),(0,Yo.Z)(this,"dialQueue",void 0),(0,Yo.Z)(this,"autoDial",void 0),(0,Yo.Z)(this,"connectionPruner",void 0),(0,Yo.Z)(this,"inboundConnectionRateLimiter",void 0),(0,Yo.Z)(this,"peerStore",void 0),(0,Yo.Z)(this,"metrics",void 0),(0,Yo.Z)(this,"events",void 0),(0,dx.Z)(this,O5,{writable:!0,value:void 0}),this.maxConnections=null!==(t=y.maxConnections)&&void 0!==t?t:T5;const m=null!==(n=y.minConnections)&&void 0!==n?n:C5;if(this.maxConnections<m)throw new aq("Connection Manager maxConnections must be greater than minConnections",s5.ERR_INVALID_PARAMETERS);this.connections=new lx,this.started=!1,this.peerStore=e.peerStore,this.metrics=e.metrics,this.events=e.events,CG(this,O5,e.logger.forComponent("libp2p:connection-manager")),this.onConnect=this.onConnect.bind(this),this.onDisconnect=this.onDisconnect.bind(this),this.events.addEventListener("connection:open",this.onConnect),this.events.addEventListener("connection:close",this.onDisconnect),this.allow=(null!==(r=y.allow)&&void 0!==r?r:[]).map((e=>(0,ng.HM)(e))),this.deny=(null!==(i=y.deny)&&void 0!==i?i:[]).map((e=>(0,ng.HM)(e))),this.incomingPendingConnections=0,this.maxIncomingPendingConnections=null!==(o=y.maxIncomingPendingConnections)&&void 0!==o?o:R5,this.inboundConnectionRateLimiter=new c5.RateLimiterMemory({points:null!==(s=y.inboundConnectionThreshold)&&void 0!==s?s:k5,duration:1}),this.autoDial=new v5({connectionManager:this,peerStore:e.peerStore,events:e.events,logger:e.logger},{minConnections:m,autoDialConcurrency:null!==(a=y.autoDialConcurrency)&&void 0!==a?a:x5,autoDialPriority:null!==(c=y.autoDialPriority)&&void 0!==c?c:P5,maxQueueLength:null!==(l=y.autoDialMaxQueueLength)&&void 0!==l?l:D5}),this.connectionPruner=new E5({connectionManager:this,peerStore:e.peerStore,events:e.events,logger:e.logger},{maxConnections:this.maxConnections,allow:this.allow}),this.dialQueue=new I5({peerId:e.peerId,metrics:e.metrics,peerStore:e.peerStore,transportManager:e.transportManager,connectionGater:e.connectionGater,logger:e.logger},{addressSorter:null!==(u=y.addressSorter)&&void 0!==u?u:W3,maxParallelDials:null!==(h=y.maxParallelDials)&&void 0!==h?h:50,maxPeerAddrsToDial:null!==(d=y.maxPeerAddrsToDial)&&void 0!==d?d:25,maxParallelDialsPerPeer:null!==(f=y.maxParallelDialsPerPeer)&&void 0!==f?f:1,dialTimeout:null!==(p=y.dialTimeout)&&void 0!==p?p:3e4,resolvers:null!==(g=y.resolvers)&&void 0!==g?g:{dnsaddr:i5},connections:this.connections})}isStarted(){return this.started}async start(){var e,t,n;null===(e=this.metrics)||void 0===e||e.registerMetricGroup("libp2p_connection_manager_connections",{calculate:()=>{const e={inbound:0,outbound:0};for(const t of this.connections.values())for(const n of t)"inbound"===n.direction?e.inbound++:e.outbound++;return e}}),null===(t=this.metrics)||void 0===t||t.registerMetricGroup("libp2p_protocol_streams_total",{label:"protocol",calculate:()=>{const e={};for(const r of this.connections.values())for(const i of r)for(const r of i.streams){var t,n;const i="".concat(r.direction," ").concat(null!==(t=r.protocol)&&void 0!==t?t:"unnegotiated");e[i]=(null!==(n=e[i])&&void 0!==n?n:0)+1}return e}}),null===(n=this.metrics)||void 0===n||n.registerMetricGroup("libp2p_connection_manager_protocol_streams_per_connection_90th_percentile",{label:"protocol",calculate:()=>{const e={};for(const o of this.connections.values())for(const i of o){const o={};for(const e of i.streams){var t,n;const r="".concat(e.direction," ").concat(null!==(t=e.protocol)&&void 0!==t?t:"unnegotiated");o[r]=(null!==(n=o[r])&&void 0!==n?n:0)+1}for(const[t,n]of Object.entries(o)){var r;e[t]=null!==(r=e[t])&&void 0!==r?r:[],e[t].push(n)}}const i={};for(let[o,s]of Object.entries(e)){s=s.sort(((e,t)=>e-t));const e=Math.floor(.9*s.length);i[o]=s[e]}return i}}),this.autoDial.start(),this.started=!0,(0,fx.Z)(this,O5).call(this,"started")}async afterStart(){Promise.resolve().then((async()=>{const e=await this.peerStore.all({filters:[e=>e.tags.has("keep-alive")]});await Promise.all(e.map((async e=>{await this.openConnection(e.id).catch((e=>{(0,fx.Z)(this,O5).error(e)}))})))})).catch((e=>{(0,fx.Z)(this,O5).error(e)})),this.autoDial.afterStart()}async stop(){this.dialQueue.stop(),this.autoDial.stop();const e=[];for(const t of this.connections.values())for(const n of t)e.push((async()=>{try{await n.close()}catch(e){(0,fx.Z)(this,O5).error(e)}})());(0,fx.Z)(this,O5).call(this,"closing %d connections",e.length),await Promise.all(e),this.connections.clear(),(0,fx.Z)(this,O5).call(this,"stopped")}onConnect(e){this._onConnect(e).catch((e=>{(0,fx.Z)(this,O5).error(e)}))}async _onConnect(e){const{detail:t}=e;if(!this.started)return void await t.close();const n=t.remotePeer,r=this.connections.get(n);let i=!1;null!=r?r.push(t):(i=!0,this.connections.set(n,[t])),null!=n.publicKey&&"RSA"===n.type&&await this.peerStore.patch(n,{publicKey:n.publicKey}),i&&this.events.safeDispatchEvent("peer:connect",{detail:t.remotePeer})}onDisconnect(e){const{detail:t}=e;if(!this.started)return;const n=t.remotePeer;let r=this.connections.get(n);null!=r&&r.length>1?(r=r.filter((e=>e.id!==t.id)),this.connections.set(n,r)):null!=r&&(this.connections.delete(n),this.events.safeDispatchEvent("peer:disconnect",{detail:t.remotePeer}))}getConnections(e){var t;if(null!=e)return null!==(t=this.connections.get(e))&&void 0!==t?t:[];let n=[];for(const r of this.connections.values())n=n.concat(r);return n}getConnectionsMap(){return this.connections}async openConnection(e){var t,n;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isStarted())throw new aq("Not started",s5.ERR_NODE_NOT_STARTED);null===(t=r.signal)||void 0===t||t.throwIfAborted();const{peerId:i}=u5(e);if(null!=i&&!0!==r.force){(0,fx.Z)(this,O5).call(this,"dial %p",i);const e=this.getConnections(i).find((e=>!e.transient));if(null!=e)return(0,fx.Z)(this,O5).call(this,"had an existing non-transient connection to %p",i),e}const o=await this.dialQueue.dial(e,{...r,priority:null!==(n=r.priority)&&void 0!==n?n:50});let s=this.connections.get(o.remotePeer);null==s&&(s=[],this.connections.set(o.remotePeer,s));let a=!1;for(const c of s)c.id===o.id&&(a=!0);return a||s.push(o),o}async closeConnections(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=null!==(t=this.connections.get(e))&&void 0!==t?t:[];await Promise.all(r.map((async e=>{try{await e.close(n)}catch(t){e.abort(t)}})))}async acceptIncomingConnection(e){if(this.deny.some((t=>e.remoteAddr.toString().startsWith(t.toString()))))return(0,fx.Z)(this,O5).call(this,"connection from %a refused - connection remote address was in deny list",e.remoteAddr),!1;if(this.allow.some((t=>e.remoteAddr.toString().startsWith(t.toString()))))return this.incomingPendingConnections++,!0;if(this.incomingPendingConnections===this.maxIncomingPendingConnections)return(0,fx.Z)(this,O5).call(this,"connection from %a refused - incomingPendingConnections exceeded by host",e.remoteAddr),!1;if(e.remoteAddr.isThinWaistAddress()){const t=e.remoteAddr.nodeAddress().address;try{await this.inboundConnectionRateLimiter.consume(t,1)}catch{return(0,fx.Z)(this,O5).call(this,"connection from %a refused - inboundConnectionThreshold exceeded by host %s",e.remoteAddr,t),!1}}return this.getConnections().length<this.maxConnections?(this.incomingPendingConnections++,!0):((0,fx.Z)(this,O5).call(this,"connection from %a refused - maxConnections exceeded",e.remoteAddr),!1)}afterUpgradeInbound(){this.incomingPendingConnections--}getDialQueue(){return this.dialQueue.pendingDials}}async function*B5(e,t){yield*zq(e,(async e=>(await t.merge(e.id,{multiaddrs:e.multiaddrs}),e)))}function L5(e){const t=new Set;return gH(e,(e=>!t.has(e.id.toString())&&(t.add(e.id.toString()),!0)))}function M5(e){try{let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return async function*(){let n=0;for await(const t of e)n++,yield t;if(n<t)throw new aq("more peers required, seen: ".concat(n,"  min: ").concat(t),"NOT_FOUND")}()}catch(t){return Promise.reject(t)}}class U5{constructor(e,t){var n;(0,Yo.Z)(this,"routers",void 0),(0,Yo.Z)(this,"started",void 0),(0,Yo.Z)(this,"components",void 0),this.routers=null!==(n=t.routers)&&void 0!==n?n:[],this.started=!1,this.components=e}isStarted(){return this.started}async start(){this.started=!0}async stop(){this.started=!1}findProviders(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){if(0===t.routers.length)throw new aq("No content routers available",s5.ERR_NO_ROUTERS_AVAILABLE);yield*Yq(Qq(...t.routers.map((t=>t.findProviders(e,n)))),(e=>B5(e,t.components.peerStore)),(e=>L5(e)),(e=>M5(e)))}()}catch(n){return Promise.reject(n)}}async provide(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===this.routers.length)throw new aq("No content routers available",s5.ERR_NO_ROUTERS_AVAILABLE);await Promise.all(this.routers.map((async n=>{await n.provide(e,t)})))}async put(e,t,n){if(!this.isStarted())throw new aq(o5.NOT_STARTED_YET,s5.DHT_NOT_STARTED);await Promise.all(this.routers.map((async r=>{await r.put(e,t,n)})))}async get(e,t){if(!this.isStarted())throw new aq(o5.NOT_STARTED_YET,s5.DHT_NOT_STARTED);return Promise.any(this.routers.map((async n=>n.get(e,t))))}}const F5=function(e){if(null!=e[Symbol.asyncIterator])return(async()=>{for await(const t of e)return t})();for(const t of e)return t},K5=aH("libp2p:peer-routing");class j5{constructor(e,t){var n;(0,Yo.Z)(this,"components",void 0),(0,Yo.Z)(this,"routers",void 0),this.components=e,this.routers=null!==(n=t.routers)&&void 0!==n?n:[]}async findPeer(e,t){if(0===this.routers.length)throw new aq("No peer routers available",s5.ERR_NO_ROUTERS_AVAILABLE);if(e.toString()===this.components.peerId.toString())throw new aq("Should not try to find self",s5.ERR_FIND_SELF);const n=await Yq(Qq(...this.routers.map((n=>async function*(){try{yield await n.findPeer(e,t)}catch(r){K5.error(r)}}()))),(e=>gH(e,Boolean)),(e=>B5(e,this.components.peerStore)),(async e=>F5(e)));if(null!=n)return n;throw new aq(o5.NOT_FOUND,s5.ERR_NOT_FOUND)}async*getClosestPeers(e,t){if(0===this.routers.length)throw new aq("No peer routers available",s5.ERR_NO_ROUTERS_AVAILABLE);yield*Yq(Qq(...this.routers.map((n=>n.getClosestPeers(e,t)))),(e=>B5(e,this.components.peerStore)),(e=>L5(e)),(e=>M5(e)))}}const Z5=aH("libp2p:registrar");class z5{constructor(e){(0,Yo.Z)(this,"topologies",void 0),(0,Yo.Z)(this,"handlers",void 0),(0,Yo.Z)(this,"components",void 0),this.topologies=new Map,this.handlers=new Map,this.components=e,this._onDisconnect=this._onDisconnect.bind(this),this._onPeerUpdate=this._onPeerUpdate.bind(this),this._onPeerIdentify=this._onPeerIdentify.bind(this),this.components.events.addEventListener("peer:disconnect",this._onDisconnect),this.components.events.addEventListener("peer:update",this._onPeerUpdate),this.components.events.addEventListener("peer:identify",this._onPeerIdentify)}getProtocols(){return Array.from(new Set([...this.handlers.keys()])).sort()}getHandler(e){const t=this.handlers.get(e);if(null==t)throw new aq("No handler registered for protocol ".concat(e),s5.ERR_NO_HANDLER_FOR_PROTOCOL);return t}getTopologies(e){const t=this.topologies.get(e);return null==t?[]:[...t.values()]}async handle(e,t,n){if(this.handlers.has(e))throw new aq("Handler already registered for protocol ".concat(e),s5.ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED);const r=g0.Z.bind({ignoreUndefined:!0})({maxInboundStreams:32,maxOutboundStreams:64},n);this.handlers.set(e,{handler:t,options:r}),await this.components.peerStore.merge(this.components.peerId,{protocols:[e]})}async unhandle(e){(Array.isArray(e)?e:[e]).forEach((e=>{this.handlers.delete(e)})),await this.components.peerStore.patch(this.components.peerId,{protocols:this.getProtocols()})}async register(e,t){if(null==t)throw new aq("invalid topology",s5.ERR_INVALID_PARAMETERS);const n="".concat((1e9*Math.random()).toString(36)).concat(Date.now());let r=this.topologies.get(e);return null==r&&(r=new Map,this.topologies.set(e,r)),r.set(n,t),n}unregister(e){for(const[t,n]of this.topologies.entries())n.has(e)&&(n.delete(e),0===n.size&&this.topologies.delete(t))}_onDisconnect(e){const t=e.detail;this.components.peerStore.get(t).then((e=>{for(const r of e.protocols){const e=this.topologies.get(r);if(null!=e)for(const r of e.values()){var n;null===(n=r.onDisconnect)||void 0===n||n.call(r,t)}}})).catch((e=>{e.code!==s5.ERR_NOT_FOUND&&Z5.error("could not inform topologies of disconnecting peer %p",t,e)}))}_onPeerUpdate(e){var t;const{peer:n,previous:r}=e.detail,i=(null!==(t=null===r||void 0===r?void 0:r.protocols)&&void 0!==t?t:[]).filter((e=>!n.protocols.includes(e)));for(const s of i){const e=this.topologies.get(s);if(null!=e)for(const t of e.values()){var o;null===(o=t.onDisconnect)||void 0===o||o.call(t,n.id)}}}_onPeerIdentify(e){const t=e.detail.protocols,n=e.detail.connection,r=e.detail.peerId;for(const o of t){const e=this.topologies.get(o);if(null!=e)for(const t of e.values()){var i;n.transient&&!0!==t.notifyOnTransient||(null===(i=t.onConnect)||void 0===i||i.call(t,r,n))}}}}const V5=aH("libp2p:transports");class H5{constructor(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,Yo.Z)(this,"components",void 0),(0,Yo.Z)(this,"transports",void 0),(0,Yo.Z)(this,"listeners",void 0),(0,Yo.Z)(this,"faultTolerance",void 0),(0,Yo.Z)(this,"started",void 0),this.components=e,this.started=!1,this.transports=new Map,this.listeners=oq({name:"libp2p_transport_manager_listeners",metrics:this.components.metrics}),this.faultTolerance=null!==(t=n.faultTolerance)&&void 0!==t?t:q3.FATAL_ALL}add(e){const t=e[Symbol.toStringTag];if(null==t)throw new aq("Transport must have a valid tag",s5.ERR_INVALID_KEY);if(this.transports.has(t))throw new aq("There is already a transport with the tag ".concat(t),s5.ERR_DUPLICATE_TRANSPORT);V5("adding transport %s",t),this.transports.set(t,e),this.listeners.has(t)||this.listeners.set(t,[])}isStarted(){return this.started}start(){this.started=!0}async afterStart(){const e=this.components.addressManager.getListenAddrs();await this.listen(e)}async stop(){const e=[];for(const[t,n]of this.listeners)for(V5("closing listeners for %s",t);n.length>0;){const t=n.pop();null!=t&&e.push(t.close())}await Promise.all(e),V5("all listeners closed");for(const t of this.listeners.keys())this.listeners.set(t,[]);this.started=!1}async dial(e,t){const n=this.transportForMultiaddr(e);if(null==n)throw new aq("No transport available for address ".concat(String(e)),s5.ERR_TRANSPORT_UNAVAILABLE);try{return await n.dial(e,{...t,upgrader:this.components.upgrader})}catch(r){throw null==r.code&&(r.code=s5.ERR_TRANSPORT_DIAL_FAILED),r}}getAddrs(){let e=[];for(const t of this.listeners.values())for(const n of t)e=[...e,...n.getAddrs()];return e}getTransports(){return Array.of(...this.transports.values())}getListeners(){return Array.of(...this.listeners.values()).flat()}transportForMultiaddr(e){for(const t of this.transports.values()){if(t.filter([e]).length>0)return t}}async listen(e){if(!this.isStarted())throw new aq("Not started",s5.ERR_NODE_NOT_STARTED);if(null==e||0===e.length)return void V5("no addresses were provided for listening, this node is dial only");const t=[];for(const[r,i]of this.transports.entries()){const o=i.filter(e),s=[];for(const e of o){var n;V5("creating listener for %s on %a",r,e);const t=i.createListener({upgrader:this.components.upgrader});let o=null!==(n=this.listeners.get(r))&&void 0!==n?n:[];null==o&&(o=[],this.listeners.set(r,o)),o.push(t),t.addEventListener("listening",(()=>{this.components.events.safeDispatchEvent("transport:listening",{detail:t})})),t.addEventListener("close",(()=>{const e=o.findIndex((e=>e===t));o.splice(e,1),this.components.events.safeDispatchEvent("transport:close",{detail:t})})),s.push(t.listen(e))}if(0===s.length){t.push(r);continue}if(null==(await Promise.allSettled(s)).find((e=>"fulfilled"===e.status))&&this.faultTolerance!==q3.NO_FATAL)throw new aq("Transport (".concat(r,") could not listen on any available address"),s5.ERR_NO_VALID_ADDRESSES)}if(t.length===this.transports.size){const e="no valid addresses were provided for transports [".concat(t.join(", "),"]");if(this.faultTolerance===q3.FATAL_ALL)throw new aq(e,s5.ERR_NO_VALID_ADDRESSES);V5("libp2p in dial mode only: ".concat(e))}}async remove(e){var t;const n=null!==(t=this.listeners.get(e))&&void 0!==t?t:[];V5.trace("removing transport %s",e);const r=[];for(V5.trace("closing listeners for %s",e);n.length>0;){const e=n.pop();null!=e&&r.push(e.close())}await Promise.all(r),this.transports.delete(e),this.listeners.delete(e)}async removeAll(){const e=[];for(const t of this.transports.keys())e.push(this.remove(t));await Promise.all(e)}}const q5="/multistream/1.0.0",G5=1024,W5=(0,yu.m)("\n");async function Q5(e,t,n){await e.write(t,n)}async function Y5(e,t){const n=await async function(e,t){const n=await e.read(t);if(0===n.byteLength||n.get(n.byteLength-1)!==W5[0])throw null===t||void 0===t||t.log.error("Invalid mss message - missing newline",n),new fu.sv("missing newline","ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");return n.sublist(0,-1)}(e,t);return(0,Au.B)(n.subarray())}async function J5(e,t,n){if(1===(t=Array.isArray(t)?[...t]:[t]).length)return function(e,t,n){const r=e.sink.bind(e),i=e.source;let o=!1,s=!1;const a=Ws();let c=!1,l=!1;const u=Ws();let h=!1,d=!1;const f=Ws(),p=la({sink:r,source:i},{...n,maxDataLength:G5});async function g(){if(s)return null===n||void 0===n||n.log.trace("optimistic: already negotiating %s stream",t),void await a.promise;s=!0;try{c||(null===n||void 0===n||n.log.trace("optimistic: doing send protocol for %s stream",t),await y()),h||(null===n||void 0===n||n.log.trace("optimistic: doing read protocol for %s stream",t),await m())}finally{s=!1,o=!0,a.resolve()}}async function y(){if(l)await u.promise;else{l=!0;try{null===n||void 0===n||n.log.trace('optimistic: write ["%s", "%s", data] in source',q5,t),await p.writeV([(0,yu.m)("".concat(q5,"\n")),(0,yu.m)("".concat(t,"\n"))]),null===n||void 0===n||n.log.trace('optimistic: wrote ["%s", "%s", data] in source',q5,t)}finally{c=!0,l=!1,u.resolve()}}}async function m(){if(d)await f.promise;else{d=!0;try{null===n||void 0===n||n.log.trace("optimistic: reading multistream select header");let e=await Y5(p,n);if(null===n||void 0===n||n.log.trace('optimistic: read multistream select header "%s"',e),e===q5&&(e=await Y5(p,n)),null===n||void 0===n||n.log.trace('optimistic: read protocol "%s", expecting "%s"',e,t),e!==t)throw new fu.sv("protocol selection failed","ERR_UNSUPPORTED_PROTOCOL")}finally{h=!0,d=!1,f.resolve()}}}if(e.sink=async e=>{const{sink:r}=p.unwrap();await r(async function*(){let r=!1;for await(const i of e){if(l&&await u.promise,c)yield i;else{l=!0,null===n||void 0===n||n.log.trace('optimistic: write ["%s", "%s", data(%d)] in sink',q5,t,i.byteLength);const e="".concat(t,"\n");yield new Zs(Uint8Array.from([19]),(0,yu.m)("".concat(q5,"\n")),Bs.cv(e.length),(0,yu.m)(e),i).subarray(),null===n||void 0===n||n.log.trace('optimistic: wrote ["%s", "%s", data(%d)] in sink',q5,t,i.byteLength),c=!0,l=!1,u.resolve()}r=!0}r||await g()}())},e.source=async function*(){await g(),null===n||void 0===n||n.log.trace('optimistic: reading data from "%s" stream',t),yield*p.unwrap().source}(),null!=e.closeRead){const t=e.closeRead.bind(e);e.closeRead=async e=>{o||await g().catch((e=>{null===n||void 0===n||n.log.error("could not negotiate protocol before close read",e)})),await t(e)}}if(null!=e.closeWrite){const t=e.closeWrite.bind(e);e.closeWrite=async e=>{o||await g().catch((e=>{null===n||void 0===n||n.log.error("could not negotiate protocol before close write",e)})),await t(e)}}if(null!=e.close){const t=e.close.bind(e);e.close=async e=>{o||(o=!0,s=!1,a.resolve()),await t(e)}}return{stream:e,protocol:t}}(e,t[0],n);const r=la(e,{...n,maxDataLength:G5}),i=t.shift();if(null==i)throw new Error("At least one protocol must be specified");null===n||void 0===n||n.log.trace('select: write ["%s", "%s"]',q5,i);const o=(0,yu.m)("".concat(q5,"\n")),s=(0,yu.m)("".concat(i,"\n"));await async function(e,t,n){await e.writeV(t,n)}(r,[o,s],n),null===n||void 0===n||n.log.trace("select: reading multistream-select header");let a=await Y5(r,n);if(null===n||void 0===n||n.log.trace('select: read "%s"',a),a===q5&&(null===n||void 0===n||n.log.trace("select: reading protocol response"),a=await Y5(r,n),null===n||void 0===n||n.log.trace('select: read "%s"',a)),a===i)return{stream:r.unwrap(),protocol:i};for(const c of t){null===n||void 0===n||n.log.trace('select: write "%s"',c),await Q5(r,(0,yu.m)("".concat(c,"\n")),n),null===n||void 0===n||n.log.trace("select: reading protocol response");const e=await Y5(r,n);if(null===n||void 0===n||n.log.trace('select: read "%s" for "%s"',e,c),e===c)return{stream:r.unwrap(),protocol:c}}throw new fu.sv("protocol selection failed","ERR_UNSUPPORTED_PROTOCOL")}function X5(e){return null!=e[Symbol.asyncIterator]}const $5=e=>{const t=Bs.P$(e),n=(0,Us.E)(t);return Bs.cv(e,n),$5.bytes=t,n};function e4(e,t){var n,r;const i=null!==(r=(t=null!==(n=t)&&void 0!==n?n:{}).lengthEncoder)&&void 0!==r?r:$5;function*o(e){const t=i(e.byteLength);t instanceof Uint8Array?yield t:yield*t,e instanceof Uint8Array?yield e:yield*e}return X5(e)?async function*(){for await(const t of e)yield*o(t)}():function*(){for(const t of e)yield*o(t)}()}$5.bytes=0,e4.single=(e,t)=>{var n,r;const i=null!==(r=(t=null!==(n=t)&&void 0!==n?n:{}).lengthEncoder)&&void 0!==r?r:$5;return new Zs(i(e.byteLength),e)};var t4;!function(e){e[e.LENGTH=0]="LENGTH",e[e.DATA=1]="DATA"}(t4||(t4={}));const n4=e=>{const t=Bs.Jx(e);return n4.bytes=Bs.P$(t),t};function r4(e,t){var n,r,i;const o=new Zs;let s=t4.LENGTH,a=-1;const c=null!==(n=null===t||void 0===t?void 0:t.lengthDecoder)&&void 0!==n?n:n4,l=null!==(r=null===t||void 0===t?void 0:t.maxLengthLength)&&void 0!==r?r:8,u=null!==(i=null===t||void 0===t?void 0:t.maxDataLength)&&void 0!==i?i:4194304;function*h(){for(;o.byteLength>0;){if(s===t4.LENGTH)try{if(a=c(o),a<0)throw Xo()(new Error("invalid message length"),"ERR_INVALID_MSG_LENGTH");if(a>u)throw Xo()(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");const e=c.bytes;o.consume(e),null!=(null===t||void 0===t?void 0:t.onLength)&&t.onLength(a),s=t4.DATA}catch(e){if(e instanceof RangeError){if(o.byteLength>l)throw Xo()(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG");break}throw e}if(s===t4.DATA){if(o.byteLength<a)break;const e=o.sublist(0,a);o.consume(a),null!=(null===t||void 0===t?void 0:t.onData)&&t.onData(e),yield e,s=t4.LENGTH}}}return X5(e)?async function*(){for await(const t of e)o.append(t),yield*h();if(o.byteLength>0)throw Xo()(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}():function*(){for(const t of e)o.append(t),yield*h();if(o.byteLength>0)throw Xo()(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}()}async function i4(e,t,n){t=Array.isArray(t)?t:[t],n.log.trace("handle: available protocols %s",t);const r=la(e,{...n,maxDataLength:G5,maxLengthLength:2});for(;;){null===n||void 0===n||n.log.trace("handle: reading incoming string");const e=await Y5(r,n);if(n.log.trace('handle: read "%s"',e),e!==q5){if(t.includes(e))return n.log.trace('handle: respond with "%s" for "%s"',e,e),await Q5(r,(0,yu.m)("".concat(e,"\n")),n),n.log.trace('handle: responded with "%s" for "%s"',e,e),{stream:r.unwrap(),protocol:e};if("ls"!==e)n.log('handle: respond with "na" for "%s"',e),await Q5(r,(0,yu.m)("na\n"),n),n.log('handle: responded with "na" for "%s"',e);else{const i=new Zs(...t.map((e=>e4.single((0,yu.m)("".concat(e,"\n"))))),(0,yu.m)("\n"));n.log.trace('handle: respond with "%s" for %s',t,e),await Q5(r,i,n),n.log.trace('handle: responded with "%s" for %s',t,e)}}else n.log.trace('handle: respond with "%s" for "%s"',q5,e),await Q5(r,(0,yu.m)("".concat(q5,"\n")),n),n.log.trace('handle: responded with "%s" for "%s"',q5,e)}}n4.bytes=0,r4.fromReader=(e,t)=>{let n=1;return r4(async function*(){for(;;)try{const{done:t,value:r}=await e.next(n);if(!0===t)return;null!=r&&(yield r)}catch(t){if("ERR_UNDER_READ"===t.code)return{done:!0,value:null};throw t}finally{n=1}}(),{...null!==t&&void 0!==t?t:{},onLength:e=>{n=e}})};const o4=Symbol.for("@libp2p/connection");var s4=new WeakMap;class a4{constructor(e){var t;(0,Yo.Z)(this,"id",void 0),(0,Yo.Z)(this,"remoteAddr",void 0),(0,Yo.Z)(this,"remotePeer",void 0),(0,Yo.Z)(this,"direction",void 0),(0,Yo.Z)(this,"timeline",void 0),(0,Yo.Z)(this,"multiplexer",void 0),(0,Yo.Z)(this,"encryption",void 0),(0,Yo.Z)(this,"status",void 0),(0,Yo.Z)(this,"transient",void 0),(0,Yo.Z)(this,"tags",void 0),(0,Yo.Z)(this,"_newStream",void 0),(0,Yo.Z)(this,"_close",void 0),(0,Yo.Z)(this,"_abort",void 0),(0,Yo.Z)(this,"_getStreams",void 0),(0,dx.Z)(this,s4,{writable:!0,value:void 0}),(0,Yo.Z)(this,Symbol.toStringTag,"Connection"),(0,Yo.Z)(this,o4,!0);const{remoteAddr:n,remotePeer:r,newStream:i,close:o,abort:s,getStreams:a}=e;this.id="".concat(parseInt(String(1e9*Math.random())).toString(36)).concat(Date.now()),this.remoteAddr=n,this.remotePeer=r,this.direction=e.direction,this.status="open",this.timeline=e.timeline,this.multiplexer=e.multiplexer,this.encryption=e.encryption,this.transient=null!==(t=e.transient)&&void 0!==t&&t,CG(this,s4,e.logger.forComponent("libp2p:connection")),null==this.remoteAddr.getPeerId()&&(this.remoteAddr=this.remoteAddr.encapsulate("/p2p/".concat(this.remotePeer))),this._newStream=i,this._close=o,this._abort=s,this._getStreams=a,this.tags=[]}get streams(){return this._getStreams()}async newStream(e,t){if("closing"===this.status)throw new aq("the connection is being closed","ERR_CONNECTION_BEING_CLOSED");if("closed"===this.status)throw new aq("the connection is closed","ERR_CONNECTION_CLOSED");if(Array.isArray(e)||(e=[e]),this.transient&&!0!==(null===t||void 0===t?void 0:t.runOnTransientConnection))throw new aq("Cannot open protocol stream on transient connection","ERR_TRANSIENT_CONNECTION");const n=await this._newStream(e,t);return n.direction="outbound",n}async close(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("closed"!==this.status&&"closing"!==this.status){if((0,fx.Z)(this,s4).call(this,"closing connection to %a",this.remoteAddr),this.status="closing",null==e.signal){const t=AbortSignal.timeout(500);dJ(1/0,t),e={...e,signal:t}}try{(0,fx.Z)(this,s4).trace("closing all streams"),await Promise.all(this.streams.map((async t=>t.close(e)))),(0,fx.Z)(this,s4).trace("closing underlying transport"),await this._close(e),(0,fx.Z)(this,s4).trace("updating timeline with close time"),this.status="closed",this.timeline.close=Date.now()}catch(t){(0,fx.Z)(this,s4).error("error encountered during graceful close of connection to %a",this.remoteAddr,t),this.abort(t)}}}abort(e){(0,fx.Z)(this,s4).error("aborting connection to %a due to error",this.remoteAddr,e),this.status="closing",this.streams.forEach((t=>{t.abort(e)})),(0,fx.Z)(this,s4).error("all streams aborted",this.streams.length),this._abort(e),this.timeline.close=Date.now(),this.status="closed"}}function c4(e,t,n){let r=0;return n.streams.forEach((n=>{n.direction===t&&n.protocol===e&&r++})),r}var l4=new WeakMap;class u4{constructor(e,t){var n;(0,Yo.Z)(this,"components",void 0),(0,Yo.Z)(this,"connectionEncryption",void 0),(0,Yo.Z)(this,"muxers",void 0),(0,Yo.Z)(this,"inboundUpgradeTimeout",void 0),(0,Yo.Z)(this,"events",void 0),(0,dx.Z)(this,l4,{writable:!0,value:void 0}),this.components=e,this.connectionEncryption=new Map,CG(this,l4,e.logger.forComponent("libp2p:upgrader")),t.connectionEncryption.forEach((e=>{this.connectionEncryption.set(e.protocol,e)})),this.muxers=new Map,t.muxers.forEach((e=>{this.muxers.set(e.protocol,e)})),this.inboundUpgradeTimeout=null!==(n=t.inboundUpgradeTimeout)&&void 0!==n?n:3e4,this.events=e.events}async shouldBlockConnection(e,t,n){const r=this.components.connectionGater[n];if(void 0!==r&&await r(e,t))throw new aq("The multiaddr connection is blocked by gater.".concat(n),s5.ERR_CONNECTION_INTERCEPTED)}async upgradeInbound(e,t){if(!await this.components.connectionManager.acceptIncomingConnection(e))throw new aq("connection denied",s5.ERR_CONNECTION_DENIED);let n,r,i,o,s;const a=AbortSignal.timeout(this.inboundUpgradeTimeout),c=()=>{e.abort(new aq("inbound upgrade timeout",s5.ERR_TIMEOUT))};a.addEventListener("abort",c,{once:!0}),dJ(1/0,a);try{var l,u,h;if(!0===await(null===(l=(u=this.components.connectionGater).denyInboundConnection)||void 0===l?void 0:l.call(u,e)))throw new aq("The multiaddr connection is blocked by gater.acceptConnection",s5.ERR_CONNECTION_INTERCEPTED);null===(h=this.components.metrics)||void 0===h||h.trackMultiaddrConnection(e),(0,fx.Z)(this,l4).call(this,"starting the inbound connection upgrade");let a=e;if(!0!==(null===t||void 0===t?void 0:t.skipProtection)){const t=this.components.connectionProtector;null!=t&&((0,fx.Z)(this,l4).call(this,"protecting the inbound connection"),a=await t.protect(e))}try{if(n=a,!0!==(null===t||void 0===t?void 0:t.skipEncryption)){({conn:n,remotePeer:r,protocol:s}=await this._encryptInbound(a));const e={...a,...n};await this.shouldBlockConnection(r,e,"denyInboundEncryptedConnection")}else{const t=e.remoteAddr.getPeerId();if(null==t)throw new aq("inbound connection that skipped encryption must have a peer id",s5.ERR_INVALID_MULTIADDR);const n=X0(t);s="native",r=n}if(i=n,null!=(null===t||void 0===t?void 0:t.muxerFactory))o=t.muxerFactory;else if(this.muxers.size>0){const e=await this._multiplexInbound({...a,...n},this.muxers);o=e.muxerFactory,i=e.stream}}catch(d){throw(0,fx.Z)(this,l4).error("Failed to upgrade inbound connection",d),d}return await this.shouldBlockConnection(r,e,"denyInboundUpgradedConnection"),(0,fx.Z)(this,l4).call(this,"Successfully upgraded inbound connection"),this._createConnection({cryptoProtocol:s,direction:"inbound",maConn:e,upgradedConn:i,muxerFactory:o,remotePeer:r,transient:null===t||void 0===t?void 0:t.transient})}finally{a.removeEventListener("abort",c),this.components.connectionManager.afterUpgradeInbound()}}async upgradeOutbound(e,t){var n;const r=e.remoteAddr.getPeerId();let i,o,s,a,c,l;null!=r&&(i=X0(r),await this.shouldBlockConnection(i,e,"denyOutboundConnection")),null===(n=this.components.metrics)||void 0===n||n.trackMultiaddrConnection(e),(0,fx.Z)(this,l4).call(this,"Starting the outbound connection upgrade");let u=e;if(!0!==(null===t||void 0===t?void 0:t.skipProtection)){const t=this.components.connectionProtector;null!=t&&(u=await t.protect(e))}try{if(o=u,!0!==(null===t||void 0===t?void 0:t.skipEncryption)){({conn:o,remotePeer:s,protocol:c}=await this._encryptOutbound(u,i));const e={...u,...o};await this.shouldBlockConnection(s,e,"denyOutboundEncryptedConnection")}else{if(null==i)throw new aq("Encryption was skipped but no peer id was passed",s5.ERR_INVALID_PEER);c="native",s=i}if(a=o,null!=(null===t||void 0===t?void 0:t.muxerFactory))l=t.muxerFactory;else if(this.muxers.size>0){const e=await this._multiplexOutbound({...u,...o},this.muxers);l=e.muxerFactory,a=e.stream}}catch(h){throw(0,fx.Z)(this,l4).error("Failed to upgrade outbound connection",h),await e.close(h),h}return await this.shouldBlockConnection(s,e,"denyOutboundUpgradedConnection"),(0,fx.Z)(this,l4).call(this,"Successfully upgraded outbound connection"),this._createConnection({cryptoProtocol:c,direction:"outbound",maConn:e,upgradedConn:a,muxerFactory:l,remotePeer:s,transient:null===t||void 0===t?void 0:t.transient})}_createConnection(e){var t,n,r=this;const{cryptoProtocol:i,direction:o,maConn:s,upgradedConn:a,remotePeer:c,muxerFactory:l,transient:u}=e;let h,d,f;null!=l&&(h=l.createStreamMuxer({direction:o,onIncomingStream:e=>{null!=f&&Promise.resolve().then((async()=>{var t;const n=this.components.registrar.getProtocols(),{stream:r,protocol:i}=await i4(e,n);if((0,fx.Z)(this,l4).call(this,"%s: incoming stream opened on %s",o,i),null==f)return;const s=function(e,t){try{const{options:n}=t.getHandler(e);return n.maxInboundStreams}catch(n){if(n.code!==s5.ERR_NO_HANDLER_FOR_PROTOCOL)throw n}return 32}(i,this.components.registrar);if(c4(i,"inbound",f)===s){const t=new aq('Too many inbound protocol streams for protocol "'.concat(i,'" - limit ').concat(s),s5.ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS);throw e.abort(t),t}e.source=r.source,e.sink=r.sink,e.protocol=i,await this.components.peerStore.merge(c,{protocols:[i]}),null===(t=this.components.metrics)||void 0===t||t.trackProtocolStream(e,f),this._onStream({connection:f,stream:e,protocol:i})})).catch((async t=>{(0,fx.Z)(this,l4).error(t),null==e.timeline.close&&await e.close()}))}}),d=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null==h)throw new aq("Stream is not multiplexed",s5.ERR_MUXER_UNAVAILABLE);(0,fx.Z)(r,l4).call(r,"%s-%s: starting new stream on %s",f.id,o,e);const n=await h.newStream();try{var i;if(null==t.signal){(0,fx.Z)(r,l4).call(r,"No abort signal was passed while trying to negotiate protocols %s falling back to default timeout",e);const n=AbortSignal.timeout(3e4);dJ(1/0,n),t={...t,signal:n}}const{stream:o,protocol:s}=await J5(n,e,t),a=function(e,t){var n;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{const{options:n}=t.getHandler(e);if(null!=n.maxOutboundStreams)return n.maxOutboundStreams}catch(i){if(i.code!==s5.ERR_NO_HANDLER_FOR_PROTOCOL)throw i}return null!==(n=r.maxOutboundStreams)&&void 0!==n?n:64}(s,r.components.registrar,t);if(c4(s,"outbound",f)>=a){const e=new aq('Too many outbound protocol streams for protocol "'.concat(s,'" - limit ').concat(a),s5.ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS);throw n.abort(e),e}return await r.components.peerStore.merge(c,{protocols:[s]}),n.source=o.source,n.sink=o.sink,n.protocol=s,null===(i=r.components.metrics)||void 0===i||i.trackProtocolStream(n,f),n}catch(s){if((0,fx.Z)(r,l4).error("could not create new stream for protocols %s on connection with address %a",e,f.remoteAddr,s),null==n.timeline.close&&n.abort(s),null!=s.code)throw s;throw new aq(String(s),s5.ERR_UNSUPPORTED_PROTOCOL)}},Promise.all([h.sink(a.source),a.sink(h.source)]).catch((e=>{(0,fx.Z)(this,l4).error(e)})));const p=s.timeline;s.timeline=new Proxy(p,{set:function(){return null!=f&&"close"===(arguments.length<=1?void 0:arguments[1])&&null!=(arguments.length<=2?void 0:arguments[2])&&null==p.close&&(async()=>{try{"open"===f.status&&await f.close()}catch(e){(0,fx.Z)(r,l4).error(e)}finally{r.events.safeDispatchEvent("connection:close",{detail:f})}})().catch((e=>{(0,fx.Z)(r,l4).error(e)})),Reflect.set(...arguments)}}),s.timeline.upgraded=Date.now();var g;return g={remoteAddr:s.remoteAddr,remotePeer:c,status:"open",direction:o,timeline:s.timeline,multiplexer:null===(t=h)||void 0===t?void 0:t.protocol,encryption:i,transient:u,logger:this.components.logger,newStream:null!==(n=d)&&void 0!==n?n:()=>{throw new aq("connection is not multiplexed",s5.ERR_CONNECTION_NOT_MULTIPLEXED)},getStreams:()=>null!=h?h.streams:[],close:async e=>{null!=h&&((0,fx.Z)(this,l4).trace("close muxer"),await h.close(e)),(0,fx.Z)(this,l4).trace("close maconn"),await s.close(e),(0,fx.Z)(this,l4).trace("closed maconn")},abort:e=>{s.abort(e),null!=h&&h.abort(e)}},f=new a4(g),this.events.safeDispatchEvent("connection:open",{detail:f}),f}_onStream(e){const{connection:t,stream:n,protocol:r}=e,{handler:i,options:o}=this.components.registrar.getHandler(r);if(t.transient&&!0!==o.runOnTransientConnection)throw new aq("Cannot open protocol stream on transient connection","ERR_TRANSIENT_CONNECTION");i({connection:t,stream:n})}async _encryptInbound(e){const t=Array.from(this.connectionEncryption.keys());(0,fx.Z)(this,l4).call(this,"handling inbound crypto protocol selection",t);try{const{stream:n,protocol:r}=await i4(e,t,{writeBytes:!0}),i=this.connectionEncryption.get(r);if(null==i)throw new Error("no crypto module found for ".concat(r));return(0,fx.Z)(this,l4).call(this,"encrypting inbound connection..."),{...await i.secureInbound(this.components.peerId,n),protocol:r}}catch(n){throw new aq(String(n),s5.ERR_ENCRYPTION_FAILED)}}async _encryptOutbound(e,t){const n=Array.from(this.connectionEncryption.keys());(0,fx.Z)(this,l4).call(this,"selecting outbound crypto protocol",n);try{const{stream:r,protocol:i}=await J5(e,n,{writeBytes:!0}),o=this.connectionEncryption.get(i);if(null==o)throw new Error("no crypto module found for ".concat(i));return(0,fx.Z)(this,l4).call(this,"encrypting outbound connection to %p",t),{...await o.secureOutbound(this.components.peerId,r,t),protocol:i}}catch(r){throw new aq(String(r),s5.ERR_ENCRYPTION_FAILED)}}async _multiplexOutbound(e,t){const n=Array.from(t.keys());(0,fx.Z)(this,l4).call(this,"outbound selecting muxer %s",n);try{const{stream:r,protocol:i}=await J5(e,n,{writeBytes:!0});(0,fx.Z)(this,l4).call(this,"%s selected as muxer protocol",i);return{stream:r,muxerFactory:t.get(i)}}catch(r){throw(0,fx.Z)(this,l4).error("error multiplexing outbound stream",r),new aq(String(r),s5.ERR_MUXER_UNAVAILABLE)}}async _multiplexInbound(e,t){const n=Array.from(t.keys());(0,fx.Z)(this,l4).call(this,"inbound handling muxers %s",n);try{const{stream:r,protocol:i}=await i4(e,n,{writeBytes:!0});return{stream:r,muxerFactory:t.get(i)}}catch(r){throw(0,fx.Z)(this,l4).error("error multiplexing inbound stream",r),new aq(String(r),s5.ERR_MUXER_UNAVAILABLE)}}}var h4,d4=new WeakMap,f4=new WeakMap,p4=new WeakSet;class g4 extends lJ{constructor(e){var t,n,r,i,o,s,a;super(),Qd(this,p4),(0,Yo.Z)(this,"peerId",void 0),(0,Yo.Z)(this,"peerStore",void 0),(0,Yo.Z)(this,"contentRouting",void 0),(0,Yo.Z)(this,"peerRouting",void 0),(0,Yo.Z)(this,"keychain",void 0),(0,Yo.Z)(this,"metrics",void 0),(0,Yo.Z)(this,"services",void 0),(0,Yo.Z)(this,"logger",void 0),(0,Yo.Z)(this,"components",void 0),(0,dx.Z)(this,d4,{writable:!0,value:void 0}),(0,dx.Z)(this,f4,{writable:!0,value:void 0});const c=new lJ,l=c.dispatchEvent.bind(c);c.dispatchEvent=e=>{const t=l(e),n=this.dispatchEvent(new hJ(e.type,{detail:e.detail}));return t||n},dJ(1/0,c),CG(this,d4,!1),this.peerId=e.peerId,this.logger=null!==(t=e.logger)&&void 0!==t?t:sH(),CG(this,f4,this.logger.forComponent("libp2p")),this.services={};const u=this.components=function(){const e=new j3(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});return new Proxy(e,{get(t,n,r){if("string"===typeof n&&!z3.includes(n)){const t=e.components[n];if(null==t&&!Z3.includes(n))throw new aq("".concat(n," not set"),"ERR_SERVICE_MISSING");return t}return Reflect.get(t,n,r)},set:(t,n,r)=>("string"===typeof n?e.components[n]=r:Reflect.set(t,n,r),!0)})}({peerId:e.peerId,logger:this.logger,events:c,datastore:null!==(n=e.datastore)&&void 0!==n?n:new vH,connectionGater:V3(e.connectionGater)});this.peerStore=this.configureComponent("peerStore",new B3(u,{addressFilter:this.components.connectionGater.filterMultiaddrForPeer,...e.peerStore})),null!=e.metrics&&(this.metrics=this.configureComponent("metrics",e.metrics(this.components))),u.events.addEventListener("peer:update",(e=>{if(null==e.detail.previous){const t={id:e.detail.peer.id,multiaddrs:e.detail.peer.addresses.map((e=>e.multiaddr)),protocols:e.detail.peer.protocols};u.events.safeDispatchEvent("peer:discovery",{detail:t})}})),null!=e.connectionProtector&&this.configureComponent("connectionProtector",e.connectionProtector(u)),this.components.upgrader=new u4(this.components,{connectionEncryption:(null!==(r=e.connectionEncryption)&&void 0!==r?r:[]).map(((e,t)=>this.configureComponent("connection-encryption-".concat(t),e(this.components)))),muxers:(null!==(i=e.streamMuxers)&&void 0!==i?i:[]).map(((e,t)=>this.configureComponent("stream-muxers-".concat(t),e(this.components)))),inboundUpgradeTimeout:e.connectionManager.inboundUpgradeTimeout}),this.configureComponent("transportManager",new H5(this.components,e.transportManager)),this.configureComponent("connectionManager",new N5(this.components,e.connectionManager)),this.configureComponent("registrar",new z5(this.components)),this.configureComponent("addressManager",new K3(this.components,e.addresses));const h=R0.generateOptions();this.keychain=this.configureComponent("keyChain",new R0(this.components,{...h,...e.keychain}));const d=(null!==(o=e.peerRouters)&&void 0!==o?o:[]).map(((e,t)=>this.configureComponent("peer-router-".concat(t),e(this.components))));this.peerRouting=this.components.peerRouting=this.configureComponent("peerRouting",new j5(this.components,{routers:d}));const f=(null!==(s=e.contentRouters)&&void 0!==s?s:[]).map(((e,t)=>this.configureComponent("content-router-".concat(t),e(this.components))));if(this.contentRouting=this.components.contentRouting=this.configureComponent("contentRouting",new U5(this.components,{routers:f})),(null!==(a=e.peerDiscovery)&&void 0!==a?a:[]).forEach(((e,t)=>{this.configureComponent("peer-discovery-".concat(t),e(this.components)).addEventListener("peer",(e=>{Yd(this,p4,y4).call(this,e)}))})),e.transports.forEach(((e,t)=>{this.components.transportManager.add(this.configureComponent("transport-".concat(t),e(this.components)))})),null!=e.services)for(const p of Object.keys(e.services)){const t=(0,e.services[p])(this.components);null!=t?(this.services[p]=t,this.configureComponent(p,t),null!=t[sJ]&&((0,fx.Z)(this,f4).call(this,"registering service %s for content routing",p),f.push(t[sJ])),null!=t[pJ]&&((0,fx.Z)(this,f4).call(this,"registering service %s for peer routing",p),d.push(t[pJ])),null!=t[fJ]&&((0,fx.Z)(this,f4).call(this,"registering service %s for peer discovery",p),t[fJ].addEventListener("peer",(e=>{Yd(this,p4,y4).call(this,e)})))):(0,fx.Z)(this,f4).error("service factory %s returned null or undefined instance",p)}}configureComponent(e,t){return null==t&&(0,fx.Z)(this,f4).error("component %s was null or undefined",e),this.components[e]=t,t}async start(){if((0,fx.Z)(this,d4))return;CG(this,d4,!0),(0,fx.Z)(this,f4).call(this,"libp2p is starting");null==(await this.keychain.listKeys()).find((e=>"self"===e.name))&&((0,fx.Z)(this,f4).call(this,"importing self key into keychain"),await this.keychain.importPeer("self",this.components.peerId));try{var e,t,n,r;await(null===(e=(t=this.components).beforeStart)||void 0===e?void 0:e.call(t)),await this.components.start(),await(null===(n=(r=this.components).afterStart)||void 0===n?void 0:n.call(r)),this.safeDispatchEvent("start",{detail:this}),(0,fx.Z)(this,f4).call(this,"libp2p has started")}catch(i){throw(0,fx.Z)(this,f4).error("An error occurred starting libp2p",i),await this.stop(),i}}async stop(){var e,t,n,r;(0,fx.Z)(this,d4)&&((0,fx.Z)(this,f4).call(this,"libp2p is stopping"),CG(this,d4,!1),await(null===(e=(t=this.components).beforeStop)||void 0===e?void 0:e.call(t)),await this.components.stop(),await(null===(n=(r=this.components).afterStop)||void 0===n?void 0:n.call(r)),this.safeDispatchEvent("stop",{detail:this}),(0,fx.Z)(this,f4).call(this,"libp2p has stopped"))}isStarted(){return(0,fx.Z)(this,d4)}getConnections(e){return this.components.connectionManager.getConnections(e)}getDialQueue(){return this.components.connectionManager.getDialQueue()}getPeers(){const e=new ux;for(const t of this.components.connectionManager.getConnections())e.add(t.remotePeer);return Array.from(e)}async dial(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.components.connectionManager.openConnection(e,t)}async dialProtocol(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null==t)throw new aq("no protocols were provided to open a stream",s5.ERR_INVALID_PROTOCOLS_FOR_STREAM);if(0===(t=Array.isArray(t)?t:[t]).length)throw new aq("no protocols were provided to open a stream",s5.ERR_INVALID_PROTOCOLS_FOR_STREAM);return(await this.dial(e,n)).newStream(t,n)}getMultiaddrs(){return this.components.addressManager.getAddresses()}getProtocols(){return this.components.registrar.getProtocols()}async hangUp(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;(0,ng.h2)(e)&&(e=X0(null!==(n=e.getPeerId())&&void 0!==n?n:""));await this.components.connectionManager.closeConnections(e,t)}async getPublicKey(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((0,fx.Z)(this,f4).call(this,"getPublicKey %p",e),null!=e.publicKey)return e.publicKey;const n=await this.peerStore.get(e);if(null!=n.id.publicKey)return n.id.publicKey;const r=(0,Ls.z)([(0,yu.m)("/pk/"),e.multihash.digest]),i=await this.contentRouting.get(r,t);return iJ(i),await this.peerStore.patch(e,{publicKey:i}),i}async handle(e,t,n){Array.isArray(e)||(e=[e]),await Promise.all(e.map((async e=>{await this.components.registrar.handle(e,t,n)})))}async unhandle(e){Array.isArray(e)||(e=[e]),await Promise.all(e.map((async e=>{await this.components.registrar.unhandle(e)})))}async register(e,t){return this.components.registrar.register(e,t)}unregister(e){this.components.registrar.unregister(e)}}function y4(e){const{detail:t}=e;t.id.toString()!==this.peerId.toString()?this.components.peerStore.merge(t.id,{multiaddrs:t.multiaddrs,protocols:t.protocols}).catch((e=>{(0,fx.Z)(this,f4).error(e)})):(0,fx.Z)(this,f4).error(new Error(s5.ERR_DISCOVERED_SELF))}async function m4(e){if(null==e.peerId){const n=e.datastore;if(null!=n)try{const t=new R0({datastore:n},(0,g0.Z)(R0.generateOptions(),e.keychain));e.peerId=await t.exportPeerId("self")}catch(t){if("ERR_NOT_FOUND"!==t.code)throw t}}return null==e.peerId&&(e.peerId=await TA()),new g4(function(e){var t,n;const r=(0,g0.Z)(a5,e);if(null==r.transports||r.transports.length<1)throw new aq(o5.ERR_TRANSPORTS_REQUIRED,s5.ERR_TRANSPORTS_REQUIRED);if(null===r.connectionProtector&&null!=(null===(t=globalThis.process)||void 0===t||null===(n=t.env)||void 0===n?void 0:n.LIBP2P_FORCE_PNET))throw new aq(o5.ERR_PROTECTOR_REQUIRED,s5.ERR_PROTECTOR_REQUIRED);return r}(e))}var v4=new WeakMap;class b4 extends EventTarget{constructor(){super(...arguments),(0,dx.Z)(this,v4,{writable:!0,value:new Map})}listenerCount(e){const t=(0,fx.Z)(this,v4).get(e);return null==t?0:t.length}addEventListener(e,t,n){var r;super.addEventListener(e,t,n);let i=(0,fx.Z)(this,v4).get(e);null==i&&(i=[],(0,fx.Z)(this,v4).set(e,i)),i.push({callback:t,once:null!==(r=!0!==n&&!1!==n&&(null===n||void 0===n?void 0:n.once))&&void 0!==r&&r})}removeEventListener(e,t,n){super.removeEventListener(e.toString(),null!==t&&void 0!==t?t:null,n);let r=(0,fx.Z)(this,v4).get(e);null!=r&&(r=r.filter((e=>{let{callback:n}=e;return n!==t})),(0,fx.Z)(this,v4).set(e,r))}dispatchEvent(e){const t=super.dispatchEvent(e);let n=(0,fx.Z)(this,v4).get(e.type);return null==n||(n=n.filter((e=>{let{once:t}=e;return!t})),(0,fx.Z)(this,v4).set(e.type,n)),t}safeDispatchEvent(e,t){return this.dispatchEvent(new E4(e,t))}}class w4 extends Event{constructor(e,t){super(e,t),(0,Yo.Z)(this,"detail",void 0),this.detail=null===t||void 0===t?void 0:t.detail}}const E4=null!==(h4=globalThis.CustomEvent)&&void 0!==h4?h4:w4,A4="StrictSign",S4="StrictNoSign";var _4;!function(e){e.Accept="accept",e.Ignore="ignore",e.Reject="reject"}(_4||(_4={}));var I4=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==n[s])throw new TypeError(o+" is ambiguous");n[s]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var r=0,i=0;e[t]===c;)r++,t++;for(var o=(e.length-t)*l+1>>>0,s=new Uint8Array(o);e[t];){var u=n[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=o-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*s[d]>>>0,s[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=o-i;f!==o&&0===s[f];)f++;for(var p=new Uint8Array(r+(o-f)),g=r;f!==o;)p[g++]=s[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,o=t.length;i!==o&&0===t[i];)i++,n++;for(var s=(o-i)*u+1>>>0,l=new Uint8Array(s);i!==o;){for(var h=t[i],d=0,f=s-1;(0!==h||d<r)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");r=d,i++}for(var p=s-r;p!==s&&0===l[p];)p++;for(var g=c.repeat(n);p<s;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:h,decode:function(e){var n=h(e);if(n)return n;throw new Error("Non-".concat(t," character"))}}};const C4=I4,T4=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class k4{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(e));throw Error("Unknown type, must be binary type")}}class R4{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(e),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return P4(this,e)}}class x4{constructor(e){this.decoders=e}or(e){return P4(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(e),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}}const P4=(e,t)=>new x4({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class D4{constructor(e,t,n,r){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=r,this.encoder=new k4(e,t,n),this.decoder=new R4(e,t,r)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const O4=e=>{let{name:t,prefix:n,encode:r,decode:i}=e;return new D4(t,n,r,i)},N4=e=>{let{prefix:t,name:n,alphabet:r}=e;const{encode:i,decode:o}=C4(r,n);return O4({prefix:t,name:n,encode:i,decode:e=>T4(o(e))})},B4=e=>{let{name:t,prefix:n,bitsPerChar:r,alphabet:i}=e;return O4({prefix:n,name:t,encode:e=>((e,t,n)=>{const r="="===t[t.length-1],i=(1<<n)-1;let o="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>n;)s-=n,o+=t[i&a>>s];if(s&&(o+=t[i&a<<n-s]),r)for(;o.length*n&7;)o+="=";return o})(e,i,r),decode:e=>((e,t,n,r)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*n/8|0);let a=0,c=0,l=0;for(let u=0;u<o;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError("Non-".concat(r," character"));c=c<<n|t,a+=n,a>=8&&(a-=8,s[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s})(e,i,r,t)})},L4=B4({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),M4=B4({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),U4=B4({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),F4=B4({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),K4=B4({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),j4=B4({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Z4=B4({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),z4=B4({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),V4=B4({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),H4=N4({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),q4=N4({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),G4=B4({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),W4=B4({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Q4=B4({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Y4=B4({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function J4(e){let t=function(e){const t=()=>{};return t.enabled=!1,t.color="",t.diff=0,t.log=()=>{},t.namespace=e,t.destroy=()=>!0,t.extend=()=>t,t}("".concat(e,":trace"));return sf().enabled("".concat(e,":trace"))&&null!=sf().names.map((e=>e.toString())).find((e=>e.includes(":trace")))&&(t=sf()("".concat(e,":trace"))),Object.assign(sf()(e),{error:sf()("".concat(e,":error")),trace:t})}sf().formatters.b=e=>null==e?"undefined":H4.baseEncode(e),sf().formatters.t=e=>null==e?"undefined":L4.baseEncode(e),sf().formatters.m=e=>null==e?"undefined":G4.baseEncode(e),sf().formatters.p=e=>null==e?"undefined":e.toString(),sf().formatters.c=e=>null==e?"undefined":e.toString(),sf().formatters.k=e=>null==e?"undefined":e.toString(),sf().formatters.a=e=>null==e?"undefined":e.toString();class X4 extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"The operation was aborted"),(0,Yo.Z)(this,"code",void 0),(0,Yo.Z)(this,"type",void 0),this.code=X4.code,this.type=X4.type}}(0,Yo.Z)(X4,"code","ABORT_ERR"),(0,Yo.Z)(X4,"type","aborted");class $4 extends Error{constructor(e,t,n){var r;super(e),(0,Yo.Z)(this,"code",void 0),(0,Yo.Z)(this,"props",void 0),this.code=t,this.name=null!==(r=null===n||void 0===n?void 0:n.name)&&void 0!==r?r:"CodeError",this.props=null!==n&&void 0!==n?n:{}}}class e6 extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected Peer"),(0,Yo.Z)(this,"code",void 0),this.code=e6.code}}(0,Yo.Z)(e6,"code","ERR_UNEXPECTED_PEER");class t6 extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid crypto exchange"),(0,Yo.Z)(this,"code",void 0),this.code=t6.code}}(0,Yo.Z)(t6,"code","ERR_INVALID_CRYPTO_EXCHANGE");class n6 extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid crypto transmission"),(0,Yo.Z)(this,"code",void 0),this.code=n6.code}}(0,Yo.Z)(n6,"code","ERR_INVALID_CRYPTO_TRANSMISSION");const r6=Symbol.for("@libp2p/peer-id");const i6=N4({prefix:"9",name:"base10",alphabet:"0123456789"}),o6=B4({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),s6=B4({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),a6=B4({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),c6=Array.from("\ud83d\ude80\ud83e\ude90\u2604\ud83d\udef0\ud83c\udf0c\ud83c\udf11\ud83c\udf12\ud83c\udf13\ud83c\udf14\ud83c\udf15\ud83c\udf16\ud83c\udf17\ud83c\udf18\ud83c\udf0d\ud83c\udf0f\ud83c\udf0e\ud83d\udc09\u2600\ud83d\udcbb\ud83d\udda5\ud83d\udcbe\ud83d\udcbf\ud83d\ude02\u2764\ud83d\ude0d\ud83e\udd23\ud83d\ude0a\ud83d\ude4f\ud83d\udc95\ud83d\ude2d\ud83d\ude18\ud83d\udc4d\ud83d\ude05\ud83d\udc4f\ud83d\ude01\ud83d\udd25\ud83e\udd70\ud83d\udc94\ud83d\udc96\ud83d\udc99\ud83d\ude22\ud83e\udd14\ud83d\ude06\ud83d\ude44\ud83d\udcaa\ud83d\ude09\u263a\ud83d\udc4c\ud83e\udd17\ud83d\udc9c\ud83d\ude14\ud83d\ude0e\ud83d\ude07\ud83c\udf39\ud83e\udd26\ud83c\udf89\ud83d\udc9e\u270c\u2728\ud83e\udd37\ud83d\ude31\ud83d\ude0c\ud83c\udf38\ud83d\ude4c\ud83d\ude0b\ud83d\udc97\ud83d\udc9a\ud83d\ude0f\ud83d\udc9b\ud83d\ude42\ud83d\udc93\ud83e\udd29\ud83d\ude04\ud83d\ude00\ud83d\udda4\ud83d\ude03\ud83d\udcaf\ud83d\ude48\ud83d\udc47\ud83c\udfb6\ud83d\ude12\ud83e\udd2d\u2763\ud83d\ude1c\ud83d\udc8b\ud83d\udc40\ud83d\ude2a\ud83d\ude11\ud83d\udca5\ud83d\ude4b\ud83d\ude1e\ud83d\ude29\ud83d\ude21\ud83e\udd2a\ud83d\udc4a\ud83e\udd73\ud83d\ude25\ud83e\udd24\ud83d\udc49\ud83d\udc83\ud83d\ude33\u270b\ud83d\ude1a\ud83d\ude1d\ud83d\ude34\ud83c\udf1f\ud83d\ude2c\ud83d\ude43\ud83c\udf40\ud83c\udf37\ud83d\ude3b\ud83d\ude13\u2b50\u2705\ud83e\udd7a\ud83c\udf08\ud83d\ude08\ud83e\udd18\ud83d\udca6\u2714\ud83d\ude23\ud83c\udfc3\ud83d\udc90\u2639\ud83c\udf8a\ud83d\udc98\ud83d\ude20\u261d\ud83d\ude15\ud83c\udf3a\ud83c\udf82\ud83c\udf3b\ud83d\ude10\ud83d\udd95\ud83d\udc9d\ud83d\ude4a\ud83d\ude39\ud83d\udde3\ud83d\udcab\ud83d\udc80\ud83d\udc51\ud83c\udfb5\ud83e\udd1e\ud83d\ude1b\ud83d\udd34\ud83d\ude24\ud83c\udf3c\ud83d\ude2b\u26bd\ud83e\udd19\u2615\ud83c\udfc6\ud83e\udd2b\ud83d\udc48\ud83d\ude2e\ud83d\ude46\ud83c\udf7b\ud83c\udf43\ud83d\udc36\ud83d\udc81\ud83d\ude32\ud83c\udf3f\ud83e\udde1\ud83c\udf81\u26a1\ud83c\udf1e\ud83c\udf88\u274c\u270a\ud83d\udc4b\ud83d\ude30\ud83e\udd28\ud83d\ude36\ud83e\udd1d\ud83d\udeb6\ud83d\udcb0\ud83c\udf53\ud83d\udca2\ud83e\udd1f\ud83d\ude41\ud83d\udea8\ud83d\udca8\ud83e\udd2c\u2708\ud83c\udf80\ud83c\udf7a\ud83e\udd13\ud83d\ude19\ud83d\udc9f\ud83c\udf31\ud83d\ude16\ud83d\udc76\ud83e\udd74\u25b6\u27a1\u2753\ud83d\udc8e\ud83d\udcb8\u2b07\ud83d\ude28\ud83c\udf1a\ud83e\udd8b\ud83d\ude37\ud83d\udd7a\u26a0\ud83d\ude45\ud83d\ude1f\ud83d\ude35\ud83d\udc4e\ud83e\udd32\ud83e\udd20\ud83e\udd27\ud83d\udccc\ud83d\udd35\ud83d\udc85\ud83e\uddd0\ud83d\udc3e\ud83c\udf52\ud83d\ude17\ud83e\udd11\ud83c\udf0a\ud83e\udd2f\ud83d\udc37\u260e\ud83d\udca7\ud83d\ude2f\ud83d\udc86\ud83d\udc46\ud83c\udfa4\ud83d\ude47\ud83c\udf51\u2744\ud83c\udf34\ud83d\udca3\ud83d\udc38\ud83d\udc8c\ud83d\udccd\ud83e\udd40\ud83e\udd22\ud83d\udc45\ud83d\udca1\ud83d\udca9\ud83d\udc50\ud83d\udcf8\ud83d\udc7b\ud83e\udd10\ud83e\udd2e\ud83c\udfbc\ud83e\udd75\ud83d\udea9\ud83c\udf4e\ud83c\udf4a\ud83d\udc7c\ud83d\udc8d\ud83d\udce3\ud83e\udd42"),l6=c6.reduce(((e,t,n)=>(e[n]=t,e)),[]),u6=c6.reduce(((e,t,n)=>(e[t.codePointAt(0)]=n,e)),[]);const h6=O4({prefix:"\ud83d\ude80",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=l6[t]),"")},decode:function(e){const t=[];for(const n of e){const e=u6[n.codePointAt(0)];if(void 0===e)throw new Error("Non-base256emoji character: ".concat(n));t.push(e)}return new Uint8Array(t)}}),d6=N4({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),f6=N4({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),p6=B4({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),g6=O4({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),y6=new TextEncoder,m6=new TextDecoder,v6="json",b6=512,w6=e=>y6.encode(JSON.stringify(e)),E6=e=>JSON.parse(m6.decode(e)),A6="raw",S6=85,_6=e=>T4(e),I6=e=>T4(e);var C6=function e(t,n,r){n=n||[];var i=r=r||0;for(;t>=R6;)n[r++]=255&t|T6,t/=128;for(;t&k6;)n[r++]=255&t|T6,t>>>=7;return n[r]=0|t,e.bytes=r-i+1,n},T6=128,k6=-128,R6=Math.pow(2,31);var x6=function e(t,n){var r,i=0,o=0,s=n=n||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");r=t[s++],i+=o<28?(r&D6)<<o:(r&D6)*Math.pow(2,o),o+=7}while(r>=P6);return e.bytes=s-n,i},P6=128,D6=127;var O6=Math.pow(2,7),N6=Math.pow(2,14),B6=Math.pow(2,21),L6=Math.pow(2,28),M6=Math.pow(2,35),U6=Math.pow(2,42),F6=Math.pow(2,49),K6=Math.pow(2,56),j6=Math.pow(2,63);const Z6={encode:C6,decode:x6,encodingLength:function(e){return e<O6?1:e<N6?2:e<B6?3:e<L6?4:e<M6?5:e<U6?6:e<F6?7:e<K6?8:e<j6?9:10}},z6=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return[Z6.decode(e,t),Z6.decode.bytes]},V6=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Z6.encode(e,t,n),t},H6=e=>Z6.encodingLength(e),q6=(e,t)=>{const n=t.byteLength,r=H6(e),i=r+H6(n),o=new Uint8Array(i+n);return V6(e,o,0),V6(n,o,r),o.set(t,i),new W6(e,n,t,o)},G6=e=>{const t=T4(e),[n,r]=z6(t),[i,o]=z6(t.subarray(r)),s=t.subarray(r+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new W6(n,i,s,t)};class W6{constructor(e,t,n,r){this.code=e,this.size=t,this.digest=n,this.bytes=r}}const Q6=T4,Y6={code:0,name:"identity",encode:Q6,digest:e=>q6(0,Q6(e))},J6=e=>{let{name:t,code:n,encode:r}=e;return new X6(t,n,r)};class X6{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?q6(this.code,t):t.then((e=>q6(this.code,e)))}throw Error("Unknown type, must be binary type")}}const $6=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),e8=J6({name:"sha2-256",code:18,encode:$6("SHA-256")}),t8=J6({name:"sha2-512",code:19,encode:$6("SHA-512")}),n8=(e,t)=>{const{bytes:n,version:r}=e;return 0===r?a8(n,i8(e),t||H4.encoder):c8(n,i8(e),t||L4.encoder)},r8=new WeakMap,i8=e=>{const t=r8.get(e);if(null==t){const t=new Map;return r8.set(e,t),t}return t};class o8{constructor(e,t,n,r){this.code=t,this.version=e,this.multihash=n,this.bytes=r,this["/"]=r}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==l8)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==u8)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return o8.createV0(t)}default:throw Error("Can not convert CID version ".concat(this.version," to version 0. This is a bug please report"))}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=q6(e,t);return o8.createV1(this.code,n)}case 1:return this;default:throw Error("Can not convert CID version ".concat(this.version," to version 1. This is a bug please report"))}}equals(e){return o8.equals(this,e)}static equals(e,t){const n=t;return n&&e.code===n.code&&e.version===n.version&&((e,t)=>{if(e===t)return!0;{const n=t;return e.code===n.code&&e.size===n.size&&n.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0})(e.bytes,n.bytes)}})(e.multihash,n.multihash)}toString(e){return n8(this,e)}toJSON(){return{"/":n8(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID(".concat(this.toString(),")")}static asCID(e){if(null==e)return null;const t=e;if(t instanceof o8)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:n,multihash:r,bytes:i}=t;return new o8(e,n,r,i||h8(e,n,r.bytes))}if(!0===t[d8]){const{version:e,multihash:n,code:r}=t,i=G6(n);return o8.create(e,r,i)}return null}static create(e,t,n){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==l8)throw new Error("Version 0 CID must use dag-pb (code: ".concat(l8,") block encoding"));return new o8(e,t,n,n.bytes);case 1:{const r=h8(e,t,n.bytes);return new o8(e,t,n,r)}default:throw new Error("Invalid version")}}static createV0(e){return o8.create(0,l8,e)}static createV1(e,t){return o8.create(1,e,t)}static decode(e){const[t,n]=o8.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=o8.inspectBytes(e),n=t.size-t.multihashSize,r=T4(e.subarray(n,n+t.multihashSize));if(r.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=r.subarray(t.multihashSize-t.digestSize),o=new W6(t.multihashCode,t.digestSize,i,r);return[0===t.version?o8.createV0(o):o8.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[n,r]=z6(e.subarray(t));return t+=r,n};let r=n(),i=l8;if(18===r?(r=0,t=0):i=n(),0!==r&&1!==r)throw new RangeError("Invalid CID version ".concat(r));const o=t,s=n(),a=n(),c=t+a;return{version:r,codec:i,multihashCode:s,digestSize:a,multihashSize:c-o,size:c}}static parse(e,t){const[n,r]=s8(e,t),i=o8.decode(r);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return i8(i).set(n,e),i}}const s8=(e,t)=>{switch(e[0]){case"Q":{const n=t||H4;return[H4.prefix,n.decode("".concat(H4.prefix).concat(e))]}case H4.prefix:{const n=t||H4;return[H4.prefix,n.decode(e)]}case L4.prefix:{const n=t||L4;return[L4.prefix,n.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},a8=(e,t,n)=>{const{prefix:r}=n;if(r!==H4.prefix)throw Error("Cannot string encode V0 in ".concat(n.name," encoding"));const i=t.get(r);if(null==i){const i=n.encode(e).slice(1);return t.set(r,i),i}return i},c8=(e,t,n)=>{const{prefix:r}=n,i=t.get(r);if(null==i){const i=n.encode(e);return t.set(r,i),i}return i},l8=112,u8=18,h8=(e,t,n)=>{const r=H6(e),i=r+H6(t),o=new Uint8Array(i+n.byteLength);return V6(e,o,0),V6(t,o,r),o.set(n,i),o},d8=Symbol.for("@ipld/js-cid/CID"),f8={...Hn,...jn,...Vn,...Fn,...Kn,...Ln,...zn,...Mn,...Un,...Zn},p8=Symbol.for("nodejs.util.inspect.custom"),g8=Object.values(f8).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)),f8.identity.decoder),y8=114,m8=36,v8=37;class b8{constructor(e){(0,Yo.Z)(this,"type",void 0),(0,Yo.Z)(this,"multihash",void 0),(0,Yo.Z)(this,"privateKey",void 0),(0,Yo.Z)(this,"publicKey",void 0),(0,Yo.Z)(this,"string",void 0),(0,Yo.Z)(this,r6,!0),this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return"PeerId(".concat(this.toString(),")")}toString(){return null==this.string&&(this.string=H4.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return o8.createV1(y8,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){var t;if(e instanceof Uint8Array)return(0,Ms.f)(this.multihash.bytes,e);if("string"===typeof e)return S8(e).equals(this);if(null!=(null===e||void 0===e||null===(t=e.multihash)||void 0===t?void 0:t.bytes))return(0,Ms.f)(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[p8](){return"PeerId(".concat(this.toString(),")")}}class w8 extends b8{constructor(e){super({...e,type:"RSA"}),(0,Yo.Z)(this,"type","RSA"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.publicKey}}class E8 extends b8{constructor(e){super({...e,type:"Ed25519"}),(0,Yo.Z)(this,"type","Ed25519"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.multihash.digest}}class A8 extends b8{constructor(e){super({...e,type:"secp256k1"}),(0,Yo.Z)(this,"type","secp256k1"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.multihash.digest}}function S8(e,t){var n;if(t=null!==(n=t)&&void 0!==n?n:g8,"1"===e.charAt(0)||"Q"===e.charAt(0)){const t=G6(H4.decode("z".concat(e)));return e.startsWith("12D")?new E8({multihash:t}):e.startsWith("16U")?new A8({multihash:t}):new w8({multihash:t})}return _8(g8.decode(e))}function _8(e){try{const t=G6(e);if(t.code===Y6.code){if(t.digest.length===m8)return new E8({multihash:t});if(t.digest.length===v8)return new A8({multihash:t})}if(t.code===e8.code)return new w8({multihash:t})}catch{return function(e){if(null==e||null==e.multihash||null==e.version||1===e.version&&e.code!==y8)throw new Error("Supplied PeerID CID is invalid");const t=e.multihash;if(t.code===e8.code)return new w8({multihash:e.multihash});if(t.code===Y6.code){if(t.digest.length===m8)return new E8({multihash:e.multihash});if(t.digest.length===v8)return new A8({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}(o8.decode(e))}throw new Error("Supplied PeerID CID is invalid")}class I8{constructor(e){if((0,Yo.Z)(this,"buffer",void 0),(0,Yo.Z)(this,"mask",void 0),(0,Yo.Z)(this,"top",void 0),(0,Yo.Z)(this,"btm",void 0),(0,Yo.Z)(this,"next",void 0),!(e>0)||0!==(e-1&e))throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];if(void 0!==e)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return void 0===this.buffer[this.btm]}}class C8{constructor(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,Yo.Z)(this,"size",void 0),(0,Yo.Z)(this,"hwm",void 0),(0,Yo.Z)(this,"head",void 0),(0,Yo.Z)(this,"tail",void 0),this.hwm=null!==(e=t.splitLimit)&&void 0!==e?e:16,this.head=new I8(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return null!=(null===e||void 0===e?void 0:e.byteLength)?e.byteLength:1}push(e){if(null!=(null===e||void 0===e?void 0:e.value)&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){const t=this.head;this.head=t.next=new I8(2*this.head.buffer.length),this.head.push(e)}}shift(){var e;let t=this.tail.shift();if(void 0===t&&null!=this.tail.next){const e=this.tail.next;this.tail.next=null,this.tail=e,t=this.tail.shift()}return null!=(null===(e=t)||void 0===e?void 0:e.value)&&(this.size-=this.calculateSize(t.value)),t}isEmpty(){return this.head.isEmpty()}}class T8 extends Error{constructor(e,t){super(null!==e&&void 0!==e?e:"The operation was aborted"),(0,Yo.Z)(this,"type",void 0),(0,Yo.Z)(this,"code",void 0),this.type="aborted",this.code=null!==t&&void 0!==t?t:"ABORT_ERR"}}function k8(){return R8((e=>{const t=e.shift();if(null==t)return{done:!0};if(null!=t.error)throw t.error;return{done:!0===t.done,value:t.value}}),arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function R8(e,t){var n;let r,i,o,s=(t=null!==(n=t)&&void 0!==n?n:{}).onEnd,a=new C8,c=Ws();const l=e=>null!=i?i(e):(a.push(e),r),u=e=>{var n;if(o)return r;if(!0!==(null===(n=t)||void 0===n?void 0:n.objectMode)&&null==(null===e||void 0===e?void 0:e.byteLength))throw new Error("objectMode was not true but tried to push non-Uint8Array value");return l({done:!1,value:e})},h=e=>o?r:(o=!0,null!=e?(e=>(a=new C8,null!=i?i({error:e}):(a.push({error:e}),r)))(e):l({done:!0}));if(r={[Symbol.asyncIterator](){return this},next:async()=>{try{return a.isEmpty()?o?{done:!0}:await new Promise(((t,n)=>{i=o=>{i=null,a.push(o);try{t(e(a))}catch(s){n(s)}return r}})):e(a)}finally{a.isEmpty()&&queueMicrotask((()=>{c.resolve(),c=Ws()}))}},return:()=>(a=new C8,h(),{done:!0}),throw:e=>(h(e),{done:!0}),push:u,end:h,get readableLength(){return a.size},onEmpty:async e=>{const t=null===e||void 0===e?void 0:e.signal;if(null===t||void 0===t||t.throwIfAborted(),a.isEmpty())return;let n,r;null!=t&&(n=new Promise(((e,n)=>{r=()=>{n(new T8)},t.addEventListener("abort",r)})));try{await Promise.race([c.promise,n])}finally{null!=r&&null!=t&&(null===t||void 0===t||t.removeEventListener("abort",r))}}},null==s)return r;const d=r;return r={[Symbol.asyncIterator](){return this},next:()=>d.next(),throw:e=>(d.throw(e),null!=s&&(s(e),s=void 0),{done:!0}),return:()=>(d.return(),null!=s&&(s(),s=void 0),{done:!0}),push:u,end:e=>(d.end(e),null!=s&&(s(e),s=void 0),r),get readableLength(){return d.readableLength},onEmpty:e=>d.onEmpty(e)},r}const x8=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=[];for(const i of t)null==i[Symbol.asyncIterator]&&r.push(i);return r.length===t.length?function*(){for(const e of r)yield*e}():async function*(){const e=k8({objectMode:!0});Promise.resolve().then((async()=>{try{await Promise.all(t.map((async t=>{for await(const n of t)e.push(n)}))),e.end()}catch(n){e.end(n)}})),yield*e}()};function P8(e){if(null==e)throw new Error("Empty pipeline");if(B8(e)){const t=e;e=()=>t.source}else if(N8(e)||O8(e)){const t=e;e=()=>t}for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=[e,...n];if(i.length>1&&B8(i[i.length-1])&&(i[i.length-1]=i[i.length-1].sink),i.length>2)for(let o=1;o<i.length-1;o++)B8(i[o])&&(i[o]=L8(i[o]));return D8(...i)}const D8=function(){let e;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(;n.length>0;)e=n.shift()(e);return e},O8=e=>null!=(null===e||void 0===e?void 0:e[Symbol.asyncIterator]),N8=e=>null!=(null===e||void 0===e?void 0:e[Symbol.iterator]),B8=e=>null!=e&&(null!=e.sink&&null!=e.source),L8=e=>t=>{const n=e.sink(t);if(null!=(null===n||void 0===n?void 0:n.then)){const t=k8({objectMode:!0});let r;n.then((()=>{t.end()}),(e=>{t.end(e)}));const i=e.source;if(O8(i))r=async function*(){yield*i,t.end()};else{if(!N8(i))throw new Error("Unknown duplex source type - must be Iterable or AsyncIterable");r=function*(){yield*i,t.end()}}return x8(t,r())}return e.source},M8="/floodsub/1.0.0",U8="/meshsub/1.0.0",F8="/meshsub/1.1.0",K8=5e3;var j8=n(62001),Z8=n.n(j8);const z8={maxSubscriptions:1/0,maxMessages:1/0,maxIhaveMessageIDs:1/0,maxIwantMessageIDs:1/0,maxControlMessages:1/0,maxPeerInfos:1/0};function V8(e,t){t={...t};const n=Z8().Reader.create(e),r=e.length,i=void 0===r?n.len:n.pos+r,o={};for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:null!=o.subscriptions&&o.subscriptions.length>0||(o.subscriptions=[]),o.subscriptions.length<t.maxSubscriptions?o.subscriptions.push(H8(n,n.uint32())):n.skipType(7&e);break;case 2:null!=o.messages&&o.messages.length>0||(o.messages=[]),o.messages.length<t.maxMessages?o.messages.push(q8(n,n.uint32())):n.skipType(7&e);break;case 3:o.control=G8(n,n.uint32(),t);break;default:n.skipType(7&e)}}return o}function H8(e,t){const n=void 0===t?e.len:e.pos+t,r={};for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:r.subscribe=e.bool();break;case 2:r.topic=e.string();break;default:e.skipType(7&t)}}return r}function q8(e,t){const n=void 0===t?e.len:e.pos+t,r={};for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:r.from=e.bytes();break;case 2:r.data=e.bytes();break;case 3:r.seqno=e.bytes();break;case 4:r.topic=e.string();break;case 5:r.signature=e.bytes();break;case 6:r.key=e.bytes();break;default:e.skipType(7&t)}}if(!r.topic)throw Error("missing required 'topic'");return r}function G8(e,t,n){const r=void 0===t?e.len:e.pos+t,i={};for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:null!=i.ihave&&i.ihave.length>0||(i.ihave=[]),i.ihave.length<n.maxControlMessages?i.ihave.push(W8(e,e.uint32(),n)):e.skipType(7&t);break;case 2:null!=i.iwant&&i.iwant.length>0||(i.iwant=[]),i.iwant.length<n.maxControlMessages?i.iwant.push(Q8(e,e.uint32(),n)):e.skipType(7&t);break;case 3:null!=i.graft&&i.graft.length>0||(i.graft=[]),i.graft.length<n.maxControlMessages?i.graft.push(Y8(e,e.uint32())):e.skipType(7&t);break;case 4:null!=i.prune&&i.prune.length>0||(i.prune=[]),i.prune.length<n.maxControlMessages?i.prune.push(J8(e,e.uint32(),n)):e.skipType(7&t);break;default:e.skipType(7&t)}}return i}function W8(e,t,n){const r=void 0===t?e.len:e.pos+t,i={};for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:i.topicID=e.string();break;case 2:null!=i.messageIDs&&i.messageIDs.length>0||(i.messageIDs=[]),n.maxIhaveMessageIDs-- >0?i.messageIDs.push(e.bytes()):e.skipType(7&t);break;default:e.skipType(7&t)}}return i}function Q8(e,t,n){const r=void 0===t?e.len:e.pos+t,i={};for(;e.pos<r;){const t=e.uint32();if(t>>>3===1)null!=i.messageIDs&&i.messageIDs.length>0||(i.messageIDs=[]),n.maxIwantMessageIDs-- >0?i.messageIDs.push(e.bytes()):e.skipType(7&t);else e.skipType(7&t)}return i}function Y8(e,t){const n=void 0===t?e.len:e.pos+t,r={};for(;e.pos<n;){const t=e.uint32();if(t>>>3===1)r.topicID=e.string();else e.skipType(7&t)}return r}function J8(e,t,n){const r=void 0===t?e.len:e.pos+t,i={};for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:i.topicID=e.string();break;case 2:null!=i.peers&&i.peers.length>0||(i.peers=[]),n.maxPeerInfos-- >0?i.peers.push(X8(e,e.uint32())):e.skipType(7&t);break;case 3:i.backoff=e.uint64();break;default:e.skipType(7&t)}}return i}function X8(e,t){const n=void 0===t?e.len:e.pos+t,r={};for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:r.peerID=e.bytes();break;case 2:r.signedPeerRecord=e.bytes();break;default:e.skipType(7&t)}}return r}const $8=n.p+"static/media/rpc.3ba5ca7bdb004060d5e2.cjs",{RPC:e7}=$8;class t7{constructor(e,t,n){(0,Yo.Z)(this,"gossip",void 0),(0,Yo.Z)(this,"msgs",new Map),(0,Yo.Z)(this,"msgIdToStrFn",void 0),(0,Yo.Z)(this,"history",[]),(0,Yo.Z)(this,"notValidatedCount",0),this.gossip=e,this.msgIdToStrFn=n;for(let r=0;r<t;r++)this.history[r]=[]}get size(){return this.msgs.size}put(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{msgIdStr:r}=e;return!this.msgs.has(r)&&(this.msgs.set(r,{message:t,validated:n,originatingPeers:new Set,iwantCounts:new Map}),this.history[0].push({...e,topic:t.topic}),n||this.notValidatedCount++,!0)}observeDuplicate(e,t){const n=this.msgs.get(e);null==n||n.validated||n.originatingPeers.add(t)}get(e){var t;return null===(t=this.msgs.get(this.msgIdToStrFn(e)))||void 0===t?void 0:t.message}getWithIWantCount(e,t){var n;const r=this.msgs.get(e);if(null==r)return null;const i=(null!==(n=r.iwantCounts.get(t))&&void 0!==n?n:0)+1;return r.iwantCounts.set(t,i),{msg:r.message,count:i}}getGossipIDs(e){const t=new Map;for(let n=0;n<this.gossip;n++)this.history[n].forEach((n=>{var r;const i=this.msgs.get(n.msgIdStr);if(null!==(r=null===i||void 0===i?void 0:i.validated)&&void 0!==r&&r&&e.has(n.topic)){let e=t.get(n.topic);null==e&&(e=[],t.set(n.topic,e)),e.push(n.msgId)}}));return t}validate(e){const t=this.msgs.get(e);if(null==t)return null;t.validated||this.notValidatedCount--;const{message:n,originatingPeers:r}=t;return t.validated=!0,t.originatingPeers=new Set,{message:n,originatingPeers:r}}shift(){this.history[this.history.length-1].forEach((e=>{const t=this.msgs.get(e.msgIdStr);null!=t&&(this.msgs.delete(e.msgIdStr),t.validated||this.notValidatedCount--)})),this.history.pop(),this.history.unshift([])}remove(e){const t=this.msgs.get(e);return null==t?null:(this.msgs.delete(e),t)}}var n7,r7,i7,o7,s7,a7,c7,l7,u7,h7,d7;function f7(e){switch(e){case _4.Ignore:return i7.Ignore;case _4.Reject:return i7.Reject;default:throw new Error("Unreachable")}}!function(e){e.StrictSign="StrictSign",e.StrictNoSign="StrictNoSign"}(n7||(n7={})),function(e){e[e.Signing=0]="Signing",e[e.Anonymous=1]="Anonymous"}(r7||(r7={})),function(e){e.Error="error",e.Ignore="ignore",e.Reject="reject",e.Blacklisted="blacklisted"}(i7||(i7={})),function(e){e.InvalidSignature="invalid_signature",e.InvalidSeqno="invalid_seqno",e.InvalidPeerId="invalid_peerid",e.SignaturePresent="signature_present",e.SeqnoPresent="seqno_present",e.FromPresent="from_present",e.TransformFailed="transform_failed"}(o7||(o7={})),function(e){e.duplicate="duplicate",e.invalid="invalid",e.valid="valid"}(s7||(s7={})),function(e){e.forward="forward",e.publish="publish"}(a7||(a7={})),function(e){e.Fanout="fanout",e.Random="random",e.Subscribed="subscribed",e.Outbound="outbound",e.NotEnough="not_enough",e.Opportunistic="opportunistic"}(c7||(c7={})),function(e){e.Dc="disconnected",e.BadScore="bad_score",e.Prune="prune",e.Excess="excess"}(l7||(l7={})),function(e){e.GraftBackoff="graft_backoff",e.BrokenPromise="broken_promise",e.MessageDeficit="message_deficit",e.IPColocation="IP_colocation"}(u7||(u7={})),function(e){e.LowScore="low_score",e.MaxIhave="max_ihave",e.MaxIasked="max_iasked"}(h7||(h7={})),function(e){e.graylist="graylist",e.publish="publish",e.gossip="gossip",e.mesh="mesh"}(d7||(d7={}));const p7="ERR_INVALID_PEER_SCORE_PARAMS",g7={topics:{},topicScoreCap:10,appSpecificScore:()=>0,appSpecificWeight:10,IPColocationFactorWeight:-5,IPColocationFactorThreshold:10,IPColocationFactorWhitelist:new Set,behaviourPenaltyWeight:-10,behaviourPenaltyThreshold:0,behaviourPenaltyDecay:.2,decayInterval:1e3,decayToZero:.1,retainScore:36e5},y7={topicWeight:.5,timeInMeshWeight:1,timeInMeshQuantum:1,timeInMeshCap:3600,firstMessageDeliveriesWeight:1,firstMessageDeliveriesDecay:.5,firstMessageDeliveriesCap:2e3,meshMessageDeliveriesWeight:-1,meshMessageDeliveriesDecay:.5,meshMessageDeliveriesCap:100,meshMessageDeliveriesThreshold:20,meshMessageDeliveriesWindow:10,meshMessageDeliveriesActivation:5e3,meshFailurePenaltyWeight:-1,meshFailurePenaltyDecay:.5,invalidMessageDeliveriesWeight:-1,invalidMessageDeliveriesDecay:.3};function m7(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{...g7,...e,topics:null!=e.topics?Object.entries(e.topics).reduce(((e,t)=>{let[n,r]=t;return e[n]=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{...y7,...e}}(r),e}),{}):{}}}function v7(e){if(e.topicWeight<0)throw new $4("invalid topic weight; must be >= 0",p7);if(0===e.timeInMeshQuantum)throw new $4("invalid TimeInMeshQuantum; must be non zero",p7);if(e.timeInMeshWeight<0)throw new $4("invalid TimeInMeshWeight; must be positive (or 0 to disable)",p7);if(0!==e.timeInMeshWeight&&e.timeInMeshQuantum<=0)throw new $4("invalid TimeInMeshQuantum; must be positive",p7);if(0!==e.timeInMeshWeight&&e.timeInMeshCap<=0)throw new $4("invalid TimeInMeshCap; must be positive",p7);if(e.firstMessageDeliveriesWeight<0)throw new $4("invallid FirstMessageDeliveriesWeight; must be positive (or 0 to disable)",p7);if(0!==e.firstMessageDeliveriesWeight&&(e.firstMessageDeliveriesDecay<=0||e.firstMessageDeliveriesDecay>=1))throw new $4("invalid FirstMessageDeliveriesDecay; must be between 0 and 1",p7);if(0!==e.firstMessageDeliveriesWeight&&e.firstMessageDeliveriesCap<=0)throw new $4("invalid FirstMessageDeliveriesCap; must be positive",p7);if(e.meshMessageDeliveriesWeight>0)throw new $4("invalid MeshMessageDeliveriesWeight; must be negative (or 0 to disable)",p7);if(0!==e.meshMessageDeliveriesWeight&&(e.meshMessageDeliveriesDecay<=0||e.meshMessageDeliveriesDecay>=1))throw new $4("invalid MeshMessageDeliveriesDecay; must be between 0 and 1",p7);if(0!==e.meshMessageDeliveriesWeight&&e.meshMessageDeliveriesCap<=0)throw new $4("invalid MeshMessageDeliveriesCap; must be positive",p7);if(0!==e.meshMessageDeliveriesWeight&&e.meshMessageDeliveriesThreshold<=0)throw new $4("invalid MeshMessageDeliveriesThreshold; must be positive",p7);if(e.meshMessageDeliveriesWindow<0)throw new $4("invalid MeshMessageDeliveriesWindow; must be non-negative",p7);if(0!==e.meshMessageDeliveriesWeight&&e.meshMessageDeliveriesActivation<1e3)throw new $4("invalid MeshMessageDeliveriesActivation; must be at least 1s",p7);if(e.meshFailurePenaltyWeight>0)throw new $4("invalid MeshFailurePenaltyWeight; must be negative (or 0 to disable)",p7);if(0!==e.meshFailurePenaltyWeight&&(e.meshFailurePenaltyDecay<=0||e.meshFailurePenaltyDecay>=1))throw new $4("invalid MeshFailurePenaltyDecay; must be between 0 and 1",p7);if(e.invalidMessageDeliveriesWeight>0)throw new $4("invalid InvalidMessageDeliveriesWeight; must be negative (or 0 to disable)",p7);if(e.invalidMessageDeliveriesDecay<=0||e.invalidMessageDeliveriesDecay>=1)throw new $4("invalid InvalidMessageDeliveriesDecay; must be between 0 and 1",p7)}const b7={gossipThreshold:-10,publishThreshold:-50,graylistThreshold:-80,acceptPXThreshold:10,opportunisticGraftThreshold:20};function w7(){return{...b7,...arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}}}function E7(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>!0;const r=new Set;if(t<=0)return r;for(const i of e){if(r.size>=t)break;n(i)&&(r.add(i),e.delete(i))}return r}class A7 extends Map{constructor(e){super(),(0,Yo.Z)(this,"getDefault",void 0),this.getDefault=e}getOrDefault(e){let t=super.get(e);return void 0===t&&(t=this.getDefault(),this.set(e,t)),t}}function S7(e,t,n,r){let i=0;Object.entries(t.topics).forEach((e=>{let[t,r]=e;const o=n.topics[t];if(void 0===o)return;let s=0;if(r.inMesh){let e=r.meshTime/o.timeInMeshQuantum;e>o.timeInMeshCap&&(e=o.timeInMeshCap),s+=e*o.timeInMeshWeight}let a=r.firstMessageDeliveries;if(a>o.firstMessageDeliveriesCap&&(a=o.firstMessageDeliveriesCap),s+=a*o.firstMessageDeliveriesWeight,r.meshMessageDeliveriesActive&&r.meshMessageDeliveries<o.meshMessageDeliveriesThreshold){const e=o.meshMessageDeliveriesThreshold-r.meshMessageDeliveries;s+=e*e*o.meshMessageDeliveriesWeight}s+=r.meshFailurePenalty*o.meshFailurePenaltyWeight;s+=r.invalidMessageDeliveries*r.invalidMessageDeliveries*o.invalidMessageDeliveriesWeight,i+=s*o.topicWeight})),n.topicScoreCap>0&&i>n.topicScoreCap&&(i=n.topicScoreCap);const o=n.appSpecificScore(e);if(i+=o*n.appSpecificWeight,t.knownIPs.forEach((e=>{if(n.IPColocationFactorWhitelist.has(e))return;const t=r.get(e),o=null!=t?t.size:0;if(o>n.IPColocationFactorThreshold){const e=o-n.IPColocationFactorThreshold;i+=e*e*n.IPColocationFactorWeight}})),t.behaviourPenalty>n.behaviourPenaltyThreshold){const e=t.behaviourPenalty-n.behaviourPenaltyThreshold;i+=e*e*n.behaviourPenaltyWeight}return i}var _7,I7=n(43663),C7=n.n(I7);!function(e){e[e.unknown=0]="unknown",e[e.valid=1]="valid",e[e.invalid=2]="invalid",e[e.ignored=3]="ignored"}(_7||(_7={}));class T7{constructor(){(0,Yo.Z)(this,"records",void 0),(0,Yo.Z)(this,"queue",void 0),this.records=new Map,this.queue=new(C7())}getRecord(e){return this.records.get(e)}ensureRecord(e){let t=this.records.get(e);if(null!=t)return t;t={status:_7.unknown,firstSeenTsMs:Date.now(),validated:0,peers:new Set},this.records.set(e,t);const n={msgId:e,expire:Date.now()+12e4};return this.queue.push(n),t}gc(){const e=Date.now();let t=this.queue.peekFront();for(;null!=t&&t.expire<e;)this.records.delete(t.msgId),this.queue.shift(),t=this.queue.peekFront()}clear(){this.records.clear(),this.queue.clear()}}const k7=J4("libp2p:gossipsub:score");class R7{constructor(e,t,n){var r;(0,Yo.Z)(this,"params",void 0),(0,Yo.Z)(this,"metrics",void 0),(0,Yo.Z)(this,"peerStats",new Map),(0,Yo.Z)(this,"peerIPs",new A7((()=>new Set))),(0,Yo.Z)(this,"scoreCache",new Map),(0,Yo.Z)(this,"deliveryRecords",new T7),(0,Yo.Z)(this,"_backgroundInterval",void 0),(0,Yo.Z)(this,"scoreCacheValidityMs",void 0),(0,Yo.Z)(this,"computeScore",void 0),this.params=e,this.metrics=t,function(e){for(const[n,r]of Object.entries(e.topics))try{v7(r)}catch(t){throw new $4("invalid score parameters for topic ".concat(n,": ").concat(t.message),p7)}if(e.topicScoreCap<0)throw new $4("invalid topic score cap; must be positive (or 0 for no cap)",p7);if(null===e.appSpecificScore||void 0===e.appSpecificScore)throw new $4("missing application specific score function",p7);if(e.IPColocationFactorWeight>0)throw new $4("invalid IPColocationFactorWeight; must be negative (or 0 to disable)",p7);if(0!==e.IPColocationFactorWeight&&e.IPColocationFactorThreshold<1)throw new $4("invalid IPColocationFactorThreshold; must be at least 1",p7);if(e.behaviourPenaltyWeight>0)throw new $4("invalid BehaviourPenaltyWeight; must be negative (or 0 to disable)",p7);if(0!==e.behaviourPenaltyWeight&&(e.behaviourPenaltyDecay<=0||e.behaviourPenaltyDecay>=1))throw new $4("invalid BehaviourPenaltyDecay; must be between 0 and 1",p7);if(e.decayInterval<1e3)throw new $4("invalid DecayInterval; must be at least 1s",p7);if(e.decayToZero<=0||e.decayToZero>=1)throw new $4("invalid DecayToZero; must be between 0 and 1",p7)}(e),this.scoreCacheValidityMs=n.scoreCacheValidityMs,this.computeScore=null!==(r=n.computeScore)&&void 0!==r?r:S7}get size(){return this.peerStats.size}start(){null==this._backgroundInterval?(this._backgroundInterval=setInterval((()=>{this.background()}),this.params.decayInterval),k7("started")):k7("Peer score already running")}stop(){null!=this._backgroundInterval?(clearInterval(this._backgroundInterval),delete this._backgroundInterval,this.peerIPs.clear(),this.peerStats.clear(),this.deliveryRecords.clear(),k7("stopped")):k7("Peer score already stopped")}background(){this.refreshScores(),this.deliveryRecords.gc()}dumpPeerScoreStats(){return Object.fromEntries(Array.from(this.peerStats.entries()).map((e=>{let[t,n]=e;return[t,n]})))}messageFirstSeenTimestampMs(e){const t=this.deliveryRecords.getRecord(e);return null!=t?t.firstSeenTsMs:null}refreshScores(){const e=Date.now(),t=this.params.decayToZero;this.peerStats.forEach(((n,r)=>{n.connected?(Object.entries(n.topics).forEach((n=>{let[r,i]=n;const o=this.params.topics[r];void 0!==o&&(i.firstMessageDeliveries*=o.firstMessageDeliveriesDecay,i.firstMessageDeliveries<t&&(i.firstMessageDeliveries=0),i.meshMessageDeliveries*=o.meshMessageDeliveriesDecay,i.meshMessageDeliveries<t&&(i.meshMessageDeliveries=0),i.meshFailurePenalty*=o.meshFailurePenaltyDecay,i.meshFailurePenalty<t&&(i.meshFailurePenalty=0),i.invalidMessageDeliveries*=o.invalidMessageDeliveriesDecay,i.invalidMessageDeliveries<t&&(i.invalidMessageDeliveries=0),i.inMesh&&(i.meshTime=e-i.graftTime,i.meshTime>o.meshMessageDeliveriesActivation&&(i.meshMessageDeliveriesActive=!0)))})),n.behaviourPenalty*=this.params.behaviourPenaltyDecay,n.behaviourPenalty<t&&(n.behaviourPenalty=0)):e>n.expire&&(this.removeIPsForPeer(r,n.knownIPs),this.peerStats.delete(r),this.scoreCache.delete(r))}))}score(e){var t,n;null===(t=this.metrics)||void 0===t||t.scoreFnCalls.inc();const r=this.peerStats.get(e);if(null==r)return 0;const i=Date.now(),o=this.scoreCache.get(e);if(null!=o&&o.cacheUntil>i)return o.score;null===(n=this.metrics)||void 0===n||n.scoreFnRuns.inc();const s=this.computeScore(e,r,this.params,this.peerIPs),a=i+this.scoreCacheValidityMs;var c;null!=o?(null===(c=this.metrics)||void 0===c||c.scoreCachedDelta.observe(Math.abs(s-o.score)),o.score=s,o.cacheUntil=a):this.scoreCache.set(e,{score:s,cacheUntil:a});return s}addPenalty(e,t,n){const r=this.peerStats.get(e);var i;null!=r&&(r.behaviourPenalty+=t,null===(i=this.metrics)||void 0===i||i.onScorePenalty(n))}addPeer(e){const t={connected:!0,expire:0,topics:{},knownIPs:new Set,behaviourPenalty:0};this.peerStats.set(e,t)}addIP(e,t){const n=this.peerStats.get(e);null!=n&&n.knownIPs.add(t),this.peerIPs.getOrDefault(t).add(e)}removeIP(e,t){const n=this.peerStats.get(e);null!=n&&n.knownIPs.delete(t);const r=this.peerIPs.get(t);null!=r&&(r.delete(e),0===r.size&&this.peerIPs.delete(t))}removePeer(e){const t=this.peerStats.get(e);if(null!=t){if(this.score(e)>0)return this.removeIPsForPeer(e,t.knownIPs),void this.peerStats.delete(e);Object.entries(t.topics).forEach((e=>{let[t,n]=e;n.firstMessageDeliveries=0;const r=this.params.topics[t].meshMessageDeliveriesThreshold;if(n.inMesh&&n.meshMessageDeliveriesActive&&n.meshMessageDeliveries<r){const e=r-n.meshMessageDeliveries;n.meshFailurePenalty+=e*e}n.inMesh=!1,n.meshMessageDeliveriesActive=!1})),t.connected=!1,t.expire=Date.now()+this.params.retainScore}}graft(e,t){const n=this.peerStats.get(e);if(null!=n){const e=this.getPtopicStats(n,t);null!=e&&(e.inMesh=!0,e.graftTime=Date.now(),e.meshTime=0,e.meshMessageDeliveriesActive=!1)}}prune(e,t){const n=this.peerStats.get(e);if(null!=n){const e=this.getPtopicStats(n,t);if(null!=e){const n=this.params.topics[t].meshMessageDeliveriesThreshold;if(e.meshMessageDeliveriesActive&&e.meshMessageDeliveries<n){const t=n-e.meshMessageDeliveries;e.meshFailurePenalty+=t*t}e.meshMessageDeliveriesActive=!1,e.inMesh=!1}}}validateMessage(e){this.deliveryRecords.ensureRecord(e)}deliverMessage(e,t,n){this.markFirstMessageDelivery(e,n);const r=this.deliveryRecords.ensureRecord(t),i=Date.now();r.status===_7.unknown?(r.status=_7.valid,r.validated=i,r.peers.forEach((t=>{t!==e.toString()&&this.markDuplicateMessageDelivery(t,n)}))):k7("unexpected delivery: message from %s was first seen %s ago and has delivery status %s",e,i-r.firstSeenTsMs,_7[r.status])}rejectInvalidMessage(e,t){this.markInvalidMessageDelivery(e,t)}rejectMessage(e,t,n,r){switch(r){case i7.Error:return void this.markInvalidMessageDelivery(e,n);case i7.Blacklisted:return}const i=this.deliveryRecords.ensureRecord(t);if(i.status===_7.unknown){if(r===i7.Ignore)return i.status=_7.ignored,void i.peers.clear();i.status=_7.invalid,this.markInvalidMessageDelivery(e,n),i.peers.forEach((e=>{this.markInvalidMessageDelivery(e,n)})),i.peers.clear()}else k7("unexpected rejection: message from %s was first seen %s ago and has delivery status %d",e,Date.now()-i.firstSeenTsMs,_7[i.status])}duplicateMessage(e,t,n){const r=this.deliveryRecords.ensureRecord(t);if(!r.peers.has(e))switch(r.status){case _7.unknown:r.peers.add(e);break;case _7.valid:r.peers.add(e),this.markDuplicateMessageDelivery(e,n,r.validated);break;case _7.invalid:this.markInvalidMessageDelivery(e,n);case _7.ignored:}}markInvalidMessageDelivery(e,t){const n=this.peerStats.get(e);if(null!=n){const e=this.getPtopicStats(n,t);null!=e&&(e.invalidMessageDeliveries+=1)}}markFirstMessageDelivery(e,t){const n=this.peerStats.get(e);if(null!=n){const e=this.getPtopicStats(n,t);if(null!=e){let n=this.params.topics[t].firstMessageDeliveriesCap;e.firstMessageDeliveries=Math.min(n,e.firstMessageDeliveries+1),e.inMesh&&(n=this.params.topics[t].meshMessageDeliveriesCap,e.meshMessageDeliveries=Math.min(n,e.meshMessageDeliveries+1))}}}markDuplicateMessageDelivery(e,t,n){const r=this.peerStats.get(e);if(null!=r){const e=void 0!==n?Date.now():0,o=this.getPtopicStats(r,t);if(null!=o&&o.inMesh){const r=this.params.topics[t];if(void 0!==n){var i;const o=e-n,s=o>r.meshMessageDeliveriesWindow;if(null===(i=this.metrics)||void 0===i||i.onDuplicateMsgDelivery(t,o,s),s)return}const s=r.meshMessageDeliveriesCap;o.meshMessageDeliveries=Math.min(s,o.meshMessageDeliveries+1)}}}removeIPsForPeer(e,t){for(const n of t){const t=this.peerIPs.get(n);null!=t&&(t.delete(e),0===t.size&&this.peerIPs.delete(n))}}getPtopicStats(e,t){let n=e.topics[t];return void 0!==n?n:void 0!==this.params.topics[t]?(n={inMesh:!1,graftTime:0,meshTime:0,firstMessageDeliveries:0,meshMessageDeliveries:0,meshMessageDeliveriesActive:!1,meshFailurePenalty:0,invalidMessageDeliveries:0},e.topics[t]=n,n):null}}function x7(e,t,n,r,i){let o=0;const s=new Map;if(Object.entries(t.topics).forEach((e=>{var t;let[r,a]=e;const c=null!==(t=i.get(r))&&void 0!==t?t:"unknown",l=n.topics[r];if(void 0===l)return;let u=s.get(c);null==u&&(u={p1w:0,p2w:0,p3w:0,p3bw:0,p4w:0},s.set(c,u));let h=0,d=0,f=0,p=0,g=0;if(a.inMesh){h+=Math.max(a.meshTime/l.timeInMeshQuantum,l.timeInMeshCap)*l.timeInMeshWeight}let y=a.firstMessageDeliveries;if(y>l.firstMessageDeliveriesCap&&(y=l.firstMessageDeliveriesCap),d+=y*l.firstMessageDeliveriesWeight,a.meshMessageDeliveriesActive&&a.meshMessageDeliveries<l.meshMessageDeliveriesThreshold){const e=l.meshMessageDeliveriesThreshold-a.meshMessageDeliveries;f+=e*e*l.meshMessageDeliveriesWeight}p+=a.meshFailurePenalty*l.meshFailurePenaltyWeight;g+=a.invalidMessageDeliveries*a.invalidMessageDeliveries*l.invalidMessageDeliveriesWeight,o+=(h+d+f+p+g)*l.topicWeight,u.p1w+=h,u.p2w+=d,u.p3w+=f,u.p3bw+=p,u.p4w+=g})),n.topicScoreCap>0&&o>n.topicScoreCap){o=n.topicScoreCap;const e=n.topicScoreCap/o;for(const t of s.values())t.p1w*=e,t.p2w*=e,t.p3w*=e,t.p3bw*=e,t.p4w*=e}let a=0,c=0,l=0;a+=n.appSpecificScore(e)*n.appSpecificWeight,t.knownIPs.forEach((e=>{if(n.IPColocationFactorWhitelist.has(e))return;const t=r.get(e),i=null!=t?t.size:0;if(i>n.IPColocationFactorThreshold){const e=i-n.IPColocationFactorThreshold;c+=e*e*n.IPColocationFactorWeight}}));return l+=t.behaviourPenalty*t.behaviourPenalty*n.behaviourPenaltyWeight,o+=a+c+l,{byTopic:s,p5w:a,p6w:c,p7w:l,score:o}}function P7(e){return null!=e[Symbol.asyncIterator]}const D7=e=>{const t=Bs.P$(e),n=(0,Us.E)(t);return Bs.cv(e,n),D7.bytes=t,n};function O7(e,t){var n,r;const i=null!==(r=(t=null!==(n=t)&&void 0!==n?n:{}).lengthEncoder)&&void 0!==r?r:D7;function*o(e){const t=i(e.byteLength);t instanceof Uint8Array?yield t:yield*t,e instanceof Uint8Array?yield e:yield*e}return P7(e)?async function*(){for await(const t of e)yield*o(t)}():function*(){for(const t of e)yield*o(t)}()}D7.bytes=0,O7.single=(e,t)=>{var n,r;const i=null!==(r=(t=null!==(n=t)&&void 0!==n?n:{}).lengthEncoder)&&void 0!==r?r:D7;return new Zs(i(e.byteLength),e)};var N7;!function(e){e[e.LENGTH=0]="LENGTH",e[e.DATA=1]="DATA"}(N7||(N7={}));const B7=e=>{const t=Bs.Jx(e);return B7.bytes=Bs.P$(t),t};function L7(e,t){var n,r,i;const o=new Zs;let s=N7.LENGTH,a=-1;const c=null!==(n=null===t||void 0===t?void 0:t.lengthDecoder)&&void 0!==n?n:B7,l=null!==(r=null===t||void 0===t?void 0:t.maxLengthLength)&&void 0!==r?r:8,u=null!==(i=null===t||void 0===t?void 0:t.maxDataLength)&&void 0!==i?i:4194304;function*h(){for(;o.byteLength>0;){if(s===N7.LENGTH)try{if(a=c(o),a<0)throw Xo()(new Error("invalid message length"),"ERR_INVALID_MSG_LENGTH");if(a>u)throw Xo()(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");const e=c.bytes;o.consume(e),null!=(null===t||void 0===t?void 0:t.onLength)&&t.onLength(a),s=N7.DATA}catch(e){if(e instanceof RangeError){if(o.byteLength>l)throw Xo()(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG");break}throw e}if(s===N7.DATA){if(o.byteLength<a)break;const e=o.sublist(0,a);o.consume(a),null!=(null===t||void 0===t?void 0:t.onData)&&t.onData(e),yield e,s=N7.LENGTH}}}return P7(e)?async function*(){for await(const t of e)o.append(t),yield*h();if(o.byteLength>0)throw Xo()(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}():function*(){for(const t of e)o.append(t),yield*h();if(o.byteLength>0)throw Xo()(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}()}B7.bytes=0,L7.fromReader=(e,t)=>{let n=1;return L7(async function*(){for(;;)try{const{done:t,value:r}=await e.next(n);if(!0===t)return;null!=r&&(yield r)}catch(t){if("ERR_UNDER_READ"===t.code)return{done:!0,value:null};throw t}finally{n=1}}(),{...null!==t&&void 0!==t?t:{},onLength:e=>{n=e}})};class M7{constructor(e,t,n){var r;(0,Yo.Z)(this,"rawStream",void 0),(0,Yo.Z)(this,"pushable",void 0),(0,Yo.Z)(this,"closeController",void 0),(0,Yo.Z)(this,"maxBufferSize",void 0),this.rawStream=e,this.pushable=k8({objectMode:!1}),this.closeController=new AbortController,this.maxBufferSize=null!==(r=n.maxBufferSize)&&void 0!==r?r:1/0,P8(fF(this.pushable,this.closeController.signal,{returnOnAbort:!0}),(e=>O7(e)),this.rawStream).catch(t)}get protocol(){return this.rawStream.protocol}push(e){if(this.pushable.readableLength>this.maxBufferSize)throw Error("OutboundStream buffer full, size > ".concat(this.maxBufferSize));this.pushable.push(e)}async close(){this.closeController.abort(),await this.pushable.return(),await this.rawStream.close()}}class U7{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,Yo.Z)(this,"source",void 0),(0,Yo.Z)(this,"rawStream",void 0),(0,Yo.Z)(this,"closeController",void 0),this.rawStream=e,this.closeController=new AbortController,this.source=fF(P8(this.rawStream,(e=>L7(e,t))),this.closeController.signal,{returnOnAbort:!0})}async close(){this.closeController.abort(),await this.rawStream.close()}}class F7{constructor(e,t,n){(0,Yo.Z)(this,"gossipsubIWantFollowupMs",void 0),(0,Yo.Z)(this,"msgIdToStrFn",void 0),(0,Yo.Z)(this,"metrics",void 0),(0,Yo.Z)(this,"promises",new Map),(0,Yo.Z)(this,"requestMsByMsg",new Map),(0,Yo.Z)(this,"requestMsByMsgExpire",void 0),this.gossipsubIWantFollowupMs=e,this.msgIdToStrFn=t,this.metrics=n,this.requestMsByMsgExpire=10*e}get size(){return this.promises.size}get requestMsByMsgSize(){return this.requestMsByMsg.size}addPromise(e,t){const n=t[Math.floor(Math.random()*t.length)],r=this.msgIdToStrFn(n);let i=this.promises.get(r);null==i&&(i=new Map,this.promises.set(r,i));const o=Date.now();i.has(e)||(i.set(e,o+this.gossipsubIWantFollowupMs),null!=this.metrics&&(this.metrics.iwantPromiseStarted.inc(1),this.requestMsByMsg.has(r)||this.requestMsByMsg.set(r,o)))}getBrokenPromises(){var e;const t=Date.now(),n=new Map;let r=0;return this.promises.forEach(((e,i)=>{e.forEach(((i,o)=>{var s;i<t&&(n.set(o,(null!==(s=n.get(o))&&void 0!==s?s:0)+1),e.delete(o),r++)})),0===e.size&&this.promises.delete(i)})),null===(e=this.metrics)||void 0===e||e.iwantPromiseBroken.inc(r),n}deliverMessage(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.trackMessage(e);const n=this.promises.get(e);null!=n&&(this.promises.delete(e),null!=this.metrics&&(this.metrics.iwantPromiseResolved.inc(1),t&&this.metrics.iwantPromiseResolvedFromDuplicate.inc(1),this.metrics.iwantPromiseResolvedPeers.inc(n.size)))}rejectMessage(e,t){this.trackMessage(e),t!==i7.Error&&this.promises.delete(e)}clear(){this.promises.clear()}prune(){var e;const t=Date.now()-this.requestMsByMsgExpire;let n=0;for(const[r,i]of this.requestMsByMsg.entries()){if(!(i<t))break;this.requestMsByMsg.delete(r),n++}null===(e=this.metrics)||void 0===e||e.iwantMessagePruned.inc(n)}trackMessage(e){if(null!=this.metrics){const t=this.requestMsByMsg.get(e);void 0!==t&&(this.metrics.iwantPromiseDeliveryTime.observe((Date.now()-t)/1e3),this.requestMsByMsg.delete(e))}}}const K7={get(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:globalThis).crypto;if(null==e||null==e.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}};const j7=32,Z7=64,z7=32;function V7(e,t){const n=new Uint8Array(Z7);for(let r=0;r<z7;r++)n[r]=e[r],n[z7+r]=t[r];return n}const H7={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};async function q7(e,t){const n=function(e){var t,n,r,i,o,s;const a=null!==(t=null===e||void 0===e?void 0:e.algorithm)&&void 0!==t?t:"AES-GCM";let c=null!==(n=null===e||void 0===e?void 0:e.keyLength)&&void 0!==n?n:16;const l=null!==(r=null===e||void 0===e?void 0:e.nonceLength)&&void 0!==r?r:12,u=null!==(i=null===e||void 0===e?void 0:e.digest)&&void 0!==i?i:"SHA-256",h=null!==(o=null===e||void 0===e?void 0:e.saltLength)&&void 0!==o?o:16,d=null!==(s=null===e||void 0===e?void 0:e.iterations)&&void 0!==s?s:32767,f=K7.get();return c*=8,{encrypt:async function(e,t){const n=f.getRandomValues(new Uint8Array(h)),r=f.getRandomValues(new Uint8Array(l)),i={name:a,iv:r};let o;if("string"===typeof t&&(t=(0,yu.m)(t)),0===t.length){o=await f.subtle.importKey("jwk",H7,{name:"AES-GCM"},!0,["encrypt"]);try{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);o=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["encrypt"])}catch{o=await f.subtle.importKey("jwk",H7,{name:"AES-GCM"},!0,["encrypt"])}}else{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);o=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["encrypt"])}const s=await f.subtle.encrypt(i,o,e);return(0,Ls.z)([n,i.iv,new Uint8Array(s)])},decrypt:async function(e,t){const n=e.subarray(0,h),r=e.subarray(h,h+l),i=e.subarray(h+l),o={name:a,iv:r};let s;if("string"===typeof t&&(t=(0,yu.m)(t)),0===t.length)try{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);s=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["decrypt"])}catch{s=await f.subtle.importKey("jwk",H7,{name:"AES-GCM"},!0,["decrypt"])}else{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);s=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["decrypt"])}const p=await f.subtle.decrypt(o,s,i);return new Uint8Array(p)}}}(),r=await n.encrypt(e,t);return G4.encode(r)}var G7,W7,Q7,Y7;!function(e){e.RSA="RSA",e.Ed25519="Ed25519",e.Secp256k1="Secp256k1"}(G7||(G7={})),function(e){e[e.RSA=0]="RSA",e[e.Ed25519=1]="Ed25519",e[e.Secp256k1=2]="Secp256k1"}(W7||(W7={})),function(e){e.codec=()=>bs(W7)}(G7||(G7={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),G7.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.Type=G7.codec().decode(e);break;case 2:n.Data=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(Q7||(Q7={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),G7.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.Type=G7.codec().decode(e);break;case 2:n.Data=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(Y7||(Y7={}));class J7{constructor(e){(0,Yo.Z)(this,"_key",void 0),this._key=r9(e,j7)}async verify(e,t){return async function(e,t,n){return ql.verify(t,n,e)}(this._key,t,e)}marshal(){return this._key}get bytes(){return Q7.encode({Type:G7.Ed25519,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await e8.digest(this.bytes);return e}}class X7{constructor(e,t){(0,Yo.Z)(this,"_key",void 0),(0,Yo.Z)(this,"_publicKey",void 0),this._key=r9(e,Z7),this._publicKey=r9(t,j7)}async sign(e){return async function(e,t){const n=e.subarray(0,z7);return ql.sign(t,n)}(this._key,e)}get public(){return new J7(this._publicKey)}marshal(){return this._key}get bytes(){return Y7.encode({Type:G7.Ed25519,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await e8.digest(this.bytes);return e}async id(){const e=Y6.digest(this.public.bytes);return H4.encode(e.bytes).substring(1)}async export(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"libp2p-key";if("libp2p-key"===t)return q7(this.bytes,e);throw new $4("export format '".concat(t,"' is not supported"),"ERR_INVALID_EXPORT_FORMAT")}}function $7(e){if(e.length>Z7){const t=(e=r9(e,Z7+j7)).subarray(0,Z7),n=e.subarray(Z7,e.length);return new X7(t,n)}const t=(e=r9(e,Z7)).subarray(0,Z7),n=e.subarray(j7);return new X7(t,n)}function e9(e){return e=r9(e,j7),new J7(e)}async function t9(){const{privateKey:e,publicKey:t}=await async function(){const e=ql.utils.randomPrivateKey(),t=ql.getPublicKey(e);return{privateKey:V7(e,t),publicKey:t}}();return new X7(e,t)}async function n9(e){const{privateKey:t,publicKey:n}=await async function(e){if(e.length!==z7)throw new TypeError('"seed" must be 32 bytes in length.');if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');const t=e,n=ql.getPublicKey(t);return{privateKey:V7(t,n),publicKey:n}}(e);return new X7(t,n)}function r9(e,t){var n;if((e=Uint8Array.from(null!==(n=e)&&void 0!==n?n:[])).length!==t)throw new $4("Key must be a Uint8Array of length ".concat(t,", got ").concat(e.length),"ERR_INVALID_KEY_TYPE");return e}function i9(e,t){let n=Uint8Array.from(e.abs().toByteArray());if(n=0===n[0]?n.subarray(1):n,null!=t){if(n.length>t)throw new Error("byte array longer than desired length");n=(0,Ls.z)([new Uint8Array(t-n.length),n])}return(0,Au.B)(n,"base64url")}function o9(e){const t=function(e,t){let n=(0,yu.m)(e,"base64urlpad");if(null!=t){if(n.length>t)throw new Error("byte array longer than desired length");n=(0,Ls.z)([new Uint8Array(t-n.length),n])}return n}(e);return new(gu().jsbn.BigInteger)((0,Au.B)(t,"base16"),16)}const s9={"P-256":256,"P-384":384,"P-521":521};Object.keys(s9).join(" / ");function a9(e){if(isNaN(e)||e<=0)throw new $4("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return _c(e)}function c9(e,t){return t.map((t=>o9(e[t])))}async function l9(e){const t=[await K7.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await h9(e)],n=await u9({privateKey:t[0],publicKey:t[1]});return{privateKey:n[0],publicKey:n[1]}}async function u9(e){if(null==e.privateKey||null==e.publicKey)throw new $4("Private and public key are required","ERR_INVALID_PARAMETERS");return Promise.all([K7.get().subtle.exportKey("jwk",e.privateKey),K7.get().subtle.exportKey("jwk",e.publicKey)])}async function h9(e){return K7.get().subtle.importKey("jwk",{kty:e.kty,n:e.n,e:e.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function d9(e,t,n,r){const i=t?function(e){return gu().pki.setRsaPublicKey(...c9(e,["n","e"]))}(e):function(e){return gu().pki.setRsaPrivateKey(...c9(e,["n","e","d","p","q","dp","dq","qi"]))}(e),o=r((0,Au.B)(Uint8Array.from(n),"ascii"),i);return(0,yu.m)(o,"ascii")}function f9(e){if("RSA"!==e.kty)throw new $4("invalid key type","ERR_INVALID_KEY_TYPE");if(null==e.n)throw new $4("invalid key modulus","ERR_INVALID_KEY_MODULUS");return 8*(0,yu.m)(e.n,"base64url").length}const p9=8192;class g9{constructor(e){(0,Yo.Z)(this,"_key",void 0),this._key=e}async verify(e,t){return async function(e,t,n){const r=await K7.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return K7.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},r,t,n)}(this._key,t,e)}marshal(){return function(e){if(null==e.n||null==e.e)throw new $4("JWK was missing components","ERR_INVALID_PARAMETERS");const t=gu().pki.publicKeyToAsn1({n:o9(e.n),e:o9(e.e)});return(0,yu.m)(gu().asn1.toDer(t).getBytes(),"ascii")}(this._key)}get bytes(){return Q7.encode({Type:G7.RSA,Data:this.marshal()}).subarray()}encrypt(e){return d9(this._key,!0,e,((e,t)=>t.encrypt(e)))}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await e8.digest(this.bytes);return e}}class y9{constructor(e,t){(0,Yo.Z)(this,"_key",void 0),(0,Yo.Z)(this,"_publicKey",void 0),this._key=e,this._publicKey=t}genSecret(){return a9(16)}async sign(e){return async function(e,t){const n=await K7.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),r=await K7.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},n,Uint8Array.from(t));return new Uint8Array(r,0,r.byteLength)}(this._key,e)}get public(){if(null==this._publicKey)throw new $4("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new g9(this._publicKey)}decrypt(e){return d9(this._key,!1,e,((e,t)=>t.decrypt(e)))}marshal(){return function(e){if(null==e.n||null==e.e||null==e.d||null==e.p||null==e.q||null==e.dp||null==e.dq||null==e.qi)throw new $4("JWK was missing components","ERR_INVALID_PARAMETERS");const t=gu().pki.privateKeyToAsn1({n:o9(e.n),e:o9(e.e),d:o9(e.d),p:o9(e.p),q:o9(e.q),dP:o9(e.dp),dQ:o9(e.dq),qInv:o9(e.qi)});return(0,yu.m)(gu().asn1.toDer(t).getBytes(),"ascii")}(this._key)}get bytes(){return Y7.encode({Type:G7.RSA,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await e8.digest(this.bytes);return e}async id(){const e=await this.public.hash();return(0,Au.B)(e,"base58btc")}async export(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"pkcs-8";if("pkcs-8"===t){const t=new(gu().util.ByteBuffer)(this.marshal()),n=gu().asn1.fromDer(t),r=gu().pki.privateKeyFromAsn1(n),i={algorithm:"aes256",count:1e4,saltSize:16,prfAlgorithm:"sha512"};return gu().pki.encryptRsaPrivateKey(r,e,i)}if("libp2p-key"===t)return q7(this.bytes,e);throw new $4("export format '".concat(t,"' is not supported"),"ERR_INVALID_EXPORT_FORMAT")}}async function m9(e){const t=function(e){const t=gu().asn1.fromDer((0,Au.B)(e,"ascii")),n=gu().pki.privateKeyFromAsn1(t);return{kty:"RSA",n:i9(n.n),e:i9(n.e),d:i9(n.d),p:i9(n.p),q:i9(n.q),dp:i9(n.dP),dq:i9(n.dQ),qi:i9(n.qInv),alg:"RS256"}}(e);if(f9(t)>p9)throw new $4("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const n=await l9(t);return new y9(n.privateKey,n.publicKey)}function v9(e){const t=function(e){const t=gu().asn1.fromDer((0,Au.B)(e,"ascii")),n=gu().pki.publicKeyFromAsn1(t);return{kty:"RSA",n:i9(n.n),e:i9(n.e)}}(e);if(f9(t)>p9)throw new $4("key size is too large","ERR_KEY_SIZE_TOO_LARGE");return new g9(t)}async function b9(e){if(f9(e)>p9)throw new $4("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const t=await l9(e);return new y9(t.privateKey,t.publicKey)}async function w9(e){if(e>p9)throw new $4("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const t=await async function(e){const t=await K7.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),n=await u9(t);return{privateKey:n[0],publicKey:n[1]}}(e);return new y9(t.privateKey,t.publicKey)}function E9(e){try{Eh.ProjectivePoint.fromHex(e)}catch(t){throw new $4(String(t),"ERR_INVALID_PUBLIC_KEY")}}class A9{constructor(e){(0,Yo.Z)(this,"_key",void 0),E9(e),this._key=e}async verify(e,t){return async function(e,t,n){try{const{digest:r}=await e8.digest(n);return Eh.verify(t,r,e)}catch(r){throw new $4(String(r),"ERR_INVALID_INPUT")}}(this._key,t,e)}marshal(){return e=this._key,Eh.ProjectivePoint.fromHex(e).toRawBytes(!0);var e}get bytes(){return Q7.encode({Type:G7.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await e8.digest(this.bytes);return e}}class S9{constructor(e,t){(0,Yo.Z)(this,"_key",void 0),(0,Yo.Z)(this,"_publicKey",void 0),this._key=e,this._publicKey=null!==t&&void 0!==t?t:function(e){try{return Eh.getPublicKey(e,!0)}catch(t){throw new $4(String(t),"ERR_INVALID_PRIVATE_KEY")}}(e),function(e){try{Eh.getPublicKey(e,!0)}catch(t){throw new $4(String(t),"ERR_INVALID_PRIVATE_KEY")}}(this._key),E9(this._publicKey)}async sign(e){return async function(e,t){const{digest:n}=await e8.digest(t);try{return Eh.sign(n,e).toDERRawBytes()}catch(r){throw new $4(String(r),"ERR_INVALID_INPUT")}}(this._key,e)}get public(){return new A9(this._publicKey)}marshal(){return this._key}get bytes(){return Y7.encode({Type:G7.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await e8.digest(this.bytes);return e}async id(){const e=await this.public.hash();return(0,Au.B)(e,"base58btc")}async export(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"libp2p-key";if("libp2p-key"===t)return q7(this.bytes,e);throw new $4("export format '".concat(t,"' is not supported"),"ERR_INVALID_EXPORT_FORMAT")}}function _9(e){return new S9(e)}function I9(e){return new A9(e)}async function C9(){const e=Eh.utils.randomPrivateKey();return new S9(e)}const T9={rsa:Jn,ed25519:Yn,secp256k1:Xn};function k9(e){const t=Object.keys(T9).join(" / ");return new $4("invalid or unsupported key type ".concat(e,". Must be ").concat(t),"ERR_UNSUPPORTED_KEY_TYPE")}function R9(e){if("rsa"===(e=e.toLowerCase())||"ed25519"===e||"secp256k1"===e)return T9[e];throw k9(e)}function x9(e){var t,n;const r=Q7.decode(e),i=null!==(t=r.Data)&&void 0!==t?t:new Uint8Array;switch(r.Type){case G7.RSA:return T9.rsa.unmarshalRsaPublicKey(i);case G7.Ed25519:return T9.ed25519.unmarshalEd25519PublicKey(i);case G7.Secp256k1:return T9.secp256k1.unmarshalSecp256k1PublicKey(i);default:throw k9(null!==(n=r.Type)&&void 0!==n?n:"unknown")}}function P9(e,t){var n;return R9(t=(null!==(n=t)&&void 0!==n?n:"rsa").toLowerCase()),e.bytes}async function D9(e){var t,n;const r=Y7.decode(e),i=null!==(t=r.Data)&&void 0!==t?t:new Uint8Array;switch(r.Type){case G7.RSA:return T9.rsa.unmarshalRsaPrivateKey(i);case G7.Ed25519:return T9.ed25519.unmarshalEd25519PrivateKey(i);case G7.Secp256k1:return T9.secp256k1.unmarshalSecp256k1PrivateKey(i);default:throw k9(null!==(n=r.Type)&&void 0!==n?n:"RSA")}}const O9=(0,yu.m)("libp2p-pubsub:");function N9(e){if(e.length<=1)return e;for(let t=0;t<e.length;t++){const n=Math.floor(Math.random()*Math.floor(e.length)),r=e[t];e[t]=e[n],e[n]=r}return e}function B9(e){return(0,Au.B)(e,"base64")}const L9={get(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:globalThis).crypto;if(null==e||null==e.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p/blob/main/packages/crypto/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}};var M9=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==n[s])throw new TypeError(o+" is ambiguous");n[s]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var r=0,i=0;e[t]===c;)r++,t++;for(var o=(e.length-t)*l+1>>>0,s=new Uint8Array(o);e[t];){var u=n[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=o-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*s[d]>>>0,s[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=o-i;f!==o&&0===s[f];)f++;for(var p=new Uint8Array(r+(o-f)),g=r;f!==o;)p[g++]=s[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,o=t.length;i!==o&&0===t[i];)i++,n++;for(var s=(o-i)*u+1>>>0,l=new Uint8Array(s);i!==o;){for(var h=t[i],d=0,f=s-1;(0!==h||d<r)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");r=d,i++}for(var p=s-r;p!==s&&0===l[p];)p++;for(var g=c.repeat(n);p<s;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:h,decode:function(e){var n=h(e);if(n)return n;throw new Error("Non-".concat(t," character"))}}};const U9=M9,F9=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class K9{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(e));throw Error("Unknown type, must be binary type")}}class j9{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(e),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return z9(this,e)}}class Z9{constructor(e){this.decoders=e}or(e){return z9(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(e),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}}const z9=(e,t)=>new Z9({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class V9{constructor(e,t,n,r){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=r,this.encoder=new K9(e,t,n),this.decoder=new j9(e,t,r)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const H9=e=>{let{name:t,prefix:n,encode:r,decode:i}=e;return new V9(t,n,r,i)},q9=e=>{let{prefix:t,name:n,alphabet:r}=e;const{encode:i,decode:o}=U9(r,n);return H9({prefix:t,name:n,encode:i,decode:e=>F9(o(e))})},G9=e=>{let{name:t,prefix:n,bitsPerChar:r,alphabet:i}=e;return H9({prefix:n,name:t,encode:e=>((e,t,n)=>{const r="="===t[t.length-1],i=(1<<n)-1;let o="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>n;)s-=n,o+=t[i&a>>s];if(s&&(o+=t[i&a<<n-s]),r)for(;o.length*n&7;)o+="=";return o})(e,i,r),decode:e=>((e,t,n,r)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*n/8|0);let a=0,c=0,l=0;for(let u=0;u<o;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError("Non-".concat(r," character"));c=c<<n|t,a+=n,a>=8&&(a-=8,s[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s})(e,i,r,t)})},W9=q9({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Q9=q9({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Y9=function e(t,n,r){n=n||[];var i=r=r||0;for(;t>=$9;)n[r++]=255&t|J9,t/=128;for(;t&X9;)n[r++]=255&t|J9,t>>>=7;return n[r]=0|t,e.bytes=r-i+1,n},J9=128,X9=-128,$9=Math.pow(2,31);var eee=function e(t,n){var r,i=0,o=0,s=n=n||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");r=t[s++],i+=o<28?(r&nee)<<o:(r&nee)*Math.pow(2,o),o+=7}while(r>=tee);return e.bytes=s-n,i},tee=128,nee=127;var ree=Math.pow(2,7),iee=Math.pow(2,14),oee=Math.pow(2,21),see=Math.pow(2,28),aee=Math.pow(2,35),cee=Math.pow(2,42),lee=Math.pow(2,49),uee=Math.pow(2,56),hee=Math.pow(2,63);const dee={encode:Y9,decode:eee,encodingLength:function(e){return e<ree?1:e<iee?2:e<oee?3:e<see?4:e<aee?5:e<cee?6:e<lee?7:e<uee?8:e<hee?9:10}},fee=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return dee.encode(e,t,n),t},pee=e=>dee.encodingLength(e),gee=(e,t)=>{const n=t.byteLength,r=pee(e),i=r+pee(n),o=new Uint8Array(i+n);return fee(e,o,0),fee(n,o,r),o.set(t,i),new yee(e,n,t,o)};class yee{constructor(e,t,n,r){this.code=e,this.size=t,this.digest=n,this.bytes=r}}const mee=F9,vee={code:0,name:"identity",encode:mee,digest:e=>gee(0,mee(e))},bee=e=>{let{name:t,code:n,encode:r}=e;return new wee(t,n,r)};class wee{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?gee(this.code,t):t.then((e=>gee(this.code,e)))}throw Error("Unknown type, must be binary type")}}const Eee=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Aee=bee({name:"sha2-256",code:18,encode:Eee("SHA-256")}),See=bee({name:"sha2-512",code:19,encode:Eee("SHA-512")});function _ee(e,t){let n=Uint8Array.from(e.abs().toByteArray());if(n=0===n[0]?n.subarray(1):n,null!=t){if(n.length>t)throw new Error("byte array longer than desired length");n=(0,Ls.z)([new Uint8Array(t-n.length),n])}return(0,Au.B)(n,"base64url")}function Iee(e){const t=function(e,t){let n=(0,yu.m)(e,"base64urlpad");if(null!=t){if(n.length>t)throw new Error("byte array longer than desired length");n=(0,Ls.z)([new Uint8Array(t-n.length),n])}return n}(e);return new(gu().jsbn.BigInteger)((0,Au.B)(t,"base16"),16)}function Cee(e){return null!=e&&("function"===typeof e.then&&"function"===typeof e.catch&&"function"===typeof e.finally)}const Tee=32,kee=64,Ree=32;function xee(e,t){const n=new Uint8Array(kee);for(let r=0;r<Ree;r++)n[r]=e[r],n[Ree+r]=t[r];return n}const Pee=G9({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Dee=G9({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Oee=G9({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Nee=G9({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Bee={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};async function Lee(e,t){const n=function(e){var t,n,r,i,o,s;const a=null!==(t=null===e||void 0===e?void 0:e.algorithm)&&void 0!==t?t:"AES-GCM";let c=null!==(n=null===e||void 0===e?void 0:e.keyLength)&&void 0!==n?n:16;const l=null!==(r=null===e||void 0===e?void 0:e.nonceLength)&&void 0!==r?r:12,u=null!==(i=null===e||void 0===e?void 0:e.digest)&&void 0!==i?i:"SHA-256",h=null!==(o=null===e||void 0===e?void 0:e.saltLength)&&void 0!==o?o:16,d=null!==(s=null===e||void 0===e?void 0:e.iterations)&&void 0!==s?s:32767,f=L9.get();return c*=8,{encrypt:async function(e,t){const n=f.getRandomValues(new Uint8Array(h)),r=f.getRandomValues(new Uint8Array(l)),i={name:a,iv:r};let o;if("string"===typeof t&&(t=(0,yu.m)(t)),0===t.length){o=await f.subtle.importKey("jwk",Bee,{name:"AES-GCM"},!0,["encrypt"]);try{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);o=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["encrypt"])}catch{o=await f.subtle.importKey("jwk",Bee,{name:"AES-GCM"},!0,["encrypt"])}}else{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);o=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["encrypt"])}const s=await f.subtle.encrypt(i,o,e);return(0,Ls.z)([n,i.iv,new Uint8Array(s)])},decrypt:async function(e,t){const n=e.subarray(0,h),r=e.subarray(h,h+l),i=e.subarray(h+l),o={name:a,iv:r};let s;if("string"===typeof t&&(t=(0,yu.m)(t)),0===t.length)try{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);s=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["decrypt"])}catch{s=await f.subtle.importKey("jwk",Bee,{name:"AES-GCM"},!0,["decrypt"])}else{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);s=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["decrypt"])}const p=await f.subtle.decrypt(o,s,i);return new Uint8Array(p)}}}(),r=await n.encrypt(e,t);return Pee.encode(r)}var Mee,Uee,Fee,Kee;!function(e){e.RSA="RSA",e.Ed25519="Ed25519",e.Secp256k1="Secp256k1"}(Mee||(Mee={})),function(e){e[e.RSA=0]="RSA",e[e.Ed25519=1]="Ed25519",e[e.Secp256k1=2]="Secp256k1"}(Uee||(Uee={})),function(e){e.codec=()=>bs(Uee)}(Mee||(Mee={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),Mee.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.Type=Mee.codec().decode(e);break;case 2:n.Data=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(Fee||(Fee={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),Mee.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.Type=Mee.codec().decode(e);break;case 2:n.Data=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(Kee||(Kee={}));class jee{constructor(e){(0,Yo.Z)(this,"_key",void 0),this._key=Gee(e,Tee)}verify(e,t){return function(e,t,n){return ql.verify(t,n instanceof Uint8Array?n:n.subarray(),e)}(this._key,t,e)}marshal(){return this._key}get bytes(){return Fee.encode({Type:Mee.Ed25519,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}hash(){const e=Aee.digest(this.bytes);return Cee(e)?e.then((e=>{let{bytes:t}=e;return t})):e.bytes}}class Zee{constructor(e,t){(0,Yo.Z)(this,"_key",void 0),(0,Yo.Z)(this,"_publicKey",void 0),this._key=Gee(e,kee),this._publicKey=Gee(t,Tee)}sign(e){return function(e,t){const n=e.subarray(0,Ree);return ql.sign(t instanceof Uint8Array?t:t.subarray(),n)}(this._key,e)}get public(){return new jee(this._publicKey)}marshal(){return this._key}get bytes(){return Kee.encode({Type:Mee.Ed25519,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const e=Aee.digest(this.bytes);let t;return Cee(e)?({bytes:t}=await e):t=e.bytes,t}async id(){const e=vee.digest(this.public.bytes);return W9.encode(e.bytes).substring(1)}async export(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"libp2p-key";if("libp2p-key"===t)return Lee(this.bytes,e);throw new fu.sv("export format '".concat(t,"' is not supported"),"ERR_INVALID_EXPORT_FORMAT")}}function zee(e){if(e.length>kee){const t=(e=Gee(e,kee+Tee)).subarray(0,kee),n=e.subarray(kee,e.length);return new Zee(t,n)}const t=(e=Gee(e,kee)).subarray(0,kee),n=e.subarray(Tee);return new Zee(t,n)}function Vee(e){return e=Gee(e,Tee),new jee(e)}async function Hee(){const{privateKey:e,publicKey:t}=function(){const e=ql.utils.randomPrivateKey(),t=ql.getPublicKey(e);return{privateKey:xee(e,t),publicKey:t}}();return new Zee(e,t)}async function qee(e){const{privateKey:t,publicKey:n}=function(e){if(e.length!==Ree)throw new TypeError('"seed" must be 32 bytes in length.');if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');const t=e,n=ql.getPublicKey(t);return{privateKey:xee(t,n),publicKey:n}}(e);return new Zee(t,n)}function Gee(e,t){var n;if((e=Uint8Array.from(null!==(n=e)&&void 0!==n?n:[])).length!==t)throw new fu.sv("Key must be a Uint8Array of length ".concat(t,", got ").concat(e.length),"ERR_INVALID_KEY_TYPE");return e}const Wee={"P-256":256,"P-384":384,"P-521":521};Object.keys(Wee).join(" / ");function Qee(e,t){return t.map((t=>Iee(e[t])))}async function Yee(e){const t=[await L9.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await Xee(e)],n=await Jee({privateKey:t[0],publicKey:t[1]});return{privateKey:n[0],publicKey:n[1]}}async function Jee(e){if(null==e.privateKey||null==e.publicKey)throw new fu.sv("Private and public key are required","ERR_INVALID_PARAMETERS");return Promise.all([L9.get().subtle.exportKey("jwk",e.privateKey),L9.get().subtle.exportKey("jwk",e.publicKey)])}async function Xee(e){return L9.get().subtle.importKey("jwk",{kty:e.kty,n:e.n,e:e.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function $ee(e,t,n,r){const i=t?function(e){return gu().pki.setRsaPublicKey(...Qee(e,["n","e"]))}(e):function(e){return gu().pki.setRsaPrivateKey(...Qee(e,["n","e","d","p","q","dp","dq","qi"]))}(e),o=r((0,Au.B)(n instanceof Uint8Array?n:n.subarray(),"ascii"),i);return(0,yu.m)(o,"ascii")}function ete(e){if("RSA"!==e.kty)throw new fu.sv("invalid key type","ERR_INVALID_KEY_TYPE");if(null==e.n)throw new fu.sv("invalid key modulus","ERR_INVALID_KEY_MODULUS");return 8*(0,yu.m)(e.n,"base64url").length}const tte=8192;class nte{constructor(e){(0,Yo.Z)(this,"_key",void 0),this._key=e}verify(e,t){return async function(e,t,n){const r=await L9.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return L9.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},r,t,n instanceof Uint8Array?n:n.subarray())}(this._key,t,e)}marshal(){return function(e){if(null==e.n||null==e.e)throw new fu.sv("JWK was missing components","ERR_INVALID_PARAMETERS");const t=gu().pki.publicKeyToAsn1({n:Iee(e.n),e:Iee(e.e)});return(0,yu.m)(gu().asn1.toDer(t).getBytes(),"ascii")}(this._key)}get bytes(){return Fee.encode({Type:Mee.RSA,Data:this.marshal()}).subarray()}encrypt(e){return $ee(this._key,!0,e,((e,t)=>t.encrypt(e)))}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}hash(){const e=Aee.digest(this.bytes);return Cee(e)?e.then((e=>{let{bytes:t}=e;return t})):e.bytes}}class rte{constructor(e,t){(0,Yo.Z)(this,"_key",void 0),(0,Yo.Z)(this,"_publicKey",void 0),this._key=e,this._publicKey=t}genSecret(){return function(e){if(isNaN(e)||e<=0)throw new fu.sv("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return _c(e)}(16)}sign(e){return async function(e,t){const n=await L9.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),r=await L9.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},n,t instanceof Uint8Array?t:t.subarray());return new Uint8Array(r,0,r.byteLength)}(this._key,e)}get public(){if(null==this._publicKey)throw new fu.sv("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new nte(this._publicKey)}decrypt(e){return $ee(this._key,!1,e,((e,t)=>t.decrypt(e)))}marshal(){return function(e){if(null==e.n||null==e.e||null==e.d||null==e.p||null==e.q||null==e.dp||null==e.dq||null==e.qi)throw new fu.sv("JWK was missing components","ERR_INVALID_PARAMETERS");const t=gu().pki.privateKeyToAsn1({n:Iee(e.n),e:Iee(e.e),d:Iee(e.d),p:Iee(e.p),q:Iee(e.q),dP:Iee(e.dp),dQ:Iee(e.dq),qInv:Iee(e.qi)});return(0,yu.m)(gu().asn1.toDer(t).getBytes(),"ascii")}(this._key)}get bytes(){return Kee.encode({Type:Mee.RSA,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}hash(){const e=Aee.digest(this.bytes);return Cee(e)?e.then((e=>{let{bytes:t}=e;return t})):e.bytes}async id(){const e=await this.public.hash();return(0,Au.B)(e,"base58btc")}async export(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"pkcs-8";if("pkcs-8"===t){const t=new(gu().util.ByteBuffer)(this.marshal()),n=gu().asn1.fromDer(t),r=gu().pki.privateKeyFromAsn1(n),i={algorithm:"aes256",count:1e4,saltSize:16,prfAlgorithm:"sha512"};return gu().pki.encryptRsaPrivateKey(r,e,i)}if("libp2p-key"===t)return Lee(this.bytes,e);throw new fu.sv("export format '".concat(t,"' is not supported"),"ERR_INVALID_EXPORT_FORMAT")}}async function ite(e){const t=function(e){const t=gu().asn1.fromDer((0,Au.B)(e,"ascii")),n=gu().pki.privateKeyFromAsn1(t);return{kty:"RSA",n:_ee(n.n),e:_ee(n.e),d:_ee(n.d),p:_ee(n.p),q:_ee(n.q),dp:_ee(n.dP),dq:_ee(n.dQ),qi:_ee(n.qInv),alg:"RS256"}}(e);if(ete(t)>tte)throw new fu.sv("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const n=await Yee(t);return new rte(n.privateKey,n.publicKey)}function ote(e){const t=function(e){const t=gu().asn1.fromDer((0,Au.B)(e,"ascii")),n=gu().pki.publicKeyFromAsn1(t);return{kty:"RSA",n:_ee(n.n),e:_ee(n.e)}}(e);if(ete(t)>tte)throw new fu.sv("key size is too large","ERR_KEY_SIZE_TOO_LARGE");return new nte(t)}async function ste(e){if(ete(e)>tte)throw new fu.sv("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const t=await Yee(e);return new rte(t.privateKey,t.publicKey)}async function ate(e){if(e>tte)throw new fu.sv("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const t=await async function(e){const t=await L9.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),n=await Jee(t);return{privateKey:n[0],publicKey:n[1]}}(e);return new rte(t.privateKey,t.publicKey)}function cte(e){try{Eh.ProjectivePoint.fromHex(e)}catch(t){throw new fu.sv(String(t),"ERR_INVALID_PUBLIC_KEY")}}class lte{constructor(e){(0,Yo.Z)(this,"_key",void 0),cte(e),this._key=e}verify(e,t){return function(e,t,n){const r=Aee.digest(n instanceof Uint8Array?n:n.subarray());if(Cee(r))return r.then((n=>{let{digest:r}=n;return Eh.verify(t,r,e)})).catch((e=>{throw new fu.sv(String(e),"ERR_INVALID_INPUT")}));try{return Eh.verify(t,r.digest,e)}catch(i){throw new fu.sv(String(i),"ERR_INVALID_INPUT")}}(this._key,t,e)}marshal(){return e=this._key,Eh.ProjectivePoint.fromHex(e).toRawBytes(!0);var e}get bytes(){return Fee.encode({Type:Mee.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const e=Aee.digest(this.bytes);let t;return Cee(e)?({bytes:t}=await e):t=e.bytes,t}}class ute{constructor(e,t){(0,Yo.Z)(this,"_key",void 0),(0,Yo.Z)(this,"_publicKey",void 0),this._key=e,this._publicKey=null!==t&&void 0!==t?t:function(e){try{return Eh.getPublicKey(e,!0)}catch(t){throw new fu.sv(String(t),"ERR_INVALID_PRIVATE_KEY")}}(e),function(e){try{Eh.getPublicKey(e,!0)}catch(t){throw new fu.sv(String(t),"ERR_INVALID_PRIVATE_KEY")}}(this._key),cte(this._publicKey)}sign(e){return function(e,t){const n=Aee.digest(t instanceof Uint8Array?t:t.subarray());if(Cee(n))return n.then((t=>{let{digest:n}=t;return Eh.sign(n,e).toDERRawBytes()})).catch((e=>{throw new fu.sv(String(e),"ERR_INVALID_INPUT")}));try{return Eh.sign(n.digest,e).toDERRawBytes()}catch(r){throw new fu.sv(String(r),"ERR_INVALID_INPUT")}}(this._key,e)}get public(){return new lte(this._publicKey)}marshal(){return this._key}get bytes(){return Kee.encode({Type:Mee.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}hash(){const e=Aee.digest(this.bytes);return Cee(e)?e.then((e=>{let{bytes:t}=e;return t})):e.bytes}async id(){const e=await this.public.hash();return(0,Au.B)(e,"base58btc")}async export(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"libp2p-key";if("libp2p-key"===t)return Lee(this.bytes,e);throw new fu.sv("export format '".concat(t,"' is not supported"),"ERR_INVALID_EXPORT_FORMAT")}}function hte(e){return new ute(e)}function dte(e){return new lte(e)}async function fte(){const e=Eh.utils.randomPrivateKey();return new ute(e)}const pte=q9({prefix:"9",name:"base10",alphabet:"0123456789"}),gte=G9({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),yte=G9({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),mte=G9({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),vte=Array.from("\ud83d\ude80\ud83e\ude90\u2604\ud83d\udef0\ud83c\udf0c\ud83c\udf11\ud83c\udf12\ud83c\udf13\ud83c\udf14\ud83c\udf15\ud83c\udf16\ud83c\udf17\ud83c\udf18\ud83c\udf0d\ud83c\udf0f\ud83c\udf0e\ud83d\udc09\u2600\ud83d\udcbb\ud83d\udda5\ud83d\udcbe\ud83d\udcbf\ud83d\ude02\u2764\ud83d\ude0d\ud83e\udd23\ud83d\ude0a\ud83d\ude4f\ud83d\udc95\ud83d\ude2d\ud83d\ude18\ud83d\udc4d\ud83d\ude05\ud83d\udc4f\ud83d\ude01\ud83d\udd25\ud83e\udd70\ud83d\udc94\ud83d\udc96\ud83d\udc99\ud83d\ude22\ud83e\udd14\ud83d\ude06\ud83d\ude44\ud83d\udcaa\ud83d\ude09\u263a\ud83d\udc4c\ud83e\udd17\ud83d\udc9c\ud83d\ude14\ud83d\ude0e\ud83d\ude07\ud83c\udf39\ud83e\udd26\ud83c\udf89\ud83d\udc9e\u270c\u2728\ud83e\udd37\ud83d\ude31\ud83d\ude0c\ud83c\udf38\ud83d\ude4c\ud83d\ude0b\ud83d\udc97\ud83d\udc9a\ud83d\ude0f\ud83d\udc9b\ud83d\ude42\ud83d\udc93\ud83e\udd29\ud83d\ude04\ud83d\ude00\ud83d\udda4\ud83d\ude03\ud83d\udcaf\ud83d\ude48\ud83d\udc47\ud83c\udfb6\ud83d\ude12\ud83e\udd2d\u2763\ud83d\ude1c\ud83d\udc8b\ud83d\udc40\ud83d\ude2a\ud83d\ude11\ud83d\udca5\ud83d\ude4b\ud83d\ude1e\ud83d\ude29\ud83d\ude21\ud83e\udd2a\ud83d\udc4a\ud83e\udd73\ud83d\ude25\ud83e\udd24\ud83d\udc49\ud83d\udc83\ud83d\ude33\u270b\ud83d\ude1a\ud83d\ude1d\ud83d\ude34\ud83c\udf1f\ud83d\ude2c\ud83d\ude43\ud83c\udf40\ud83c\udf37\ud83d\ude3b\ud83d\ude13\u2b50\u2705\ud83e\udd7a\ud83c\udf08\ud83d\ude08\ud83e\udd18\ud83d\udca6\u2714\ud83d\ude23\ud83c\udfc3\ud83d\udc90\u2639\ud83c\udf8a\ud83d\udc98\ud83d\ude20\u261d\ud83d\ude15\ud83c\udf3a\ud83c\udf82\ud83c\udf3b\ud83d\ude10\ud83d\udd95\ud83d\udc9d\ud83d\ude4a\ud83d\ude39\ud83d\udde3\ud83d\udcab\ud83d\udc80\ud83d\udc51\ud83c\udfb5\ud83e\udd1e\ud83d\ude1b\ud83d\udd34\ud83d\ude24\ud83c\udf3c\ud83d\ude2b\u26bd\ud83e\udd19\u2615\ud83c\udfc6\ud83e\udd2b\ud83d\udc48\ud83d\ude2e\ud83d\ude46\ud83c\udf7b\ud83c\udf43\ud83d\udc36\ud83d\udc81\ud83d\ude32\ud83c\udf3f\ud83e\udde1\ud83c\udf81\u26a1\ud83c\udf1e\ud83c\udf88\u274c\u270a\ud83d\udc4b\ud83d\ude30\ud83e\udd28\ud83d\ude36\ud83e\udd1d\ud83d\udeb6\ud83d\udcb0\ud83c\udf53\ud83d\udca2\ud83e\udd1f\ud83d\ude41\ud83d\udea8\ud83d\udca8\ud83e\udd2c\u2708\ud83c\udf80\ud83c\udf7a\ud83e\udd13\ud83d\ude19\ud83d\udc9f\ud83c\udf31\ud83d\ude16\ud83d\udc76\ud83e\udd74\u25b6\u27a1\u2753\ud83d\udc8e\ud83d\udcb8\u2b07\ud83d\ude28\ud83c\udf1a\ud83e\udd8b\ud83d\ude37\ud83d\udd7a\u26a0\ud83d\ude45\ud83d\ude1f\ud83d\ude35\ud83d\udc4e\ud83e\udd32\ud83e\udd20\ud83e\udd27\ud83d\udccc\ud83d\udd35\ud83d\udc85\ud83e\uddd0\ud83d\udc3e\ud83c\udf52\ud83d\ude17\ud83e\udd11\ud83c\udf0a\ud83e\udd2f\ud83d\udc37\u260e\ud83d\udca7\ud83d\ude2f\ud83d\udc86\ud83d\udc46\ud83c\udfa4\ud83d\ude47\ud83c\udf51\u2744\ud83c\udf34\ud83d\udca3\ud83d\udc38\ud83d\udc8c\ud83d\udccd\ud83e\udd40\ud83e\udd22\ud83d\udc45\ud83d\udca1\ud83d\udca9\ud83d\udc50\ud83d\udcf8\ud83d\udc7b\ud83e\udd10\ud83e\udd2e\ud83c\udfbc\ud83e\udd75\ud83d\udea9\ud83c\udf4e\ud83c\udf4a\ud83d\udc7c\ud83d\udc8d\ud83d\udce3\ud83e\udd42"),bte=vte.reduce(((e,t,n)=>(e[n]=t,e)),[]),wte=vte.reduce(((e,t,n)=>(e[t.codePointAt(0)]=n,e)),[]);const Ete=H9({prefix:"\ud83d\ude80",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=bte[t]),"")},decode:function(e){const t=[];for(const n of e){const e=wte[n.codePointAt(0)];if(void 0===e)throw new Error("Non-base256emoji character: ".concat(n));t.push(e)}return new Uint8Array(t)}}),Ate=G9({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Ste=G9({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),_te=G9({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Ite=G9({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Cte=G9({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Tte=G9({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),kte=G9({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Rte=G9({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),xte=G9({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Pte=q9({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Dte=q9({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Ote=G9({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),Nte=H9({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),Bte=new TextEncoder,Lte=new TextDecoder,Mte="json",Ute=512,Fte=e=>Bte.encode(JSON.stringify(e)),Kte=e=>JSON.parse(Lte.decode(e)),jte="raw",Zte=85,zte=e=>F9(e),Vte=e=>F9(e);new WeakMap;Symbol.toStringTag,Symbol.for("nodejs.util.inspect.custom");Symbol.for("@ipld/js-cid/CID");const Hte={...fr,...cr,...dr,...sr,...ar,...ur,...hr,...$n,...nr,...lr},qte=Symbol.for("nodejs.util.inspect.custom");Object.values(Hte).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)),Hte.identity.decoder);Symbol.toStringTag;function Gte(e){if("signed"!==e.type)throw new Error("expected signed message type");if(null==e.sequenceNumber)throw Error("missing seqno field");return((e,t)=>{const n=(0,yu.m)(t.toString(16).padStart(16,"0"),"base16"),r=new Uint8Array(e.length+n.length);return r.set(e,0),r.set(n,e.length),r})(e.from.toBytes(),e.sequenceNumber)}async function Wte(e){return e8.encode(e.data)}var Qte,Yte=n(37318);!function(e){e[e.ip4=4]="ip4",e[e.ip6=41]="ip6"}(Qte||(Qte={}));class Jte{constructor(e){(0,Yo.Z)(this,"entries",new Map),(0,Yo.Z)(this,"validityMs",void 0),this.validityMs=e.validityMs}get size(){return this.entries.size}put(e,t){return!!this.entries.has(e)||(this.entries.set(e,{value:t,validUntilMs:Date.now()+this.validityMs}),!1)}prune(){const e=Date.now();for(const[t,n]of this.entries.entries()){if(!(n.validUntilMs<e))break;this.entries.delete(t)}}has(e){return this.entries.has(e)}get(e){const t=this.entries.get(e);return null!=t&&t.validUntilMs>=Date.now()?t.value:void 0}clear(){this.entries.clear()}}var Xte,$te,ene;!function(e){e[e.started=0]="started",e[e.stopped=1]="stopped"}(Xte||(Xte={}));class tne extends b4{constructor(e){var t,n,r,i,o;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),(0,Yo.Z)(this,"globalSignaturePolicy",void 0),(0,Yo.Z)(this,"multicodecs",[F8,U8]),(0,Yo.Z)(this,"publishConfig",void 0),(0,Yo.Z)(this,"dataTransform",void 0),(0,Yo.Z)(this,"peers",new Set),(0,Yo.Z)(this,"streamsInbound",new Map),(0,Yo.Z)(this,"streamsOutbound",new Map),(0,Yo.Z)(this,"outboundInflightQueue",k8({objectMode:!0})),(0,Yo.Z)(this,"direct",new Set),(0,Yo.Z)(this,"floodsubPeers",new Set),(0,Yo.Z)(this,"seenCache",void 0),(0,Yo.Z)(this,"acceptFromWhitelist",new Map),(0,Yo.Z)(this,"topics",new Map),(0,Yo.Z)(this,"subscriptions",new Set),(0,Yo.Z)(this,"mesh",new Map),(0,Yo.Z)(this,"fanout",new Map),(0,Yo.Z)(this,"fanoutLastpub",new Map),(0,Yo.Z)(this,"gossip",new Map),(0,Yo.Z)(this,"control",new Map),(0,Yo.Z)(this,"peerhave",new Map),(0,Yo.Z)(this,"iasked",new Map),(0,Yo.Z)(this,"backoff",new Map),(0,Yo.Z)(this,"outbound",new Map),(0,Yo.Z)(this,"msgIdFn",void 0),(0,Yo.Z)(this,"fastMsgIdFn",void 0),(0,Yo.Z)(this,"msgIdToStrFn",void 0),(0,Yo.Z)(this,"fastMsgIdCache",void 0),(0,Yo.Z)(this,"publishedMessageIds",void 0),(0,Yo.Z)(this,"mcache",void 0),(0,Yo.Z)(this,"score",void 0),(0,Yo.Z)(this,"topicValidators",new Map),(0,Yo.Z)(this,"log",void 0),(0,Yo.Z)(this,"heartbeatTicks",0),(0,Yo.Z)(this,"gossipTracer",void 0),(0,Yo.Z)(this,"components",void 0),(0,Yo.Z)(this,"directPeerInitial",null),(0,Yo.Z)(this,"opts",void 0),(0,Yo.Z)(this,"decodeRpcLimits",void 0),(0,Yo.Z)(this,"metrics",void 0),(0,Yo.Z)(this,"status",{code:Xte.stopped}),(0,Yo.Z)(this,"maxInboundStreams",void 0),(0,Yo.Z)(this,"maxOutboundStreams",void 0),(0,Yo.Z)(this,"allowedTopics",void 0),(0,Yo.Z)(this,"heartbeatTimer",null),(0,Yo.Z)(this,"runHeartbeat",(()=>{var e;const t=null===(e=this.metrics)||void 0===e?void 0:e.heartbeatDuration.startTimer();this.heartbeat().catch((e=>{this.log("Error running heartbeat",e)})).finally((()=>{if(null!=t&&t(),this.status.code===Xte.started){clearTimeout(this.status.heartbeatTimeout);let t=this.opts.heartbeatInterval-(Date.now()-this.status.hearbeatStartMs)%this.opts.heartbeatInterval;var e;if(t<.25*this.opts.heartbeatInterval)t+=this.opts.heartbeatInterval,null===(e=this.metrics)||void 0===e||e.heartbeatSkipped.inc();this.status.heartbeatTimeout=setTimeout(this.runHeartbeat,t)}}))}));const a={fallbackToFloodsub:!0,floodPublish:!0,doPX:!1,directPeers:[],D:6,Dlo:4,Dhi:12,Dscore:4,Dout:2,Dlazy:6,heartbeatInterval:1e3,fanoutTTL:6e4,mcacheLength:5,mcacheGossip:3,seenTTL:12e4,gossipsubIWantFollowupMs:3e3,prunePeers:16,pruneBackoff:6e4,unsubcribeBackoff:1e4,graftFloodThreshold:1e4,opportunisticGraftPeers:2,opportunisticGraftTicks:60,directConnectTicks:300,...s,scoreParams:m7(s.scoreParams),scoreThresholds:w7(s.scoreThresholds)};if(this.components=e,this.decodeRpcLimits=null!==(t=a.decodeRpcLimits)&&void 0!==t?t:z8,this.globalSignaturePolicy=null!==(n=a.globalSignaturePolicy)&&void 0!==n?n:A4,a.fallbackToFloodsub&&this.multicodecs.push(M8),this.log=J4(null!==(r=a.debugName)&&void 0!==r?r:"libp2p:gossipsub"),this.opts=a,this.direct=new Set(a.directPeers.map((e=>e.id.toString()))),this.seenCache=new Jte({validityMs:a.seenTTL}),this.publishedMessageIds=new Jte({validityMs:a.seenTTL}),null!=s.msgIdFn)this.msgIdFn=s.msgIdFn;else switch(this.globalSignaturePolicy){case A4:this.msgIdFn=Gte;break;case S4:this.msgIdFn=Wte;break;default:throw new Error("Invalid globalSignaturePolicy: ".concat(this.globalSignaturePolicy))}if(null!=s.fastMsgIdFn&&(this.fastMsgIdFn=s.fastMsgIdFn,this.fastMsgIdCache=new Jte({validityMs:a.seenTTL})),this.msgIdToStrFn=null!==(i=s.msgIdToStrFn)&&void 0!==i?i:B9,this.mcache=null!==(o=s.messageCache)&&void 0!==o?o:new t7(a.mcacheGossip,a.mcacheLength,this.msgIdToStrFn),null!=s.dataTransform&&(this.dataTransform=s.dataTransform),null!=s.metricsRegister){if(null==s.metricsTopicStrToLabel)throw Error("Must set metricsTopicStrToLabel with metrics");const e=Math.max(...Object.values(a.scoreParams.topics).map((e=>e.meshMessageDeliveriesWindow)),1e3),t=function(e,t,n){return{protocolsEnabled:e.gauge({name:"gossipsub_protocol",help:"Status of enabled protocols",labelNames:["protocol"]}),topicSubscriptionStatus:e.gauge({name:"gossipsub_topic_subscription_status",help:"Status of our subscription to this topic",labelNames:["topicStr"]}),topicPeersCount:e.gauge({name:"gossipsub_topic_peer_count",help:"Number of peers subscribed to each topic",labelNames:["topicStr"]}),meshPeerCounts:e.gauge({name:"gossipsub_mesh_peer_count",help:"Number of peers in our mesh",labelNames:["topicStr"]}),meshPeerInclusionEventsFanout:e.gauge({name:"gossipsub_mesh_peer_inclusion_events_fanout_total",help:"Number of times we include peers in a topic mesh for fanout reasons",labelNames:["topic"]}),meshPeerInclusionEventsRandom:e.gauge({name:"gossipsub_mesh_peer_inclusion_events_random_total",help:"Number of times we include peers in a topic mesh for random reasons",labelNames:["topic"]}),meshPeerInclusionEventsSubscribed:e.gauge({name:"gossipsub_mesh_peer_inclusion_events_subscribed_total",help:"Number of times we include peers in a topic mesh for subscribed reasons",labelNames:["topic"]}),meshPeerInclusionEventsOutbound:e.gauge({name:"gossipsub_mesh_peer_inclusion_events_outbound_total",help:"Number of times we include peers in a topic mesh for outbound reasons",labelNames:["topic"]}),meshPeerInclusionEventsNotEnough:e.gauge({name:"gossipsub_mesh_peer_inclusion_events_not_enough_total",help:"Number of times we include peers in a topic mesh for not_enough reasons",labelNames:["topic"]}),meshPeerInclusionEventsOpportunistic:e.gauge({name:"gossipsub_mesh_peer_inclusion_events_opportunistic_total",help:"Number of times we include peers in a topic mesh for opportunistic reasons",labelNames:["topic"]}),meshPeerInclusionEventsUnknown:e.gauge({name:"gossipsub_mesh_peer_inclusion_events_unknown_total",help:"Number of times we include peers in a topic mesh for unknown reasons",labelNames:["topic"]}),meshPeerChurnEventsDisconnected:e.gauge({name:"gossipsub_peer_churn_events_disconnected_total",help:"Number of times we remove peers in a topic mesh for disconnected reasons",labelNames:["topic"]}),meshPeerChurnEventsBadScore:e.gauge({name:"gossipsub_peer_churn_events_bad_score_total",help:"Number of times we remove peers in a topic mesh for bad_score reasons",labelNames:["topic"]}),meshPeerChurnEventsPrune:e.gauge({name:"gossipsub_peer_churn_events_prune_total",help:"Number of times we remove peers in a topic mesh for prune reasons",labelNames:["topic"]}),meshPeerChurnEventsExcess:e.gauge({name:"gossipsub_peer_churn_events_excess_total",help:"Number of times we remove peers in a topic mesh for excess reasons",labelNames:["topic"]}),meshPeerChurnEventsUnknown:e.gauge({name:"gossipsub_peer_churn_events_unknown_total",help:"Number of times we remove peers in a topic mesh for unknown reasons",labelNames:["topic"]}),peersPerProtocol:e.gauge({name:"gossipsub_peers_per_protocol_count",help:"Peers connected for each topic",labelNames:["protocol"]}),heartbeatDuration:e.histogram({name:"gossipsub_heartbeat_duration_seconds",help:"The time it takes to complete one iteration of the heartbeat",buckets:[.01,.1,1]}),heartbeatSkipped:e.gauge({name:"gossipsub_heartbeat_skipped",help:"Heartbeat run took longer than heartbeat interval so next is skipped"}),acceptedMessagesTotal:e.gauge({name:"gossipsub_accepted_messages_total",help:"Total accepted messages for each topic",labelNames:["topic"]}),ignoredMessagesTotal:e.gauge({name:"gossipsub_ignored_messages_total",help:"Total ignored messages for each topic",labelNames:["topic"]}),rejectedMessagesTotal:e.gauge({name:"gossipsub_rejected_messages_total",help:"Total rejected messages for each topic",labelNames:["topic"]}),unknownValidationResultsTotal:e.gauge({name:"gossipsub_unknown_validation_results_total",help:"Total unknown validation results for each topic",labelNames:["topic"]}),asyncValidationMcacheHit:e.gauge({name:"gossipsub_async_validation_mcache_hit_total",help:"Async validation result reported by the user layer",labelNames:["hit"]}),asyncValidationDelayFromFirstSeenSec:e.histogram({name:"gossipsub_async_validation_delay_from_first_seen",help:"Async validation report delay from first seen in second",labelNames:["topic"],buckets:[.01,.03,.1,.3,1,3,10]}),asyncValidationUnknownFirstSeen:e.gauge({name:"gossipsub_async_validation_unknown_first_seen_count_total",help:"Async validation report unknown first seen value for message"}),peerReadStreamError:e.gauge({name:"gossipsub_peer_read_stream_err_count_total",help:"Peer read stream error"}),rpcRecvBytes:e.gauge({name:"gossipsub_rpc_recv_bytes_total",help:"RPC recv"}),rpcRecvCount:e.gauge({name:"gossipsub_rpc_recv_count_total",help:"RPC recv"}),rpcRecvSubscription:e.gauge({name:"gossipsub_rpc_recv_subscription_total",help:"RPC recv"}),rpcRecvMessage:e.gauge({name:"gossipsub_rpc_recv_message_total",help:"RPC recv"}),rpcRecvControl:e.gauge({name:"gossipsub_rpc_recv_control_total",help:"RPC recv"}),rpcRecvIHave:e.gauge({name:"gossipsub_rpc_recv_ihave_total",help:"RPC recv"}),rpcRecvIWant:e.gauge({name:"gossipsub_rpc_recv_iwant_total",help:"RPC recv"}),rpcRecvGraft:e.gauge({name:"gossipsub_rpc_recv_graft_total",help:"RPC recv"}),rpcRecvPrune:e.gauge({name:"gossipsub_rpc_recv_prune_total",help:"RPC recv"}),rpcDataError:e.gauge({name:"gossipsub_rpc_data_err_count_total",help:"RPC data error"}),rpcRecvError:e.gauge({name:"gossipsub_rpc_recv_err_count_total",help:"RPC recv error"}),rpcRecvNotAccepted:e.gauge({name:"gossipsub_rpc_rcv_not_accepted_total",help:"Total count of RPC dropped because acceptFrom() == false"}),rpcSentBytes:e.gauge({name:"gossipsub_rpc_sent_bytes_total",help:"RPC sent"}),rpcSentCount:e.gauge({name:"gossipsub_rpc_sent_count_total",help:"RPC sent"}),rpcSentSubscription:e.gauge({name:"gossipsub_rpc_sent_subscription_total",help:"RPC sent"}),rpcSentMessage:e.gauge({name:"gossipsub_rpc_sent_message_total",help:"RPC sent"}),rpcSentControl:e.gauge({name:"gossipsub_rpc_sent_control_total",help:"RPC sent"}),rpcSentIHave:e.gauge({name:"gossipsub_rpc_sent_ihave_total",help:"RPC sent"}),rpcSentIWant:e.gauge({name:"gossipsub_rpc_sent_iwant_total",help:"RPC sent"}),rpcSentGraft:e.gauge({name:"gossipsub_rpc_sent_graft_total",help:"RPC sent"}),rpcSentPrune:e.gauge({name:"gossipsub_rpc_sent_prune_total",help:"RPC sent"}),msgPublishCount:e.gauge({name:"gossipsub_msg_publish_count_total",help:"Total count of msg published by topic",labelNames:["topic"]}),msgPublishPeersByTopic:e.gauge({name:"gossipsub_msg_publish_peers_total",help:"Total count of peers that we publish a msg to",labelNames:["topic"]}),directPeersPublishedTotal:e.gauge({name:"gossipsub_direct_peers_published_total",help:"Total direct peers that we publish a msg to",labelNames:["topic"]}),floodsubPeersPublishedTotal:e.gauge({name:"gossipsub_floodsub_peers_published_total",help:"Total floodsub peers that we publish a msg to",labelNames:["topic"]}),meshPeersPublishedTotal:e.gauge({name:"gossipsub_mesh_peers_published_total",help:"Total mesh peers that we publish a msg to",labelNames:["topic"]}),fanoutPeersPublishedTotal:e.gauge({name:"gossipsub_fanout_peers_published_total",help:"Total fanout peers that we publish a msg to",labelNames:["topic"]}),msgPublishBytes:e.gauge({name:"gossipsub_msg_publish_bytes_total",help:"Total count of msg publish data.length bytes",labelNames:["topic"]}),msgPublishTime:e.histogram({name:"gossipsub_msg_publish_seconds",help:"Total time in seconds to publish a message",buckets:[.001,.002,.005,.01,.1,.5,1],labelNames:["topic"]}),msgForwardCount:e.gauge({name:"gossipsub_msg_forward_count_total",help:"Total count of msg forwarded by topic",labelNames:["topic"]}),msgForwardPeers:e.gauge({name:"gossipsub_msg_forward_peers_total",help:"Total count of peers that we forward a msg to",labelNames:["topic"]}),msgReceivedPreValidation:e.gauge({name:"gossipsub_msg_received_prevalidation_total",help:"Total count of recv msgs before any validation",labelNames:["topic"]}),msgReceivedError:e.gauge({name:"gossipsub_msg_received_error_total",help:"Total count of recv msgs error",labelNames:["topic"]}),prevalidationInvalidTotal:e.gauge({name:"gossipsub_pre_validation_invalid_total",help:"Total count of invalid messages received",labelNames:["topic"]}),prevalidationValidTotal:e.gauge({name:"gossipsub_pre_validation_valid_total",help:"Total count of valid messages received",labelNames:["topic"]}),prevalidationDuplicateTotal:e.gauge({name:"gossipsub_pre_validation_duplicate_total",help:"Total count of duplicate messages received",labelNames:["topic"]}),prevalidationUnknownTotal:e.gauge({name:"gossipsub_pre_validation_unknown_status_total",help:"Total count of unknown_status messages received",labelNames:["topic"]}),msgReceivedInvalid:e.gauge({name:"gossipsub_msg_received_invalid_total",help:"Tracks specific reason of invalid",labelNames:["error"]}),msgReceivedInvalidByTopic:e.gauge({name:"gossipsub_msg_received_invalid_by_topic_total",help:"Tracks specific invalid message by topic",labelNames:["topic"]}),duplicateMsgDeliveryDelay:e.histogram({name:"gossisub_duplicate_msg_delivery_delay_seconds",help:"Time since the 1st duplicated message validated",labelNames:["topic"],buckets:[.25*n.maxMeshMessageDeliveriesWindowSec,.5*n.maxMeshMessageDeliveriesWindowSec,Number(n.maxMeshMessageDeliveriesWindowSec),2*n.maxMeshMessageDeliveriesWindowSec,4*n.maxMeshMessageDeliveriesWindowSec]}),duplicateMsgLateDelivery:e.gauge({name:"gossisub_duplicate_msg_late_delivery_total",help:"Total count of late duplicate message delivery by topic, which triggers P3 penalty",labelNames:["topic"]}),duplicateMsgIgnored:e.gauge({name:"gossisub_ignored_published_duplicate_msgs_total",help:"Total count of published duplicate message ignored by topic",labelNames:["topic"]}),scoreFnCalls:e.gauge({name:"gossipsub_score_fn_calls_total",help:"Total times score() is called"}),scoreFnRuns:e.gauge({name:"gossipsub_score_fn_runs_total",help:"Total times score() call actually computed computeScore(), no cache"}),scoreCachedDelta:e.histogram({name:"gossipsub_score_cache_delta",help:"Delta of score between cached values that expired",buckets:[10,100,1e3]}),peersByScoreThreshold:e.gauge({name:"gossipsub_peers_by_score_threshold_count",help:"Current count of peers by score threshold",labelNames:["threshold"]}),score:e.avgMinMax({name:"gossipsub_score",help:"Avg min max of gossip scores"}),scoreWeights:e.avgMinMax({name:"gossipsub_score_weights",help:"Separate score weights",labelNames:["topic","p"]}),scorePerMesh:e.avgMinMax({name:"gossipsub_score_per_mesh",help:"Histogram of the scores for each mesh topic",labelNames:["topic"]}),scoringPenalties:e.gauge({name:"gossipsub_scoring_penalties_total",help:"A counter of the kind of penalties being applied to peers",labelNames:["penalty"]}),behaviourPenalty:e.histogram({name:"gossipsub_peer_stat_behaviour_penalty",help:"Current peer stat behaviour_penalty at each scrape",buckets:[.25*n.behaviourPenaltyThreshold,.5*n.behaviourPenaltyThreshold,Number(n.behaviourPenaltyThreshold),2*n.behaviourPenaltyThreshold,4*n.behaviourPenaltyThreshold]}),ihaveRcvIgnored:e.gauge({name:"gossipsub_ihave_rcv_ignored_total",help:"Total received IHAVE messages that we ignore for some reason",labelNames:["reason"]}),ihaveRcvMsgids:e.gauge({name:"gossipsub_ihave_rcv_msgids_total",help:"Total received IHAVE messages by topic",labelNames:["topic"]}),ihaveRcvNotSeenMsgids:e.gauge({name:"gossipsub_ihave_rcv_not_seen_msgids_total",help:"Total messages per topic we do not have, not actual requests",labelNames:["topic"]}),iwantRcvMsgids:e.gauge({name:"gossipsub_iwant_rcv_msgids_total",help:"Total received IWANT messages by topic",labelNames:["topic"]}),iwantRcvDonthaveMsgids:e.gauge({name:"gossipsub_iwant_rcv_dont_have_msgids_total",help:"Total requested messageIDs that we do not have"}),iwantPromiseStarted:e.gauge({name:"gossipsub_iwant_promise_sent_total",help:"Total count of started IWANT promises"}),iwantPromiseResolved:e.gauge({name:"gossipsub_iwant_promise_resolved_total",help:"Total count of resolved IWANT promises"}),iwantPromiseResolvedFromDuplicate:e.gauge({name:"gossipsub_iwant_promise_resolved_from_duplicate_total",help:"Total count of resolved IWANT promises from duplicate messages"}),iwantPromiseResolvedPeers:e.gauge({name:"gossipsub_iwant_promise_resolved_peers",help:"Total count of peers we have asked IWANT promises that are resolved"}),iwantPromiseBroken:e.gauge({name:"gossipsub_iwant_promise_broken",help:"Total count of broken IWANT promises"}),iwantMessagePruned:e.gauge({name:"gossipsub_iwant_message_pruned",help:"Total count of pruned IWANT messages"}),iwantPromiseDeliveryTime:e.histogram({name:"gossipsub_iwant_promise_delivery_seconds",help:"Histogram of delivery time of resolved IWANT promises",buckets:[.5*n.gossipPromiseExpireSec,Number(n.gossipPromiseExpireSec),2*n.gossipPromiseExpireSec,4*n.gossipPromiseExpireSec]}),iwantPromiseUntracked:e.gauge({name:"gossip_iwant_promise_untracked",help:"Total count of untracked IWANT promise"}),connectedPeersBackoffSec:e.histogram({name:"gossipsub_connected_peers_backoff_seconds",help:"Backoff time in seconds",buckets:[1,2,4,10,20,60,120]}),cacheSize:e.gauge({name:"gossipsub_cache_size",help:"Unbounded cache sizes",labelNames:["cache"]}),mcacheSize:e.gauge({name:"gossipsub_mcache_size",help:"Current mcache msg count"}),mcacheNotValidatedCount:e.gauge({name:"gossipsub_mcache_not_validated_count",help:"Current mcache msg count not validated"}),fastMsgIdCacheCollision:e.gauge({name:"gossipsub_fastmsgid_cache_collision_total",help:"Total count of key collisions on fastmsgid cache put"}),newConnectionCount:e.gauge({name:"gossipsub_new_connection_total",help:"Total new connection by status",labelNames:["status"]}),topicStrToLabel:t,toTopic(e){var t;return null!==(t=this.topicStrToLabel.get(e))&&void 0!==t?t:e},onJoin(e){this.topicSubscriptionStatus.set({topicStr:e},1),this.meshPeerCounts.set({topicStr:e},0)},onLeave(e){this.topicSubscriptionStatus.set({topicStr:e},0),this.meshPeerCounts.set({topicStr:e},0)},onAddToMesh(e,t,n){const r=this.toTopic(e);switch(t){case c7.Fanout:this.meshPeerInclusionEventsFanout.inc({topic:r},n);break;case c7.Random:this.meshPeerInclusionEventsRandom.inc({topic:r},n);break;case c7.Subscribed:this.meshPeerInclusionEventsSubscribed.inc({topic:r},n);break;case c7.Outbound:this.meshPeerInclusionEventsOutbound.inc({topic:r},n);break;case c7.NotEnough:this.meshPeerInclusionEventsNotEnough.inc({topic:r},n);break;case c7.Opportunistic:this.meshPeerInclusionEventsOpportunistic.inc({topic:r},n);break;default:this.meshPeerInclusionEventsUnknown.inc({topic:r},n)}},onRemoveFromMesh(e,t,n){const r=this.toTopic(e);switch(t){case l7.Dc:this.meshPeerChurnEventsDisconnected.inc({topic:r},n);break;case l7.BadScore:this.meshPeerChurnEventsBadScore.inc({topic:r},n);break;case l7.Prune:this.meshPeerChurnEventsPrune.inc({topic:r},n);break;case l7.Excess:this.meshPeerChurnEventsExcess.inc({topic:r},n);break;default:this.meshPeerChurnEventsUnknown.inc({topic:r},n)}},onReportValidation(e,t,n){if(this.asyncValidationMcacheHit.inc({hit:null!=e?"hit":"miss"}),null!=e){const n=this.toTopic(e.message.topic);switch(t){case _4.Accept:this.acceptedMessagesTotal.inc({topic:n});break;case _4.Ignore:this.ignoredMessagesTotal.inc({topic:n});break;case _4.Reject:this.rejectedMessagesTotal.inc({topic:n});break;default:this.unknownValidationResultsTotal.inc({topic:n})}}null!=n?this.asyncValidationDelayFromFirstSeenSec.observe((Date.now()-n)/1e3):this.asyncValidationUnknownFirstSeen.inc()},onScorePenalty(e){this.scoringPenalties.inc({penalty:e},1)},onIhaveRcv(e,t,n){const r=this.toTopic(e);this.ihaveRcvMsgids.inc({topic:r},t),this.ihaveRcvNotSeenMsgids.inc({topic:r},n)},onIwantRcv(e,t){for(const[n,r]of e){const e=this.toTopic(n);this.iwantRcvMsgids.inc({topic:e},r)}this.iwantRcvDonthaveMsgids.inc(t)},onForwardMsg(e,t){const n=this.toTopic(e);this.msgForwardCount.inc({topic:n},1),this.msgForwardPeers.inc({topic:n},t)},onPublishMsg(e,t,n,r,i){const o=this.toTopic(e);this.msgPublishCount.inc({topic:o},1),this.msgPublishBytes.inc({topic:o},n*r),this.msgPublishPeersByTopic.inc({topic:o},n),this.directPeersPublishedTotal.inc({topic:o},t.direct),this.floodsubPeersPublishedTotal.inc({topic:o},t.floodsub),this.meshPeersPublishedTotal.inc({topic:o},t.mesh),this.fanoutPeersPublishedTotal.inc({topic:o},t.fanout),this.msgPublishTime.observe({topic:o},i/1e3)},onMsgRecvPreValidation(e){const t=this.toTopic(e);this.msgReceivedPreValidation.inc({topic:t},1)},onMsgRecvError(e){const t=this.toTopic(e);this.msgReceivedError.inc({topic:t},1)},onPrevalidationResult(e,t){const n=this.toTopic(e);switch(t){case s7.duplicate:this.prevalidationDuplicateTotal.inc({topic:n});break;case s7.invalid:this.prevalidationInvalidTotal.inc({topic:n});break;case s7.valid:this.prevalidationValidTotal.inc({topic:n});break;default:this.prevalidationUnknownTotal.inc({topic:n})}},onMsgRecvInvalid(e,t){const n=this.toTopic(e),r=t.reason===i7.Error?t.error:t.reason;this.msgReceivedInvalid.inc({error:r},1),this.msgReceivedInvalidByTopic.inc({topic:n},1)},onDuplicateMsgDelivery(e,t,n){if(this.duplicateMsgDeliveryDelay.observe(t/1e3),n){const t=this.toTopic(e);this.duplicateMsgLateDelivery.inc({topic:t},1)}},onPublishDuplicateMsg(e){const t=this.toTopic(e);this.duplicateMsgIgnored.inc({topic:t},1)},onPeerReadStreamError(){this.peerReadStreamError.inc(1)},onRpcRecvError(){this.rpcRecvError.inc(1)},onRpcDataError(){this.rpcDataError.inc(1)},onRpcRecv(e,t){this.rpcRecvBytes.inc(t),this.rpcRecvCount.inc(1),null!=e.subscriptions&&this.rpcRecvSubscription.inc(e.subscriptions.length),null!=e.messages&&this.rpcRecvMessage.inc(e.messages.length),null!=e.control&&(this.rpcRecvControl.inc(1),null!=e.control.ihave&&this.rpcRecvIHave.inc(e.control.ihave.length),null!=e.control.iwant&&this.rpcRecvIWant.inc(e.control.iwant.length),null!=e.control.graft&&this.rpcRecvGraft.inc(e.control.graft.length),null!=e.control.prune&&this.rpcRecvPrune.inc(e.control.prune.length))},onRpcSent(e,t){if(this.rpcSentBytes.inc(t),this.rpcSentCount.inc(1),null!=e.subscriptions&&this.rpcSentSubscription.inc(e.subscriptions.length),null!=e.messages&&this.rpcSentMessage.inc(e.messages.length),null!=e.control){var n,r,i,o,s,a,c,l;const t=null!==(n=null===(r=e.control.ihave)||void 0===r?void 0:r.length)&&void 0!==n?n:0,u=null!==(i=null===(o=e.control.iwant)||void 0===o?void 0:o.length)&&void 0!==i?i:0,h=null!==(s=null===(a=e.control.graft)||void 0===a?void 0:a.length)&&void 0!==s?s:0,d=null!==(c=null===(l=e.control.prune)||void 0===l?void 0:l.length)&&void 0!==c?c:0;t>0&&this.rpcSentIHave.inc(t),u>0&&this.rpcSentIWant.inc(u),h>0&&this.rpcSentGraft.inc(h),d>0&&this.rpcSentPrune.inc(d),(t>0||u>0||h>0||d>0)&&this.rpcSentControl.inc(1)}},registerScores(e,t){let n=0,r=0,i=0,o=0;for(const s of e)s>=t.graylistThreshold&&n++,s>=t.publishThreshold&&r++,s>=t.gossipThreshold&&i++,s>=0&&o++;this.peersByScoreThreshold.set({threshold:d7.graylist},n),this.peersByScoreThreshold.set({threshold:d7.publish},r),this.peersByScoreThreshold.set({threshold:d7.gossip},i),this.peersByScoreThreshold.set({threshold:d7.mesh},o),this.score.set(e)},registerScoreWeights(e){for(const[t,n]of e.byTopic)this.scoreWeights.set({topic:t,p:"p1"},n.p1w),this.scoreWeights.set({topic:t,p:"p2"},n.p2w),this.scoreWeights.set({topic:t,p:"p3"},n.p3w),this.scoreWeights.set({topic:t,p:"p3b"},n.p3bw),this.scoreWeights.set({topic:t,p:"p4"},n.p4w);this.scoreWeights.set({p:"p5"},e.p5w),this.scoreWeights.set({p:"p6"},e.p6w),this.scoreWeights.set({p:"p7"},e.p7w)},registerScorePerMesh(e,t){const n=new Map;e.forEach(((e,t)=>{var r;const i=null!==(r=this.topicStrToLabel.get(t))&&void 0!==r?r:"unknown";let o=n.get(i);null==o&&(o=new Set,n.set(i,o)),e.forEach((e=>{var t;return null===(t=o)||void 0===t?void 0:t.add(e)}))}));for(const[r,i]of n){const e=[];i.forEach((n=>{var r;e.push(null!==(r=t.get(n))&&void 0!==r?r:0)})),this.scorePerMesh.set({topic:r},e)}}}}(s.metricsRegister,s.metricsTopicStrToLabel,{gossipPromiseExpireSec:this.opts.gossipsubIWantFollowupMs/1e3,behaviourPenaltyThreshold:a.scoreParams.behaviourPenaltyThreshold,maxMeshMessageDeliveriesWindowSec:e/1e3});t.mcacheSize.addCollect((()=>{this.onScrapeMetrics(t)}));for(const n of this.multicodecs)t.protocolsEnabled.set({protocol:n},1);this.metrics=t}else this.metrics=null;this.gossipTracer=new F7(this.opts.gossipsubIWantFollowupMs,this.msgIdToStrFn,this.metrics),this.score=new R7(this.opts.scoreParams,this.metrics,{scoreCacheValidityMs:a.heartbeatInterval}),this.maxInboundStreams=s.maxInboundStreams,this.maxOutboundStreams=s.maxOutboundStreams,this.allowedTopics=null!=a.allowedTopics?new Set(a.allowedTopics):null}getPeers(){return[...this.peers.keys()].map((e=>S8(e)))}isStarted(){return this.status.code===Xte.started}async start(){if(this.isStarted())return;this.log("starting"),this.publishConfig=await async function(e,t){switch(e){case A4:{if(null==t)throw Error("Must provide PeerId");if(null==t.privateKey)throw Error("Cannot sign message, no private key present");if(null==t.publicKey)throw Error("Cannot sign message, no public key present");const e=await D9(t.privateKey);return{type:r7.Signing,author:t,key:t.publicKey,privateKey:e}}case S4:return{type:r7.Anonymous};default:throw new Error('Unknown signature policy "'.concat(e,'"'))}}(this.globalSignaturePolicy,this.components.peerId),this.outboundInflightQueue=k8({objectMode:!0}),P8(this.outboundInflightQueue,(async e=>{for await(const{peerId:t,connection:n}of e)await this.createOutboundStream(t,n)})).catch((e=>{this.log.error("outbound inflight queue error",e)})),await Promise.all(this.opts.directPeers.map((async e=>{await this.components.peerStore.merge(e.id,{multiaddrs:e.addrs})})));const e=this.components.registrar;await Promise.all(this.multicodecs.map((async t=>e.handle(t,this.onIncomingStream.bind(this),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams}))));const t={onConnect:this.onPeerConnected.bind(this),onDisconnect:this.onPeerDisconnected.bind(this)},n=await Promise.all(this.multicodecs.map((async n=>e.register(n,t)))),r=setTimeout(this.runHeartbeat,100);this.status={code:Xte.started,registrarTopologyIds:n,heartbeatTimeout:r,hearbeatStartMs:Date.now()+100},this.score.start(),this.directPeerInitial=setTimeout((()=>{Promise.resolve().then((async()=>{await Promise.all(Array.from(this.direct).map((async e=>this.connect(e))))})).catch((e=>{this.log(e)}))}),1e3),this.log("started")}async stop(){if(this.log("stopping"),this.status.code!==Xte.started)return;const{registrarTopologyIds:e}=this.status;this.status={code:Xte.stopped};const t=this.components.registrar;await Promise.all(this.multicodecs.map((async e=>t.unhandle(e)))),e.forEach((e=>{t.unregister(e)})),this.outboundInflightQueue.end();const n=[];for(const r of this.streamsOutbound.values())n.push(r.close());this.streamsOutbound.clear();for(const r of this.streamsInbound.values())n.push(r.close());this.streamsInbound.clear(),await Promise.all(n),this.peers.clear(),this.subscriptions.clear(),null!=this.heartbeatTimer&&(this.heartbeatTimer.cancel(),this.heartbeatTimer=null),this.score.stop(),this.mesh.clear(),this.fanout.clear(),this.fanoutLastpub.clear(),this.gossip.clear(),this.control.clear(),this.peerhave.clear(),this.iasked.clear(),this.backoff.clear(),this.outbound.clear(),this.gossipTracer.clear(),this.seenCache.clear(),null!=this.fastMsgIdCache&&this.fastMsgIdCache.clear(),null!=this.directPeerInitial&&clearTimeout(this.directPeerInitial),this.log("stopped")}dumpPeerScoreStats(){return this.score.dumpPeerScoreStats()}onIncomingStream(e){let{stream:t,connection:n}=e;if(!this.isStarted())return;const r=n.remotePeer;this.addPeer(r,n.direction,n.remoteAddr),this.createInboundStream(r,t),this.outboundInflightQueue.push({peerId:r,connection:n})}onPeerConnected(e,t){var n;null===(n=this.metrics)||void 0===n||n.newConnectionCount.inc({status:t.status}),this.isStarted()&&"open"===t.status&&(this.addPeer(e,t.direction,t.remoteAddr),this.outboundInflightQueue.push({peerId:e,connection:t}))}onPeerDisconnected(e){this.log("connection ended %p",e),this.removePeer(e)}async createOutboundStream(e,t){if(!this.isStarted())return;const n=e.toString();if(this.peers.has(n)&&!this.streamsOutbound.has(n))try{var r;const i=new M7(await t.newStream(this.multicodecs),(e=>{this.log.error("outbound pipe error",e)}),{maxBufferSize:this.opts.maxOutboundBufferSize});this.log("create outbound stream %p",e),this.streamsOutbound.set(n,i);const o=i.protocol;o===M8&&this.floodsubPeers.add(n),null===(r=this.metrics)||void 0===r||r.peersPerProtocol.inc({protocol:o},1),this.subscriptions.size>0&&(this.log("send subscriptions to",n),this.sendSubscriptions(n,Array.from(this.subscriptions),!0))}catch(i){this.log.error("createOutboundStream error",i)}}createInboundStream(e,t){if(!this.isStarted())return;const n=e.toString();if(!this.peers.has(n))return;const r=this.streamsInbound.get(n);void 0!==r&&(this.log("replacing existing inbound steam %s",n),r.close().catch((e=>{this.log.error(e)}))),this.log("create inbound stream %s",n);const i=new U7(t,{maxDataLength:this.opts.maxInboundDataLength});this.streamsInbound.set(n,i),this.pipePeerReadStream(e,i.source).catch((e=>{this.log(e)}))}addPeer(e,t,n){const r=e.toString();if(!this.peers.has(r)){this.log("new peer %p",e),this.peers.add(r),this.score.addPeer(r);const i=function(e){for(const t of e.tuples())switch(t[0]){case Qte.ip4:case Qte.ip6:return(0,Yte.xV)(t[0],t[1])}return null}(n);null!==i?this.score.addIP(r,i):this.log("Added peer has no IP in current address %s %s",r,n.toString()),this.outbound.has(r)||this.outbound.set(r,"outbound"===t)}}removePeer(e){const t=e.toString();if(!this.peers.has(t))return;this.log("delete peer %p",e),this.peers.delete(t);const n=this.streamsOutbound.get(t),r=this.streamsInbound.get(t);var i;null!=n&&(null===(i=this.metrics)||void 0===i||i.peersPerProtocol.inc({protocol:n.protocol},-1));null===n||void 0===n||n.close().catch((e=>{this.log.error(e)})),null===r||void 0===r||r.close().catch((e=>{this.log.error(e)})),this.streamsOutbound.delete(t),this.streamsInbound.delete(t);for(const s of this.topics.values())s.delete(t);for(const[s,a]of this.mesh){var o;if(a.delete(t))null===(o=this.metrics)||void 0===o||o.onRemoveFromMesh(s,l7.Dc,1)}for(const s of this.fanout.values())s.delete(t);this.floodsubPeers.delete(t),this.gossip.delete(t),this.control.delete(t),this.outbound.delete(t),this.score.removePeer(t),this.acceptFromWhitelist.delete(t)}get started(){return this.status.code===Xte.started}getMeshPeers(e){const t=this.mesh.get(e);return null!=t?Array.from(t):[]}getSubscribers(e){const t=this.topics.get(e);return(null!=t?Array.from(t):[]).map((e=>S8(e)))}getTopics(){return Array.from(this.subscriptions)}async pipePeerReadStream(e,t){try{await P8(t,(async t=>{for await(const a of t)try{var n;const t=a.subarray(),i=V8(t,this.decodeRpcLimits);if(null===(n=this.metrics)||void 0===n||n.onRpcRecv(i,t.length),this.opts.awaitRpcHandler)try{await this.handleReceivedRpc(e,i)}catch(o){var r;null===(r=this.metrics)||void 0===r||r.onRpcRecvError(),this.log(o)}else this.handleReceivedRpc(e,i).catch((e=>{var t;null===(t=this.metrics)||void 0===t||t.onRpcRecvError(),this.log(e)}))}catch(s){var i;null===(i=this.metrics)||void 0===i||i.onRpcDataError(),this.log(s)}}))}catch(r){var n;null===(n=this.metrics)||void 0===n||n.onPeerReadStreamError(),this.handlePeerReadStreamError(r,e)}}handlePeerReadStreamError(e,t){this.log.error(e),this.onPeerDisconnected(t)}async handleReceivedRpc(e,t){var n;if(!this.acceptFrom(e.toString()))return this.log("received message from unacceptable peer %p",e),void(null===(n=this.metrics)||void 0===n||n.rpcRecvNotAccepted.inc());const r=null!=t.subscriptions?t.subscriptions.length:0,i=null!=t.messages?t.messages.length:0;let o=0,s=0,a=0,c=0;if(null!=t.control&&(null!=t.control.ihave&&(o=t.control.ihave.length),null!=t.control.iwant&&(s=t.control.iwant.length),null!=t.control.graft&&(a=t.control.graft.length),null!=t.control.prune&&(c=t.control.prune.length)),this.log("rpc.from ".concat(e.toString()," subscriptions ").concat(r," messages ").concat(i," ihave ").concat(o," iwant ").concat(s," graft ").concat(a," prune ").concat(c)),null!=t.subscriptions&&t.subscriptions.length>0){const n=[];t.subscriptions.forEach((t=>{const r=t.topic,i=!0===t.subscribe;if(null!=r){if(null!=this.allowedTopics&&!this.allowedTopics.has(r))return;this.handleReceivedSubscription(e,r,i),n.push({topic:r,subscribe:i})}})),this.safeDispatchEvent("subscription-change",{detail:{peerId:e,subscriptions:n}})}if(null!=t.messages)for(const l of t.messages){if(null!=this.allowedTopics&&!this.allowedTopics.has(l.topic))continue;const t=this.handleReceivedMessage(e,l).catch((e=>{var t;null===(t=this.metrics)||void 0===t||t.onMsgRecvError(l.topic),this.log(e)}));this.opts.awaitRpcMessageHandler&&await t}null!=t.control&&await this.handleControlMessage(e.toString(),t.control)}handleReceivedSubscription(e,t,n){this.log("subscription update from %p topic %s",e,t);let r=this.topics.get(t);null==r&&(r=new Set,this.topics.set(t,r)),n?r.add(e.toString()):r.delete(e.toString())}async handleReceivedMessage(e,t){var n,r,i;null===(n=this.metrics)||void 0===n||n.onMsgRecvPreValidation(t.topic);const o=await this.validateReceivedMessage(e,t);null===(r=this.metrics)||void 0===r||r.onPrevalidationResult(t.topic,o.code);const s=o.code;switch(s){case s7.duplicate:return this.score.duplicateMessage(e.toString(),o.msgIdStr,t.topic),this.gossipTracer.deliverMessage(o.msgIdStr,!0),void this.mcache.observeDuplicate(o.msgIdStr,e.toString());case s7.invalid:if(null!=o.msgIdStr){const n=o.msgIdStr;this.score.rejectMessage(e.toString(),n,t.topic,o.reason),this.gossipTracer.rejectMessage(n,o.reason)}else this.score.rejectInvalidMessage(e.toString(),t.topic);return void(null===(i=this.metrics)||void 0===i||i.onMsgRecvInvalid(t.topic,o));case s7.valid:if(this.score.validateMessage(o.messageId.msgIdStr),this.gossipTracer.deliverMessage(o.messageId.msgIdStr),this.mcache.put(o.messageId,t,!this.opts.asyncValidation),this.subscriptions.has(t.topic)){this.components.peerId.equals(e)&&!this.opts.emitSelf||(super.dispatchEvent(new E4("gossipsub:message",{detail:{propagationSource:e,msgId:o.messageId.msgIdStr,msg:o.msg}})),super.dispatchEvent(new E4("message",{detail:o.msg})))}this.opts.asyncValidation||this.forwardMessage(o.messageId.msgIdStr,t,e.toString());break;default:throw new Error("Invalid validation result: ".concat(s))}}async validateReceivedMessage(e,t){var n,r;const i=null===(n=this.fastMsgIdFn)||void 0===n?void 0:n.call(this,t),o=void 0!==i?null===(r=this.fastMsgIdCache)||void 0===r?void 0:r.get(i):void 0;if(null!=o)return{code:s7.duplicate,msgIdStr:o};const s=await async function(e,t){var n;switch(e){case S4:return null!=t.signature?{valid:!1,error:o7.SignaturePresent}:null!=t.seqno?{valid:!1,error:o7.SeqnoPresent}:null!=t.key?{valid:!1,error:o7.FromPresent}:{valid:!0,message:{type:"unsigned",topic:t.topic,data:null!==(n=t.data)&&void 0!==n?n:new Uint8Array(0)}};case A4:{var r,i;if(null==t.seqno)return{valid:!1,error:o7.InvalidSeqno};if(8!==t.seqno.length)return{valid:!1,error:o7.InvalidSeqno};if(null==t.signature)return{valid:!1,error:o7.InvalidSignature};if(null==t.from)return{valid:!1,error:o7.InvalidPeerId};let e,n;try{e=_8(t.from)}catch(o){return{valid:!1,error:o7.InvalidPeerId}}if(null!=t.key){if(n=x9(t.key),void 0!==e.publicKey&&!(0,Ms.f)(n.bytes,e.publicKey))return{valid:!1,error:o7.InvalidPeerId}}else{if(null==e.publicKey)return{valid:!1,error:o7.InvalidPeerId};n=x9(e.publicKey)}const s={from:t.from,data:t.data,seqno:t.seqno,topic:t.topic,signature:void 0,key:void 0},a=(0,Ls.z)([O9,e7.Message.encode(s).finish()]);return await n.verify(a,t.signature)?{valid:!0,message:{type:"signed",from:e,data:null!==(r=t.data)&&void 0!==r?r:new Uint8Array(0),sequenceNumber:BigInt("0x".concat((0,Au.B)(t.seqno,"base16"))),topic:t.topic,signature:t.signature,key:null!==(i=t.key)&&void 0!==i?i:P9(n)}}:{valid:!1,error:o7.InvalidSignature}}default:throw new Error("Unreachable")}}(this.globalSignaturePolicy,t);if(!s.valid)return{code:s7.invalid,reason:i7.Error,error:s.error};const a=s.message;try{null!=this.dataTransform&&(a.data=this.dataTransform.inboundTransform(t.topic,a.data))}catch(f){return this.log("Invalid message, transform failed",f),{code:s7.invalid,reason:i7.Error,error:o7.TransformFailed}}const c=await this.msgIdFn(a),l=this.msgIdToStrFn(c),u={msgId:c,msgIdStr:l};if(void 0!==i&&null!=this.fastMsgIdCache){var h;if(this.fastMsgIdCache.put(i,l))null===(h=this.metrics)||void 0===h||h.fastMsgIdCacheCollision.inc()}if(this.seenCache.has(l))return{code:s7.duplicate,msgIdStr:l};this.seenCache.put(l);const d=this.topicValidators.get(t.topic);if(null!=d){let t;try{t=await d(e,a)}catch(f){const e=f.code;"ERR_TOPIC_VALIDATOR_IGNORE"===e&&(t=_4.Ignore),t="ERR_TOPIC_VALIDATOR_REJECT"===e?_4.Reject:_4.Ignore}if(t!==_4.Accept)return{code:s7.invalid,reason:f7(t),msgIdStr:l}}return{code:s7.valid,messageId:u,msg:a}}getScore(e){return this.score.score(e)}sendSubscriptions(e,t,n){this.sendRpc(e,{subscriptions:t.map((e=>({topic:e,subscribe:n})))})}async handleControlMessage(e,t){var n;if(void 0===t)return;const r=null!=t.ihave?this.handleIHave(e,t.ihave):[],i=null!=t.iwant?this.handleIWant(e,t.iwant):[],o=null!=t.graft?await this.handleGraft(e,t.graft):[];if(null!=t.prune&&await this.handlePrune(e,t.prune),0===r.length&&0===i.length&&0===o.length)return;const s=this.sendRpc(e,{messages:i,control:{iwant:r,prune:o}}),a=null===(n=r[0])||void 0===n?void 0:n.messageIDs;var c;null!=a&&(s?this.gossipTracer.addPromise(e,a):null===(c=this.metrics)||void 0===c||c.iwantPromiseUntracked.inc(1))}acceptFrom(e){if(this.direct.has(e))return!0;const t=Date.now(),n=this.acceptFromWhitelist.get(e);if(null!=n&&n.messagesAccepted<128&&n.acceptUntil>=t)return n.messagesAccepted+=1,!0;const r=this.score.score(e);return r>=0?this.acceptFromWhitelist.set(e,{messagesAccepted:0,acceptUntil:t+1e3}):this.acceptFromWhitelist.delete(e),r>=this.opts.scoreThresholds.graylistThreshold}handleIHave(e,t){var n,r;if(0===t.length)return[];const i=this.score.score(e);var o;if(i<this.opts.scoreThresholds.gossipThreshold)return this.log("IHAVE: ignoring peer %s with score below threshold [ score = %d ]",e,i),null===(o=this.metrics)||void 0===o||o.ihaveRcvIgnored.inc({reason:h7.LowScore}),[];const s=(null!==(n=this.peerhave.get(e))&&void 0!==n?n:0)+1;var a;if(this.peerhave.set(e,s),s>10)return this.log("IHAVE: peer %s has advertised too many times (%d) within this heartbeat interval; ignoring",e,s),null===(a=this.metrics)||void 0===a||a.ihaveRcvIgnored.inc({reason:h7.MaxIhave}),[];const c=null!==(r=this.iasked.get(e))&&void 0!==r?r:0;var l;if(c>=K8)return this.log("IHAVE: peer %s has already advertised too many messages (%d); ignoring",e,c),null===(l=this.metrics)||void 0===l||l.ihaveRcvIgnored.inc({reason:h7.MaxIasked}),[];const u=new Map;if(t.forEach((e=>{var t;let{topicID:n,messageIDs:r}=e;if(null==n||null==r||!this.mesh.has(n))return;let i=0;r.forEach((e=>{const t=this.msgIdToStrFn(e);this.seenCache.has(t)||(u.set(t,e),i++)})),null===(t=this.metrics)||void 0===t||t.onIhaveRcv(n,r.length,i)})),0===u.size)return[];let h=u.size;h+c>K8&&(h=K8-c),this.log("IHAVE: Asking for %d out of %d messages from %s",h,u.size,e);let d=Array.from(u.values());return N9(d),d=d.slice(0,h),this.iasked.set(e,c+h),[{messageIDs:d}]}handleIWant(e,t){var n;if(0===t.length)return[];const r=this.score.score(e);if(r<this.opts.scoreThresholds.gossipThreshold)return this.log("IWANT: ignoring peer %s with score below threshold [score = %d]",e,r),[];const i=new Map,o=new Map;let s=0;return t.forEach((t=>{let{messageIDs:n}=t;null===n||void 0===n||n.forEach((t=>{var n;const r=this.msgIdToStrFn(t),a=this.mcache.getWithIWantCount(r,e);null!=a?(o.set(a.msg.topic,1+(null!==(n=o.get(a.msg.topic))&&void 0!==n?n:0)),a.count>3?this.log("IWANT: Peer %s has asked for message %s too many times: ignoring request",e,t):i.set(r,a.msg)):s++}))})),null===(n=this.metrics)||void 0===n||n.onIwantRcv(o,s),0===i.size?(this.log("IWANT: Could not provide any wanted messages to %s",e),[]):(this.log("IWANT: Sending %d messages to %s",i.size,e),Array.from(i.values()))}async handleGraft(e,t){const n=[],r=this.score.score(e),i=Date.now();let o=this.opts.doPX;if(t.forEach((t=>{var s,a,c;let{topicID:l}=t;if(null==l)return;const u=this.mesh.get(l);if(null==u)return void(o=!1);if(u.has(e))return;if(this.direct.has(e))return this.log("GRAFT: ignoring request from direct peer %s",e),n.push(l),void(o=!1);const h=null===(s=this.backoff.get(l))||void 0===s?void 0:s.get(e);if("number"===typeof h&&i<h){this.log("GRAFT: ignoring backed off peer %s",e),this.score.addPenalty(e,1,u7.GraftBackoff),o=!1;const t=h+this.opts.graftFloodThreshold-this.opts.pruneBackoff;return i<t&&this.score.addPenalty(e,1,u7.GraftBackoff),this.addBackoff(e,l),void n.push(l)}return r<0?(this.log("GRAFT: ignoring peer %s with negative score: score=%d, topic=%s",e,r,l),n.push(l),o=!1,void this.addBackoff(e,l)):u.size>=this.opts.Dhi&&(null===(a=this.outbound.get(e))||void 0===a||!a)?(n.push(l),void this.addBackoff(e,l)):(this.log("GRAFT: Add mesh link from %s in %s",e,l),this.score.graft(e,l),u.add(e),void(null===(c=this.metrics)||void 0===c||c.onAddToMesh(l,c7.Subscribed,1)))})),0===n.length)return[];return Promise.all(n.map((async t=>this.makePrune(e,t,o,false))))}async handlePrune(e,t){const n=this.score.score(e);for(const{topicID:i,backoff:o,peers:s}of t){if(null==i)continue;const t=this.mesh.get(i);if(null==t)return;var r;if(this.log("PRUNE: Remove mesh link to %s in %s",e,i),this.score.prune(e,i),t.has(e))t.delete(e),null===(r=this.metrics)||void 0===r||r.onRemoveFromMesh(i,l7.Prune,1);if("number"===typeof o&&o>0?this.doAddBackoff(e,i,1e3*o):this.addBackoff(e,i),null!=s&&s.length>0){if(n<this.opts.scoreThresholds.acceptPXThreshold){this.log("PRUNE: ignoring PX from peer %s with insufficient score [score = %d, topic = %s]",e,n,i);continue}await this.pxConnect(s)}}}addBackoff(e,t){this.doAddBackoff(e,t,this.opts.pruneBackoff)}doAddBackoff(e,t,n){var r;let i=this.backoff.get(t);null==i&&(i=new Map,this.backoff.set(t,i));const o=Date.now()+n;(null!==(r=i.get(e))&&void 0!==r?r:0)<o&&i.set(e,o)}applyIwantPenalties(){this.gossipTracer.getBrokenPromises().forEach(((e,t)=>{this.log("peer %s didn't follow up in %d IWANT requests; adding penalty",t,e),this.score.addPenalty(t,e,u7.BrokenPromise)}))}clearBackoff(){if(this.heartbeatTicks%15!==0)return;const e=Date.now();this.backoff.forEach(((t,n)=>{t.forEach(((n,r)=>{n+1*this.opts.heartbeatInterval<e&&t.delete(r)})),0===t.size&&this.backoff.delete(n)}))}async directConnect(){const e=[];this.direct.forEach((t=>{this.streamsOutbound.has(t)||e.push(t)})),await Promise.all(e.map((async e=>this.connect(e))))}async pxConnect(e){e.length>this.opts.prunePeers&&(N9(e),e=e.slice(0,this.opts.prunePeers));const t=[];await Promise.all(e.map((async e=>{if(null==e.peerID)return;const n=_8(e.peerID),r=n.toString();if(!this.peers.has(r))if(null!=e.signedPeerRecord)try{if(!await this.components.peerStore.consumePeerRecord(e.signedPeerRecord,n))return void this.log("bogus peer record obtained through px: could not add peer record to address book");t.push(r)}catch(i){this.log("bogus peer record obtained through px: invalid signature or not a peer record")}else t.push(r)}))),0!==t.length&&await Promise.all(t.map((async e=>this.connect(e))))}async connect(e){this.log("Initiating connection with %s",e);const t=S8(e),n=await this.components.connectionManager.openConnection(t);for(const i of this.multicodecs)for(const e of this.components.registrar.getTopologies(i)){var r;null===(r=e.onConnect)||void 0===r||r.call(e,t,n)}}subscribe(e){if(this.status.code!==Xte.started)throw new Error("Pubsub has not started");if(!this.subscriptions.has(e)){this.subscriptions.add(e);for(const t of this.peers.keys())this.sendSubscriptions(t,[e],!0)}this.join(e)}unsubscribe(e){if(this.status.code!==Xte.started)throw new Error("Pubsub is not started");const t=this.subscriptions.delete(e);if(this.log("unsubscribe from %s - am subscribed %s",e,t),t)for(const n of this.peers.keys())this.sendSubscriptions(n,[e],!1);this.leave(e)}join(e){var t;if(this.status.code!==Xte.started)throw new Error("Gossipsub has not started");if(this.mesh.has(e))return;this.log("JOIN %s",e),null===(t=this.metrics)||void 0===t||t.onJoin(e);const n=new Set,r=this.backoff.get(e),i=this.fanout.get(e);var o;null!=i&&(this.fanout.delete(e),this.fanoutLastpub.delete(e),i.forEach((e=>{this.direct.has(e)||!(this.score.score(e)>=0)||null!=r&&r.has(e)||n.add(e)})),null===(o=this.metrics)||void 0===o||o.onAddToMesh(e,c7.Fanout,n.size));if(n.size<this.opts.D){var s;const t=n.size;this.getRandomGossipPeers(e,this.opts.D,(e=>!n.has(e)&&!this.direct.has(e)&&this.score.score(e)>=0&&(null==r||!r.has(e)))).forEach((e=>{n.add(e)})),null===(s=this.metrics)||void 0===s||s.onAddToMesh(e,c7.Random,n.size-t)}this.mesh.set(e,n),n.forEach((t=>{this.log("JOIN: Add mesh link to %s in %s",t,e),this.sendGraft(t,e)}))}leave(e){var t;if(this.status.code!==Xte.started)throw new Error("Gossipsub has not started");this.log("LEAVE %s",e),null===(t=this.metrics)||void 0===t||t.onLeave(e);const n=this.mesh.get(e);null!=n&&(Promise.all(Array.from(n).map((async t=>{this.log("LEAVE: Remove mesh link to %s in %s",t,e),await this.sendPrune(t,e)}))).catch((e=>{this.log("Error sending prunes to mesh peers",e)})),this.mesh.delete(e))}selectPeersToForward(e,t,n){const r=new Set,i=this.topics.get(e);null!=i&&(this.direct.forEach((e=>{var o;!i.has(e)||t===e||null!==(o=null===n||void 0===n?void 0:n.has(e))&&void 0!==o&&o||r.add(e)})),this.floodsubPeers.forEach((e=>{var o;i.has(e)&&t!==e&&(null===(o=null===n||void 0===n?void 0:n.has(e))||void 0===o||!o)&&this.score.score(e)>=this.opts.scoreThresholds.publishThreshold&&r.add(e)})));const o=this.mesh.get(e);return null!=o&&o.size>0&&o.forEach((e=>{var i;t===e||null!==(i=null===n||void 0===n?void 0:n.has(e))&&void 0!==i&&i||r.add(e)})),r}selectPeersToPublish(e){const t=new Set,n={direct:0,floodsub:0,mesh:0,fanout:0},r=this.topics.get(e);if(null!=r)if(this.opts.floodPublish)r.forEach((e=>{this.direct.has(e)?(t.add(e),n.direct++):this.score.score(e)>=this.opts.scoreThresholds.publishThreshold&&(t.add(e),n.floodsub++)}));else{this.direct.forEach((e=>{r.has(e)&&(t.add(e),n.direct++)})),this.floodsubPeers.forEach((e=>{r.has(e)&&this.score.score(e)>=this.opts.scoreThresholds.publishThreshold&&(t.add(e),n.floodsub++)}));const i=this.mesh.get(e);if(null!=i&&i.size>0)i.forEach((e=>{t.add(e),n.mesh++}));else{const r=this.fanout.get(e);if(null!=r&&r.size>0)r.forEach((e=>{t.add(e),n.fanout++}));else{const r=this.getRandomGossipPeers(e,this.opts.D,(e=>this.score.score(e)>=this.opts.scoreThresholds.publishThreshold));r.size>0&&(this.fanout.set(e,r),r.forEach((e=>{t.add(e),n.fanout++})))}this.fanoutLastpub.set(e,Date.now())}}return{tosend:t,tosendCount:n}}forwardMessage(e,t,n,r){var i;null!=n&&this.score.deliverMessage(n,e,t.topic);const o=this.selectPeersToForward(t.topic,n,r);o.forEach((e=>{this.sendRpc(e,{messages:[t]})})),null===(i=this.metrics)||void 0===i||i.onForwardMsg(t.topic,o.size)}async publish(e,t,n){var r,i,o;const s=Date.now(),a=null!=this.dataTransform?this.dataTransform.outboundTransform(e,t):t;if(null==this.publishConfig)throw Error("PublishError.Uninitialized");const{raw:c,msg:l}=await async function(e,t,n,r){switch(e.type){case r7.Signing:{const i={from:e.author.toBytes(),data:r,seqno:a9(8),topic:t,signature:void 0,key:void 0},o=(0,Ls.z)([O9,e7.Message.encode(i).finish()]);return i.signature=await e.privateKey.sign(o),i.key=e.key,{raw:i,msg:{type:"signed",from:e.author,data:n,sequenceNumber:BigInt("0x".concat((0,Au.B)(i.seqno,"base16"))),topic:t,signature:i.signature,key:i.key}}}case r7.Anonymous:return{raw:{from:void 0,data:r,seqno:void 0,topic:t,signature:void 0,key:void 0},msg:{type:"unsigned",data:n,topic:t}};default:throw new Error("Unreachable")}}(this.publishConfig,e,t,a),u=await this.msgIdFn(l),h=this.msgIdToStrFn(u),d=null!==(r=null===n||void 0===n?void 0:n.ignoreDuplicatePublishError)&&void 0!==r?r:this.opts.ignoreDuplicatePublishError;if(this.seenCache.has(h)){var f;if(d)return null===(f=this.metrics)||void 0===f||f.onPublishDuplicateMsg(e),{recipients:[]};throw Error("PublishError.Duplicate")}const{tosend:p,tosendCount:g}=this.selectPeersToPublish(e),y=this.opts.emitSelf&&this.subscriptions.has(e),m=null!==(i=null===n||void 0===n?void 0:n.allowPublishToZeroPeers)&&void 0!==i?i:this.opts.allowPublishToZeroPeers;if(0===p.size&&!m&&!y)throw Error("PublishError.InsufficientPeers");this.seenCache.put(h),this.mcache.put({msgId:u,msgIdStr:h},c,!0),this.publishedMessageIds.put(h);for(const b of p){this.sendRpc(b,{messages:[c]})||p.delete(b)}const v=Date.now()-s;return null===(o=this.metrics)||void 0===o||o.onPublishMsg(e,g,p.size,null!=c.data?c.data.length:0,v),y&&(p.add(this.components.peerId.toString()),super.dispatchEvent(new E4("gossipsub:message",{detail:{propagationSource:this.components.peerId,msgId:h,msg:l}})),super.dispatchEvent(new E4("message",{detail:l}))),{recipients:Array.from(p.values()).map((e=>S8(e)))}}reportMessageValidationResult(e,t,n){var r;let i;if(n===_4.Accept){if(i=this.mcache.validate(e),null!=i){const{message:n,originatingPeers:r}=i;this.score.deliverMessage(t,e,n.topic),this.forwardMessage(e,i.message,t,r)}}else if(i=this.mcache.remove(e),null!=i){const r=f7(n),{message:o,originatingPeers:s}=i;this.score.rejectMessage(t,e,o.topic,r);for(const t of s)this.score.rejectMessage(t,e,o.topic,r)}const o=this.score.messageFirstSeenTimestampMs(e);null===(r=this.metrics)||void 0===r||r.onReportValidation(i,n,o)}sendGraft(e,t){const n=[{topicID:t}];this.sendRpc(e,{control:{graft:n}})}async sendPrune(e,t){const n=[await this.makePrune(e,t,this.opts.doPX,!0)];this.sendRpc(e,{control:{prune:n}})}sendRpc(e,t){var n;const r=this.streamsOutbound.get(e);if(null==r)return this.log("Cannot send RPC to ".concat(e," as there is no open stream to it available")),!1;const i=this.control.get(e);null!=i&&(this.piggybackControl(e,t,i),this.control.delete(e));const o=this.gossip.get(e);null!=o&&(this.piggybackGossip(e,t,o),this.gossip.delete(e));const s=e7.encode(t).finish();try{r.push(s)}catch(a){return this.log.error("Cannot send rpc to ".concat(e),a),null!=i&&this.control.set(e,i),null!=o&&this.gossip.set(e,o),!1}return null===(n=this.metrics)||void 0===n||n.onRpcSent(t,s.length),!0}piggybackControl(e,t,n){if(null!=n.graft){null==t.control&&(t.control={}),null==t.control.graft&&(t.control.graft=[]);for(const o of n.graft){var r,i;null!=o.topicID&&null!==(r=null===(i=this.mesh.get(o.topicID))||void 0===i?void 0:i.has(e))&&void 0!==r&&r&&t.control.graft.push(o)}}if(null!=n.prune){null==t.control&&(t.control={}),null==t.control.prune&&(t.control.prune=[]);for(const r of n.prune){var o,s;null==r.topicID||null!==(o=null===(s=this.mesh.get(r.topicID))||void 0===s?void 0:s.has(e))&&void 0!==o&&o||t.control.prune.push(r)}}}piggybackGossip(e,t,n){null==t.control&&(t.control={}),t.control.ihave=n}async sendGraftPrune(e,t,n){const r=this.opts.doPX;for(const[i,o]of e){const e=o.map((e=>({topicID:e})));let s=[];const a=t.get(i);null!=a&&(s=await Promise.all(a.map((async e=>{var t;return this.makePrune(i,e,r&&!(null!==(t=n.get(i))&&void 0!==t&&t),false)}))),t.delete(i)),this.sendRpc(i,{control:{graft:e,prune:s}})}for(const[i,o]of t){const e=await Promise.all(o.map((async e=>{var t;return this.makePrune(i,e,r&&!(null!==(t=n.get(i))&&void 0!==t&&t),false)})));this.sendRpc(i,{control:{prune:e}})}}emitGossip(e){const t=this.mcache.getGossipIDs(new Set(e.keys()));for(const[r,i]of e){var n;this.doEmitGossip(r,i,null!==(n=t.get(r))&&void 0!==n?n:[])}}doEmitGossip(e,t,n){if(0===n.length)return;if(N9(n),n.length>K8&&this.log("too many messages for gossip; will truncate IHAVE list (%d messages)",n.length),0===t.size)return;let r=this.opts.Dlazy;const i=.25*t.size;let o=t;i>r&&(r=i),r>o.size?r=o.size:o=N9(Array.from(o)).slice(0,r),o.forEach((t=>{let r=n;n.length>K8&&(r=N9(r.slice()).slice(0,K8)),this.pushGossip(t,{topicID:e,messageIDs:r})}))}flush(){for(const[e,t]of this.gossip.entries())this.gossip.delete(e),this.sendRpc(e,{control:{ihave:t}});for(const[e,t]of this.control.entries())this.control.delete(e),this.sendRpc(e,{control:{graft:t.graft,prune:t.prune}})}pushGossip(e,t){var n;this.log("Add gossip to %s",e);const r=null!==(n=this.gossip.get(e))&&void 0!==n?n:[];this.gossip.set(e,r.concat(t))}async makePrune(e,t,n,r){var i;if(this.score.prune(e,t),(null===(i=this.streamsOutbound.get(e))||void 0===i?void 0:i.protocol)===U8)return{topicID:t,peers:[]};const o=r?this.opts.unsubcribeBackoff:this.opts.pruneBackoff,s=o/1e3;if(this.doAddBackoff(e,t,o),!n)return{topicID:t,peers:[],backoff:s};const a=this.getRandomGossipPeers(t,this.opts.prunePeers,(t=>t!==e&&this.score.score(t)>=0)),c=await Promise.all(Array.from(a).map((async e=>{var t;const n=S8(e);let r;try{r=await this.components.peerStore.get(n)}catch(i){if("ERR_NOT_FOUND"!==i.code)throw i}return{peerID:n.toBytes(),signedPeerRecord:null===(t=r)||void 0===t?void 0:t.peerRecordEnvelope}})));return{topicID:t,peers:c,backoff:s}}async heartbeat(){var e,t;const{D:n,Dlo:r,Dhi:i,Dscore:o,Dout:s,fanoutTTL:a}=this.opts;this.heartbeatTicks++;const c=new Map,l=e=>{let t=c.get(e);return void 0===t&&(t=this.score.score(e),c.set(e,t)),t},u=new Map,h=new Map,d=new Map;this.clearBackoff(),this.peerhave.clear(),null===(e=this.metrics)||void 0===e||e.cacheSize.set({cache:"iasked"},this.iasked.size),this.iasked.clear(),this.applyIwantPenalties(),this.heartbeatTicks%this.opts.directConnectTicks===0&&await this.directConnect(),null===(t=this.fastMsgIdCache)||void 0===t||t.prune(),this.seenCache.prune(),this.gossipTracer.prune(),this.publishedMessageIds.prune();const f=new Map;this.mesh.forEach(((e,t)=>{const a=this.topics.get(t),c=new Set,p=new Set;if(f.set(t,p),null!=a){const n=N9(Array.from(a)),r=this.backoff.get(t);for(const t of n){const n=this.streamsOutbound.get(t);if(null!=n&&this.multicodecs.includes(n.protocol)&&!e.has(t)&&!this.direct.has(t)){const e=l(t);(null==r||!r.has(t))&&e>=0&&c.add(t),e>=this.opts.scoreThresholds.gossipThreshold&&p.add(t)}}}const g=(n,r)=>{var i;this.log("HEARTBEAT: Remove mesh link to %s in %s",n,t),this.addBackoff(n,t),e.delete(n),l(n)>=this.opts.scoreThresholds.gossipThreshold&&p.add(n),null===(i=this.metrics)||void 0===i||i.onRemoveFromMesh(t,r,1);const o=h.get(n);null==o?h.set(n,[t]):o.push(t)},y=(n,r)=>{var i;this.log("HEARTBEAT: Add mesh link to %s in %s",n,t),this.score.graft(n,t),e.add(n),p.delete(n),null===(i=this.metrics)||void 0===i||i.onAddToMesh(t,r,1);const o=u.get(n);null==o?u.set(n,[t]):o.push(t)};if(e.forEach((e=>{const n=l(e);n<0&&(this.log("HEARTBEAT: Prune peer %s with negative score: score=%d, topic=%s",e,n,t),g(e,l7.BadScore),d.set(e,!0))})),e.size<r){const t=function(e,t){return E7(e,t,(()=>!0))}(c,n-e.size);t.forEach((e=>{y(e,c7.NotEnough)}))}if(e.size>i){let t=Array.from(e);t.sort(((e,t)=>l(t)-l(e))),t=t.slice(0,o).concat(N9(t.slice(o)));let r=0;if(t.slice(0,n).forEach((e=>{var t;null!==(t=this.outbound.get(e))&&void 0!==t&&t&&r++})),r<s){const e=e=>{const n=t[e];for(let r=e;r>0;r--)t[r]=t[r-1];t[0]=n};if(r>0){let i=r;for(let r=1;r<n&&i>0;r++){var m;null!==(m=this.outbound.get(t[r]))&&void 0!==m&&m&&(e(r),i--)}}let i=n-r;for(let r=n;r<t.length&&i>0;r++){var v;null!==(v=this.outbound.get(t[r]))&&void 0!==v&&v&&(e(r),i--)}}t.slice(n).forEach((e=>{g(e,l7.Excess)}))}if(e.size>=r){let t=0;if(e.forEach((e=>{var n;null!==(n=this.outbound.get(e))&&void 0!==n&&n&&t++})),t<s){E7(c,s-t,(e=>!0===this.outbound.get(e))).forEach((e=>{y(e,c7.Outbound)}))}}if(this.heartbeatTicks%this.opts.opportunisticGraftTicks===0&&e.size>1){const n=Array.from(e).sort(((e,t)=>l(e)-l(t))),r=Math.floor(e.size/2),i=l(n[r]);if(i<this.opts.scoreThresholds.opportunisticGraftThreshold){const e=E7(c,this.opts.opportunisticGraftPeers,(e=>l(e)>i));for(const n of e)this.log("HEARTBEAT: Opportunistically graft peer %s on topic %s",n,t),y(n,c7.Opportunistic)}}}));const p=Date.now();this.fanoutLastpub.forEach(((e,t)=>{e+a<p&&(this.fanout.delete(t),this.fanoutLastpub.delete(t))})),this.fanout.forEach(((e,t)=>{const r=this.topics.get(t);e.forEach((t=>{var n;(null===(n=null===r||void 0===r?void 0:r.has(t))||void 0===n||!n||l(t)<this.opts.scoreThresholds.publishThreshold)&&e.delete(t)}));const i=this.topics.get(t),o=[],s=new Set;if(f.set(t,s),null!=i){const t=N9(Array.from(i));for(const n of t){const t=this.streamsOutbound.get(n);if(null!=t&&this.multicodecs.includes(t.protocol)&&!e.has(n)&&!this.direct.has(n)){const e=l(n);e>=this.opts.scoreThresholds.publishThreshold&&o.push(n),e>=this.opts.scoreThresholds.gossipThreshold&&s.add(n)}}}if(e.size<n){const t=n-e.size;o.slice(0,t).forEach((t=>{e.add(t),null===s||void 0===s||s.delete(t)}))}})),this.emitGossip(f),await this.sendGraftPrune(u,h,d),this.flush(),this.mcache.shift(),this.dispatchEvent(new E4("gossipsub:heartbeat"))}getRandomGossipPeers(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>!0;const r=this.topics.get(e);if(null==r)return new Set;let i=[];return r.forEach((e=>{const t=this.streamsOutbound.get(e);null!=t&&this.multicodecs.includes(t.protocol)&&n(e)&&i.push(e)})),i=N9(i),t>0&&i.length>t&&(i=i.slice(0,t)),new Set(i)}onScrapeMetrics(e){var t,n;e.mcacheSize.set(this.mcache.size),e.mcacheNotValidatedCount.set(this.mcache.notValidatedCount),e.cacheSize.set({cache:"direct"},this.direct.size),e.cacheSize.set({cache:"seenCache"},this.seenCache.size),e.cacheSize.set({cache:"fastMsgIdCache"},null!==(t=null===(n=this.fastMsgIdCache)||void 0===n?void 0:n.size)&&void 0!==t?t:0),e.cacheSize.set({cache:"publishedMessageIds"},this.publishedMessageIds.size),e.cacheSize.set({cache:"mcache"},this.mcache.size),e.cacheSize.set({cache:"score"},this.score.size),e.cacheSize.set({cache:"gossipTracer.promises"},this.gossipTracer.size),e.cacheSize.set({cache:"gossipTracer.requests"},this.gossipTracer.requestMsByMsgSize),e.cacheSize.set({cache:"topics"},this.topics.size),e.cacheSize.set({cache:"subscriptions"},this.subscriptions.size),e.cacheSize.set({cache:"mesh"},this.mesh.size),e.cacheSize.set({cache:"fanout"},this.fanout.size),e.cacheSize.set({cache:"peers"},this.peers.size),e.cacheSize.set({cache:"streamsOutbound"},this.streamsOutbound.size),e.cacheSize.set({cache:"streamsInbound"},this.streamsInbound.size),e.cacheSize.set({cache:"acceptFromWhitelist"},this.acceptFromWhitelist.size),e.cacheSize.set({cache:"gossip"},this.gossip.size),e.cacheSize.set({cache:"control"},this.control.size),e.cacheSize.set({cache:"peerhave"},this.peerhave.size),e.cacheSize.set({cache:"outbound"},this.outbound.size);let r=0;const i=Date.now();e.connectedPeersBackoffSec.reset();for(const u of this.backoff.values()){r+=u.size;for(const[t,n]of u.entries())this.peers.has(t)&&e.connectedPeersBackoffSec.observe(Math.max(0,n-i)/1e3)}e.cacheSize.set({cache:"backoff"},r);for(const[u,h]of this.topics)e.topicPeersCount.set({topicStr:u},h.size);for(const[u,h]of this.mesh)e.meshPeerCounts.set({topicStr:u},h.size);const o=[],s=new Map;e.behaviourPenalty.reset();for(const u of this.peers.keys()){var a,c;const t=this.score.score(u);o.push(t),s.set(u,t),e.behaviourPenalty.observe(null!==(a=null===(c=this.score.peerStats.get(u))||void 0===c?void 0:c.behaviourPenalty)&&void 0!==a?a:0)}e.registerScores(o,this.opts.scoreThresholds),e.registerScorePerMesh(this.mesh,s);const l=function(e,t,n,r,i){const o={byTopic:new Map,p5w:[],p6w:[],p7w:[],score:[]};for(const s of e){const e=t.get(s);if(null!=e){const t=x7(s,e,n,r,i);for(const[e,n]of t.byTopic){let t=o.byTopic.get(e);null==t&&(t={p1w:[],p2w:[],p3w:[],p3bw:[],p4w:[]},o.byTopic.set(e,t)),t.p1w.push(n.p1w),t.p2w.push(n.p2w),t.p3w.push(n.p3w),t.p3bw.push(n.p3bw),t.p4w.push(n.p4w)}o.p5w.push(t.p5w),o.p6w.push(t.p6w),o.p7w.push(t.p7w),o.score.push(t.score)}else o.p5w.push(0),o.p6w.push(0),o.p7w.push(0),o.score.push(0)}return o}(this.peers.keys(),this.score.peerStats,this.score.params,this.score.peerIPs,e.topicStrToLabel);e.registerScoreWeights(l)}}function nne(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>new tne(t,e)}function rne(){const e=Ws();let t=!1;return{sink:async n=>{if(t)throw new Error("already piped");t=!0,e.resolve(n)},source:async function*(){const t=await e.promise;yield*t}()}}(0,Yo.Z)(tne,"multicodec",F8);const ine=65535,one=Boolean(null===($te=globalThis.process)||void 0===$te||null===(ene=$te.env)||void 0===ene?void 0:ene.DUMP_SESSION_KEYS),sne={hashSHA256:e=>au(e),getHKDF(e,t){const n=Xl(au,t,e),r=tu(au,n,void 0,96);return[r.subarray(0,32),r.subarray(32,64),r.subarray(64,96)]},generateX25519KeyPair(){const e=Wl.utils.randomPrivateKey();return{publicKey:Wl.getPublicKey(e),privateKey:e}},generateX25519KeyPairFromSeed:e=>({publicKey:Wl.getPublicKey(e),privateKey:e}),generateX25519SharedKey:(e,t)=>Wl.getSharedSecret(e,t),chaCha20Poly1305Encrypt:(e,t,n,r)=>lc(r,t,n).encrypt(e),chaCha20Poly1305Decrypt:(e,t,n,r,i)=>lc(r,t,n).decrypt(e,i)},ane=e=>{const t=(0,Us.E)(2);return new DataView(t.buffer,t.byteOffset,t.byteLength).setUint16(0,e,!1),t};ane.bytes=2;const cne=e=>{if(e.length<2)throw RangeError("Could not decode int16BE");return e instanceof Uint8Array?new DataView(e.buffer,e.byteOffset,e.byteLength).getUint16(0,!1):e.getUint16(0)};cne.bytes=2;var lne,une;async function hne(e,t,n){const r=await async function(e,t){if(null==e.privateKey)throw new Error("PrivateKey was missing from PeerId");return(await oJ(e.privateKey)).sign(t)}(e,pne(t));if(null==e.publicKey)throw new Error("PublicKey was missing from local PeerId");return function(e,t,n){return une.encode({identityKey:e,identitySig:t,extensions:null!==n&&void 0!==n?n:{webtransportCerthashes:[]}}).subarray()}(e.publicKey,r,n)}async function dne(e){return e1(e.identityKey)}function fne(e){return une.decode(e)}function pne(e){const t=(0,yu.m)("noise-libp2p-static-key:");return(0,Ls.z)([t,e],t.length+e.length)}async function gne(e,t,n){const r=await e1(t.identityKey);if(!r.equals(n))throw new Error("Payload identity key ".concat(r.toString()," does not match expected remote peer ").concat(n.toString()));const i=pne(e);if(null==r.publicKey)throw new Error("PublicKey was missing from PeerId");if(null==t.identitySig)throw new Error("Signature was missing from message");const o=iJ(r.publicKey);if(!await o.verify(i,t.identitySig))throw new Error("Static key doesn't match to peer that signed payload!");return r}function yne(e){return e instanceof Uint8Array&&32===e.length}!function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==n.lengthDelimited&&t.fork(),null!=e.webtransportCerthashes)for(const r of e.webtransportCerthashes)t.uint32(10),t.bytes(r);!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={webtransportCerthashes:[]},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();if(t>>>3===1)n.webtransportCerthashes.push(e.bytes());else e.skipType(7&t)}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(lne||(lne={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.identityKey&&e.identityKey.byteLength>0&&(t.uint32(10),t.bytes(e.identityKey)),null!=e.identitySig&&e.identitySig.byteLength>0&&(t.uint32(18),t.bytes(e.identitySig)),null!=e.extensions&&(t.uint32(34),lne.codec().encode(e.extensions,t)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={identityKey:(0,Us.u)(0),identitySig:(0,Us.u)(0)},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.identityKey=e.bytes();break;case 2:n.identitySig=e.bytes();break;case 4:n.extensions=lne.codec().decode(e,e.uint32());break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(une||(une={}));const mne=aH("libp2p:noise");let vne;function bne(e){e?(vne("LOCAL_PUBLIC_EPHEMERAL_KEY ".concat((0,Au.B)(e.publicKey,"hex"))),vne("LOCAL_PRIVATE_EPHEMERAL_KEY ".concat((0,Au.B)(e.privateKey,"hex")))):vne("Missing local ephemeral keys.")}function wne(e){vne("REMOTE_EPHEMERAL_PUBLIC_KEY ".concat((0,Au.B)(e,"hex")))}vne=one?mne:Object.assign((()=>{}),{enabled:!1,trace:()=>{},error:()=>{}});class Ene{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;(0,Yo.Z)(this,"n",void 0),(0,Yo.Z)(this,"bytes",void 0),(0,Yo.Z)(this,"view",void 0),this.n=e,this.bytes=(0,Us.u)(12),this.view=new DataView(this.bytes.buffer,this.bytes.byteOffset,this.bytes.byteLength),this.view.setUint32(4,e,!0)}increment(){this.n++,this.view.setUint32(4,this.n,!0)}getBytes(){return this.bytes}getUint64(){return this.n}assertValue(){if(this.n>4294967295)throw new Error("Cipherstate has reached maximum n, a new handshake must be performed")}}class Ane{constructor(e){(0,Yo.Z)(this,"crypto",void 0),this.crypto=e}encryptWithAd(e,t,n){const r=this.encrypt(e.k,e.n,t,n);return e.n.increment(),r}decryptWithAd(e,t,n,r){const{plaintext:i,valid:o}=this.decrypt(e.k,e.n,t,n,r);return o&&e.n.increment(),{plaintext:i,valid:o}}hasKey(e){return!this.isEmptyKey(e.k)}createEmptyKey(){return(0,Us.u)(32)}isEmptyKey(e){const t=this.createEmptyKey();return(0,Ms.f)(t,e)}encrypt(e,t,n,r){return t.assertValue(),this.crypto.chaCha20Poly1305Encrypt(r,t.getBytes(),n,e)}encryptAndHash(e,t){let n;return n=this.hasKey(e.cs)?this.encryptWithAd(e.cs,e.h,t):t,this.mixHash(e,n),n}decrypt(e,t,n,r,i){t.assertValue();const o=this.crypto.chaCha20Poly1305Decrypt(r,t.getBytes(),n,e,i);return o?{plaintext:o,valid:!0}:{plaintext:(0,Us.u)(0),valid:!1}}decryptAndHash(e,t){let n,r=!0;return this.hasKey(e.cs)?({plaintext:n,valid:r}=this.decryptWithAd(e.cs,e.h,t)):n=t,this.mixHash(e,t),{plaintext:n,valid:r}}dh(e,t){try{const n=this.crypto.generateX25519SharedKey(e,t);return 32===n.length?n:n.subarray(0,32)}catch(n){const e=n;return mne.error(e),(0,Us.u)(32)}}mixHash(e,t){e.h=this.getHash(e.h,t)}getHash(e,t){return this.crypto.hashSHA256((0,Ls.z)([e,t],e.length+t.length))}mixKey(e,t){const[n,r]=this.crypto.getHKDF(e.ck,t);e.cs=this.initializeKey(r),e.ck=n}initializeKey(e){return{k:e,n:new Ene}}initializeSymmetric(e){const t=(0,Xh.mL)(e,"utf-8"),n=this.hashProtocolName(t),r=n,i=this.createEmptyKey();return{cs:this.initializeKey(i),ck:r,h:n}}hashProtocolName(e){if(e.length<=32){const t=(0,Us.u)(32);return t.set(e),t}return this.getHash(e,(0,Us.u)(0))}split(e){const[t,n]=this.crypto.getHKDF(e.ck,(0,Us.u)(0));return{cs1:this.initializeKey(t),cs2:this.initializeKey(n)}}writeMessageRegular(e,t){const n=this.encryptWithAd(e,(0,Us.u)(0),t);return{ne:this.createEmptyKey(),ns:(0,Us.u)(0),ciphertext:n}}readMessageRegular(e,t){return this.decryptWithAd(e,(0,Us.u)(0),t.ciphertext)}}class Sne extends Ane{initializeInitiator(e,t,n,r){const i=this.initializeSymmetric("Noise_XX_25519_ChaChaPoly_SHA256");this.mixHash(i,e);return{ss:i,s:t,rs:n,psk:r,re:(0,Us.u)(32)}}initializeResponder(e,t,n,r){const i=this.initializeSymmetric("Noise_XX_25519_ChaChaPoly_SHA256");this.mixHash(i,e);return{ss:i,s:t,rs:n,psk:r,re:(0,Us.u)(32)}}writeMessageA(e,t,n){const r=(0,Us.u)(0);e.e=void 0!==n?n:this.crypto.generateX25519KeyPair();const i=e.e.publicKey;this.mixHash(e.ss,i);return{ne:i,ns:r,ciphertext:this.encryptAndHash(e.ss,t)}}writeMessageB(e,t){e.e=this.crypto.generateX25519KeyPair();const n=e.e.publicKey;this.mixHash(e.ss,n),this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));const r=e.s.publicKey,i=this.encryptAndHash(e.ss,r);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));return{ne:n,ns:i,ciphertext:this.encryptAndHash(e.ss,t)}}writeMessageC(e,t){const n=e.s.publicKey,r=this.encryptAndHash(e.ss,n);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));const i=this.encryptAndHash(e.ss,t),o={ne:this.createEmptyKey(),ns:r,ciphertext:i},{cs1:s,cs2:a}=this.split(e.ss);return{h:e.ss.h,messageBuffer:o,cs1:s,cs2:a}}readMessageA(e,t){return yne(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),this.decryptAndHash(e.ss,t.ciphertext)}readMessageB(e,t){if(yne(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));const{plaintext:n,valid:r}=this.decryptAndHash(e.ss,t.ns);r&&yne(n)&&(e.rs=n),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));const{plaintext:i,valid:o}=this.decryptAndHash(e.ss,t.ciphertext);return{plaintext:i,valid:r&&o}}readMessageC(e,t){const{plaintext:n,valid:r}=this.decryptAndHash(e.ss,t.ns);if(r&&yne(n)&&(e.rs=n),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));const{plaintext:i,valid:o}=this.decryptAndHash(e.ss,t.ciphertext),{cs1:s,cs2:a}=this.split(e.ss);return{h:e.ss.h,plaintext:i,valid:r&&o,cs1:s,cs2:a}}initSession(e,t,n){const r=this.createEmptyKey(),i=(0,Us.u)(32);let o;return o=e?this.initializeInitiator(t,n,i,r):this.initializeResponder(t,n,i,r),{hs:o,i:e,mc:0}}sendMessage(e,t,n){let r;if(0===e.mc)r=this.writeMessageA(e.hs,t,n);else if(1===e.mc)r=this.writeMessageB(e.hs,t);else if(2===e.mc){const{h:n,messageBuffer:i,cs1:o,cs2:s}=this.writeMessageC(e.hs,t);r=i,e.h=n,e.cs1=o,e.cs2=s}else{if(!(e.mc>2))throw new Error("Session invalid.");if(e.i){if(!e.cs1)throw new Error("CS1 (cipher state) is not defined");r=this.writeMessageRegular(e.cs1,t)}else{if(!e.cs2)throw new Error("CS2 (cipher state) is not defined");r=this.writeMessageRegular(e.cs2,t)}}return e.mc++,r}recvMessage(e,t){let n=(0,Us.u)(0),r=!1;if(0===e.mc)({plaintext:n,valid:r}=this.readMessageA(e.hs,t));else if(1===e.mc)({plaintext:n,valid:r}=this.readMessageB(e.hs,t));else if(2===e.mc){const{h:i,plaintext:o,valid:s,cs1:a,cs2:c}=this.readMessageC(e.hs,t);n=o,r=s,e.h=i,e.cs1=a,e.cs2=c}return e.mc++,{plaintext:n,valid:r}}}class _ne{constructor(e,t,n,r,i,o,s,a){(0,Yo.Z)(this,"isInitiator",void 0),(0,Yo.Z)(this,"session",void 0),(0,Yo.Z)(this,"remotePeer",void 0),(0,Yo.Z)(this,"remoteExtensions",{webtransportCerthashes:[]}),(0,Yo.Z)(this,"payload",void 0),(0,Yo.Z)(this,"connection",void 0),(0,Yo.Z)(this,"xx",void 0),(0,Yo.Z)(this,"staticKeypair",void 0),(0,Yo.Z)(this,"prologue",void 0),this.isInitiator=e,this.payload=t,this.prologue=n,this.staticKeypair=i,this.connection=o,s&&(this.remotePeer=s),this.xx=null!==a&&void 0!==a?a:new Sne(r),this.session=this.xx.initSession(this.isInitiator,this.prologue,this.staticKeypair)}async propose(){var e;if(e=this.session.hs.s,vne("LOCAL_STATIC_PUBLIC_KEY ".concat((0,Au.B)(e.publicKey,"hex"))),vne("LOCAL_STATIC_PRIVATE_KEY ".concat((0,Au.B)(e.privateKey,"hex"))),this.isInitiator){mne.trace("Stage 0 - Initiator starting to send first message.");const e=this.xx.sendMessage(this.session,(0,Us.u)(0));await this.connection.write(function(e){return(0,Ls.z)([e.ne,e.ciphertext],e.ne.length+e.ciphertext.length)}(e)),mne.trace("Stage 0 - Initiator finished sending first message."),bne(this.session.hs.e)}else{mne.trace("Stage 0 - Responder waiting to receive first message...");const e=function(e){if(e.length<32)throw new Error("Cannot decode stage 0 MessageBuffer: length less than 32 bytes.");return{ne:e.subarray(0,32),ciphertext:e.subarray(32,e.length),ns:(0,Us.u)(0)}}((await this.connection.read()).subarray()),{valid:t}=this.xx.recvMessage(this.session,e);if(!t)throw new lq("xx handshake stage 0 validation fail");mne.trace("Stage 0 - Responder received first message."),wne(this.session.hs.re)}}async exchange(){if(this.isInitiator){mne.trace("Stage 1 - Initiator waiting to receive first message from responder...");const n=function(e){if(e.length<80)throw new Error("Cannot decode stage 1 MessageBuffer: length less than 80 bytes.");return{ne:e.subarray(0,32),ns:e.subarray(32,80),ciphertext:e.subarray(80,e.length)}}((await this.connection.read()).subarray()),{plaintext:r,valid:i}=this.xx.recvMessage(this.session,n);if(!i)throw new lq("xx handshake stage 1 validation fail");mne.trace("Stage 1 - Initiator received the message."),wne(this.session.hs.re),e=this.session.hs.rs,vne("REMOTE_STATIC_PUBLIC_KEY ".concat((0,Au.B)(e,"hex"))),mne.trace("Initiator going to check remote's signature...");try{const e=fne(r);this.remotePeer=this.remotePeer||await dne(e),await gne(this.session.hs.rs,e,this.remotePeer),this.setRemoteNoiseExtension(e.extensions)}catch(t){throw new cq("Error occurred while verifying signed payload: ".concat(t.message))}mne.trace("All good with the signature!")}else{mne.trace("Stage 1 - Responder sending out first message with signed payload and static key.");const e=this.xx.sendMessage(this.session,this.payload);await this.connection.write(function(e){return(0,Ls.z)([e.ne,e.ns,e.ciphertext],e.ne.length+e.ns.length+e.ciphertext.length)}(e)),mne.trace("Stage 1 - Responder sent the second handshake message with signed payload."),bne(this.session.hs.e)}var e}async finish(){if(this.isInitiator){mne.trace("Stage 2 - Initiator sending third handshake message.");const e=this.xx.sendMessage(this.session,this.payload);await this.connection.write(function(e){return(0,Ls.z)([e.ns,e.ciphertext],e.ns.length+e.ciphertext.length)}(e)),mne.trace("Stage 2 - Initiator sent message with signed payload.")}else{mne.trace("Stage 2 - Responder waiting for third handshake message...");const e=function(e){if(e.length<48)throw new Error("Cannot decode stage 2 MessageBuffer: length less than 48 bytes.");return{ne:(0,Us.u)(0),ns:e.subarray(0,48),ciphertext:e.subarray(48,e.length)}}((await this.connection.read()).subarray()),{plaintext:n,valid:r}=this.xx.recvMessage(this.session,e);if(!r)throw new lq("xx handshake stage 2 validation fail");mne.trace("Stage 2 - Responder received the message, finished handshake.");try{const e=fne(n);this.remotePeer=this.remotePeer||await dne(e),await gne(this.session.hs.rs,e,this.remotePeer),this.setRemoteNoiseExtension(e.extensions)}catch(t){throw new cq("Error occurred while verifying signed payload: ".concat(t.message))}}var e;(e=this.session).cs1&&e.cs2?(vne("CIPHER_STATE_1 ".concat(e.cs1.n.getUint64()," ").concat((0,Au.B)(e.cs1.k,"hex"))),vne("CIPHER_STATE_2 ".concat(e.cs2.n.getUint64()," ").concat((0,Au.B)(e.cs2.k,"hex")))):vne("Missing cipher state.")}encrypt(e,t){const n=this.getCS(t);return this.xx.encryptWithAd(n,(0,Us.u)(0),e)}decrypt(e,t,n){const r=this.getCS(t,!1);return this.xx.decryptWithAd(r,(0,Us.u)(0),e,n)}getRemoteStaticKey(){return this.session.hs.rs}getCS(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!e.cs1||!e.cs2)throw new lq("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?t?e.cs1:e.cs2:t?e.cs2:e.cs1}setRemoteNoiseExtension(e){e&&(this.remoteExtensions=e)}}class Ine{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,Yo.Z)(this,"protocol","/noise"),(0,Yo.Z)(this,"crypto",void 0),(0,Yo.Z)(this,"prologue",void 0),(0,Yo.Z)(this,"staticKeys",void 0),(0,Yo.Z)(this,"extensions",void 0),(0,Yo.Z)(this,"metrics",void 0);const{staticNoiseKey:t,extensions:n,crypto:r,prologueBytes:i,metrics:o}=e;this.crypto=null!==r&&void 0!==r?r:sne,this.extensions=n,this.metrics=o?function(e){return{xxHandshakeSuccesses:e.registerCounter("libp2p_noise_xxhandshake_successes_total",{help:"Total count of noise xxHandshakes successes_"}),xxHandshakeErrors:e.registerCounter("libp2p_noise_xxhandshake_error_total",{help:"Total count of noise xxHandshakes errors"}),encryptedPackets:e.registerCounter("libp2p_noise_encrypted_packets_total",{help:"Total count of noise encrypted packets successfully"}),decryptedPackets:e.registerCounter("libp2p_noise_decrypted_packets_total",{help:"Total count of noise decrypted packets"}),decryptErrors:e.registerCounter("libp2p_noise_decrypt_errors_total",{help:"Total count of noise decrypt errors"})}}(o):void 0,this.staticKeys=t?this.crypto.generateX25519KeyPairFromSeed(t):this.crypto.generateX25519KeyPair(),this.prologue=null!==i&&void 0!==i?i:(0,Us.u)(0)}async secureOutbound(e,t,n){const r=la(t,{lengthEncoder:ane,lengthDecoder:cne,maxDataLength:ine}),i=await this.performHandshake({connection:r,isInitiator:!0,localPeer:e,remotePeer:n});return{conn:await this.createSecureConnection(r,i),remoteExtensions:i.remoteExtensions,remotePeer:i.remotePeer}}async secureInbound(e,t,n){const r=la(t,{lengthEncoder:ane,lengthDecoder:cne,maxDataLength:ine}),i=await this.performHandshake({connection:r,isInitiator:!1,localPeer:e,remotePeer:n});return{conn:await this.createSecureConnection(r,i),remotePeer:i.remotePeer,remoteExtensions:i.remoteExtensions}}async performHandshake(e){const t=await hne(e.localPeer,this.staticKeys.publicKey,this.extensions);return this.performXXHandshake(e,t)}async performXXHandshake(e,t){const{isInitiator:n,remotePeer:r,connection:i}=e,o=new _ne(n,t,this.prologue,this.crypto,this.staticKeys,i,r);try{var s;await o.propose(),await o.exchange(),await o.finish(),null===(s=this.metrics)||void 0===s||s.xxHandshakeSuccesses.increment()}catch(c){var a;if(null===(a=this.metrics)||void 0===a||a.xxHandshakeErrors.increment(),c instanceof Error)throw c.message="Error occurred during XX handshake: ".concat(c.message),c}return o}async createSecureConnection(e,t){const[n,r]=function(){const e=rne(),t=rne();return[{source:e.source,sink:t.sink},{source:t.source,sink:e.sink}]}(),i=e.unwrap();return await Yq(n,function(e,t){return async function*(n){for await(const r of n)for(let n=0;n<r.length;n+=65519){let i=n+65519;i>r.length&&(i=r.length);const o=e.encrypt(r.subarray(n,i),e.session);null===t||void 0===t||t.encryptedPackets.increment(),yield(0,Xh.zo)([ane(o.byteLength),o],2+o.byteLength)}}}(t,this.metrics),i,(e=>Zq(e,{lengthDecoder:cne})),function(e,t){return async function*(n){for await(const r of n)for(let n=0;n<r.length;n+=ine){let i=n+ine;if(i>r.length&&(i=r.length),i-16<n)throw new Error("Invalid chunk");const o=r.subarray(n,i),s=r.subarray(n,i-16),{plaintext:a,valid:c}=e.decrypt(o,e.session,s);if(!c)throw null===t||void 0===t||t.decryptErrors.increment(),new Error("Failed to validate decrypted chunk");null===t||void 0===t||t.decryptedPackets.increment(),yield a}}}(t,this.metrics),n),r}}function Cne(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return()=>new Ine(e)}const Tne="ERR_INVALID_FRAME",kne="ERR_UNREQUESTED_PING",Rne="ERR_NOT_MATCHING_PING",xne="ERR_STREAM_ALREADY_EXISTS",Pne="ERR_DECODE_INVALID_VERSION",Dne="ERR_BOTH_CLIENTS",One="ERR_RECV_WINDOW_EXCEEDED",Nne=new Set([Tne,kne,Rne,xne,Pne,Dne,One]),Bne="ERR_INVALID_CONFIG",Lne="ERR_MUXER_LOCAL_CLOSED",Mne="ERR_MUXER_REMOTE_CLOSED",Une=262144,Fne={log:aH("libp2p:yamux"),enableKeepAlive:!0,keepAliveInterval:3e4,maxInboundStreams:1e3,maxOutboundStreams:1e3,initialStreamWindowSize:Une,maxStreamWindowSize:16777216,maxMessageSize:65536};var Kne,jne;!function(e){e[e.Data=0]="Data",e[e.WindowUpdate=1]="WindowUpdate",e[e.Ping=2]="Ping",e[e.GoAway=3]="GoAway"}(Kne||(Kne={})),function(e){e[e.SYN=1]="SYN",e[e.ACK=2]="ACK",e[e.FIN=4]="FIN",e[e.RST=8]="RST"}(jne||(jne={}));Object.values(jne).filter((e=>"string"!==typeof e));var Zne;!function(e){e[e.NormalTermination=0]="NormalTermination",e[e.ProtocolError=1]="ProtocolError",e[e.InternalError=2]="InternalError"}(Zne||(Zne={}));const zne=2**24;class Vne{constructor(e){(0,Yo.Z)(this,"source",void 0),(0,Yo.Z)(this,"buffer",void 0),(0,Yo.Z)(this,"frameInProgress",void 0),this.source=function(e){if(void 0!==e[Symbol.iterator]){const t=e[Symbol.iterator]();return t.return=void 0,{[Symbol.iterator]:()=>t}}if(void 0!==e[Symbol.asyncIterator]){const t=e[Symbol.asyncIterator]();return t.return=void 0,{[Symbol.asyncIterator]:()=>t}}throw new Error("a source must be either an iterable or an async iterable")}(e),this.buffer=new Zs,this.frameInProgress=!1}async*emitFrames(){for await(const e of this.source)for(this.buffer.append(e);;){const e=this.readHeader();if(void 0===e)break;const{type:t,length:n}=e;t===Kne.Data?(this.frameInProgress=!0,yield{header:e,readData:this.readBytes.bind(this,n)}):yield{header:e}}}readHeader(){if(this.frameInProgress)throw new aq("decoding frame already in progress","ERR_DECODE_IN_PROGRESS");if(this.buffer.length<12)return;const e=function(e){if(0!==e[0])throw new aq("Invalid frame version",Pne);return{type:e[1],flag:(e[2]<<8)+e[3],streamID:e[4]*zne+(e[5]<<16)+(e[6]<<8)+e[7],length:e[8]*zne+(e[9]<<16)+(e[10]<<8)+e[11]}}(this.buffer.subarray(0,12));return this.buffer.consume(12),e}async readBytes(e){if(this.buffer.length<e)for await(const n of this.source)if(this.buffer.append(n),this.buffer.length>=e)break;const t=this.buffer.sublist(0,e);return this.buffer.consume(e),this.frameInProgress=!1,t}}function Hne(e){const t=new Uint8Array(12);return t[1]=e.type,t[2]=e.flag>>>8,t[3]=e.flag,t[4]=e.streamID>>>24,t[5]=e.streamID>>>16,t[6]=e.streamID>>>8,t[7]=e.streamID,t[8]=e.length>>>24,t[9]=e.length>>>16,t[10]=e.length>>>8,t[11]=e.length,t}function qne(e){return null!=e&&"function"===typeof e.then}class Gne{constructor(e){var t,n;(0,Yo.Z)(this,"id",void 0),(0,Yo.Z)(this,"direction",void 0),(0,Yo.Z)(this,"timeline",void 0),(0,Yo.Z)(this,"protocol",void 0),(0,Yo.Z)(this,"metadata",void 0),(0,Yo.Z)(this,"source",void 0),(0,Yo.Z)(this,"status",void 0),(0,Yo.Z)(this,"readStatus",void 0),(0,Yo.Z)(this,"writeStatus",void 0),(0,Yo.Z)(this,"sinkController",void 0),(0,Yo.Z)(this,"sinkEnd",void 0),(0,Yo.Z)(this,"endErr",void 0),(0,Yo.Z)(this,"streamSource",void 0),(0,Yo.Z)(this,"onEnd",void 0),(0,Yo.Z)(this,"onCloseRead",void 0),(0,Yo.Z)(this,"onCloseWrite",void 0),(0,Yo.Z)(this,"onReset",void 0),(0,Yo.Z)(this,"onAbort",void 0),(0,Yo.Z)(this,"sendCloseWriteTimeout",void 0),(0,Yo.Z)(this,"log",void 0),this.sinkController=new AbortController,this.sinkEnd=Ws(),this.log=e.log,this.status="open",this.readStatus="ready",this.writeStatus="ready",this.id=e.id,this.metadata=null!==(t=e.metadata)&&void 0!==t?t:{},this.direction=e.direction,this.timeline={open:Date.now()},this.sendCloseWriteTimeout=null!==(n=e.sendCloseWriteTimeout)&&void 0!==n?n:5e3,this.onEnd=e.onEnd,this.onCloseRead=null===e||void 0===e?void 0:e.onCloseRead,this.onCloseWrite=null===e||void 0===e?void 0:e.onCloseWrite,this.onReset=null===e||void 0===e?void 0:e.onReset,this.onAbort=null===e||void 0===e?void 0:e.onAbort,this.source=this.streamSource=Gq({onEnd:e=>{null!=e?this.log.trace("source ended with error",e):this.log.trace("source ended"),this.onSourceEnd(e)}}),this.sink=this.sink.bind(this)}async sink(e){if("ready"!==this.writeStatus)throw new aq('writable end state is "'.concat(this.writeStatus,'" not "ready"'),"ERR_SINK_INVALID_STATE");try{this.writeStatus="writing";const t={signal:this.sinkController.signal};if("outbound"===this.direction){const e=this.sendNewStream(t);qne(e)&&await e}e=fF(e,this.sinkController.signal,{returnOnAbort:!0}),this.log.trace("sink reading from source");for await(let n of e){n=n instanceof Uint8Array?new Zs(n):n;const e=this.sendData(n,t);qne(e)&&await e}this.log.trace('sink finished reading from source, write status is "%s"',this.writeStatus),"writing"===this.writeStatus&&(this.writeStatus="closing",this.log.trace("send close write to remote"),await this.sendCloseWrite({signal:AbortSignal.timeout(this.sendCloseWriteTimeout)}),this.writeStatus="closed"),this.onSinkEnd()}catch(t){throw this.log.trace("sink ended with error, calling abort with error",t),this.abort(t),t}finally{this.log.trace("resolve sink end"),this.sinkEnd.resolve()}}onSourceEnd(e){var t;null==this.timeline.closeRead&&(this.timeline.closeRead=Date.now(),this.readStatus="closed",null!=e&&null==this.endErr&&(this.endErr=e),null===(t=this.onCloseRead)||void 0===t||t.call(this),null!=this.timeline.closeWrite?(this.log.trace("source and sink ended"),this.timeline.close=Date.now(),"aborted"!==this.status&&"reset"!==this.status&&(this.status="closed"),null!=this.onEnd&&this.onEnd(this.endErr)):this.log.trace("source ended, waiting for sink to end"))}onSinkEnd(e){var t;null==this.timeline.closeWrite&&(this.timeline.closeWrite=Date.now(),this.writeStatus="closed",null!=e&&null==this.endErr&&(this.endErr=e),null===(t=this.onCloseWrite)||void 0===t||t.call(this),null!=this.timeline.closeRead?(this.log.trace("sink and source ended"),this.timeline.close=Date.now(),"aborted"!==this.status&&"reset"!==this.status&&(this.status="closed"),null!=this.onEnd&&this.onEnd(this.endErr)):this.log.trace("sink ended, waiting for source to end"))}async close(e){this.log.trace("closing gracefully"),this.status="closing",await Promise.all([this.closeRead(e),this.closeWrite(e)]),this.status="closed",this.log.trace("closed gracefully")}async closeRead(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("closing"===this.readStatus||"closed"===this.readStatus)return;this.log.trace('closing readable end of stream with starting read status "%s"',this.readStatus);const t=this.readStatus;this.readStatus="closing","reset"!==this.status&&"aborted"!==this.status&&null==this.timeline.closeRead&&(this.log.trace("send close read to remote"),await this.sendCloseRead(e)),"ready"===t&&(this.log.trace("ending internal source queue"),this.streamSource.end()),this.log.trace("closed readable end of stream")}async closeWrite(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"closing"!==this.writeStatus&&"closed"!==this.writeStatus&&(this.log.trace('closing writable end of stream with starting write status "%s"',this.writeStatus),"ready"===this.writeStatus&&(this.log.trace("sink was never sunk, sink an empty array"),await Ys(this.sink([]),e.signal)),"writing"===this.writeStatus&&await new Promise(((t,n)=>{queueMicrotask((()=>{this.log.trace("aborting source passed to .sink"),this.sinkController.abort(),Ys(this.sinkEnd.promise,e.signal).then(t,n)}))})),this.writeStatus="closed",this.log.trace("closed writable end of stream"))}abort(e){var t;if("closed"===this.status||"aborted"===this.status||"reset"===this.status)return;this.log("abort with error",e),this.log("try to send reset to remote");const n=this.sendReset();qne(n)&&n.catch((e=>{this.log.error("error sending reset message",e)})),this.status="aborted",this.timeline.abort=Date.now(),this._closeSinkAndSource(e),null===(t=this.onAbort)||void 0===t||t.call(this,e)}reset(){var e;if("closed"===this.status||"aborted"===this.status||"reset"===this.status)return;const t=new aq("stream reset","ERR_STREAM_RESET");this.status="reset",this.timeline.reset=Date.now(),this._closeSinkAndSource(t),null===(e=this.onReset)||void 0===e||e.call(this)}_closeSinkAndSource(e){this._closeSink(e),this._closeSource(e)}_closeSink(e){"writing"===this.writeStatus&&(this.log.trace("end sink source"),this.sinkController.abort()),this.onSinkEnd(e)}_closeSource(e){"closing"!==this.readStatus&&"closed"!==this.readStatus&&(this.log.trace("ending source with %d bytes to be read by consumer",this.streamSource.readableLength),this.readStatus="closing",this.streamSource.end(e))}remoteCloseWrite(){"closing"!==this.readStatus&&"closed"!==this.readStatus?(this.log.trace("remote close write"),this._closeSource()):this.log("received remote close write but local source is already closed")}remoteCloseRead(){"closing"!==this.writeStatus&&"closed"!==this.writeStatus?(this.log.trace("remote close read"),this._closeSink()):this.log("received remote close read but local sink is already closed")}destroy(){"closed"!==this.status&&"aborted"!==this.status&&"reset"!==this.status?(this.log.trace("stream destroyed"),this._closeSinkAndSource()):this.log("received destroy but we are already closed")}sourcePush(e){this.streamSource.push(e)}sourceReadableLength(){return this.streamSource.readableLength}}var Wne;!function(e){e[e.Init=0]="Init",e[e.SYNSent=1]="SYNSent",e[e.SYNReceived=2]="SYNReceived",e[e.Established=3]="Established",e[e.Finished=4]="Finished"}(Wne||(Wne={}));class Qne extends Gne{constructor(e){super({...e,onEnd:t=>{var n;this.state=Wne.Finished,null===(n=e.onEnd)||void 0===n||n.call(e,t)}}),(0,Yo.Z)(this,"name",void 0),(0,Yo.Z)(this,"state",void 0),(0,Yo.Z)(this,"config",void 0),(0,Yo.Z)(this,"_id",void 0),(0,Yo.Z)(this,"sendWindowCapacity",void 0),(0,Yo.Z)(this,"sendWindowCapacityUpdate",void 0),(0,Yo.Z)(this,"recvWindow",void 0),(0,Yo.Z)(this,"recvWindowCapacity",void 0),(0,Yo.Z)(this,"epochStart",void 0),(0,Yo.Z)(this,"getRTT",void 0),(0,Yo.Z)(this,"sendFrame",void 0),this.config=e.config,this._id=parseInt(e.id,10),this.name=e.name,this.state=e.state,this.sendWindowCapacity=Une,this.recvWindow=this.config.initialStreamWindowSize,this.recvWindowCapacity=this.recvWindow,this.epochStart=Date.now(),this.getRTT=e.getRTT,this.sendFrame=e.sendFrame,this.source=jd(this.source,(()=>{this.sendWindowUpdate()}))}async sendNewStream(){}async sendData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(e=e.sublist();0!==e.byteLength;){if(0===this.sendWindowCapacity&&await this.waitForSendWindowCapacity(t),"open"!==this.status)return;const n=Math.min(this.sendWindowCapacity,this.config.maxMessageSize-12,e.length),r=this.getSendFlags();this.sendFrame({type:Kne.Data,flag:r,streamID:this._id,length:n},e.subarray(0,n)),this.sendWindowCapacity-=n,e.consume(n)}}async sendReset(){this.sendFrame({type:Kne.WindowUpdate,flag:jne.RST,streamID:this._id,length:0})}async sendCloseWrite(){const e=this.getSendFlags()|jne.FIN;this.sendFrame({type:Kne.WindowUpdate,flag:e,streamID:this._id,length:0})}async sendCloseRead(){}async waitForSendWindowCapacity(){var e;let t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.sendWindowCapacity>0)return;const i=()=>{"open"===this.status?n(new aq("stream aborted","ERR_STREAM_ABORT")):t()};null===(e=r.signal)||void 0===e||e.addEventListener("abort",i);try{await new Promise(((e,r)=>{this.sendWindowCapacityUpdate=()=>{e()},n=r,t=e}))}finally{var o;null===(o=r.signal)||void 0===o||o.removeEventListener("abort",i)}}handleWindowUpdate(e){var t;null===(t=this.log)||void 0===t||t.trace("stream received window update id=%s",this._id),this.processFlags(e.flag);const n=this.sendWindowCapacity;var r;(this.sendWindowCapacity+=e.length,0===n&&e.length>0)&&(null===(r=this.sendWindowCapacityUpdate)||void 0===r||r.call(this))}async handleData(e,t){var n;if(null===(n=this.log)||void 0===n||n.trace("stream received data id=%s",this._id),this.processFlags(e.flag),this.recvWindowCapacity<e.length)throw new aq("receive window exceeded",One,{available:this.recvWindowCapacity,recv:e.length});const r=await t();this.recvWindowCapacity-=e.length,this.sourcePush(r)}processFlags(e){(e&jne.ACK)===jne.ACK&&this.state===Wne.SYNSent&&(this.state=Wne.Established),(e&jne.FIN)===jne.FIN&&this.remoteCloseWrite(),(e&jne.RST)===jne.RST&&this.reset()}getSendFlags(){switch(this.state){case Wne.Init:return this.state=Wne.SYNSent,jne.SYN;case Wne.SYNReceived:return this.state=Wne.Established,jne.ACK;default:return 0}}sendWindowUpdate(){const e=this.getSendFlags(),t=Date.now(),n=this.getRTT();if(0===e&&n>-1&&t-this.epochStart<4*n&&(this.recvWindow=Math.min(2*this.recvWindow,this.config.maxStreamWindowSize)),this.recvWindowCapacity>=this.recvWindow&&0===e)return;const r=this.recvWindow-this.recvWindowCapacity;this.recvWindowCapacity=this.recvWindow,this.epochStart=t,this.sendFrame({type:Kne.WindowUpdate,flag:e,streamID:this._id,length:r})}}const Yne="/yamux/1.0.0";class Jne{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,Yo.Z)(this,"protocol",Yne),(0,Yo.Z)(this,"_init",void 0),this._init=e}createStreamMuxer(e){return new Xne({...this._init,...e})}}class Xne{constructor(e){var t;(0,Yo.Z)(this,"protocol",Yne),(0,Yo.Z)(this,"source",void 0),(0,Yo.Z)(this,"sink",void 0),(0,Yo.Z)(this,"config",void 0),(0,Yo.Z)(this,"log",void 0),(0,Yo.Z)(this,"closeController",void 0),(0,Yo.Z)(this,"nextStreamID",void 0),(0,Yo.Z)(this,"_streams",void 0),(0,Yo.Z)(this,"nextPingID",void 0),(0,Yo.Z)(this,"activePing",void 0),(0,Yo.Z)(this,"rtt",void 0),(0,Yo.Z)(this,"client",void 0),(0,Yo.Z)(this,"localGoAway",void 0),(0,Yo.Z)(this,"remoteGoAway",void 0),(0,Yo.Z)(this,"numInboundStreams",void 0),(0,Yo.Z)(this,"numOutboundStreams",void 0),(0,Yo.Z)(this,"onIncomingStream",void 0),(0,Yo.Z)(this,"onStreamEnd",void 0),this.client="outbound"===e.direction,this.config={...Fne,...e},this.log=this.config.log,function(e){if(e.keepAliveInterval<=0)throw new aq("keep-alive interval must be positive",Bne);if(e.maxInboundStreams<0)throw new aq("max inbound streams must be larger or equal 0",Bne);if(e.maxOutboundStreams<0)throw new aq("max outbound streams must be larger or equal 0",Bne);if(e.initialStreamWindowSize<Une)throw new aq("InitialStreamWindowSize must be larger or equal 256 kB",Bne);if(e.maxStreamWindowSize<e.initialStreamWindowSize)throw new aq("MaxStreamWindowSize must be larger than the InitialStreamWindowSize",Bne);if(e.maxStreamWindowSize>2**32-1)throw new aq("MaxStreamWindowSize must be less than equal MAX_UINT32",Bne);if(e.maxMessageSize<1024)throw new aq("MaxMessageSize must be greater than a kilobyte",Bne)}(this.config),this.closeController=new AbortController,dJ(1/0,this.closeController.signal),this.onIncomingStream=e.onIncomingStream,this.onStreamEnd=e.onStreamEnd,this._streams=new Map,this.source=Gq({onEnd:()=>{var e;null===(e=this.log)||void 0===e||e.trace("muxer source ended"),this._streams.forEach((e=>{e.destroy()}))}}),this.sink=async e=>{var t;const n=()=>{const t=ad(e);if(null!=t.return){const e=t.return();null!=(n=e)&&"function"===typeof n.then&&e.catch((e=>{var t;null===(t=this.log)||void 0===t||t.call(this,"could not cause sink source to return",e)}))}var n};let r,i;try{const t=new Vne(e);try{this.closeController.signal.addEventListener("abort",n);for await(const e of t.emitFrames())await this.handleFrame(e.header,e.readData)}finally{this.closeController.signal.removeEventListener("abort",n)}r=Zne.NormalTermination}catch(a){const e=a.code;var o,s;if(Nne.has(e))null===(o=this.log)||void 0===o||o.error("protocol error in sink",a),r=Zne.ProtocolError;else null===(s=this.log)||void 0===s||s.error("internal error in sink",a),r=Zne.InternalError;i=a}null===(t=this.log)||void 0===t||t.trace("muxer sink ended"),null!=i?this.abort(i,r):await this.close({reason:r})},this.numInboundStreams=0,this.numOutboundStreams=0,this.nextStreamID=this.client?1:2,this.nextPingID=0,this.rtt=-1,null===(t=this.log)||void 0===t||t.trace("muxer created"),this.config.enableKeepAlive&&this.keepAliveLoop().catch((e=>{var t;return null===(t=this.log)||void 0===t?void 0:t.error("keepalive error: %s",e)})),this.ping().catch((e=>{var t;return null===(t=this.log)||void 0===t?void 0:t.error("ping error: %s",e)}))}get streams(){return Array.from(this._streams.values())}newStream(e){var t;if(void 0!==this.remoteGoAway)throw new aq("muxer closed remotely",Mne);if(void 0!==this.localGoAway)throw new aq("muxer closed locally",Lne);const n=this.nextStreamID;if(this.nextStreamID+=2,this.numOutboundStreams>=this.config.maxOutboundStreams)throw new aq("max outbound streams exceeded","ERROR_MAX_OUTBOUND_STREAMS_EXCEEDED");null===(t=this.log)||void 0===t||t.trace("new outgoing stream id=%s",n);const r=this._newStream(n,e,Wne.Init,"outbound");return this._streams.set(n,r),this.numOutboundStreams++,r.sendWindowUpdate(),r}async ping(){if(void 0!==this.remoteGoAway)throw new aq("muxer closed remotely",Mne);if(void 0!==this.localGoAway)throw new aq("muxer closed locally",Lne);if(void 0===this.activePing){let e=()=>{};this.activePing={id:this.nextPingID++,promise:new Promise(((t,n)=>{const r=()=>{n(new aq("muxer closed locally",Lne))};this.closeController.signal.addEventListener("abort",r,{once:!0}),e=()=>{this.closeController.signal.removeEventListener("abort",r),t()}})),resolve:e};const t=Date.now();this.sendPing(this.activePing.id);try{await this.activePing.promise}finally{delete this.activePing}const n=Date.now();this.rtt=n-t}else await this.activePing.promise;return this.rtt}getRTT(){return this.rtt}async close(){var e,t,n;let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.closeController.signal.aborted)return;const i=null!==(e=null===(t=r)||void 0===t?void 0:t.reason)&&void 0!==e?e:Zne.NormalTermination;if(null===(n=this.log)||void 0===n||n.trace("muxer close reason=%s",i),null==r.signal){const e=AbortSignal.timeout(500);dJ(1/0,e),r={...r,signal:e}}try{await Promise.all([...this._streams.values()].map((async e=>e.close(r)))),this.sendGoAway(i),this._closeMuxer()}catch(o){this.abort(o)}}abort(e,t){var n,r;if(!this.closeController.signal.aborted){t=null!==(n=t)&&void 0!==n?n:Zne.InternalError,null===(r=this.log)||void 0===r||r.error("muxer abort reason=%s error=%s",t,e);for(const t of this._streams.values())t.abort(e);this.sendGoAway(t),this._closeMuxer()}}isClosed(){return this.closeController.signal.aborted}_closeMuxer(){this.closeController.abort(),this.source.end()}_newStream(e,t,n,r){if(null!=this._streams.get(e))throw new aq("Stream already exists",xne,{id:e});const i=new Qne({id:e.toString(),name:t,state:n,direction:r,sendFrame:this.sendFrame.bind(this),onEnd:()=>{var t;this.closeStream(e),null===(t=this.onStreamEnd)||void 0===t||t.call(this,i)},log:aH("libp2p:yamux:".concat(r,":").concat(e)),config:this.config,getRTT:this.getRTT.bind(this)});return i}closeStream(e){this.client===(e%2===0)?this.numInboundStreams--:this.numOutboundStreams--,this._streams.delete(e)}async keepAliveLoop(){var e;const t=new Promise(((e,t)=>{this.closeController.signal.addEventListener("abort",t,{once:!0})}));for(null===(e=this.log)||void 0===e||e.trace("muxer keepalive enabled interval=%s",this.config.keepAliveInterval);;){let e;try{await Promise.race([t,new Promise((t=>{e=setTimeout(t,this.config.keepAliveInterval)}))]),this.ping().catch((e=>{var t;return null===(t=this.log)||void 0===t?void 0:t.error("ping error: %s",e)}))}catch(n){return void clearInterval(e)}}}async handleFrame(e,t){var n;const{streamID:r,type:i,length:o}=e;if(null===(n=this.log)||void 0===n||n.trace("received frame %o",e),0===r)switch(i){case Kne.Ping:return void this.handlePing(e);case Kne.GoAway:return void this.handleGoAway(o);default:throw new aq("Invalid frame type",Tne,{header:e})}else switch(e.type){case Kne.Data:case Kne.WindowUpdate:return void await this.handleStreamMessage(e,t);default:throw new aq("Invalid frame type",Tne,{header:e})}}handlePing(e){if(e.flag===jne.SYN){var t;null===(t=this.log)||void 0===t||t.trace("received ping request pingId=%s",e.length),this.sendPing(e.length,jne.ACK)}else{if(e.flag!==jne.ACK)throw new aq("Invalid frame flag",Tne,{header:e});var n;null===(n=this.log)||void 0===n||n.trace("received ping response pingId=%s",e.length),this.handlePingResponse(e.length)}}handlePingResponse(e){if(void 0===this.activePing)throw new aq("ping not requested",kne);if(this.activePing.id!==e)throw new aq("ping doesn't match our id",Rne);this.activePing.resolve()}handleGoAway(e){var t,n;null===(t=this.log)||void 0===t||t.trace("received GoAway reason=%s",null!==(n=Zne[e])&&void 0!==n?n:"unknown"),this.remoteGoAway=e;for(const r of this._streams.values())r.reset();this._closeMuxer()}async handleStreamMessage(e,t){const{streamID:n,flag:r,type:i}=e;(r&jne.SYN)===jne.SYN&&this.incomingStream(n);const o=this._streams.get(n);if(void 0!==o)switch(i){case Kne.WindowUpdate:return void o.handleWindowUpdate(e);case Kne.Data:if(void 0===t)throw new Error("unreachable");return void await o.handleData(e,t);default:throw new Error("unreachable")}else if(i===Kne.Data){var s;if(null===(s=this.log)||void 0===s||s.call(this,"discarding data for stream id=%s",n),void 0===t)throw new Error("unreachable");await t()}else{var a;null===(a=this.log)||void 0===a||a.call(this,"frame for missing stream id=%s",n)}}incomingStream(e){var t,n,r;if(this.client!==(e%2===0))throw new aq("both endpoints are clients",Dne);if(this._streams.has(e))return;if(null===(t=this.log)||void 0===t||t.trace("new incoming stream id=%s",e),void 0!==this.localGoAway)return void this.sendFrame({type:Kne.WindowUpdate,flag:jne.RST,streamID:e,length:0});if(this.numInboundStreams>=this.config.maxInboundStreams)return null===(r=this.log)||void 0===r||r.call(this,"maxIncomingStreams exceeded, forcing stream reset"),void this.sendFrame({type:Kne.WindowUpdate,flag:jne.RST,streamID:e,length:0});const i=this._newStream(e,void 0,Wne.SYNReceived,"inbound");this.numInboundStreams++,this._streams.set(e,i),null===(n=this.onIncomingStream)||void 0===n||n.call(this,i)}sendFrame(e,t){var n;if(null===(n=this.log)||void 0===n||n.trace("sending frame %o",e),e.type===Kne.Data){if(void 0===t)throw new aq("invalid frame",Tne);this.source.push(Hne(e)),this.source.push(t)}else this.source.push(Hne(e))}sendPing(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jne.SYN;var n,r;t===jne.SYN?null===(n=this.log)||void 0===n||n.trace("sending ping request pingId=%s",e):null===(r=this.log)||void 0===r||r.trace("sending ping response pingId=%s",e);this.sendFrame({type:Kne.Ping,flag:t,streamID:0,length:e})}sendGoAway(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Zne.NormalTermination;null===(e=this.log)||void 0===e||e.call(this,"sending GoAway reason=%s",Zne[t]),this.localGoAway=t,this.sendFrame({type:Kne.GoAway,flag:0,streamID:0,length:t})}}function $ne(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return()=>new Jne(e)}var ere,tre=new WeakMap;class nre extends EventTarget{constructor(){super(...arguments),(0,dx.Z)(this,tre,{writable:!0,value:new Map})}listenerCount(e){const t=(0,fx.Z)(this,tre).get(e);return null==t?0:t.length}addEventListener(e,t,n){var r;super.addEventListener(e,t,n);let i=(0,fx.Z)(this,tre).get(e);null==i&&(i=[],(0,fx.Z)(this,tre).set(e,i)),i.push({callback:t,once:null!==(r=!0!==n&&!1!==n&&(null===n||void 0===n?void 0:n.once))&&void 0!==r&&r})}removeEventListener(e,t,n){super.removeEventListener(e.toString(),null!==t&&void 0!==t?t:null,n);let r=(0,fx.Z)(this,tre).get(e);null!=r&&(r=r.filter((e=>{let{callback:n}=e;return n!==t})),(0,fx.Z)(this,tre).set(e,r))}dispatchEvent(e){const t=super.dispatchEvent(e);let n=(0,fx.Z)(this,tre).get(e.type);return null==n||(n=n.filter((e=>{let{once:t}=e;return!t})),(0,fx.Z)(this,tre).set(e.type,n)),t}safeDispatchEvent(e,t){return this.dispatchEvent(new ire(e,t))}}class rre extends Event{constructor(e,t){super(e,t),(0,Yo.Z)(this,"detail",void 0),this.detail=null===t||void 0===t?void 0:t.detail}}const ire=null!==(ere=globalThis.CustomEvent)&&void 0!==ere?ere:rre,ore=Symbol.for("@libp2p/peer-discovery");var sre=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==n[s])throw new TypeError(o+" is ambiguous");n[s]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var r=0,i=0;e[t]===c;)r++,t++;for(var o=(e.length-t)*l+1>>>0,s=new Uint8Array(o);e[t];){var u=n[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=o-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*s[d]>>>0,s[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=o-i;f!==o&&0===s[f];)f++;for(var p=new Uint8Array(r+(o-f)),g=r;f!==o;)p[g++]=s[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,o=t.length;i!==o&&0===t[i];)i++,n++;for(var s=(o-i)*u+1>>>0,l=new Uint8Array(s);i!==o;){for(var h=t[i],d=0,f=s-1;(0!==h||d<r)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");r=d,i++}for(var p=s-r;p!==s&&0===l[p];)p++;for(var g=c.repeat(n);p<s;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:h,decode:function(e){var n=h(e);if(n)return n;throw new Error("Non-".concat(t," character"))}}};const are=sre,cre=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class lre{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(e));throw Error("Unknown type, must be binary type")}}class ure{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(e),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return dre(this,e)}}class hre{constructor(e){this.decoders=e}or(e){return dre(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(e),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}}const dre=(e,t)=>new hre({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class fre{constructor(e,t,n,r){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=r,this.encoder=new lre(e,t,n),this.decoder=new ure(e,t,r)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const pre=e=>{let{name:t,prefix:n,encode:r,decode:i}=e;return new fre(t,n,r,i)},gre=e=>{let{prefix:t,name:n,alphabet:r}=e;const{encode:i,decode:o}=are(r,n);return pre({prefix:t,name:n,encode:i,decode:e=>cre(o(e))})},yre=e=>{let{name:t,prefix:n,bitsPerChar:r,alphabet:i}=e;return pre({prefix:n,name:t,encode:e=>((e,t,n)=>{const r="="===t[t.length-1],i=(1<<n)-1;let o="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>n;)s-=n,o+=t[i&a>>s];if(s&&(o+=t[i&a<<n-s]),r)for(;o.length*n&7;)o+="=";return o})(e,i,r),decode:e=>((e,t,n,r)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*n/8|0);let a=0,c=0,l=0;for(let u=0;u<o;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError("Non-".concat(r," character"));c=c<<n|t,a+=n,a>=8&&(a-=8,s[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s})(e,i,r,t)})},mre=yre({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),vre=yre({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),bre=yre({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),wre=yre({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Ere=yre({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Are=yre({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Sre=yre({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),_re=yre({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Ire=yre({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Cre=gre({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Tre=gre({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),kre=yre({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Rre=yre({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),xre=yre({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Pre=yre({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function Dre(e){let t=function(e){const t=()=>{};return t.enabled=!1,t.color="",t.diff=0,t.log=()=>{},t.namespace=e,t.destroy=()=>!0,t.extend=()=>t,t}("".concat(e,":trace"));return sf().enabled("".concat(e,":trace"))&&null!=sf().names.map((e=>e.toString())).find((e=>e.includes(":trace")))&&(t=sf()("".concat(e,":trace"))),Object.assign(sf()(e),{error:sf()("".concat(e,":error")),trace:t})}sf().formatters.b=e=>null==e?"undefined":Cre.baseEncode(e),sf().formatters.t=e=>null==e?"undefined":mre.baseEncode(e),sf().formatters.m=e=>null==e?"undefined":kre.baseEncode(e),sf().formatters.p=e=>null==e?"undefined":e.toString(),sf().formatters.c=e=>null==e?"undefined":e.toString(),sf().formatters.k=e=>null==e?"undefined":e.toString(),sf().formatters.a=e=>null==e?"undefined":e.toString();class Ore extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"The operation was aborted"),(0,Yo.Z)(this,"code",void 0),(0,Yo.Z)(this,"type",void 0),this.code=Ore.code,this.type=Ore.type}}(0,Yo.Z)(Ore,"code","ABORT_ERR"),(0,Yo.Z)(Ore,"type","aborted");class Nre extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected Peer"),(0,Yo.Z)(this,"code",void 0),this.code=Nre.code}}(0,Yo.Z)(Nre,"code","ERR_UNEXPECTED_PEER");class Bre extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid crypto exchange"),(0,Yo.Z)(this,"code",void 0),this.code=Bre.code}}(0,Yo.Z)(Bre,"code","ERR_INVALID_CRYPTO_EXCHANGE");class Lre extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid crypto transmission"),(0,Yo.Z)(this,"code",void 0),this.code=Lre.code}}(0,Yo.Z)(Lre,"code","ERR_INVALID_CRYPTO_TRANSMISSION");const Mre=Symbol.for("@libp2p/peer-id");const Ure=gre({prefix:"9",name:"base10",alphabet:"0123456789"}),Fre=yre({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Kre=yre({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),jre=yre({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Zre=Array.from("\ud83d\ude80\ud83e\ude90\u2604\ud83d\udef0\ud83c\udf0c\ud83c\udf11\ud83c\udf12\ud83c\udf13\ud83c\udf14\ud83c\udf15\ud83c\udf16\ud83c\udf17\ud83c\udf18\ud83c\udf0d\ud83c\udf0f\ud83c\udf0e\ud83d\udc09\u2600\ud83d\udcbb\ud83d\udda5\ud83d\udcbe\ud83d\udcbf\ud83d\ude02\u2764\ud83d\ude0d\ud83e\udd23\ud83d\ude0a\ud83d\ude4f\ud83d\udc95\ud83d\ude2d\ud83d\ude18\ud83d\udc4d\ud83d\ude05\ud83d\udc4f\ud83d\ude01\ud83d\udd25\ud83e\udd70\ud83d\udc94\ud83d\udc96\ud83d\udc99\ud83d\ude22\ud83e\udd14\ud83d\ude06\ud83d\ude44\ud83d\udcaa\ud83d\ude09\u263a\ud83d\udc4c\ud83e\udd17\ud83d\udc9c\ud83d\ude14\ud83d\ude0e\ud83d\ude07\ud83c\udf39\ud83e\udd26\ud83c\udf89\ud83d\udc9e\u270c\u2728\ud83e\udd37\ud83d\ude31\ud83d\ude0c\ud83c\udf38\ud83d\ude4c\ud83d\ude0b\ud83d\udc97\ud83d\udc9a\ud83d\ude0f\ud83d\udc9b\ud83d\ude42\ud83d\udc93\ud83e\udd29\ud83d\ude04\ud83d\ude00\ud83d\udda4\ud83d\ude03\ud83d\udcaf\ud83d\ude48\ud83d\udc47\ud83c\udfb6\ud83d\ude12\ud83e\udd2d\u2763\ud83d\ude1c\ud83d\udc8b\ud83d\udc40\ud83d\ude2a\ud83d\ude11\ud83d\udca5\ud83d\ude4b\ud83d\ude1e\ud83d\ude29\ud83d\ude21\ud83e\udd2a\ud83d\udc4a\ud83e\udd73\ud83d\ude25\ud83e\udd24\ud83d\udc49\ud83d\udc83\ud83d\ude33\u270b\ud83d\ude1a\ud83d\ude1d\ud83d\ude34\ud83c\udf1f\ud83d\ude2c\ud83d\ude43\ud83c\udf40\ud83c\udf37\ud83d\ude3b\ud83d\ude13\u2b50\u2705\ud83e\udd7a\ud83c\udf08\ud83d\ude08\ud83e\udd18\ud83d\udca6\u2714\ud83d\ude23\ud83c\udfc3\ud83d\udc90\u2639\ud83c\udf8a\ud83d\udc98\ud83d\ude20\u261d\ud83d\ude15\ud83c\udf3a\ud83c\udf82\ud83c\udf3b\ud83d\ude10\ud83d\udd95\ud83d\udc9d\ud83d\ude4a\ud83d\ude39\ud83d\udde3\ud83d\udcab\ud83d\udc80\ud83d\udc51\ud83c\udfb5\ud83e\udd1e\ud83d\ude1b\ud83d\udd34\ud83d\ude24\ud83c\udf3c\ud83d\ude2b\u26bd\ud83e\udd19\u2615\ud83c\udfc6\ud83e\udd2b\ud83d\udc48\ud83d\ude2e\ud83d\ude46\ud83c\udf7b\ud83c\udf43\ud83d\udc36\ud83d\udc81\ud83d\ude32\ud83c\udf3f\ud83e\udde1\ud83c\udf81\u26a1\ud83c\udf1e\ud83c\udf88\u274c\u270a\ud83d\udc4b\ud83d\ude30\ud83e\udd28\ud83d\ude36\ud83e\udd1d\ud83d\udeb6\ud83d\udcb0\ud83c\udf53\ud83d\udca2\ud83e\udd1f\ud83d\ude41\ud83d\udea8\ud83d\udca8\ud83e\udd2c\u2708\ud83c\udf80\ud83c\udf7a\ud83e\udd13\ud83d\ude19\ud83d\udc9f\ud83c\udf31\ud83d\ude16\ud83d\udc76\ud83e\udd74\u25b6\u27a1\u2753\ud83d\udc8e\ud83d\udcb8\u2b07\ud83d\ude28\ud83c\udf1a\ud83e\udd8b\ud83d\ude37\ud83d\udd7a\u26a0\ud83d\ude45\ud83d\ude1f\ud83d\ude35\ud83d\udc4e\ud83e\udd32\ud83e\udd20\ud83e\udd27\ud83d\udccc\ud83d\udd35\ud83d\udc85\ud83e\uddd0\ud83d\udc3e\ud83c\udf52\ud83d\ude17\ud83e\udd11\ud83c\udf0a\ud83e\udd2f\ud83d\udc37\u260e\ud83d\udca7\ud83d\ude2f\ud83d\udc86\ud83d\udc46\ud83c\udfa4\ud83d\ude47\ud83c\udf51\u2744\ud83c\udf34\ud83d\udca3\ud83d\udc38\ud83d\udc8c\ud83d\udccd\ud83e\udd40\ud83e\udd22\ud83d\udc45\ud83d\udca1\ud83d\udca9\ud83d\udc50\ud83d\udcf8\ud83d\udc7b\ud83e\udd10\ud83e\udd2e\ud83c\udfbc\ud83e\udd75\ud83d\udea9\ud83c\udf4e\ud83c\udf4a\ud83d\udc7c\ud83d\udc8d\ud83d\udce3\ud83e\udd42"),zre=Zre.reduce(((e,t,n)=>(e[n]=t,e)),[]),Vre=Zre.reduce(((e,t,n)=>(e[t.codePointAt(0)]=n,e)),[]);const Hre=pre({prefix:"\ud83d\ude80",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=zre[t]),"")},decode:function(e){const t=[];for(const n of e){const e=Vre[n.codePointAt(0)];if(void 0===e)throw new Error("Non-base256emoji character: ".concat(n));t.push(e)}return new Uint8Array(t)}}),qre=gre({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Gre=gre({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Wre=yre({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),Qre=pre({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),Yre=new TextEncoder,Jre=new TextDecoder,Xre="json",$re=512,eie=e=>Yre.encode(JSON.stringify(e)),tie=e=>JSON.parse(Jre.decode(e)),nie="raw",rie=85,iie=e=>cre(e),oie=e=>cre(e);var sie=function e(t,n,r){n=n||[];var i=r=r||0;for(;t>=lie;)n[r++]=255&t|aie,t/=128;for(;t&cie;)n[r++]=255&t|aie,t>>>=7;return n[r]=0|t,e.bytes=r-i+1,n},aie=128,cie=-128,lie=Math.pow(2,31);var uie=function e(t,n){var r,i=0,o=0,s=n=n||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");r=t[s++],i+=o<28?(r&die)<<o:(r&die)*Math.pow(2,o),o+=7}while(r>=hie);return e.bytes=s-n,i},hie=128,die=127;var fie=Math.pow(2,7),pie=Math.pow(2,14),gie=Math.pow(2,21),yie=Math.pow(2,28),mie=Math.pow(2,35),vie=Math.pow(2,42),bie=Math.pow(2,49),wie=Math.pow(2,56),Eie=Math.pow(2,63);const Aie={encode:sie,decode:uie,encodingLength:function(e){return e<fie?1:e<pie?2:e<gie?3:e<yie?4:e<mie?5:e<vie?6:e<bie?7:e<wie?8:e<Eie?9:10}},Sie=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return[Aie.decode(e,t),Aie.decode.bytes]},_ie=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Aie.encode(e,t,n),t},Iie=e=>Aie.encodingLength(e),Cie=(e,t)=>{const n=t.byteLength,r=Iie(e),i=r+Iie(n),o=new Uint8Array(i+n);return _ie(e,o,0),_ie(n,o,r),o.set(t,i),new kie(e,n,t,o)},Tie=e=>{const t=cre(e),[n,r]=Sie(t),[i,o]=Sie(t.subarray(r)),s=t.subarray(r+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new kie(n,i,s,t)};class kie{constructor(e,t,n,r){this.code=e,this.size=t,this.digest=n,this.bytes=r}}const Rie=cre,xie={code:0,name:"identity",encode:Rie,digest:e=>Cie(0,Rie(e))},Pie=e=>{let{name:t,code:n,encode:r}=e;return new Die(t,n,r)};class Die{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Cie(this.code,t):t.then((e=>Cie(this.code,e)))}throw Error("Unknown type, must be binary type")}}const Oie=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Nie=Pie({name:"sha2-256",code:18,encode:Oie("SHA-256")}),Bie=Pie({name:"sha2-512",code:19,encode:Oie("SHA-512")}),Lie=(e,t)=>{const{bytes:n,version:r}=e;return 0===r?jie(n,Uie(e),t||Cre.encoder):Zie(n,Uie(e),t||mre.encoder)},Mie=new WeakMap,Uie=e=>{const t=Mie.get(e);if(null==t){const t=new Map;return Mie.set(e,t),t}return t};class Fie{constructor(e,t,n,r){this.code=t,this.version=e,this.multihash=n,this.bytes=r,this["/"]=r}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==zie)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==Vie)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Fie.createV0(t)}default:throw Error("Can not convert CID version ".concat(this.version," to version 0. This is a bug please report"))}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=Cie(e,t);return Fie.createV1(this.code,n)}case 1:return this;default:throw Error("Can not convert CID version ".concat(this.version," to version 1. This is a bug please report"))}}equals(e){return Fie.equals(this,e)}static equals(e,t){const n=t;return n&&e.code===n.code&&e.version===n.version&&((e,t)=>{if(e===t)return!0;{const n=t;return e.code===n.code&&e.size===n.size&&n.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0})(e.bytes,n.bytes)}})(e.multihash,n.multihash)}toString(e){return Lie(this,e)}toJSON(){return{"/":Lie(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID(".concat(this.toString(),")")}static asCID(e){if(null==e)return null;const t=e;if(t instanceof Fie)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:n,multihash:r,bytes:i}=t;return new Fie(e,n,r,i||Hie(e,n,r.bytes))}if(!0===t[qie]){const{version:e,multihash:n,code:r}=t,i=Tie(n);return Fie.create(e,r,i)}return null}static create(e,t,n){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==zie)throw new Error("Version 0 CID must use dag-pb (code: ".concat(zie,") block encoding"));return new Fie(e,t,n,n.bytes);case 1:{const r=Hie(e,t,n.bytes);return new Fie(e,t,n,r)}default:throw new Error("Invalid version")}}static createV0(e){return Fie.create(0,zie,e)}static createV1(e,t){return Fie.create(1,e,t)}static decode(e){const[t,n]=Fie.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=Fie.inspectBytes(e),n=t.size-t.multihashSize,r=cre(e.subarray(n,n+t.multihashSize));if(r.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=r.subarray(t.multihashSize-t.digestSize),o=new kie(t.multihashCode,t.digestSize,i,r);return[0===t.version?Fie.createV0(o):Fie.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[n,r]=Sie(e.subarray(t));return t+=r,n};let r=n(),i=zie;if(18===r?(r=0,t=0):i=n(),0!==r&&1!==r)throw new RangeError("Invalid CID version ".concat(r));const o=t,s=n(),a=n(),c=t+a;return{version:r,codec:i,multihashCode:s,digestSize:a,multihashSize:c-o,size:c}}static parse(e,t){const[n,r]=Kie(e,t),i=Fie.decode(r);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return Uie(i).set(n,e),i}}const Kie=(e,t)=>{switch(e[0]){case"Q":{const n=t||Cre;return[Cre.prefix,n.decode("".concat(Cre.prefix).concat(e))]}case Cre.prefix:{const n=t||Cre;return[Cre.prefix,n.decode(e)]}case mre.prefix:{const n=t||mre;return[mre.prefix,n.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},jie=(e,t,n)=>{const{prefix:r}=n;if(r!==Cre.prefix)throw Error("Cannot string encode V0 in ".concat(n.name," encoding"));const i=t.get(r);if(null==i){const i=n.encode(e).slice(1);return t.set(r,i),i}return i},Zie=(e,t,n)=>{const{prefix:r}=n,i=t.get(r);if(null==i){const i=n.encode(e);return t.set(r,i),i}return i},zie=112,Vie=18,Hie=(e,t,n)=>{const r=Iie(e),i=r+Iie(t),o=new Uint8Array(i+n.byteLength);return _ie(e,o,0),_ie(t,o,r),o.set(n,i),o},qie=Symbol.for("@ipld/js-cid/CID"),Gie={...Ir,...Er,..._r,...br,...wr,...yr,...Sr,...mr,...vr,...Ar},Wie=Symbol.for("nodejs.util.inspect.custom"),Qie=Object.values(Gie).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)),Gie.identity.decoder),Yie=114,Jie=36,Xie=37;class $ie{constructor(e){(0,Yo.Z)(this,"type",void 0),(0,Yo.Z)(this,"multihash",void 0),(0,Yo.Z)(this,"privateKey",void 0),(0,Yo.Z)(this,"publicKey",void 0),(0,Yo.Z)(this,"string",void 0),(0,Yo.Z)(this,Mre,!0),this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return"PeerId(".concat(this.toString(),")")}toString(){return null==this.string&&(this.string=Cre.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return Fie.createV1(Yie,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){var t;if(e instanceof Uint8Array)return(0,Ms.f)(this.multihash.bytes,e);if("string"===typeof e)return roe(e).equals(this);if(null!=(null===e||void 0===e||null===(t=e.multihash)||void 0===t?void 0:t.bytes))return(0,Ms.f)(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[Wie](){return"PeerId(".concat(this.toString(),")")}}class eoe extends $ie{constructor(e){super({...e,type:"RSA"}),(0,Yo.Z)(this,"type","RSA"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.publicKey}}class toe extends $ie{constructor(e){super({...e,type:"Ed25519"}),(0,Yo.Z)(this,"type","Ed25519"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.multihash.digest}}class noe extends $ie{constructor(e){super({...e,type:"secp256k1"}),(0,Yo.Z)(this,"type","secp256k1"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.multihash.digest}}function roe(e,t){var n;if(t=null!==(n=t)&&void 0!==n?n:Qie,"1"===e.charAt(0)||"Q"===e.charAt(0)){const t=Tie(Cre.decode("z".concat(e)));return e.startsWith("12D")?new toe({multihash:t}):e.startsWith("16U")?new noe({multihash:t}):new eoe({multihash:t})}return function(e){try{const t=Tie(e);if(t.code===xie.code){if(t.digest.length===Jie)return new toe({multihash:t});if(t.digest.length===Xie)return new noe({multihash:t})}if(t.code===Nie.code)return new eoe({multihash:t})}catch{return function(e){if(null==e||null==e.multihash||null==e.version||1===e.version&&e.code!==Yie)throw new Error("Supplied PeerID CID is invalid");const t=e.multihash;if(t.code===Nie.code)return new eoe({multihash:e.multihash});if(t.code===xie.code){if(t.digest.length===Jie)return new toe({multihash:e.multihash});if(t.digest.length===Xie)return new noe({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}(Fie.decode(e))}throw new Error("Supplied PeerID CID is invalid")}(Qie.decode(e))}const ioe=Dre("libp2p:bootstrap");class ooe extends nre{constructor(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{list:[]};if(null==n.list||0===n.list.length)throw new Error("Bootstrap requires a list of peer addresses");super(),(0,Yo.Z)(this,"timer",void 0),(0,Yo.Z)(this,"list",void 0),(0,Yo.Z)(this,"timeout",void 0),(0,Yo.Z)(this,"components",void 0),(0,Yo.Z)(this,"_init",void 0),(0,Yo.Z)(this,ore,this),(0,Yo.Z)(this,Symbol.toStringTag,"@libp2p/bootstrap"),this.components=e,this.timeout=null!==(t=n.timeout)&&void 0!==t?t:1e3,this.list=[];for(const r of n.list){if(!Yx.matches(r)){ioe.error("Invalid multiaddr");continue}const e=(0,ng.HM)(r),t=e.getPeerId();if(null==t){ioe.error("Invalid bootstrap multiaddr without peer id");continue}const n={id:roe(t),multiaddrs:[e],protocols:[]};this.list.push(n)}this._init=n}isStarted(){return Boolean(this.timer)}start(){this.isStarted()||(ioe("Starting bootstrap node discovery, discovering peers after %s ms",this.timeout),this.timer=setTimeout((()=>{this._discoverBootstrapPeers().catch((e=>{ioe.error(e)}))}),this.timeout))}async _discoverBootstrapPeers(){if(null!=this.timer)for(const r of this.list){var e,t,n;if(await this.components.peerStore.merge(r.id,{tags:{[null!==(e=this._init.tagName)&&void 0!==e?e:"bootstrap"]:{value:null!==(t=this._init.tagValue)&&void 0!==t?t:50,ttl:null!==(n=this._init.tagTTL)&&void 0!==n?n:12e4}}}),null==this.timer)return;this.safeDispatchEvent("peer",{detail:r})}}stop(){null!=this.timer&&clearTimeout(this.timer),this.timer=void 0}}function soe(e){return t=>new ooe(t,e)}(0,Yo.Z)(ooe,"tag","bootstrap");const aoe=Symbol.for("@libp2p/content-routing");class coe extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"The operation was aborted"),(0,Yo.Z)(this,"code",void 0),(0,Yo.Z)(this,"type",void 0),this.code=coe.code,this.type=coe.type}}(0,Yo.Z)(coe,"code","ABORT_ERR"),(0,Yo.Z)(coe,"type","aborted");class loe extends Error{constructor(e,t,n){var r;super(e),(0,Yo.Z)(this,"code",void 0),(0,Yo.Z)(this,"props",void 0),this.code=t,this.name=null!==(r=null===n||void 0===n?void 0:n.name)&&void 0!==r?r:"CodeError",this.props=null!==n&&void 0!==n?n:{}}}class uoe extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected Peer"),(0,Yo.Z)(this,"code",void 0),this.code=uoe.code}}(0,Yo.Z)(uoe,"code","ERR_UNEXPECTED_PEER");class hoe extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid crypto exchange"),(0,Yo.Z)(this,"code",void 0),this.code=hoe.code}}(0,Yo.Z)(hoe,"code","ERR_INVALID_CRYPTO_EXCHANGE");class doe extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid crypto transmission"),(0,Yo.Z)(this,"code",void 0),this.code=doe.code}}var foe;(0,Yo.Z)(doe,"code","ERR_INVALID_CRYPTO_TRANSMISSION");var poe=new WeakMap;class goe extends EventTarget{constructor(){super(...arguments),(0,dx.Z)(this,poe,{writable:!0,value:new Map})}listenerCount(e){const t=(0,fx.Z)(this,poe).get(e);return null==t?0:t.length}addEventListener(e,t,n){var r;super.addEventListener(e,t,n);let i=(0,fx.Z)(this,poe).get(e);null==i&&(i=[],(0,fx.Z)(this,poe).set(e,i)),i.push({callback:t,once:null!==(r=!0!==n&&!1!==n&&(null===n||void 0===n?void 0:n.once))&&void 0!==r&&r})}removeEventListener(e,t,n){super.removeEventListener(e.toString(),null!==t&&void 0!==t?t:null,n);let r=(0,fx.Z)(this,poe).get(e);null!=r&&(r=r.filter((e=>{let{callback:n}=e;return n!==t})),(0,fx.Z)(this,poe).set(e,r))}dispatchEvent(e){const t=super.dispatchEvent(e);let n=(0,fx.Z)(this,poe).get(e.type);return null==n||(n=n.filter((e=>{let{once:t}=e;return!t})),(0,fx.Z)(this,poe).set(e.type,n)),t}safeDispatchEvent(e,t){return this.dispatchEvent(new moe(e,t))}}class yoe extends Event{constructor(e,t){super(e,t),(0,Yo.Z)(this,"detail",void 0),this.detail=null===t||void 0===t?void 0:t.detail}}const moe=null!==(foe=globalThis.CustomEvent)&&void 0!==foe?foe:yoe,voe=function(e){try{for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r]}catch{}},boe=Symbol.for("@libp2p/peer-discovery"),woe=Symbol.for("@libp2p/peer-routing");var Eoe=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==n[s])throw new TypeError(o+" is ambiguous");n[s]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var r=0,i=0;e[t]===c;)r++,t++;for(var o=(e.length-t)*l+1>>>0,s=new Uint8Array(o);e[t];){var u=n[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=o-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*s[d]>>>0,s[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=o-i;f!==o&&0===s[f];)f++;for(var p=new Uint8Array(r+(o-f)),g=r;f!==o;)p[g++]=s[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,o=t.length;i!==o&&0===t[i];)i++,n++;for(var s=(o-i)*u+1>>>0,l=new Uint8Array(s);i!==o;){for(var h=t[i],d=0,f=s-1;(0!==h||d<r)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");r=d,i++}for(var p=s-r;p!==s&&0===l[p];)p++;for(var g=c.repeat(n);p<s;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:h,decode:function(e){var n=h(e);if(n)return n;throw new Error("Non-".concat(t," character"))}}};const Aoe=Eoe,Soe=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class _oe{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(e));throw Error("Unknown type, must be binary type")}}class Ioe{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(e),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return Toe(this,e)}}class Coe{constructor(e){this.decoders=e}or(e){return Toe(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(e),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}}const Toe=(e,t)=>new Coe({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class koe{constructor(e,t,n,r){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=r,this.encoder=new _oe(e,t,n),this.decoder=new Ioe(e,t,r)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Roe=e=>{let{name:t,prefix:n,encode:r,decode:i}=e;return new koe(t,n,r,i)},xoe=e=>{let{prefix:t,name:n,alphabet:r}=e;const{encode:i,decode:o}=Aoe(r,n);return Roe({prefix:t,name:n,encode:i,decode:e=>Soe(o(e))})},Poe=e=>{let{name:t,prefix:n,bitsPerChar:r,alphabet:i}=e;return Roe({prefix:n,name:t,encode:e=>((e,t,n)=>{const r="="===t[t.length-1],i=(1<<n)-1;let o="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>n;)s-=n,o+=t[i&a>>s];if(s&&(o+=t[i&a<<n-s]),r)for(;o.length*n&7;)o+="=";return o})(e,i,r),decode:e=>((e,t,n,r)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*n/8|0);let a=0,c=0,l=0;for(let u=0;u<o;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError("Non-".concat(r," character"));c=c<<n|t,a+=n,a>=8&&(a-=8,s[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s})(e,i,r,t)})},Doe=Poe({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Ooe=Poe({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Noe=Poe({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Boe=Poe({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Loe=Poe({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Moe=Poe({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Uoe=Poe({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Foe=Poe({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Koe=Poe({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),joe=xoe({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Zoe=xoe({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),zoe=Poe({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Voe=Poe({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Hoe=Poe({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),qoe=Poe({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function Goe(e){let t=function(e){const t=()=>{};return t.enabled=!1,t.color="",t.diff=0,t.log=()=>{},t.namespace=e,t.destroy=()=>!0,t.extend=()=>t,t}("".concat(e,":trace"));return sf().enabled("".concat(e,":trace"))&&null!=sf().names.map((e=>e.toString())).find((e=>e.includes(":trace")))&&(t=sf()("".concat(e,":trace"))),Object.assign(sf()(e),{error:sf()("".concat(e,":error")),trace:t})}sf().formatters.b=e=>null==e?"undefined":joe.baseEncode(e),sf().formatters.t=e=>null==e?"undefined":Doe.baseEncode(e),sf().formatters.m=e=>null==e?"undefined":zoe.baseEncode(e),sf().formatters.p=e=>null==e?"undefined":e.toString(),sf().formatters.c=e=>null==e?"undefined":e.toString(),sf().formatters.k=e=>null==e?"undefined":e.toString(),sf().formatters.a=e=>null==e?"undefined":e.toString();const Woe=function(e){if(null!=e[Symbol.asyncIterator])return(async()=>{for await(const t of e);})();for(const t of e);};class Qoe{constructor(e){if((0,Yo.Z)(this,"buffer",void 0),(0,Yo.Z)(this,"mask",void 0),(0,Yo.Z)(this,"top",void 0),(0,Yo.Z)(this,"btm",void 0),(0,Yo.Z)(this,"next",void 0),!(e>0)||0!==(e-1&e))throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];if(void 0!==e)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return void 0===this.buffer[this.btm]}}class Yoe{constructor(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,Yo.Z)(this,"size",void 0),(0,Yo.Z)(this,"hwm",void 0),(0,Yo.Z)(this,"head",void 0),(0,Yo.Z)(this,"tail",void 0),this.hwm=null!==(e=t.splitLimit)&&void 0!==e?e:16,this.head=new Qoe(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return null!=(null===e||void 0===e?void 0:e.byteLength)?e.byteLength:1}push(e){if(null!=(null===e||void 0===e?void 0:e.value)&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){const t=this.head;this.head=t.next=new Qoe(2*this.head.buffer.length),this.head.push(e)}}shift(){var e;let t=this.tail.shift();if(void 0===t&&null!=this.tail.next){const e=this.tail.next;this.tail.next=null,this.tail=e,t=this.tail.shift()}return null!=(null===(e=t)||void 0===e?void 0:e.value)&&(this.size-=this.calculateSize(t.value)),t}isEmpty(){return this.head.isEmpty()}}class Joe extends Error{constructor(e,t){super(null!==e&&void 0!==e?e:"The operation was aborted"),(0,Yo.Z)(this,"type",void 0),(0,Yo.Z)(this,"code",void 0),this.type="aborted",this.code=null!==t&&void 0!==t?t:"ABORT_ERR"}}function Xoe(){return $oe((e=>{const t=e.shift();if(null==t)return{done:!0};if(null!=t.error)throw t.error;return{done:!0===t.done,value:t.value}}),arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function $oe(e,t){var n;let r,i,o,s=(t=null!==(n=t)&&void 0!==n?n:{}).onEnd,a=new Yoe,c=Ws();const l=e=>null!=i?i(e):(a.push(e),r),u=e=>{var n;if(o)return r;if(!0!==(null===(n=t)||void 0===n?void 0:n.objectMode)&&null==(null===e||void 0===e?void 0:e.byteLength))throw new Error("objectMode was not true but tried to push non-Uint8Array value");return l({done:!1,value:e})},h=e=>o?r:(o=!0,null!=e?(e=>(a=new Yoe,null!=i?i({error:e}):(a.push({error:e}),r)))(e):l({done:!0}));if(r={[Symbol.asyncIterator](){return this},next:async()=>{try{return a.isEmpty()?o?{done:!0}:await new Promise(((t,n)=>{i=o=>{i=null,a.push(o);try{t(e(a))}catch(s){n(s)}return r}})):e(a)}finally{a.isEmpty()&&queueMicrotask((()=>{c.resolve(),c=Ws()}))}},return:()=>(a=new Yoe,h(),{done:!0}),throw:e=>(h(e),{done:!0}),push:u,end:h,get readableLength(){return a.size},onEmpty:async e=>{const t=null===e||void 0===e?void 0:e.signal;if(null===t||void 0===t||t.throwIfAborted(),a.isEmpty())return;let n,r;null!=t&&(n=new Promise(((e,n)=>{r=()=>{n(new Joe)},t.addEventListener("abort",r)})));try{await Promise.race([c.promise,n])}finally{null!=r&&null!=t&&(null===t||void 0===t||t.removeEventListener("abort",r))}}},null==s)return r;const d=r;return r={[Symbol.asyncIterator](){return this},next:()=>d.next(),throw:e=>(d.throw(e),null!=s&&(s(e),s=void 0),{done:!0}),return:()=>(d.return(),null!=s&&(s(),s=void 0),{done:!0}),push:u,end:e=>(d.end(e),null!=s&&(s(e),s=void 0),r),get readableLength(){return d.readableLength},onEmpty:e=>d.onEmpty(e)},r}const ese=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=[];for(const i of t)null==i[Symbol.asyncIterator]&&r.push(i);return r.length===t.length?function*(){for(const e of r)yield*e}():async function*(){const e=Xoe({objectMode:!0});Promise.resolve().then((async()=>{try{await Promise.all(t.map((async t=>{for await(const n of t)e.push(n)}))),e.end()}catch(n){e.end(n)}})),yield*e}()},tse=1e3,nse="/dht/provider",rse=20,ise=3,ose=Number(3e5),sse=Number(Number(tse)),ase=Number(5e3),cse=Number(3e5),lse=Number(3e4),use=Number(3e4);const hse=function(e){const[t,n]=null!=e[Symbol.asyncIterator]?[e[Symbol.asyncIterator](),Symbol.asyncIterator]:[e[Symbol.iterator](),Symbol.iterator],r=[];return{peek:()=>t.next(),push:e=>{r.push(e)},next:()=>r.length>0?{done:!1,value:r.shift()}:t.next(),[n](){return this}}};const dse=function(e,t){if(null!=e[Symbol.asyncIterator])return async function*(){for await(const n of e)yield t(n)}();const n=hse(e),{value:r,done:i}=n.next();if(!0===i)return function*(){}();const o=t(r);if("function"===typeof o.then)return async function*(){yield await o;for await(const e of n)yield t(e)}();const s=t;return function*(){yield o;for(const e of n)yield s(e)}()};function fse(e){if(null==e)throw new Error("Empty pipeline");if(mse(e)){const t=e;e=()=>t.source}else if(yse(e)||gse(e)){const t=e;e=()=>t}for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=[e,...n];if(i.length>1&&mse(i[i.length-1])&&(i[i.length-1]=i[i.length-1].sink),i.length>2)for(let o=1;o<i.length-1;o++)mse(i[o])&&(i[o]=vse(i[o]));return pse(...i)}const pse=function(){let e;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(;n.length>0;)e=n.shift()(e);return e},gse=e=>null!=(null===e||void 0===e?void 0:e[Symbol.asyncIterator]),yse=e=>null!=(null===e||void 0===e?void 0:e[Symbol.iterator]),mse=e=>null!=e&&(null!=e.sink&&null!=e.source),vse=e=>t=>{const n=e.sink(t);if(null!=(null===n||void 0===n?void 0:n.then)){const t=Xoe({objectMode:!0});let r;n.then((()=>{t.end()}),(e=>{t.end(e)}));const i=e.source;if(gse(i))r=async function*(){yield*i,t.end()};else{if(!yse(i))throw new Error("Unknown duplex source type - must be Iterable or AsyncIterable");r=function*(){yield*i,t.end()}}return ese(t,r())}return e.source},bse=Symbol.for("@libp2p/peer-id");const wse=xoe({prefix:"9",name:"base10",alphabet:"0123456789"}),Ese=Poe({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Ase=Poe({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Sse=Poe({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),_se=Array.from("\ud83d\ude80\ud83e\ude90\u2604\ud83d\udef0\ud83c\udf0c\ud83c\udf11\ud83c\udf12\ud83c\udf13\ud83c\udf14\ud83c\udf15\ud83c\udf16\ud83c\udf17\ud83c\udf18\ud83c\udf0d\ud83c\udf0f\ud83c\udf0e\ud83d\udc09\u2600\ud83d\udcbb\ud83d\udda5\ud83d\udcbe\ud83d\udcbf\ud83d\ude02\u2764\ud83d\ude0d\ud83e\udd23\ud83d\ude0a\ud83d\ude4f\ud83d\udc95\ud83d\ude2d\ud83d\ude18\ud83d\udc4d\ud83d\ude05\ud83d\udc4f\ud83d\ude01\ud83d\udd25\ud83e\udd70\ud83d\udc94\ud83d\udc96\ud83d\udc99\ud83d\ude22\ud83e\udd14\ud83d\ude06\ud83d\ude44\ud83d\udcaa\ud83d\ude09\u263a\ud83d\udc4c\ud83e\udd17\ud83d\udc9c\ud83d\ude14\ud83d\ude0e\ud83d\ude07\ud83c\udf39\ud83e\udd26\ud83c\udf89\ud83d\udc9e\u270c\u2728\ud83e\udd37\ud83d\ude31\ud83d\ude0c\ud83c\udf38\ud83d\ude4c\ud83d\ude0b\ud83d\udc97\ud83d\udc9a\ud83d\ude0f\ud83d\udc9b\ud83d\ude42\ud83d\udc93\ud83e\udd29\ud83d\ude04\ud83d\ude00\ud83d\udda4\ud83d\ude03\ud83d\udcaf\ud83d\ude48\ud83d\udc47\ud83c\udfb6\ud83d\ude12\ud83e\udd2d\u2763\ud83d\ude1c\ud83d\udc8b\ud83d\udc40\ud83d\ude2a\ud83d\ude11\ud83d\udca5\ud83d\ude4b\ud83d\ude1e\ud83d\ude29\ud83d\ude21\ud83e\udd2a\ud83d\udc4a\ud83e\udd73\ud83d\ude25\ud83e\udd24\ud83d\udc49\ud83d\udc83\ud83d\ude33\u270b\ud83d\ude1a\ud83d\ude1d\ud83d\ude34\ud83c\udf1f\ud83d\ude2c\ud83d\ude43\ud83c\udf40\ud83c\udf37\ud83d\ude3b\ud83d\ude13\u2b50\u2705\ud83e\udd7a\ud83c\udf08\ud83d\ude08\ud83e\udd18\ud83d\udca6\u2714\ud83d\ude23\ud83c\udfc3\ud83d\udc90\u2639\ud83c\udf8a\ud83d\udc98\ud83d\ude20\u261d\ud83d\ude15\ud83c\udf3a\ud83c\udf82\ud83c\udf3b\ud83d\ude10\ud83d\udd95\ud83d\udc9d\ud83d\ude4a\ud83d\ude39\ud83d\udde3\ud83d\udcab\ud83d\udc80\ud83d\udc51\ud83c\udfb5\ud83e\udd1e\ud83d\ude1b\ud83d\udd34\ud83d\ude24\ud83c\udf3c\ud83d\ude2b\u26bd\ud83e\udd19\u2615\ud83c\udfc6\ud83e\udd2b\ud83d\udc48\ud83d\ude2e\ud83d\ude46\ud83c\udf7b\ud83c\udf43\ud83d\udc36\ud83d\udc81\ud83d\ude32\ud83c\udf3f\ud83e\udde1\ud83c\udf81\u26a1\ud83c\udf1e\ud83c\udf88\u274c\u270a\ud83d\udc4b\ud83d\ude30\ud83e\udd28\ud83d\ude36\ud83e\udd1d\ud83d\udeb6\ud83d\udcb0\ud83c\udf53\ud83d\udca2\ud83e\udd1f\ud83d\ude41\ud83d\udea8\ud83d\udca8\ud83e\udd2c\u2708\ud83c\udf80\ud83c\udf7a\ud83e\udd13\ud83d\ude19\ud83d\udc9f\ud83c\udf31\ud83d\ude16\ud83d\udc76\ud83e\udd74\u25b6\u27a1\u2753\ud83d\udc8e\ud83d\udcb8\u2b07\ud83d\ude28\ud83c\udf1a\ud83e\udd8b\ud83d\ude37\ud83d\udd7a\u26a0\ud83d\ude45\ud83d\ude1f\ud83d\ude35\ud83d\udc4e\ud83e\udd32\ud83e\udd20\ud83e\udd27\ud83d\udccc\ud83d\udd35\ud83d\udc85\ud83e\uddd0\ud83d\udc3e\ud83c\udf52\ud83d\ude17\ud83e\udd11\ud83c\udf0a\ud83e\udd2f\ud83d\udc37\u260e\ud83d\udca7\ud83d\ude2f\ud83d\udc86\ud83d\udc46\ud83c\udfa4\ud83d\ude47\ud83c\udf51\u2744\ud83c\udf34\ud83d\udca3\ud83d\udc38\ud83d\udc8c\ud83d\udccd\ud83e\udd40\ud83e\udd22\ud83d\udc45\ud83d\udca1\ud83d\udca9\ud83d\udc50\ud83d\udcf8\ud83d\udc7b\ud83e\udd10\ud83e\udd2e\ud83c\udfbc\ud83e\udd75\ud83d\udea9\ud83c\udf4e\ud83c\udf4a\ud83d\udc7c\ud83d\udc8d\ud83d\udce3\ud83e\udd42"),Ise=_se.reduce(((e,t,n)=>(e[n]=t,e)),[]),Cse=_se.reduce(((e,t,n)=>(e[t.codePointAt(0)]=n,e)),[]);const Tse=Roe({prefix:"\ud83d\ude80",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=Ise[t]),"")},decode:function(e){const t=[];for(const n of e){const e=Cse[n.codePointAt(0)];if(void 0===e)throw new Error("Non-base256emoji character: ".concat(n));t.push(e)}return new Uint8Array(t)}}),kse=xoe({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Rse=xoe({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),xse=Poe({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),Pse=Roe({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),Dse=new TextEncoder,Ose=new TextDecoder,Nse="json",Bse=512,Lse=e=>Dse.encode(JSON.stringify(e)),Mse=e=>JSON.parse(Ose.decode(e)),Use="raw",Fse=85,Kse=e=>Soe(e),jse=e=>Soe(e);var Zse=function e(t,n,r){n=n||[];var i=r=r||0;for(;t>=Hse;)n[r++]=255&t|zse,t/=128;for(;t&Vse;)n[r++]=255&t|zse,t>>>=7;return n[r]=0|t,e.bytes=r-i+1,n},zse=128,Vse=-128,Hse=Math.pow(2,31);var qse=function e(t,n){var r,i=0,o=0,s=n=n||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");r=t[s++],i+=o<28?(r&Wse)<<o:(r&Wse)*Math.pow(2,o),o+=7}while(r>=Gse);return e.bytes=s-n,i},Gse=128,Wse=127;var Qse=Math.pow(2,7),Yse=Math.pow(2,14),Jse=Math.pow(2,21),Xse=Math.pow(2,28),$se=Math.pow(2,35),eae=Math.pow(2,42),tae=Math.pow(2,49),nae=Math.pow(2,56),rae=Math.pow(2,63);const iae={encode:Zse,decode:qse,encodingLength:function(e){return e<Qse?1:e<Yse?2:e<Jse?3:e<Xse?4:e<$se?5:e<eae?6:e<tae?7:e<nae?8:e<rae?9:10}},oae=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return[iae.decode(e,t),iae.decode.bytes]},sae=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return iae.encode(e,t,n),t},aae=e=>iae.encodingLength(e),cae=(e,t)=>{const n=t.byteLength,r=aae(e),i=r+aae(n),o=new Uint8Array(i+n);return sae(e,o,0),sae(n,o,r),o.set(t,i),new uae(e,n,t,o)},lae=e=>{const t=Soe(e),[n,r]=oae(t),[i,o]=oae(t.subarray(r)),s=t.subarray(r+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new uae(n,i,s,t)};class uae{constructor(e,t,n,r){this.code=e,this.size=t,this.digest=n,this.bytes=r}}const hae=Soe,dae={code:0,name:"identity",encode:hae,digest:e=>cae(0,hae(e))},fae=e=>{let{name:t,code:n,encode:r}=e;return new pae(t,n,r)};class pae{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?cae(this.code,t):t.then((e=>cae(this.code,e)))}throw Error("Unknown type, must be binary type")}}const gae=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),yae=fae({name:"sha2-256",code:18,encode:gae("SHA-256")}),mae=fae({name:"sha2-512",code:19,encode:gae("SHA-512")}),vae=(e,t)=>{const{bytes:n,version:r}=e;return 0===r?Sae(n,wae(e),t||joe.encoder):_ae(n,wae(e),t||Doe.encoder)},bae=new WeakMap,wae=e=>{const t=bae.get(e);if(null==t){const t=new Map;return bae.set(e,t),t}return t};class Eae{constructor(e,t,n,r){this.code=t,this.version=e,this.multihash=n,this.bytes=r,this["/"]=r}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==Iae)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==Cae)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Eae.createV0(t)}default:throw Error("Can not convert CID version ".concat(this.version," to version 0. This is a bug please report"))}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=cae(e,t);return Eae.createV1(this.code,n)}case 1:return this;default:throw Error("Can not convert CID version ".concat(this.version," to version 1. This is a bug please report"))}}equals(e){return Eae.equals(this,e)}static equals(e,t){const n=t;return n&&e.code===n.code&&e.version===n.version&&((e,t)=>{if(e===t)return!0;{const n=t;return e.code===n.code&&e.size===n.size&&n.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0})(e.bytes,n.bytes)}})(e.multihash,n.multihash)}toString(e){return vae(this,e)}toJSON(){return{"/":vae(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID(".concat(this.toString(),")")}static asCID(e){if(null==e)return null;const t=e;if(t instanceof Eae)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:n,multihash:r,bytes:i}=t;return new Eae(e,n,r,i||Tae(e,n,r.bytes))}if(!0===t[kae]){const{version:e,multihash:n,code:r}=t,i=lae(n);return Eae.create(e,r,i)}return null}static create(e,t,n){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==Iae)throw new Error("Version 0 CID must use dag-pb (code: ".concat(Iae,") block encoding"));return new Eae(e,t,n,n.bytes);case 1:{const r=Tae(e,t,n.bytes);return new Eae(e,t,n,r)}default:throw new Error("Invalid version")}}static createV0(e){return Eae.create(0,Iae,e)}static createV1(e,t){return Eae.create(1,e,t)}static decode(e){const[t,n]=Eae.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=Eae.inspectBytes(e),n=t.size-t.multihashSize,r=Soe(e.subarray(n,n+t.multihashSize));if(r.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=r.subarray(t.multihashSize-t.digestSize),o=new uae(t.multihashCode,t.digestSize,i,r);return[0===t.version?Eae.createV0(o):Eae.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[n,r]=oae(e.subarray(t));return t+=r,n};let r=n(),i=Iae;if(18===r?(r=0,t=0):i=n(),0!==r&&1!==r)throw new RangeError("Invalid CID version ".concat(r));const o=t,s=n(),a=n(),c=t+a;return{version:r,codec:i,multihashCode:s,digestSize:a,multihashSize:c-o,size:c}}static parse(e,t){const[n,r]=Aae(e,t),i=Eae.decode(r);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return wae(i).set(n,e),i}}const Aae=(e,t)=>{switch(e[0]){case"Q":{const n=t||joe;return[joe.prefix,n.decode("".concat(joe.prefix).concat(e))]}case joe.prefix:{const n=t||joe;return[joe.prefix,n.decode(e)]}case Doe.prefix:{const n=t||Doe;return[Doe.prefix,n.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},Sae=(e,t,n)=>{const{prefix:r}=n;if(r!==joe.prefix)throw Error("Cannot string encode V0 in ".concat(n.name," encoding"));const i=t.get(r);if(null==i){const i=n.encode(e).slice(1);return t.set(r,i),i}return i},_ae=(e,t,n)=>{const{prefix:r}=n,i=t.get(r);if(null==i){const i=n.encode(e);return t.set(r,i),i}return i},Iae=112,Cae=18,Tae=(e,t,n)=>{const r=aae(e),i=r+aae(t),o=new Uint8Array(i+n.byteLength);return sae(e,o,0),sae(t,o,r),o.set(n,i),o},kae=Symbol.for("@ipld/js-cid/CID"),Rae={...Fr,...Br,...Ur,...Or,...Nr,...xr,...Mr,...Pr,...Dr,...Lr},xae=Symbol.for("nodejs.util.inspect.custom"),Pae=Object.values(Rae).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)),Rae.identity.decoder),Dae=114,Oae=36,Nae=37;class Bae{constructor(e){(0,Yo.Z)(this,"type",void 0),(0,Yo.Z)(this,"multihash",void 0),(0,Yo.Z)(this,"privateKey",void 0),(0,Yo.Z)(this,"publicKey",void 0),(0,Yo.Z)(this,"string",void 0),(0,Yo.Z)(this,bse,!0),this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return"PeerId(".concat(this.toString(),")")}toString(){return null==this.string&&(this.string=joe.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return Eae.createV1(Dae,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){var t;if(e instanceof Uint8Array)return(0,Ms.f)(this.multihash.bytes,e);if("string"===typeof e)return Fae(e).equals(this);if(null!=(null===e||void 0===e||null===(t=e.multihash)||void 0===t?void 0:t.bytes))return(0,Ms.f)(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[xae](){return"PeerId(".concat(this.toString(),")")}}class Lae extends Bae{constructor(e){super({...e,type:"RSA"}),(0,Yo.Z)(this,"type","RSA"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.publicKey}}class Mae extends Bae{constructor(e){super({...e,type:"Ed25519"}),(0,Yo.Z)(this,"type","Ed25519"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.multihash.digest}}class Uae extends Bae{constructor(e){super({...e,type:"secp256k1"}),(0,Yo.Z)(this,"type","secp256k1"),(0,Yo.Z)(this,"publicKey",void 0),this.publicKey=e.multihash.digest}}function Fae(e,t){var n;if(t=null!==(n=t)&&void 0!==n?n:Pae,"1"===e.charAt(0)||"Q"===e.charAt(0)){const t=lae(joe.decode("z".concat(e)));return e.startsWith("12D")?new Mae({multihash:t}):e.startsWith("16U")?new Uae({multihash:t}):new Lae({multihash:t})}return Kae(Pae.decode(e))}function Kae(e){try{const t=lae(e);if(t.code===dae.code){if(t.digest.length===Oae)return new Mae({multihash:t});if(t.digest.length===Nae)return new Uae({multihash:t})}if(t.code===yae.code)return new Lae({multihash:t})}catch{return function(e){if(null==e||null==e.multihash||null==e.version||1===e.version&&e.code!==Dae)throw new Error("Supplied PeerID CID is invalid");const t=e.multihash;if(t.code===yae.code)return new Lae({multihash:e.multihash});if(t.code===dae.code){if(t.digest.length===Oae)return new Mae({multihash:e.multihash});if(t.digest.length===Nae)return new Uae({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}(Eae.decode(e))}throw new Error("Supplied PeerID CID is invalid")}async function jae(e,t){return e.length===Oae?new Mae({multihash:cae(dae.code,e),privateKey:t}):e.length===Nae?new Uae({multihash:cae(dae.code,e),privateKey:t}):new Lae({multihash:await yae.digest(e),publicKey:e,privateKey:t})}var Zae,zae,Vae;function Hae(e){const t=e.getUTCFullYear(),n=String(e.getUTCMonth()+1).padStart(2,"0"),r=String(e.getUTCDate()).padStart(2,"0"),i=String(e.getUTCHours()).padStart(2,"0"),o=String(e.getUTCMinutes()).padStart(2,"0"),s=String(e.getUTCSeconds()).padStart(2,"0"),a=e.getUTCMilliseconds(),c=String(1e3*a*1e3).padStart(9,"0");return"".concat(t,"-").concat(n,"-").concat(r,"T").concat(i,":").concat(o,":").concat(s,".").concat(c,"Z")}!function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.key&&e.key.byteLength>0&&(t.uint32(10),t.bytes(e.key)),null!=e.value&&e.value.byteLength>0&&(t.uint32(18),t.bytes(e.value)),null!=e.timeReceived&&""!==e.timeReceived&&(t.uint32(42),t.string(e.timeReceived)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={key:new Uint8Array(0),value:new Uint8Array(0),timeReceived:""},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.key=e.bytes();break;case 2:n.value=e.bytes();break;case 5:n.timeReceived=e.string();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(Zae||(Zae={}));class qae{constructor(e,t,n){if((0,Yo.Z)(this,"key",void 0),(0,Yo.Z)(this,"value",void 0),(0,Yo.Z)(this,"timeReceived",void 0),!(e instanceof Uint8Array))throw new Error("key must be a Uint8Array");if(!(t instanceof Uint8Array))throw new Error("value must be a Uint8Array");this.key=e,this.value=t,this.timeReceived=n}serialize(){return Zae.encode(this.prepareSerialize())}prepareSerialize(){return{key:this.key,value:this.value,timeReceived:Hae(this.timeReceived)}}static deserialize(e){const t=Zae.decode(e);return new qae(t.key,t.value,new Date(t.timeReceived))}static fromDeserialized(e){const t=function(e){const t=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),n=String(e).trim().match(t);if(null==n)throw new Error("Invalid format");const r=parseInt(n[1],10),i=parseInt(n[2],10)-1,o=parseInt(n[3],10),s=parseInt(n[4],10),a=parseInt(n[5],10),c=parseInt(n[6],10),l=parseInt(n[7].slice(0,-6),10);return new Date(Date.UTC(r,i,o,s,a,c,l))}(e.timeReceived);if(null==e.key)throw new Error("key missing from deserialized object");if(null==e.value)throw new Error("value missing from deserialized object");return new qae(e.key,e.value,t)}}!function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.key&&(t.uint32(10),t.bytes(e.key)),null!=e.value&&(t.uint32(18),t.bytes(e.value)),null!=e.author&&(t.uint32(26),t.bytes(e.author)),null!=e.signature&&(t.uint32(34),t.bytes(e.signature)),null!=e.timeReceived&&(t.uint32(42),t.string(e.timeReceived)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.key=e.bytes();break;case 2:n.value=e.bytes();break;case 3:n.author=e.bytes();break;case 4:n.signature=e.bytes();break;case 5:n.timeReceived=e.string();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(zae||(zae={})),function(e){let t,n,r,i,o,s;!function(e){e.PUT_VALUE="PUT_VALUE",e.GET_VALUE="GET_VALUE",e.ADD_PROVIDER="ADD_PROVIDER",e.GET_PROVIDERS="GET_PROVIDERS",e.FIND_NODE="FIND_NODE",e.PING="PING"}(t=e.MessageType||(e.MessageType={})),function(e){e[e.PUT_VALUE=0]="PUT_VALUE",e[e.GET_VALUE=1]="GET_VALUE",e[e.ADD_PROVIDER=2]="ADD_PROVIDER",e[e.GET_PROVIDERS=3]="GET_PROVIDERS",e[e.FIND_NODE=4]="FIND_NODE",e[e.PING=5]="PING"}(n||(n={})),function(e){e.codec=()=>bs(n)}(t=e.MessageType||(e.MessageType={})),function(e){e.NOT_CONNECTED="NOT_CONNECTED",e.CONNECTED="CONNECTED",e.CAN_CONNECT="CAN_CONNECT",e.CANNOT_CONNECT="CANNOT_CONNECT"}(r=e.ConnectionType||(e.ConnectionType={})),function(e){e[e.NOT_CONNECTED=0]="NOT_CONNECTED",e[e.CONNECTED=1]="CONNECTED",e[e.CAN_CONNECT=2]="CAN_CONNECT",e[e.CANNOT_CONNECT=3]="CANNOT_CONNECT"}(i||(i={})),function(e){e.codec=()=>bs(i)}(r=e.ConnectionType||(e.ConnectionType={})),function(t){let n;t.codec=()=>(null==n&&(n=ws((function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==r.lengthDelimited&&n.fork(),null!=t.id&&(n.uint32(10),n.bytes(t.id)),null!=t.addrs)for(const e of t.addrs)n.uint32(18),n.bytes(e);null!=t.connection&&(n.uint32(24),e.ConnectionType.codec().encode(t.connection,n)),!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={addrs:[]},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.id=t.bytes();break;case 2:r.addrs.push(t.bytes());break;case 3:r.connection=e.ConnectionType.codec().decode(t);break;default:t.skipType(7&n)}}return r}))),n),t.encode=e=>fs(e,t.codec()),t.decode=e=>ds(e,t.codec())}(o=e.Peer||(e.Peer={})),e.codec=()=>(null==s&&(s=ws((function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==r.lengthDelimited&&n.fork(),null!=t.type&&(n.uint32(8),e.MessageType.codec().encode(t.type,n)),null!=t.clusterLevelRaw&&(n.uint32(80),n.int32(t.clusterLevelRaw)),null!=t.key&&(n.uint32(18),n.bytes(t.key)),null!=t.record&&(n.uint32(26),n.bytes(t.record)),null!=t.closerPeers)for(const i of t.closerPeers)n.uint32(66),e.Peer.codec().encode(i,n);if(null!=t.providerPeers)for(const i of t.providerPeers)n.uint32(74),e.Peer.codec().encode(i,n);!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={closerPeers:[],providerPeers:[]},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.type=e.MessageType.codec().decode(t);break;case 10:r.clusterLevelRaw=t.int32();break;case 2:r.key=t.bytes();break;case 3:r.record=t.bytes();break;case 8:r.closerPeers.push(e.Peer.codec().decode(t,t.uint32()));break;case 9:r.providerPeers.push(e.Peer.codec().decode(t,t.uint32()));break;default:t.skipType(7&n)}}return r}))),s),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(Vae||(Vae={}));const Gae=Vae.MessageType,Wae=Vae.ConnectionType,Qae=Object.keys(Gae);class Yae{constructor(e,t,n){if((0,Yo.Z)(this,"type",void 0),(0,Yo.Z)(this,"key",void 0),(0,Yo.Z)(this,"clusterLevelRaw",void 0),(0,Yo.Z)(this,"closerPeers",void 0),(0,Yo.Z)(this,"providerPeers",void 0),(0,Yo.Z)(this,"record",void 0),!(t instanceof Uint8Array))throw new Error("Key must be a Uint8Array");this.type=e,this.key=t,this.clusterLevelRaw=n,this.closerPeers=[],this.providerPeers=[],this.record=void 0}get clusterLevel(){const e=this.clusterLevelRaw-1;return e<0?0:e}set clusterLevel(e){this.clusterLevelRaw=e}serialize(){return Vae.encode({key:this.key,type:this.type,clusterLevelRaw:this.clusterLevelRaw,closerPeers:this.closerPeers.map(Jae),providerPeers:this.providerPeers.map(Jae),record:null==this.record?void 0:this.record.serialize().subarray()})}static deserialize(e){var t,n,r,i;const o=Vae.decode(e),s=new Yae(null!==(t=o.type)&&void 0!==t?t:Vae.MessageType.PUT_VALUE,null!==(n=o.key)&&void 0!==n?n:Uint8Array.from([]),null!==(r=o.clusterLevelRaw)&&void 0!==r?r:0);return s.closerPeers=o.closerPeers.map(Xae),s.providerPeers=o.providerPeers.map(Xae),null!=(null===(i=o.record)||void 0===i?void 0:i.length)&&(s.record=qae.deserialize(o.record)),s}}function Jae(e){var t;return{id:e.id.toBytes(),addrs:(null!==(t=e.multiaddrs)&&void 0!==t?t:[]).map((e=>e.bytes)),connection:Wae.CONNECTED}}function Xae(e){var t;if(null==e.id)throw new Error("Invalid peer in message");return{id:Kae(e.id),multiaddrs:(null!==(t=e.addrs)&&void 0!==t?t:[]).map((e=>(0,ng.HM)(e))),protocols:[]}}function $ae(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r={...e,name:"SEND_QUERY",type:0,messageName:e.type,messageType:Qae.indexOf(e.type.toString())};return null===(t=n.onProgress)||void 0===t||t.call(n,new moe("kad-dht:query:send-query",{detail:r})),r}function ece(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r={...e,name:"PEER_RESPONSE",type:1,messageName:e.messageType,closer:null!=e.closer?e.closer:[],providers:null!=e.providers?e.providers:[]};return null===(t=n.onProgress)||void 0===t||t.call(n,new moe("kad-dht:query:peer-response",{detail:r})),r}function tce(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r={...e,name:"FINAL_PEER",type:2};return null===(t=n.onProgress)||void 0===t||t.call(n,new moe("kad-dht:query:final-peer",{detail:r})),r}function nce(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r={...e,name:"QUERY_ERROR",type:3};return null===(t=n.onProgress)||void 0===t||t.call(n,new moe("kad-dht:query:query-error",{detail:r})),r}function rce(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r={...e,name:"PROVIDER",type:4};return null===(t=n.onProgress)||void 0===t||t.call(n,new moe("kad-dht:query:provider",{detail:r})),r}function ice(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r={...e,name:"VALUE",type:5};return null===(t=n.onProgress)||void 0===t||t.call(n,new moe("kad-dht:query:value",{detail:r})),r}function oce(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r={...e,name:"DIAL_PEER",type:7};return null===(t=n.onProgress)||void 0===t||t.call(n,new moe("kad-dht:query:dial-peer",{detail:r})),r}const sce={pk:function(e,t){return 0}};async function ace(e,t){const n=t.key,r=(0,Au.B)(n).split("/");if(r.length<3)return;const i=e[r[1].toString()];if(null==i){const e='No validator available for key type "'.concat(r[1],'"');throw new loe(e,"ERR_INVALID_RECORD_KEY_TYPE")}await i(n,t.value)}const cce={pk:async(e,t)=>{if(!(e instanceof Uint8Array))throw new loe('"key" must be a Uint8Array',"ERR_INVALID_RECORD_KEY_NOT_BUFFER");if(e.byteLength<5)throw new loe("invalid public key record","ERR_INVALID_RECORD_KEY_TOO_SHORT");if("/pk/"!==(0,Au.B)(e.subarray(0,4)))throw new loe("key was not prefixed with /pk/","ERR_INVALID_RECORD_KEY_BAD_PREFIX");const n=e.slice(4),r=await yae.digest(t);if(!(0,Ms.f)(n,r.bytes))throw new loe("public key does not match passed in key","ERR_INVALID_RECORD_HASH_MISMATCH")}};const lce="/",uce=(new TextEncoder).encode(lce),hce=uce[0];class dce{constructor(e,t){if((0,Yo.Z)(this,"_buf",void 0),"string"===typeof e)this._buf=(0,yu.m)(e);else{if(!(e instanceof Uint8Array))throw new Error("Invalid key, should be String of Uint8Array");this._buf=e}if(null==t&&(t=!0),t&&this.clean(),0===this._buf.byteLength||this._buf[0]!==hce)throw new Error("Invalid key")}toString(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"utf8";return(0,Au.B)(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return"Key(".concat(this.toString(),")")}static withNamespaces(e){return new dce(e.join(lce))}static random(){return new dce(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21;return crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+((t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_")),"")}().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||"string"===typeof e?new dce(e):"function"===typeof e.uint8Array?new dce(e.uint8Array()):null}clean(){if(null!=this._buf&&0!==this._buf.byteLength||(this._buf=uce),this._buf[0]!==hce){const e=new Uint8Array(this._buf.byteLength+1);e.fill(hce,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===hce;)this._buf=this._buf.subarray(0,-1)}less(e){const t=this.list(),n=e.list();for(let r=0;r<t.length;r++){if(n.length<r+1)return!1;const e=t[r],i=n[r];if(e<i)return!0;if(e>i)return!1}return t.length<n.length}reverse(){return dce.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){const e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(lce).slice(1)}type(){return function(e){const t=e.split(":");if(t.length<2)return"";return t.slice(0,-1).join(":")}(this.baseNamespace())}name(){return function(e){const t=e.split(":");return t[t.length-1]}(this.baseNamespace())}instance(e){return new dce(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(lce)||(e+=lce),e+=this.type(),new dce(e)}parent(){const e=this.list();return 1===e.length?new dce(lce):new dce(e.slice(0,-1).join(lce))}child(e){return this.toString()===lce?e:e.toString()===lce?this:new dce(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()!==this.toString()&&e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()!==this.toString()&&this.toString().startsWith(e.toString())}isTopLevel(){return 1===this.list().length}concat(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return dce.withNamespaces([...this.namespaces(),...(r=t.map((e=>e.namespaces())),[].concat(...r))]);var r}}const fce=(0,yu.m)("/pk/");function pce(e){return{...e,multiaddrs:e.multiaddrs.filter((e=>{const[[t,n]]=e.stringTuples();if(53===t||54===t||55===t)return"localhost"!==n;if(4!==t&&6!==t)return!1;if(null==n)return!1;const r=mS(n);return null==r||!r}))}}function gce(e){return{...e,multiaddrs:e.multiaddrs.filter((e=>{const[[t,n]]=e.stringTuples();if("localhost"===n)return!0;if(4!==t&&6!==t)return!1;if(null==n)return!1;const r=mS(n);return null!=r&&r}))}}async function yce(e){return(await yae.digest(e)).digest}async function mce(e){return yce(e.toBytes())}function vce(e){return new dce("".concat("/dht/record","/").concat((0,Au.B)(e,"base32")),!1)}function bce(e,t){const n=new Date;return new qae(e,t,n).serialize()}class wce{constructor(e,t){(0,Yo.Z)(this,"log",void 0),(0,Yo.Z)(this,"components",void 0),(0,Yo.Z)(this,"validators",void 0),(0,Yo.Z)(this,"selectors",void 0),(0,Yo.Z)(this,"peerRouting",void 0),(0,Yo.Z)(this,"queryManager",void 0),(0,Yo.Z)(this,"network",void 0);const{validators:n,selectors:r,peerRouting:i,queryManager:o,network:s,lan:a}=t;this.components=e,this.log=Goe("libp2p:kad-dht:".concat(a?"lan":"wan",":content-fetching")),this.validators=n,this.selectors=r,this.peerRouting=i,this.queryManager=o,this.network=s}async putLocal(e,t){const n=vce(e);await this.components.datastore.put(n,t)}async getLocal(e){this.log("getLocal %b",e);const t=vce(e);this.log("fetching record for key %k",t);const n=await this.components.datastore.get(t);this.log("found %k in local datastore",t);const r=qae.deserialize(n);return await ace(this.validators,r),r}sendCorrectionRecord(e,t,n){try{var r=this;let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return async function*(){r.log("sendCorrection for %b",e);const o=bce(e,n);for(const{value:a,from:c}of t){if((0,Ms.f)(a,n)){r.log("record was ok");continue}if(r.components.peerId.equals(c)){try{const t=vce(e);r.log("Storing corrected record for key ".concat(t.toString())),await r.components.datastore.put(t,o.subarray())}catch(s){r.log.error("Failed error correcting self",s)}continue}let t=!1;const l=new Yae(Gae.PUT_VALUE,e,0);l.record=qae.deserialize(o);for await(const e of r.network.sendRequest(c,l,i))"PEER_RESPONSE"===e.name&&null!=e.record&&(0,Ms.f)(e.record.value,qae.deserialize(o).value)&&(t=!0),yield e;t||(yield nce({from:c,error:new loe("value not put correctly","ERR_PUT_VALUE_INVALID")},i)),r.log.error("Failed error correcting entry")}}()}catch(i){return Promise.reject(i)}}put(e,t){try{var n=this;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return async function*(){n.log("put key %b value %b",e,t);const i=bce(e,t),o=vce(e);n.log("storing record for key ".concat(o.toString())),await n.components.datastore.put(o,i.subarray()),yield*fse(n.peerRouting.getClosestPeers(e,{signal:r.signal}),(t=>dse(t,(t=>async()=>{if("FINAL_PEER"!==t.name)return[t];const o=[],s=new Yae(Gae.PUT_VALUE,e,0);s.record=qae.deserialize(i),n.log("send put to %p",t.peer.id);for await(const e of n.network.sendRequest(t.peer.id,s,r))o.push(e),"PEER_RESPONSE"===e.name&&(null!=e.record&&(0,Ms.f)(e.record.value,qae.deserialize(i).value)||o.push(nce({from:t.peer.id,error:new loe("value not put correctly","ERR_PUT_VALUE_INVALID")},r)));return o}))),(e=>KA(e,{ordered:!1,concurrency:ise})),(async function*(e){for await(const t of e)yield*t}))}()}catch(r){return Promise.reject(r)}}get(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){t.log("get %b",e);const r=[];for await(const c of t.getMany(e,n))"VALUE"===c.name&&r.push(c),yield c;if(0===r.length)return;const i=r.map((e=>e.value));let o=0;try{o=function(e,t,n){if(0===n.length)throw new loe("No records given","ERR_NO_RECORDS_RECEIVED");const r=(0,Au.B)(t).split("/");if(r.length<3)throw new loe("Record key does not have a selector function","ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY");const i=e[r[1].toString()];if(null==i){const e='No selector function configured for key type "'.concat(r[1],'"');throw new loe(e,"ERR_UNRECOGNIZED_KEY_PREFIX")}return 1===n.length?0:i(t,n)}(t.selectors,e,i)}catch(a){if("ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY"!==a.code)throw a}const s=i[o];if(t.log("GetValue %b %b",e,s),null==s)throw new loe("best value was not found","ERR_NOT_FOUND");yield*t.sendCorrectionRecord(e,r,s,n),yield r[o]}()}catch(n){return Promise.reject(n)}}getMany(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){t.log("getMany values for %b",e);try{const r=await t.getLocal(e);yield ice({value:r.value,from:t.components.peerId},n)}catch(i){t.log("error getting local value for %b",e,i)}const r=t;yield*t.queryManager.run(e,(function(t){try{let{peer:i,signal:o}=t;return async function*(){for await(const t of r.peerRouting.getValueOrPeers(i,e,{signal:o}))yield t,"PEER_RESPONSE"===t.name&&null!=t.record&&(yield ice({from:i,value:t.record.value},n))}()}catch(i){return Promise.reject(i)}}),n)}()}catch(n){return Promise.reject(n)}}}class Ece{constructor(e,t){(0,Yo.Z)(this,"log",void 0),(0,Yo.Z)(this,"components",void 0),(0,Yo.Z)(this,"network",void 0),(0,Yo.Z)(this,"peerRouting",void 0),(0,Yo.Z)(this,"queryManager",void 0),(0,Yo.Z)(this,"routingTable",void 0),(0,Yo.Z)(this,"providers",void 0);const{network:n,peerRouting:r,queryManager:i,routingTable:o,providers:s,lan:a}=t;this.components=e,this.log=Goe("libp2p:kad-dht:".concat(a?"lan":"wan",":content-routing")),this.network=n,this.peerRouting=r,this.queryManager=i,this.routingTable=o,this.providers=s}provide(e,t){try{var n=this;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return async function*(){n.log("provide %s",e),await n.providers.addProvider(e,n.components.peerId);const i=new Yae(Gae.ADD_PROVIDER,e.multihash.bytes,0);i.providerPeers=[{id:n.components.peerId,multiaddrs:t,protocols:[]}];let o=0;yield*fse(n.peerRouting.getClosestPeers(e.multihash.bytes,r),(t=>dse(t,(t=>(t=>async()=>{if("FINAL_PEER"!==t.name)return[t];const s=[];n.log("putProvider %s to %p",e,t.peer.id);try{n.log("sending provider record for %s to %p",e,t.peer.id);for await(const a of n.network.sendMessage(t.peer.id,i,r))"PEER_RESPONSE"===a.name&&(n.log("sent provider record for %s to %p",e,t.peer.id),o++),s.push(a)}catch(a){n.log.error("error sending provide record to peer %p",t.peer.id,a),s.push(nce({from:t.peer.id,error:a},r))}return s})(t)))),(e=>KA(e,{ordered:!1,concurrency:ise})),(async function*(e){for await(const t of e)yield*t})),n.log("sent provider records to %d peers",o)}()}catch(r){return Promise.reject(r)}}async*findProviders(e,t){const n=this.routingTable.kBucketSize,r=e.multihash.bytes,i=this;this.log("findProviders %c",e);const o=await this.providers.getProviders(e);if(o.length>0){const e=[];for(const t of o.slice(0,n))try{const n=await this.components.peerStore.get(t);e.push({id:t,multiaddrs:n.addresses.map((e=>{let{multiaddr:t}=e;return t})),protocols:n.protocols})}catch(c){if("ERR_NOT_FOUND"!==c.code)throw c;this.log("no peer store entry for %p",t)}yield ece({from:this.components.peerId,messageType:Gae.GET_PROVIDERS,providers:e},t),yield rce({from:this.components.peerId,providers:e},t)}if(o.length>=n)return;const s=function(e){try{let{peer:n,signal:o}=e;return async function*(){const e=new Yae(Gae.GET_PROVIDERS,r,0);yield*i.network.sendRequest(n,e,{...t,signal:o})}()}catch(n){return Promise.reject(n)}},a=new Set(o.map((e=>e.toString())));for await(const l of this.queryManager.run(r,s,t))if(yield l,"PEER_RESPONSE"===l.name){this.log("Found %d provider entries for %c and %d closer peers",l.providers.length,e,l.closer.length);const r=[];for(const e of l.providers)a.has(e.id.toString())||(a.add(e.id.toString()),r.push(e));if(r.length>0&&(yield rce({from:l.from,providers:r},t)),a.size===n)return}}}const Ace=function(e){if(null!=e[Symbol.asyncIterator])return(async()=>{for await(const t of e)return t})();for(const t of e)return t};function Sce(e){return null!=e[Symbol.asyncIterator]}const _ce=e=>{const t=Bs.P$(e),n=(0,Us.E)(t);return Bs.cv(e,n),_ce.bytes=t,n};function Ice(e,t){var n,r;const i=null!==(r=(t=null!==(n=t)&&void 0!==n?n:{}).lengthEncoder)&&void 0!==r?r:_ce;function*o(e){const t=i(e.byteLength);t instanceof Uint8Array?yield t:yield*t,e instanceof Uint8Array?yield e:yield*e}return Sce(e)?async function*(){for await(const t of e)yield*o(t)}():function*(){for(const t of e)yield*o(t)}()}_ce.bytes=0,Ice.single=(e,t)=>{var n,r;const i=null!==(r=(t=null!==(n=t)&&void 0!==n?n:{}).lengthEncoder)&&void 0!==r?r:_ce;return new Zs(i(e.byteLength),e)};var Cce;!function(e){e[e.LENGTH=0]="LENGTH",e[e.DATA=1]="DATA"}(Cce||(Cce={}));const Tce=e=>{const t=Bs.Jx(e);return Tce.bytes=Bs.P$(t),t};function kce(e,t){var n,r,i;const o=new Zs;let s=Cce.LENGTH,a=-1;const c=null!==(n=null===t||void 0===t?void 0:t.lengthDecoder)&&void 0!==n?n:Tce,l=null!==(r=null===t||void 0===t?void 0:t.maxLengthLength)&&void 0!==r?r:8,u=null!==(i=null===t||void 0===t?void 0:t.maxDataLength)&&void 0!==i?i:4194304;function*h(){for(;o.byteLength>0;){if(s===Cce.LENGTH)try{if(a=c(o),a<0)throw Xo()(new Error("invalid message length"),"ERR_INVALID_MSG_LENGTH");if(a>u)throw Xo()(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");const e=c.bytes;o.consume(e),null!=(null===t||void 0===t?void 0:t.onLength)&&t.onLength(a),s=Cce.DATA}catch(e){if(e instanceof RangeError){if(o.byteLength>l)throw Xo()(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG");break}throw e}if(s===Cce.DATA){if(o.byteLength<a)break;const e=o.sublist(0,a);o.consume(a),null!=(null===t||void 0===t?void 0:t.onData)&&t.onData(e),yield e,s=Cce.LENGTH}}}return Sce(e)?async function*(){for await(const t of e)o.append(t),yield*h();if(o.byteLength>0)throw Xo()(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}():function*(){for(const t of e)o.append(t),yield*h();if(o.byteLength>0)throw Xo()(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}()}Tce.bytes=0,kce.fromReader=(e,t)=>{let n=1;return kce(async function*(){for(;;)try{const{done:t,value:r}=await e.next(n);if(!0===t)return;null!=r&&(yield r)}catch(t){if("ERR_UNDER_READ"===t.code)return{done:!0,value:null};throw t}finally{n=1}}(),{...null!==t&&void 0!==t?t:{},onLength:e=>{n=e}})};class Rce extends goe{constructor(e,t){super(),(0,Yo.Z)(this,"log",void 0),(0,Yo.Z)(this,"protocol",void 0),(0,Yo.Z)(this,"running",void 0),(0,Yo.Z)(this,"components",void 0);const{protocol:n,lan:r}=t;this.components=e,this.log=Goe("libp2p:kad-dht:".concat(r?"lan":"wan",":network")),this.running=!1,this.protocol=n}async start(){this.running||(this.running=!0)}async stop(){this.running=!1}isStarted(){return this.running}sendRequest(e,t){try{var n=this;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return async function*(){if(!n.running)return;n.log("sending %s to %p",t.type,e),yield oce({peer:e},r),yield $ae({to:e,type:t.type},r);try{const i=await n.components.connectionManager.openConnection(e,r),o=await i.newStream(n.protocol,r),s=await n._writeReadMessage(o,t.serialize(),r);yield ece({from:e,messageType:s.type,closer:s.closerPeers,providers:s.providerPeers,record:s.record},r)}catch(i){yield nce({from:e,error:i},r)}finally{0}}()}catch(r){return Promise.reject(r)}}sendMessage(e,t){try{var n=this;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return async function*(){if(!n.running)return;n.log("sending %s to %p",t.type,e),yield oce({peer:e},r),yield $ae({to:e,type:t.type},r);try{const i=await n.components.connectionManager.openConnection(e,r),o=await i.newStream(n.protocol,r);await n._writeMessage(o,t.serialize(),r),yield ece({from:e,messageType:t.type},r)}catch(i){yield nce({from:e,error:i},r)}finally{0}}()}catch(r){return Promise.reject(r)}}async _writeMessage(e,t,n){null!=n.signal&&(e=gF(e,n.signal)),await fse([t],(e=>Ice(e)),e,Woe)}async _writeReadMessage(e,t,n){null!=n.signal&&(e=gF(e,n.signal));const r=await fse([t],(e=>Ice(e)),e,(e=>kce(e)),(async e=>{const t=await Ace(e);if(null!=t)return t;throw new loe("No message received","ERR_NO_MESSAGE_RECEIVED")})),i=Yae.deserialize(r);return i.closerPeers.forEach((e=>{this.dispatchEvent(new moe("peer",{detail:e}))})),i.providerPeers.forEach((e=>{this.dispatchEvent(new moe("peer",{detail:e}))})),i}}const xce={get(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:globalThis).crypto;if(null==e||null==e.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}};const Pce=32,Dce=64,Oce=32;function Nce(e,t){const n=new Uint8Array(Dce);for(let r=0;r<Oce;r++)n[r]=e[r],n[Oce+r]=t[r];return n}const Bce={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};function Lce(e){var t,n,r,i,o,s;const a=null!==(t=null===e||void 0===e?void 0:e.algorithm)&&void 0!==t?t:"AES-GCM";let c=null!==(n=null===e||void 0===e?void 0:e.keyLength)&&void 0!==n?n:16;const l=null!==(r=null===e||void 0===e?void 0:e.nonceLength)&&void 0!==r?r:12,u=null!==(i=null===e||void 0===e?void 0:e.digest)&&void 0!==i?i:"SHA-256",h=null!==(o=null===e||void 0===e?void 0:e.saltLength)&&void 0!==o?o:16,d=null!==(s=null===e||void 0===e?void 0:e.iterations)&&void 0!==s?s:32767,f=xce.get();c*=8;return{encrypt:async function(e,t){const n=f.getRandomValues(new Uint8Array(h)),r=f.getRandomValues(new Uint8Array(l)),i={name:a,iv:r};let o;if("string"===typeof t&&(t=(0,yu.m)(t)),0===t.length){o=await f.subtle.importKey("jwk",Bce,{name:"AES-GCM"},!0,["encrypt"]);try{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);o=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["encrypt"])}catch{o=await f.subtle.importKey("jwk",Bce,{name:"AES-GCM"},!0,["encrypt"])}}else{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);o=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["encrypt"])}const s=await f.subtle.encrypt(i,o,e);return(0,Ls.z)([n,i.iv,new Uint8Array(s)])},decrypt:async function(e,t){const n=e.subarray(0,h),r=e.subarray(h,h+l),i=e.subarray(h+l),o={name:a,iv:r};let s;if("string"===typeof t&&(t=(0,yu.m)(t)),0===t.length)try{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);s=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["decrypt"])}catch{s=await f.subtle.importKey("jwk",Bce,{name:"AES-GCM"},!0,["decrypt"])}else{const e={name:"PBKDF2",salt:n,iterations:d,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);s=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["decrypt"])}const p=await f.subtle.decrypt(o,s,i);return new Uint8Array(p)}}}async function Mce(e,t){const n=Lce(),r=await n.encrypt(e,t);return zoe.encode(r)}var Uce,Fce,Kce,jce;!function(e){e.RSA="RSA",e.Ed25519="Ed25519",e.Secp256k1="Secp256k1"}(Uce||(Uce={})),function(e){e[e.RSA=0]="RSA",e[e.Ed25519=1]="Ed25519",e[e.Secp256k1=2]="Secp256k1"}(Fce||(Fce={})),function(e){e.codec=()=>bs(Fce)}(Uce||(Uce={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),Uce.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.Type=Uce.codec().decode(e);break;case 2:n.Data=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(Kce||(Kce={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),Uce.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.Type=Uce.codec().decode(e);break;case 2:n.Data=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(jce||(jce={}));class Zce{constructor(e){(0,Yo.Z)(this,"_key",void 0),this._key=Wce(e,Pce)}async verify(e,t){return async function(e,t,n){return ql.verify(t,n,e)}(this._key,t,e)}marshal(){return this._key}get bytes(){return Kce.encode({Type:Uce.Ed25519,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await yae.digest(this.bytes);return e}}class zce{constructor(e,t){(0,Yo.Z)(this,"_key",void 0),(0,Yo.Z)(this,"_publicKey",void 0),this._key=Wce(e,Dce),this._publicKey=Wce(t,Pce)}async sign(e){return async function(e,t){const n=e.subarray(0,Oce);return ql.sign(t,n)}(this._key,e)}get public(){return new Zce(this._publicKey)}marshal(){return this._key}get bytes(){return jce.encode({Type:Uce.Ed25519,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await yae.digest(this.bytes);return e}async id(){const e=dae.digest(this.public.bytes);return joe.encode(e.bytes).substring(1)}async export(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"libp2p-key";if("libp2p-key"===t)return Mce(this.bytes,e);throw new loe("export format '".concat(t,"' is not supported"),"ERR_INVALID_EXPORT_FORMAT")}}function Vce(e){if(e.length>Dce){const t=(e=Wce(e,Dce+Pce)).subarray(0,Dce),n=e.subarray(Dce,e.length);return new zce(t,n)}const t=(e=Wce(e,Dce)).subarray(0,Dce),n=e.subarray(Pce);return new zce(t,n)}function Hce(e){return e=Wce(e,Pce),new Zce(e)}async function qce(){const{privateKey:e,publicKey:t}=await async function(){const e=ql.utils.randomPrivateKey(),t=ql.getPublicKey(e);return{privateKey:Nce(e,t),publicKey:t}}();return new zce(e,t)}async function Gce(e){const{privateKey:t,publicKey:n}=await async function(e){if(e.length!==Oce)throw new TypeError('"seed" must be 32 bytes in length.');if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');const t=e,n=ql.getPublicKey(t);return{privateKey:Nce(t,n),publicKey:n}}(e);return new zce(t,n)}function Wce(e,t){var n;if((e=Uint8Array.from(null!==(n=e)&&void 0!==n?n:[])).length!==t)throw new loe("Key must be a Uint8Array of length ".concat(t,", got ").concat(e.length),"ERR_INVALID_KEY_TYPE");return e}function Qce(e,t){let n=Uint8Array.from(e.abs().toByteArray());if(n=0===n[0]?n.subarray(1):n,null!=t){if(n.length>t)throw new Error("byte array longer than desired length");n=(0,Ls.z)([new Uint8Array(t-n.length),n])}return(0,Au.B)(n,"base64url")}function Yce(e){const t=Jce(e);return new(gu().jsbn.BigInteger)((0,Au.B)(t,"base16"),16)}function Jce(e,t){let n=(0,yu.m)(e,"base64urlpad");if(null!=t){if(n.length>t)throw new Error("byte array longer than desired length");n=(0,Ls.z)([new Uint8Array(t-n.length),n])}return n}const Xce={"P-256":256,"P-384":384,"P-521":521};Object.keys(Xce).join(" / ");function $ce(e){if(isNaN(e)||e<=0)throw new loe("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return _c(e)}function ele(e,t){return t.map((t=>Yce(e[t])))}async function tle(e){const t=[await xce.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await rle(e)],n=await nle({privateKey:t[0],publicKey:t[1]});return{privateKey:n[0],publicKey:n[1]}}async function nle(e){if(null==e.privateKey||null==e.publicKey)throw new loe("Private and public key are required","ERR_INVALID_PARAMETERS");return Promise.all([xce.get().subtle.exportKey("jwk",e.privateKey),xce.get().subtle.exportKey("jwk",e.publicKey)])}async function rle(e){return xce.get().subtle.importKey("jwk",{kty:e.kty,n:e.n,e:e.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function ile(e,t,n,r){const i=t?function(e){return gu().pki.setRsaPublicKey(...ele(e,["n","e"]))}(e):function(e){return gu().pki.setRsaPrivateKey(...ele(e,["n","e","d","p","q","dp","dq","qi"]))}(e),o=r((0,Au.B)(Uint8Array.from(n),"ascii"),i);return(0,yu.m)(o,"ascii")}function ole(e){if("RSA"!==e.kty)throw new loe("invalid key type","ERR_INVALID_KEY_TYPE");if(null==e.n)throw new loe("invalid key modulus","ERR_INVALID_KEY_MODULUS");return 8*(0,yu.m)(e.n,"base64url").length}const sle=8192;class ale{constructor(e){(0,Yo.Z)(this,"_key",void 0),this._key=e}async verify(e,t){return async function(e,t,n){const r=await xce.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return xce.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},r,t,n)}(this._key,t,e)}marshal(){return function(e){if(null==e.n||null==e.e)throw new loe("JWK was missing components","ERR_INVALID_PARAMETERS");const t=gu().pki.publicKeyToAsn1({n:Yce(e.n),e:Yce(e.e)});return(0,yu.m)(gu().asn1.toDer(t).getBytes(),"ascii")}(this._key)}get bytes(){return Kce.encode({Type:Uce.RSA,Data:this.marshal()}).subarray()}encrypt(e){return ile(this._key,!0,e,((e,t)=>t.encrypt(e)))}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await yae.digest(this.bytes);return e}}class cle{constructor(e,t){(0,Yo.Z)(this,"_key",void 0),(0,Yo.Z)(this,"_publicKey",void 0),this._key=e,this._publicKey=t}genSecret(){return $ce(16)}async sign(e){return async function(e,t){const n=await xce.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),r=await xce.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},n,Uint8Array.from(t));return new Uint8Array(r,0,r.byteLength)}(this._key,e)}get public(){if(null==this._publicKey)throw new loe("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new ale(this._publicKey)}decrypt(e){return ile(this._key,!1,e,((e,t)=>t.decrypt(e)))}marshal(){return function(e){if(null==e.n||null==e.e||null==e.d||null==e.p||null==e.q||null==e.dp||null==e.dq||null==e.qi)throw new loe("JWK was missing components","ERR_INVALID_PARAMETERS");const t=gu().pki.privateKeyToAsn1({n:Yce(e.n),e:Yce(e.e),d:Yce(e.d),p:Yce(e.p),q:Yce(e.q),dP:Yce(e.dp),dQ:Yce(e.dq),qInv:Yce(e.qi)});return(0,yu.m)(gu().asn1.toDer(t).getBytes(),"ascii")}(this._key)}get bytes(){return jce.encode({Type:Uce.RSA,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await yae.digest(this.bytes);return e}async id(){const e=await this.public.hash();return(0,Au.B)(e,"base58btc")}async export(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"pkcs-8";if("pkcs-8"===t){const t=new(gu().util.ByteBuffer)(this.marshal()),n=gu().asn1.fromDer(t),r=gu().pki.privateKeyFromAsn1(n),i={algorithm:"aes256",count:1e4,saltSize:16,prfAlgorithm:"sha512"};return gu().pki.encryptRsaPrivateKey(r,e,i)}if("libp2p-key"===t)return Mce(this.bytes,e);throw new loe("export format '".concat(t,"' is not supported"),"ERR_INVALID_EXPORT_FORMAT")}}async function lle(e){const t=function(e){const t=gu().asn1.fromDer((0,Au.B)(e,"ascii")),n=gu().pki.privateKeyFromAsn1(t);return{kty:"RSA",n:Qce(n.n),e:Qce(n.e),d:Qce(n.d),p:Qce(n.p),q:Qce(n.q),dp:Qce(n.dP),dq:Qce(n.dQ),qi:Qce(n.qInv),alg:"RS256"}}(e);if(ole(t)>sle)throw new loe("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const n=await tle(t);return new cle(n.privateKey,n.publicKey)}function ule(e){const t=function(e){const t=gu().asn1.fromDer((0,Au.B)(e,"ascii")),n=gu().pki.publicKeyFromAsn1(t);return{kty:"RSA",n:Qce(n.n),e:Qce(n.e)}}(e);if(ole(t)>sle)throw new loe("key size is too large","ERR_KEY_SIZE_TOO_LARGE");return new ale(t)}async function hle(e){if(ole(e)>sle)throw new loe("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const t=await tle(e);return new cle(t.privateKey,t.publicKey)}async function dle(e){if(e>sle)throw new loe("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const t=await async function(e){const t=await xce.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),n=await nle(t);return{privateKey:n[0],publicKey:n[1]}}(e);return new cle(t.privateKey,t.publicKey)}function fle(e){try{Eh.ProjectivePoint.fromHex(e)}catch(t){throw new loe(String(t),"ERR_INVALID_PUBLIC_KEY")}}class ple{constructor(e){(0,Yo.Z)(this,"_key",void 0),fle(e),this._key=e}async verify(e,t){return async function(e,t,n){try{const{digest:r}=await yae.digest(n);return Eh.verify(t,r,e)}catch(r){throw new loe(String(r),"ERR_INVALID_INPUT")}}(this._key,t,e)}marshal(){return e=this._key,Eh.ProjectivePoint.fromHex(e).toRawBytes(!0);var e}get bytes(){return Kce.encode({Type:Uce.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await yae.digest(this.bytes);return e}}class gle{constructor(e,t){(0,Yo.Z)(this,"_key",void 0),(0,Yo.Z)(this,"_publicKey",void 0),this._key=e,this._publicKey=null!==t&&void 0!==t?t:function(e){try{return Eh.getPublicKey(e,!0)}catch(t){throw new loe(String(t),"ERR_INVALID_PRIVATE_KEY")}}(e),function(e){try{Eh.getPublicKey(e,!0)}catch(t){throw new loe(String(t),"ERR_INVALID_PRIVATE_KEY")}}(this._key),fle(this._publicKey)}async sign(e){return async function(e,t){const{digest:n}=await yae.digest(t);try{return Eh.sign(n,e).toDERRawBytes()}catch(r){throw new loe(String(r),"ERR_INVALID_INPUT")}}(this._key,e)}get public(){return new ple(this._publicKey)}marshal(){return this._key}get bytes(){return jce.encode({Type:Uce.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return(0,Ms.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await yae.digest(this.bytes);return e}async id(){const e=await this.public.hash();return(0,Au.B)(e,"base58btc")}async export(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"libp2p-key";if("libp2p-key"===t)return Mce(this.bytes,e);throw new loe("export format '".concat(t,"' is not supported"),"ERR_INVALID_EXPORT_FORMAT")}}function yle(e){return new gle(e)}function mle(e){return new ple(e)}async function vle(){const e=Eh.utils.randomPrivateKey();return new gle(e)}const ble={rsa:Hr,ed25519:Vr,secp256k1:qr};function wle(e){const t=Object.keys(ble).join(" / ");return new loe("invalid or unsupported key type ".concat(e,". Must be ").concat(t),"ERR_UNSUPPORTED_KEY_TYPE")}function Ele(e){if("rsa"===(e=e.toLowerCase())||"ed25519"===e||"secp256k1"===e)return ble[e];throw wle(e)}function Ale(e,t){var n;return Ele(t=(null!==(n=t)&&void 0!==n?n:"rsa").toLowerCase()),e.bytes}function Sle(e,t){if(null!=globalThis.Buffer)return globalThis.Buffer.compare(e,t);for(let n=0;n<e.byteLength;n++){if(e[n]<t[n])return-1;if(e[n]>t[n])return 1}return e.byteLength>t.byteLength?1:e.byteLength<t.byteLength?-1:0}var _le=n(81472);function Ile(e,t){if(e.length!==t.length)throw new Error("Inputs should have the same length");const n=(0,Us.E)(e.length);for(let r=0;r<e.length;r++)n[r]=e[r]^t[r];return(0,_le.P)(n)}class Cle{constructor(e,t){(0,Yo.Z)(this,"originDhtKey",void 0),(0,Yo.Z)(this,"capacity",void 0),(0,Yo.Z)(this,"peerDistances",void 0),this.originDhtKey=e,this.capacity=t,this.peerDistances=[]}get length(){return this.peerDistances.length}get peers(){return this.peerDistances.map((e=>e.peerId))}async add(e){if(null!=this.peerDistances.find((t=>t.peerId.equals(e))))return;const t=await mce(e),n={peerId:e,distance:Ile(this.originDhtKey,t)};this.peerDistances.push(n),this.peerDistances.sort(((e,t)=>Sle(e.distance,t.distance))),this.peerDistances=this.peerDistances.slice(0,this.capacity)}async anyCloser(e){if(0===e.length)return!1;if(0===this.length)return!0;const t=await Promise.all(e.map(mce)),n=this.peerDistances[this.peerDistances.length-1].distance;for(const r of t){if(Sle(Ile(this.originDhtKey,r),n)<0)return!0}return!1}}class Tle{constructor(e,t){(0,Yo.Z)(this,"components",void 0),(0,Yo.Z)(this,"log",void 0),(0,Yo.Z)(this,"routingTable",void 0),(0,Yo.Z)(this,"network",void 0),(0,Yo.Z)(this,"validators",void 0),(0,Yo.Z)(this,"queryManager",void 0);const{routingTable:n,network:r,validators:i,queryManager:o,lan:s}=t;this.components=e,this.routingTable=n,this.network=r,this.validators=i,this.queryManager=o,this.log=Goe("libp2p:kad-dht:".concat(s?"lan":"wan",":peer-routing"))}async findPeerLocal(e){let t;const n=await this.routingTable.find(e);if(null!=n){this.log("findPeerLocal found %p in routing table",e);try{t=await this.components.peerStore.get(n)}catch(r){if("ERR_NOT_FOUND"!==r.code)throw r}}if(null==t)try{t=await this.components.peerStore.get(e)}catch(r){if("ERR_NOT_FOUND"!==r.code)throw r}if(null!=t)return this.log("findPeerLocal found %p in peer store",e),{id:t.id,multiaddrs:t.addresses.map((e=>e.multiaddr)),protocols:[]}}_getValueSingle(e,t){try{var n=this;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return async function*(){const i=new Yae(Gae.GET_VALUE,t,0);yield*n.network.sendRequest(e,i,r)}()}catch(r){return Promise.reject(r)}}getPublicKeyFromNode(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){const r=function(e){return(0,Ls.z)([fce,e.toBytes()])}(e);for await(const i of t._getValueSingle(e,r,n))if(yield i,"PEER_RESPONSE"===i.name&&null!=i.record){const t=await jae(Ale({bytes:i.record.value}));if(!t.equals(e))throw new loe("public key does not match id","ERR_PUBLIC_KEY_DOES_NOT_MATCH_ID");if(null==t.publicKey)throw new loe("public key missing","ERR_PUBLIC_KEY_MISSING");yield ice({from:e,value:t.publicKey},n)}throw new loe("Node not responding with its public key: ".concat(e.toString()),"ERR_INVALID_RECORD")}()}catch(n){return Promise.reject(n)}}findPeer(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){t.log("findPeer %p",e);const r=await t.findPeerLocal(e);if(null!=r)return t.log("found local"),void(yield tce({from:t.components.peerId,peer:r},n));const i=t,o=function(t){try{let{peer:r,signal:o}=t;return async function*(){const t=new Yae(Gae.FIND_NODE,e.toBytes(),0);for await(const s of i.network.sendRequest(r,t,{...n,signal:o}))if(yield s,"PEER_RESPONSE"===s.name){const t=s.closer.find((t=>t.id.equals(e)));null!=t&&(yield tce({from:s.from,peer:t},n))}}()}catch(r){return Promise.reject(r)}};let s=!1;for await(const a of t.queryManager.run(e.toBytes(),o,n))"FINAL_PEER"===a.name&&(s=!0),yield a;s||(yield nce({from:t.components.peerId,error:new loe("Not found","ERR_NOT_FOUND")},n))}()}catch(n){return Promise.reject(n)}}getClosestPeers(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){t.log("getClosestPeers to %b",e);const r=await yce(e),i=t.routingTable.closestPeers(r),o=t,s=new Cle(r,t.routingTable.kBucketSize);await Promise.all(i.map((async e=>{await s.add(e)})));const a=function(t){try{let{peer:r,signal:i}=t;return async function*(){o.log("closerPeersSingle %s from %p",(0,Au.B)(e,"base32"),r);const t=new Yae(Gae.FIND_NODE,e,0);yield*o.network.sendRequest(r,t,{...n,signal:i})}()}catch(r){return Promise.reject(r)}};for await(const l of t.queryManager.run(e,a,n))yield l,"PEER_RESPONSE"===l.name&&await Promise.all(l.closer.map((async e=>{await s.add(e.id)})));t.log("found %d peers close to %b",s.length,e);for(const e of s.peers)try{const r=await t.components.peerStore.get(e);yield tce({from:t.components.peerId,peer:{id:e,multiaddrs:r.addresses.map((e=>{let{multiaddr:t}=e;return t})),protocols:r.protocols}},n)}catch(c){if("ERR_NOT_FOUND"!==c.code)throw c}}()}catch(n){return Promise.reject(n)}}getValueOrPeers(e,t){try{var n=this;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return async function*(){for await(const o of n._getValueSingle(e,t,r)){if("PEER_RESPONSE"===o.name&&null!=o.record)try{await n._verifyRecordOnline(o.record)}catch(i){const e="invalid record received, discarded";n.log(e),yield nce({from:o.from,error:new loe(e,"ERR_INVALID_RECORD")},r);continue}yield o}}()}catch(r){return Promise.reject(r)}}async _verifyRecordOnline(e){if(null==e.timeReceived)throw new loe("invalid record received","ERR_INVALID_RECORD");await ace(this.validators,new qae(e.key,e.value,e.timeReceived))}async getCloserPeersOffline(e,t){const n=await yce(e),r=this.routingTable.closestPeers(n),i=[];for(const s of r)if(!s.equals(t))try{const e=await this.components.peerStore.get(s);i.push({id:s,multiaddrs:e.addresses.map((e=>{let{multiaddr:t}=e;return t})),protocols:e.protocols})}catch(o){if("ERR_NOT_FOUND"!==o.code)throw o}return i.length>0?this.log("getCloserPeersOffline found %d peer(s) closer to %b than %p",i.length,e,t):this.log("getCloserPeersOffline could not find peer closer to %b than %p",e,t),i}}var kle=n(34737),Rle=n.n(kle);const xle=Goe("libp2p:kad-dht:providers");class Ple{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,Yo.Z)(this,"components",void 0),(0,Yo.Z)(this,"cache",void 0),(0,Yo.Z)(this,"cleanupInterval",void 0),(0,Yo.Z)(this,"provideValidity",void 0),(0,Yo.Z)(this,"syncQueue",void 0),(0,Yo.Z)(this,"started",void 0),(0,Yo.Z)(this,"cleaner",void 0);const{cacheSize:n,cleanupInterval:r,provideValidity:i}=t;this.components=e,this.cleanupInterval=null!==r&&void 0!==r?r:36e5,this.provideValidity=null!==i&&void 0!==i?i:864e5,this.cache=Rle()(null!==n&&void 0!==n?n:256),this.syncQueue=new Bm.Z({concurrency:1}),this.started=!1}isStarted(){return this.started}async start(){this.started||(this.started=!0,this.cleaner=setInterval((()=>{this._cleanup().catch((e=>{xle.error(e)}))}),this.cleanupInterval))}async stop(){this.started=!1,null!=this.cleaner&&(clearInterval(this.cleaner),this.cleaner=void 0)}async _cleanup(){await this.syncQueue.add((async()=>{const e=Date.now();let t=0,n=0;const r=new Map,i=this.components.datastore.batch(),o=this.components.datastore.query({prefix:nse});for await(const c of o)try{const{cid:e,peerId:o}=Ole(c.key),a=Nle(c.value).getTime(),l=Date.now(),u=l-a,h=u>this.provideValidity;if(xle("comparing: %d - %d = %d > %d %s",l,a,u,this.provideValidity,h?"(expired)":""),h){var s;n++,i.delete(c.key);const t=null!==(s=r.get(e))&&void 0!==s?s:new Set;t.add(o),r.set(e,t)}t++}catch(a){xle.error(a.message)}r.size>0?(xle("deleting %d / %d entries",n,t),await i.commit()):xle("nothing to delete");for(const[c,l]of r){const e=Dle(c),t=this.cache.get(e);if(null!=t){for(const e of l)t.delete(e);0===t.size?this.cache.remove(e):this.cache.set(e,t)}}xle("Cleanup successful (%dms)",Date.now()-e)}))}async _getProvidersMap(e){const t=Dle(e);let n=this.cache.get(t);return null==n&&(n=await async function(e,t){const n=new Map,r=e.query({prefix:Dle(t)});for await(const i of r){const{peerId:e}=Ole(i.key);n.set(e,Nle(i.value))}return n}(this.components.datastore,e),this.cache.set(t,n)),n}async addProvider(e,t){await this.syncQueue.add((async()=>{xle("%p provides %s",t,e);const n=await this._getProvidersMap(e);xle("loaded %s provs",n.size);const r=new Date;n.set(t.toString(),r);const i=Dle(e);this.cache.set(i,n),await async function(e,t,n,r){const i=[Dle(t),"/",n.toString()].join(""),o=new dce(i),s=Bs.cv(r.getTime());await e.put(o,s)}(this.components.datastore,e,t,r)}))}async getProviders(e){return this.syncQueue.add((async()=>{xle("get providers for %s",e);return[...(await this._getProvidersMap(e)).keys()].map((e=>Fae(e)))}),{throwOnTimeout:!0})}}function Dle(e){const t="string"===typeof e?e:(0,Au.B)(e.multihash.bytes,"base32");return"".concat(nse,"/").concat(t)}function Ole(e){const t=e.toString().split("/");if(5!==t.length)throw new Error("incorrectly formatted provider entry key in datastore: ".concat(e.toString()));return{cid:t[3],peerId:t[4]}}function Nle(e){return new Date(Bs.Jx(e))}function Ble(e){const t=new globalThis.AbortController;function n(){t.abort();for(const t of e)null!=(null===t||void 0===t?void 0:t.removeEventListener)&&t.removeEventListener("abort",n)}for(const i of e){if(!0===(null===i||void 0===i?void 0:i.aborted)){n();break}null!=(null===i||void 0===i?void 0:i.addEventListener)&&i.addEventListener("abort",n)}const r=t.signal;return r.clear=function(){for(const t of e)null!=(null===t||void 0===t?void 0:t.removeEventListener)&&t.removeEventListener("abort",n)},r}const Lle=BigInt("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF");async function*Mle(e){const{key:t,startingPeer:n,ourPeerId:r,signal:i,query:o,alpha:s,pathIndex:a,numPaths:c,cleanUp:l,queryFuncTimeout:u,log:h,peersSeen:d}=e,f=new Bm.Z({concurrency:s}),p=await yce(t);!function n(s,l){if(null==s)return;d.add(s);const g=BigInt("0x"+(0,Au.B)(Ile(l,p),"base16"));f.add((async()=>{const l=[i];null!=u&&l.push(AbortSignal.timeout(u));const y=Ble(l);try{for await(const e of o({key:t,peer:s,signal:y,pathIndex:a,numPaths:c})){if(y.aborted)return;if("PEER_RESPONSE"===e.name)for(const i of e.closer){if(d.has(i.id)){h("already seen %p in query",i.id);continue}if(r.equals(i.id)){h("not querying ourselves");continue}const e=await mce(i.id);BigInt("0x"+(0,Au.B)(Ile(e,p),"base16"))>g?h("skipping %p as they are not closer to %b than %p",i.id,t,s):(h("querying closer peer %p",i.id),n(i.id,e))}f.emit("completed",e)}}catch(m){if(!i.aborted)return nce({from:s,error:m},e)}finally{y.clear()}}),{priority:Lle-g}).catch((e=>{h.error(e)}))}(n,await mce(n)),yield*async function*(e,t,n,r){const i=Xoe({objectMode:!0}),o=t=>{r("clean up queue, results %d, queue size %d, pending tasks %d",i.readableLength,e.size,e.pending),e.clear(),i.end(t)},s=e=>{null!=e&&i.push(e)},a=e=>{r("queue error",e),o(e)},c=()=>{r("queue idle"),o()},l=()=>{r("abort queue"),o(new loe("Query aborted","ERR_QUERY_ABORTED"))},u=()=>{o()};e.on("completed",s),e.on("error",a),e.on("idle",c),t.addEventListener("abort",l),n.addEventListener("cleanup",u);try{yield*i}finally{e.removeListener("completed",s),e.removeListener("error",a),e.removeListener("idle",c),t.removeEventListener("abort",l),n.removeEventListener("cleanup",u)}}(f,i,l,h)}class Ule{constructor(e,t){(0,Yo.Z)(this,"components",void 0),(0,Yo.Z)(this,"lan",void 0),(0,Yo.Z)(this,"disjointPaths",void 0),(0,Yo.Z)(this,"alpha",void 0),(0,Yo.Z)(this,"shutDownController",void 0),(0,Yo.Z)(this,"running",void 0),(0,Yo.Z)(this,"queries",void 0),(0,Yo.Z)(this,"metrics",void 0),(0,Yo.Z)(this,"routingTable",void 0),(0,Yo.Z)(this,"initialQuerySelfHasRun",void 0);const{lan:n=!1,disjointPaths:r=rse,alpha:i=ise}=t;this.components=e,this.disjointPaths=null!==r&&void 0!==r?r:rse,this.running=!1,this.alpha=null!==i&&void 0!==i?i:ise,this.lan=n,this.queries=0,this.initialQuerySelfHasRun=t.initialQuerySelfHasRun,this.routingTable=t.routingTable,this.shutDownController=new AbortController,voe(1/0,this.shutDownController.signal)}isStarted(){return this.running}async start(){this.running=!0,null!=this.components.metrics&&null==this.metrics&&(this.metrics={runningQueries:this.components.metrics.registerMetric("libp2p_kad_dht_".concat(this.lan?"lan":"wan","_running_queries")),queryTime:this.components.metrics.registerMetric("libp2p_kad_dht_".concat(this.lan?"lan":"wan","_query_time_seconds"))})}async stop(){this.running=!1,this.shutDownController.abort()}run(e,t){try{var n=this;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return async function*(i){if(!n.running)throw new Error("QueryManager not started");const o=null===(i=n.metrics)||void 0===i?void 0:i.queryTime.timer();if(null==r.signal){const e=AbortSignal.timeout(use);voe(1/0,e),r={...r,signal:e}}const s=Ble([n.shutDownController.signal,r.signal]);voe(1/0,s);const a=Goe("libp2p:kad-dht:".concat(n.lan?"lan":"wan",":query:")+(0,Au.B)(e,"base58btc")),c=Date.now(),l=new goe;try{var u;!0!==r.isSelfQuery&&null!=n.initialQuerySelfHasRun&&(a("waiting for initial query-self query before continuing"),await Promise.race([new Promise(((e,t)=>{s.addEventListener("abort",(()=>{t(new coe("Query was aborted before self-query ran"))}))})),n.initialQuerySelfHasRun.promise]),n.initialQuerySelfHasRun=void 0),a("query:start"),n.queries++,null===(u=n.metrics)||void 0===u||u.runningQueries.update(n.queries);const i=await yce(e),o=n.routingTable.closestPeers(i),c=o.slice(0,Math.min(n.disjointPaths,o.length));if(0===o.length)return void a.error("Running query with no peers");const h=new ux,d=c.map(((i,o)=>Mle({key:e,startingPeer:i,ourPeerId:n.components.peerId,signal:s,query:t,pathIndex:o,numPaths:c.length,alpha:n.alpha,cleanUp:l,queryFuncTimeout:r.queryFuncTimeout,log:a,peersSeen:h,onProgress:r.onProgress})));for await(const e of ese(...d))yield e,"QUERY_ERROR"===e.name&&a("error",e.error)}catch(d){if(n.running||"ERR_QUERY_ABORTED"!==d.code)throw d}finally{var h;s.clear(),n.queries--,null===(h=n.metrics)||void 0===h||h.runningQueries.update(n.queries),null!=o&&o(),l.dispatchEvent(new moe("cleanup")),a("query:done in %dms",Date.now()-c)}}()}catch(r){return Promise.reject(r)}}}const Fle=function(e){if(null!=e[Symbol.asyncIterator])return(async()=>{let t=0;for await(const n of e)t++;return t})();{let t=0;for(const n of e)t++;return t}};const Kle=function(e,t){return null!=e[Symbol.asyncIterator]?async function*(){let n=0;if(!(t<1))for await(const r of e)if(yield r,n++,n===t)return}():function*(){let n=0;if(!(t<1))for(const r of e)if(yield r,n++,n===t)return}()},jle=e=>{const t=e.on||e.addListener||e.addEventListener,n=e.off||e.removeListener||e.removeEventListener;if(!t||!n)throw new TypeError("Emitter is not compatible");return{addListener:t.bind(e),removeListener:n.bind(e)}};function Zle(e,t,n){"function"===typeof n&&(n={filter:n});const r=function(e,t,n){let r;const i=new Promise(((i,o)=>{var s;if(!((n={rejectionEvents:["error"],multiArgs:!1,resolveImmediately:!1,...n}).count>=0)||n.count!==Number.POSITIVE_INFINITY&&!Number.isInteger(n.count))throw new TypeError("The `count` option should be at least 0 or more");null===(s=n.signal)||void 0===s||s.throwIfAborted();const a=[t].flat(),c=[],{addListener:l,removeListener:u}=jle(e),h=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];const s=n.multiArgs?t:t[0];n.filter&&!n.filter(s)||(c.push(s),n.count===c.length&&(r(),i(c)))},d=e=>{r(),o(e)};r=()=>{for(const e of a)u(e,h);for(const e of n.rejectionEvents)u(e,d)};for(const e of a)l(e,h);for(const e of n.rejectionEvents)l(e,d);n.signal&&n.signal.addEventListener("abort",(()=>{d(n.signal.reason)}),{once:!0}),n.resolveImmediately&&i(c)}));if(i.cancel=r,"number"===typeof n.timeout){const e=YB(i,{milliseconds:n.timeout});return e.cancel=r,e}return i}(e,t,n={...n,count:1,resolveImmediately:!1}),i=r.then((e=>e[0]));return i.cancel=r.cancel,i}class zle{constructor(e,t){var n;(0,Yo.Z)(this,"log",void 0),(0,Yo.Z)(this,"components",void 0),(0,Yo.Z)(this,"peerRouting",void 0),(0,Yo.Z)(this,"routingTable",void 0),(0,Yo.Z)(this,"count",void 0),(0,Yo.Z)(this,"interval",void 0),(0,Yo.Z)(this,"initialInterval",void 0),(0,Yo.Z)(this,"queryTimeout",void 0),(0,Yo.Z)(this,"started",void 0),(0,Yo.Z)(this,"timeoutId",void 0),(0,Yo.Z)(this,"controller",void 0),(0,Yo.Z)(this,"initialQuerySelfHasRun",void 0),(0,Yo.Z)(this,"querySelfPromise",void 0);const{peerRouting:r,lan:i,count:o,interval:s,queryTimeout:a,routingTable:c}=t;this.components=e,this.log=Goe("libp2p:kad-dht:".concat(i?"lan":"wan",":query-self")),this.started=!1,this.peerRouting=r,this.routingTable=c,this.count=null!==o&&void 0!==o?o:rse,this.interval=null!==s&&void 0!==s?s:ose,this.initialInterval=null!==(n=t.initialInterval)&&void 0!==n?n:sse,this.queryTimeout=null!==a&&void 0!==a?a:ase,this.initialQuerySelfHasRun=t.initialQuerySelfHasRun}isStarted(){return this.started}start(){this.started||(this.started=!0,clearTimeout(this.timeoutId),this.timeoutId=setTimeout((()=>{this.querySelf().catch((e=>{this.log.error("error running self-query",e)}))}),this.initialInterval))}stop(){this.started=!1,null!=this.timeoutId&&clearTimeout(this.timeoutId),null!=this.controller&&this.controller.abort()}async querySelf(){if(this.started){if(null!=this.querySelfPromise)return this.log("joining existing self query"),this.querySelfPromise.promise;if(this.querySelfPromise=Ws(),this.started){this.controller=new AbortController;const t=Ble([this.controller.signal,AbortSignal.timeout(this.queryTimeout)]);voe(1/0,t);try{0===this.routingTable.size&&(this.log("routing table was empty, waiting for some peers before running query"),await Zle(this.routingTable,"peer:add",{signal:t})),this.log("run self-query, look for %d peers timing out after %dms",this.count,this.queryTimeout);const e=Date.now(),n=await fse(this.peerRouting.getClosestPeers(this.components.peerId.toBytes(),{signal:t,isSelfQuery:!0}),(e=>Kle(e,this.count)),(async e=>Fle(e)));this.log("self-query found %d peers in %dms",n,Date.now()-e)}catch(e){this.log.error("self-query error",e)}finally{t.clear(),null!=this.initialQuerySelfHasRun&&(this.initialQuerySelfHasRun.resolve(),this.initialQuerySelfHasRun=void 0)}}this.querySelfPromise.resolve(),this.querySelfPromise=void 0,this.started&&(this.timeoutId=setTimeout((()=>{this.querySelf().catch((e=>{this.log.error("error running self-query",e)}))}),this.interval))}else this.log("skip self-query because we are not started")}}function Vle(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0,r=e.length;n<r;++n)if(e[n]!==t[n])return!1;return!0}function Hle(e,t){if(!(t instanceof Uint8Array))throw new TypeError(e+" is not a Uint8Array")}class qle extends goe{constructor(e){var t,n,r,i;super(),(0,Yo.Z)(this,"localNodeId",void 0),(0,Yo.Z)(this,"root",void 0),(0,Yo.Z)(this,"numberOfNodesPerKBucket",void 0),(0,Yo.Z)(this,"numberOfNodesToPing",void 0),(0,Yo.Z)(this,"distance",void 0),(0,Yo.Z)(this,"arbiter",void 0),this.localNodeId=e.localNodeId,this.numberOfNodesPerKBucket=null!==(t=e.numberOfNodesPerKBucket)&&void 0!==t?t:20,this.numberOfNodesToPing=null!==(n=e.numberOfNodesToPing)&&void 0!==n?n:3,this.distance=null!==(r=e.distance)&&void 0!==r?r:qle.distance,this.arbiter=null!==(i=e.arbiter)&&void 0!==i?i:qle.arbiter,Hle("option.localNodeId as parameter 1",this.localNodeId),this.root={contacts:[],dontSplit:!1,left:null,right:null}}static arbiter(e,t){var n,r;return(null!==(n=e.vectorClock)&&void 0!==n?n:0)>(null!==(r=t.vectorClock)&&void 0!==r?r:0)?e:t}static distance(e,t){let n=0,r=0;const i=Math.min(e.length,t.length),o=Math.max(e.length,t.length);for(;r<i;++r)n=256*n+(e[r]^t[r]);for(;r<o;++r)n=256*n+255;return n}add(e){Hle("contact.id",null===e||void 0===e?void 0:e.id);let t=0,n=this.root;for(;null===n.contacts;)n=this._determineNode(n,e.id,t++);const r=this._indexOf(n,e.id);return r>=0?(this._update(n,r,e),this):n.contacts.length<this.numberOfNodesPerKBucket?(n.contacts.push(e),this.safeDispatchEvent("added",{detail:e}),this):n.dontSplit?(this.safeDispatchEvent("ping",{detail:{oldContacts:n.contacts.slice(0,this.numberOfNodesToPing),newContact:e}}),this):(this._split(n,t),this.add(e))}closest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;if(Hle("id",e),!Number.isInteger(t)&&t!==1/0||t<=0)throw new TypeError("n is not positive number");let n=[];for(let r=[this.root],i=0;r.length>0&&n.length<t;){const t=r.pop();if(null!=t)if(null===t.contacts){const n=this._determineNode(t,e,i++);r.push(t.left===n?t.right:t.left),r.push(n)}else n=n.concat(t.contacts)}return n.map((t=>({distance:this.distance(t.id,e),contact:t}))).sort(((e,t)=>e.distance-t.distance)).slice(0,t).map((e=>e.contact))}count(){let e=0;for(const t=[this.root];t.length>0;){const n=t.pop();null!=n&&(null===n.contacts?t.push(n.right,n.left):e+=n.contacts.length)}return e}_determineNode(e,t,n){const r=n>>3,i=n%8;if(t.length<=r&&0!==i)return e.left;return 0!==(t[r]&1<<7-i)?e.right:e.left}get(e){Hle("id",e);let t=0,n=this.root;for(;null===n.contacts;)n=this._determineNode(n,e,t++);const r=this._indexOf(n,e);return r>=0?n.contacts[r]:void 0}_indexOf(e,t){for(let n=0;n<e.contacts.length;++n)if(Vle(e.contacts[n].id,t))return n;return-1}remove(e){Hle("the id as parameter 1",e);let t=0,n=this.root;for(;null===n.contacts;)n=this._determineNode(n,e,t++);const r=this._indexOf(n,e);if(r>=0){const e=n.contacts.splice(r,1)[0];this.safeDispatchEvent("removed",{detail:e})}return this}_split(e,t){e.left={contacts:[],dontSplit:!1,left:null,right:null},e.right={contacts:[],dontSplit:!1,left:null,right:null};for(const r of e.contacts)this._determineNode(e,r.id,t).contacts.push(r);e.contacts=null;const n=this._determineNode(e,this.localNodeId,t);(e.left===n?e.right:e.left).dontSplit=!0}toArray(){let e=[];for(const t=[this.root];t.length>0;){const n=t.pop();null!=n&&(null===n.contacts?t.push(n.right,n.left):e=e.concat(n.contacts))}return e}*toIterable(){for(const e=[this.root];e.length>0;){const t=e.pop();null!=t&&(null===t.contacts?e.push(t.right,t.left):yield*t.contacts)}}_update(e,t,n){if(!Vle(e.contacts[t].id,n.id))throw new Error("wrong index for _update");const r=e.contacts[t],i=this.arbiter(r,n);i===r&&r!==n||(e.contacts.splice(t,1),e.contacts.push(i),this.safeDispatchEvent("updated",{detail:{incumbent:r,selection:i}}))}}class Gle extends goe{constructor(e,t){super(),(0,Yo.Z)(this,"kBucketSize",void 0),(0,Yo.Z)(this,"kb",void 0),(0,Yo.Z)(this,"pingQueue",void 0),(0,Yo.Z)(this,"log",void 0),(0,Yo.Z)(this,"components",void 0),(0,Yo.Z)(this,"lan",void 0),(0,Yo.Z)(this,"pingTimeout",void 0),(0,Yo.Z)(this,"pingConcurrency",void 0),(0,Yo.Z)(this,"running",void 0),(0,Yo.Z)(this,"protocol",void 0),(0,Yo.Z)(this,"tagName",void 0),(0,Yo.Z)(this,"tagValue",void 0),(0,Yo.Z)(this,"metrics",void 0);const{kBucketSize:n,pingTimeout:r,lan:i,pingConcurrency:o,protocol:s,tagName:a,tagValue:c}=t;this.components=e,this.log=Goe("libp2p:kad-dht:".concat(i?"lan":"wan",":routing-table")),this.kBucketSize=null!==n&&void 0!==n?n:20,this.pingTimeout=null!==r&&void 0!==r?r:1e4,this.pingConcurrency=null!==o&&void 0!==o?o:10,this.lan=i,this.running=!1,this.protocol=s,this.tagName=null!==a&&void 0!==a?a:"kad-close",this.tagValue=null!==c&&void 0!==c?c:50;const l=()=>{var e,t;null===(e=this.metrics)||void 0===e||e.pingQueueSize.update(this.pingQueue.size),null===(t=this.metrics)||void 0===t||t.pingRunning.update(this.pingQueue.pending)};this.pingQueue=new Bm.Z({concurrency:this.pingConcurrency}),this.pingQueue.addListener("add",l),this.pingQueue.addListener("next",l),this._onPing=this._onPing.bind(this)}isStarted(){return this.running}async start(){this.running=!0,null!=this.components.metrics&&(this.metrics={routingTableSize:this.components.metrics.registerMetric("libp2p_kad_dht_".concat(this.lan?"lan":"wan","_routing_table_size")),pingQueueSize:this.components.metrics.registerMetric("libp2p_kad_dht_".concat(this.lan?"lan":"wan","_ping_queue_size")),pingRunning:this.components.metrics.registerMetric("libp2p_kad_dht_".concat(this.lan?"lan":"wan","_ping_running"))});const e=new qle({localNodeId:await mce(this.components.peerId),numberOfNodesPerKBucket:this.kBucketSize,numberOfNodesToPing:1});this.kb=e,e.addEventListener("ping",this._onPing),this._tagPeers(e)}async stop(){this.running=!1,this.pingQueue.clear(),this.kb=void 0}_tagPeers(e){let t=new ux;const n=function(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return()=>{clearTimeout(t),t=setTimeout((()=>{e()}),n)}}((()=>{const n=new ux(e.closest(e.localNodeId,20).map((e=>e.peer))),r=n.difference(t),i=t.difference(n);Promise.resolve().then((async()=>{for(const e of r)await this.components.peerStore.merge(e,{tags:{[this.tagName]:{value:this.tagValue}}});for(const e of i)await this.components.peerStore.merge(e,{tags:{[this.tagName]:void 0}})})).catch((e=>{this.log.error("Could not update peer tags",e)})),t=n}));e.addEventListener("added",(e=>{n(),this.safeDispatchEvent("peer:add",{detail:e.detail.peer})})),e.addEventListener("removed",(e=>{n(),this.safeDispatchEvent("peer:remove",{detail:e.detail.peer})}))}_onPing(e){const{oldContacts:t,newContact:n}=e.detail;this.pingQueue.add((async()=>{if(!this.running)return;let e=0;try{await Promise.all(t.map((async t=>{try{const n={signal:AbortSignal.timeout(this.pingTimeout)};this.log("pinging old contact %p",t.peer);const r=await this.components.connectionManager.openConnection(t.peer,n),i=await r.newStream(this.protocol,n);await i.close(),e++}catch(r){this.running&&null!=this.kb&&(this.log.error("could not ping peer %p",t.peer,r),this.log("evicting old contact after ping failed %p",t.peer),this.kb.remove(t.id))}finally{var n;null===(n=this.metrics)||void 0===n||n.routingTableSize.update(this.size)}}))),this.running&&e<t.length&&null!=this.kb&&(this.log("adding new contact %p",n.peer),this.kb.add(n))}catch(r){this.log.error("could not process k-bucket ping event",r)}})).catch((e=>{this.log.error("could not process k-bucket ping event",e)}))}get size(){return null==this.kb?0:this.kb.count()}async find(e){const t=await mce(e),n=this.closestPeer(t);if(null!=n&&e.equals(n))return n}closestPeer(e){const t=this.closestPeers(e,1);if(t.length>0)return t[0]}closestPeers(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.kBucketSize;if(null==this.kb)return[];return this.kb.closest(e,t).map((e=>e.peer))}async add(e){var t;if(null==this.kb)throw new Error("RoutingTable is not started");const n=await mce(e);this.kb.add({id:n,peer:e}),this.log("added %p with kad id %b",e,n),null===(t=this.metrics)||void 0===t||t.routingTableSize.update(this.size)}async remove(e){var t;if(null==this.kb)throw new Error("RoutingTable is not started");const n=await mce(e);this.kb.remove(n),null===(t=this.metrics)||void 0===t||t.routingTableSize.update(this.size)}}const Wle=[77591,22417,43971,28421,740,29829,71467,228973,196661,78537,27689,36431,44415,14362,19456,106025,96308,2882,49509,21149,87173,131409,75844,23676,121838,30291,17492,2953,7564,110620,129477,127283,53113,72417,165166,109690,21200,102125,24049,71504,90342,25307,72039,26812,26715,32264,133800,71161,88956,171987,51779,24425,16671,30251,186294,247761,14202,2121,8465,35024,4876,85917,169730,3638,256836,96184,943,18678,6583,52907,35807,112254,214097,18796,11595,9243,23554,887,268203,382004,24590,111335,11625,16619,29039,102425,69006,97976,92362,32552,63717,41433,128974,137630,59943,10019,13986,35430,33665,108037,43799,43280,38195,29078,58629,18265,14425,46832,235538,40830,77881,110717,58937,3463,325358,51300,47623,117252,19007,10170,20540,91237,294813,4951,79841,56232,36270,128547,69209,66275,100156,32063,73531,34439,80937,28892,44466,88595,216307,32583,49620,16605,82127,45807,21630,78726,20235,40163,111007,96926,5567,72083,21665,58844,39419,179767,48328,42662,51550,5251,37811,49608,81056,50854,55513,20922,18891,197409,164656,32593,71449,220474,58919,85682,67854,13758,35066,3565,61905,214793,119572,141419,21504,10302,27354,67003,46131,32668,15165,64871,34450,17821,2757,11452,34189,5160,12257,85523,560,53385,65887,119549,135620,312353,115979,122356,10867,193231,124537,54783,90675,120791,4715,142253,50943,17271,43358,25331,4917,120566,34580,12878,33786,160528,32523,4869,301307,104817,81491,23276,8832,97911,31265,52065,7998,49622,9715,43998,34091,84587,20664,69041,29419,53205,10838,58288,116145,6185,5154,141795,35924,21307,144738,43730,12085,8279,10002,119,133779,199668,72938,31768,39176,67875,38453,9700,44144,4121,116048,41733,12868,82669,92308,128,34262,11332,7712,90764,36141,13553,71312,77470,117314,96549,49135,23602,54468,28605,6327,62308,17171,67531,21319,14105,894,107722,46157,8503,51069,100472,45138,15246,14577,35609,191464,1757,13364,161349,32067,91705,81144,52339,5408,91066,21983,14157,100545,4372,26630,129112,1423,29676,213626,4397,88436,99190,6877,49958,26122,114348,60661,29818,293118,50042,179738,16400,163423,89627,31040,43973,36638,45952,5153,1894,109322,1898,134021,12402,112077,68309,190269,69866,31938,107383,11522,105232,11248,14868,39852,71707,186525,16530,38162,106212,11700,5130,16608,26998,59586,108399,230033,43683,48135,82179,2073,5015,196684,189293,16378,23452,8301,35640,11632,214551,29240,57644,33137,91949,55157,52384,117313,5090,17717,89668,49363,82238,241035,66216,29066,184088,97206,62820,26595,4241,135635,173672,8202,459,71355,146294,29587,3008,135385,141203,14803,6634,45094,69362,50925,546,51884,62011,83296,234584,44515,56050,89476,87751,19373,12691,149923,19794,13833,35846,87557,58339,2884,19145,25647,12224,11024,77338,64608,122297,53025,7205,36189,36294,170779,21750,7739,173883,75192,35664,224240,113121,30181,26267,27036,117827,92015,106516,55628,203549,67949,60462,60844,35911,20457,1820,920,19773,8738,73173,181993,38521,98254,76257,46008,92796,5384,26868,151566,22124,2411,15919,186872,180021,28099,152961,78811,80237,62352,102653,74259,184890,16792,123702,224945,29940,19512,75283,14059,112691,92811,233329,20411,138569,53341,109802,50600,134528,66747,5529,166531,31578,64732,67189,1596,126357,967,167999,206598,109752,119431,207825,78791,91938,10301,27311,24233,252343,28831,32812,66002,112267,90895,8786,8095,16824,22866,21813,60507,174833,19549,130985,117051,52110,6938,81923,123864,38061,919,18680,53534,46739,112893,161529,85429,26761,11900,81121,91968,15390,217947,56524,1713,6654,37089,85630,138866,61850,16491,75577,16884,98296,73523,6140,44645,6062,36366,29844,57946,37932,42472,5266,20834,19309,33753,127182,134259,35810,41805,45878,312001,14881,47757,49251,120050,44252,3708,25856,107864,120347,1228,36550,41682,34496,47025,8393,173365,246526,12894,161607,35670,90785,126572,2095,124731,157033,58694,554,12786,9642,4817,16136,47864,174698,66992,4639,69284,10625,40710,27763,51738,30404,264105,137904,109882,52487,42824,57514,2740,10479,146799,107390,16586,88038,174951,9410,16185,44158,5568,40658,46108,12763,97385,26175,108859,664,230732,67470,46663,14395,50750,141320,93140,15361,47997,55784,6791,307840,118569,107326,18056,58281,260415,54691,8790,73332,45633,7511,45674,143373,14031,11799,94491,35646,96544,14560,26049,32983,25791,83814,42094,231370,63955,139212,2359,169908,3108,183486,105867,28197,32941,124968,26402,88267,149768,23053,3078,19091,52924,25383,19209,111548,97361,3959,24880,235061,9099,24921,161254,151405,20508,7159,34381,20133,11434,74036,19974,34769,36585,1076,22454,17354,38727,235160,111547,96454,117448,156940,91330,37299,7310,26915,117060,51369,22620,61861,322264,106850,111694,15091,2624,40345,300446,177064,1707,27389,54792,327783,132669,183543,59003,17744,20603,151134,106923,53084,71803,279424,319816,11579,21946,16728,38274,72711,5085,83391,88646,40159,25027,34680,10752,12988,54126,30365,18338,100445,230674,44874,84974,143877,123253,139372,28082,91477,144002,13096,219729,46016,50029,42377,14601,6660,58244,58978,23918,88206,113611,64452,17541,41032,10942,12021,49189,10978,40175,37156,10947,71709,106894,112538,57007,137486,150608,152719,40615,7746,279716,13101,19524,28708,40578,72320,1096,182051,94527,51275,22833,45164,81917,77519,48508,5421,140302,37845,149830,5587,27579,5357,428725,248187,6326,206760,39814,32585,89923,44341,288753,284443,96368,31201,94189,119504,20359,52073,103216,179,27934,32801,96035,34111,34309,101326,18198,20704,210266,37643,27880,141873,106e3,19414,56614,167714,66483,107885,86602,4379,20796,75467,4987,5017,118857,26003,34308,114428,29198,6686,29697,73632,3739,69795,16798,41504,7207,30722,21436,36735,28067,28545,3239,11221,36031,41889,100010,19247,317673,29495,174554,6424,129725,53845,94986,7955,59676,2604,191497,19735,102214,62954,23844,11872,179525,261436,34492,428,78404,142035,16747,17246,27578,37021,33672,57944,26056,135760,2369,61674,122066,31327,19374,157065,40553,130982,69619,71290,38855,72100,92903,95940,51422,165999,65713,57873,50726,7288,20272,2081,42326,22624,81120,57914,79352,19447,1684,72302,11774,302559,161481,96396,13692,414988,3721,79066,56627,46883,21150,11747,12184,5856,113458,176117,84416,52079,27933,3354,59765,141359,2212,216309,2555,23458,196722,142463,45701,44548,28798,19418,215,29916,9396,10574,114226,84475,13520,18694,34056,4524,90302,62930,13539,19407,77209,7728,38088,9535,2263,23875,183945,17750,26274,67172,10585,28042,22199,7478,51331,66030,26774,192929,31434,25850,50197,52926,178158,4679,181256,70184,229600,9959,105594,72158,73974,2726,35085,78087,23284,35568,51713,155676,5401,27254,11966,17569,223253,71993,103357,111477,55722,30504,26034,46774,35392,36285,214814,41143,163465,1051,16094,81044,6636,76489,179102,20712,39178,35683,125177,54219,30617,52994,25324,50123,2543,87529,58995,10688,125199,12388,60158,125481,131646,7642,133350,65874,3438,97277,101450,10075,56344,116821,50778,60547,98016,106135,13859,14255,16300,77373,173521,8285,45932,37426,4054,114295,55947,7703,39114,52,51119,128135,19714,60715,9554,50492,88180,2823,118271,52993,122625,97919,23859,37895,25040,33614,32102,20431,3577,9275,15686,43031,157741,110358,1884,40291,125391,13736,5008,64881,87336,77381,70711,43032,49155,118587,70494,4318,10168,30126,12580,10524,280104,104001,145413,2862,84140,6603,106005,13566,12780,11251,42830,571,179910,82443,13146,469,42714,32591,265217,424024,92553,54721,134100,6007,15242,114681,59030,16718,85465,200214,85982,55174,165013,23493,56964,82529,109150,32706,27568,82442,5350,14976,13165,44890,60021,21343,33978,17264,4655,22328,27819,75730,16567,55483,14510,17926,45827,150609,3704,7385,272531,161543,76904,122163,52405,2039,19165,41623,14423,228354,3369,176360,85491,7122,35789,303724,4465,13628,2233,55311,118771,20713,10006,221519,45115,71021,35650,29775,7337,10864,20665,21142,1746,15080,1624,32449,10905,105743,229797,7701,3940,22997,178467,57208,389057,39683,59403,63344,63125,54847,69691,18336,56448,3362,37202,18282,29648,138224,35867,10495,5911,28814,26653,31514,176702,26550,45621,11734,4525,40543,73944,121080,27858,155561,14887,44670,30742,8796,107455,113472,56369,75581,183777,240095,133699,153299,8768,160464,26058,49078,103971,21875,71486,44888,17156,9678,89541,123019,102337,3972,83930,21245,87852,109660,287918,183019,686,10100,39177,283941,11274,24736,26793,26214,25995,77011,141580,4070,23742,46285,46632,30700,26669,19056,35951,115575,174034,56097,35463,87425,24575,44245,38701,82317,85922,281616,100333,147697,61503,7730,84330,8530,59917,61597,17173,9092,32658,90288,193136,39023,20381,56654,31132,7779,1919,1375,117128,30819,11169,40938,23935,115201,101155,151034,4835,11231,74550,89388,59951,91704,107312,167882,115062,12732,72738,88703,464019,158267,57995,60496,737,14371,123867,4174,243339,159946,7568,16025,134556,110916,38103,191,80226,88794,29688,27230,10454,76308,57647,77409,113483,66864,14745,19808,12023,46583,84805,16015,17102,2231,20611,3547,95740,250131,34559,108894,8498,15853,159169,148920,20942,2813,93160,45188,210613,45531,52587,149062,39782,28194,57849,60965,84954,89766,84453,100927,16501,27658,165311,103841,54192,207341,19558,20084,319622,5672,205467,98462,61849,36279,13609,147177,24726,165015,209489,59591,31157,6551,117580,75060,141146,277310,21072,22023,106474,63041,137443,122965,68371,5383,42146,98961,113467,30863,23794,4843,99630,30392,82679,13699,241612,33601,93146,24319,18643,32155,95669,40440,15333,34089,67799,142144,58245,38633,114531,117400,77861,188726,5507,2568,8853,10987,107222,2663,2421,11530,13345,30075,41785,118661,104786,17459,12490,16281,71936,193555,17431,5944,71758,26485,77317,20803,367167,158,7362,93430,11735,172445,46002,11532,54482,930,62911,2235,23004,179236,4764,101859,208113,22477,55163,95579,14098,67320,162556,90709,156949,3826,57492,4025,34092,87442,104565,6718,186015,28214,14209,10039,107186,233912,58877,81637,55265,39828,6194,145813,50831,105849,4974,88319,122296,10272,197216,95714,51540,72418,23324,91555,8743,140452,250249,51666,34124,7229,38592,129641,78169,174242,22464,149964,51450,14034,10026,95376,26190,120062,14401,8700,265,31386,143573,7203,229889,61567,4227,140981,2466,72052,10787,10062,30958,6099,38471,30103,23202,208101,70847,467,58934,32271,32984,36637,24107,30771,17109,73353,13650,2098,157040,67366,66904,106018,265380,107238,18535,44025,32681,144983,62505,91295,56120,3082,77508,10322,63023,36700,81885,224127,16721,45023,239261,111272,13852,7866,149243,204199,32309,22084,42029,38316,126644,104973,14406,43454,67322,61310,15789,40285,24026,181047,6301,70927,23319,115823,27248,66693,115875,278566,63007,146844,56841,59007,87368,180001,22370,42114,80605,12022,10374,308,25079,14689,12618,63368,7936,264973,212291,136713,95999,105801,18965,32075,48700,52230,35119,96912,32992,8586,16606,101333,101812,14969,39930,759,193090,27387,42914,12937,5058,62646,64528,38624,25743,37502,3716,4435,30352,178687,26461,132611,42002,138442,35833,59582,16345,8048,60319,49349,309,47800,49739,90482,26405,34470,63786,32479,85028,39866,47846,11649,23934,29466,2816,42864,31828,7410,74885,49632,47629,111801,90749,19536,18767,105764,59606,21223,10746,76298,22220,39408,7190,79654,64856,11602,82156,272765,17079,70089,245473,51813,184407,384678,1576,122249,5064,27481,6188,25790,74361,27541,318284,45430,31488,620,93579,45723,192118,22670,51913,4162,70244,35966,26397,16199,50899,209613,121702,287507,2993,36101,132229,67345,33062,76295,118628,78705,52316,34375,107083,107454,44863,127561,33964,3073,154010,190914,55967,39074,6272,31047,5550,41123,26154,98638,47110,19998,148091,50229,31329,59900,195442,19106,61347,73497,70015,682,45850,25776,38022,148951,6288,37411,232526,109277,27286,32342,9262,5220,16651,23175,46740,129438,78614,121925,66914,88710,127952,5563,21500,34521,10739,14863,191006,62956,17359,16749,67027,56284,69134,43301,35039,58883,54466,60823,404451,75743,59856,86979,7923,34273,83785,32142,7693,268986,197428,282681,17049,22346,22990,92245,107180,3357,37104,96724,49153,7683,31197,43267,82231,164276,23696,20848,188364,22309,24821,158707,1018,22514,70922,27792,45589,59709,10765,736,35218,63479,51987,24275,63588,55361,92929,81964,4658,20122,12330,44058,13065,311456,72224,8337,211229,38979,22590,138478,52757,32595,133600,8838,31549,94412,43391,90056,1585,94802,127271,6223,31889,137038,132910,2165,57616,230152,6080,10748,36737,74579,134062,50525,180532,119270,34556,76155,82394,52595,29258,31435,87820,67996,26943,183878,38007,2410,13526,180297,69856,3503,187396,167700,7838,16701,9199,56267,3661,37407,65994,23767,5708,62508,221700,67088,86978,46776,84434,32088,5612,9149,88244,21685,95151,46750,189612,2979,506311,2594,3628,40074,105039,78243,28523,6651,38058,71999,30992,12764,68261,108991,6165,26450,61961,13400,22426,7490,60890,109623,2070,12958,50355,67979,257096,7213,42578,52121,35716,65461,7516,124758,39268,302,64712,14977,1467,219452,2840,34229,11121,21602,19270,63574,8024,1532,17331,79839,78885,52029,180767,57957,6069,91265,61380,55767,8927,32881,287603,22149,35029,68876,6428,199567,46926,13412,104132,21434,366616,45060,110046,81924,128910,45886,52821,130416,29416,77342,21762,67329,121432,79924,11724,38625,81006,102033,28338,13326,3250,82056,82526,38212,21112,12382,111495,3263,7414,86274,93490,40844,30224,45212,24019,48411,71367,24941,76729,57776,3769,38114,202019,197745,31953,237533,33270,201580,255648,100798,44741,32241,98468,106931,10085,15090,170358,33154,66787,18819,69760,25061,234005,82660,6295,131975,16874,9076,4094,25005,17740,40908,19533,220019,44330,99792,50040,19619,13950,55228,24423,31253,95308,103177,184795,28590,82285,5059,3210,75525,49894,70007,56178,10580,36051,139681,21617,98736,3555,106306,164189,37352,63915,47824,24883,145530,61904,28444,11483,19837,145446,30420,112972,85939,11835,191233,2262,20705,58630,1753,148334,1197,144714,6887,11223,107667,60879,77914,4151,57417,81594,96681,169430,1784,20444,95138,254041,27038,596,7117,72808,13759,3353,126776,21074,55322,27081,36942,39547,139830,179275,4453,713,8722,71399,19204,25785,22794,23923,104114,11291,25458,102309,88396,75288,230440,206396,104551,58447,130857,37247,94734,31548,176529,226077,65159,20104,10096,66881,94191,237909,27109,37404,1520,27421,25220,113003,23423,24884,50585,6286,231877,150800,11789,3226,90004,60642,5053,202400,61442,132531,175329,57138,30116,103847,9973,75367,16452,32360,59119,21246,10191,164804,23305,61051,37348,154530,13214,5468,50403,66754,130976,50559,80515,14436,155492,84017,5472,43107,41240,2890,90431,70188,382,76234,48040,50211,281038,237007,32115,142178,1536,22761,96429,1811,31243,1679,49143,55209,17402,235054,61494,7462,77030,34925,87609,78002,9499,9027,73289,201078,101379,63544,27666,5469,10642,30029,49816,132979,95620,58086,351930,116300,2110,2043,30845,6154,11279,16727,4122,2277,27281,4971,3650,39060,61970,65951,39674,75686,38151,11370,130809,177895,32665,63725,122267,7857,39618,118483,44792,157755,178624,136994,24260,41308,22471,12404,21707,12486,30473,52781,50246,20247,39065,909,56825,103158,128603,31542,1089,41935,32744,12428,37963,84420,33134,72921,208449,42622,168151,127335,147107,46699,38216,12591,94342,85814,31423,24944,2605,87542,67473,192551,4496,56321,91819,17630,6300,256183,114569,202090,33209,35289,34897,24967,40520,43470,5344,10199,34810,14283,10381,10017,62923,49924,23233,64539,13051,35686,19698,11570,135555,120868,44924,87065,52318,52335,47586,140906,245885,109834,78668,9065,46990,25258,72022,61243,40838,4545,146387,10537,11557,17470,36930,68104,46711,24264,79401,81043,18225,120488,24746,84338,81652,28266,13776,21878,46973,1047,230465,73357,95777,24973,210160,62210,58404,110633,169651,6937,41870,9909,26822,191062,76553,27519,96256,239070,2478,205678,67955,58532,20601,50120,19148,78501,195724,110740,8249,109665,27446,30568,57631,31425,49752,32820,65504,50079,3663,102256,219898,23849,211315,14645,4359,91767,9528,12449,49366,7941,49763,107848,8930,27086,50686,9744,10447,81935,39513,46514,1670,29229,6172,22312,137280,97759,9806,14445,22976,56458,73391,34983,93760,174219,52573,33149,59747,2429,136277,75123,165263,91040,7446,57632,48633,97140,246081,84766,151684,79918,93268,120346,54059,54875,77858,32996,103590,45276,11968,19600,25849,17159,132907,42828,16817,4913,99462,103303,27395,5737,74184,20749,21160,14377,77062,131403,158735,10999,27799,77785,9320,34366,51593,61070,33746,47048,29268,36675,30262,53297,9832,82e3,20188,122292,39917,7331,18160,68301,185935,134830,15031,4935,10004,165845,185534,46923,30109,44134,122631,18874,22903,112790,26561,18549,348902,82871,140345,255565,135390,63556,103747,145055,179600,145662,296111,61661,211987,23952,52342,126343,48450,32919,44277,82185,9591,62139,205363,376969,394874,108461,18040,120885,14798,39863,16571,16794,58271,81025,55206,14640,118656,6361,44092,85970,6262,153863,108244,180200,72264,79947,38044,10050,5735,61221,80712,5471,115689,11391,11661,184257,20010,60116,30320,19327,134598,45455,27542,18004,125092,452272,1549,91523,46567,180063,156026,2608,11174,58848,37788,65907,80194,30490,5786,40775,119519,106241,11323,156297,8425,61495,2617,29675,2425,59886,112582,49142,59618,4863,50597,86710,50650,168632,27693,85641,83643,18993,25768,84284,28090,93592,36627,312804,43381,9887,9402,100931,97165,3311,173330,66805,28935,4963,184460,3201,78102,19126,21607,37496,24938,22615,16153,32862,134792,153318,61120,6067,2812,12826,12792,23825,37559,64662,202250,102694,155488,85881,149193,46233,65383,15521,106982,11358,176786,25752,39717,34208,24510,32464,77742,39371,72028,138229,60688,71386,102834,132477,2208,11548,63670,271279,28351,30338,38620,32491,99845,143885,152266,13252,2825,178663,108097,1775,78201,14897,113573,163346,62292,171129,22183,96598,38733,64971,166776,117445,9968,146393,44677,74867,20908,97328,12761,25656,26785,9148,112344,26115,99176,110121,22437,49547,6180,79320,5835,31392,43328,33377,75870,119860,69497,80273,7325,155219,43167,111173,28347,20222,3763,71752,55041,47252,14618,28088,15012,97805,194698,54636,2036,41349,6173,96604,61530,51859,43782,13361,24334,22668,24792,7070,23441,16789,3209,36211,208475,26242,32880,122181,182407,21444,31060,88459,29929,77907,12716,10934,97005,20599,31690,8403,58445,30303,22700,10336,86731,103115,337709,72556,46788,112566,47684,67089,53548,36874,56487,41387,125985,26893,40071,106683,73712,18787,40105,72992,67246,137276,50802,36790,70328,138827,22466,39263,183295,29858,50975,9322,57397,10654,24364,30383,55799,41600,23584,127295,296610,129078,143558,244131,86397,36049,1085,80677,3820,108139,5476,34767,24683,7758,13060,7239,131671,250593,59556,103392,29810,4188,252323,39404,116877,7651,43600,40338,13554,157253,39196,25978,144387,61211,234,50104,6129,10449,93777,9240,356378,274148,4439,72970,3724,147770,78680,62570,115877,40027,40547,36817,224392,64609,34795,165027,67440,2477,37206,23431,50754,164797,46018,94995,170982,27051,7957,22767,3674,27900,56419,18930,60701,41302,2692,84749,339721,61996,111094,80221,50129,1045,8153,62945,19202,8250,37208,37418,32560,79477,41106,88569,33963,36693,5892,30570,1581,66471,49647,11922,160717,29442,5643,114865,82962,95982,132098,22633,22838,94726,54556,28566,205039,162340,33216,16849,35847,221339,94851,26533,71469,1805,3804,12935,45483,71020,36310,65381,192960,34240,35165,59773,1248,46954,155332,96864,4246,388800,16129,57133,74592,44807,442014,38203,42574,80818,91592,26377,36424,65760,977,77387,22628,147610,28018,30561,98454,6969,119628,63648,18170,36854,26601,64018,22027,37279,51395,152934,21153,9430,58760,194742,5330,55115,34158,28917,174111,13171,122326,1526,43896,66094,25325,4234,148354,11450,275,18999,112191,44365,22723,68409,8733,57746,96565,75007,14196,108844,29475,88599,177563,100792,106156,86323,93726,14248,135341,194131,40126,47099,14779,8272,39597,95983,171398,65882,28052,10393,47213,40689,22120,72212,106829,34964,109146,753,648,21660,30047,17527,181025,5619,145357,4085,216883,9359,186951,24779,53931,24545,36197,223296,62628,168101,4243,107313,30321,26642,13049,51059,31027,107912,807,73550,26551,84369,122422,165872,49754,74213,234264,33151,52014,33100,87183,22365,52500,40013,23302,5652,72723,21404,26107,48434,587,94049,168493,96418,32871,70860,31709,25128,443,71597,166253,15670,70994,26341,133675,28280,75491,54756,47955,56028,26182,11952,113272,472197,64640,110753,17919,337,50642,22576,142,87371,53391,93210,126694,15285,19642,85667,14148,1506,42092,52962,33243,11970,20734,135843,57044,58880,13002,219134,22876,64754,232519,4257,43120,321573,24799,64526,124728,52579,81472,70831,276848,17403,74359,23021,182101,74597,23744,148267,12055,7976,5349,11772,67540,167347,65318,18720,127832,108238,22828,90233,9987,259080,118185,73209,79270,13775,90100,137742,90799,70569,15699,19961,9087,67475,57872,39731,8810,134897,131868,146849,19898,3334,2281,167061,91073,60356,467742,74712,188,53179,137679,92769,29241,9537,132595,80119,1041,88962,5976,40171,44911,102859,139059,104558,98987,47761,19272,71472,113864,175377,73338,10857,23402,23758,1591,139864,5644,4076,118760,16427,134198,18853,20291,100849,37423,22038,36677,19071,195521,57445,11069,31869,55718,66882,148490,44,41296,75242,49704,166810,9906,20943,122258,49112,105667,15969,10344,6408,187694,21399,72742,58970,14867,14376,81889,41856,23225,15042,56993,16074,131389,74276,72407,53875,383108,53597,37363,68993,44854,122548,430927,198279,38430,80409,12245,2981,628,2818,17760,37437,238229,7968,46892,2200,3730,34190,65983,37959,112291,87850,70827,6522,20750,73913,111621,41652,19587,2780,58668,25916,85259,18200,168962,95781,42445,102050,7776,57662,103313,47742,96358,41964,66174,100396,29069,204735,19679,27978,7479,40264,22534,61183,36081,107436,58223,14680,23002,101311,24716,124108,12908,5646,31750,40380,14215,232799,102772,14122,96775,61398,50917,12096,149880,67833,598749,124194,155871,49216,790,14677,65319,56917,7440,145744,95701,12206,49405,129269,76199,45732,9767,11058,9047,210885,11051,7392,26307,2130,8132,147526,20802,232698,115660,50060,59789,57344,107623,80343,112676,23291,9866,160971,34032,118291,15719,59730,164911,28975,2659,58046,78480,21854,66209,53863,109085,116045,29021,46481,107552,22130,18764,70254,31272,11300,52460,43933,84738,20721,53869,190840,79673,105300,7561,321817,66924,13940,33281,101046,183181,32176,71878,5678,62924,79535,56646,40303,19559,27703,93042,73368,42187,3670,37376,46440,7023,36816,109628,20680,5940,276440,275233,170848,112093,136996,14984,20226,111441,77693,112960,48577,39370,55707,50314,123404,26570,54281,61372,123391,4857,35928,246740,132507,106646,44241,7196,92258,9825,37688,51197,303141,5590,15476,132986,10955,85782,34486,26696,7991,28813,18858,39546,11703,11365,38185,5716,93555,11925,40121,60002,6985,10976,171384,3887,43394,13337,56346,6381,252336,39573,75042,53711,1028,31781,44295,95925,131713,7214,68125,43571,70954,213234,1628,8760,13391,65485,17320,56038,1710,25248,60803,57399,19839,3870,326,281556,50945,72400,21460,316244,75619,56246,98775,481,13513,55765,50427,7388,123519,32929,57908,27124,61316,101097,57467,30228,48792,10788,20402,37318,50526,155730,34456,158065,145305,17832,43733,64052,4506,35072,205355,177028,184004,187081,68616,35938,83703,10367,36892,93186,260137,51934,89970,4985,23445,26755,21558,7948,78741,23376,124405,85594,68596,57536,49351,12619,56593,132668,99924,109728,71844,71935,196018,65464,17617,14987,89701,143773,33997,8687,22701,33258,2914,4436,72108,85610,9671,49067,2327,82988,1361,1672,44033,35777,30269,24057,10605,82236,616,15793,13919,47249,112086,116698,9484,80207,90574,33304,68624,93127,56101,42210,160929,4827,38995,38095,4701,125119,5027,33680,9236,231236,14135,87837,23318,70261,78893,30151,81482,14332,1084,74256,27532,46644,79185,3148,62615,6981,55672,31668,36825,1849,14536,37446,14738,23779,43058,162749,72199,1168,21346,5592,85932,85302,9668,18351,57135,150360,2080,228015,77953,34670,119302,151751,31009,106725,84265,45214,59289,74178,113071,263206,111009,4021,44449,188119,192629,123592,392506,292847,114487,12831,205858,9852,20780,79648,75767,357014,97721,18166,21005,67950,33226,204009,16536,2987,11335,66717,144910,47950,17262,55060,15063,2934,51038,26775,178497,66008,3427,49433,128592,20036,157553,63861,3089,23015,51210,28696,35933,49942,71135,231518,99620,17248,21835,176536,20676,16944,38700,165831,233253,295625,36723,13023,52745,10907,19423,67972,125868,95473,82875,1183,108455,52685,33417,64095,21433,52438,33191,127809,44505,211823,7810,2752,95548,162031,7185,91196,47563,61721,33359,17897,23682,42806,178101,22874,49707,199897,75419,82456,8618,11171,79712,116847,18783,44190,46564,5346,59046,95032,7893,14916,3214,26800,24172,121453,34362,10250,17408,18888,4840,68696,22831,13162,36005,32512,14800,62357,41723,45046,27247,37486,5372,2564,34261,298500,66509,133920,89138,31305,117697,19097,108304,81386,84106,23802,46411,63304,946,51417,41777,41041,19501,115864,60743,294354,37955,94165,18116,1156,17937,20645,57114,90804,58042,48643,92288,9861,2557,88546,61333,101008,12853,5148,87856,4152,144503,73841,18718,9789,147565,10846,42085,12789,30223,8993,56352,67203,2448,28215,6052,23540,126319,75933,36689,80235,23231,23561,21383,38800,77548,102798,21234,31468,158608,46188,63960,191679,8051,67014,11185,170078,42186,28827,34777,41930,212079,12421,34750,24111,110344,73918,45171,70826,141949,40063,23979,24254,37309,26724,27179,24718,83648,54938,14591,17425,29525,102675,48975,48654,12316,8929,60640,41709,50168,63264,89812,50716,48632,38755,138583,160123,55579,71829,24230,233277,46322,39650,166388,34718,24108,98252,7031,106695,62498,18258,35062,217827,78731,34824,33354,19520,60852,2432,60224,8587,2836,62955,702,20227,42285,40560,95592,62486,11094,53035,143291,18842,46177,77994,1770,9657,107422,172915,32655,128716,25886,25164,156740,119928,165875,85817,11007,89110,33956,12652,65156,180266,8494,36889,19958,20955,96,1264,118288,135769,44754,86671,5632,19026,168220,289120,33569,93821,66144,70635,7687,5642,2714,55445,56636,71545,184182,93133,7332,37389,12643,52315,22729,11014,158742,17050,152889,50178,34601,41945,52136,9948,26914,63548,95721,115951,40759,8960,158258,38938,49232,48325,42234,81523,253019,66128,40978,20048,238048,38760,62928,122560,118532,43687,137472,163689,26680,9878,17448,51035,16211,60834,36749,29178,14241,59868,150086,2305,26477,42422,34342,165341,83279,33894,14257,29928,12743,13957,125571,89134,66712,10952,16507,147839,30146,7249,16565,45399,39874,114565,215780,31990,230881,171477,102,196546,44538,10880,84948,281705,86651,10617,31395,2342,453658,43569,60561,132901,21845,17727,58556,258242,22262,58728,4008,77997,11806,37431,30599,81375,109137,185787,114085,217292,97453,169085,30593,60212,11544,102056,65580,2384,91655,4855,95725,7295,157994,16228,20669,53276,141590,105246,17334,25440,76067,17967,39321,38911,11362,28559,63807,21627,26468,85816,40120,1025,15234,58319,69516,66512,124548,75845,78873,22137,46681,51242,85683,32909,76747,35555,43396,101465,1765,73094,1077,2962,39028,66777,57831,42048,15828,13962,36041,63657,52412,5242,58846,2141,5506,219012,134451,3936,182230,17558,17153,152237,22621,49377,170216,35257,68233,65374,6510,11126,212151,7184,2480,22517,3437,33073,30156,16557,3768,55067,86829,91e3,12350,148650,66017,79424,70885,49066,28250,21369,51213,34533,11510,3258,18176,18465,84413,6315,36411,163765,4346,356,107618,598,13727,285026,162695,8749,14583,7132,63521,184253,32378,25991,5604,30961,53675,4874,84693,5086,34811,26978,56564,7904,33519,51221,113942,69253,6664,125563,22055,220680,102008,742,51930,19494,176108,44424,35123,13025,75685,11759,74335,22250,181453,131147,16984,132115,154311,11991,76452,52609,85351,196,30969,9198,74919,2529,56838,71779,29187,116304,3504,62330,41190,86153,28393,254926,104228,105189,13264,84359,3574,12415,8534,57147,10175,188174,59504,60932,66318,16407,107921,17638,99103,49278,28403,39786,145865,8462,3558,43406,142271,29139,21989,36552,93955,72365,7176,13556,106185,37957,321774,17782,129017,51154,27938,24952,1935,39366,2791,33489,41582,56078,24558,9311,5449,218786,27808,190429,68013,36020,86003,29735,3404,87348,119357,115714,2324,86796,81973,40992,43376,93621,28784,16808,36367,2517,2909,191926,24978,55303,53308,205724,60068,3098,21375,64784,23949,26579,63121,12319,80145,39967,97861,6757,70143,67642,37082,34698,69140,122883,46151,62187,80934,429,19437,135071,137885,222647,13331,154065,327,61778,74257,40116,37493,14855,85079,237641,42342,102164,199965,71204,4662,29368,5042,113914,122214,8955,13149,102503,43173,5659,163787,69003,307084,63392,171080,21390,81918,86666,36622,24126,28887,5736,28054,207170,163428,79891,346467,95363,38980,111806,80828,9200,19288,294896,114468,87405,111715,141705,7015,72754,68463,48738,243147,33397,101210,37051,98801,82847,20397,4940,185559,18716,54718,83491,11725,40803,1128,12128,23060,5174,7745,67007,46701,1571,27807,180186,256996,18975,16837,7877,212758,250379,15440,87954,57755,24719,124057,83461,258,50864,8874,29038,71289,31627,15429,9005,4061,113851,107716,82819,13651,79656,117851,17539,111446,12938,39724,190787,4352,15402,21070,62708,8539,23777,73853,13552,38810,86117,16285,56400,1718,75342,142863,29033,378,110113,180321,32586,23606,26393,160984,207987,23783,8406,16904,24596,47274,11693,46539,60524,78595,48423,31718,20170,9009,146268,15183,191060,172765,1349,138436,37365,10970,40509,225817,20021,70394,152138,21541,66559,66544,89352,2725,17258,91345,7313,3815,115868,8660,40362,4071,103524,39388,118275,21950,6549,38226,32754,209574,29201,43495,18028,20296,40597,18370,47520,202450,24134,2219,8195,69545,38041,136934,46374,19041,159811,84865,58620,846,98749,13569,30714,97246,32186,4479,27355,92973,35214,151491,75963,37631,1561,27200,238083,23182,60756,12291,25766,39355,102333,87362,65741,59906,19538,201575,48772,102938,24438,292580,39964,66366,9004,61379,50548,37622,38732,28379,68180,76622,17488,69849,5963,7219,48143,43413,55358,540,58691,29506,19245,52193,48621,5518,13048,118625,44755,191081,42061,89197,2259,60665,66994,71210,51232,3585,142096,55024,7892,8345,58653,463307,65658,64319,137941,136323,53499,12746,43492,6978,95163,29925,60175,5128,7352,41463,184756,121146,20473,18426,4598,5309,54580,14277,121151,10691,56711,43880,63409,76682,11830,172218,264898,32632,66536,81062,31649,25788,92774,60222,11100,63159,9432,224657,25240,53613,152,138620,163829,2397,85345,12501,37507,64932,38575,43522,65789,80198,78796,35226,3851,108891,73311,3060,28391,93671,39663,46142,30982,66041,37281,68157,26553,71872,81142,211527,39747,118119,22695,2859,11066,20232,168911,7933,197005,17066,111071,44434,133994,120798,12766,227798,45756,132852,29917,36076,55352,65281,129800,41958,18944,84678,18580,168093,132621,39997,54092,27740,32354,3770,114118,103242,43918,15899,18574,145944,3190,123469,219903,24169,100571,62403,16776,92779,14535,17168,16475,14304,37231,1712,28218,242754,61688,28980,1318,51359,222657,99200,67989,31772,23932,35351,201251,49041,27306,19128,40135,3986,77333,19649,120683,151927,21081,7076,78375,77501,101599,8011,89585,96715,58179,5378,102138,106793,26051,217276,4197,16297,27014,46721,13322,22806,5278,29629,70632,9647,71519,58818,40603,128530,8903,36770,56900,31483,26935,43845,34265,34920,87658,6114,84767,64250,47318,50720,19264,162514,33357,13117,6705,46696,75032,71054,87004,42035,69138,11903,99854,102328,19611,34525,69312,6431,49842,101600,133178,108751,41829,89939,225664,48916,99556,9195,130387,5960,36857,116724,53518,94002,39077,53996,6945,22261,64291,8314,152785,57588,16522,9091,5048,87671,35441,39509,1945,12423,158923,178413,37549,14095,1475,73188,62878,4819,24012,68534,42606,4010,120809,57497,59564,101758,103718,32701,80116,12345,95834,46918,21468,53213,15665,31200,3867,5140,96013,250744,21016,10069,13968,35449,180829,27683,39704,59956,22893,3115,26293,32785,75934,62445,141162,62720,2018,83638,19949,114012,95006,3330,99829,130935,309272,9565,55874,121727,37017,23586,319858,40970,27602,8625,112329,61060,100088,118525,25922,16232,1907,60671,51583,44553,80993,5262,94679,8676,940,20736,11823,3020,16476,12340,152600,97416,3703,25744,66826,16245,16876,46446,84798,74227,176020,45192,61955,75496,23946,23626,40372,26036,6149,11822,30582,16541,41914,82385,232823,40921,80773,14930,3631,7517,39619,4348,36180,126106,138939,62611,1477,113512,47321,25052,14546,118881,29060,23589,128322,36795,18401,137921,104699,267929,36194,172791,18113,4766,188215,30083,332586,94089,5805,77909,22194,68234,154976,43220,40660,70001,184893,138095,11128,103010,22663,5108,212615,8485,5565,49222,54614,26530,42639,16319,55062,152662,105595,21114,22216,10294,68158,10436,86950,7206,62115,3977,3657,59874,456,118617,18156,106663,112229,80992,17442,8217,55551,5133,34344,251927,51153,39364,201321,7816,66803,23057,156724,145664,14276,95705,979,2796,6875,13429,212525,50602,26276,28284,3424,19465,52397,46963,31420,51399,206476,92317,48851,637,100820,83349,10317,60227,21972,6908,282439,32857,224767,95629,83882,42106,87338,69757,29840,68709,37665,45244,114577,49188,175943,54009,186746,106158,70168,3358,234002,50555,9221,129338,9562,20118,32923,78479,118280,65752,4977,10474,102174,60947,129006,10570,83451,8598,8078,159367,123785,80438,16742,5905,5281,181513,42402,6977,163136,93179,42191,14968,50421,112401,105440,33456,57347,121611,4221,94954,36517,24046,27796,6255,33394,72990,135408,116627,1233,57874,25654,95419,68156,401399,313338,55208,45573,93124,119251,47200,38196,11909,130667,45391,73904,64964,167846,4137,115606,52036,62214,7969,160925,7187,1132,134835,40309,73195,64494,80472,444841,61111,26500,45323,40743,53625,52797,22659,15631,29739,36706,28841,39147,102836,26794,10536,14845,87305,45874,12241,127587,83833,57183,79722,30844,41304,84655,20825,92500,3722,25655,27811,10157,81634,31362,34088,92487,70123,22190,185100,72658,139035,192523,88241,2078,230490,44528,85638,100198,22088,29982,291233,241062,13865,4445,137791,37835,107218,31726,19718,38234,72528,23046,19177,66695,5109,17251,28077,5617,21554,47839,72425,133825,1486,73065,181275,141508,21768,62971,63082,2512,34200,9904,120309,6392,91243,68416,268253,41199,116757,138551,185526,41246,28986,4093,19057,17295,4148,245766,122360,35356,112075,20301,75441,10998,7977,19769,62922,937,63547,100196,26427,157820,20983,236696,22935,8140,90315,156004,47204,140973,7726,45097,52725,22636,23436,257282,105247,522,88389,216031,202204,46812,211666,19693,68828,81691,45925,11256,30292,372,5236,167826,88328,232776,151611,5360,82104,18841,80393,25465,18285,20320,72377,31730,33160,45803,38715,27705,37379,24163,18360,103586,4015,32305,269494,91252,20080,36567,54650,7797,57073,12650,31164,42209,6375,261663,105528,81661,106002,2800,5375,17247,43151,4442,15727,194619,100855,144898,62320,78465,39929,16454,1967,28311,61363,17219,9395,8745,121445,76939,80385,162380,22009,54191,44248,16299,122830,48151,74429,78291,64755,14238,44966,2511,17712,67954,93583,829,105899,49935,84750,11591,33185,85447,42717,27409,208542,28965,62052,52525,5597,25694,65594,16343,63224,276188,12475,9331,127507,38522,57287,24128,133161,79723,105548,133695,48917,27558,43278,46520,13778,141954,110785,83366,17715,46317,105763,66298,147013,41086,94180,16478,220447,44611,730,19722,78975,117889,125643,26254,16574,18480,65006,15806,38549,246418,46052,36056,8440,34984,30170,3163,59800,4458,115442,4283,41970,33507,104078,1653,22,121158,276486,3655,6338,24048,133421,23641,2161,24422,36006,8086,10675,181474,12307,29514,59143,14729,52509,87128,122470,19446,80852,33314,24573,119864,14237,9652,57779,6612,51851,15284,98871,90581,124466,156831,21190,22015,71380,161906,87247,69201,18392,17908,108470,72962,40719,14338,17911,95260,43339,20610,78916,20710,72451,11315,31448,17263,58853,178878,48111,116002,45497,80506,82605,85880,36300,121755,25215,36118,301929,88728,405223,276136,553,34704,212438,49970,78329,922,20711,25036,257130,38295,145369,18128,15385,30829,55656,48345,8012,3561,28004,122041,192900,58338,112508,41085,29976,87040,47117,23905,4336,92061,138880,97407,42083,172121,6256,25192,172671,5,93568,1420,12677,31605,56743,40620,6015,78415,231077,31298,80026,13902,19048,24924,170586,32955,176119,87859,36731,6773,27711,24658,26475,115216,133207,93250,95820,88522,8317,5714,124047,55219,86860,19677,23961,22928,162209,8904,225992,359835,56084,96201,29392,96558,86071,93643,55114,13347,8183,95129,82012,2017,123336,34219,115554,157159,47747,101684,41008,18735,193781,104151,226906,7552,179874,124113,31159,21162,44010,14771,51268,166128,31382,73124,77438,92830,205709,12113,1292,38937,13114,1334,2118,15597,69581,14449,21934,76618,48728,67038,14967,51495,24243,87736,147249,26720,11119,46063,43749,5843,44147,152629,133428,65703,14269,45604,57982,28672,55616,45957,8438,95433,37698,220862,132034,39456,61870,4161,26501,73560,56418,9845,4654,20916,10456,88920,119358,9015,65931,96507,48029,38534,21676,109081,43078,34943,25089,6131,28766,23665,5477,10255,16695,67,45778,42443,42770,29534,23733,100513,62617,42630,48746,14191,43753,50295,26007,8792,57243,43119,54725,164253,58250,112304,131796,25165,4651,3188,24831,47748,3705,19540,13211,102095,5593,18699,23666,32005,117571,33541,60584,74573,86311,99443,25172,27222,168938,7143,11853,53560,18834,19960,86522,28217,53266,117700,72989,34323,18721,66450,34346,74056,47217,202002,46269,9429,68582,75458,37823,82843,96652,32549,145144,27958,19820,158086,31955,201406,135379,31207,192545,12950,51704,9094,248263,76147,64028,110009,79407,89345,99284,223492,47966,26848,15359,201137,2861,110507,71231,72297,31851,118777,71039,151051,240855,16333,50766,14727,7939,4149,80908,418780,88378,59276,1327,7284,38576,79814,65820,42199,84860,49574,62596,12396,70598,40117,8648,7994,16836,7630,14047,359699,106878,525,29037,28064,13380,11675,50669,74216,103539,180314,27449,56299,172344,19274,7301,246099,32043,19422,36506,129317,6806,30140,4614,46639,66926,932,86600,6322,27847,233103,10541,39025,34887,3517,12972,26220,2031,66561,115015,48658,47596,12714,33845,3893,16165,35237,89983,14769,11962,147224,47018,29977,27979,5552,82338,86023,131368,1218,24853,237840,132193,15455,40873,3668,65351,53388,15229,59889,272245,47934,11858,34347,18038,90853,86981,300602,19343,114181,29362,84921,6095,106059,79472,38015,1206,48741,6208,8e4,21916,17423,6002,108083,24479,34931,56661,9511,26995,100694,163853,35997,81254,58321,18919,171890,86877,91341,74503,70477,53412,7027,59281,39892,131302,5864,15947,61301,67466,162369,47956,27874,35624,282324,21270,111847,102548,41482,30955,116737,28264,8592,55458,22301,75090,29821,30697,51709,3041,19208,8038,24634,30467,87509,126428,19389,18814,152686,20701,83474,45832,80891,105808,11378,153223,120770,98186,150633,49838,9141,12755,30962,5260,74490,21256,31678,65062,33326,289838,187831,20595,89768,2805,58535,10844,70085,12090,2451,138068,98544,24461,4511,6754,41684,28203,3383,65355,82833,30161,83924,234361,128424,28921,222594,33975,125491,34069,11508,67464,144226,41850,98703,34371,7901,21254,38398,65651,23549,53883,213340,123269,12028,71764,177701,28758,2623,68395,11549,15232,68603,9660,63116,36079,57093,31198,20475,48467,89984,35619,186847,107469,31389,43631,73867,41949,68841,114250,1605,30564,63403,17588,27680,99533,12641,70325,50428,73426,78379,11855,91651,72081,91720,60198,15743,12065,83398,140046,6761,46598,45900,5068,886,62448,148968,37347,19405,9680,15819,43496,63370,75667,163700,37639,3633,22774,34341,183131,134335,37200,23915,7054,14194,12970,26438,13350,285521,25594,8219,104410,91039,168804,138480,149734,15907,33818,61132,60082,4622,110187,56736,13551,73571,3945,73463,65498,17758,263266,17593,2710,27585,54469,38200,45367,63754,28881,3473,12791,98287,31895,65787,4463,94536,24951,36332,59901,28803,52130,86403,7668,181822,74831,18977,9850,177206,145485,109798,7292,31421,26280,77211,58511,12507,127004,11113,147,8729,56208,43066,79926,129937,31345,83947,39915,46146,98763,42566,1337,13192,18323,105163,80570,117753,16555,72883,11077,159438,40764,70933,83329,26066,12276,72059,21655,173836,126713,69454,153482,91585,70644,102558,110483,6764,127864,190133,3961,101798,20945,71138,82402,90884,69669,44753,923,16939,59700,164258,25969,27082,31399,43846,6306,246093,51342,6153,151581,202801,182731,56475,162188,89426,141356,14355,121815,27536,28023,65257,77523,106668,127314,24947,12790,38796,169698,23555,10725,44573,183083,42088,62716,43265,105958,32050,44067,50118,1668,3874,6243,318411,16599,1691,94999,52378,28671,216728,123258,2059,34969,69225,5913,136280,171443,141515,91662,22175,135282,80020,92270,1663,4808,4482,3495,34691,5226,109830,108512,17342,107488,11606,123190,100247,29666,146527,113014,15794,30894,13224,39585,243192,22351,9903,7836,47699,11078,25468,122291,48821,26780,122679,75521,81450,630,4895,92900,55074,74293,17441,3563,111657,103102,51613,12318,52370,36191,68245,34269,40445,41354,122901,168604,182500,62012,42557,11259,24428,115113,86345,12362,3909,78430,86852,134602,20459,47853,93879,22577,7659,3688,38555,13349,17381,56715,91639,12493,10895,92438,3142,37057,28928,2004,36427,32268,34222,209974,10432,67436,41989,173518,107930,27079,62729,30908,55558,5828,45031,14902,53546,8204,144263,60255,14520,88212,86582,109589,69356,8064,47449,8505,66558,16886,4844,52817,111260,215129,12941,91118,650,20770,6273,73089,40618,62790,2873,35002,14023,97208,19386,102646,36993,143736,135457,35385,113601,17893,32627,84439,100619,56016,6581,57264,172160,45452,111710,203627,70131,24100,322787,1996,35665,70078,22358,90922,83658,4097,63200,58499,14542,99153,52159,6615,12414,63415,31986,16823,1579,65405,137809,8841,16898,48082,259,33014,42375,12260,179850,73667,91389,98882,29532,17311,326251,41092,5928,20742,44964,48019,43505,9317,49265,6643,192712,48424,163487,19861,20113,70848,31928,105333,23685,78563,14638,54755,7158,24142,44018,20774,125255,20331,24280,10163,1285,2336,39851,4299,117269,46714,63816,87779,159624,11731,9971,990,137317,108831,50994,74554,162680,23640,131597,146962,170620,34829,91205,21184,1913,63616,18427,93136,156592,17519,67565,115882,138220,78622,88535,18115,2711,33554,109492,54298,971,24914,25863,36363,45715,27099,194995,14299,178181,111488,72395,322385,157719,130787,11897,81843,83999,11369,49280,118604,40922,61332,110343,53407,75639,40582,300440,54722,25637,13694,48248,48278,194521,56203,52779,48783,72627,10953,376,16733,280238,26351,230789,15132,25168,137270,3588,63704,73376,94031,74284,19443,159557,9697,39901,13351,119050,15406,146455,3460,29556,75195,37673,102524,92329,47289,98413,15311,100684,56345,7116,95480,11590,7200,167,23610,58426,17730,136656,27944,53151,2701,8824,103124,3017,90744,113588,53216,79736,65940,26931,498,29568,80540,143543,21292,1740,59268,16561,180816,42323,50174,40890,52866,10703,57169,4700,17191,4424,93511,49698,166650,26972,48631,165169,82879,69326,202970,4007,2376,231325,139592,22119,62851,37504,68816,58345,67398,186643,43331,277416,53749,15746,23102,17432,4793,151138,48822,54265,48203,198688,14305,54287,2291,18018,113378,123260,7180,97549,87027,120085,2920,76080,8190,102005,5641,64580,14955,59802,54028,58884,19367,81779,412567,85957,97053,103637,78871,29364,27637,141728,4767,30686,112738,130146,42745,12730,105040,14844,232,210944,36581,152317,135543,29744,3129,55647,58149,46319,27265,17499,28005,59948,7170,34138,5702,293047,110892,408,91760,218674,18469,46095,81403,14389,4610,35672,73060,11006,74848,104820,118143,190357,20043,105358,141735,5115,27093,45924,123073,52599,29433,9616,238350,78610,24851,58858,26769,31969,24613,18294,4982,32735,39639,143563,112073,202205,12567,4873,88601,44897,81503,101648,81362,34662,85277,17574,48173,21435,221188,40215,39576,80786,26544,64668,81841,10731,37733,247986,149188,127703,495,18382,54388,72446,43071,30974,198723,89608,41360,190,33045,8386,31658,19992,237838,119015,137622,50890,100913,6460,116233,267230,26621,104129,65114,14190,41542,14888,85962,23342,23041,26453,43725,71809,45186,4770,46452,53894,56616,221286,18973,9038,109299,55365,19366,26863,18808,60909,69353,41738,83463,12100,68561,72860,3980,13796,49340,12332,31311,27418,4255,53430,18976,45523,510,14224,30477,26581,4530,3651,101663,139840,22709,150861,31996,63923,120623,262522,3076,10528,2929,14672,130238,18087,9816,121894,100308,25085,55111,14565,18952,53293,2042,369988,23674,61789,133529,28783,108293,35477,47119,36448,71049,40015,33055,78598,198442,1833,159937,40654,77444,189245,113153,8621,18599,38553,35223,166072,2375,11659,21786,89523,6032,12116,63046,159398,18454,3678,32521,47626,11411,103527,38896,42946,15696,26370,10185,8413,37080,165583,4331,63555,14907,72220,50056,6623,62236,36565,49783,10049,17503,100581,55951,146244,24724,9626,17969,25524,109300,173965,99994,101056,46459,43647,53737,277968,8347,123521,74858,33829,44762,77574,877,81377,222525,123532,30602,43881,53145,2973,16284,81940,61281,127044,63620,9875,14756,114829,19032,9202,52759,119141,23928,120551,19607,3599,33401,76821,73233,117430,39968,36539,7071,5446,121735,194059,15206,45283,6706,15603,65615,1207,165723,92275,34773,104447,8396,32353,205240,164323,13600,60555,79205,25532,22907,33410,57480,107111,69630,32137,47832,70913,33161,20321,2371,117348,10714,86246,1625,11763,17900,268,78457,99175,97940,101092,86660,32221,14041,128504,125080,53744,124263,31017,13897,403,31859,21964,5633,111630,5547,77329,17961,18241,84995,25984,12983,67491,62168,47262,5241,297,51191,7351,8967,147212,82060,16821,782,11033,82431,62957,5026,43459,77963,203477,53528,6247,191852,87774,74164,215654,13467,1522,219964,28589,244104,16242,117821,67725,72570,156792,17186,15979,26990,44128,193014,35276,57125,16212,166451,68017,6905,77608,16364,53777,75921,76426,37975,26203,269296,64099,84122,12077,38533,830,4407,20139,963,43028,38902,42911,37503,83343,85045,16979,1165,60835,137387,58380,86990,110066,134540,56331,193845,81238,17922,163093,38744,110641,12502,56404,34862,26865,125964,12965,111648,25547,7771,27196,136980,9555,29551,107158,57885,18831,37705,35505,101742,13970,102109,62548,124657,23328,11124,89592,146376,248050,6241,22033,18337,80685,29898,11908,216623,67721,106162,146610,21377,15085,91552,42041,62560,122532,125336,102365,121537,142559,29693,223919,11515,110495,18776,22494,5895,185059,103592,229351,51220,100102,37027,257855,29359,54123,36066,106493,12244,79258,32002,432,56205,94836,90182,6726,14762,29391,48938,26864,38083,60364,3310,60192,14766,205567,57504,110760,22649,24666,46333,21517,3430,13135,28873,27052,158809,11597,20529,6695,23138,22960,37137,45574,6545,305877,43423,26153,24769,59844,14501,10430,134352,56169,13213,103432,49523,35181,13435,12408,129475,64620,230854,77390,51990,15653,83248,33466,44571,117828,51481,2187,10559,68019,18021,54895,48247,18354,33737,4554,108595,37288,39767,116707,9175,3726,108877,21616,83684,49862,1938,8543,276466,20134,108498,48770,102254,31914,131520,185291,100559,51890,209,19526,76471,50544,71814,99351,8172,198526,28816,20419,9109,98389,136777,76479,75596,30635,165417,48216,120220,25955,211071,39314,24308,32164,2559,146280,43403,9233,17947,90585,1786,86920,125662,2457,64741,32152,32918,122882,78538,44001,31723,56426,23375,103172,88177,145697,52506,49319,68016,31664,41488,18486,110400,7030,28241,986,109199,19900,42147,56864,65287,49183,7858,24e3,30453,840,16673,25907,68916,89927,6309,158335,36407,199737,130464,13137,59603,201778,195292,21015,42466,179062,172561,89492,11075,180407,31868,72493,20998,60217,9865,19530,39274,130266,54539,21623,12535,13505,40641,73375,4087,85633,2153,3117,70680,55788,92096,47509,98493,37490,271936,151475,3032,16171,96642,34106,78425,125761,19591,3366,19316,54508,24183,50786,194248,91528,33253,34622,108355,41741,705,3814,3883,108929,13203,67831,10142,59754,68208,29128,84820,56880,38794,24972,48571,40821,40476,18137,164254,24064,236309,79181,11282,395,39169,2013,51587,28551,9645,701,109513,115899,113566,12762,62045,58322,103726,41343,40866,244102,143816,2490,70346,40973,52618,15412,30720,104315,38917,42027,93676,17513,107418,20706,123890,13399,97727,24044,87962,65606,44250,98044,65276,74790,101473,19350,91570,1326,87790,172042,7577,100813,86896,85891,41512,108130,27794,14875,71431,12835,156250,58135,3759,22476,42176,115873,34686,56523,73643,108505,51491,20838,12721,32863,45700,29496,13700,34294,55360,29206,155942,123812,7706,163234,203,132720,49358,144431,8130,175788,35818,3270,76832,25710,54095,97274,28779,94621,74396,19092,128242,58067,20885,14670,93255,15107,63291,23654,126900,129421,59294,262659,9798,3251,67344,28600,44629,50672,29072,26999,31526,23183,49175,165843,175455,17282,175411,32022,45989,30298,90690,78118,83156,23749,35636,31317,7069,80381,94561,133756,14960,97404,6138,41065,78041,32843,16601,34123,9559,146529,123377,96395,54441,42012,84257,123541,10745,22139,106459,11720,150883,172651,154996,110538,4728,53447,25704,2009,71152,119354,21166,66604,1429,216162,8637,122250,63520,27180,29172,36124,276428,107787,77184,4680,14952,104903,24418,14793,51561,52931,8371,26342,48526,7118,92066,67280,40653,8847,34597,105438,14198,50163,61188,146286,50315,41205,170829,161496,585,197359,95056,1687,365794,91349,48507,5804,49263,5146,104902,96365,117343,132222,46084,96919,16875,8073,262381,79982,52663,13928,16056,153908,15145,109256,132308,18763,24904,167644,13618,40750,18686,147124,114709,150038,52849,2938,12568,48617,8778,5459,44202,44591,74914,17183,248689,13878,7822,80060,23116,194037,18487,2067,7798,43077,33678,244028,31320,74273,2794,19466,8218,36280,183997,48124,19416,29656,19280,98734,7715,18311,30701,133602,150307,126956,7378,2933,79903,13178,12593,86571,26604,92446,13574,44205,65699,427599,21118,8245,14407,27877,47936,33542,7916,26460,117762,21596,37818,2249,127359,209394,60044,47677,308089,36791,154971,31417,6998,150042,174360,12255,43009,29335,48739,3912,101398,53340,2580,146939,151295,45360,125275,15273,45383,27456,48761,23314,8750,60801,85823,104759,27894,123685,66968,39480,26917,55290,83305,2696,98390,57569,145853,340733,4919,20024,52268,30884,7413,203685,70989,112855,4129,50536,349518,68205,332641,159581,135361,236026,37563,176404,64899,6578,122033,63871,1850,85234,82089,66124,74145,121098,107351,12687,36881,117334,13136,14698,85933,93866,18047,32620,310,15094,46e3,88451,23632,36645,27940,87618,80520,58892,20976,27702,140090,96075,67841,103292,238964,87778,107338,17019,83427,67522,7302,8261,47570,116787,8730,80484,61772,174422,56005,131193,52875,14588,28471,59817,9586,15720,158155,51307,109734,15196,11025,59331,3884,52626,102602,84797,25158,27314,4437,20488,76214,189248,35023,114952,157376,2827,62439,102878,129749,36405,10329,109339,108633,36662,1254,13267,5470,87105,58004,15397,10434,159667,21864,52022,179464,3013,32147,31496,116832,18494,105502,129227,107267,50033,13481,9954,24267,22141,16257,116154,36185,950,115685,11305,176708,2048,178671,112573,287867,162328,497663,95170,50979,193861,50987,30368,136257,31830,46549,15119,169876,23788,17462,249887,57377,1949,35448,14791,43769,210091,3783,34612,282103,88380,245190,5457,20491,98908,11402,86899,117916,16028,162584,60644,320177,156096,31065,55876,22e3,77655,9992,23397,13757,317623,63978,215255,2443,17648,93231,27388,104529,93807,55505,140477,12046,112040,70887,40152,94365,112353,25063,114679,266061,71248,119555,15589,2244,617,14129,211431,70110,100652,7777,4383,85911,89221,21010,120615,58357,86405,37554,41647,18,15143,69662,60491,14714,186134,148344,42347,5410,168175,44535,42449,343894,129417,99682,20659,27272,140483,63455,222159,17536,13722,42637,62324,11976,114691,148109,2283,32057,182393,4295,147364,33705,2075,44303,30274,28331,63740,69740,29148,10346,44862,33716,73937,153333,12930,38784,247159,2515,41053,20256,83368,256189,54639,115240,5096,24661,175419,153552,26516,141,138176,63885,34115,47222,55709,2765,28479,38875,236608,12229,22921,77291,54426,45388,2860,57787,114579,295139,105782,17826,71066,19119,54364,69385,16568,12323,28057,33346,34919,124763,155533,101386,31644,8627,49001,303600,29868,63213,9103,77280,71333,9696,138789,37059,24823,5057,21352,32368,114208,56803,19424,10445,58514,8661,209508,26187,171838,10460,63454,14016,122504,41328,21329,46618,32493,38225,7855,31763,7945,29876,8734,6438,24205,97490,139977,130740,47323,33195,85390,57194,13813,60600,21313,96251,7699,27584,170521,139271,1363,4402,336738,129223,84983,69150,13147,3590,163929,207225,155260,55916,20288,4503,8398,98490,11773,27512,37113,84976,86558,28365,11756,116005,182148,13733,115313,47644,67208,85069,9347,14995,226141,14704,101835,41159,35314,13113,63526,214039,29978,50446,83339,17440,129441,72522,118641,97816,24907,73844,15717,118884,167255,96509,162793,30847,36849,51297,78974,77793,10427,1873,2972,9999,35074,28190,64297,146836,46298,60038,163007,108919,61219,2403,75022,127339,4233,110389,69022,9833,128097,88016,79390,222936,22570,94657,28462,56956,38803,81536,30474,152794,19566,16481,147408,74574,81895,20731,1918,1366,76367,187321,54494,24366,21690,61696,33283,107477,77499,31112,414383,74362,18463,218441,120929,59848,258629,201924,69269,454,19989,13054,59894,3623,58908,20681,35723,78523,102680,38988,184112,108087,50944,132704,52966,21699,18860,96349,201411,82697,85395,95658,5093,6427,177894,44191,32755,26961,155739,6249,31310,81030,26574,84311,120155,86730,113535,7424,48888,13516,45747,98098,20077,183995,81945,43210,26704,40420,75831,45648,11180,6855,57927,65528,124096,34851,2598,156633,107572,127352,38169,123845,60142,62722,105584,232364,23211,68120,1601,22169,89299,747,258039,80572,7258,152249,11862,101204,8834,121434,33761,19175,133142,46343,40178,48723,3589,41977,30210,38868,62257,10087,82658,87827,90646,16415,47552,351723,28298,72225,91146,272760,1701,11295,1652,109651,300747,51863,198800,29446,11794,32345,37538,22356,33102,37590,113544,37970,11478,179743,25454,103417,59905,221970,105196,145604,7817,164809,102360,16974,75840,255333,56902,6659,1954,645,59400,67769,7689,18675,5215,13793,20536,27852,3387,29523,259718,16860,94625,43143,29245,15848,233581,22685,63631,78557,22836,133302,84513,1348,51826,47129,98836,58284,1830,1749,94642,10933,6145,12506,10975,13879,103781,144434,10268,28409,32346,52968,121567,107374,77268,23686,35097,10501,155275,15303,47136,21102,168741,55332,90385,15996,84817,681,137803,25054,142275,6163,38175,8056,124296,240642,65621,4934,178205,16101,62803,60964,18230,100622,76465,44689,14545,9543,47514,16852,93380,28048,12047,107106,37575,101485,77047,57326,34819,96137,76916,6469,46264,115983,75768,87668,69942,13027,165,8373,114231,26434,52844,42799,182044,23580,146254,38081,43236,33883,146220,382894,14606,46035,36481,166621,35417,95382,2957,59384,60428,36358,66343,75378,22267,22950,83528,17577,56474,25285,4619,179691,75355,95836,53295,34588,171410,4487,14679,84208,44015,18562,109133,54101,11531,86052,174479,303157,28095,9953,35642,14564,39802,16145,77606,117406,53038,121117,53624,22062,1212,7632,127157,237292,189087,10478,127345,102515,181997,86752,87623,10966,121602,68783,68681,83042,114380,138349,191305,67176,50085,39016,1427,42384,1412,67118,122616,72389,25260,2237,13576,137346,19938,20304,2191,68759,5373,61364,238507,75814,23931,69565,38993,131741,38364,12528,87762,5679,129853,5310,186831,32653,90338,260176,389531,108118,26843,43985,50175,30563,25106,56965,18130,140428,4542,165503,117991,24219,229605,1819,129663,1240,3797,76093,18398,71339,51919,93043,27175,47060,216257,6483,35051,1217,16512,80798,129064,13225,69339,8548,237079,72298,2575,34280,51379,117910,55671,53345,247552,29486,39328,140821,34681,57045,60177,5004,90269,78522,2479,322607,48474,61296,13057,31558,4678,59271,6699,27044,31988,35944,12503,83480,4389,136508,3781,114121,70279,4488,155829,42214,2898,68191,75695,305850,45041,74344,106509,30087,17429,93292,12477,290,23080,114802,35714,18751,26554,105424,17775,2144,2412,100610,65192,113975,52975,180272,135050,129815,76238,106483,21440,63186,4260,46189,9711,28249,4169,23429,23390,8324,141585,63809,67668,38457,38063,39226,59972,1189,203916,62368,14403,16949,61767,85801,1739,40147,35049,76757,33124,62102,15780,103593,103009,53484,22952,67973,114645,6566,5245,50462,7601,8288,3513,194571,80276,1908,54592,5124,58571,2513,6800,273997,193904,1119,17991,117245,2508,129156,82366,26278,71465,63341,56943,39662,106116,94966,156875,9736,2204,122308,94418,27134,1280,24539,49022,45314,3764,50904,46424,30699,28087,293839,9400,33646,40165,822,147499,50263,116179,29085,11863,31314,5578,17797,5104,12454,1604,15342,219206,10232,67800,94261,25872,13565,90339,78971,75377,26649,41184,47695,11514,35369,20767,14227,41953,309396,148270,147938,33074,14453,27499,109019,39018,25738,240196,158931,52820,8612,95853,21524,137010,84901,70869,70021,116794,48404,38771,6732,1070,70990,187297,49140,5238,576,3564,253975,16027,16483,2811,37775,19034,25259,4053,2e3,70083,95774,19713,33431,92703,91314,42381,288770,48194,95985,3991,77418,13406,241328,245086,56533,35275,62725,9246,51924,70181,95331,16163,31410,79016,39312,120878,119371,275987,80124,27712,9186,220,23598,146167,85209,68238,282190,57048,31273,30555,80913,17594,75779,59160,135002,101219,189377,29225,96735,60126,62522,104e3,27620,86814,17240,147533,11001,5425,43682,410,49460,87270,69480,46315,59448,1816,76201,9431,11788,87960,29063,65539,47347,11678,33846,7008,196704,9895,6753,8633,120892,59970,572824,115934,6646,202559,892,48351,37611,251282,57823,67263,57750,26527,34485,90747,7685,88370,6144,64182,1709,41969,21458,62327,181657,49247,225330,122600,114574,107124,85361,111833,63243,71420,15655,191178,72430,18063,51425,54002,12364,53225,86557,18193,97580,41232,138398,67821,128724,8944,233212,101353,52099,42127,14006,120107,32789,32132,3498,18123,33758,56058,5779,128760,59888,98869,18445,84702,51911,13234,218379,20093,39031,8074,70195,20708,23462,24355,131384,60189,26390,10403,41060,7140,10781,49410,42261,87202,82566,41663,43105,60276,2768,5733,74176,28329,2297,145430,131632,83615,122915,105441,655,224102,5284,136426,67763,16294,188511,32538,61049,27893,3394,13951,159099,28542,17930,145360,9492,190122,32285,78855,26440,13570,58648,73908,4239,124561,2444,74172,53131,11468,10794,73566,11623,35343,64710,30481,4163,10328,38309,29901,10538,154377,76132,92405,24839,11679,3465,13449,11637,7824,2337,57754,1260,14458,41118,19878,38661,13416,159180,37074,163164,54137,28627,52134,184900,8520,40385,29546,30502,22386,66527,107458,6850,24022,47983,30603,35083,8934,304066,39500,9,28261,33026,77251,9374,44833,116312,34990,29236,63563,125639,135405,165398,159055,55690,88141,69643,236964,31983,25572,20436,36746,60896,31850,16179,11828,5888,3043,66368,9750,31167,7915,53111,36430,1333,64344,93659,20061,60596,180191,51630,6792,30244,43509,101058,22409,420,44210,109783,43223,27030,72477,72831,32679,29235,7675,47556,12258,39907,149412,84926,118247,24692,71717,105038,86009,45941,41189,89453,29856,52543,30627,226798,67303,59230,67415,34408,1367,99685,16867,128419,52147,4111,125381,117881,16173,44093,102224,31575,23234,24870,83790,127407,239098,3200,994,1255,100903,242275,117266,55116,38205,16140,29662,11307,40414,208793,123355,56470,4862,75600,30119,58218,70828,24075,26974,7802,192353,4851,5475,78720,66596,3409,28573,64396,30381,30690,59859,88256,5406,99945,103064,34463,37727,24238,86643,60088,4057,23741,5967,162904,38240,28356,93858,25510,122879,6897,3278,7057,11971,4400,35461,211413,21395,59615,39471,87233,55795,128426,3051,22470,41950,14705,3974,180108,80476,78442,204996,91987,15634,67610,139015,142373,35611,51134,10387,4353,153456,57749,181039,14183,68447,151532,21107,36452,20551,3186,46247,46383,129666,88736,140662,146243,2066,8360,7978,64818,106963,17896,47801,10723,114821,223295,74192,3293,3393,16987,74064,11277,91622,4270,29828,27951,387869,103235,1374,61988,120083,477,145892,128378,11779,211263,61354,18221,17869,46530,83061,108538,157981,90608,67199,95080,49064,195814,12302,66307,10348,231346,160732,112859,63633,146558,21271,31037,198802,47622,12862,95710,3910,77850,73961,85585,34752,61e3,4082,24595,103679,71107,8208,79568,150019,16615,24961,139857,32664,197366,4559,54735,32696,4126,162019,75698,13916,70108,159638,19834,9349,24675,175560,49643,18206,52459,27992,10809,88865,401975,133172,29e3,34558,30915,3658,25834,42430,36562,125265,18182,10155,40149,97082,208980,19575,60853,90529,66545,9600,789,46420,2317,88593,55595,98980,115302,5742,169155,1073,177901,3472,11189,63711,78643,65472,50459,127979,93,42202,67053,21720,157650,11145,141378,42033,22824,85705,79114,35584,15974,1510,54172,28562,12451,104226,19190,97151,73024,20948,5151,81741,21499,29006,84183,198074,54003,45120,170125,26240,35177,28389,64863,79974,60778,176915,232183,45342,2038,80253,41564,40703,32689,5430,100689,5366,23007,134279,14266,26712,73993,24934,64242,52113,102887,61801,46415,201049,54251,62133,122757,164883,30815,139966,2319,30842,766,13362,10287,134518,86111,81665,82440,28333,43019,18963,8804,161944,23439,102144,101145,80029,39052,248708,30350,117340,11878,128467,974,138625,63961,5237,74778,61834,67040,43814,13690,65947,33809,232476,115258,181745,28824,94013,9510,10246,93722,81976,7217,114383,3493,16014,69045,72692,12145,80981,9507,6692,1620,60820,330444,35474,33962,4797,7053,295463,46445,27026,12491,77988,49524,35675,90947,29114,166705,101385,133782,32704,6186,84595,176031,185623,45966,151302,63069,1699,107491,947,15458,74452,196212,6046,10498,12163,10239,35191,243951,9277,9090,29539,54460,22820,26514,112549,60372,51753,48756,21812,70861,260326,41,44222,10441,16961,48148,138771,216194,5914,52153,53400,212036,56519,26245,10117,45888,15294,138019,90913,26368,43842,42111,23348,6082,194845,161089,156206,51546,11647,30759,302912,262094,8635,78876,26535,35283,54183,31183,85484,147873,12989,5197,6356,72894,65347,20150,27370,73787,1493,45918,12366,190217,20724,13858,10981,67449,81213,7553,14115,72242,271517,11842,48310,88743,143726,22177,3290,243231,58452,62937,12592,1654,40066,33477,13751,9921,128442,15868,7106,75236,83773,10775,36938,10482,170465,17368,17469,161508,32752,98340,800,19824,264456,3901,87319,2867,26782,9630,113102,185815,24197,44584,86366,40224,3636,140916,31731,267731,9567,53678,72984,29389,27963,17106,50282,284911,60170,8322,12608,23374,89652,5268,39044,229766,8869,151350,31436,177342,12269,183212,120418,116270,2843,78888,69192,7865,184099,1086,129897,18383,70508,20242,18508,229924,124569,35749,50589,55626,9884,83115,40971,30671,18135,14452,38861,17844,201826,5549,26413,17189,13561,38539,10679,143331,3314,36785,171194,49685,187713,67506,4618,104039,17060,195080,50648,33159,19238,67559,134840,28599,157523,17130,38064,117398,94355,31918,13575,34538,40326,13997,3494,348283,62481,26862,3603,104426,244363,153709,112487,304612,199674,41239,35545,54869,293005,28223,26277,26899,4533,18518,15492,38587,80488,70485,160395,263,60162,11382,222152,4696,250751,51921,182609,10707,48463,46243,1227,49111,111564,46502,33342,56846,68541,63559,858,139927,16654,229375,76759,26478,33205,95828,23399,92945,2637,35630,28470,143992,50214,14174,21456,166191,65665,1711,21594,78019,97599,111701,36,147151,110246,189022,43021,30397,40757,131935,42065,73335,48039,26596,28984,15102,2361,7421,202167,69744,43766,52826,3642,83304,33873,75140,63169,192389,36551,92748,13039,123959,233220,21738,84447,77230,20228,187852,19095,25799,92136,108774,29237,53947,2299,118106,2687,8830,42331,202924,33667,2023,73763,30704,19363,19779,16737,35629,48081,24068,101013,162338,291912,13749,24745,328289,167679,70086,48299,23306,16732,17801,43322,54589,3586,63653,43624,53474,925,109177,251316,43805,13082,19511,86565,142182,92461,17117,101033,103319,64589,4022,4351,235897,5352,82705,107142,46391,156084,5860,61365,10558,13045,7717,18357,33922,12590,33065,6928,46993,783,46937,67846,8952,26295,6107,119656,18799,17458,50747,4229,179559,112727,118080,20683,41464,125468,51560,49749,44231,7359,35339,62988,136487,67015,5208,29150,24956,105186,48858,6143,18097,6972,16404,73489,58742,97196,36357,164616,5834,32267,13746,147733,15113,132091,34127,106298,39729,106426,22294,9780,15602,36213,71502,42808,66802,599,60755,5851,39120,67363,108623,126368,72770,91263,32486,30596,151717,7951,52002,43103,11768,68942,40901,39344,24037,127500,116890,48403,16926,86750,17745,48648,159545,34460,58419,5634,114317,67865,31462,23352,24010,98185,125708,69686,68337,13610,26271,70691,2980,4768,27225,102402,75453,28106,8104,6931,1176,6274,6475,112635,22498,6176,238686,26832,28893,90319,14441,15682,15087,39517,45270,109134,104440,45965,47645,81772,7876,52683,87720,12898,4505,185665,2769,113401,15664,57592,105229,137381,97059,119268,6876,43309,33886,128363,35476,144249,67013,143587,83367,25703,91436,59347,53236,2289,16519,19844,46309,58558,99834,23313,218816,231303,36388,51333,183535,109792,139277,54306,90139,18235,8275,32710,37677,82464,86025,92204,88842,117723,37570,128723,234242,76350,73795,34896,148247,58424,11105,11744,45746,63372,17118,49772,199520,81902,38004,22911,33752,3125,1995,53792,4689,26909,108150,146062,69674,41811,161444,84855,8999,28561,16731,93937,3189,21967,24890,22943,1356,145300,51569,28802,517,118679,31703,40607,48098,108854,25003,10233,73969,177495,5248,24516,215347,146192,48712,60626,69188,40735,5866,586,101541,6509,47590,52129,5969,222045,110933,25733,24223,65339,62812,2414,155418,35819,16022,78423,43138,20995,128255,240673,46745,236093,72176,57085,97841,61248,107,36068,193177,105427,55726,215229,20446,47228,100420,87091,14429,121708,23605,21157,187721,21880,2997,203976,99166,95068,25877,7724,98925,83401,4829,13182,18229,13718,239662,38653,116505,153497,30589,89029,38962,181302,43853,78872,180301,4786,248240,7401,106136,112590,77745,19731,60880,77789,125748,135487,5975,48627,34084,12419,215770,47557,254582,10364,106495,21856,67539,88981,38805,21428,48732,42316,12149,16078,52808,25327,51322,33850,51147,12253,122354,46077,56483,254553,115417,81834,150991,94662,86668,7381,12841,100650,18218,15741,22372,68294,50705,15535,84660,61887,22553,72299,31361,24824,17743,46820,64288,31582,77006,111674,116384,30760,80920,86149,77192,51979,79691,60342,122805,103800,240873,160744,233114,78962,54920,8608,3484,316104,72548,24337,5088,230040,21926,10172,36838,26,86221,83458,102176,12062,17571,41929,41170,28428,68239,41750,103930,2634,18313,53019,34825,97837,63115,24606,73157,152474,14715,91439,37033,109806,140259,30668,174760,380,135597,95673,136073,65073,134249,13829,17279,122305,4420,46444,10237,64848,203623,70728,10349,182885,65075,24519,25783,40318,34139,22222,63394,55266,102764,41422,20126,65100,90408,53640,35128,48932,11192,38935,96839,34782,39492,19396,41332,6250,5511,19492,51304,25936,104466,54099,73771,86115,5080,7669,30891,111700,13931,25276,72289,135447,14820,258641,25265,31005,281179,75286,393,95359,14623,13584,6680,101227,80173,44933,76666,54542,13244,39348,458,25379,109451,134348,81143,6959,65554,12027,51311,8716,57589,140731,28467,23316,17272,30458,25980,55229,77197,83798,28302,114784,7428,34548,26241,14712,39336,103304,18928,54080,12870,334,87722,15208,16895,142098,114262,39820,83913,57817,28682,7721,14900,108672,11250,62246,42849,415188,1724,26555,24549,25505,26443,107450,145899,61035,43528,6901,60726,65906,267741,21338,147590,42079,18924,73017,135236,15393,5206,4026,84185,1531,5988,113890,82647,303391,7386,69844,71611,189865,76523,31877,13315,19314,198575,32821,1928,67641,25913,104475,103489,3297,70391,18406,15446,113347,19295,93790,27856,1792,167471,116449,8541,4408,41757,63233,25765,86680,64501,27034,24816,34975,6079,4486,49693,36229,16917,21581,62426,27862,11612,54284,35702,194034,355,24277,48262,87411,70504,310164,118018,12516,47559,43502,57433,107139,9290,66533,80863,14634,34312,91725,28606,21342,67241,72355,43244,375789,37402,174015,105070,8342,44167,67494,1890,16365,11723,271002,1865,47918,8350,45564,27742,25110,125803,8553,49504,81925,62211,4534,15491,19011,80373,206920,667,102405,128623,245524,5553,113309,192739,65766,19567,22832,261958,29679,21293,71134,20962,105123,24721,860,21752,33448,18372,157167,94822,35770,173224,232737,75729,28937,46828,28062,25453,5207,140366,36665,30652,6169,67920,150458,92040,23186,184604,92330,20891,176492,49427,27828,38305,42495,143982,49560,25503,90043,29747,65328,47830,12932,11068,77721,9003,25213,94205,140426,46090,89945,138173,192691,33329,112232,129905,35709,27514,1841,19957,31411,127476,53572,17497,173549,55063,175135,19841,69314,5192,237921,117660,150697,4060,273045,50414,98940,65348,153665,164423,58804,156695,48994,213928,86036,28608,8355,39574,34540,16927,135680,18374,151587,10830,53805,16878,16623,4282,48030,8537,14986,46102,13062,72897,72,33050,108227,39451,45935,651,113320,40535,95176,57450,48843,5003,19019,10407,211163,3848,1068,4988,32091,30095,41692,15099,43602,107434,50744,7627,171349,16313,150832,352665,207750,33937,38256,51091,156e3,87889,90663,84175,24908,114900,50365,31494,83829,5398,169342,47521,54818,18935,8356,43094,41212,174536,10082,92550,6678,60614,23355,69721,14796,34149,128830,58187,3179,208,40325,28399,225029,401412,51150,31580,207268,6657,10993,69818,64282,289845,23308,12961,38447,6681,52944,31855,2572,47646,120728,179148,37240,45196,218274,4816,3695,21961,50084,35209,18073,51452,27004,6100,33941,1377,84831,171214,85,141510,9078,99227,32610,6417,11718,49868,65579,87902,73018,49062,46280,61742,21512,40862,107733,15941,29168,157765,144919,14487,5767,158014,140070,7241,573,71584,16921,223566,40331,179473,35081,47926,140885,41508,52104,59180,42310,32811,29048,123517,102413,80208,10104,14746,12649,153641,126022,37965,113017,4171,83,142592,2809,6362,50416,71323,116894,260776,16204,1524,5760,30351,12658,20703,54403,36083,45408,74772,4946,14485,50759,111222,10890,2195,167147,92962,130534,16283,177256,35016,15472,210156,151187,73922,117691,43250,52051,37392,24811,24358,30830,5775,818,21969,1476,127322,151783,58392,31021,106913,65215,89407,90802,28531,11690,20234,95249,44602,37256,18707,11928,5161,4410,26571,51903,49768,22008,25252,65780,209499,68769,203726,13249,137363,48845,86823,6658,5674,31881,1083,1823,108676,34518,166752,13791,14287,91576,91429,8665,11529,26401,16191,91972,30964,5254,28486,54697,79613,66520,18447,22870,45203,194466,22822,51703,12278,76716,44595,73455,33546,12235,144843,36154,51247,11116,33040,3180,225753,60864,1972,28469,12891,28879,10338,144157,56294,353058,38302,41447,87532,110616,27065,168438,6557,1213,50804,144643,24817,2390,136531,38174,247513,16190,4059,122791,131994,137430,39506,57650,16305,5188,54309,106128,20628,88071,67394,395446,250285,66176,91254,1399,114196,43915,60230,44853,27206,106353,43013,18733,345105,226453,51202,16607,57106,117175,35492,10476,89598,127439,15187,39624,13688,61570,10615,31111,59370,6238,175252,32143,224492,41388,95408,34384,148238,78307,38959,9340,160091,61443,15737,11216,41244,170,38299,102443,113097,26382,14027,33707,3957,76300,66160,19431,18900,6952,1717,108656,82206,188021,257335,27295,43999,41210,31777,46956,57457,12657,11489,15697,48060,204748,53583,82422,284790,30503,137341,8120,19615,220311,15991,10217,63424,9808,67431,70976,98221,4491,15177,28535,144789,751,13230,2394,1504,33977,132104,30316,22230,931,97193,185240,24826,22687,174322,15307,22988,1390,188745,180325,29580,59068,74903,18994,29195,79,15436,7622,38462,11566,138710,44828,45774,37768,99236,68137,84083,19282,22698,17134,74807,126662,173497,46248,16938,119735,3212,28292,213652,49013,9975,32180,45660,86250,4801,68788,95490,77482,113751,11994,44624,94452,46839,128497,100316,5798,58588,73184,202987,65417,37790,88524,1606,43156,97964,105717,34947,11203,100060,37742,130074,93653,107799,94311,196106,41347,8035,10780,16390,27883,118236,167395,1979,25006,19375,31628,18916,144723,78502,114047,103107,86492,107686,5844,20934,206963,23556,22591,16562,146333,20167,10471,117434,33085,2863,9740,36669,41849,37271,22790,18209,28979,8231,12952,54408,21731,25130,45208,55748,138120,75826,414,29593,9925,292865,25999,683,123149,7036,92159,86055,61827,103680,23176,54918,58466,57578,13305,5709,86479,16697,31064,17660,200919,10770,49793,33423,32370,52047,16488,62555,6459,8426,83493,7763,59725,82812,18628,67760,79405,68557,9612,7673,28102,56517,69620,171797,32458,29541,15870,81109,32080,207644,71495,21202,11039,91036,61230,2810,130800,32260,4613,60590,37112,75214,33979,126402,155062,30642,63875,12810,194463,82799,47664,16725,36685,43367,61099,449,172150,102867,21691,301838,36745,7130,18671,57316,34852,38034,54182,35578,65900,99486,19771,3456,2658,16914,99866,28390,28109,8262,21147,34353,20006,4228,137085,1675,203023,283196,198286,214375,163329,290603,152574,40471,83506,30068,14730,23177,131539,34759,27668,32178,71896,104799,116305,85430,119262,42860,25160,8911,23428,49437,105322,6519,16203,6349,74711,1230,38045,8540,75165,44736,25909,51026,317034,4984,32281,91312,27060,44431,17817,45363,155937,239085,35697,59784,91993,29531,126740,213757,76560,167776,285273,24262,8237,65030,41160,74437,48804,118916,13159,37842,1031,75349,1478,11655,108777,23435,277425,101734,67469,70231,124711,43532,28514,65526,54956,1e3,21882,17728,25302,40952,52214,149632,1999,2111,3259,63362,89961,220561,39777,26335,9063,10572,12416,34551,34623,38604,24723,5947,15588,69927,66252,119177,69173,46629,28714,70715,212408,20521,406913,74380,11716,50659,50862,37009,88460,130101,7210,53853,538,65120,151950,55806,163748,52837,13153,21100,16674,64536,6091,138201,44837,58547,3723,163,2177,32288,85454,34033,8497,14282,25742,10535,10741,79559,117493,243787,49337,100718,79495,40139,42956,7551,55433,15421,31509,23034,45081,547,61176,53434,328001,8470,36263,30145,4519,74173,53935,11845,73774,60211,78025,3,4102,73782,109293,315332,48412,26683,13714,6865,20128,18490,104141,325,39470,171970,115860,15707,7268,73301,74336,31370,2368,111827,107757,136231,142844,97138,96638,84053,38691,23801,1588,10573,122098,77039,240,186135,146101,11996,18143,112963,46171,155836,348769,47795,121213,116266,132515,3344,144804,31286,99187,255838,129694,35894,48779,55235,148582,71967,65282,15174,13920,47080,6147,108242,157593,125025,7136,1286,28957,127956,28402,98813,20805,7532,109417,40610,5041,32958,15142,18408,108596,33543,50517,27748,80114,233434,91447,487,37094,100048,30541,43477,10639,89862,155868,37667,8726,60684,237903,73408,99589,12190,38739,97348,3914,13594,2680,149016,13907,30171,28343,23530,115225,61104,35821,147679,14337,4297,244282,24085,326976,56428,7851,21303,131620,71446,83253,68692,111870,5224,15813,38197,49026,45057,13660,3306,76345,40671,27905,91072,996,68527,62085,91351,122634,55109,168209,2024,27560,112707,17352,8306,167115,169921,166958,5031,46020,11844,67284,19130,76185,6920,32849,5450,14610,22451,21002,17392,31872,66682,84796,13709,40210,59898,12029,8719,53564,21462,91884,21647,88379,194428,12754,37797,132826,160016,22567,54383,53186,77611,31107,8339,4694,19185,90355,23597,17222,140675,28442,23668,55977,9128,61555,28774,155229,17658,9390,24379,69357,15752,127381,239631,62460,93181,55913,45133,140155,18676,25249,33164,29581,82837,67223,22362,29975,7317,52813,1943,29613,20012,207130,49617,49651,5636,15334,36313,29226,28084,95247,72072,19e3,224932,15811,114,32127,38097,37508,88507,37225,27359,91626,12193,69279,20608,11055,88156,92808,2152,57259,55275,72789,24475,104414,1708,9882,3818,48661,66897,1631,34806,227930,85815,87753,18321,250664,72733,25107,206797,50891,8082,196411,92596,96764,152823,65514,22819,387277,62176,51225,40329,15563,189,3659,73670,64357,51793,275136,33482,86653,74615,67058,11318,125720,15388,22388,8267,1730,102663,170910,40784,7144,85373,13040,7088,94309,583,44224,140424,77439,18496,164026,36578,4722,9151,5824,63365,26510,35199,40500,79277,32495,44614,35233,9566,203293,152144,7097,2330,183480,98629,13423,330887,44130,68600,30939,97829,31012,345465,56747,94879,4939,160027,149761,99423,46099,32251,15332,8761,96094,128555,5763,235318,222223,55729,30241,55420,201746,3987,81382,8259,49325,23287,7719,24633,251100,92311,18591,110533,64759,170260,393860,7175,21144,132887,3593,75346,101277,91109,16387,259187,11627,57459,173829,44694,55780,49797,89192,120443,62622,3904,14814,23887,1027,112258,64955,99800,11132,66353,36202,48624,18158,88481,96882,43059,11040,2455,7077,21651,181159,99126,100434,61388,68186,19161,110468,120052,8819,55324,41494,7014,37689,3618,87729,92615,207943,9823,128657,12587,15857,6379,67628,51216,71775,157617,63244,1503,3864,218754,110864,5769,21492,7243,1192,87921,85529,31512,18537,42698,35350,73510,84474,34301,8991,21013,35034,566,38832,19838,35586,37216,39413,55006,12178,59742,856,84563,6900,25632,17437,49786,30723,13847,70845,4044,7843,23944,235976,55530,48942,6518,20939,73769,192653,52936,95207,23895,132542,142982,22632,87452,48042,54018,178468,10728,26230,23559,363,81269,142012,5718,346258,31456,84333,246476,51018,66692,101804,120570,39962,30373,70593,2864,60541,19425,54209,104092,7201,31545,48018,25865,15442,46257,40443,8328,6451,111782,47527,97754,33046,470,245116,31095,39,91934,87208,73470,36708,36521,12801,70624,36272,8892,79768,12427,55454,103756,5908,52390,62962,22720,141138,94634,41689,128402,126390,6628,106394,35527,134394,82727,254651,194502,148064,89549,3202,28359,957,21954,27906,49840,142747,8307,24206,48978,1186,71728,133038,71474,91306,6333,110959,74600,70387,18983,62609,56057,22970,1147,135850,1321,28834,3578,59715,102227,32827,81415,99952,55636,257598,390,22702,35701,85872,402916,39216,189795,14929,19467,10112,144422,61514,5279,63421,134686,41436,8424,51925,10598,132295,124416,4604,194739,210929,57866,31829,51626,50007,9976,91878,61906,56168,81906,60918,61859,40017,23059,16887,40927,62064,12785,32893,32913,21782,93965,20169,44387,79084,38463,11457,93950,27127,157050,2697,337088,5116,54128,48255,33279,8821,27352,25515,124022,65710,28906,38557,33390,1722,104435,72215,38551,12094,30978,25113,6671,37355,175109,42862,98024,65406,221276,59624,118012,64637,78760,86697,21426,1639,40350,12584,67193,84144,31396,7863,143011,69629,63112,9454,28666,65798,46372,134721,6314,51402,30837,151922,2847,38676,38008,92823,136245,17540,5504,109295,205242,37606,5211,214892,1586,20670,208711,137743,19328,40652,16995,20023,14657,154919,34422,12996,13918,38221,47690,16398,2959,37680,89122,6721,198469,91876,172043,83898,101992,26084,94570,3635,76958,22853,76497,38266,176590,168403,44464,142840,79180,184594,1984,41806,83147,11985,6546,366068,59732,24533,271505,8736,39084,222992,93429,28962,58985,86665,8432,30028,14548,32439,54424,165029,55175,27458,69046,121277,46168,33732,20661,24581,135574,123110,37556,79260,72611,16957,12939,46162,58238,44907,72936,253758,41324,32518,96480,11949,124438,65280,43256,34107,53533,43531,37037,28366,45970,32741,173438,6121,194202,62969,26355,30314,58370,28455,1848,50519,82830,90393,21761,295490,10936,256940,133568,44050,20269,4089,27457,21610,219460,36743,14821,101388,52005,13124,30979,140816,167362,26054,18458,60789,34917,40447,26606,33422,9066,3452,83614,5761,20263,137238,25038,91310,101,52322,74548,42572,38084,214054,186568,31802,17665,30620,141936,37730,14420,4265,187218,49640,188208,51441,55388,96452,66659,40869,42039,60967,221027,19234,178581,29105,96050,9165,196118,157335,3738,40354,117436,2965,34136,59659,15570,50843,230035,31444,71260,43886,18316,5387,38500,168508,17406,32174,8828,103373,143806,90367,3560,18719,122310,16508,26719,2541,105429,6645,37998,73190,10591,235916,49737,87112,233941,53188,32193,79154,4544,52905,126477,7580,63501,57314,3216,31337,6541,103083,60846,49,9756,15481,1355,43840,14319,13743,27486,10222,73114,230718,418644,16706,6674,279748,23058,45273,295831,86306,2743,5535,88773,21829,35253,120938,31153,3169,16839,42847,8751,80974,33942,36867,35514,16485,26474,77775,56877,5391,48346,3882,108713,31403,27804,55248,26235,43821,136104,40118,175507,28034,203908,18732,1788,34030,106427,36958,54359,7251,44936,15356,69139,455,157915,22173,140291,50348,43275,82066,49621,54952,15216,36226,96695,66855,6936,1987,8227,196087,4631,68827,99004,47541,110265,17953,147605,110242,58520,31312,38724,329975,642,3155,34497,75937,6207,73843,6120,17249,51429,117746,3218,910,68961,319671,14938,29555,34700,1649,66673,72268,9655,76800,153087,6941,210168,27130,35398,1780,73242,3135,56689,19556,165307,8765,35967,121458,13333,70453,17350,117253,22265,13340,44265,39869,441,3742,135025,23581,33309,16543,17731,13291,157637,283005,21408,101360,63887,52312,83873,5338,233779,23759,186949,34531,177320,38069,156465,91004,19353,59852,68160,14891,1338,1072,29823,1950,28901,81407,313445,73038,84807,162348,240257,37162,138934,16111,58013,41253,102951,16457,96056,19541,56402,67217,41638,94381,89674,29481,37456,80815,151579,13937,13683,132537,19699,134545,67020,29816,222341,141235,427578,48868,129557,233342,23077,87871,16213,18728,16184,9469,37913,19680,2798,171356,178328,13216,50049,72690,71904,124644,55455,7504,29052,41036,266546,19899,30391,188755,8659,59469,16,104298,112943,53865,76203,138226,68857,139953,14125,107625,119795,173133,4398,50273,48808,54390,16466,122086,31835,67035,50971,48859,7508,46427,66477,73021,84615,39985,83076,46779,201569,53336,36443,60865,168164,143810,51393,25548,169307,32896,24485,38424,21837,29087,275813,51674,6714,64883,46169,187369,55186,76192,12852,12018,62134,31067,118303,16542,12125,10579,4928,26291,43854,7091,10946,253716,109062,39283,17261,113012,258512,47764,125126,32646,55892,80279,201623,149872,3192,385,1208,48750,5376,58738,22335,5427,82416,47811,32435,143086,38930,94128,59975,156037,37977,38224,62485,7698,50405,71027,16462,21559,136153,34131,107506,162069,63703,3101,215029,40407,4178,3774,9187,80019,17880,97926,67579,2600,18405,8351,47924,86638,70820,92206,86453,29610,42241,119200,3198,15466,67813,57863,35454,4779,99518,4649,104641,144269,33730,38073,65864,6838,109456,193298,154007,5623,45741,30846,182578,25573,157224,1543,58575,138703,146140,44971,49356,18275,59064,20300,13122,11848,24453,11973,9797,86843,2919,25530,49210,1130,161220,76788,75373,85604,34926,36014,17777,17255,51533,11676,92226,51845,119859,21525,5936,18507,28050,1140,31418,14857,34207,47859,10750,36382,32079,106909,59426,87757,38393,110042,15965,97104,33757,35344,97993,53979,33651,45407,41884,82515,173089,7177,58371,35365,47543,51927,35587,10670,23544,29306,84233,39976,76076,62097,9007,8668,28119,78281,120790,19835,143020,54968,18670,64959,20649,34469,42570,33001,136570,87796,120044,1106,58700,63951,127623,12805,83057,40212,31773,49850,7361,54336,347524,101314,23751,19569,48791,29174,49369,20467,7465,75842,38281,623,112457,60210,28849,51003,94720,6426,90047,85560,43761,3579,85105,34607,90410,118528,7224,42907,111163,18168,6960,161135,191298,5247,100584,127552,171568,20121,91173,12636,54615,20199,63730,98105,2396,40387,14438,125012,4765,33235,12865,45299,37728,82098,77872,114037,59253,19675,24838,398016,102561,11446,17069,57508,178277,65836,99941,26114,2585,271882,136866,50126,11027,155648,118367,14585,8910,123015,335383,40434,41016,53021,14439,87098,176860,201543,121888,2358,9286,5739,22666,54270,37884,169381,33984,93859,16124,89364,72207,51639,76366,99029,65812,2198,12147,174891,194289,6986,30252,88822,21284,11445,288337,160821,33034,100869,43852,25761,52882,1144,103809,1924,84458,86079,43411,13542,139276,18141,34978,41298,7276,26481,173800,33210,17951,142652,33616,33677,2210,19941,98568,2486,192414,80136,12058,235883,50963,249638,29572,27221,47034,6124,72107,63346,97620,158513,299699,40388,23235,37176,224244,198386,121323,67992,23827,63170,17838,106622,158590,26807,5345,23489,91891,55474,74834,37981,13058,5977,72552,34706,26828,145172,19904,21367,34043,960,77092,91381,4733,47446,7680,41697,5170,16960,14741,46101,13656,473,51842,37433,11103,11551,121951,13191,97536,165932,50397,51628,129028,9069,44885,6590,59195,47045,32940,225472,90345,21833,13303,29407,96615,141951,5198,6028,18395,7181,3861,14966,156358,167182,36529,55253,25942,173153,30959,27261,50691,150176,162201,38467,48462,80602,42163,118482,168,108756,26011,17166,54149,456538,22512,91374,13816,90358,131615,18132,226707,1824,28139,26860,42253,93877,77351,65575,8980,80574,22020,27948,40422,91324,76376,13528,39281,91685,82215,122541,144066,1983,193851,17283,26320,2739,194978,4790,26845,42627,61300,65815,174612,55133,4200,191130,79771,158321,52280,166796,221620,62461,11278,4067,88152,83409,31717,121367,13522,47325,37945,10406,174348,249321,154101,64912,29938,51775,17220,15776,166138,78890,84425,54121,42861,16368,24572,291647,10197,32073,22651,11677,97509,26952,35787,18424,41910,71614,94977,72318,41594,70024,275419,37702,60199,7335,39107,61315,18271,18394,33768,87884,104277,123724,7277,56288,71981,189803,49320,3352,6798,14240,8954,69220,94433,57372,28620,68863,193727,85575,42309,41667,67689,42081,22543,44824,12719,28540,114236,101553,27638,27296,4300,5353,4663,19379,94098,3758,95888,95144,80344,87320,28447,259518,12718,71391,152731,37063,24132,31911,104896,15672,103782,1521,4945,72541,23717,122632,15619,87175,206120,29428,189780,61416,28350,44457,972,1175,47233,198738,95789,41907,21953,97034,59341,22864,53713,16873,32971,20693,20954,31336,21477,16169,38370,16412,9019,3841,24599,21938,17085,6484,81198,76413,5849,72514,12320,65247,276175,37234,59796,52642,16312,57349,198507,94148,46134,18958,125552,1747,18725,151873,14901,5490,68287,29470,3689,64794,40814,26018,25692,54450,2703,88278,124886,173087,174e3,24159,179477,24276,46004,201876,209202,445,52876,31948,30206,157610,39180,18439,44124,50469,5774,96278,222758,200216,50290,45486,20435,46986,46276,140133,142326,15569,13363,47522,92583,2182,7135,16853,22998,30272,4952,63263,35623,39096,53789,44864,20053,110392,124213,4630,16087,28221,127787,25839,77481,44693,13464,113146,6983,27069,55717,50102,4760,7107,26186,66507,59145,36032,104182,71328,29425,64317,50781,47465,94298,69706,74899,22754,120756,25108,93077,56834,73286,39928,16218,41699,176763,7555,70819,50083,26895,23315,26014,16773,123079,41712,5719,31516,90427,158540,85051,183128,40864,27505,55392,9058,45224,96857,30901,136622,96557,56304,120061,11501,151448,5773,89743,7769,86069,2935,18471,41628,10114,33660,110170,49479,26745,92846,33221,26731,18795,87076,8550,2100,29972,120289,3077,72490,33784,2630,208722,50861,63483,79029,6419,39467,14302,45286,64207,9686,67513,44170,1050,77246,59266,17055,53801,7150,11111,42432,4278,94579,362117,36175,42902,41933,39002,98489,22913,74161,84773,57036,17556,162288,74485,178760,93867,73635,128860,50362,261,67455,80001,46080,35662,4368,25247,19230,74393,22588,1822,27682,235324,13798,85998,13194,235067,23514,71669,147632,23191,134748,214683,105101,1518,25489,247114,7380,54842,26922,3971,26361,20844,68642,170517,77339,123255,8963,77818,150998,48466,36806,2732,23261,11741,236162,18243,126216,28690,50546,16385,92760,197383,246558,201295,88255,67588,71687,176076,172653,169058,33906,63747,24835,157621,43338,30050,46152,132741,2770,51371,94835,6614,15112,11749,56936,1250,19027,399017,58036,100215,23388,55815,308768,124152,94803,9521,64186,8971,28,30427,62163,7616,103838,35079,29203,131235,7743,17389,10882,37420,61460,228512,85363,41581,131077,62822,119647,10130,54445,26925,19968,29016,24446,74028,24176,61448,67185,9254,8563,119129,9771,99184,37716,39514,10532,221512,258753,218630,55980,23394,32141,61924,66749,32411,3741,36475,26678,77010,44946,91203,128749,116953,20476,49625,53116,13735,102335,29376,51946,83407,67892,59212,34685,21083,1546,112982,32972,74397,1078,190545,16082,86140,58591,89611,101531,10061,105104,76319,20035,17551,52611,169061,190842,100780,23907,90413,115619,9675,34710,193435,49443,129734,11183,258877,16318,136182,126808,44635,27304,192375,2599,125648,47051,12091,23814,721,58800,40137,66726,97930,60877,74487,7942,54326,9841,41428,13762,8211,85383,6950,99177,79806,201786,296464,124087,13144,29741,41721,47634,55088,254286,106408,17041,99064,12942,64086,45233,14005,2612,55827,255,7984,13980,38574,12776,46654,73499,249951,2101,26676,25996,132326,116415,119062,50449,31033,23038,11589,179252,20007,14860,129270,21143,17796,144715,60106,70758,69842,34674,282133,44014,16774,57268,38528,24053,46373,201667,28327,471023,51889,102667,21193,114909,84132,69317,96723,67969,16134,68145,15058,28765,32035,2524,101089,98664,25045,76571,14957,86040,118506,262428,154764,81573,39681,283900,73287,127825,544,80448,52347,38512,175971,15180,45467,33086,46552,48894,81107,43213,36672,54025,76703,8053,7608,13299,56619,20752,238099,54164,105133,1444,32942,953,37564,8e3,66316,119463,106817,404,13667,149108,128597,31267,10269,49836,106150,1484,52330,76965,160486,171648,38456,31263,22424,37738,66245,67467,143369,60471,75610,20895,115528,86070,60854,40796,49347,18989,15030,11371,37578,15779,79867,10187,86462,46402,155626,93200,40229,7090,57547,108053,99598,11088,47505,41218,206017,2173,20988,30219,22919,80563,57566,42369,93141,41675,2407,182519,120495,27154,16702,29456,14349,7958,16688,117177,140375,42467,261919,74916,153569,10836,34742,49526,7621,105997,12212,2270,392377,7755,17959,25086,232152,138791,33847,13860,35316,5811,1344,71259,50452,207539,92635,50359,5821,33674,30255,2086,2587,96264,17543,42,6029,9580,43007,139248,82831,12917,29607,25786,51467,42137,85161,100698,31561,88989,121990,278500,3602,109344,37982,15279,116442,28936,30880,87894,58079,128661,126731,67392,28051,146885,4861,16216,97344,42827,147561,153948,22684,21335,47685,1853,43349,15185,59642,10229,25520,187921,108972,5579,98037,24945,6697,19193,63734,137934,75056,89740,19767,224268,56138,63643,151661,39313,70618,84031,89723,84074,13703,85626,35460,8867,64845,3439,57906,99776,63968,49270,81130,34356,16210,23547,36446,34090,140028,72439,2221,22163,57058,363492,113754,18913,95451,48663,54464,54037,176097,68425,3023,34906,29482,117389,341780,80431,58330,16753,92616,60907,94846,147486,4498,48646,7773,46801,7778,18946,464978,47558,33223,177444,7328,15626,63337,94700,11743,9351,255024,39098,16447,42647,96230,39769,58840,10068,63439,35800,65843,58823,413844,9156,51258,7434,61791,85018,6872,3692,28096,7121,33024,6009,75532,31997,192535,9661,3304,9547,14753,31987,25314,55689,15896,20430,39472,31340,99744,25398,115569,54883,28719,205423,23071,57855,64638,149867,25671,82403,37616,20668,39989,77996,74948,140555,175248,64810,36515,46595,4958,248773,24045,28728,136673,168704,20804,114833,100325,27135,21205,96151,153134,45992,7093,13992,76047,1980,19432,145001,75159,87462,17710,1013,45556,34297,144882,20648,26061,11319,129567,108555,18872,464580,33386,22717,65948,167189,5603,135042,79542,8801,202632,18114,91882,5973,5239,67315,4431,60916,47819,71693,32597,32606,18183,45072,80329,76385,24749,51305,40314,156514,14693,130345,13168,66214,18029,12858,34801,27628,14544,10823,40522,40185,33739,148694,23548,9923,61012,28859,17933,19442,34364,99849,164107,141167,30629,21054,6744,36491,8096,42474,41706,155060,30650,10600,163442,1143,96655,61390,52359,7559,51568,64256,203854,4467,22453,14504,436398,7878,6980,8293,63610,293747,16167,35763,19627,147603,15419,18032,110744,51346,33681,54571,40472,48615,39073,21604,13754,173027,92560,11083,47299,63062,11813,52007,29883,9734,139722,15953,1550,20651,13616,49306,16113,90089,92326,7584,30712,72424,164858,6831,152871,55746,197721,34167,196442,6022,112107,55215,7538,123381,4920,43539,77165,8939,50392,34192,20225,79762,22505,58667,40770,29788,97180,82835,4568,8579,13273,363569,35898,49983,436,36598,3237,131691,62418,35591,8101,4073,379438,65218,76072,33887,2968,27573,212619,288680,68278,72851,150504,217896,6913,121339,22017,35340,51072,43616,75043,31437,10833,81487,4364,22968,41454,106687,85446,19863,109625,149241,524,141850,214404,54376,657,237023,9401,108137,53800,32474,49712,53334,126876,27337,45552,177696,8269,15036,12097,42240,2328,125374,119295,99715,2500,19624,39441,27220,102691,60957,94543,39101,18566,67362,13975,78230,25017,34017,239007,90027,39351,41681,35354,43822,1043,916,58587,141983,94818,38799,75459,41114,67432,16195,36606,59568,22272,126769,31424,68659,12287,134302,257977,5756,207285,95637,47248,117689,19583,77451,22373,12200,54993,117118,34244,29386,34562,53819,71267,64172,77665,49368,7716,59301,25749,45426,194789,17297,2650,1766,32501,45198,20403,20984,6600,14171,94604,19037,5402,29896,9938,59935,109708,88081,145182,44844,39167,352626,164173,35374,45982,6122,154,73419,220487,53834,53601,17992,8609,229321,5610,68098,66815,71012,95069,140968,27396,8957,134489,24656,86659,56598,134852,17316,123838,255436,6613,41610,138033,81452,32023,32396,123687,63398,8693,29712,30407,19296,121188,3551,36099,20032,111948,56624,16547,27453,35916,15378,52039,56849,13489,22214,73177,53097,277349,2157,14029,187886,10260,141743,246460,91880,50869,3788,49486,133566,54950,33120,129337,53768,18333,9525,26902,312251,10297,9020,70759,16647,112432,59260,84609,9818,82766,73569,468,46001,75780,55028,52106,11498,43645,108069,17150,17753,29417,16705,31799,9606,289,122254,115975,8620,6133,255357,56908,14456,133464,43554,79224,11247,29630,160,12756,25464,65960,350428,62521,321796,100359,67358,35169,46172,113128,48988,88868,31094,33266,6847,60887,98188,49659,69117,92977,220228,13947,80181,35103,62170,97351,13475,2440,199768,19498,36597,46971,25234,67806,62881,84717,73648,181966,10488,94149,21550,26655,63436,48375,14405,165650,9621,24439,28043,42735,4490,29963,56674,45373,1934,262446,50855,67098,26898,5261,52696,40644,33900,9440,180286,87162,22940,19704,26936,69769,10254,101759,27406,12243,48e3,73926,113215,54935,5726,192787,4312,106216,9366,11550,52949,23457,212271,277152,133895,108374,6191,96477,29980,218916,58024,54696,40853,91124,65894,91170,65908,252552,6793,29212,15389,44516,122515,52617,35058,9017,103536,39510,49136,19242,130652,662077,74699,47024,31422,8517,73351,24399,13867,128360,4810,4434,61779,111983,61036,17798,110240,59722,102960,39688,10001,23803,23039,176498,56659,44814,134295,17188,77577,74466,226175,102472,154333,63900,111747,18062,41171,79669,32773,408933,42562,28931,30907,107388,43487,2946,240310,23938,24354,319,184983,7927,6488,1422,10790,68809,68209,64775,4361,202,17123,59634,51200,44391,18188,17843,2619,74278,3230,9540,47187,21702,36274,56894,43907,16310,34790,16866,6150,5561,13587,107545,108873,126867,86986,28640,33427,19017,5762,80637,17430,46903,2047,131055,25958,13558,5444,47152,13900,44563,122857,45348,70863,39593,54332,38068,33637,318,40310,143467,18502,24520,11377,62013,28942,27246,28269,83545,17999,59015,90707,30065,15161,34720,1263,37008,2012,6060,98575,92933,5721,299,199555,24578,29223,2985,743,115825,109523,136657,47454,26378,53586,3733,174945,93340,244456,5693,37386,28782,89767,27545,23573,18798,136425,34320,84778,20041,48453,38215,7477,71958,40621,8773,5874,187927,105965,51100,43533,18083,8443,10180,43597,2003,183999,69689,12216,129696,146188,62389,34044,68410,12765,43273,26949,266807,3345,34477,79197,5688,47539,213110,21634,22257,50092,32222,42346,39530,63668,98,134978,74022,5152,59088,174145,37220,9934,9545,118937,5724,87240,19875,15784,40143,23263,87513,181654,285152,37881,263241,4966,43934,10433,186657,6470,74416,225854,25908,142677,246262,32280,6192,75890,45546,143264,135305,29742,47013,77787,11732,126658,8763,37950,21806,57557,113464,89465,108995,164574,23894,22996,23169,15369,23117,17642,130607,40503,36239,280990,44666,9981,40427,147487,26869,168452,32886,32991,46798,240839,15111,70502,65697,88548,44145,28701,48767,31139,206777,35659,181164,166262,14554,171445,31786,66523,76607,17956,6507,31279,90476,116611,167918,6560,1243,115324,80128,41867,55897,187323,37069,32596,189444,145931,13390,105530,65709,26805,6999,55714,41300,22915,68951,22138,21120,22264,10058,19945,33635,56123,99085,10032,5818,6016,46649,57476,35264,94413,112522,262288,93686,83038,14341,23204,28807,66084,77987,6101,126673,7133,38126,5923,122091,170240,97772,46874,215746,43948,41622,3272,55596,8332,146411,251315,13533,8561,81521,115449,48616,175175,2063,186556,3036,134537,75772,29728,82360,22973,186559,86348,89100,38388,82297,45610,2613,87082,9986,177812,57884,23591,47485,42543,33582,44713,74439,257444,252451,31825,35631,38540,33066,5147,13973,4343,51830,70378,22827,26448,95560,36896,241741,48067,203953,298860,61620,20450,3220,67272,6586,107662,100160,108684,6929,57226,4762,7457,1320,40404,77204,99309,62750,208653,59977,44e3,74315,34332,5819,172217,64904,114077,18147,84012,1791,98456,90930,21446,116669,103938,7422,85140,59713,5768,326211,16239,75411,13229,29398,10758,236107,1539,112472,95979,152154,151294,306,21196,38146,10700,6891,84282,109646,56492,40539,6589,119491,51354,30685,140209,136906,29622,73617,49553,70525,51671,166869,139616,74395,37439,49595,45678,11959,33211,86560,52434,9282,62690,112155,130810,5243,108261,99970,265613,72551,80049,6391,33365,90721,66737,69872,87011,1860,9032,112544,60905,37371,89015,140351,19076,850,373531,2802,36725,218795,72062,28990,16550,24614,7815,6187,26336,33373,32162,42791,73555,32062,23386,10244,56392,49442,27076,136262,12412,14883,1134,33675,97153,199281,15608,100152,74072,47942,254301,36451,16026,10687,65067,56708,254030,30290,50490,13864,57941,259331,35588,23485,43486,24869,21620,92971,22072,88645,1048,182050,13343,32452,14825,19509,3325,216938,45740,99716,189082,53740,78245,25609,24311,176777,47340,308354,40669,66085,14102,125339,9225,128709,97207,1271,200933,78439,113451,88975,18324,46521,11819,18570,141756,72512,170020,52754,63550,118515,103073,93330,32736,50499,14722,31600,68452,398867,29316,172786,18417,104924,2606,5670,84818,16288,67106,59580,82929,607401,291,85829,359,15897,35830,50696,65630,52672,22115,356968,29895,40837,231192,34024,38957,26722,406,23335,124952,72068,68804,13268,147101,164740,276569,162596,66943,11569,26654,66358,4777,23229,102127,5848,978,2921,59666,5371,28212,90108,42938,39320,2499,4271,108792,33510,125072,71653,65239,38250,66357,38577,13964,86251,35708,50755,36010,29448,12209,3844,38222,206337,100876,67827,137088,14167,252225,84163,195270,1306,5703,54198,779,46802,22028,51124,86759,70560,113164,35685,162145,45471,34561,422,2611,6464,47486,19223,38246,9191,18331,89942,243642,212364,15893,17518,22617,6409,30046,126182,59716,36560,104428,18846,26592,19458,50793,147333,30826,1388,27647,10922,14495,33545,19269,135828,39727,41601,46931,233379,49169,131130,182112,16276,82381,118209,142445,128310,19672,28740,82907,33436,3118,102206,28723,24819,41937,38854,5157,3881,111491,1142,9776,421673,152241,29309,14961,87854,6054,15424,3796,82656,54996,2108,55367,239450,154525,9643,118103,106041,64601,68549,48707,30266,25772,18740,9462,229669,91798,112152,191327,14493,72828,8175,66636,236474,25817,87351,129027,76653,20422,22983,71240,27846,44661,12399,46158,77704,53101,35032,11072,17300,109294,33638,24408,1895,11241,760,17584,82479,125877,63150,141075,34259,23274,81698,15732,43577,48340,91584,14688,16379,24481,150280,96420,262050,48635,43727,61819,56268,72003,88178,17281,79912,13218,122519,125295,166396,11811,2171,118930,67746,17636,178278,174656,95661,173039,83845,79689,17473,98555,127696,203415,54730,22925,232239,9309,12136,175026,20740,180188,10747,39816,314017,266131,10040,175732,112550,220651,31974,37393,888,23008,86799,4303,64905,148467,75337,251,3284,370102,50264,9835,5438,23655,4481,29851,329,12855,7162,64931,78141,12804,42372,296771,83547,18624,34874,86271,3360,48665,77735,88767,11463,63527,28889,22258,29140,194315,113924,25499,6406,31334,1845,4802,49184,43455,35469,127594,92970,61038,115005,38840,87761,106838,8811,20572,55637,11162,96721,132425,108925,2948,125457,36356,3502,75270,27622,127192,2561,123095,49394,61155,16897,110064,9699,89448,53356,19628,220310,21622,83036,9885,112214,6087,26713,17901,161912,91492,3440,68594,9266,92238,8087,6866,150194,72175,80701,13459,31836,43243,239700,95846,44749,50647,21945,230538,120612,132371,244604,5193,105637,34661,41341,68775,85393,1874,8771,33718,49672,77403,595452,99507,6490,58895,128742,7704,39239,73217,43816,62824,37804,199976,22361,80005,87514,94832,14089,4574,139975,59142,75523,100268,43906,53442,15152,2547,186002,17011,19513,204282,3343,60568,128318,119250,4298,51871,41336,71759,21921,45074,98169,145889,99427,11350,1237,5520,28799,7803,53702,21026,136352,38293,128690,12158,90132,44600,10184,26957,39459,126025,78904,82999,59373,39301,150198,120529,153042,20177,50089,14764,271571,30530,123161,38975,101562,22941,5648,124654,109243,69817,71675,49162,106884,21241,107795,30258,16572,188262,141456,7688,60718,8271,11044,32440,104608,103419,236109,93156,43293,128929,42107,67180,25201,115254,185488,130954,72813,167547,20537,39969,38432,22582,184022,1139,27199,5655,17767,97412,122606,209377,27070,35871,326617,188954,42680,73512,80911,22629,3011,95021,315242,157737,383,41821,41808,19335,27950,15674,25677,110950,35375,76835,59108,57370,35262,16569,160415,37706,78086,32041,49691,137143,9782,172080,50148,77917,6323,10110,69172,17711,21795,59511,76184,135114,31046,132319,59105,157578,20549,80778,57649,158421,65143,4575,72235,21899,10797,92745,34035,106079,80159,4508,78304,25350,75457,46458,32937,25623,47,8531,104751,84953,8138,36508,187199,66310,115274,13253,32461,38536,1916,42007,187160,35055,26325,84394,35963,94216,45590,97782];class Qle{constructor(e){(0,Yo.Z)(this,"log",void 0),(0,Yo.Z)(this,"peerRouting",void 0),(0,Yo.Z)(this,"routingTable",void 0),(0,Yo.Z)(this,"refreshInterval",void 0),(0,Yo.Z)(this,"refreshQueryTimeout",void 0),(0,Yo.Z)(this,"commonPrefixLengthRefreshedAt",void 0),(0,Yo.Z)(this,"refreshTimeoutId",void 0);const{peerRouting:t,routingTable:n,refreshInterval:r,refreshQueryTimeout:i,lan:o}=e;this.log=Goe("libp2p:kad-dht:".concat(o?"lan":"wan",":routing-table:refresh")),this.peerRouting=t,this.routingTable=n,this.refreshInterval=null!==r&&void 0!==r?r:cse,this.refreshQueryTimeout=null!==i&&void 0!==i?i:lse,this.commonPrefixLengthRefreshedAt=[],this.refreshTable=this.refreshTable.bind(this)}async start(){this.log("refreshing routing table every ".concat(this.refreshInterval,"ms")),this.refreshTable(!0)}async stop(){null!=this.refreshTimeoutId&&clearTimeout(this.refreshTimeoutId)}refreshTable(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.log("refreshing routing table");const t=this._maxCommonPrefix(),n=this._getTrackedCommonPrefixLengthsForRefresh(t);this.log("max common prefix length ".concat(t)),this.log("tracked CPLs [ ".concat(n.map((e=>e.toISOString())).join(", ")," ]")),Promise.all(n.map((async(r,i)=>{try{if(await this._refreshCommonPrefixLength(i,r,e),0===this._numPeersForCpl(t)){const t=Math.min(2*(i+1),n.length-1);for(let n=i+1;n<t+1;n++)try{await this._refreshCommonPrefixLength(n,r,e)}catch(o){this.log.error(o)}}}catch(o){this.log.error(o)}}))).catch((e=>{this.log.error(e)})).then((()=>{this.refreshTimeoutId=setTimeout(this.refreshTable,this.refreshInterval),null!=this.refreshTimeoutId.unref&&this.refreshTimeoutId.unref()})).catch((e=>{this.log.error(e)}))}async _refreshCommonPrefixLength(e,t,n){if(!n&&t.getTime()>Date.now()-this.refreshInterval)return void this.log("not running refresh for cpl %s as time since last refresh not above interval",e);const r=await this._generateRandomPeerId(e);this.log("starting refreshing cpl %s with key %p (routing table size was %s)",e,r,this.routingTable.size);const i=await Fle(this.peerRouting.getClosestPeers(r.toBytes(),{signal:AbortSignal.timeout(this.refreshQueryTimeout)}));this.log("found ".concat(i," peers that were close to imaginary peer %p"),r),this.log("finished refreshing cpl %s with key %p (routing table size is now %s)",e,r,this.routingTable.size)}_getTrackedCommonPrefixLengthsForRefresh(e){e>15&&(e=15);const t=[];for(let r=0;r<=e;r++){var n;t[r]=null!==(n=this.commonPrefixLengthRefreshedAt[r])&&void 0!==n?n:new Date}return t}async _generateRandomPeerId(e){if(null==this.routingTable.kb)throw new Error("Routing table not started");const t=$ce(2),n=(t[1]<<8)+t[0];return Kae(await this._makePeerId(this.routingTable.kb.localNodeId,n,e))}async _makePeerId(e,t,n){if(n>15)throw new Error("Cannot generate peer ID for common prefix length greater than ".concat(15));const r=new DataView(e.buffer,e.byteOffset,e.byteLength).getUint16(0,!1),i=65535<<16-(n+1),o=Wle[(r^32768>>n)&i|t&~i],s=new ArrayBuffer(34),a=new DataView(s,0,s.byteLength);return a.setUint8(0,yae.code),a.setUint8(1,32),a.setUint32(2,o,!1),new Uint8Array(a.buffer,a.byteOffset,a.byteLength)}_maxCommonPrefix(){let e=0;for(const t of this._prefixLengths())t>e&&(e=t);return e}_numPeersForCpl(e){let t=0;for(const n of this._prefixLengths())n===e&&t++;return t}*_prefixLengths(){if(null!=this.routingTable.kb)for(const{id:e}of this.routingTable.kb.toIterable()){const t=Ile(this.routingTable.kb.localNodeId,e);let n=0;for(const e of t){if(0!==e)break;n++}yield n}}}const Yle=Goe("libp2p:kad-dht:rpc:handlers:add-provider");class Jle{constructor(e){(0,Yo.Z)(this,"providers",void 0);const{providers:t}=e;this.providers=t}async handle(e,t){if(Yle("start"),null==t.key||0===t.key.length)throw new loe("Missing key","ERR_MISSING_KEY");let n;try{n=Eae.decode(t.key)}catch(r){throw new loe("Invalid CID","ERR_INVALID_CID")}null!=t.providerPeers&&0!==t.providerPeers.length||Yle.error("no providers found in message"),await Promise.all(t.providerPeers.map((async t=>{t.id.equals(e)?t.multiaddrs.length<1?Yle("no valid addresses for provider %p. Ignore",e):(Yle("received provider %p for %s (addrs %s)",e,n,t.multiaddrs.map((e=>e.toString()))),await this.providers.addProvider(n,t.id)):Yle("invalid provider peer %p from %p",t.id,e)})))}}const Xle=Goe("libp2p:kad-dht:rpc:handlers:find-node");class $le{constructor(e,t){(0,Yo.Z)(this,"peerRouting",void 0),(0,Yo.Z)(this,"lan",void 0),(0,Yo.Z)(this,"components",void 0);const{peerRouting:n,lan:r}=t;this.components=e,this.peerRouting=n,this.lan=Boolean(r)}async handle(e,t){Xle("incoming request from %p for peers closer to %b",e,t.key);let n=[];n=(0,Xh.fS)(this.components.peerId.toBytes(),t.key)?[{id:this.components.peerId,multiaddrs:this.components.addressManager.getAddresses().map((e=>e.decapsulateCode((0,ng.a_)("p2p").code))),protocols:[]}]:await this.peerRouting.getCloserPeersOffline(t.key,e),n=n.map(this.lan?gce:pce).filter((e=>{let{multiaddrs:t}=e;return t.length}));const r=new Yae(t.type,new Uint8Array(0),t.clusterLevel);return n.length>0?r.closerPeers=n:Xle("could not find any peers closer to %b than %p",t.key,e),r}}const eue=Goe("libp2p:kad-dht:rpc:handlers:get-providers");class tue{constructor(e,t){(0,Yo.Z)(this,"components",void 0),(0,Yo.Z)(this,"peerRouting",void 0),(0,Yo.Z)(this,"providers",void 0),(0,Yo.Z)(this,"lan",void 0);const{peerRouting:n,providers:r,lan:i}=t;this.components=e,this.peerRouting=n,this.providers=r,this.lan=Boolean(i)}async handle(e,t){let n;try{n=Eae.decode(t.key)}catch(c){throw new loe("Invalid CID","ERR_INVALID_CID")}eue("%p asking for providers for %s",e,n);const[r,i]=await Promise.all([this.providers.getProviders(n),this.peerRouting.getCloserPeersOffline(t.key,e)]),o=await this._getPeers(r),s=await this._getPeers(i.map((e=>{let{id:t}=e;return t}))),a=new Yae(t.type,t.key,t.clusterLevel);return o.length>0&&(a.providerPeers=o),s.length>0&&(a.closerPeers=s),eue("got %s providers %s closerPeers",o.length,s.length),a}async _getAddresses(e){return[]}async _getPeers(e){const t=[],n=this.lan?gce:pce;for(const i of e)try{const e=await this.components.peerStore.get(i),r=n({id:i,multiaddrs:e.addresses.map((e=>{let{multiaddr:t}=e;return t})),protocols:e.protocols});r.multiaddrs.length>0&&t.push(r)}catch(r){if("ERR_NOT_FOUND"!==r.code)throw r}return t}}const nue=Goe("libp2p:kad-dht:rpc:handlers:get-value");class rue{constructor(e,t){(0,Yo.Z)(this,"components",void 0),(0,Yo.Z)(this,"peerRouting",void 0);const{peerRouting:n}=t;this.components=e,this.peerRouting=n}async handle(e,t){const n=t.key;if(nue("%p asked for key %b",e,n),null==n||0===n.length)throw new loe("Invalid key","ERR_INVALID_KEY");const r=new Yae(Gae.GET_VALUE,n,t.clusterLevel);if(function(e){return"/pk/"===(0,Au.B)(e.subarray(0,4))}(n)){nue("is public key");const e=function(e){return Kae(e.subarray(4))}(n);let t;try{const n=await this.components.peerStore.get(e);if(null==n.id.publicKey)throw new loe("No public key found in key book","ERR_NOT_FOUND");t=n.id.publicKey}catch(s){if("ERR_NOT_FOUND"!==s.code)throw s}if(null!=t)return nue("returning found public key"),r.record=new qae(n,t,new Date),r}const[i,o]=await Promise.all([this._checkLocalDatastore(n),this.peerRouting.getCloserPeersOffline(t.key,e)]);return null!=i&&(nue("had record for %b in local datastore",n),r.record=i),o.length>0&&(nue("had %s closer peers in routing table",o.length),r.closerPeers=o),r}async _checkLocalDatastore(e){nue("checkLocalDatastore looking for %b",e);const t=vce(e);let n;try{n=await this.components.datastore.get(t)}catch(i){if("ERR_NOT_FOUND"===i.code)return;throw i}const r=qae.deserialize(n);if(null==r)throw new loe("Invalid record","ERR_INVALID_RECORD");if(!(null==r.timeReceived||Date.now()-r.timeReceived.getTime()>1296e5))return r;await this.components.datastore.delete(t)}}const iue=Goe("libp2p:kad-dht:rpc:handlers:ping");class oue{async handle(e,t){return iue("ping from %p",e),t}}class sue{constructor(e,t){(0,Yo.Z)(this,"log",void 0),(0,Yo.Z)(this,"components",void 0),(0,Yo.Z)(this,"validators",void 0);const{validators:n}=t;this.components=e,this.log=Goe("libp2p:kad-dht:rpc:handlers:put-value"),this.validators=n}async handle(e,t){const n=t.key;this.log("%p asked us to store value for key %b",e,n);const r=t.record;if(null==r){const t="Empty record from: ".concat(e.toString());throw this.log.error(t),new loe(t,"ERR_EMPTY_RECORD")}try{await ace(this.validators,r),r.timeReceived=new Date;const e=vce(r.key);await this.components.datastore.put(e,r.serialize().subarray()),this.log("put record for %b into datastore under key %k",n,e)}catch(i){this.log("did not put record for key %b into datastore %o",n,i)}return t}}class aue{constructor(e,t){(0,Yo.Z)(this,"handlers",void 0),(0,Yo.Z)(this,"routingTable",void 0),(0,Yo.Z)(this,"log",void 0);const{providers:n,peerRouting:r,validators:i,lan:o}=t;this.log=Goe("libp2p:kad-dht:rpc"),this.routingTable=t.routingTable,this.handlers={[Gae.GET_VALUE]:new rue(e,{peerRouting:r}),[Gae.PUT_VALUE]:new sue(e,{validators:i}),[Gae.FIND_NODE]:new $le(e,{peerRouting:r,lan:o}),[Gae.ADD_PROVIDER]:new Jle({providers:n}),[Gae.GET_PROVIDERS]:new tue(e,{peerRouting:r,providers:n,lan:o}),[Gae.PING]:new oue}}async handleMessage(e,t){try{await this.routingTable.add(e)}catch(r){this.log.error("Failed to update the kbucket store",r)}const n=this.handlers[t.type];if(null!=n)return n.handle(e,t);this.log.error("no handler found for message type: ".concat(t.type))}onIncomingStream(e){Promise.resolve().then((async()=>{const{stream:t,connection:n}=e,r=n.remotePeer;try{await this.routingTable.add(r)}catch(o){this.log.error(o)}const i=this;await fse(t,(e=>kce(e)),(async function*(e){for await(const t of e){const e=Yae.deserialize(t);i.log("incoming %s from %p",e.type,r);const n=await i.handleMessage(r,e);null!=n&&(yield n.serialize())}}),(e=>Ice(e)),t)})).catch((e=>{this.log.error(e)}))}}class cue extends goe{constructor(e,t){super(),(0,Yo.Z)(this,"log",void 0),(0,Yo.Z)(this,"components",void 0),(0,Yo.Z)(this,"protocol",void 0),(0,Yo.Z)(this,"running",void 0),(0,Yo.Z)(this,"registrarId",void 0);const{protocol:n,lan:r}=t;this.components=e,this.log=Goe("libp2p:kad-dht:topology-listener:".concat(r?"lan":"wan")),this.running=!1,this.protocol=n}isStarted(){return this.running}async start(){this.running||(this.running=!0,this.registrarId=await this.components.registrar.register(this.protocol,{onConnect:e=>{this.log("observed peer %p with protocol %s",e,this.protocol),this.dispatchEvent(new moe("peer",{detail:e}))}}))}async stop(){this.running=!1,null!=this.registrarId&&(this.components.registrar.unregister(this.registrarId),this.registrarId=void 0)}}class lue extends goe{constructor(e,t){super(),(0,Yo.Z)(this,"protocol",void 0),(0,Yo.Z)(this,"routingTable",void 0),(0,Yo.Z)(this,"providers",void 0),(0,Yo.Z)(this,"network",void 0),(0,Yo.Z)(this,"peerRouting",void 0),(0,Yo.Z)(this,"components",void 0),(0,Yo.Z)(this,"log",void 0),(0,Yo.Z)(this,"running",void 0),(0,Yo.Z)(this,"kBucketSize",void 0),(0,Yo.Z)(this,"clientMode",void 0),(0,Yo.Z)(this,"lan",void 0),(0,Yo.Z)(this,"validators",void 0),(0,Yo.Z)(this,"selectors",void 0),(0,Yo.Z)(this,"queryManager",void 0),(0,Yo.Z)(this,"contentFetching",void 0),(0,Yo.Z)(this,"contentRouting",void 0),(0,Yo.Z)(this,"routingTableRefresh",void 0),(0,Yo.Z)(this,"rpc",void 0),(0,Yo.Z)(this,"topologyListener",void 0),(0,Yo.Z)(this,"querySelf",void 0),(0,Yo.Z)(this,"maxInboundStreams",void 0),(0,Yo.Z)(this,"maxOutboundStreams",void 0);const{kBucketSize:n,clientMode:r,validators:i,selectors:o,querySelfInterval:s,lan:a,protocolPrefix:c,pingTimeout:l,pingConcurrency:u,maxInboundStreams:h,maxOutboundStreams:d,providers:f}=t;this.running=!1,this.components=e,this.lan=Boolean(a),this.log=Goe("libp2p:kad-dht:".concat(!0===a?"lan":"wan")),this.protocol="".concat(null!==c&&void 0!==c?c:"/ipfs").concat(!0===a?"/lan":"").concat("/kad/1.0.0"),this.kBucketSize=null!==n&&void 0!==n?n:20,this.clientMode=null===r||void 0===r||r,this.maxInboundStreams=null!==h&&void 0!==h?h:32,this.maxOutboundStreams=null!==d&&void 0!==d?d:64,this.routingTable=new Gle(e,{kBucketSize:n,lan:this.lan,pingTimeout:l,pingConcurrency:u,protocol:this.protocol}),this.providers=new Ple(e,null!==f&&void 0!==f?f:{}),this.validators={...cce,...i},this.selectors={...sce,...o},this.network=new Rce(e,{protocol:this.protocol,lan:this.lan});const p=Ws();!0===t.allowQueryWithZeroPeers&&p.resolve(),this.queryManager=new Ule(e,{disjointPaths:Math.ceil(this.kBucketSize/2),lan:a,initialQuerySelfHasRun:p,routingTable:this.routingTable}),this.peerRouting=new Tle(e,{routingTable:this.routingTable,network:this.network,validators:this.validators,queryManager:this.queryManager,lan:this.lan}),this.contentFetching=new wce(e,{validators:this.validators,selectors:this.selectors,peerRouting:this.peerRouting,queryManager:this.queryManager,network:this.network,lan:this.lan}),this.contentRouting=new Ece(e,{network:this.network,peerRouting:this.peerRouting,queryManager:this.queryManager,routingTable:this.routingTable,providers:this.providers,lan:this.lan}),this.routingTableRefresh=new Qle({peerRouting:this.peerRouting,routingTable:this.routingTable,lan:this.lan}),this.rpc=new aue(e,{routingTable:this.routingTable,providers:this.providers,peerRouting:this.peerRouting,validators:this.validators,lan:this.lan}),this.topologyListener=new cue(e,{protocol:this.protocol,lan:this.lan}),this.querySelf=new zle(e,{peerRouting:this.peerRouting,interval:s,initialInterval:t.initialQuerySelfInterval,lan:this.lan,initialQuerySelfHasRun:p,routingTable:this.routingTable}),this.network.addEventListener("peer",(e=>{const t=e.detail;this.onPeerConnect(t).catch((e=>{this.log.error("could not add %p to routing table",t.id,e)})),this.dispatchEvent(new moe("peer",{detail:t}))})),this.topologyListener.addEventListener("peer",(e=>{const t=e.detail;Promise.resolve().then((async()=>{const e=await this.components.peerStore.get(t),n={id:t,multiaddrs:e.addresses.map((e=>{let{multiaddr:t}=e;return t})),protocols:e.protocols};await this.onPeerConnect(n)})).catch((e=>{this.log.error("could not add %p to routing table",t,e)}))}))}async onPeerConnect(e){if(this.log("peer %p connected with protocols",e.id,e.protocols),0!==(e=this.lan?gce(e):pce(e)).multiaddrs.length)try{await this.routingTable.add(e.id)}catch(t){this.log.error("could not add %p to routing table",e.id,t)}else this.log("ignoring %p as they do not have any %s addresses in %s",e.id,this.lan?"private":"public",e.multiaddrs.map((e=>e.toString())))}isStarted(){return this.running}async getMode(){return this.clientMode?"client":"server"}async setMode(e){await this.components.registrar.unhandle(this.protocol),"client"===e?(this.log("enabling client mode"),this.clientMode=!0):(this.log("enabling server mode"),this.clientMode=!1,await this.components.registrar.handle(this.protocol,this.rpc.onIncomingStream.bind(this.rpc),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams}))}async start(){this.running=!0,await this.setMode(this.clientMode?"client":"server"),await Promise.all([this.providers.start(),this.queryManager.start(),this.network.start(),this.routingTable.start(),this.topologyListener.start()]),this.querySelf.start(),await this.routingTableRefresh.start()}async stop(){this.running=!1,this.querySelf.stop(),await Promise.all([this.providers.stop(),this.queryManager.stop(),this.network.stop(),this.routingTable.stop(),this.routingTableRefresh.stop(),this.topologyListener.stop()])}put(e,t){try{var n=this;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return async function*(){yield*n.contentFetching.put(e,t,r)}()}catch(r){return Promise.reject(r)}}get(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){yield*t.contentFetching.get(e,n)}()}catch(n){return Promise.reject(n)}}provide(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){yield*t.contentRouting.provide(e,t.components.addressManager.getAddresses(),n)}()}catch(n){return Promise.reject(n)}}findProviders(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){yield*t.contentRouting.findProviders(e,n)}()}catch(n){return Promise.reject(n)}}findPeer(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){yield*t.peerRouting.findPeer(e,n)}()}catch(n){return Promise.reject(n)}}getClosestPeers(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){yield*t.peerRouting.getClosestPeers(e,n)}()}catch(n){return Promise.reject(n)}}async refreshRoutingTable(){this.routingTableRefresh.refreshTable(!0)}}const uue=Goe("libp2p:kad-dht");class hue{constructor(e){(0,Yo.Z)(this,"dht",void 0),this.dht=e}async provide(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};await Woe(this.dht.provide(e,t))}findProviders(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){for await(const r of t.dht.findProviders(e,n))"PROVIDER"===r.name&&(yield*r.providers)}()}catch(n){return Promise.reject(n)}}async put(e,t,n){await Woe(this.dht.put(e,t,n))}async get(e,t){for await(const n of this.dht.get(e,t))if("VALUE"===n.name)return n.value;throw new loe("Not found","ERR_NOT_FOUND")}}class due{constructor(e){(0,Yo.Z)(this,"dht",void 0),this.dht=e}async findPeer(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for await(const n of this.dht.findPeer(e,t))if("FINAL_PEER"===n.name)return n.peer;throw new loe("Not found","ERR_NOT_FOUND")}getClosestPeers(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){for await(const r of t.dht.getClosestPeers(e,n))"FINAL_PEER"===r.name&&(yield r.peer)}()}catch(n){return Promise.reject(n)}}}class fue extends goe{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),(0,Yo.Z)(this,"wan",void 0),(0,Yo.Z)(this,"lan",void 0),(0,Yo.Z)(this,"components",void 0),(0,Yo.Z)(this,"contentRouting",void 0),(0,Yo.Z)(this,"peerRouting",void 0),(0,Yo.Z)(this,Symbol.toStringTag,"@libp2p/dual-kad-dht"),this.components=e,this.wan=new lue(e,{protocolPrefix:"/ipfs",...t,lan:!1}),this.lan=new lue(e,{protocolPrefix:"/ipfs",...t,clientMode:!1,lan:!0}),this.contentRouting=new hue(this),this.peerRouting=new due(this),this.wan.addEventListener("peer",(e=>{this.dispatchEvent(new moe("peer",{detail:e.detail}))})),this.lan.addEventListener("peer",(e=>{this.dispatchEvent(new moe("peer",{detail:e.detail}))})),null==t.clientMode&&e.events.addEventListener("self:peer:update",(e=>{uue("received update of self-peer info");const t=e.detail.peer.addresses.some((e=>{let{multiaddr:t}=e;return function(e){const t=e.stringTuples();for(const n of t)if(290===n[0])return!1;if(54===t[0][0]||55===t[0][0]||56===t[0][0])return!0;if(4===t[0][0]||41===t[0][0]){const e=mS("".concat(t[0][1]));return null==e||!e}return!1}(t)}));this.getMode().then((async e=>{t&&"client"===e?await this.setMode("server"):"server"!==e||t||await this.setMode("client")})).catch((e=>{uue.error("error setting dht server mode",e)}))}))}get[aoe](){return this.contentRouting}get[woe](){return this.peerRouting}get[boe](){return this}isStarted(){return this.wan.isStarted()&&this.lan.isStarted()}async getMode(){return this.wan.getMode()}async setMode(e){await this.wan.setMode(e)}async start(){await Promise.all([this.lan.start(),this.wan.start()])}async stop(){await Promise.all([this.lan.stop(),this.wan.stop()])}put(e,t){try{var n=this;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return async function*(){for await(const i of ese(n.lan.put(e,t,r),n.wan.put(e,t,r)))yield i}()}catch(r){return Promise.reject(r)}}get(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){let r=!1,i=!1;for await(const o of ese(t.lan.get(e,n),t.wan.get(e,n)))yield o,"DIAL_PEER"===o.name&&(r=!0),"VALUE"===o.name&&(r=!0,null!=o.value&&(i=!0)),"SEND_QUERY"===o.name&&(r=!0);if(!r)throw new loe("No peers found in routing table!","ERR_NO_PEERS_IN_ROUTING_TABLE");i||(yield nce({from:t.components.peerId,error:new loe("Not found","ERR_NOT_FOUND")},n))}()}catch(n){return Promise.reject(n)}}provide(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){let r=0,i=0;const o=[],s=[t.lan];"server"===await t.wan.getMode()&&s.push(t.wan);for await(const t of ese(...s.map((t=>t.provide(e,n)))))yield t,"SEND_QUERY"===t.name&&r++,"QUERY_ERROR"===t.name&&o.push(t.error),"PEER_RESPONSE"===t.name&&"ADD_PROVIDER"===t.messageName&&(uue("sent provider record for %s to %p",e,t.from),i++);if(0===i){if(o.length>0)throw new loe("Failed to provide to ".concat(o.length," of ").concat(r," peers"),"ERR_PROVIDES_FAILED",{errors:o});throw new loe("Failed to provide - no peers found","ERR_PROVIDES_FAILED")}}()}catch(n){return Promise.reject(n)}}findProviders(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){yield*ese(t.lan.findProviders(e,n),t.wan.findProviders(e,n))}()}catch(n){return Promise.reject(n)}}findPeer(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){let r=!1;for await(const i of ese(t.lan.findPeer(e,n),t.wan.findPeer(e,n)))yield i,"SEND_QUERY"!==i.name&&"FINAL_PEER"!==i.name||(r=!0);if(!r)throw new loe("Peer lookup failed","ERR_LOOKUP_FAILED")}()}catch(n){return Promise.reject(n)}}getClosestPeers(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){yield*ese(t.lan.getClosestPeers(e,n),t.wan.getClosestPeers(e,n))}()}catch(n){return Promise.reject(n)}}async refreshRoutingTable(){await Promise.all([this.lan.refreshRoutingTable(),this.wan.refreshRoutingTable()])}}var pue,gue;function yue(e){return t=>new fue(t,e)}!function(e){e[e.SEND_QUERY=0]="SEND_QUERY",e[e.PEER_RESPONSE=1]="PEER_RESPONSE",e[e.FINAL_PEER=2]="FINAL_PEER",e[e.QUERY_ERROR=3]="QUERY_ERROR",e[e.PROVIDER=4]="PROVIDER",e[e.VALUE=5]="VALUE",e[e.ADD_PEER=6]="ADD_PEER",e[e.DIAL_PEER=7]="DIAL_PEER"}(pue||(pue={})),function(e){e[e.PUT_VALUE=0]="PUT_VALUE",e[e.GET_VALUE=1]="GET_VALUE",e[e.ADD_PROVIDER=2]="ADD_PROVIDER",e[e.GET_PROVIDERS=3]="GET_PROVIDERS",e[e.FIND_NODE=4]="FIND_NODE",e[e.PING=5]="PING"}(gue||(gue={}));class mue extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"The operation was aborted"),(0,Yo.Z)(this,"code",void 0),(0,Yo.Z)(this,"type",void 0),this.code=mue.code,this.type=mue.type}}(0,Yo.Z)(mue,"code","ABORT_ERR"),(0,Yo.Z)(mue,"type","aborted");class vue extends Error{constructor(e,t,n){var r;super(e),(0,Yo.Z)(this,"code",void 0),(0,Yo.Z)(this,"props",void 0),this.code=t,this.name=null!==(r=null===n||void 0===n?void 0:n.name)&&void 0!==r?r:"CodeError",this.props=null!==n&&void 0!==n?n:{}}}class bue extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected Peer"),(0,Yo.Z)(this,"code",void 0),this.code=bue.code}}(0,Yo.Z)(bue,"code","ERR_UNEXPECTED_PEER");class wue extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid crypto exchange"),(0,Yo.Z)(this,"code",void 0),this.code=wue.code}}(0,Yo.Z)(wue,"code","ERR_INVALID_CRYPTO_EXCHANGE");class Eue extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid crypto transmission"),(0,Yo.Z)(this,"code",void 0),this.code=Eue.code}}(0,Yo.Z)(Eue,"code","ERR_INVALID_CRYPTO_TRANSMISSION");var Aue=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==n[s])throw new TypeError(o+" is ambiguous");n[s]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var r=0,i=0;e[t]===c;)r++,t++;for(var o=(e.length-t)*l+1>>>0,s=new Uint8Array(o);e[t];){var u=n[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=o-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*s[d]>>>0,s[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=o-i;f!==o&&0===s[f];)f++;for(var p=new Uint8Array(r+(o-f)),g=r;f!==o;)p[g++]=s[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,o=t.length;i!==o&&0===t[i];)i++,n++;for(var s=(o-i)*u+1>>>0,l=new Uint8Array(s);i!==o;){for(var h=t[i],d=0,f=s-1;(0!==h||d<r)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");r=d,i++}for(var p=s-r;p!==s&&0===l[p];)p++;for(var g=c.repeat(n);p<s;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:h,decode:function(e){var n=h(e);if(n)return n;throw new Error("Non-".concat(t," character"))}}};const Sue=Aue;new Uint8Array(0);class _ue{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(e));throw Error("Unknown type, must be binary type")}}class Iue{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(e),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return Tue(this,e)}}class Cue{constructor(e){this.decoders=e}or(e){return Tue(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(e),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}}const Tue=(e,t)=>new Cue({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class kue{constructor(e,t,n,r){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=r,this.encoder=new _ue(e,t,n),this.decoder=new Iue(e,t,r)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Rue=e=>{let{name:t,prefix:n,encode:r,decode:i}=e;return new kue(t,n,r,i)},xue=e=>{let{prefix:t,name:n,alphabet:r}=e;const{encode:i,decode:o}=Sue(r,n);return Rue({prefix:t,name:n,encode:i,decode:e=>(e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")})(o(e))})},Pue=e=>{let{name:t,prefix:n,bitsPerChar:r,alphabet:i}=e;return Rue({prefix:n,name:t,encode:e=>((e,t,n)=>{const r="="===t[t.length-1],i=(1<<n)-1;let o="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>n;)s-=n,o+=t[i&a>>s];if(s&&(o+=t[i&a<<n-s]),r)for(;o.length*n&7;)o+="=";return o})(e,i,r),decode:e=>((e,t,n,r)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*n/8|0);let a=0,c=0,l=0;for(let u=0;u<o;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError("Non-".concat(r," character"));c=c<<n|t,a+=n,a>=8&&(a-=8,s[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s})(e,i,r,t)})},Due=Pue({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Oue=(Pue({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Pue({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Pue({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Pue({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Pue({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Pue({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Pue({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Pue({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),xue({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"})),Nue=(xue({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Pue({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}));Pue({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Pue({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Pue({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function Bue(e){let t=function(e){const t=()=>{};return t.enabled=!1,t.color="",t.diff=0,t.log=()=>{},t.namespace=e,t.destroy=()=>!0,t.extend=()=>t,t}("".concat(e,":trace"));return sf().enabled("".concat(e,":trace"))&&null!=sf().names.map((e=>e.toString())).find((e=>e.includes(":trace")))&&(t=sf()("".concat(e,":trace"))),Object.assign(sf()(e),{error:sf()("".concat(e,":error")),trace:t})}sf().formatters.b=e=>null==e?"undefined":Oue.baseEncode(e),sf().formatters.t=e=>null==e?"undefined":Due.baseEncode(e),sf().formatters.m=e=>null==e?"undefined":Nue.baseEncode(e),sf().formatters.p=e=>null==e?"undefined":e.toString(),sf().formatters.c=e=>null==e?"undefined":e.toString(),sf().formatters.k=e=>null==e?"undefined":e.toString(),sf().formatters.a=e=>null==e?"undefined":e.toString();var Lue,Mue=n(79023);class Uue{constructor(e){if((0,Yo.Z)(this,"buffer",void 0),(0,Yo.Z)(this,"mask",void 0),(0,Yo.Z)(this,"top",void 0),(0,Yo.Z)(this,"btm",void 0),(0,Yo.Z)(this,"next",void 0),!(e>0)||0!==(e-1&e))throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];if(void 0!==e)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return void 0===this.buffer[this.btm]}}class Fue{constructor(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,Yo.Z)(this,"size",void 0),(0,Yo.Z)(this,"hwm",void 0),(0,Yo.Z)(this,"head",void 0),(0,Yo.Z)(this,"tail",void 0),this.hwm=null!==(e=t.splitLimit)&&void 0!==e?e:16,this.head=new Uue(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return null!=(null===e||void 0===e?void 0:e.byteLength)?e.byteLength:1}push(e){if(null!=(null===e||void 0===e?void 0:e.value)&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){const t=this.head;this.head=t.next=new Uue(2*this.head.buffer.length),this.head.push(e)}}shift(){var e;let t=this.tail.shift();if(void 0===t&&null!=this.tail.next){const e=this.tail.next;this.tail.next=null,this.tail=e,t=this.tail.shift()}return null!=(null===(e=t)||void 0===e?void 0:e.value)&&(this.size-=this.calculateSize(t.value)),t}isEmpty(){return this.head.isEmpty()}}class Kue extends Error{constructor(e,t){super(null!==e&&void 0!==e?e:"The operation was aborted"),(0,Yo.Z)(this,"type",void 0),(0,Yo.Z)(this,"code",void 0),this.type="aborted",this.code=null!==t&&void 0!==t?t:"ABORT_ERR"}}function jue(e,t){var n;let r,i,o,s=(t=null!==(n=t)&&void 0!==n?n:{}).onEnd,a=new Fue,c=Ws();const l=e=>null!=i?i(e):(a.push(e),r),u=e=>{var n;if(o)return r;if(!0!==(null===(n=t)||void 0===n?void 0:n.objectMode)&&null==(null===e||void 0===e?void 0:e.byteLength))throw new Error("objectMode was not true but tried to push non-Uint8Array value");return l({done:!1,value:e})},h=e=>o?r:(o=!0,null!=e?(e=>(a=new Fue,null!=i?i({error:e}):(a.push({error:e}),r)))(e):l({done:!0}));if(r={[Symbol.asyncIterator](){return this},next:async()=>{try{return a.isEmpty()?o?{done:!0}:await new Promise(((t,n)=>{i=o=>{i=null,a.push(o);try{t(e(a))}catch(s){n(s)}return r}})):e(a)}finally{a.isEmpty()&&queueMicrotask((()=>{c.resolve(),c=Ws()}))}},return:()=>(a=new Fue,h(),{done:!0}),throw:e=>(h(e),{done:!0}),push:u,end:h,get readableLength(){return a.size},onEmpty:async e=>{const t=null===e||void 0===e?void 0:e.signal;if(null===t||void 0===t||t.throwIfAborted(),a.isEmpty())return;let n,r;null!=t&&(n=new Promise(((e,n)=>{r=()=>{n(new Kue)},t.addEventListener("abort",r)})));try{await Promise.race([c.promise,n])}finally{null!=r&&null!=t&&(null===t||void 0===t||t.removeEventListener("abort",r))}}},null==s)return r;const d=r;return r={[Symbol.asyncIterator](){return this},next:()=>d.next(),throw:e=>(d.throw(e),null!=s&&(s(e),s=void 0),{done:!0}),return:()=>(d.return(),null!=s&&(s(),s=void 0),{done:!0}),push:u,end:e=>(d.end(e),null!=s&&(s(e),s=void 0),r),get readableLength(){return d.readableLength},onEmpty:e=>d.onEmpty(e)},r}!function(e){e[e.NEW_STREAM=0]="NEW_STREAM",e[e.MESSAGE_RECEIVER=1]="MESSAGE_RECEIVER",e[e.MESSAGE_INITIATOR=2]="MESSAGE_INITIATOR",e[e.CLOSE_RECEIVER=3]="CLOSE_RECEIVER",e[e.CLOSE_INITIATOR=4]="CLOSE_INITIATOR",e[e.RESET_RECEIVER=5]="RESET_RECEIVER",e[e.RESET_INITIATOR=6]="RESET_INITIATOR"}(Lue||(Lue={}));const Zue=Object.freeze({0:"NEW_STREAM",1:"MESSAGE_RECEIVER",2:"MESSAGE_INITIATOR",3:"CLOSE_RECEIVER",4:"CLOSE_INITIATOR",5:"RESET_RECEIVER",6:"RESET_INITIATOR"}),zue=Object.freeze({NEW_STREAM:Lue.NEW_STREAM,MESSAGE:Lue.MESSAGE_INITIATOR,CLOSE:Lue.CLOSE_INITIATOR,RESET:Lue.RESET_INITIATOR}),Vue=Object.freeze({MESSAGE:Lue.MESSAGE_RECEIVER,CLOSE:Lue.CLOSE_RECEIVER,RESET:Lue.RESET_RECEIVER}),Hue=1<<20;class que{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Hue,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4194304;(0,Yo.Z)(this,"_buffer",void 0),(0,Yo.Z)(this,"_headerInfo",void 0),(0,Yo.Z)(this,"_maxMessageSize",void 0),(0,Yo.Z)(this,"_maxUnprocessedMessageQueueSize",void 0),this._buffer=new Zs,this._headerInfo=null,this._maxMessageSize=e,this._maxUnprocessedMessageQueueSize=t}write(e){if(null==e||0===e.length)return[];if(this._buffer.append(e),this._buffer.byteLength>this._maxUnprocessedMessageQueueSize)throw Object.assign(new Error("unprocessed message queue size too large!"),{code:"ERR_MSG_QUEUE_TOO_BIG"});const t=[];for(;0!==this._buffer.length;){if(null==this._headerInfo)try{this._headerInfo=this._decodeHeader(this._buffer)}catch(n){if("ERR_MSG_TOO_BIG"===n.code)throw n;break}const{id:e,type:r,length:i,offset:o}=this._headerInfo;if(this._buffer.length-o<i)break;const s={id:e,type:r};r!==Lue.NEW_STREAM&&r!==Lue.MESSAGE_INITIATOR&&r!==Lue.MESSAGE_RECEIVER||(s.data=this._buffer.sublist(o,o+i)),t.push(s),this._buffer.consume(o+i),this._headerInfo=null}return t}_decodeHeader(e){const{value:t,offset:n}=Que(e),{value:r,offset:i}=Que(e,n),o=7&t;if(null==Zue[o])throw new Error("Invalid type received: ".concat(o));if(r>this._maxMessageSize)throw Object.assign(new Error("message size too large!"),{code:"ERR_MSG_TOO_BIG"});return{id:t>>3,type:o,offset:n+i,length:r}}}const Gue=128,Wue=127;function Que(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=0,i=0,o=n;const s=e.length;do{if(o>=s||i>49)throw n=0,new RangeError("Could not decode varint");t=e.get(o++),r+=i<28?(t&Wue)<<i:(t&Wue)*Math.pow(2,i),i+=7}while(t>=Gue);return n=o-n,{value:r,offset:n}}const Yue=1048576,Jue=(e,t)=>{t.append(e)};const Xue=function(e,t){return null!=e[Symbol.asyncIterator]?async function*(n,r,i){let o=new Zs,s=!1,a=Ws(),c=Number(null!==(n=null===t||void 0===t?void 0:t.size)&&void 0!==n?n:Yue);if((isNaN(c)||0===c||c<0)&&(c=Yue),c!==Math.round(c))throw new Error("Batch size must be an integer");const l=null!==(r=null===t||void 0===t?void 0:t.yieldAfter)&&void 0!==r?r:0,u=null!==(i=null===t||void 0===t?void 0:t.serialize)&&void 0!==i?i:Jue;for(Promise.resolve().then((async()=>{try{let t;for await(const n of e)u(n,o),o.byteLength>=c?(clearTimeout(t),a.resolve()):t=setTimeout((()=>{a.resolve()}),l);clearTimeout(t),a.resolve()}catch(t){a.reject(t)}finally{s=!0}}));!s;)if(await a.promise,a=Ws(),o.byteLength>0){const e=o;o=new Zs,yield e.subarray()}}():function*(n,r){const i=new Zs;let o=Number(null!==(n=null===t||void 0===t?void 0:t.size)&&void 0!==n?n:Yue);if((isNaN(o)||0===o||o<0)&&(o=Yue),o!==Math.round(o))throw new Error("Batch size must be an integer");const s=null!==(r=null===t||void 0===t?void 0:t.serialize)&&void 0!==r?r:Jue;for(const t of e)s(t,i),i.byteLength>=o&&(yield i.subarray(0,o),i.consume(o));i.byteLength>0&&(yield i.subarray())}()};function $ue(e){return new Uint8Array(e)}const ehe=10240;const the=new class{constructor(){(0,Yo.Z)(this,"_pool",void 0),(0,Yo.Z)(this,"_poolOffset",void 0),this._pool=$ue(ehe),this._poolOffset=0}write(e,t){const n=this._pool;let r=this._poolOffset;Bs.cv(e.id<<3|e.type,n,r),r+=Bs.P$(e.id<<3|e.type),e.type!==Lue.NEW_STREAM&&e.type!==Lue.MESSAGE_INITIATOR&&e.type!==Lue.MESSAGE_RECEIVER||null==e.data?(Bs.cv(0,n,r),r+=Bs.P$(0)):(Bs.cv(e.data.length,n,r),r+=Bs.P$(e.data.length));const i=n.subarray(this._poolOffset,r);ehe-r<100?(this._pool=$ue(ehe),this._poolOffset=0):this._poolOffset=r,t.append(i),e.type!==Lue.NEW_STREAM&&e.type!==Lue.MESSAGE_INITIATOR&&e.type!==Lue.MESSAGE_RECEIVER||null==e.data||t.append(e.data)}};function nhe(e){return null!=e&&"function"===typeof e.then}class rhe{constructor(e){var t,n;(0,Yo.Z)(this,"id",void 0),(0,Yo.Z)(this,"direction",void 0),(0,Yo.Z)(this,"timeline",void 0),(0,Yo.Z)(this,"protocol",void 0),(0,Yo.Z)(this,"metadata",void 0),(0,Yo.Z)(this,"source",void 0),(0,Yo.Z)(this,"status",void 0),(0,Yo.Z)(this,"readStatus",void 0),(0,Yo.Z)(this,"writeStatus",void 0),(0,Yo.Z)(this,"sinkController",void 0),(0,Yo.Z)(this,"sinkEnd",void 0),(0,Yo.Z)(this,"endErr",void 0),(0,Yo.Z)(this,"streamSource",void 0),(0,Yo.Z)(this,"onEnd",void 0),(0,Yo.Z)(this,"onCloseRead",void 0),(0,Yo.Z)(this,"onCloseWrite",void 0),(0,Yo.Z)(this,"onReset",void 0),(0,Yo.Z)(this,"onAbort",void 0),(0,Yo.Z)(this,"sendCloseWriteTimeout",void 0),(0,Yo.Z)(this,"log",void 0),this.sinkController=new AbortController,this.sinkEnd=Ws(),this.log=e.log,this.status="open",this.readStatus="ready",this.writeStatus="ready",this.id=e.id,this.metadata=null!==(t=e.metadata)&&void 0!==t?t:{},this.direction=e.direction,this.timeline={open:Date.now()},this.sendCloseWriteTimeout=null!==(n=e.sendCloseWriteTimeout)&&void 0!==n?n:5e3,this.onEnd=e.onEnd,this.onCloseRead=null===e||void 0===e?void 0:e.onCloseRead,this.onCloseWrite=null===e||void 0===e?void 0:e.onCloseWrite,this.onReset=null===e||void 0===e?void 0:e.onReset,this.onAbort=null===e||void 0===e?void 0:e.onAbort,this.source=this.streamSource=function(){return jue((e=>{const t=e.shift();if(null==t)return{done:!0};if(null!=t.error)throw t.error;return{done:!0===t.done,value:t.value}}),arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}({onEnd:e=>{null!=e?this.log.trace("source ended with error",e):this.log.trace("source ended"),this.onSourceEnd(e)}}),this.sink=this.sink.bind(this)}async sink(e){if("ready"!==this.writeStatus)throw new vue('writable end state is "'.concat(this.writeStatus,'" not "ready"'),"ERR_SINK_INVALID_STATE");try{this.writeStatus="writing";const t={signal:this.sinkController.signal};if("outbound"===this.direction){const e=this.sendNewStream(t);nhe(e)&&await e}e=fF(e,this.sinkController.signal,{returnOnAbort:!0}),this.log.trace("sink reading from source");for await(let n of e){n=n instanceof Uint8Array?new Zs(n):n;const e=this.sendData(n,t);nhe(e)&&await e}this.log.trace('sink finished reading from source, write status is "%s"',this.writeStatus),"writing"===this.writeStatus&&(this.writeStatus="closing",this.log.trace("send close write to remote"),await this.sendCloseWrite({signal:AbortSignal.timeout(this.sendCloseWriteTimeout)}),this.writeStatus="closed"),this.onSinkEnd()}catch(t){throw this.log.trace("sink ended with error, calling abort with error",t),this.abort(t),t}finally{this.log.trace("resolve sink end"),this.sinkEnd.resolve()}}onSourceEnd(e){var t;null==this.timeline.closeRead&&(this.timeline.closeRead=Date.now(),this.readStatus="closed",null!=e&&null==this.endErr&&(this.endErr=e),null===(t=this.onCloseRead)||void 0===t||t.call(this),null!=this.timeline.closeWrite?(this.log.trace("source and sink ended"),this.timeline.close=Date.now(),"aborted"!==this.status&&"reset"!==this.status&&(this.status="closed"),null!=this.onEnd&&this.onEnd(this.endErr)):this.log.trace("source ended, waiting for sink to end"))}onSinkEnd(e){var t;null==this.timeline.closeWrite&&(this.timeline.closeWrite=Date.now(),this.writeStatus="closed",null!=e&&null==this.endErr&&(this.endErr=e),null===(t=this.onCloseWrite)||void 0===t||t.call(this),null!=this.timeline.closeRead?(this.log.trace("sink and source ended"),this.timeline.close=Date.now(),"aborted"!==this.status&&"reset"!==this.status&&(this.status="closed"),null!=this.onEnd&&this.onEnd(this.endErr)):this.log.trace("sink ended, waiting for source to end"))}async close(e){this.log.trace("closing gracefully"),this.status="closing",await Promise.all([this.closeRead(e),this.closeWrite(e)]),this.status="closed",this.log.trace("closed gracefully")}async closeRead(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("closing"===this.readStatus||"closed"===this.readStatus)return;this.log.trace('closing readable end of stream with starting read status "%s"',this.readStatus);const t=this.readStatus;this.readStatus="closing","reset"!==this.status&&"aborted"!==this.status&&null==this.timeline.closeRead&&(this.log.trace("send close read to remote"),await this.sendCloseRead(e)),"ready"===t&&(this.log.trace("ending internal source queue"),this.streamSource.end()),this.log.trace("closed readable end of stream")}async closeWrite(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"closing"!==this.writeStatus&&"closed"!==this.writeStatus&&(this.log.trace('closing writable end of stream with starting write status "%s"',this.writeStatus),"ready"===this.writeStatus&&(this.log.trace("sink was never sunk, sink an empty array"),await Ys(this.sink([]),e.signal)),"writing"===this.writeStatus&&await new Promise(((t,n)=>{queueMicrotask((()=>{this.log.trace("aborting source passed to .sink"),this.sinkController.abort(),Ys(this.sinkEnd.promise,e.signal).then(t,n)}))})),this.writeStatus="closed",this.log.trace("closed writable end of stream"))}abort(e){var t;if("closed"===this.status||"aborted"===this.status||"reset"===this.status)return;this.log("abort with error",e),this.log("try to send reset to remote");const n=this.sendReset();nhe(n)&&n.catch((e=>{this.log.error("error sending reset message",e)})),this.status="aborted",this.timeline.abort=Date.now(),this._closeSinkAndSource(e),null===(t=this.onAbort)||void 0===t||t.call(this,e)}reset(){var e;if("closed"===this.status||"aborted"===this.status||"reset"===this.status)return;const t=new vue("stream reset","ERR_STREAM_RESET");this.status="reset",this.timeline.reset=Date.now(),this._closeSinkAndSource(t),null===(e=this.onReset)||void 0===e||e.call(this)}_closeSinkAndSource(e){this._closeSink(e),this._closeSource(e)}_closeSink(e){"writing"===this.writeStatus&&(this.log.trace("end sink source"),this.sinkController.abort()),this.onSinkEnd(e)}_closeSource(e){"closing"!==this.readStatus&&"closed"!==this.readStatus&&(this.log.trace("ending source with %d bytes to be read by consumer",this.streamSource.readableLength),this.readStatus="closing",this.streamSource.end(e))}remoteCloseWrite(){"closing"!==this.readStatus&&"closed"!==this.readStatus?(this.log.trace("remote close write"),this._closeSource()):this.log("received remote close write but local source is already closed")}remoteCloseRead(){"closing"!==this.writeStatus&&"closed"!==this.writeStatus?(this.log.trace("remote close read"),this._closeSink()):this.log("received remote close read but local sink is already closed")}destroy(){"closed"!==this.status&&"aborted"!==this.status&&"reset"!==this.status?(this.log.trace("stream destroyed"),this._closeSinkAndSource()):this.log("received destroy but we are already closed")}sourcePush(e){this.streamSource.push(e)}sourceReadableLength(){return this.streamSource.readableLength}}class ihe extends rhe{constructor(e){super(e),(0,Yo.Z)(this,"name",void 0),(0,Yo.Z)(this,"streamId",void 0),(0,Yo.Z)(this,"send",void 0),(0,Yo.Z)(this,"types",void 0),(0,Yo.Z)(this,"maxDataSize",void 0),this.types="outbound"===e.direction?zue:Vue,this.send=e.send,this.name=e.name,this.streamId=e.streamId,this.maxDataSize=e.maxDataSize}async sendNewStream(){await this.send({id:this.streamId,type:zue.NEW_STREAM,data:new Zs((0,yu.m)(this.name))})}async sendData(e){for(e=e.sublist();e.byteLength>0;){const t=Math.min(e.byteLength,this.maxDataSize);await this.send({id:this.streamId,type:this.types.MESSAGE,data:e.sublist(0,t)}),e.consume(t)}}async sendReset(){await this.send({id:this.streamId,type:this.types.RESET})}async sendCloseWrite(){await this.send({id:this.streamId,type:this.types.CLOSE})}async sendCloseRead(){}}const ohe=Bue("libp2p:mplex");function she(e){const t={...e,type:"".concat(Zue[e.type]," (").concat(e.type,")")};return e.type===Lue.NEW_STREAM&&(t.data=(0,Xh.BB)(e.data instanceof Uint8Array?e.data:e.data.subarray())),e.type!==Lue.MESSAGE_INITIATOR&&e.type!==Lue.MESSAGE_RECEIVER||(t.data=(0,Xh.BB)(e.data instanceof Uint8Array?e.data:e.data.subarray(),"base16")),t}class ahe{constructor(e){var t,n,r;(0,Yo.Z)(this,"protocol","/mplex/6.7.0"),(0,Yo.Z)(this,"sink",void 0),(0,Yo.Z)(this,"source",void 0),(0,Yo.Z)(this,"_streamId",void 0),(0,Yo.Z)(this,"_streams",void 0),(0,Yo.Z)(this,"_init",void 0),(0,Yo.Z)(this,"_source",void 0),(0,Yo.Z)(this,"closeController",void 0),(0,Yo.Z)(this,"rateLimiter",void 0),(0,Yo.Z)(this,"closeTimeout",void 0),e=null!==(t=e)&&void 0!==t?t:{},this._streamId=0,this._streams={initiators:new Map,receivers:new Map},this._init=e,this.closeTimeout=null!==(n=e.closeTimeout)&&void 0!==n?n:500,this.sink=this._createSink(),this._source=function(){return jue((e=>{let t;const n=[];for(;!e.isEmpty()&&(t=e.shift(),null!=t);){if(null!=t.error)throw t.error;!1===t.done&&n.push(t.value)}return null==t?{done:!0}:{done:!0===t.done,value:n}}),arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}({objectMode:!0,onEnd:()=>{for(const e of this._streams.initiators.values())e.destroy();for(const e of this._streams.receivers.values())e.destroy()}}),this.source=(0,Mue.pipe)(this._source,(e=>function(e){try{let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return async function*(){if(null!=t&&0!==t)yield*Xue(e,{size:t,serialize:(e,t)=>{for(const n of e)the.write(n,t)}});else for await(const t of e){const e=new Zs;for(const n of t)the.write(n,e);yield e.subarray()}}()}catch(t){return Promise.reject(t)}}(e,this._init.minSendBytes))),this.closeController=new AbortController,this.rateLimiter=new c5.RateLimiterMemory({points:null!==(r=e.disconnectThreshold)&&void 0!==r?r:5,duration:1})}get streams(){const e=[];for(const t of this._streams.initiators.values())e.push(t);for(const t of this._streams.receivers.values())e.push(t);return e}newStream(e){if(this.closeController.signal.aborted)throw new Error("Muxer already closed");const t=this._streamId++;e=null==e?t.toString():e.toString();const n=this._streams.initiators;return this._newStream({id:t,name:e,type:"initiator",registry:n})}async close(e){var t;if(this.closeController.signal.aborted)return;const n=null!==(t=null===e||void 0===e?void 0:e.signal)&&void 0!==t?t:AbortSignal.timeout(this.closeTimeout);try{await Promise.all(this.streams.map((async e=>e.close({signal:n})))),this._source.end(),await this._source.onEmpty({signal:n}),this.closeController.abort()}catch(r){this.abort(r)}}abort(e){this.closeController.signal.aborted||(this.streams.forEach((t=>{t.abort(e)})),this.closeController.abort(e))}_newReceiverStream(e){const{id:t,name:n}=e,r=this._streams.receivers;return this._newStream({id:t,name:n,type:"receiver",registry:r})}_newStream(e){var t;const{id:n,name:r,type:i,registry:o}=e;if(ohe("new %s stream %s",i,n),"initiator"===i&&this._streams.initiators.size===(null!==(t=this._init.maxOutboundStreams)&&void 0!==t?t:1024))throw new vue("Too many outbound streams open","ERR_TOO_MANY_OUTBOUND_STREAMS");if(o.has(n))throw new Error("".concat(i," stream ").concat(n," already exists!"));const s=function(e){const{id:t,name:n,send:r,onEnd:i,type:o="initiator",maxMsgSize:s=Hue}=e;return new ihe({id:"initiator"===o?"i".concat(t):"r".concat(t),streamId:t,name:"".concat(null==n?t:n),direction:"initiator"===o?"outbound":"inbound",maxDataSize:s,onEnd:i,send:r,log:Bue("libp2p:mplex:stream:".concat(o,":").concat(t))})}({id:n,name:r,send:async e=>{ohe.enabled&&ohe.trace("%s stream %s send",i,n,she(e)),this._source.push(e)},type:i,onEnd:()=>{ohe("%s stream with id %s and protocol %s ended",i,n,s.protocol),o.delete(n),null!=this._init.onStreamEnd&&this._init.onStreamEnd(s)},maxMsgSize:this._init.maxMsgSize});return o.set(n,s),s}_createSink(){return async e=>{try{e=fF(e,this.closeController.signal,{returnOnAbort:!0});const t=new que(this._init.maxMsgSize,this._init.maxUnprocessedMessageQueueSize);for await(const n of e)for(const e of t.write(n))await this._handleIncoming(e);this._source.end()}catch(t){ohe("error in sink",t),this._source.end(t)}}}async _handleIncoming(e){var t;const{id:n,type:r}=e;if(ohe.enabled&&ohe.trace("incoming message",she(e)),e.type===Lue.NEW_STREAM){var i;if(this._streams.receivers.size===(null!==(i=this._init.maxInboundStreams)&&void 0!==i?i:1024)){ohe("too many inbound streams open"),this._source.push({id:n,type:Lue.RESET_RECEIVER});try{await this.rateLimiter.consume("new-stream",1)}catch{return ohe("rate limit hit when opening too many new streams over the inbound stream limit - closing remote connection"),void this.abort(new Error("Too many open streams"))}return}const t=this._newReceiverStream({id:n,name:(0,Xh.BB)(e.data instanceof Uint8Array?e.data:e.data.subarray())});return void(null!=this._init.onIncomingStream&&this._init.onIncomingStream(t))}const o=(1===(1&r)?this._streams.initiators:this._streams.receivers).get(n);if(null==o){ohe("missing stream %s for message type %s",n,Zue[r]);try{await this.rateLimiter.consume("missing-stream",1)}catch{return ohe("rate limit hit when receiving messages for streams that do not exist - closing remote connection"),void this.abort(new Error("Too many messages for missing streams"))}return}const s=null!==(t=this._init.maxStreamBufferSize)&&void 0!==t?t:4194304;try{switch(r){case Lue.MESSAGE_INITIATOR:case Lue.MESSAGE_RECEIVER:if(o.sourceReadableLength()>s)throw this._source.push({id:e.id,type:r===Lue.MESSAGE_INITIATOR?Lue.RESET_RECEIVER:Lue.RESET_INITIATOR}),new vue("Input buffer full - increase Mplex maxBufferSize to accommodate slow consumers","ERR_STREAM_INPUT_BUFFER_FULL");o.sourcePush(e.data);break;case Lue.CLOSE_INITIATOR:case Lue.CLOSE_RECEIVER:o.remoteCloseWrite();break;case Lue.RESET_INITIATOR:case Lue.RESET_RECEIVER:o.reset();break;default:ohe("unknown message type %s",r)}}catch(a){ohe.error("error while processing message",a),o.abort(a)}}}class che{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,Yo.Z)(this,"protocol","/mplex/6.7.0"),(0,Yo.Z)(this,"_init",void 0),this._init=e}createStreamMuxer(){return new ahe({...arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},...this._init})}}function lhe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return()=>new che(e)}var uhe;!function(e){e.ERR_ALREADY_ABORTED="ERR_ALREADY_ABORTED",e.ERR_DATA_CHANNEL="ERR_DATA_CHANNEL",e.ERR_CONNECTION_CLOSED="ERR_CONNECTION_CLOSED",e.ERR_HASH_NOT_SUPPORTED="ERR_HASH_NOT_SUPPORTED",e.ERR_INVALID_MULTIADDR="ERR_INVALID_MULTIADDR",e.ERR_INVALID_FINGERPRINT="ERR_INVALID_FINGERPRINT",e.ERR_INVALID_PARAMETERS="ERR_INVALID_PARAMETERS",e.ERR_NOT_IMPLEMENTED="ERR_NOT_IMPLEMENTED",e.ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS="ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS",e.ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS="ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS"}(uhe||(uhe={}));class hhe extends aq{constructor(e,t){super("WebRTC transport error: ".concat(e),null!==t&&void 0!==t?t:""),this.name="WebRTCTransportError"}}class dhe extends hhe{constructor(e,t){super("[stream: ".concat(e,"] data channel error: ").concat(t),uhe.ERR_DATA_CHANNEL),this.name="WebRTC/DataChannelError"}}function fhe(e,t){return new dhe(e,t)}class phe extends hhe{constructor(e){super("There was a problem with the Multiaddr which was passed in: ".concat(e),uhe.ERR_INVALID_MULTIADDR),this.name="WebRTC/InappropriateMultiaddrError"}}function ghe(e){return new phe(e)}class yhe extends hhe{constructor(e){super("There was a problem with a provided argument: ".concat(e),uhe.ERR_INVALID_PARAMETERS),this.name="WebRTC/InvalidArgumentError"}}function mhe(e){return new yhe(e)}class vhe extends hhe{constructor(e,t){super('Invalid fingerprint "'.concat(e,'" within ').concat(t),uhe.ERR_INVALID_FINGERPRINT),this.name="WebRTC/InvalidFingerprintError"}}function bhe(e,t){return new vhe(e,t)}class whe extends hhe{constructor(e){super("A method (".concat(e,") was called though it has been intentionally left unimplemented."),uhe.ERR_NOT_IMPLEMENTED),this.name="WebRTC/UnimplementedError"}}class Ehe extends hhe{constructor(e){super("unsupported hash algorithm: ".concat(e),uhe.ERR_HASH_NOT_SUPPORTED),this.name="WebRTC/UnsupportedHashAlgorithmError"}}const Ahe=aH("libp2p:webrtc:utils"),She=zB(),_he=null!=She&&"firefox"===She.name,Ihe=async function*(){},Che=async e=>{},The=3e4;const khe=aH("libp2p:webrtc:maconn");class Rhe{constructor(e){(0,Yo.Z)(this,"peerConnection",void 0),(0,Yo.Z)(this,"remoteAddr",void 0),(0,Yo.Z)(this,"timeline",void 0),(0,Yo.Z)(this,"metrics",void 0),(0,Yo.Z)(this,"source",Ihe()),(0,Yo.Z)(this,"sink",Che),this.remoteAddr=e.remoteAddr,this.timeline=e.timeline,this.peerConnection=e.peerConnection;const t=this.peerConnection.connectionState;this.peerConnection.onconnectionstatechange=()=>{khe.trace("peer connection state change",this.peerConnection.connectionState,"initial state",t),"disconnected"!==this.peerConnection.connectionState&&"failed"!==this.peerConnection.connectionState&&"closed"!==this.peerConnection.connectionState||(this.timeline.close=Date.now())}}async close(e){var t;khe.trace("closing connection"),this.peerConnection.close(),this.timeline.close=Date.now(),null===(t=this.metrics)||void 0===t||t.increment({close:!0})}abort(e){var t;khe.error("closing connection due to error",e),this.peerConnection.close(),this.timeline.close=Date.now(),null===(t=this.metrics)||void 0===t||t.increment({abort:!0})}}const xhe=e=>{const t=e.on||e.addListener||e.addEventListener,n=e.off||e.removeListener||e.removeEventListener;if(!t||!n)throw new TypeError("Emitter is not compatible");return{addListener:t.bind(e),removeListener:n.bind(e)}};function Phe(e,t,n){"function"===typeof n&&(n={filter:n});const r=function(e,t,n){let r;const i=new Promise(((i,o)=>{var s;if(!((n={rejectionEvents:["error"],multiArgs:!1,resolveImmediately:!1,...n}).count>=0)||n.count!==Number.POSITIVE_INFINITY&&!Number.isInteger(n.count))throw new TypeError("The `count` option should be at least 0 or more");null===(s=n.signal)||void 0===s||s.throwIfAborted();const a=[t].flat(),c=[],{addListener:l,removeListener:u}=xhe(e),h=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];const s=n.multiArgs?t:t[0];n.filter&&!n.filter(s)||(c.push(s),n.count===c.length&&(r(),i(c)))},d=e=>{r(),o(e)};r=()=>{for(const e of a)u(e,h);for(const e of n.rejectionEvents)u(e,d)};for(const e of a)l(e,h);for(const e of n.rejectionEvents)l(e,d);n.signal&&n.signal.addEventListener("abort",(()=>{d(n.signal.reason)}),{once:!0}),n.resolveImmediately&&i(c)}));if(i.cancel=r,"number"===typeof n.timeout){const e=YB(i,{milliseconds:n.timeout});return e.cancel=r,e}return i}(e,t,n={...n,count:1,resolveImmediately:!1}),i=r.then((e=>e[0]));return i.cancel=r.cancel,i}var Dhe;!function(e){let t,n,r;!function(e){e.FIN="FIN",e.STOP_SENDING="STOP_SENDING",e.RESET="RESET",e.FIN_ACK="FIN_ACK"}(t=e.Flag||(e.Flag={})),function(e){e[e.FIN=0]="FIN",e[e.STOP_SENDING=1]="STOP_SENDING",e[e.RESET=2]="RESET",e[e.FIN_ACK=3]="FIN_ACK"}(n||(n={})),function(e){e.codec=()=>bs(n)}(t=e.Flag||(e.Flag={})),e.codec=()=>(null==r&&(r=ws((function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==r.lengthDelimited&&n.fork(),null!=t.flag&&(n.uint32(8),e.Flag.codec().encode(t.flag,n)),null!=t.message&&(n.uint32(18),n.bytes(t.message)),!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.flag=e.Flag.codec().decode(t);break;case 2:r.message=t.bytes();break;default:t.skipType(7&n)}}return r}))),r),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(Dhe||(Dhe={}));class Ohe extends Gne{constructor(e){var t,n,r,i;const o=e.onEnd;switch(e.onEnd=e=>{this.log.trace("readable and writeable ends closed",this.status),Promise.resolve((async()=>{if(null==this.timeline.abort&&null===this.timeline.reset)try{await YB(this.receiveFinAck.promise,{milliseconds:this.finAckTimeout})}catch(e){this.log.error("error receiving FIN_ACK",e)}})).then((()=>{this.incomingData.end(),null===o||void 0===o||o(e)})).catch((e=>{this.log.error("error ending stream",e)}))},super(e),(0,Yo.Z)(this,"channel",void 0),(0,Yo.Z)(this,"incomingData",void 0),(0,Yo.Z)(this,"messageQueue",void 0),(0,Yo.Z)(this,"maxBufferedAmount",void 0),(0,Yo.Z)(this,"bufferedAmountLowEventTimeout",void 0),(0,Yo.Z)(this,"maxMessageSize",void 0),(0,Yo.Z)(this,"receiveFinAck",void 0),(0,Yo.Z)(this,"finAckTimeout",void 0),this.channel=e.channel,this.channel.binaryType="arraybuffer",this.incomingData=Gq(),this.messageQueue=new Zs,this.bufferedAmountLowEventTimeout=null!==(t=e.bufferedAmountLowEventTimeout)&&void 0!==t?t:3e4,this.maxBufferedAmount=null!==(n=e.maxBufferedAmount)&&void 0!==n?n:16777216,this.maxMessageSize=(null!==(r=e.maxMessageSize)&&void 0!==r?r:16384)-5-2,this.receiveFinAck=Ws(),this.finAckTimeout=null!==(i=e.closeTimeout)&&void 0!==i?i:5e3,this.channel.readyState){case"open":case"connecting":break;case"closed":case"closing":void 0!==this.timeline.close&&0!==this.timeline.close||(this.timeline.close=Date.now());break;default:throw this.log.error("unknown datachannel state %s",this.channel.readyState),new aq("Unknown datachannel state","ERR_INVALID_STATE")}this.channel.onopen=e=>{this.timeline.open=(new Date).getTime(),null!=this.messageQueue&&this.messageQueue.byteLength>0&&(this.log.trace("dataChannel opened, sending queued messages",this.messageQueue.byteLength,this.channel.readyState),this._sendMessage(this.messageQueue).catch((e=>{this.log.error("error sending queued messages",e),this.abort(e)}))),this.messageQueue=void 0},this.channel.onclose=e=>{this.receiveFinAck.resolve(),this.close().catch((e=>{this.log.error("error closing stream after channel closed",e)}))},this.channel.onerror=e=>{const t=e.error;this.abort(t)},this.channel.onmessage=async e=>{const{data:t}=e;null!==t&&0!==t.byteLength&&this.incomingData.push(new Uint8Array(t,0,t.byteLength))};const s=this;Promise.resolve().then((async()=>{for await(const e of Zq(this.incomingData)){const t=s.processIncomingProtobuf(e);null!=t&&s.sourcePush(new Zs(t))}})).catch((e=>{this.log.error("error processing incoming data channel messages",e)}))}sendNewStream(){}async _sendMessage(e){if((!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.channel.bufferedAmount>this.maxBufferedAmount)try{await Phe(this.channel,"bufferedamountlow",{timeout:this.bufferedAmountLowEventTimeout})}catch(t){if(t instanceof qB)throw new aq("Timed out waiting for DataChannel buffer to clear after ".concat(this.bufferedAmountLowEventTimeout,"ms"),"ERR_BUFFER_CLEAR_TIMEOUT");throw t}if("closed"===this.channel.readyState||"closing"===this.channel.readyState)throw new aq("Invalid datachannel state - ".concat(this.channel.readyState),"ERR_INVALID_STATE");if("open"===this.channel.readyState)for(const n of e)this.channel.send(n);else{if("connecting"!==this.channel.readyState)throw this.log.error("unknown datachannel state %s",this.channel.readyState),new aq("Unknown datachannel state","ERR_INVALID_STATE");null==this.messageQueue&&(this.messageQueue=new Zs),this.messageQueue.append(e)}}async sendData(e){for(e=e.sublist();e.byteLength>0;){const t=Math.min(e.byteLength,this.maxMessageSize),n=e.subarray(0,t),r=Dhe.encode({message:n}),i=Fq.single(r);await this._sendMessage(i),e.consume(t)}}async sendReset(){await this._sendFlag(Dhe.Flag.RESET)}async sendCloseWrite(e){if(await this._sendFlag(Dhe.Flag.FIN)){this.log.trace("awaiting FIN_ACK");try{await Ys(this.receiveFinAck.promise,null===e||void 0===e?void 0:e.signal,{errorMessage:"sending close-write was aborted before FIN_ACK was received",errorCode:"ERR_FIN_ACK_NOT_RECEIVED"})}catch(t){this.log.error("failed to await FIN_ACK",t)}}else this.log.trace("sending FIN failed, not awaiting FIN_ACK");this.receiveFinAck.resolve()}async sendCloseRead(){await this._sendFlag(Dhe.Flag.STOP_SENDING)}processIncomingProtobuf(e){const t=Dhe.decode(e);if(void 0!==t.flag&&(this.log.trace('incoming flag %s, write status "%s", read status "%s"',t.flag,this.writeStatus,this.readStatus),t.flag===Dhe.Flag.FIN&&(this.remoteCloseWrite(),this.log.trace("sending FIN_ACK"),this._sendFlag(Dhe.Flag.FIN_ACK).catch((e=>{this.log.error("error sending FIN_ACK immediately",e)}))),t.flag===Dhe.Flag.RESET&&this.reset(),t.flag===Dhe.Flag.STOP_SENDING&&this.remoteCloseRead(),t.flag===Dhe.Flag.FIN_ACK&&(this.log.trace("received FIN_ACK"),this.receiveFinAck.resolve())),"ready"===this.readStatus)return t.message}async _sendFlag(e){if("open"!==this.channel.readyState)return this.log.trace("not sending flag %s because channel is not open",e.toString()),!1;this.log.trace("sending flag %s",e.toString());const t=Dhe.encode({flag:e}),n=Fq.single(t);try{return await this._sendMessage(n,!1),!0}catch(r){this.log.error("could not send flag %s",e.toString(),r)}return!1}}function Nhe(e){const{channel:t,direction:n}=e;return new Ohe({id:"inbound"===n?"i".concat(t.id):"r".concat(t.id),log:aH("libp2p:webrtc:stream:".concat(n,":").concat(t.id)),...e})}const Bhe=aH("libp2p:webrtc:muxer"),Lhe="/webrtc";class Mhe{constructor(e){var t,n;(0,Yo.Z)(this,"protocol",void 0),(0,Yo.Z)(this,"peerConnection",void 0),(0,Yo.Z)(this,"bufferedStreams",[]),(0,Yo.Z)(this,"metrics",void 0),(0,Yo.Z)(this,"dataChannelOptions",void 0),this.peerConnection=e.peerConnection,this.metrics=e.metrics,this.protocol=null!==(t=e.protocol)&&void 0!==t?t:Lhe,this.dataChannelOptions=null!==(n=e.dataChannelOptions)&&void 0!==n?n:{},this.peerConnection.ondatachannel=e=>{let{channel:t}=e;const n={},r=Nhe({channel:t,direction:"inbound",onEnd:e=>{n.onEnd(e)},...this.dataChannelOptions});n.stream=r,n.channel=t,n.onEnd=()=>{this.bufferedStreams=this.bufferedStreams.filter((e=>e.stream.id!==r.id))},this.bufferedStreams.push(n)}}createStreamMuxer(e){return new Fhe({...e,peerConnection:this.peerConnection,dataChannelOptions:this.dataChannelOptions,metrics:this.metrics,streams:this.bufferedStreams,protocol:this.protocol})}}var Uhe=new WeakSet;class Fhe{constructor(e){var t,n;Qd(this,Uhe),(0,Yo.Z)(this,"init",void 0),(0,Yo.Z)(this,"streams",void 0),(0,Yo.Z)(this,"protocol",void 0),(0,Yo.Z)(this,"peerConnection",void 0),(0,Yo.Z)(this,"dataChannelOptions",void 0),(0,Yo.Z)(this,"metrics",void 0),(0,Yo.Z)(this,"source",Ihe()),(0,Yo.Z)(this,"sink",Che),this.init=e,this.streams=e.streams.map((e=>e.stream)),this.peerConnection=e.peerConnection,this.protocol=null!==(t=e.protocol)&&void 0!==t?t:Lhe,this.metrics=e.metrics,this.dataChannelOptions=null!==(n=e.dataChannelOptions)&&void 0!==n?n:{},this.peerConnection.ondatachannel=t=>{var n,r;let{channel:i}=t;const o=Nhe({channel:i,direction:"inbound",onEnd:()=>{Yd(this,Uhe,Khe).call(this,o,i)},...this.dataChannelOptions});this.streams.push(o),null===(n=this.metrics)||void 0===n||n.increment({incoming_stream:!0}),null===e||void 0===e||null===(r=e.onIncomingStream)||void 0===r||r.call(e,o)},this.init.streams.length>0&&queueMicrotask((()=>{this.init.streams.forEach((e=>{var t,n,r;e.onEnd=()=>{Yd(this,Uhe,Khe).call(this,e.stream,e.channel)},null===(t=this.metrics)||void 0===t||t.increment({incoming_stream:!0}),null===(n=this.init)||void 0===n||null===(r=n.onIncomingStream)||void 0===r||r.call(n,e.stream)}))}))}async close(e){try{await Promise.all(this.streams.map((async t=>t.close(e))))}catch(t){this.abort(t)}}abort(e){for(const t of this.streams)t.abort(e)}newStream(){var e;const t=this.peerConnection.createDataChannel(""),n=Nhe({channel:t,direction:"outbound",onEnd:()=>{Yd(this,Uhe,Khe).call(this,n,t)},...this.dataChannelOptions});return this.streams.push(n),null===(e=this.metrics)||void 0===e||e.increment({outgoing_stream:!0}),n}}function Khe(e,t){var n,r,i;Bhe.trace("stream %s %s %s onEnd",e.direction,e.id,e.protocol),function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:The;"open"===e.readyState&&Promise.resolve().then((async()=>{if(e.bufferedAmount>0){Ahe("%s drain channel with %d buffered bytes",t,e.bufferedAmount);const r=Ws();let i=!1;e.bufferedAmountLowThreshold=0;const o=()=>{i||(Ahe("%s drain channel closed before drain",t),r.resolve())};e.addEventListener("close",o,{once:!0}),e.addEventListener("bufferedamountlow",(()=>{i=!0,e.removeEventListener("close",o),r.resolve()})),await YB(r.promise,{milliseconds:n})}})).then((async()=>{"open"===e.readyState&&e.close()})).catch((e=>{Ahe.error("error closing outbound stream",e)}))}(t,"".concat(e.direction," ").concat(e.id," ").concat(e.protocol),this.dataChannelOptions.drainTimeout),this.streams=this.streams.filter((t=>t.id!==e.id)),null===(n=this.metrics)||void 0===n||n.increment({stream_end:!0}),null===(r=this.init)||void 0===r||null===(i=r.onStreamEnd)||void 0===i||i.call(r,e)}const jhe=globalThis.RTCPeerConnection,Zhe=globalThis.RTCSessionDescription,zhe=globalThis.RTCIceCandidate;var Vhe;!function(e){let t,n,r;!function(e){e.SDP_OFFER="SDP_OFFER",e.SDP_ANSWER="SDP_ANSWER",e.ICE_CANDIDATE="ICE_CANDIDATE"}(t=e.Type||(e.Type={})),function(e){e[e.SDP_OFFER=0]="SDP_OFFER",e[e.SDP_ANSWER=1]="SDP_ANSWER",e[e.ICE_CANDIDATE=2]="ICE_CANDIDATE"}(n||(n={})),function(e){e.codec=()=>bs(n)}(t=e.Type||(e.Type={})),e.codec=()=>(null==r&&(r=ws((function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==r.lengthDelimited&&n.fork(),null!=t.type&&(n.uint32(8),e.Type.codec().encode(t.type,n)),null!=t.data&&(n.uint32(18),n.string(t.data)),!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.type=e.Type.codec().decode(t);break;case 2:r.data=t.string();break;default:t.skipType(7&n)}}return r}))),r),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(Vhe||(Vhe={}));const Hhe=aH("libp2p:webrtc:peer:util"),qhe=async(e,t,n,r)=>{var i;const o=new AbortController;e.promise.then((()=>{o.abort()}),(()=>{o.abort()}));const s=SH([o.signal,r.signal]),a=fF(n.unwrap().unwrap().source,s,{returnOnAbort:!0});try{for await(const e of Zq(a)){var c;const n=Vhe.decode(e);if(n.type!==Vhe.Type.ICE_CANDIDATE)throw new aq("ICE candidate message expected","ERR_NOT_ICE_CANDIDATE");let i=JSON.parse(null!==(c=n.data)&&void 0!==c?c:"null");""===i&&(Hhe.trace("end-of-candidates for this generation received"),i={candidate:"",sdpMid:"0",sdpMLineIndex:0}),null===i&&(Hhe.trace("end-of-candidates received"),i={candidate:null,sdpMid:"0",sdpMLineIndex:0});const o=new zhe(i);Hhe.trace("%s received new ICE candidate",r.direction,o);try{await t.addIceCandidate(o)}catch(l){Hhe.error("%s bad candidate received",r.direction,l)}}}catch(l){Hhe.error("%s error parsing ICE candidate",r.direction,l)}finally{s.clear()}if(!0===(null===(i=r.signal)||void 0===i?void 0:i.aborted))throw new Qs("Aborted while reading ICE candidates","ERR_ICE_CANDIDATES_READ_ABORTED");await Ys(e.promise,r.signal,{errorMessage:"Aborted before connected",errorCode:"ERR_ABORTED_BEFORE_CONNECTED"})};function Ghe(e,t){e[_he?"oniceconnectionstatechange":"onconnectionstatechange"]=n=>{switch(Hhe.trace("receiver peerConnectionState state change: %s",e.connectionState),_he?e.iceConnectionState:e.connectionState){case"connected":t.resolve();break;case"failed":case"disconnected":case"closed":t.reject(new aq("RTCPeerConnection was closed","ERR_CONNECTION_CLOSED_BEFORE_CONNECTED"))}}}const Whe=aH("libp2p:webrtc:initiate-connection");async function Qhe(e){let{peerConnection:t,signal:n,metrics:r,multiaddr:i,connectionManager:o,transportManager:s}=e;const{baseAddr:a}=function(e){const t=e.toString().split($he+"/");if(2!==t.length)throw new aq("webrtc protocol was not present in multiaddr",uhe.ERR_INVALID_MULTIADDR);if(!t[0].includes(ede))throw new aq("p2p-circuit protocol was not present in multiaddr",uhe.ERR_INVALID_MULTIADDR);let n=(0,ng.HM)(t[0]);const r=(0,ng.HM)("/"+t[1]).getPeerId();if(null==r)throw new aq("destination peer id was missing",uhe.ERR_INVALID_MULTIADDR);const i=n.protos().pop();if(void 0===i)throw new aq("invalid multiaddr",uhe.ERR_INVALID_MULTIADDR);"p2p"!==i.name&&(n=n.encapsulate("/p2p/".concat(r)));return{baseAddr:n,peerId:X0(r)}}(i);null===r||void 0===r||r.dialerEvents.increment({open:!0}),Whe.trace("dialing base address: %a",a);const c=a.getPeerId();if(null==c)throw new aq("Relay peer was missing","ERR_INVALID_ADDRESS");const l=o.getConnections(X0(c));let u,h=!1;0===l.length?(u=await s.dial(a,{signal:n}),h=!0):u=l[0];try{const e=await u.newStream(tde,{signal:n,runOnTransientConnection:!0}),r=rk(e).pb(Vhe),o=Ws(),s=()=>{o.reject(new aq("SDP handshake aborted","ERR_SDP_HANDSHAKE_ABORTED"))};try{Ghe(t,o),null===n||void 0===n||n.addEventListener("abort",s);const e=t.createDataChannel("init");t.onicecandidate=e=>{var t;let{candidate:i}=e;const o=JSON.stringify(null!==(t=null===i||void 0===i?void 0:i.toJSON())&&void 0!==t?t:null);Whe.trace("initiator sending ICE candidate %s",o),r.write({type:Vhe.Type.ICE_CANDIDATE,data:o},{signal:n}).catch((e=>{Whe.error("error sending ICE candidate",e)}))},t.onicecandidateerror=e=>{Whe("initiator ICE candidate error",e)};const a=await t.createOffer();Whe.trace("initiator send SDP offer %s",a.sdp),await r.write({type:Vhe.Type.SDP_OFFER,data:a.sdp},{signal:n}),await t.setLocalDescription(a).catch((e=>{throw Whe.error("could not execute setLocalDescription",e),new aq("Failed to set localDescription","ERR_SDP_HANDSHAKE_FAILED")}));const c=await r.read({signal:n});if(c.type!==Vhe.Type.SDP_ANSWER)throw new aq("remote should send an SDP answer","ERR_SDP_HANDSHAKE_FAILED");Whe.trace("initiator receive SDP answer %s",c.data);const l=new Zhe({type:"answer",sdp:c.data});return await t.setRemoteDescription(l).catch((e=>{throw Whe.error("could not execute setRemoteDescription",e),new aq("Failed to set remoteDescription","ERR_SDP_HANDSHAKE_FAILED")})),Whe.trace("initiator read candidates until connected"),await qhe(o,t,r,{direction:"initiator",signal:n}),Whe.trace("initiator connected, closing init channel"),e.close(),Whe.trace("initiator closing signalling stream"),await r.unwrap().unwrap().close({signal:n}),Whe.trace("initiator connected to remote address %s",i),{remoteAddress:i}}catch(d){throw t.close(),e.abort(d),d}finally{null===n||void 0===n||n.removeEventListener("abort",s),t.onicecandidate=null,t.onicecandidateerror=null}}finally{if(h)try{await u.close({signal:n})}catch(d){u.abort(d)}}}class Yhe extends lJ{constructor(e,t){super(),(0,Yo.Z)(this,"peerId",void 0),(0,Yo.Z)(this,"transportManager",void 0),(0,Yo.Z)(this,"shutdownController",void 0),this.peerId=e.peerId,this.transportManager=e.transportManager,this.shutdownController=t.shutdownController}async listen(){this.safeDispatchEvent("listening",{})}getAddrs(){return this.transportManager.getListeners().filter((e=>e!==this)).map((e=>e.getAddrs().filter((e=>Qx.matches(e))).map((e=>e.encapsulate("/webrtc/p2p/".concat(this.peerId)))))).flat()}async close(){this.shutdownController.abort(),this.safeDispatchEvent("close",{})}}const Jhe=aH("libp2p:webrtc:signaling-stream-handler");const Xhe=aH("libp2p:webrtc:peer"),$he="/webrtc",ede="/p2p-circuit",tde="/webrtc-signaling/0.0.1";class nde{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,Yo.Z)(this,"components",void 0),(0,Yo.Z)(this,"init",void 0),(0,Yo.Z)(this,"_started",!1),(0,Yo.Z)(this,"metrics",void 0),(0,Yo.Z)(this,"shutdownController",void 0),(0,Yo.Z)(this,Symbol.toStringTag,"@libp2p/webrtc"),(0,Yo.Z)(this,H3,!0),this.components=e,this.init=t,this.shutdownController=new AbortController,null!=e.metrics&&(this.metrics={dialerEvents:e.metrics.registerCounterGroup("libp2p_webrtc_dialer_events_total",{label:"event",help:"Total count of WebRTC dialer events by type"}),listenerEvents:e.metrics.registerCounterGroup("libp2p_webrtc_listener_events_total",{label:"event",help:"Total count of WebRTC listener events by type"})})}isStarted(){return this._started}async start(){await this.components.registrar.handle(tde,(e=>{this._onProtocol(e).catch((t=>{Xhe.error("failed to handle incoming connect from %p",e.connection.remotePeer,t)}))}),{runOnTransientConnection:!0}),this._started=!0}async stop(){await this.components.registrar.unhandle(tde),this._started=!1}createListener(e){return new Yhe(this.components,{shutdownController:this.shutdownController})}filter(e){return e.filter(tO.uF.exactMatch)}async dial(e,t){var n;Xhe.trace("dialing address: %a",e);const r=new jhe(this.init.rtcConfiguration),i=new Mhe({peerConnection:r,dataChannelOptions:this.init.dataChannel}),{remoteAddress:o}=await Qhe({peerConnection:r,multiaddr:e,dataChannelOptions:this.init.dataChannel,signal:t.signal,connectionManager:this.components.connectionManager,transportManager:this.components.transportManager}),s=new Rhe({peerConnection:r,timeline:{open:Date.now()},remoteAddr:o,metrics:null===(n=this.metrics)||void 0===n?void 0:n.dialerEvents}),a=await t.upgrader.upgradeOutbound(s,{skipProtection:!0,skipEncryption:!0,muxerFactory:i});return this._closeOnShutdown(r,s),a}async _onProtocol(e){var t;let{connection:n,stream:r}=e;const i=AbortSignal.timeout(null!==(t=this.init.inboundConnectionTimeout)&&void 0!==t?t:3e4),o=new jhe(this.init.rtcConfiguration),s=new Mhe({peerConnection:o,dataChannelOptions:this.init.dataChannel});try{var a;const{remoteAddress:e}=await async function(e){let{peerConnection:t,stream:n,signal:r,connection:i}=e;Jhe.trace("new inbound signaling stream");const o=rk(n).pb(Vhe);try{const e=Ws(),n=Ws();r.onabort=()=>{e.reject(new aq("Timed out while trying to connect","ERR_TIMEOUT"))},t.onicecandidate=t=>{let{candidate:i}=t;n.promise.then((async()=>{var e;const t=JSON.stringify(null!==(e=null===i||void 0===i?void 0:i.toJSON())&&void 0!==e?e:null);Jhe.trace("recipient sending ICE candidate %s",t),await o.write({type:Vhe.Type.ICE_CANDIDATE,data:t},{signal:r})}),(t=>{Jhe.error("cannot set candidate since sending answer failed",t),e.reject(t)}))},Ghe(t,e);const i=await o.read({signal:r});var s;if(i.type!==Vhe.Type.SDP_OFFER)throw new aq("expected message type SDP_OFFER, received: ".concat(null!==(s=i.type)&&void 0!==s?s:"undefined"," "),"ERR_SDP_HANDSHAKE_FAILED");Jhe.trace("recipient receive SDP offer %s",i.data);const a=new Zhe({type:"offer",sdp:i.data});await t.setRemoteDescription(a).catch((e=>{throw Jhe.error("could not execute setRemoteDescription",e),new aq("Failed to set remoteDescription","ERR_SDP_HANDSHAKE_FAILED")}));const c=await t.createAnswer().catch((e=>{throw Jhe.error("could not execute createAnswer",e),n.reject(e),new aq("Failed to create answer","ERR_SDP_HANDSHAKE_FAILED")}));Jhe.trace("recipient send SDP answer %s",c.sdp),await o.write({type:Vhe.Type.SDP_ANSWER,data:c.sdp},{signal:r}),await t.setLocalDescription(c).catch((e=>{throw Jhe.error("could not execute setLocalDescription",e),n.reject(e),new aq("Failed to set localDescription","ERR_SDP_HANDSHAKE_FAILED")})),n.resolve(),Jhe.trace("recipient read candidates until connected"),await qhe(e,t,o,{direction:"recipient",signal:r}),Jhe.trace("recipient connected, closing signaling stream"),await o.unwrap().unwrap().close({signal:r})}catch(c){if("connected"!==t.connectionState)throw Jhe.error("error while handling signaling stream from peer %a",i.remoteAddr,c),t.close(),c;Jhe("error while handling signaling stream from peer %a, ignoring as the RTCPeerConnection is already connected",i.remoteAddr,c)}const a=(0,ng.HM)("/webrtc/p2p/".concat(i.remoteAddr.getPeerId()));return Jhe.trace("recipient connected to remote address %s",a),{remoteAddress:a}}({peerConnection:o,connection:n,stream:r,signal:i}),t=new Rhe({peerConnection:o,timeline:{open:(new Date).getTime()},remoteAddr:e,metrics:null===(a=this.metrics)||void 0===a?void 0:a.listenerEvents});this._closeOnShutdown(o,t),await this.components.upgrader.upgradeInbound(t,{skipEncryption:!0,skipProtection:!0,muxerFactory:s}),await r.close({signal:i})}catch(c){throw r.abort(c),c}}_closeOnShutdown(e,t){const n=()=>{t.close().catch((e=>{Xhe.error("could not close WebRTCMultiaddrConnection",e)}))};this.shutdownController.signal.addEventListener("abort",n),e.addEventListener("close",(()=>{this.shutdownController.signal.removeEventListener("abort",n)}))}}const rde=aH("libp2p:webrtc:sdp"),ide=Object.values(Z0).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)));function ode(e){var t;const n=null===(t=e.getConfiguration().certificates)||void 0===t?void 0:t.at(0);if(null==n||null==n.getFingerprints){rde.trace("fetching fingerprint from local SDP");const t=e.localDescription;if(null==t)return;return function(e){var t;const n=e.match(sde);return null===n||void 0===n||null===(t=n.groups)||void 0===t?void 0:t.fingerprint}(t.sdp)}if(rde.trace("fetching fingerprint from local certificate"),0===n.getFingerprints().length)return;const r=n.getFingerprints()[0].value;if(null==r)throw bhe("","no fingerprint on local certificate");return r}const sde=/^a=fingerprint:(?:\w+-[0-9]+)\s(?<fingerprint>(:?[0-9a-fA-F]{2})+)$/m;function ade(e){const t=e.stringTuples().filter((e=>e[0]===fde)).map((e=>e[1]))[0];if(void 0===t||""===t)throw ghe("Couldn't find a certhash component of multiaddr: ".concat(e.toString()));return t}function cde(e){const t=ide.decode(e);return SU.decode(t)}function lde(e){switch(e){case"sha1":return"sha-1";case"sha2-256":return"sha-256";case"sha2-512":return"sha-512";default:throw new Ehe(e)}}function ude(e,t){const{host:n,port:r}=e.toOptions(),i=function(e){for(const t of e.protoNames())if(t.startsWith("ip"))return t.toUpperCase();return rde("Warning: multiaddr does not appear to contain IP4 or IP6, defaulting to IP6",e),"IP6"}(e),[o]=function(e){const t=cde(ade(e)),n=lde(t.name),r=t.digest.reduce(((e,t)=>e+t.toString(16).padStart(2,"0")),""),i=r.match(/.{1,2}/g);if(null==i)throw bhe(r,e.toString());return["".concat(n.toUpperCase()," ").concat(i.join(":").toUpperCase()),r]}(e);return"v=0\no=- 0 0 IN ".concat(i," ").concat(n,"\ns=-\nc=IN ").concat(i," ").concat(n,"\nt=0 0\na=ice-lite\nm=application ").concat(r," UDP/DTLS/SCTP webrtc-datachannel\na=mid:0\na=setup:passive\na=ice-ufrag:").concat(t,"\na=ice-pwd:").concat(t,"\na=fingerprint:").concat(o,"\na=sctp-port:5000\na=max-message-size:16384\na=candidate:1467250027 1 UDP 1467250027 ").concat(n," ").concat(r," typ host\r\n")}const hde=Array.from("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),dde=aH("libp2p:webrtc:transport"),fde=((0,ng.a_)("webrtc-direct").code,(0,ng.a_)("certhash").code);class pde{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,Yo.Z)(this,"metrics",void 0),(0,Yo.Z)(this,"components",void 0),(0,Yo.Z)(this,"init",void 0),(0,Yo.Z)(this,Symbol.toStringTag,"@libp2p/webrtc-direct"),(0,Yo.Z)(this,H3,!0),this.components=e,this.init=t,null!=e.metrics&&(this.metrics={dialerEvents:e.metrics.registerCounterGroup("libp2p_webrtc-direct_dialer_events_total",{label:"event",help:"Total count of WebRTC-direct dial events by type"})})}async dial(e,t){const n=await this._connect(e,t);return dde("dialing address: %a",e),n}createListener(e){throw new whe("WebRTCTransport.createListener")}filter(e){return e.filter(tO.Ih.exactMatch)}async _connect(e,t){const n=new AbortController,r=n.signal,i=e.getPeerId();if(null===i)throw ghe("we need to have the remote's PeerId");const o=X0(i),s=cde(ade(e)),a=await jhe.generateCertificate({name:"ECDSA",namedCurve:"P-256",hash:lde(s.name)}),c=new jhe({certificates:[a]});try{var l,u,h,d;const i=new Promise(((e,t)=>{const n=c.createDataChannel("",{negotiated:!0,id:0}),r=setTimeout((()=>{var e;const r="Data channel was never opened: state: ".concat(n.readyState);dde.error(r),null===(e=this.metrics)||void 0===e||e.dialerEvents.increment({open_error:!0}),t(fhe("data",r))}),1e4);n.onopen=t=>{clearTimeout(r),e(n)},n.onerror=e=>{var n,i,o;clearTimeout(r);const s=null!==(n=null===(i=e.target)||void 0===i?void 0:i.toString())&&void 0!==n?n:"not specified",a="Error opening a data channel for handshaking: ".concat(s);dde.error(a),null===(o=this.metrics)||void 0===o||o.dialerEvents.increment({unknown_error:!0}),t(fhe("data",a))}})),a="libp2p+webrtc+v1/"+[...Array(32)].map((()=>hde.at(Math.floor(Math.random()*hde.length)))).join(""),f=function(e,t){if(void 0===e.sdp)throw mhe("Can't munge a missing SDP");return e.sdp=e.sdp.replace(/\na=ice-ufrag:[^\n]*\n/,"\na=ice-ufrag:"+t+"\n").replace(/\na=ice-pwd:[^\n]*\n/,"\na=ice-pwd:"+t+"\n"),e}(await c.createOffer(),a);await c.setLocalDescription(f);const p=function(e,t){return{type:"answer",sdp:ude(e,t)}}(e,a);await c.setRemoteDescription(p);const g=await i,y=this.components.peerId,m=Cne({prologueBytes:this.generateNoisePrologue(c,s.code,e)})(),v=Nhe({channel:g,direction:"inbound",...null!==(l=this.init.dataChannel)&&void 0!==l?l:{}}),b={...v,sink:v.sink.bind(v),source:async function*(){for await(const e of v.source)for(const t of e)yield t}()},w=new Rhe({peerConnection:c,remoteAddr:e,timeline:{open:Date.now()},metrics:null===(u=this.metrics)||void 0===u?void 0:u.dialerEvents}),E=_he?"iceconnectionstatechange":"connectionstatechange";c.addEventListener(E,(()=>{switch(c.connectionState){case"failed":case"disconnected":case"closed":w.close().catch((e=>{dde.error("error closing connection",e)})).finally((()=>{n.abort()}))}}),{signal:r}),null===(h=this.metrics)||void 0===h||h.dialerEvents.increment({peer_connection:!0});const A=new Mhe({peerConnection:c,metrics:null===(d=this.metrics)||void 0===d?void 0:d.dialerEvents,dataChannelOptions:this.init.dataChannel});return await m.secureInbound(y,b,o),await t.upgrader.upgradeOutbound(w,{skipProtection:!0,skipEncryption:!0,muxerFactory:A})}catch(f){throw c.close(),f}}generateNoisePrologue(e,t,n){var r;if(0===(null===(r=e.getConfiguration().certificates)||void 0===r?void 0:r.length))throw mhe("no local certificate");const i=ode(e);if(null==i)throw mhe("no local fingerprint found");const o=i.trim().toLowerCase().replaceAll(":",""),s=(0,yu.m)(o,"hex"),a=SU.encode(s,t),c=ide.decode(ade(n)),l=(0,yu.m)("libp2p-webrtc-noise:");return(0,Ls.z)([l,a,c])}}function gde(e){return t=>new pde(t,e)}const yde=aH("libp2p:webtransport:stream");async function mde(e,t,n,r,i){const o=e.writable.getWriter(),s=e.readable.getReader();function a(){const e=r.findIndex((e=>e===h));-1!==e&&(r.splice(e,1),h.timeline.close=Date.now(),null===i||void 0===i||i(h))}await o.ready;let c=!1,l=!1;(async function(){const e=await o.closed.catch((e=>e));if(null!=e){const n=e.message;n.includes("aborted by the remote server")||n.includes("STOP_SENDING")||yde.error("WebTransport writer closed unexpectedly: streamId=".concat(t," err=").concat(e.message))}c=!0,c&&l&&a()})().catch((()=>{yde.error("WebTransport failed to cleanup closed stream")})),async function(){const e=await s.closed.catch((e=>e));null!=e&&yde.error("WebTransport reader closed unexpectedly: streamId=".concat(t," err=").concat(e.message)),l=!0,c&&l&&a()}().catch((()=>{yde.error("WebTransport failed to cleanup closed stream")}));let u=!1;const h={id:t,status:"open",writeStatus:"ready",readStatus:"ready",abort(e){c||(o.abort(e).catch((e=>{yde.error("could not abort stream",e)})),c=!0),l=!0,this.status="aborted",this.writeStatus="closed",this.readStatus="closed",this.timeline.reset=this.timeline.close=this.timeline.closeRead=this.timeline.closeWrite=Date.now(),a()},async close(e){this.status="closing",await Promise.all([h.closeRead(e),h.closeWrite(e)]),a(),this.status="closed",this.timeline.close=Date.now()},async closeRead(e){if(!l){this.readStatus="closing";try{await s.cancel()}catch(t){!0===t.toString().includes("RESET_STREAM")&&(c=!0)}this.timeline.closeRead=Date.now(),this.readStatus="closed",l=!0}c&&a()},async closeWrite(e){if(!c){c=!0,this.writeStatus="closing";try{await o.close()}catch(t){!0===t.toString().includes("RESET_STREAM")&&(l=!0)}this.timeline.closeWrite=Date.now(),this.writeStatus="closed"}l&&a()},direction:n,timeline:{open:Date.now()},metadata:{},source:async function*(){for(;;){const e=await s.read();if(e.done)return l=!0,void(c&&a());yield new Zs(e.value)}}(),sink:async function(e){if(u)throw new Error("sink already called on stream");u=!0;try{this.writeStatus="writing";for await(const t of e)if(t instanceof Uint8Array)await o.write(t);else for(const e of t)await o.write(e);this.writeStatus="done"}finally{this.timeline.closeWrite=Date.now(),this.writeStatus="closed",await h.closeWrite()}}};return h}function vde(){return{source:{[Symbol.asyncIterator]:()=>({next:async()=>new Promise((()=>{}))})},sink:async e=>new Promise((()=>{}))}}const bde=Object.values(Z0).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)));function wde(e){var t;if(!tO.Mk.matches(e))throw new aq("Invalid multiaddr, was not a WebTransport address","ERR_INVALID_MULTIADDR");const n=e.stringTuples(),r=n.filter((e=>{let[t,n]=e;return t===(0,ng.a_)("certhash").code})).map((e=>{let[t,n]=e;return r=null!==n&&void 0!==n?n:"",HH(bde.decode(r));var r})),i=n.filter((e=>{let[t,n]=e;return t===(0,ng.a_)("p2p").code})).map((e=>{let[t,n]=e;return X0(null!==n&&void 0!==n?n:"")}))[0],o=e.toOptions();let s=o.host;return 6===o.family&&null!==(t=s)&&void 0!==t&&t.includes(":")&&(s="[".concat(s,"]")),{url:"https://".concat(s,":").concat(o.port),certhashes:r,remotePeer:i}}const Ede=aH("libp2p:webtransport");class Ade{constructor(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,Yo.Z)(this,"components",void 0),(0,Yo.Z)(this,"config",void 0),(0,Yo.Z)(this,"metrics",void 0),(0,Yo.Z)(this,Symbol.toStringTag,"@libp2p/webtransport"),(0,Yo.Z)(this,H3,!0),this.components=e,this.config={maxInboundStreams:null!==(t=n.maxInboundStreams)&&void 0!==t?t:1e3},null!=e.metrics&&(this.metrics={dialerEvents:e.metrics.registerCounterGroup("libp2p_webtransport_dialer_events_total",{label:"event",help:"Total count of WebTransport dialer events by type"})})}async dial(e,t){var n,r,i;null===(n=t)||void 0===n||null===(r=n.signal)||void 0===r||r.throwIfAborted(),Ede("dialing %s",e);const o=this.components.peerId;if(void 0===o)throw new Error("Need a local peerid");t=null!==(i=t)&&void 0!==i?i:{};const{url:s,certhashes:a,remotePeer:c}=wde(e);if(null==c)throw new Error("Need a target peerid");if(0===a.length)throw new Error("Expected multiaddr to contain certhashes");let l,u,h=()=>{},d=!1,f=!1,p=!1;try{var g,y,m,v;null===(g=this.metrics)||void 0===g||g.dialerEvents.increment({pending:!0});const n=new WebTransport("".concat(s,"/.well-known/libp2p-webtransport?type=noise"),{serverCertificateHashes:a.map((e=>({algorithm:"sha-256",value:e.digest})))});if(h=e=>{if(!d)try{var t;null===(t=this.metrics)||void 0===t||t.dialerEvents.increment({[e]:!0}),n.close()}catch(r){Ede.error("error closing wt session",r)}finally{null!=u&&(u.timeline.close=Date.now()),d=!0}},l=()=>{h(f?"noise_timeout":"ready_timeout")},null===(y=t.signal)||void 0===y||y.addEventListener("abort",l,{once:!0}),await Promise.race([n.closed,n.ready]),f=!0,null===(m=this.metrics)||void 0===m||m.dialerEvents.increment({ready:!0}),n.closed.catch((e=>{Ede.error("error on remote wt session close",e)})).finally((()=>{h("remote_close")})),!await this.authenticateWebTransport(n,o,c,a))throw new Error("Failed to authenticate webtransport");return null===(v=this.metrics)||void 0===v||v.dialerEvents.increment({open:!0}),u={close:async()=>{Ede("Closing webtransport"),h("close")},abort:e=>{Ede("aborting webtransport due to passed err",e),h("abort")},remoteAddr:e,timeline:{open:Date.now()},...vde()},p=!0,await t.upgrader.upgradeOutbound(u,{skipEncryption:!0,muxerFactory:this.webtransportMuxer(n),skipProtection:!0})}catch(w){throw Ede.error("caught wt session err",w),h(p?"upgrade_error":f?"noise_error":"ready_error"),w}finally{var b;if(null!=l)null===(b=t.signal)||void 0===b||b.removeEventListener("abort",l)}}async authenticateWebTransport(e,t,n,r){var i;const o=await e.createBidirectionalStream(),s=o.writable.getWriter(),a=o.readable.getReader();await s.ready;const c={source:async function*(){for(;;){const e=await a.read();if(null!=e.value&&(yield e.value),e.done)break}}(),sink:async function(e){for await(const t of e)await s.write(t)}},l=Cne()(),{remoteExtensions:u}=await l.secureOutbound(t,c,n);if(s.close().catch((e=>{Ede.error("Failed to close authentication stream writer: ".concat(e.message))})),a.cancel().catch((e=>{Ede.error("Failed to close authentication stream reader: ".concat(e.message))})),h=null!==(i=null===u||void 0===u?void 0:u.webtransportCerthashes)&&void 0!==i?i:[],(d=r.map((e=>e.bytes))).filter((e=>Boolean(h.find((t=>(0,Ms.f)(e,t)))))).length!==d.length)throw new Error("Our certhashes are not a subset of the remote's reported certhashes");var h,d;return!0}webtransportMuxer(e){let t=0;const n=this.config;return{protocol:"webtransport",createStreamMuxer:r=>{"function"===typeof r&&(r={onIncomingStream:r});const i=[];(async function(){const o=e.incomingBidirectionalStreams.getReader();for(;;){const{done:e,value:u}=await o.read();if(e)break;if(i.length>=n.maxInboundStreams)u.writable.close().catch((e=>{Ede.error("Failed to close inbound stream that crossed our maxInboundStream limit: ".concat(e.message))})),u.readable.cancel().catch((e=>{Ede.error("Failed to close inbound stream that crossed our maxInboundStream limit: ".concat(e.message))}));else{var s,a,c,l;const e=await mde(u,String(t++),"inbound",i,null===(s=r)||void 0===s?void 0:s.onStreamEnd);i.push(e),null===(a=r)||void 0===a||null===(c=(l=a).onIncomingStream)||void 0===c||c.call(l,e)}}})().catch((()=>{Ede.error("WebTransport failed to receive incoming stream")}));return{protocol:"webtransport",streams:i,newStream:async n=>{var o,s,a;const c=await e.createBidirectionalStream(),l=await mde(c,String(t++),null!==(o=null===(s=r)||void 0===s?void 0:s.direction)&&void 0!==o?o:"outbound",i,null===(a=r)||void 0===a?void 0:a.onStreamEnd);return i.push(l),l},close:async e=>{Ede("Closing webtransport muxer"),await Promise.all(i.map((async t=>t.close(e))))},abort:e=>{Ede("Aborting webtransport muxer with err:",e);for(const t of i)t.abort(e)},...vde()}}}}createListener(e){throw new Error("Webtransport servers are not supported in Node or the browser")}filter(e){return e.filter(tO.Mk.exactMatch)}}function Sde(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>new Ade(t,e)}const _de="ERR_UNRECOGNIZED_VALIDITY",Ide="ERR_SIGNATURE_VERIFICATION",Cde="ERR_UNRECOGNIZED_FORMAT",Tde="ERR_UNDEFINED_PARAMETER",kde="ERR_RECORD_TOO_LARGE";var Rde;!function(e){let t,n,r;!function(e){e.EOL="EOL"}(t=e.ValidityType||(e.ValidityType={})),function(e){e[e.EOL=0]="EOL"}(n||(n={})),function(e){e.codec=()=>bs(n)}(t=e.ValidityType||(e.ValidityType={})),e.codec=()=>(null==r&&(r=ws((function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==r.lengthDelimited&&n.fork(),null!=t.value&&(n.uint32(10),n.bytes(t.value)),null!=t.signatureV1&&(n.uint32(18),n.bytes(t.signatureV1)),null!=t.validityType&&(n.uint32(24),e.ValidityType.codec().encode(t.validityType,n)),null!=t.validity&&(n.uint32(34),n.bytes(t.validity)),null!=t.sequence&&(n.uint32(40),n.uint64(t.sequence)),null!=t.ttl&&(n.uint32(48),n.uint64(t.ttl)),null!=t.pubKey&&(n.uint32(58),n.bytes(t.pubKey)),null!=t.signatureV2&&(n.uint32(66),n.bytes(t.signatureV2)),null!=t.data&&(n.uint32(74),n.bytes(t.data)),!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.value=t.bytes();break;case 2:r.signatureV1=t.bytes();break;case 3:r.validityType=e.ValidityType.codec().decode(t);break;case 4:r.validity=t.bytes();break;case 5:r.sequence=t.uint64();break;case 6:r.ttl=t.uint64();break;case 7:r.pubKey=t.bytes();break;case 8:r.signatureV2=t.bytes();break;case 9:r.data=t.bytes();break;default:t.skipType(7&n)}}return r}))),r),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(Rde||(Rde={}));const xde=aH("ipns:utils"),Pde=(0,yu.m)("/ipns/");const Dde=async(e,t)=>{if(null==t||null==e){const e=new Error("one or more of the provided parameters are not defined");throw xde.error(e),Xo()(e,Tde)}let n;if(null!=t.pubKey){try{n=iJ(t.pubKey)}catch(r){throw xde.error(r),r}if(!(await e1(t.pubKey)).equals(e))throw Xo()(new Error("Embedded public key did not match PeerID"),"ERR_INVALID_EMBEDDED_KEY")}else null!=e.publicKey&&(n=iJ(e.publicKey));if(null!=n)return n;throw Xo()(new Error("no public key is available"),Tde)};function Ode(e){const t=Rde.decode(e);if(null!=t.sequence&&(t.sequence=BigInt(t.sequence)),null!=t.ttl&&(t.ttl=BigInt(t.ttl)),null==t.signatureV2||null==t.data)throw Xo()(new Error("missing data or signatureV2"),Ide);const n=Bde(t.data),r=Lde(n.Value);let i;try{i=Xg().fromDate(function(e){const t=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),n=String(e).trim().match(t);if(null==n)throw new Error("Invalid format");const r=parseInt(n[1],10),i=parseInt(n[2],10)-1,o=parseInt(n[3],10),s=parseInt(n[4],10),a=parseInt(n[5],10),c=parseInt(n[6],10),l=parseInt(n[7].padEnd(6,"0").slice(0,3),10);return new Date(Date.UTC(r,i,o,s,a,c,l))}((0,Au.B)(n.Validity)))}catch(o){throw xde.error("unrecognized validity format (not an rfc3339 format)"),Xo()(new Error("unrecognized validity format (not an rfc3339 format)"),Cde)}if(null!=t.value&&null!=t.signatureV1)return Mde(t),{value:r,validityType:Rde.ValidityType.EOL,validity:i,sequence:n.Sequence,ttl:n.TTL,pubKey:t.pubKey,signatureV1:t.signatureV1,signatureV2:t.signatureV2,data:t.data};if(null!=t.signatureV2)return{value:r,validityType:Rde.ValidityType.EOL,validity:i,sequence:n.Sequence,ttl:n.TTL,pubKey:t.pubKey,signatureV2:t.signatureV2,data:t.data};throw new Error("invalid record: does not include signatureV1 or signatureV2")}const Nde=e=>$0(e.slice(Pde.length)),Bde=e=>{const t=hQ(e);if(0!==t.ValidityType)throw Xo()(new Error("Unknown validity type"),_de);return t.ValidityType=Rde.ValidityType.EOL,Number.isInteger(t.Sequence)&&(t.Sequence=BigInt(t.Sequence)),Number.isInteger(t.TTL)&&(t.TTL=BigInt(t.TTL)),t},Lde=e=>{if(null!=e){if(P0(e))return"/ipns/".concat(e.toCID().toString(dQ));if(e instanceof Uint8Array){const t=(0,Au.B)(e);t.startsWith("/")&&(e=t)}const t=e.toString().trim();if(t.startsWith("/")&&t.length>1)return t;const n=YH.asCID(e);if(null!=n)return 114===n.code?"/ipns/".concat(n.toString(dQ)):"/ipfs/".concat(n.toV1().toString());try{return e instanceof Uint8Array?"/ipfs/".concat(YH.decode(e).toV1().toString()):"/ipfs/".concat(YH.parse(t).toV1().toString())}catch{}}throw Xo()(new Error("Value must be a valid content path starting with /"),"ERR_INVALID_VALUE")},Mde=e=>{var t,n;if(null==e.data)throw Xo()(new Error("Record data is missing"),"ERR_INVALID_RECORD_DATA");const r=Bde(e.data);if(!(0,Ms.f)(r.Value,null!==(t=e.value)&&void 0!==t?t:new Uint8Array(0)))throw Xo()(new Error('Field "value" did not match between protobuf and CBOR'),Ide);if(!(0,Ms.f)(r.Validity,null!==(n=e.validity)&&void 0!==n?n:new Uint8Array(0)))throw Xo()(new Error('Field "validity" did not match between protobuf and CBOR'),Ide);if(r.ValidityType!==e.validityType)throw Xo()(new Error('Field "validityType" did not match between protobuf and CBOR'),Ide);if(r.Sequence!==e.sequence)throw Xo()(new Error('Field "sequence" did not match between protobuf and CBOR'),Ide);if(r.TTL!==e.ttl)throw Xo()(new Error('Field "ttl" did not match between protobuf and CBOR'),Ide)};function Ude(e,t){const n=t.map(((e,t)=>({record:Ode(e),index:t})));return n.sort(((e,t)=>{const n=e.record.sequence,r=t.record.sequence;if(n>r)return-1;if(n<r)return 1;const i=e.record.validity.toDate(),o=t.record.validity.toDate();return i.getTime()>o.getTime()?-1:i.getTime()<o.getTime()?1:0})),n[0].index}const Fde=aH("ipns:validator"),Kde=10240,jde=async(e,t)=>{const n=Ode(t);let r;try{const t=(e=>{const t=(0,yu.m)("ipns-signature:");return(0,Ls.z)([t,e])})(n.data);r=await e.verify(t,n.signatureV2)}catch(i){r=!1}if(!r)throw Fde.error("record signature verification failed"),Xo()(new Error("record signature verification failed"),Ide);if(n.validityType===Rde.ValidityType.EOL){if(n.validity.toDate().getTime()<Date.now())throw Fde.error("record has expired"),Xo()(new Error("record has expired"),"ERR_IPNS_EXPIRED_RECORD")}else if(null!=n.validityType)throw Fde.error("unrecognized validity type"),Xo()(new Error("unrecognized validity type"),_de);Fde("ipns record for %b is valid",n.value)};async function Zde(e,t){if(t.byteLength>Kde)throw Xo()(new Error("record too large"),kde);const n=Nde(e),r=Ode(t),i=await Dde(n,r);await jde(i,t)}var zde;!function(e){let t,n,r,i,o,s,a,c;!function(e){e.DIAL="DIAL",e.DIAL_RESPONSE="DIAL_RESPONSE"}(t=e.MessageType||(e.MessageType={})),function(e){e[e.DIAL=0]="DIAL",e[e.DIAL_RESPONSE=1]="DIAL_RESPONSE"}(n||(n={})),function(e){e.codec=()=>bs(n)}(t=e.MessageType||(e.MessageType={})),function(e){e.OK="OK",e.E_DIAL_ERROR="E_DIAL_ERROR",e.E_DIAL_REFUSED="E_DIAL_REFUSED",e.E_BAD_REQUEST="E_BAD_REQUEST",e.E_INTERNAL_ERROR="E_INTERNAL_ERROR"}(r=e.ResponseStatus||(e.ResponseStatus={})),function(e){e[e.OK=0]="OK",e[e.E_DIAL_ERROR=100]="E_DIAL_ERROR",e[e.E_DIAL_REFUSED=101]="E_DIAL_REFUSED",e[e.E_BAD_REQUEST=200]="E_BAD_REQUEST",e[e.E_INTERNAL_ERROR=300]="E_INTERNAL_ERROR"}(i||(i={})),function(e){e.codec=()=>bs(i)}(r=e.ResponseStatus||(e.ResponseStatus={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==n.lengthDelimited&&t.fork(),null!=e.id&&(t.uint32(10),t.bytes(e.id)),null!=e.addrs)for(const r of e.addrs)t.uint32(18),t.bytes(r);!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={addrs:[]},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.id=e.bytes();break;case 2:n.addrs.push(e.bytes());break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(o=e.PeerInfo||(e.PeerInfo={})),function(t){let n;t.codec=()=>(null==n&&(n=ws((function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==r.lengthDelimited&&n.fork(),null!=t.peer&&(n.uint32(10),e.PeerInfo.codec().encode(t.peer,n)),!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();if(n>>>3===1)r.peer=e.PeerInfo.codec().decode(t,t.uint32());else t.skipType(7&n)}return r}))),n),t.encode=e=>fs(e,t.codec()),t.decode=e=>ds(e,t.codec())}(s=e.Dial||(e.Dial={})),function(t){let n;t.codec=()=>(null==n&&(n=ws((function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==r.lengthDelimited&&n.fork(),null!=t.status&&(n.uint32(8),e.ResponseStatus.codec().encode(t.status,n)),null!=t.statusText&&(n.uint32(18),n.string(t.statusText)),null!=t.addr&&(n.uint32(26),n.bytes(t.addr)),!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.status=e.ResponseStatus.codec().decode(t);break;case 2:r.statusText=t.string();break;case 3:r.addr=t.bytes();break;default:t.skipType(7&n)}}return r}))),n),t.encode=e=>fs(e,t.codec()),t.decode=e=>ds(e,t.codec())}(a=e.DialResponse||(e.DialResponse={})),e.codec=()=>(null==c&&(c=ws((function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==r.lengthDelimited&&n.fork(),null!=t.type&&(n.uint32(8),e.MessageType.codec().encode(t.type,n)),null!=t.dial&&(n.uint32(18),e.Dial.codec().encode(t.dial,n)),null!=t.dialResponse&&(n.uint32(26),e.DialResponse.codec().encode(t.dialResponse,n)),!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.type=e.MessageType.codec().decode(t);break;case 2:r.dial=e.Dial.codec().decode(t,t.uint32());break;case 3:r.dialResponse=e.DialResponse.codec().decode(t,t.uint32());break;default:t.skipType(7&n)}}return r}))),c),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(zde||(zde={}));const Vde=aH("libp2p:autonat");class Hde{constructor(e,t){var n,r,i,o,s,a;(0,Yo.Z)(this,"components",void 0),(0,Yo.Z)(this,"startupDelay",void 0),(0,Yo.Z)(this,"refreshInterval",void 0),(0,Yo.Z)(this,"protocol",void 0),(0,Yo.Z)(this,"timeout",void 0),(0,Yo.Z)(this,"maxInboundStreams",void 0),(0,Yo.Z)(this,"maxOutboundStreams",void 0),(0,Yo.Z)(this,"verifyAddressTimeout",void 0),(0,Yo.Z)(this,"started",void 0),this.components=e,this.started=!1,this.protocol="/".concat(null!==(n=t.protocolPrefix)&&void 0!==n?n:"libp2p","/").concat("autonat","/").concat("1.0.0"),this.timeout=null!==(r=t.timeout)&&void 0!==r?r:3e4,this.maxInboundStreams=null!==(i=t.maxInboundStreams)&&void 0!==i?i:1,this.maxOutboundStreams=null!==(o=t.maxOutboundStreams)&&void 0!==o?o:1,this.startupDelay=null!==(s=t.startupDelay)&&void 0!==s?s:5e3,this.refreshInterval=null!==(a=t.refreshInterval)&&void 0!==a?a:6e4,this._verifyExternalAddresses=this._verifyExternalAddresses.bind(this)}isStarted(){return this.started}async start(){this.started||(await this.components.registrar.handle(this.protocol,(e=>{this.handleIncomingAutonatStream(e).catch((e=>{Vde.error("error handling incoming autonat stream",e)}))}),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams}),this.verifyAddressTimeout=setTimeout(this._verifyExternalAddresses,this.startupDelay),this.started=!0)}async stop(){await this.components.registrar.unhandle(this.protocol),clearTimeout(this.verifyAddressTimeout),this.started=!1}async handleIncomingAutonatStream(e){const t=AbortSignal.timeout(this.timeout),n=()=>{e.stream.abort(new aq("handleIncomingAutonatStream timeout",s5.ERR_TIMEOUT))};t.addEventListener("abort",n,{once:!0}),dJ(1/0,t);const r=this.components.addressManager.getAddresses().map((e=>e.toOptions().host));try{const n=this;await Yq(e.stream,(e=>Zq(e)),(async function*(i){const o=await F5(i);if(null==o)return Vde("no message received"),void(yield zde.encode({type:zde.MessageType.DIAL_RESPONSE,dialResponse:{status:zde.ResponseStatus.E_BAD_REQUEST,statusText:"No message was sent"}}));let s;try{s=zde.decode(o)}catch(f){return Vde.error("could not decode message",f),void(yield zde.encode({type:zde.MessageType.DIAL_RESPONSE,dialResponse:{status:zde.ResponseStatus.E_BAD_REQUEST,statusText:"Could not decode message"}}))}const a=s.dial;if(null==a)return Vde.error("dial was missing from message"),void(yield zde.encode({type:zde.MessageType.DIAL_RESPONSE,dialResponse:{status:zde.ResponseStatus.E_BAD_REQUEST,statusText:"No Dial message found in message"}}));let c;const l=a.peer;if(null==l||null==l.id)return Vde.error("PeerId missing from message"),void(yield zde.encode({type:zde.MessageType.DIAL_RESPONSE,dialResponse:{status:zde.ResponseStatus.E_BAD_REQUEST,statusText:"missing peer info"}}));try{c=$0(l.id)}catch(f){return Vde.error("invalid PeerId",f),void(yield zde.encode({type:zde.MessageType.DIAL_RESPONSE,dialResponse:{status:zde.ResponseStatus.E_BAD_REQUEST,statusText:"bad peer id"}}))}if(Vde("incoming request from %p",c),!e.connection.remotePeer.equals(c))return Vde("target peer %p did not equal sending peer %p",c,e.connection.remotePeer),void(yield zde.encode({type:zde.MessageType.DIAL_RESPONSE,dialResponse:{status:zde.ResponseStatus.E_BAD_REQUEST,statusText:"peer id mismatch"}}));const u=l.addrs.map((e=>(0,ng.HM)(e))).filter((t=>{const n=t.toOptions().host===e.connection.remoteAddr.toOptions().host;return Vde.trace("request to dial %a was sent from %a is same host %s",t,e.connection.remoteAddr,n),n})).filter((e=>{var t;const n=e.toOptions().host,r=!(null!==(t=mS(n))&&void 0!==t&&t);return Vde.trace("host %s was public %s",n,r),r})).filter((e=>{const t=e.toOptions().host,n=!r.includes(t);return Vde.trace("host %s was not our host %s",t,n),n})).filter((e=>{const t=Boolean(n.components.transportManager.transportForMultiaddr(e));return Vde.trace("transport for %a is supported %s",e,t),t})).map((e=>(null==e.getPeerId()&&(e=e.encapsulate("/p2p/".concat(c.toString()))),e)));if(0===u.length)return Vde("no valid multiaddrs for %p in message",c),void(yield zde.encode({type:zde.MessageType.DIAL_RESPONSE,dialResponse:{status:zde.ResponseStatus.E_DIAL_REFUSED,statusText:"no dialable addresses"}}));Vde("dial multiaddrs %s for peer %p",u.map((e=>e.toString())).join(", "),c);let h="",d=u[0];for await(const e of u){let r;d=e;try{if(r=await n.components.connectionManager.openConnection(e,{signal:t}),!r.remoteAddr.equals(e))throw Vde.error("tried to dial %a but dialed %a",e,r.remoteAddr),new Error("Unexpected remote address");return Vde("Success %p",c),void(yield zde.encode({type:zde.MessageType.DIAL_RESPONSE,dialResponse:{status:zde.ResponseStatus.OK,addr:r.remoteAddr.decapsulateCode((0,ng.a_)("p2p").code).bytes}}))}catch(f){Vde("could not dial %p",c,f),h=f.message}finally{null!=r&&await r.close()}}yield zde.encode({type:zde.MessageType.DIAL_RESPONSE,dialResponse:{status:zde.ResponseStatus.E_DIAL_ERROR,statusText:h,addr:d.bytes}})}),(e=>Fq(e)),e.stream)}catch(i){Vde.error("error handling incoming autonat stream",i)}finally{t.removeEventListener("abort",n)}}_verifyExternalAddresses(){this.verifyExternalAddresses().catch((e=>{Vde.error("error verifying external address",e)}))}async verifyExternalAddresses(){if(clearTimeout(this.verifyAddressTimeout),!this.isStarted())return;const e=this.components.addressManager,t=e.getObservedAddrs().filter((e=>{var t;const n=e.toOptions();return!(null!==(t=mS(n.host))&&void 0!==t&&t)}));if(0===t.length)return Vde("no public addresses found, not requesting verification"),void(this.verifyAddressTimeout=setTimeout(this._verifyExternalAddresses,this.refreshInterval));const n=AbortSignal.timeout(this.timeout);dJ(1/0,n);const r=this;try{Vde("verify multiaddrs %s",t.map((e=>e.toString())).join(", "));const o=zde.encode({type:zde.MessageType.DIAL,dial:{peer:{id:this.components.peerId.toBytes(),addrs:t.map((e=>e.bytes))}}}),s=(await TA()).toBytes(),a={},c=[],l=async e=>{let t=()=>{};try{Vde("asking %p to verify multiaddr",e.id);const i=await r.components.connectionManager.openConnection(e.id,{signal:n}),s=await i.newStream(this.protocol,{signal:n});t=()=>{s.abort(new aq("verifyAddress timeout",s5.ERR_TIMEOUT))},n.addEventListener("abort",t,{once:!0});const a=await Yq([o],(e=>Fq(e)),s,(e=>Zq(e)),(async e=>F5(e)));if(null==a)return void Vde("no response received from %p",i.remotePeer);const l=zde.decode(a);if(l.type!==zde.MessageType.DIAL_RESPONSE||null==l.dialResponse)return void Vde("invalid autonat response from %p",i.remotePeer);if(l.dialResponse.status===zde.ResponseStatus.OK){const e=i.remoteAddr.toOptions();let t;if(4===e.family){t=e.host.split(".")[0]}else{if(6!==e.family)return void Vde('remote address "%s" was not IP4 or IP6?',e.host);t=e.host.split(":")[0]}if(c.includes(t))return void Vde("already have response from network segment %d - %s",t,e.host);c.push(t)}return l.dialResponse}catch(i){Vde.error("error asking remote to verify multiaddr",i)}finally{n.removeEventListener("abort",t)}};for await(const r of KA(zq(this.components.peerRouting.getClosestPeers(s,{signal:n}),(e=>async()=>l(e))),{concurrency:4}))try{if(null==r)continue;const n=null==r.addr?t[0]:(0,ng.HM)(r.addr);if(Vde("autonat response for %a is %s",n,r.status),r.status===zde.ResponseStatus.E_BAD_REQUEST)continue;if(r.status===zde.ResponseStatus.E_DIAL_REFUSED)continue;if(null==r.addr&&t.length>1)continue;if(!t.some((e=>e.equals(n)))){Vde("peer reported %a as %s but it was not in our observed address list",n,r.status);continue}const i=n.toString();if(null==a[i]&&(a[i]={success:0,failure:0}),r.status===zde.ResponseStatus.OK?a[i].success++:r.status===zde.ResponseStatus.E_DIAL_ERROR&&a[i].failure++,4===a[i].success)return Vde("%a is externally dialable",n),void e.confirmObservedAddr(n);if(4===a[i].failure)return Vde("%a is not externally dialable",n),void e.removeObservedAddr(n)}catch(i){Vde.error("could not verify external address",i)}}finally{this.verifyAddressTimeout=setTimeout(this._verifyExternalAddresses,this.refreshInterval)}}}function qde(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>new Hde(t,e)}BigInt(1<<17);const Gde="/libp2p/circuit/relay/0.2.0/hop",Wde="/libp2p/circuit/relay/0.2.0/stop";var Qde,Yde,Jde,Xde,$de,efe,tfe,nfe;!function(e){let t,n,r;!function(e){e.RESERVE="RESERVE",e.CONNECT="CONNECT",e.STATUS="STATUS"}(t=e.Type||(e.Type={})),function(e){e[e.RESERVE=0]="RESERVE",e[e.CONNECT=1]="CONNECT",e[e.STATUS=2]="STATUS"}(n||(n={})),function(e){e.codec=()=>bs(n)}(t=e.Type||(e.Type={})),e.codec=()=>(null==r&&(r=ws((function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==r.lengthDelimited&&n.fork(),null!=t.type&&(n.uint32(8),e.Type.codec().encode(t.type,n)),null!=t.peer&&(n.uint32(18),Jde.codec().encode(t.peer,n)),null!=t.reservation&&(n.uint32(26),Xde.codec().encode(t.reservation,n)),null!=t.limit&&(n.uint32(34),$de.codec().encode(t.limit,n)),null!=t.status&&(n.uint32(40),efe.codec().encode(t.status,n)),!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.type=e.Type.codec().decode(t);break;case 2:r.peer=Jde.codec().decode(t,t.uint32());break;case 3:r.reservation=Xde.codec().decode(t,t.uint32());break;case 4:r.limit=$de.codec().decode(t,t.uint32());break;case 5:r.status=efe.codec().decode(t);break;default:t.skipType(7&n)}}return r}))),r),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(Qde||(Qde={})),function(e){let t,n,r;!function(e){e.CONNECT="CONNECT",e.STATUS="STATUS"}(t=e.Type||(e.Type={})),function(e){e[e.CONNECT=0]="CONNECT",e[e.STATUS=1]="STATUS"}(n||(n={})),function(e){e.codec=()=>bs(n)}(t=e.Type||(e.Type={})),e.codec=()=>(null==r&&(r=ws((function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==r.lengthDelimited&&n.fork(),null!=t.type&&(n.uint32(8),e.Type.codec().encode(t.type,n)),null!=t.peer&&(n.uint32(18),Jde.codec().encode(t.peer,n)),null!=t.limit&&(n.uint32(26),$de.codec().encode(t.limit,n)),null!=t.status&&(n.uint32(32),efe.codec().encode(t.status,n)),!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.type=e.Type.codec().decode(t);break;case 2:r.peer=Jde.codec().decode(t,t.uint32());break;case 3:r.limit=$de.codec().decode(t,t.uint32());break;case 4:r.status=efe.codec().decode(t);break;default:t.skipType(7&n)}}return r}))),r),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(Yde||(Yde={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==n.lengthDelimited&&t.fork(),null!=e.id&&e.id.byteLength>0&&(t.uint32(10),t.bytes(e.id)),null!=e.addrs)for(const r of e.addrs)t.uint32(18),t.bytes(r);!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={id:new Uint8Array(0),addrs:[]},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.id=e.bytes();break;case 2:n.addrs.push(e.bytes());break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(Jde||(Jde={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==n.lengthDelimited&&t.fork(),null!=e.expire&&0n!==e.expire&&(t.uint32(8),t.uint64(e.expire)),null!=e.addrs)for(const r of e.addrs)t.uint32(18),t.bytes(r);null!=e.voucher&&(t.uint32(26),t.bytes(e.voucher)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={expire:0n,addrs:[]},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.expire=e.uint64();break;case 2:n.addrs.push(e.bytes());break;case 3:n.voucher=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(Xde||(Xde={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.duration&&(t.uint32(8),t.uint32(e.duration)),null!=e.data&&(t.uint32(16),t.uint64(e.data)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.duration=e.uint32();break;case 2:n.data=e.uint64();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}($de||($de={})),function(e){e.UNUSED="UNUSED",e.OK="OK",e.RESERVATION_REFUSED="RESERVATION_REFUSED",e.RESOURCE_LIMIT_EXCEEDED="RESOURCE_LIMIT_EXCEEDED",e.PERMISSION_DENIED="PERMISSION_DENIED",e.CONNECTION_FAILED="CONNECTION_FAILED",e.NO_RESERVATION="NO_RESERVATION",e.MALFORMED_MESSAGE="MALFORMED_MESSAGE",e.UNEXPECTED_MESSAGE="UNEXPECTED_MESSAGE"}(efe||(efe={})),function(e){e[e.UNUSED=0]="UNUSED",e[e.OK=100]="OK",e[e.RESERVATION_REFUSED=200]="RESERVATION_REFUSED",e[e.RESOURCE_LIMIT_EXCEEDED=201]="RESOURCE_LIMIT_EXCEEDED",e[e.PERMISSION_DENIED=202]="PERMISSION_DENIED",e[e.CONNECTION_FAILED=203]="CONNECTION_FAILED",e[e.NO_RESERVATION=204]="NO_RESERVATION",e[e.MALFORMED_MESSAGE=400]="MALFORMED_MESSAGE",e[e.UNEXPECTED_MESSAGE=401]="UNEXPECTED_MESSAGE"}(tfe||(tfe={})),function(e){e.codec=()=>bs(tfe)}(efe||(efe={})),function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.relay&&e.relay.byteLength>0&&(t.uint32(10),t.bytes(e.relay)),null!=e.peer&&e.peer.byteLength>0&&(t.uint32(18),t.bytes(e.peer)),null!=e.expiration&&0n!==e.expiration&&(t.uint32(24),t.uint64(e.expiration)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={relay:new Uint8Array(0),peer:new Uint8Array(0),expiration:0n},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.relay=e.bytes();break;case 2:n.peer=e.bytes();break;case 3:n.expiration=e.uint64();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(nfe||(nfe={}));aH("libp2p:circuit-relay:utils");function rfe(e){const t=e*BigInt(1e3),n=(new Date).getTime();return Number(t-BigInt(n))}aH("libp2p:circuit-relay:advert-service");aH("libp2p:circuit-relay:server");const ife=aH("libp2p:stream:converter");function ofe(e){const{stream:t,remoteAddr:n}=e,{sink:r,source:i}=t,o={async sink(e){try{await r(e),s()}catch(t){"aborted"!==t.type&&ife(t)}},source:async function*(){for await(const e of i)e instanceof Uint8Array?yield e:yield*e}(),remoteAddr:n,timeline:{open:Date.now(),close:void 0},async close(e){s(),await t.close(e)},abort(e){s(),t.abort(e)}};function s(){null==o.timeline.close&&(o.timeline.close=Date.now())}return o}const sfe=aH("libp2p:circuit-relay:discover-relays");class afe extends lJ{constructor(e){super(),(0,Yo.Z)(this,"peerId",void 0),(0,Yo.Z)(this,"peerStore",void 0),(0,Yo.Z)(this,"contentRouting",void 0),(0,Yo.Z)(this,"registrar",void 0),(0,Yo.Z)(this,"started",void 0),(0,Yo.Z)(this,"topologyId",void 0),this.started=!1,this.peerId=e.peerId,this.peerStore=e.peerStore,this.contentRouting=e.contentRouting,this.registrar=e.registrar}isStarted(){return this.started}async start(){this.topologyId=await this.registrar.register(Gde,{notifyOnTransient:!0,onConnect:e=>{this.safeDispatchEvent("relay:discover",{detail:e})}}),this.discover().catch((e=>{sfe.error("error listening on relays",e)})),this.started=!0}stop(){null!=this.topologyId&&this.registrar.unregister(this.topologyId),this.started=!1}async discover(){sfe("searching peer store for relays");const e=await this.peerStore.all({filters:[e=>e.protocols.includes(Gde)],orders:[()=>Math.random()<.5?1:-1]});for(const n of e)sfe("found relay peer %p in content peer store",n.id),this.safeDispatchEvent("relay:discover",{detail:n.id});sfe("found %d relay peers in peer store",e.length);try{sfe("searching content routing for relays");const e=await async function(e){const t=(new TextEncoder).encode(e),n=await pq.digest(t);return YH.createV0(n)}("/libp2p/relay");let t=0;for await(const n of this.contentRouting.findProviders(e))if(n.multiaddrs.length>0&&!n.id.equals(this.peerId)){const e=n.id;t++,await this.peerStore.merge(e,{multiaddrs:n.multiaddrs}),sfe("found relay peer %p in content routing",e),this.safeDispatchEvent("relay:discover",{detail:e})}sfe("found %d relay peers in content routing",t)}catch(t){sfe.error("failed when finding relays on the network",t)}}}const cfe=aH("libp2p:circuit-relay:transport:listener");var lfe=new WeakSet;class ufe extends lJ{constructor(e){super(),Qd(this,lfe),(0,Yo.Z)(this,"connectionManager",void 0),(0,Yo.Z)(this,"relayStore",void 0),(0,Yo.Z)(this,"listeningAddrs",void 0),(0,Yo.Z)(this,"_onRemoveRelayPeer",(e=>{Yd(this,lfe,hfe).call(this,e.detail)})),this.connectionManager=e.connectionManager,this.relayStore=e.relayStore,this.listeningAddrs=new lx,this.relayStore.addEventListener("relay:removed",this._onRemoveRelayPeer)}async listen(e){cfe("listen on %a",e);const t=e.decapsulate("/p2p-circuit"),n=await this.connectionManager.openConnection(t);if(!this.relayStore.hasReservation(n.remotePeer))return void await this.relayStore.addRelay(n.remotePeer,"configured");const r=this.relayStore.getReservation(n.remotePeer);if(null==r)throw new aq("Did not have reservation after making reservation","ERR_NO_RESERVATION");this.listeningAddrs.has(n.remotePeer)?cfe("already listening on relay %p",n.remotePeer):(this.listeningAddrs.set(n.remotePeer,r.addrs.map((e=>(0,ng.HM)(e).encapsulate("/p2p-circuit")))),this.safeDispatchEvent("listening",{}))}getAddrs(){return[...this.listeningAddrs.values()].flat()}async close(){}}function hfe(e){const t=this.listeningAddrs.has(e);cfe("relay peer removed %p - had reservation",e,t),this.listeningAddrs.delete(e),t&&(cfe.trace("removing relay event listener for peer %p",e),this.relayStore.removeEventListener("relay:removed",this._onRemoveRelayPeer),this.safeDispatchEvent("close",{}))}const dfe=aH("libp2p:circuit-relay:transport:reservation-store");var ffe=new WeakSet,pfe=new WeakSet;class gfe extends lJ{constructor(e,t){var n,r,i,o;super(),Qd(this,pfe),Qd(this,ffe),(0,Yo.Z)(this,"peerId",void 0),(0,Yo.Z)(this,"connectionManager",void 0),(0,Yo.Z)(this,"transportManager",void 0),(0,Yo.Z)(this,"peerStore",void 0),(0,Yo.Z)(this,"events",void 0),(0,Yo.Z)(this,"reserveQueue",void 0),(0,Yo.Z)(this,"reservations",void 0),(0,Yo.Z)(this,"maxDiscoveredRelays",void 0),(0,Yo.Z)(this,"maxReservationQueueLength",void 0),(0,Yo.Z)(this,"reservationCompletionTimeout",void 0),(0,Yo.Z)(this,"started",void 0),this.peerId=e.peerId,this.connectionManager=e.connectionManager,this.transportManager=e.transportManager,this.peerStore=e.peerStore,this.events=e.events,this.reservations=new lx,this.maxDiscoveredRelays=null!==(n=null===t||void 0===t?void 0:t.discoverRelays)&&void 0!==n?n:0,this.maxReservationQueueLength=null!==(r=null===t||void 0===t?void 0:t.maxReservationQueueLength)&&void 0!==r?r:100,this.reservationCompletionTimeout=null!==(i=null===t||void 0===t?void 0:t.reservationCompletionTimeout)&&void 0!==i?i:1e4,this.started=!1,this.reserveQueue=new f5({concurrency:null!==(o=null===t||void 0===t?void 0:t.reservationConcurrency)&&void 0!==o?o:1}),this.events.addEventListener("peer:disconnect",(e=>{Yd(this,pfe,mfe).call(this,e.detail)}))}isStarted(){return this.started}async start(){this.started=!0}async stop(){this.reserveQueue.clear(),this.reservations.forEach((e=>{let{timeout:t}=e;clearTimeout(t)})),this.reservations.clear(),this.started=!1}async addRelay(e,t){this.peerId.equals(e)?dfe("not trying to use self as relay"):this.reserveQueue.size>this.maxReservationQueueLength?dfe("not adding relay as the queue is full"):this.reserveQueue.hasJob(e)?dfe("relay peer is already in the reservation queue"):(dfe("add relay %p",e),await this.reserveQueue.add((async()=>{try{const n=this.reservations.get(e);if(null!=n){if(rfe(n.reservation.expire)>6e5)return void dfe("already have reservation on relay peer %p and it expires in more than 10 minutes",e);clearTimeout(n.timeout),this.reservations.delete(e)}if("discovered"===t&&[...this.reservations.values()].reduce(((e,t)=>("discovered"===t.type&&e++,e)),0)>=this.maxDiscoveredRelays)return void dfe("already have enough discovered relays");const r=AbortSignal.timeout(this.reservationCompletionTimeout),i=await this.connectionManager.openConnection(e,{signal:r});if(i.remoteAddr.protoNames().includes("p2p-circuit"))return void dfe("not creating reservation over relayed connection");const o=await Yd(this,ffe,yfe).call(this,i,{signal:r});dfe("created reservation on relay peer %p",e);const s=rfe(o.expire),a=Math.min(Math.max(s-3e5,3e4),Math.pow(2,31)-1),c=setTimeout((()=>{this.addRelay(e,t).catch((t=>{dfe.error("could not refresh reservation to relay %p",e,t)}))}),a);this.reservations.set(e,{timeout:c,reservation:o,type:t}),await this.peerStore.merge(e,{tags:{"circuit-relay-relay":{value:1,ttl:s}}}),await this.transportManager.listen([(0,ng.HM)("/p2p/".concat(e.toString(),"/p2p-circuit"))])}catch(n){dfe.error("could not reserve slot on %p",e,n);const t=this.reservations.get(e);null!=t&&clearTimeout(t.timeout),this.reservations.delete(e)}}),{peerId:e}))}hasReservation(e){return this.reservations.has(e)}getReservation(e){var t;return null===(t=this.reservations.get(e))||void 0===t?void 0:t.reservation}}async function yfe(e,t){var n,r;null===(n=t.signal)||void 0===n||n.throwIfAborted(),dfe("requesting reservation from %p",e.remotePeer);const i=await e.newStream(Gde,t),o=rk(i).pb(Qde);let s;await o.write({type:Qde.Type.RESERVE},t);try{s=await o.read(t)}catch(c){throw dfe.error("error parsing reserve message response from %p because",e.remotePeer,c),c}finally{await i.close()}if(s.status===efe.OK&&null!=s.reservation)return s.reservation;const a="reservation failed with status ".concat(null!==(r=s.status)&&void 0!==r?r:"undefined");throw dfe.error(a),new Error(a)}function mfe(e){const t=this.reservations.get(e);null!=t&&(dfe("connection to relay %p closed, removing reservation from local store",e),clearTimeout(t.timeout),this.reservations.delete(e),this.safeDispatchEvent("relay:removed",{detail:e}),this.reservations.size<this.maxDiscoveredRelays&&(dfe("not enough relays %d/%d",this.reservations.size,this.maxDiscoveredRelays),this.safeDispatchEvent("relay:not-enough-relays",{})))}const vfe=aH("libp2p:circuit-relay:transport"),bfe=p5,wfe=p5,Efe=3e4;class Afe{constructor(e,t){var n,r,i;(0,Yo.Z)(this,"discovery",void 0),(0,Yo.Z)(this,"registrar",void 0),(0,Yo.Z)(this,"peerStore",void 0),(0,Yo.Z)(this,"connectionManager",void 0),(0,Yo.Z)(this,"peerId",void 0),(0,Yo.Z)(this,"upgrader",void 0),(0,Yo.Z)(this,"addressManager",void 0),(0,Yo.Z)(this,"connectionGater",void 0),(0,Yo.Z)(this,"reservationStore",void 0),(0,Yo.Z)(this,"maxInboundStopStreams",void 0),(0,Yo.Z)(this,"maxOutboundStopStreams",void 0),(0,Yo.Z)(this,"stopTimeout",void 0),(0,Yo.Z)(this,"started",void 0),(0,Yo.Z)(this,H3,!0),(0,Yo.Z)(this,Symbol.toStringTag,"libp2p/circuit-relay-v2"),this.registrar=e.registrar,this.peerStore=e.peerStore,this.connectionManager=e.connectionManager,this.peerId=e.peerId,this.upgrader=e.upgrader,this.addressManager=e.addressManager,this.connectionGater=e.connectionGater,this.maxInboundStopStreams=null!==(n=t.maxInboundStopStreams)&&void 0!==n?n:bfe,this.maxOutboundStopStreams=null!==(r=t.maxOutboundStopStreams)&&void 0!==r?r:wfe,this.stopTimeout=null!==(i=t.stopTimeout)&&void 0!==i?i:Efe,null!=t.discoverRelays&&t.discoverRelays>0&&(this.discovery=new afe(e),this.discovery.addEventListener("relay:discover",(e=>{this.reservationStore.addRelay(e.detail,"discovered").catch((t=>{vfe.error("could not add discovered relay %p",e.detail,t)}))}))),this.reservationStore=new gfe(e,t),this.reservationStore.addEventListener("relay:not-enough-relays",(()=>{var e;null===(e=this.discovery)||void 0===e||e.discover().catch((e=>{vfe.error("could not discover relays",e)}))})),this.started=!1}isStarted(){return this.started}async start(){var e;await this.reservationStore.start(),await(null===(e=this.discovery)||void 0===e?void 0:e.start()),await this.registrar.handle(Wde,(e=>{this.onStop(e).catch((t=>{vfe.error("error while handling STOP protocol",t),e.stream.abort(t)}))}),{maxInboundStreams:this.maxInboundStopStreams,maxOutboundStreams:this.maxOutboundStopStreams,runOnTransientConnection:!0}),this.started=!0}async stop(){var e;null===(e=this.discovery)||void 0===e||e.stop(),await this.reservationStore.stop(),await this.registrar.unhandle(Wde),this.started=!1}async dial(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(1!==e.protoCodes().filter((e=>290===e)).length){const t="Invalid circuit relay address";throw vfe.error(t,e),new aq(t,s5.ERR_RELAYED_DIAL)}const n=e.toString().split("/p2p-circuit"),r=(0,ng.HM)(n[0]),i=(0,ng.HM)(n[n.length-1]),o=r.getPeerId(),s=i.getPeerId();if(null==o||null==s){const t="Circuit relay dial to ".concat(e.toString()," failed as address did not have peer ids");throw vfe.error(t),new aq(t,s5.ERR_RELAYED_DIAL)}const a=X0(o),c=X0(s);let l=!1;let u,h=this.connectionManager.getConnections(a)[0];null==h&&(await this.peerStore.merge(a,{multiaddrs:[r]}),h=await this.connectionManager.openConnection(a,t),l=!0);try{return u=await h.newStream([Gde]),await this.connectV2({stream:u,connection:h,destinationPeer:c,destinationAddr:i,relayAddr:r,ma:e,disconnectOnFailure:l})}catch(d){throw vfe.error("circuit relay dial to destination %p via relay %p failed",c,a,d),null!=u&&u.abort(d),l&&await h.close(),d}}async connectV2(e){let{stream:t,connection:n,destinationPeer:r,destinationAddr:i,relayAddr:o,ma:s,disconnectOnFailure:a}=e;try{const e=rk(t),n=e.pb(Qde);await n.write({type:Qde.Type.CONNECT,peer:{id:r.toBytes(),addrs:[(0,ng.HM)(i).bytes]}});const a=await n.read();var c,l;if(a.status!==efe.OK)throw new aq("failed to connect via relay with status ".concat(null!==(c=null===a||void 0===a||null===(l=a.status)||void 0===l?void 0:l.toString())&&void 0!==c?c:"undefined"),s5.ERR_HOP_REQUEST_FAILED);const u=ofe({stream:e.unwrap(),remoteAddr:s,localAddr:o.encapsulate("/p2p-circuit/p2p/".concat(this.peerId.toString()))});return vfe("new outbound transient connection %a",u.remoteAddr),await this.upgrader.upgradeOutbound(u,{transient:!0})}catch(u){throw vfe.error("Circuit relay dial to destination ".concat(r.toString()," via relay ").concat(n.remotePeer.toString()," failed"),u),a&&await n.close(),u}}createListener(e){return function(e){return new ufe(e)}({connectionManager:this.connectionManager,relayStore:this.reservationStore})}filter(e){return(e=Array.isArray(e)?e:[e]).filter((e=>Qx.matches(e)))}async onStop(e){var t,n;let{connection:r,stream:i}=e;const o=AbortSignal.timeout(this.stopTimeout),s=rk(i).pb(Yde),a=await s.read({signal:o});if(vfe("new circuit relay v2 stop stream from %p with type %s",r.remotePeer,a.type),void 0===(null===a||void 0===a?void 0:a.type))return vfe.error("type was missing from circuit v2 stop protocol request from %s",r.remotePeer),await s.write({type:Yde.Type.STATUS,status:efe.MALFORMED_MESSAGE},{signal:o}),void await i.close();if(a.type!==Yde.Type.CONNECT)return vfe.error("invalid stop connect request via peer %p",r.remotePeer),await s.write({type:Yde.Type.STATUS,status:efe.UNEXPECTED_MESSAGE},{signal:o}),void await i.close();if(!(e=>{if(null==e.peer)return!1;try{e.peer.addrs.forEach(ng.HM)}catch{return!1}return!0})(a))return vfe.error("invalid stop connect request via peer %p",r.remotePeer),await s.write({type:Yde.Type.STATUS,status:efe.MALFORMED_MESSAGE},{signal:o}),void await i.close();const c=$0(a.peer.id);if(!0===await(null===(t=(n=this.connectionGater).denyInboundRelayedConnection)||void 0===t?void 0:t.call(n,r.remotePeer,c)))return vfe.error("connection gater denied inbound relayed connection from %p",r.remotePeer),await s.write({type:Yde.Type.STATUS,status:efe.PERMISSION_DENIED},{signal:o}),void await i.close();vfe.trace("sending success response to %p",r.remotePeer),await s.write({type:Yde.Type.STATUS,status:efe.OK},{signal:o});const l=r.remoteAddr.encapsulate("/p2p-circuit/p2p/".concat(c.toString())),u=this.addressManager.getAddresses()[0],h=ofe({stream:s.unwrap().unwrap(),remoteAddr:l,localAddr:u});vfe("new inbound transient connection %a",h.remoteAddr),await this.upgrader.upgradeInbound(h,{transient:!0}),vfe("%s connection %a upgraded","inbound",h.remoteAddr)}}function Sfe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>new Afe(t,e)}const _fe=()=>{const e=new Error("Delay aborted");return e.name="AbortError",e},Ife=new WeakMap;const Cfe=function(){let{clearTimeout:e,setTimeout:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(n){let r,i,o,{value:s,signal:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null!==a&&void 0!==a&&a.aborted)return Promise.reject(_fe());const c=null!==e&&void 0!==e?e:clearTimeout,l=()=>{c(r),o(_fe())},u=new Promise(((e,c)=>{i=()=>{a&&a.removeEventListener("abort",l),e(s)},o=c,r=(null!==t&&void 0!==t?t:setTimeout)(i,n)}));return a&&a.addEventListener("abort",l,{once:!0}),Ife.set(u,(()=>{c(r),r=null,i()})),u}}(),Tfe=Cfe;var kfe;function Rfe(e,t){if(tO.dx.matches(e))return!1;return null!=t.transportForMultiaddr(e)&&(!!tO.Rk.matches(e)||!!tO.IP.matches(e)&&!1===mS(e.toOptions().host))}!function(e){let t,n,r;!function(e){e.UNUSED="UNUSED",e.CONNECT="CONNECT",e.SYNC="SYNC"}(t=e.Type||(e.Type={})),function(e){e[e.UNUSED=0]="UNUSED",e[e.CONNECT=100]="CONNECT",e[e.SYNC=300]="SYNC"}(n||(n={})),function(e){e.codec=()=>bs(n)}(t=e.Type||(e.Type={})),e.codec=()=>(null==r&&(r=ws((function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==r.lengthDelimited&&n.fork(),null!=t.type&&(n.uint32(8),e.Type.codec().encode(t.type,n)),null!=t.observedAddresses)for(const e of t.observedAddresses)n.uint32(18),n.bytes(e);!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={observedAddresses:[]},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.type=e.Type.codec().decode(t);break;case 2:r.observedAddresses.push(t.bytes());break;default:t.skipType(7&n)}}return r}))),r),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(kfe||(kfe={}));const xfe=aH("libp2p:dcutr"),Pfe=5e3,Dfe=3,Ofe=1,Nfe=1;class Bfe{constructor(e,t){var n,r,i,o;(0,Yo.Z)(this,"started",void 0),(0,Yo.Z)(this,"timeout",void 0),(0,Yo.Z)(this,"retries",void 0),(0,Yo.Z)(this,"maxInboundStreams",void 0),(0,Yo.Z)(this,"maxOutboundStreams",void 0),(0,Yo.Z)(this,"peerStore",void 0),(0,Yo.Z)(this,"registrar",void 0),(0,Yo.Z)(this,"connectionManager",void 0),(0,Yo.Z)(this,"addressManager",void 0),(0,Yo.Z)(this,"transportManager",void 0),(0,Yo.Z)(this,"topologyId",void 0),this.started=!1,this.peerStore=e.peerStore,this.registrar=e.registrar,this.addressManager=e.addressManager,this.connectionManager=e.connectionManager,this.transportManager=e.transportManager,this.timeout=null!==(n=t.timeout)&&void 0!==n?n:Pfe,this.retries=null!==(r=t.retries)&&void 0!==r?r:Dfe,this.maxInboundStreams=null!==(i=t.maxInboundStreams)&&void 0!==i?i:Ofe,this.maxOutboundStreams=null!==(o=t.maxOutboundStreams)&&void 0!==o?o:Nfe}isStarted(){return this.started}async start(){this.started||(this.topologyId=await this.registrar.register(Lfe,{notifyOnTransient:!0,onConnect:(e,t)=>{t.transient&&"inbound"===t.direction&&this.upgradeInbound(t).catch((e=>{xfe.error("error during outgoing DCUtR attempt",e)}))}}),await this.registrar.handle(Lfe,(e=>{this.handleIncomingUpgrade(e.stream,e.connection).catch((t=>{xfe.error("error during incoming DCUtR attempt",t),e.stream.abort(t)}))}),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams,runOnTransientConnection:!0}),this.started=!0)}async stop(){await this.registrar.unhandle(Lfe),null!=this.topologyId&&this.registrar.unregister(this.topologyId),this.started=!1}async upgradeInbound(e){if(await this.attemptUnilateralConnectionUpgrade(e))return;let t;for(let i=0;i<this.retries;i++){const o={signal:AbortSignal.timeout(this.timeout)};try{t=await e.newStream([Lfe],{signal:o.signal,runOnTransientConnection:!0});const n=rk(t,{maxDataLength:4096}).pb(kfe);xfe("B sending connect to %p",e.remotePeer);const r=Date.now();await n.write({type:kfe.Type.CONNECT,observedAddresses:this.addressManager.getAddresses().map((e=>e.bytes))},o),xfe("B receiving connect from %p",e.remotePeer);const i=await n.read(o);if(i.type!==kfe.Type.CONNECT)throw xfe("A sent wrong message type"),new aq("DCUtR message type was incorrect",s5.ERR_INVALID_MESSAGE);const s=this.getDialableMultiaddrs(i.observedAddresses);if(0===s.length)throw xfe("A did not have any dialable multiaddrs"),new aq("DCUtR connect message had no multiaddrs",s5.ERR_INVALID_MESSAGE);const a=Date.now()-r;xfe("A sending sync, rtt %dms",a),await n.write({type:kfe.Type.SYNC,observedAddresses:[]},o),xfe("A waiting for half RTT"),await Tfe(a/2),xfe("B dialing",s);const c=await this.connectionManager.openConnection(s,{signal:o.signal,priority:100});xfe("DCUtR to %p succeeded to address %a, closing relayed connection",e.remotePeer,c.remoteAddr),await e.close(o);break}catch(r){var n;if(xfe.error("error while attempting DCUtR on attempt %d of %d",i+1,this.retries,r),null===(n=t)||void 0===n||n.abort(r),i===this.retries)throw r}finally{null!=t&&await t.close(o)}}}async attemptUnilateralConnectionUpgrade(e){const t=(await this.peerStore.get(e.remotePeer)).addresses.map((t=>{const n=t.multiaddr;return null==n.getPeerId()?n.encapsulate("/p2p/".concat(e.remotePeer)):n})).filter((e=>Rfe(e,this.transportManager)));if(t.length>0){const r=AbortSignal.timeout(this.timeout);try{xfe("attempting unilateral connection upgrade to %a",t);const n=await this.connectionManager.openConnection(t,{signal:r,force:!0});if(n.transient)throw new Error("Could not open a new, non-transient, connection");return xfe("unilateral connection upgrade to %p succeeded via %a, closing relayed connection",e.remotePeer,n.remoteAddr),await e.close({signal:r}),!0}catch(n){xfe.error("unilateral connection upgrade to %p on addresses %a failed",e.remotePeer,t,n)}}else xfe("peer %p has no public addresses, not attempting unilateral connection upgrade",e.remotePeer);return!1}async handleIncomingUpgrade(e,t){const n={signal:AbortSignal.timeout(this.timeout)};try{const r=rk(e,{maxDataLength:4096}).pb(kfe);xfe("A receiving connect");const i=await r.read(n);if(i.type!==kfe.Type.CONNECT)throw xfe("B sent wrong message type"),new aq("DCUtR message type was incorrect",s5.ERR_INVALID_MESSAGE);if(0===i.observedAddresses.length)throw xfe("B sent no multiaddrs"),new aq("DCUtR connect message had no multiaddrs",s5.ERR_INVALID_MESSAGE);const o=this.getDialableMultiaddrs(i.observedAddresses);if(0===o.length)throw xfe("B had no dialable multiaddrs"),new aq("DCUtR connect message had no dialable multiaddrs",s5.ERR_INVALID_MESSAGE);xfe("A sending connect"),await r.write({type:kfe.Type.CONNECT,observedAddresses:this.addressManager.getAddresses().map((e=>e.bytes))}),xfe("A receiving sync");if((await r.read(n)).type!==kfe.Type.SYNC)throw new aq("DCUtR message type was incorrect",s5.ERR_INVALID_MESSAGE);xfe("A dialing",o);const s=await this.connectionManager.openConnection(o,{signal:n.signal,priority:100,force:!0});xfe("DCUtR to %p succeeded via %a, closing relayed connection",t.remotePeer,s.remoteAddr),await t.close(n)}catch(r){xfe.error("incoming DCUtR from %p failed",t.remotePeer,r),e.abort(r)}finally{await e.close(n)}}getDialableMultiaddrs(e){const t=[];for(const n of e)if(null!=n&&0!==n.length)try{const e=(0,ng.HM)(n);if(!Rfe(e,this.transportManager))continue;t.push(e)}catch{}return t}}const Lfe="/libp2p/dcutr";function Mfe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>new Bfe(t,e)}const Ufe="js-libp2p/".concat("0.46.21");var Ffe;!function(e){let t;e.codec=()=>(null==t&&(t=ws((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==n.lengthDelimited&&t.fork(),null!=e.protocolVersion&&(t.uint32(42),t.string(e.protocolVersion)),null!=e.agentVersion&&(t.uint32(50),t.string(e.agentVersion)),null!=e.publicKey&&(t.uint32(10),t.bytes(e.publicKey)),null!=e.listenAddrs)for(const r of e.listenAddrs)t.uint32(18),t.bytes(r);if(null!=e.observedAddr&&(t.uint32(34),t.bytes(e.observedAddr)),null!=e.protocols)for(const r of e.protocols)t.uint32(26),t.string(r);null!=e.signedPeerRecord&&(t.uint32(66),t.bytes(e.signedPeerRecord)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={listenAddrs:[],protocols:[]},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 5:n.protocolVersion=e.string();break;case 6:n.agentVersion=e.string();break;case 1:n.publicKey=e.bytes();break;case 2:n.listenAddrs.push(e.bytes());break;case 4:n.observedAddr=e.bytes();break;case 3:n.protocols.push(e.string());break;case 8:n.signedPeerRecord=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>fs(t,e.codec()),e.decode=t=>ds(t,e.codec())}(Ffe||(Ffe={}));const Kfe=8192,jfe={protocolPrefix:"ipfs",agentVersion:Ufe,timeout:6e4,maxInboundStreams:1,maxOutboundStreams:1,maxPushIncomingStreams:1,maxPushOutgoingStreams:1,maxObservedAddresses:10,maxIdentifyMessageSize:8192,runOnConnectionOpen:!0,runOnTransientConnection:!0};var Zfe=new WeakMap,zfe=new WeakSet;class Vfe{constructor(e,t){var n,r,i,o,s,a,c,l,u,h,d,f,p;Qd(this,zfe),(0,Yo.Z)(this,"identifyProtocolStr",void 0),(0,Yo.Z)(this,"identifyPushProtocolStr",void 0),(0,Yo.Z)(this,"host",void 0),(0,Yo.Z)(this,"started",void 0),(0,Yo.Z)(this,"timeout",void 0),(0,Yo.Z)(this,"peerId",void 0),(0,Yo.Z)(this,"peerStore",void 0),(0,Yo.Z)(this,"registrar",void 0),(0,Yo.Z)(this,"connectionManager",void 0),(0,Yo.Z)(this,"addressManager",void 0),(0,Yo.Z)(this,"maxInboundStreams",void 0),(0,Yo.Z)(this,"maxOutboundStreams",void 0),(0,Yo.Z)(this,"maxPushIncomingStreams",void 0),(0,Yo.Z)(this,"maxPushOutgoingStreams",void 0),(0,Yo.Z)(this,"maxIdentifyMessageSize",void 0),(0,Yo.Z)(this,"maxObservedAddresses",void 0),(0,Yo.Z)(this,"events",void 0),(0,Yo.Z)(this,"runOnTransientConnection",void 0),(0,dx.Z)(this,Zfe,{writable:!0,value:void 0}),this.started=!1,this.peerId=e.peerId,this.peerStore=e.peerStore,this.registrar=e.registrar,this.addressManager=e.addressManager,this.connectionManager=e.connectionManager,this.events=e.events,CG(this,Zfe,e.logger.forComponent("libp2p:identify")),this.identifyProtocolStr="/".concat(null!==(n=t.protocolPrefix)&&void 0!==n?n:jfe.protocolPrefix,"/").concat("id","/").concat("1.0.0"),this.identifyPushProtocolStr="/".concat(null!==(r=t.protocolPrefix)&&void 0!==r?r:jfe.protocolPrefix,"/").concat("id/push","/").concat("1.0.0"),this.timeout=null!==(i=t.timeout)&&void 0!==i?i:jfe.timeout,this.maxInboundStreams=null!==(o=t.maxInboundStreams)&&void 0!==o?o:jfe.maxInboundStreams,this.maxOutboundStreams=null!==(s=t.maxOutboundStreams)&&void 0!==s?s:jfe.maxOutboundStreams,this.maxPushIncomingStreams=null!==(a=t.maxPushIncomingStreams)&&void 0!==a?a:jfe.maxPushIncomingStreams,this.maxPushOutgoingStreams=null!==(c=t.maxPushOutgoingStreams)&&void 0!==c?c:jfe.maxPushOutgoingStreams,this.maxIdentifyMessageSize=null!==(l=t.maxIdentifyMessageSize)&&void 0!==l?l:jfe.maxIdentifyMessageSize,this.maxObservedAddresses=null!==(u=t.maxObservedAddresses)&&void 0!==u?u:jfe.maxObservedAddresses,this.runOnTransientConnection=null!==(h=t.runOnTransientConnection)&&void 0!==h?h:jfe.runOnTransientConnection,this.host={protocolVersion:"".concat(null!==(d=t.protocolPrefix)&&void 0!==d?d:jfe.protocolPrefix,"/").concat("0.1.0"),agentVersion:null!==(f=t.agentVersion)&&void 0!==f?f:jfe.agentVersion},(null!==(p=t.runOnConnectionOpen)&&void 0!==p?p:jfe.runOnConnectionOpen)&&e.events.addEventListener("connection:open",(e=>{const t=e.detail;this.identify(t).catch((e=>{(0,fx.Z)(this,Zfe).error("error during identify trigged by connection:open",e)}))})),e.events.addEventListener("self:peer:update",(e=>{this.push().catch((e=>{(0,fx.Z)(this,Zfe).error(e)}))})),this.host.agentVersion===Ufe&&(lO||aO?this.host.agentVersion+=" UserAgent=".concat(globalThis.process.version):(sO||uO||cO||hO)&&(this.host.agentVersion+=" UserAgent=".concat(globalThis.navigator.userAgent)))}isStarted(){return this.started}async start(){this.started||(await this.peerStore.merge(this.peerId,{metadata:{AgentVersion:(0,yu.m)(this.host.agentVersion),ProtocolVersion:(0,yu.m)(this.host.protocolVersion)}}),await this.registrar.handle(this.identifyProtocolStr,(e=>{this._handleIdentify(e).catch((e=>{(0,fx.Z)(this,Zfe).error(e)}))}),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams,runOnTransientConnection:this.runOnTransientConnection}),await this.registrar.handle(this.identifyPushProtocolStr,(e=>{this._handlePush(e).catch((e=>{(0,fx.Z)(this,Zfe).error(e)}))}),{maxInboundStreams:this.maxPushIncomingStreams,maxOutboundStreams:this.maxPushOutgoingStreams,runOnTransientConnection:this.runOnTransientConnection}),this.started=!0)}async stop(){await this.registrar.unhandle(this.identifyProtocolStr),await this.registrar.unhandle(this.identifyPushProtocolStr),this.started=!1}async pushToConnections(e){var t,n;const r=this.addressManager.getAddresses().map((e=>e.decapsulateCode((0,ng.a_)("p2p").code))),i=new nk({peerId:this.peerId,multiaddrs:r}),o=await XT.seal(i,this.peerId),s=this.registrar.getProtocols(),a=await this.peerStore.get(this.peerId),c=(0,Au.B)(null!==(t=a.metadata.get("AgentVersion"))&&void 0!==t?t:(0,yu.m)(this.host.agentVersion)),l=(0,Au.B)(null!==(n=a.metadata.get("ProtocolVersion"))&&void 0!==n?n:(0,yu.m)(this.host.protocolVersion)),u=e.map((async e=>{let t;const n=AbortSignal.timeout(this.timeout);dJ(1/0,n);try{var i;t=await e.newStream([this.identifyPushProtocolStr],{signal:n,runOnTransientConnection:this.runOnTransientConnection});const a=rk(t,{maxDataLength:null!==(i=this.maxIdentifyMessageSize)&&void 0!==i?i:Kfe}).pb(Ffe);await a.write({listenAddrs:r.map((e=>e.bytes)),signedPeerRecord:o.marshal(),protocols:s,agentVersion:c,protocolVersion:l},{signal:n}),await t.close({signal:n})}catch(u){var a;(0,fx.Z)(this,Zfe).error("could not push identify update to peer",u),null===(a=t)||void 0===a||a.abort(u)}}));await Promise.all(u)}async push(){if(!this.isStarted())return;const e=[];await Promise.all(this.connectionManager.getConnections().map((async t=>{try{if(!(await this.peerStore.get(t.remotePeer)).protocols.includes(this.identifyPushProtocolStr))return;e.push(t)}catch(n){if(n.code!==s5.ERR_NOT_FOUND)throw n}}))),await this.pushToConnections(e)}async _identify(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null==n.signal){const e=AbortSignal.timeout(this.timeout);dJ(1/0,e),n={...n,signal:e}}try{var r;t=await e.newStream([this.identifyProtocolStr],{...n,runOnTransientConnection:this.runOnTransientConnection});const i=rk(t,{maxDataLength:null!==(r=this.maxIdentifyMessageSize)&&void 0!==r?r:Kfe}).pb(Ffe),o=await i.read(n);return await t.close(n),o}catch(o){var i;throw(0,fx.Z)(this,Zfe).error("error while reading identify message",o),null===(i=t)||void 0===i||i.abort(o),o}}async identify(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=await this._identify(e,n),{publicKey:i,protocols:o,observedAddr:s}=r;if(null==i)throw new aq("public key was missing from identify message",s5.ERR_MISSING_PUBLIC_KEY);const a=await e1(i);if(!e.remotePeer.equals(a))throw new aq("identified peer does not match the expected peer",s5.ERR_INVALID_PEER);if(this.peerId.equals(a))throw new aq("identified peer is our own peer id?",s5.ERR_INVALID_PEER);const c=function(e){if(null!=e&&e.length>0)try{return(0,ng.HM)(e)}catch{}}(s);return(0,fx.Z)(this,Zfe).call(this,"identify completed for peer %p and protocols %o",a,o),(0,fx.Z)(this,Zfe).call(this,"our observed address is %a",c),null!=c&&this.addressManager.getObservedAddrs().length<(null!==(t=this.maxObservedAddresses)&&void 0!==t?t:1/0)&&((0,fx.Z)(this,Zfe).call(this,"storing our observed address %a",c),this.addressManager.addObservedAddr(c)),Yd(this,zfe,Hfe).call(this,e,r)}async _handleIdentify(e){const{connection:t,stream:n}=e,r=AbortSignal.timeout(this.timeout);dJ(1/0,r);try{var i;const e=null!==(i=this.peerId.publicKey)&&void 0!==i?i:new Uint8Array(0),o=await this.peerStore.get(this.peerId),s=this.addressManager.getAddresses().map((e=>e.decapsulateCode((0,ng.a_)("p2p").code)));let a=o.peerRecordEnvelope;if(s.length>0&&null==a){const e=new nk({peerId:this.peerId,multiaddrs:s});a=(await XT.seal(e,this.peerId)).marshal().subarray()}let c=t.remoteAddr.bytes;tO.Iq.matches(t.remoteAddr)||(c=void 0);const l=rk(n).pb(Ffe);await l.write({protocolVersion:this.host.protocolVersion,agentVersion:this.host.agentVersion,publicKey:e,listenAddrs:s.map((e=>e.bytes)),signedPeerRecord:a,observedAddr:c,protocols:o.protocols},{signal:r}),await n.close({signal:r})}catch(o){(0,fx.Z)(this,Zfe).error("could not respond to identify request",o),n.abort(o)}}async _handlePush(e){const{connection:t,stream:n}=e;try{var r;if(this.peerId.equals(t.remotePeer))throw new Error("received push from ourselves?");const e={signal:AbortSignal.timeout(this.timeout)},i=rk(n,{maxDataLength:null!==(r=this.maxIdentifyMessageSize)&&void 0!==r?r:Kfe}).pb(Ffe),o=await i.read(e);await n.close(e),await Yd(this,zfe,Hfe).call(this,t,o)}catch(i){return(0,fx.Z)(this,Zfe).error("received invalid message",i),void n.abort(i)}(0,fx.Z)(this,Zfe).call(this,"handled push from %p",t.remotePeer)}}async function Hfe(e,t){if((0,fx.Z)(this,Zfe).call(this,"received identify from %p",e.remotePeer),null==t)throw new aq("message was null or undefined","ERR_INVALID_MESSAGE");const n={};if(t.listenAddrs.length>0&&(n.addresses=t.listenAddrs.map((e=>({isCertified:!1,multiaddr:(0,ng.HM)(e)})))),t.protocols.length>0&&(n.protocols=t.protocols),null!=t.publicKey){n.publicKey=t.publicKey;if(!(await e1(t.publicKey)).equals(e.remotePeer))throw new aq("public key did not match remote PeerId","ERR_INVALID_PUBLIC_KEY")}let r;if(null!=t.signedPeerRecord){(0,fx.Z)(this,Zfe).call(this,"received signedPeerRecord in push from %p",e.remotePeer);let i=t.signedPeerRecord;const s=await XT.openAndCertify(i,nk.DOMAIN);let a,c=nk.createFromProtobuf(s.payload);if(!c.peerId.equals(s.peerId))throw new aq("signing key does not match PeerId in the PeerRecord","ERR_INVALID_SIGNING_KEY");if(!e.remotePeer.equals(c.peerId))throw new aq("signing key does not match remote PeerId","ERR_INVALID_PEER_RECORD_KEY");try{a=await this.peerStore.get(c.peerId)}catch(o){if("ERR_NOT_FOUND"!==o.code)throw o}if(null!=a&&(n.metadata=a.metadata,null!=a.peerRecordEnvelope)){const e=await XT.createFromProtobuf(a.peerRecordEnvelope),t=nk.createFromProtobuf(e.payload);t.seqNumber>=c.seqNumber&&((0,fx.Z)(this,Zfe).call(this,"sequence number was lower or equal to existing sequence number - stored: %d received: %d",t.seqNumber,c.seqNumber),c=t,i=a.peerRecordEnvelope)}n.peerRecordEnvelope=i,n.addresses=c.multiaddrs.map((e=>({isCertified:!0,multiaddr:e}))),r={seq:c.seqNumber,addresses:c.multiaddrs}}else(0,fx.Z)(this,Zfe).call(this,"%p did not send a signed peer record",e.remotePeer);if((0,fx.Z)(this,Zfe).call(this,"patching %p with",e.remotePeer,n),await this.peerStore.patch(e.remotePeer,n),null!=t.agentVersion||null!=t.protocolVersion){const n={};null!=t.agentVersion&&(n.AgentVersion=(0,yu.m)(t.agentVersion)),null!=t.protocolVersion&&(n.ProtocolVersion=(0,yu.m)(t.protocolVersion)),(0,fx.Z)(this,Zfe).call(this,"merging %p metadata",e.remotePeer,n),await this.peerStore.merge(e.remotePeer,{metadata:n})}const i={peerId:e.remotePeer,protocolVersion:t.protocolVersion,agentVersion:t.agentVersion,publicKey:t.publicKey,listenAddrs:t.listenAddrs.map((e=>(0,ng.HM)(e))),observedAddr:null==t.observedAddr?void 0:(0,ng.HM)(t.observedAddr),protocols:t.protocols,signedPeerRecord:r,connection:e};return this.events.safeDispatchEvent("peer:identify",{detail:i}),i}function qfe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>new Vfe(t,e)}const Gfe=aH("libp2p:ping");class Wfe{constructor(e,t){var n,r,i,o,s;(0,Yo.Z)(this,"protocol",void 0),(0,Yo.Z)(this,"components",void 0),(0,Yo.Z)(this,"started",void 0),(0,Yo.Z)(this,"timeout",void 0),(0,Yo.Z)(this,"maxInboundStreams",void 0),(0,Yo.Z)(this,"maxOutboundStreams",void 0),(0,Yo.Z)(this,"runOnTransientConnection",void 0),this.components=e,this.started=!1,this.protocol="/".concat(null!==(n=t.protocolPrefix)&&void 0!==n?n:"ipfs","/").concat("ping","/").concat("1.0.0"),this.timeout=null!==(r=t.timeout)&&void 0!==r?r:1e4,this.maxInboundStreams=null!==(i=t.maxInboundStreams)&&void 0!==i?i:2,this.maxOutboundStreams=null!==(o=t.maxOutboundStreams)&&void 0!==o?o:1,this.runOnTransientConnection=null===(s=t.runOnTransientConnection)||void 0===s||s}async start(){await this.components.registrar.handle(this.protocol,this.handleMessage,{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams,runOnTransientConnection:this.runOnTransientConnection}),this.started=!0}async stop(){await this.components.registrar.unhandle(this.protocol),this.started=!1}isStarted(){return this.started}handleMessage(e){Gfe("incoming ping from %p",e.connection.remotePeer);const{stream:t}=e,n=Date.now();Yq(t,t).catch((t=>{Gfe.error("incoming ping from %p failed with error",e.connection.remotePeer,t)})).finally((()=>{const t=Date.now()-n;Gfe("incoming ping from %p complete in %dms",e.connection.remotePeer,t)}))}async ping(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Gfe("pinging %p",e);const n=Date.now(),r=LY(32),i=await this.components.connectionManager.openConnection(e,t);let o,s=()=>{};if(null==t.signal){const e=AbortSignal.timeout(this.timeout);t={...t,signal:e}}try{var a;o=await i.newStream(this.protocol,{...t,runOnTransientConnection:this.runOnTransientConnection}),s=()=>{var e;null===(e=o)||void 0===e||e.abort(new aq("ping timeout",s5.ERR_TIMEOUT))},null===(a=t.signal)||void 0===a||a.addEventListener("abort",s,{once:!0});const e=await Yq([r],o,(async e=>F5(e))),c=Date.now()-n;if(null==e)throw new aq("Did not receive a ping ack after ".concat(c,"ms"),s5.ERR_WRONG_PING_ACK);if(!(0,Ms.f)(r,e.subarray()))throw new aq("Received wrong ping ack after ".concat(c,"ms"),s5.ERR_WRONG_PING_ACK);return Gfe("ping %p complete in %dms",i.remotePeer,c),c}catch(u){var c;throw Gfe.error("error while pinging %p",i.remotePeer,u),null===(c=o)||void 0===c||c.abort(u),u}finally{var l;null===(l=t.signal)||void 0===l||l.removeEventListener("abort",s),null!=o&&await o.close()}}}function Qfe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>new Wfe(t,e)}const Yfe={list:["/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN","/dnsaddr/bootstrap.libp2p.io/p2p/QmQCU2EcMqAqQPR2i9bChDtGNJchTbq5TbXJJ16u19uLTa","/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb","/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt","/ip4/104.131.131.82/tcp/4001/p2p/QmaCpDMGvV2BGHeYERUEnRQAwe3N8SzbUtfsmvsqQLuvuJ"]};async function Jfe(e,t){var n;return t=null!==(n=t)&&void 0!==n?n:{},async function(e){const t=await m4(e);return!1!==e.start&&await t.start(),t}({datastore:e,...function(){return{addresses:{listen:["/webrtc"]},transports:[Sfe({discoverRelays:1}),t=>new nde(t,e),gde(),Sde(),bF()],connectionEncryption:[Cne()],streamMuxers:[$ne(),lhe()],peerDiscovery:[soe(Yfe)],services:{identify:qfe(),autoNAT:qde(),pubsub:nne(),dcutr:Mfe(),delegatedRouting:()=>Xm("https://delegated-ipfs.dev"),dht:yue({clientMode:!0,validators:{ipns:Zde},selectors:{ipns:Ude}}),ping:Qfe()}};var e}(),...t,start:!1})}const Xfe="2.1.0",$fe="helia",epe=aH("helia");async function tpe(){var e,t;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r=null!==(e=n.datastore)&&void 0!==e?e:new vH,i=null!==(t=n.blockstore)&&void 0!==t?t:new yV;let o;o=function(e){if(null==e)return!1;return["dial","dialProtocol","hangUp","handle","unhandle","getMultiaddrs","getProtocols"].every((t=>"function"===typeof e[t]))}(n.libp2p)?n.libp2p:await Jfe(r,n.libp2p);const s=new pY({...n,datastore:r,blockstore:i,libp2p:o});return!1!==n.start&&await s.start(),function(e){try{if(null==e.libp2p.services.identify.host.agentVersion.match(/js-libp2p\/\d+\.\d+\.\d+\sUserAgent=/))return;e.libp2p.services.identify.host.agentVersion="".concat($fe,"/").concat(Xfe," ").concat(e.libp2p.services.identify.host.agentVersion)}catch(t){epe.error("could not add Helia to agent version",t)}}(s),s}function npe(){return{forComponent:e=>rpe(e)}}function rpe(e){let t=function(e){const t=()=>{};return t.enabled=!1,t.color="",t.diff=0,t.log=()=>{},t.namespace=e,t.destroy=()=>!0,t.extend=()=>t,t}("".concat(e,":trace"));return sf().enabled("".concat(e,":trace"))&&null!=sf().names.map((e=>e.toString())).find((e=>e.includes(":trace")))&&(t=sf()("".concat(e,":trace"))),Object.assign(sf()(e),{error:sf()("".concat(e,":error")),trace:t})}sf().formatters.b=e=>null==e?"undefined":mu.base58btc.baseEncode(e),sf().formatters.t=e=>null==e?"undefined":DV.base32.baseEncode(e),sf().formatters.m=e=>null==e?"undefined":xu.base64.baseEncode(e),sf().formatters.p=e=>null==e?"undefined":e.toString(),sf().formatters.c=e=>null==e?"undefined":e.toString(),sf().formatters.k=e=>null==e?"undefined":e.toString(),sf().formatters.a=e=>null==e?"undefined":e.toString();const ipe=e=>e;function ope(e,t){const n=e.getPeerId();if(null!=n){Zh(n).equals(t)&&(e=e.decapsulate((0,ng.HM)("/p2p/".concat(t.toString()))))}return e}class spe{constructor(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,Yo.Z)(this,"log",void 0),(0,Yo.Z)(this,"components",void 0),(0,Yo.Z)(this,"listen",void 0),(0,Yo.Z)(this,"announce",void 0),(0,Yo.Z)(this,"observed",void 0),(0,Yo.Z)(this,"announceFilter",void 0);const{listen:r=[],announce:i=[]}=n;this.components=e,this.log=e.logger.forComponent("libp2p:address-manager"),this.listen=r.map((e=>e.toString())),this.announce=new Set(i.map((e=>e.toString()))),this.observed=new Map,this.announceFilter=null!==(t=n.announceFilter)&&void 0!==t?t:ipe,this._updatePeerStoreAddresses=function(e,t){let n;return function(){clearTimeout(n),n=setTimeout((function(){n=void 0,e()}),t)}}(this._updatePeerStoreAddresses.bind(this),1e3),e.events.addEventListener("transport:listening",(()=>{this._updatePeerStoreAddresses()})),e.events.addEventListener("transport:close",(()=>{this._updatePeerStoreAddresses()}))}_updatePeerStoreAddresses(){const e=this.getAnnounceAddrs().concat(this.components.transportManager.getAddrs()).concat([...this.observed.entries()].filter((e=>{let[t,n]=e;return n.confident})).map((e=>{let[t]=e;return(0,ng.HM)(t)}))).map((e=>e.getPeerId()===this.components.peerId.toString()?e.decapsulate("/p2p/".concat(this.components.peerId.toString())):e));this.components.peerStore.patch(this.components.peerId,{multiaddrs:e}).catch((e=>{this.log.error("error updating addresses",e)}))}getListenAddrs(){return Array.from(this.listen).map((e=>(0,ng.HM)(e)))}getAnnounceAddrs(){return Array.from(this.announce).map((e=>(0,ng.HM)(e)))}getObservedAddrs(){return Array.from(this.observed).map((e=>{let[t]=e;return(0,ng.HM)(t)}))}addObservedAddr(e){const t=(e=ope(e,this.components.peerId)).toString();this.observed.has(t)||this.observed.set(t,{confident:!1})}confirmObservedAddr(e){var t;const n=(e=ope(e,this.components.peerId)).toString(),r=(null!==(t=this.observed.get(n))&&void 0!==t?t:{confident:!1}).confident;this.observed.set(n,{confident:!0}),r||this._updatePeerStoreAddresses()}removeObservedAddr(e){const t=(e=ope(e,this.components.peerId)).toString();this.observed.delete(t)}getAddresses(){let e=this.getAnnounceAddrs().map((e=>e.toString()));0===e.length&&(e=this.components.transportManager.getAddrs().map((e=>e.toString()))),e=e.concat(Array.from(this.observed).filter((e=>{let[t,n]=e;return n.confident})).map((e=>{let[t]=e;return t})));const t=new Set(e);return this.announceFilter(Array.from(t).map((e=>(0,ng.HM)(e)))).map((e=>{var t;return!0===(null===(t=e.protos().pop())||void 0===t?void 0:t.path)||e.getPeerId()===this.components.peerId.toString()?e:e.encapsulate("/p2p/".concat(this.components.peerId.toString()))}))}}class ape{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,Yo.Z)(this,"components",{}),(0,Yo.Z)(this,"_started",!1),this.components={};for(const[t,n]of Object.entries(e))this.components[t]=n;null==this.components.logger&&(this.components.logger=npe())}isStarted(){return this._started}async _invokeStartableMethod(e){await Promise.all(Object.values(this.components).filter((e=>(0,fu.qK)(e))).map((async t=>{var n;await(null===(n=t[e])||void 0===n?void 0:n.call(t))})))}async beforeStart(){await this._invokeStartableMethod("beforeStart")}async start(){await this._invokeStartableMethod("start"),this._started=!0}async afterStart(){await this._invokeStartableMethod("afterStart")}async beforeStop(){await this._invokeStartableMethod("beforeStop")}async stop(){await this._invokeStartableMethod("stop"),this._started=!1}async afterStop(){await this._invokeStartableMethod("afterStop")}}const cpe=["metrics","connectionProtector"],lpe=["components","isStarted","beforeStart","start","afterStart","beforeStop","stop","afterStop","then","_invokeStartableMethod"];function upe(){return{denyDialPeer:async()=>!1,denyDialMultiaddr:async e=>{const t=e.stringTuples();return(4===t[0][0]||41===t[0][0])&&Boolean(mS("".concat(t[0][1])))},denyInboundConnection:async()=>!1,denyOutboundConnection:async()=>!1,denyInboundEncryptedConnection:async()=>!1,denyOutboundEncryptedConnection:async()=>!1,denyInboundUpgradedConnection:async()=>!1,denyOutboundUpgradedConnection:async()=>!1,filterMultiaddrForPeer:async()=>!0,...arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}}}function hpe(e){try{const{address:t}=e.nodeAddress();return Boolean(mS(t))}catch{return!0}}function dpe(e,t){const n=function(e,t){const n=hpe(e.multiaddr),r=hpe(t.multiaddr);return n&&!r?1:!n&&r?-1:0}(e,t);if(0!==n)return n;const r=function(e,t){const n=tO.dx.exactMatch(e.multiaddr),r=tO.dx.exactMatch(t.multiaddr);return n&&!r?1:!n&&r?-1:0}(e,t);if(0!==r)return r;const i=function(e,t){return e.isCertified&&!t.isCertified?-1:!e.isCertified&&t.isCertified?1:0}(e,t);return i}var fpe,ppe;!function(e){e.NOT_STARTED_YET="The libp2p node is not started yet",e.DHT_DISABLED="DHT is not available",e.PUBSUB_DISABLED="PubSub is not available",e.CONN_ENCRYPTION_REQUIRED="At least one connection encryption module is required",e.ERR_TRANSPORTS_REQUIRED="At least one transport module is required",e.ERR_PROTECTOR_REQUIRED="Private network is enforced, but no protector was provided",e.NOT_FOUND="Not found"}(fpe||(fpe={})),function(e){e.DHT_DISABLED="ERR_DHT_DISABLED",e.ERR_PUBSUB_DISABLED="ERR_PUBSUB_DISABLED",e.PUBSUB_NOT_STARTED="ERR_PUBSUB_NOT_STARTED",e.DHT_NOT_STARTED="ERR_DHT_NOT_STARTED",e.CONN_ENCRYPTION_REQUIRED="ERR_CONN_ENCRYPTION_REQUIRED",e.ERR_TRANSPORTS_REQUIRED="ERR_TRANSPORTS_REQUIRED",e.ERR_PROTECTOR_REQUIRED="ERR_PROTECTOR_REQUIRED",e.ERR_PEER_DIAL_INTERCEPTED="ERR_PEER_DIAL_INTERCEPTED",e.ERR_CONNECTION_INTERCEPTED="ERR_CONNECTION_INTERCEPTED",e.ERR_INVALID_PROTOCOLS_FOR_STREAM="ERR_INVALID_PROTOCOLS_FOR_STREAM",e.ERR_CONNECTION_ENDED="ERR_CONNECTION_ENDED",e.ERR_CONNECTION_FAILED="ERR_CONNECTION_FAILED",e.ERR_NODE_NOT_STARTED="ERR_NODE_NOT_STARTED",e.ERR_ALREADY_ABORTED="ERR_ALREADY_ABORTED",e.ERR_TOO_MANY_ADDRESSES="ERR_TOO_MANY_ADDRESSES",e.ERR_NO_VALID_ADDRESSES="ERR_NO_VALID_ADDRESSES",e.ERR_RELAYED_DIAL="ERR_RELAYED_DIAL",e.ERR_DIALED_SELF="ERR_DIALED_SELF",e.ERR_DISCOVERED_SELF="ERR_DISCOVERED_SELF",e.ERR_DUPLICATE_TRANSPORT="ERR_DUPLICATE_TRANSPORT",e.ERR_ENCRYPTION_FAILED="ERR_ENCRYPTION_FAILED",e.ERR_HOP_REQUEST_FAILED="ERR_HOP_REQUEST_FAILED",e.ERR_INVALID_KEY="ERR_INVALID_KEY",e.ERR_INVALID_MESSAGE="ERR_INVALID_MESSAGE",e.ERR_INVALID_PARAMETERS="ERR_INVALID_PARAMETERS",e.ERR_INVALID_PEER="ERR_INVALID_PEER",e.ERR_MUXER_UNAVAILABLE="ERR_MUXER_UNAVAILABLE",e.ERR_NOT_FOUND="ERR_NOT_FOUND",e.ERR_TRANSPORT_UNAVAILABLE="ERR_TRANSPORT_UNAVAILABLE",e.ERR_TRANSPORT_DIAL_FAILED="ERR_TRANSPORT_DIAL_FAILED",e.ERR_UNSUPPORTED_PROTOCOL="ERR_UNSUPPORTED_PROTOCOL",e.ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED="ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED",e.ERR_INVALID_MULTIADDR="ERR_INVALID_MULTIADDR",e.ERR_SIGNATURE_NOT_VALID="ERR_SIGNATURE_NOT_VALID",e.ERR_FIND_SELF="ERR_FIND_SELF",e.ERR_NO_ROUTERS_AVAILABLE="ERR_NO_ROUTERS_AVAILABLE",e.ERR_CONNECTION_NOT_MULTIPLEXED="ERR_CONNECTION_NOT_MULTIPLEXED",e.ERR_NO_DIAL_TOKENS="ERR_NO_DIAL_TOKENS",e.ERR_INVALID_CMS="ERR_INVALID_CMS",e.ERR_MISSING_KEYS="ERR_MISSING_KEYS",e.ERR_NO_KEY="ERR_NO_KEY",e.ERR_INVALID_KEY_NAME="ERR_INVALID_KEY_NAME",e.ERR_INVALID_KEY_TYPE="ERR_INVALID_KEY_TYPE",e.ERR_KEY_ALREADY_EXISTS="ERR_KEY_ALREADY_EXISTS",e.ERR_INVALID_KEY_SIZE="ERR_INVALID_KEY_SIZE",e.ERR_KEY_NOT_FOUND="ERR_KEY_NOT_FOUND",e.ERR_OLD_KEY_NAME_INVALID="ERR_OLD_KEY_NAME_INVALID",e.ERR_NEW_KEY_NAME_INVALID="ERR_NEW_KEY_NAME_INVALID",e.ERR_PASSWORD_REQUIRED="ERR_PASSWORD_REQUIRED",e.ERR_PEM_REQUIRED="ERR_PEM_REQUIRED",e.ERR_CANNOT_READ_KEY="ERR_CANNOT_READ_KEY",e.ERR_MISSING_PRIVATE_KEY="ERR_MISSING_PRIVATE_KEY",e.ERR_MISSING_PUBLIC_KEY="ERR_MISSING_PUBLIC_KEY",e.ERR_INVALID_OLD_PASS_TYPE="ERR_INVALID_OLD_PASS_TYPE",e.ERR_INVALID_NEW_PASS_TYPE="ERR_INVALID_NEW_PASS_TYPE",e.ERR_INVALID_PASS_LENGTH="ERR_INVALID_PASS_LENGTH",e.ERR_NOT_IMPLEMENTED="ERR_NOT_IMPLEMENTED",e.ERR_WRONG_PING_ACK="ERR_WRONG_PING_ACK",e.ERR_INVALID_RECORD="ERR_INVALID_RECORD",e.ERR_ALREADY_SUCCEEDED="ERR_ALREADY_SUCCEEDED",e.ERR_NO_HANDLER_FOR_PROTOCOL="ERR_NO_HANDLER_FOR_PROTOCOL",e.ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS="ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS",e.ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS="ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS",e.ERR_CONNECTION_DENIED="ERR_CONNECTION_DENIED",e.ERR_TRANSFER_LIMIT_EXCEEDED="ERR_TRANSFER_LIMIT_EXCEEDED"}(ppe||(ppe={}));const gpe={addresses:{listen:[],announce:[],noAnnounce:[],announceFilter:e=>e},connectionManager:{resolvers:{dnsaddr:i5},addressSorter:dpe},transportManager:{faultTolerance:fu.P7.FATAL_ALL}};function ype(e){if((0,fu.I$)(e))return{peerId:e,multiaddrs:[]};let t;if(Array.isArray(e)||(e=[e]),e.length>0){const n=e[0].getPeerId();t=null==n?void 0:Zh(n),e.forEach((e=>{if(!(0,ng.h2)(e))throw new fu.sv("Invalid Multiaddr",ppe.ERR_INVALID_MULTIADDR);const n=e.getPeerId();if(null==n){if(null!=t)throw new fu.sv("Multiaddrs must all have the same peer id or have no peer id",ppe.ERR_INVALID_PARAMETERS)}else{const e=Zh(n);if(null==t||!t.equals(e))throw new fu.sv("Multiaddrs must all have the same peer id or have no peer id",ppe.ERR_INVALID_PARAMETERS)}}))}return{peerId:t,multiaddrs:e}}const mpe="last-dial-failure",vpe={minConnections:5,maxQueueLength:100,autoDialConcurrency:25,autoDialPriority:0,autoDialInterval:5e3,autoDialPeerRetryThreshold:42e4,autoDialDiscoveredPeersDebounce:10};class bpe{constructor(e,t){var n,r,i,o,s,a,c;let l;(0,Yo.Z)(this,"connectionManager",void 0),(0,Yo.Z)(this,"peerStore",void 0),(0,Yo.Z)(this,"queue",void 0),(0,Yo.Z)(this,"minConnections",void 0),(0,Yo.Z)(this,"autoDialPriority",void 0),(0,Yo.Z)(this,"autoDialIntervalMs",void 0),(0,Yo.Z)(this,"autoDialMaxQueueLength",void 0),(0,Yo.Z)(this,"autoDialPeerRetryThresholdMs",void 0),(0,Yo.Z)(this,"autoDialDiscoveredPeersDebounce",void 0),(0,Yo.Z)(this,"autoDialInterval",void 0),(0,Yo.Z)(this,"started",void 0),(0,Yo.Z)(this,"running",void 0),(0,Yo.Z)(this,"log",void 0),this.connectionManager=e.connectionManager,this.peerStore=e.peerStore,this.minConnections=null!==(n=t.minConnections)&&void 0!==n?n:vpe.minConnections,this.autoDialPriority=null!==(r=t.autoDialPriority)&&void 0!==r?r:vpe.autoDialPriority,this.autoDialIntervalMs=null!==(i=t.autoDialInterval)&&void 0!==i?i:vpe.autoDialInterval,this.autoDialMaxQueueLength=null!==(o=t.maxQueueLength)&&void 0!==o?o:vpe.maxQueueLength,this.autoDialPeerRetryThresholdMs=null!==(s=t.autoDialPeerRetryThreshold)&&void 0!==s?s:vpe.autoDialPeerRetryThreshold,this.autoDialDiscoveredPeersDebounce=null!==(a=t.autoDialDiscoveredPeersDebounce)&&void 0!==a?a:vpe.autoDialDiscoveredPeersDebounce,this.log=e.logger.forComponent("libp2p:connection-manager:auto-dial"),this.started=!1,this.running=!1,this.queue=new yx({concurrency:null!==(c=t.autoDialConcurrency)&&void 0!==c?c:vpe.autoDialConcurrency}),this.queue.addListener("error",(e=>{this.log.error("error during auto-dial",e)})),e.events.addEventListener("connection:close",(()=>{this.autoDial().catch((e=>{this.log.error(e)}))})),e.events.addEventListener("peer:discovery",(()=>{clearTimeout(l),l=setTimeout((()=>{this.autoDial().catch((e=>{this.log.error(e)}))}),this.autoDialDiscoveredPeersDebounce)}))}isStarted(){return this.started}start(){this.autoDialInterval=setTimeout((()=>{this.autoDial().catch((e=>{this.log.error("error while autodialing",e)}))}),this.autoDialIntervalMs),this.started=!0}afterStart(){this.autoDial().catch((e=>{this.log.error("error while autodialing",e)}))}stop(){this.queue.clear(),clearTimeout(this.autoDialInterval),this.started=!1,this.running=!1}async autoDial(){if(!this.started)return;const e=this.connectionManager.getConnectionsMap(),t=e.size;if(t>=this.minConnections)return void(this.minConnections>0&&this.log.trace("have enough connections %d/%d",t,this.minConnections));if(this.queue.size>this.autoDialMaxQueueLength)return void this.log("not enough connections %d/%d but auto dial queue is full",t,this.minConnections);if(this.running)return void this.log("not enough connections %d/%d - but skipping autodial as it is already running",t,this.minConnections);this.running=!0,this.log("not enough connections %d/%d - will dial peers to increase the number of connections",t,this.minConnections);const n=new ux(this.connectionManager.getDialQueue().map((e=>e.peerId)).filter(Boolean)),r=await this.peerStore.all({filters:[t=>0===t.addresses.length?(this.log.trace("not autodialing %p because they have no addresses",t.id),!1):e.has(t.id)?(this.log.trace("not autodialing %p because they are already connected",t.id),!1):n.has(t.id)?(this.log.trace("not autodialing %p because they are already being dialed",t.id),!1):!this.queue.hasJob(t.id)||(this.log.trace("not autodialing %p because they are already being autodialed",t.id),!1)]}),i=r.sort((()=>Math.random()>.5?1:-1)),o=new lx;for(const a of i)o.has(a.id)||o.set(a.id,[...a.tags.values()].reduce(((e,t)=>e+t.value),0));const s=i.sort(((e,t)=>{var n,r;const i=null!==(n=o.get(e.id))&&void 0!==n?n:0,s=null!==(r=o.get(t.id))&&void 0!==r?r:0;return i>s?-1:i<s?1:0})).filter((e=>{const t=e.metadata.get(mpe);if(null==t)return!0;const n=parseInt((0,Au.B)(t));return!!isNaN(n)||Date.now()-n>this.autoDialPeerRetryThresholdMs}));this.log("selected %d/%d peers to dial",s.length,r.length);for(const a of s)this.queue.add((async()=>{const e=this.connectionManager.getConnectionsMap().size;if(e>=this.minConnections)return this.log("got enough connections now %d/%d",e,this.minConnections),void this.queue.clear();this.log("connecting to a peerStore stored peer %p",a.id),await this.connectionManager.openConnection(a.id,{priority:this.autoDialPriority})}),{peerId:a.id}).catch((e=>{this.log.error("could not connect to peerStore stored peer",e)}));this.running=!1,this.started&&(this.autoDialInterval=setTimeout((()=>{this.autoDial().catch((e=>{this.log.error("error while autodialing",e)}))}),this.autoDialIntervalMs))}}const wpe={maxConnections:100,allow:[]};class Epe{constructor(e){var t,n;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,Yo.Z)(this,"maxConnections",void 0),(0,Yo.Z)(this,"connectionManager",void 0),(0,Yo.Z)(this,"peerStore",void 0),(0,Yo.Z)(this,"allow",void 0),(0,Yo.Z)(this,"events",void 0),(0,Yo.Z)(this,"log",void 0),this.maxConnections=null!==(t=r.maxConnections)&&void 0!==t?t:wpe.maxConnections,this.allow=null!==(n=r.allow)&&void 0!==n?n:wpe.allow,this.connectionManager=e.connectionManager,this.peerStore=e.peerStore,this.events=e.events,this.log=e.logger.forComponent("libp2p:connection-manager:connection-pruner"),e.events.addEventListener("connection:open",(()=>{this.maybePruneConnections().catch((e=>{this.log.error(e)}))}))}async maybePruneConnections(){const e=this.connectionManager.getConnections(),t=e.length,n=Math.max(t-this.maxConnections,0);if(this.log("checking max connections limit %d/%d",t,this.maxConnections),t<=this.maxConnections)return;this.log("max connections limit exceeded %d/%d, pruning %d connection(s)",t,this.maxConnections,n);const r=new lx;for(const a of e){const e=a.remotePeer;if(!r.has(e)){r.set(e,0);try{const t=await this.peerStore.get(e);r.set(e,[...t.tags.values()].reduce(((e,t)=>e+t.value),0))}catch(s){"ERR_NOT_FOUND"!==s.code&&this.log.error("error loading peer tags",s)}}}const i=e.sort(((e,t)=>{var n,i;const o=null!==(n=r.get(e.remotePeer))&&void 0!==n?n:0,s=null!==(i=r.get(t.remotePeer))&&void 0!==i?i:0;if(o>s)return 1;if(o<s)return-1;const a=e.timeline.open,c=t.timeline.open;return a<c?1:a>c?-1:0})),o=[];for(const a of i){this.log("too many connections open - closing a connection to %p",a.remotePeer);if(this.allow.some((e=>a.remoteAddr.toString().startsWith(e.toString())))||o.push(a),o.length===n)break}await Promise.all(o.map((async e=>{try{await e.close()}catch(s){this.log.error(s)}}))),this.events.safeDispatchEvent("connection:prune",{detail:o})}}function Ape(e){const t=new globalThis.AbortController;function n(){t.abort();for(const t of e)null!=(null===t||void 0===t?void 0:t.removeEventListener)&&t.removeEventListener("abort",n)}for(const i of e){if(!0===(null===i||void 0===i?void 0:i.aborted)){n();break}null!=(null===i||void 0===i?void 0:i.addEventListener)&&i.addEventListener("abort",n)}const r=t.signal;return r.clear=function(){for(const t of e)null!=(null===t||void 0===t?void 0:t.removeEventListener)&&t.removeEventListener("abort",n)},r}async function Spe(e,t){if(!e.protoNames().includes("dnsaddr"))return[e];const n=await async function(e,t){try{e=(0,ng.HM)(e.toString());return await e.resolve(t)}catch(n){return t.log.error("multiaddr ".concat(e.toString()," could not be resolved"),n),[]}}(e,t),r=(await Promise.all(n.map((async e=>Spe(e,t))))).flat().reduce(((e,t)=>(null==e.find((e=>e.equals(t)))&&e.push(t),e)),[]);return t.log("resolved %s to",e,r.map((e=>e.toString()))),r}const _pe={addressSorter:dpe,maxParallelDials:50,maxPeerAddrsToDial:25,dialTimeout:3e4,resolvers:{dnsaddr:i5}};class Ipe{constructor(e){var t,n,r,i,o,s,a;let c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,Yo.Z)(this,"pendingDials",void 0),(0,Yo.Z)(this,"queue",void 0),(0,Yo.Z)(this,"peerId",void 0),(0,Yo.Z)(this,"peerStore",void 0),(0,Yo.Z)(this,"connectionGater",void 0),(0,Yo.Z)(this,"transportManager",void 0),(0,Yo.Z)(this,"addressSorter",void 0),(0,Yo.Z)(this,"maxPeerAddrsToDial",void 0),(0,Yo.Z)(this,"dialTimeout",void 0),(0,Yo.Z)(this,"inProgressDialCount",void 0),(0,Yo.Z)(this,"pendingDialCount",void 0),(0,Yo.Z)(this,"shutDownController",void 0),(0,Yo.Z)(this,"connections",void 0),(0,Yo.Z)(this,"log",void 0),this.addressSorter=null!==(t=c.addressSorter)&&void 0!==t?t:_pe.addressSorter,this.maxPeerAddrsToDial=null!==(n=c.maxPeerAddrsToDial)&&void 0!==n?n:_pe.maxPeerAddrsToDial,this.dialTimeout=null!==(r=c.dialTimeout)&&void 0!==r?r:_pe.dialTimeout,this.connections=null!==(i=c.connections)&&void 0!==i?i:new lx,this.log=e.logger.forComponent("libp2p:connection-manager:dial-queue"),this.peerId=e.peerId,this.peerStore=e.peerStore,this.connectionGater=e.connectionGater,this.transportManager=e.transportManager,this.shutDownController=new AbortController,(0,fu.Wp)(1/0,this.shutDownController.signal),this.pendingDialCount=null===(o=e.metrics)||void 0===o?void 0:o.registerMetric("libp2p_dial_queue_pending_dials"),this.inProgressDialCount=null===(s=e.metrics)||void 0===s?void 0:s.registerMetric("libp2p_dial_queue_in_progress_dials"),this.pendingDials=[];for(const[u,h]of Object.entries(null!==(l=c.resolvers)&&void 0!==l?l:{})){var l;ng.s_.set(u,h)}this.queue=new Bm.Z({concurrency:null!==(a=c.maxParallelDials)&&void 0!==a?a:_pe.maxParallelDials}),this.queue.on("add",(()=>{var e,t;null===(e=this.pendingDialCount)||void 0===e||e.update(this.queue.size),null===(t=this.inProgressDialCount)||void 0===t||t.update(this.queue.pending)})),this.queue.on("active",(()=>{var e,t;null===(e=this.pendingDialCount)||void 0===e||e.update(this.queue.size),null===(t=this.inProgressDialCount)||void 0===t||t.update(this.queue.pending)})),this.queue.on("completed",(()=>{var e,t;null===(e=this.pendingDialCount)||void 0===e||e.update(this.queue.size),null===(t=this.inProgressDialCount)||void 0===t||t.update(this.queue.pending)})),this.queue.on("error",(e=>{var t,n;this.log.error("error in dial queue",e),null===(t=this.pendingDialCount)||void 0===t||t.update(this.queue.size),null===(n=this.inProgressDialCount)||void 0===n||n.update(this.queue.pending)})),this.queue.on("empty",(()=>{var e,t;null===(e=this.pendingDialCount)||void 0===e||e.update(this.queue.size),null===(t=this.inProgressDialCount)||void 0===t||t.update(this.queue.pending)})),this.queue.on("idle",(()=>{var e,t;null===(e=this.pendingDialCount)||void 0===e||e.update(this.queue.size),null===(t=this.inProgressDialCount)||void 0===t||t.update(this.queue.pending)}))}stop(){this.shutDownController.abort()}async dial(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{peerId:n,multiaddrs:r}=ype(e),i=r.map((e=>({multiaddr:e,isCertified:!1}))),o=this.createDialAbortControllers(t.signal);let s;try{s=await this.calculateMultiaddrs(n,i,{...t,signal:o})}catch(h){throw o.clear(),h}let a=Array.from(this.connections.values()).flat().find((e=>!0!==t.force&&s.find((t=>t.multiaddr.equals(e.remoteAddr)))));if(null!=a)return this.log("already connected to %a",a.remoteAddr),a;const c=this.pendingDials.find((e=>!(null==e.peerId||null==n||!e.peerId.equals(n))||s.map((e=>{let{multiaddr:t}=e;return t.toString()})).join()===e.multiaddrs.map((e=>e.toString())).join()));if(null!=c)return this.log("joining existing dial target for %p",n),o.clear(),c.promise;this.log("creating dial target for",s.map((e=>{let{multiaddr:t}=e;return t.toString()})));const l={id:"".concat(parseInt(String(1e9*Math.random()),10).toString()).concat(Date.now()),status:"queued",peerId:n,multiaddrs:s.map((e=>{let{multiaddr:t}=e;return t}))};l.promise=this.performDial(l,{...t,signal:o}).finally((()=>{this.pendingDials=this.pendingDials.filter((e=>e.id!==l.id)),o.clear()})).catch((async e=>{if(this.log.error("dial failed to %s",l.multiaddrs.map((e=>e.toString())).join(", "),e),null!=n)try{await this.peerStore.patch(n,{metadata:{[mpe]:(0,yu.m)(Date.now().toString())}})}catch(e){this.log.error("could not update last dial failure key for %p",n,e)}if(o.aborted){throw new fu.sv(e.message,fu.l9)}throw e})),this.pendingDials.push(l);const u=await l.promise;return a=Array.from(this.connections.values()).flat().find((e=>!0!==t.force&&(e.id!==u.id&&e.remoteAddr.equals(u.remoteAddr)))),null!=a?(this.log("already connected to %a",a.remoteAddr),await u.close(),a):(this.log("connection opened to %a",u.remoteAddr),u)}createDialAbortControllers(e){const t=Ape([AbortSignal.timeout(this.dialTimeout),this.shutDownController.signal,e]);try{null===fu.Wp||void 0===fu.Wp||(0,fu.Wp)(1/0,t)}catch{}return t}async calculateMultiaddrs(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!=e){var r,i;if(this.peerId.equals(e))throw new fu.sv("Tried to dial self",ppe.ERR_DIALED_SELF);if(!0===await(null===(r=(i=this.connectionGater).denyDialPeer)||void 0===r?void 0:r.call(i,e)))throw new fu.sv("The dial request is blocked by gater.allowDialPeer",ppe.ERR_PEER_DIAL_INTERCEPTED);if(0===t.length){this.log("loading multiaddrs for %p",e);try{const n=await this.peerStore.get(e);t.push(...n.addresses),this.log("loaded multiaddrs for %p",e,t.map((e=>{let{multiaddr:t}=e;return t.toString()})))}catch(h){if(h.code!==ppe.ERR_NOT_FOUND)throw h}}}let o=(await Promise.all(t.map((async e=>{const t=await Spe(e.multiaddr,{...n,log:this.log});return 1===t.length&&t[0].equals(e.multiaddr)?e:t.map((e=>({multiaddr:e,isCertified:!1})))})))).flat();if(null!=e){const t="/p2p/".concat(e.toString());o=o.map((e=>{const n=e.multiaddr.protos().pop();return!0===(null===n||void 0===n?void 0:n.path)?e:null==e.multiaddr.getPeerId()?{multiaddr:e.multiaddr.encapsulate(t),isCertified:e.isCertified}:e}))}const s=o.filter((t=>{if(null==this.transportManager.transportForMultiaddr(t.multiaddr))return!1;const n=t.multiaddr.getPeerId();return null==e||null==n||e.equals(n)})),a=new Map;for(const d of s){const e=d.multiaddr.toString(),t=a.get(e);null==t?a.set(e,d):t.isCertified=t.isCertified||d.isCertified||!1}const c=[...a.values()];if((0===c.length||c.length>this.maxPeerAddrsToDial)&&(this.log("addresses for %p before filtering",null!==e&&void 0!==e?e:"unknown peer",o.map((e=>{let{multiaddr:t}=e;return t.toString()}))),this.log("addresses for %p after filtering",null!==e&&void 0!==e?e:"unknown peer",c.map((e=>{let{multiaddr:t}=e;return t.toString()})))),0===c.length)throw new fu.sv("The dial request has no valid addresses",ppe.ERR_NO_VALID_ADDRESSES);if(c.length>this.maxPeerAddrsToDial)throw new fu.sv("dial with more addresses than allowed",ppe.ERR_TOO_MANY_ADDRESSES);const l=[];for(const d of c)null!=this.connectionGater.denyDialMultiaddr&&await this.connectionGater.denyDialMultiaddr(d.multiaddr)||l.push(d);const u=l.sort(this.addressSorter);if(0===u.length)throw new fu.sv("The connection gater denied all addresses in the dial request",ppe.ERR_NO_VALID_ADDRESSES);return u}async performDial(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e.multiaddrs.map((()=>new AbortController));try{const r=new Bm.Z({concurrency:1});r.on("error",(t=>{this.log.error("error dialing %s %o",e.multiaddrs,t)}));const i=await Promise.any(e.multiaddrs.map((async(i,o)=>{const s=n[o];if(null==s)throw new fu.sv("dialAction did not come with an AbortController",ppe.ERR_INVALID_PARAMETERS);const a=function(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const o of n)null!=o&&((0,fu.Wp)(1/0,o),e.push(o));const i=Ape(e);return(0,fu.Wp)(1/0,i),i}(s.signal,t.signal);a.addEventListener("abort",(()=>{this.log("dial to %a aborted",i)}));const c=Ws();return await r.add((async()=>{if(a.aborted)return this.log("dial to %a was aborted before reaching the head of the peer dial queue",i),void c.reject(new fu._L);await this.queue.add((async()=>{try{if(a.aborted)return this.log("dial to %a was aborted before reaching the head of the dial queue",i),void c.reject(new fu._L);e.status="active";const r=await this.transportManager.dial(i,{...t,signal:a});if(s.signal.aborted)return this.log("multiple dials succeeded, closing superfluous connection"),r.close().catch((e=>{this.log.error("error closing superfluous connection",e)})),void c.reject(new fu._L);n[o]=void 0,n.forEach((e=>{void 0!==e&&e.abort()})),this.log("dial to %a succeeded",i),c.resolve(r)}catch(r){this.log.error("error during dial of %a",i,r),c.reject(r)}}),{...t,signal:a}).catch((e=>{c.reject(e)}))}),{signal:a}).catch((e=>{c.reject(e)})).finally((()=>{a.clear()})),c.promise})));if(null==i)throw new fu.sv("successful dial led to empty object returned from peer dial queue",ppe.ERR_TRANSPORT_DIAL_FAILED);return e.status="success",i}catch(r){if(e.status="error",1===e.multiaddrs.length&&"AggregateError"===r.name)throw r.errors[0];throw r}}}const Cpe=5,Tpe=100,kpe=5,Rpe=10,xpe=25,Ppe=0,Dpe=100;class Ope{constructor(e){var t,n,r,i,o,s,a,c,l,u,h,d,f,p;let g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,Yo.Z)(this,"started",void 0),(0,Yo.Z)(this,"connections",void 0),(0,Yo.Z)(this,"allow",void 0),(0,Yo.Z)(this,"deny",void 0),(0,Yo.Z)(this,"maxIncomingPendingConnections",void 0),(0,Yo.Z)(this,"incomingPendingConnections",void 0),(0,Yo.Z)(this,"maxConnections",void 0),(0,Yo.Z)(this,"dialQueue",void 0),(0,Yo.Z)(this,"autoDial",void 0),(0,Yo.Z)(this,"connectionPruner",void 0),(0,Yo.Z)(this,"inboundConnectionRateLimiter",void 0),(0,Yo.Z)(this,"peerStore",void 0),(0,Yo.Z)(this,"metrics",void 0),(0,Yo.Z)(this,"events",void 0),(0,Yo.Z)(this,"log",void 0),this.maxConnections=null!==(t=g.maxConnections)&&void 0!==t?t:Tpe;const y=null!==(n=g.minConnections)&&void 0!==n?n:Cpe;if(this.maxConnections<y)throw new fu.sv("Connection Manager maxConnections must be greater than minConnections",ppe.ERR_INVALID_PARAMETERS);this.connections=new lx,this.started=!1,this.peerStore=e.peerStore,this.metrics=e.metrics,this.events=e.events,this.log=e.logger.forComponent("libp2p:connection-manager"),this.onConnect=this.onConnect.bind(this),this.onDisconnect=this.onDisconnect.bind(this),this.events.addEventListener("connection:open",this.onConnect),this.events.addEventListener("connection:close",this.onDisconnect),this.allow=(null!==(r=g.allow)&&void 0!==r?r:[]).map((e=>(0,ng.HM)(e))),this.deny=(null!==(i=g.deny)&&void 0!==i?i:[]).map((e=>(0,ng.HM)(e))),this.incomingPendingConnections=0,this.maxIncomingPendingConnections=null!==(o=g.maxIncomingPendingConnections)&&void 0!==o?o:Rpe,this.inboundConnectionRateLimiter=new c5.RateLimiterMemory({points:null!==(s=g.inboundConnectionThreshold)&&void 0!==s?s:kpe,duration:1}),this.autoDial=new bpe({connectionManager:this,peerStore:e.peerStore,events:e.events,logger:e.logger},{minConnections:y,autoDialConcurrency:null!==(a=g.autoDialConcurrency)&&void 0!==a?a:xpe,autoDialPriority:null!==(c=g.autoDialPriority)&&void 0!==c?c:Ppe,maxQueueLength:null!==(l=g.autoDialMaxQueueLength)&&void 0!==l?l:Dpe}),this.connectionPruner=new Epe({connectionManager:this,peerStore:e.peerStore,events:e.events,logger:e.logger},{maxConnections:this.maxConnections,allow:this.allow}),this.dialQueue=new Ipe({peerId:e.peerId,metrics:e.metrics,peerStore:e.peerStore,transportManager:e.transportManager,connectionGater:e.connectionGater,logger:e.logger},{addressSorter:null!==(u=g.addressSorter)&&void 0!==u?u:dpe,maxParallelDials:null!==(h=g.maxParallelDials)&&void 0!==h?h:50,maxPeerAddrsToDial:null!==(d=g.maxPeerAddrsToDial)&&void 0!==d?d:25,dialTimeout:null!==(f=g.dialTimeout)&&void 0!==f?f:3e4,resolvers:null!==(p=g.resolvers)&&void 0!==p?p:{dnsaddr:i5},connections:this.connections})}isStarted(){return this.started}async start(){var e,t,n;null===(e=this.metrics)||void 0===e||e.registerMetricGroup("libp2p_connection_manager_connections",{calculate:()=>{const e={inbound:0,outbound:0};for(const t of this.connections.values())for(const n of t)"inbound"===n.direction?e.inbound++:e.outbound++;return e}}),null===(t=this.metrics)||void 0===t||t.registerMetricGroup("libp2p_protocol_streams_total",{label:"protocol",calculate:()=>{const e={};for(const r of this.connections.values())for(const i of r)for(const r of i.streams){var t,n;const i="".concat(r.direction," ").concat(null!==(t=r.protocol)&&void 0!==t?t:"unnegotiated");e[i]=(null!==(n=e[i])&&void 0!==n?n:0)+1}return e}}),null===(n=this.metrics)||void 0===n||n.registerMetricGroup("libp2p_connection_manager_protocol_streams_per_connection_90th_percentile",{label:"protocol",calculate:()=>{const e={};for(const o of this.connections.values())for(const i of o){const o={};for(const e of i.streams){var t,n;const r="".concat(e.direction," ").concat(null!==(t=e.protocol)&&void 0!==t?t:"unnegotiated");o[r]=(null!==(n=o[r])&&void 0!==n?n:0)+1}for(const[t,n]of Object.entries(o)){var r;e[t]=null!==(r=e[t])&&void 0!==r?r:[],e[t].push(n)}}const i={};for(let[o,s]of Object.entries(e)){s=s.sort(((e,t)=>e-t));const e=Math.floor(.9*s.length);i[o]=s[e]}return i}}),this.autoDial.start(),this.started=!0,this.log("started")}async afterStart(){Promise.resolve().then((async()=>{const e=await this.peerStore.all({filters:[e=>e.tags.has("keep-alive")]});await Promise.all(e.map((async e=>{await this.openConnection(e.id).catch((e=>{this.log.error(e)}))})))})).catch((e=>{this.log.error(e)})),this.autoDial.afterStart()}async stop(){this.dialQueue.stop(),this.autoDial.stop();const e=[];for(const t of this.connections.values())for(const n of t)e.push((async()=>{try{await n.close()}catch(e){this.log.error(e)}})());this.log("closing %d connections",e.length),await Promise.all(e),this.connections.clear(),this.log("stopped")}onConnect(e){this._onConnect(e).catch((e=>{this.log.error(e)}))}async _onConnect(e){const{detail:t}=e;if(!this.started)return void await t.close();const n=t.remotePeer,r=this.connections.get(n);let i=!1;null!=r?r.push(t):(i=!0,this.connections.set(n,[t])),null!=n.publicKey&&"RSA"===n.type&&await this.peerStore.patch(n,{publicKey:n.publicKey}),i&&this.events.safeDispatchEvent("peer:connect",{detail:t.remotePeer})}onDisconnect(e){const{detail:t}=e;if(!this.started)return;const n=t.remotePeer;let r=this.connections.get(n);null!=r&&r.length>1?(r=r.filter((e=>e.id!==t.id)),this.connections.set(n,r)):null!=r&&(this.connections.delete(n),this.events.safeDispatchEvent("peer:disconnect",{detail:t.remotePeer}))}getConnections(e){var t;if(null!=e)return null!==(t=this.connections.get(e))&&void 0!==t?t:[];let n=[];for(const r of this.connections.values())n=n.concat(r);return n}getConnectionsMap(){return this.connections}async openConnection(e){var t,n;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isStarted())throw new fu.sv("Not started",ppe.ERR_NODE_NOT_STARTED);null===(t=r.signal)||void 0===t||t.throwIfAborted();const{peerId:i}=ype(e);if(null!=i&&!0!==r.force){this.log("dial %p",i);const e=this.getConnections(i).find((e=>!e.transient));if(null!=e)return this.log("had an existing non-transient connection to %p",i),e}const o=await this.dialQueue.dial(e,{...r,priority:null!==(n=r.priority)&&void 0!==n?n:50});let s=this.connections.get(o.remotePeer);null==s&&(s=[],this.connections.set(o.remotePeer,s));let a=!1;for(const c of s)c.id===o.id&&(a=!0);return a||s.push(o),o}async closeConnections(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=null!==(t=this.connections.get(e))&&void 0!==t?t:[];await Promise.all(r.map((async e=>{try{await e.close(n)}catch(t){e.abort(t)}})))}async acceptIncomingConnection(e){if(this.deny.some((t=>e.remoteAddr.toString().startsWith(t.toString()))))return this.log("connection from %a refused - connection remote address was in deny list",e.remoteAddr),!1;if(this.allow.some((t=>e.remoteAddr.toString().startsWith(t.toString()))))return this.incomingPendingConnections++,!0;if(this.incomingPendingConnections===this.maxIncomingPendingConnections)return this.log("connection from %a refused - incomingPendingConnections exceeded by host",e.remoteAddr),!1;if(e.remoteAddr.isThinWaistAddress()){const t=e.remoteAddr.nodeAddress().address;try{await this.inboundConnectionRateLimiter.consume(t,1)}catch{return this.log("connection from %a refused - inboundConnectionThreshold exceeded by host %s",e.remoteAddr,t),!1}}return this.getConnections().length<this.maxConnections?(this.incomingPendingConnections++,!0):(this.log("connection from %a refused - maxConnections exceeded",e.remoteAddr),!1)}afterUpgradeInbound(){this.incomingPendingConnections--}getDialQueue(){return this.dialQueue.pendingDials}}const Npe=function(e,t){if(null!=e[Symbol.asyncIterator])return async function*(){for await(const n of e)yield t(n)}();const n=IV(e),{value:r,done:i}=n.next();if(!0===i)return function*(){}();const o=t(r);if("function"===typeof o.then)return async function*(){yield await o;for await(const e of n)yield t(e)}();const s=t;return function*(){yield o;for(const e of n)yield s(e)}()};async function*Bpe(e,t){yield*Npe(e,(async e=>(await t.merge(e.id,{multiaddrs:e.multiaddrs}),e)))}function Lpe(e){const t=new Set;return CV(e,(e=>!t.has(e.id.toString())&&(t.add(e.id.toString()),!0)))}function Mpe(e){try{let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return async function*(){let n=0;for await(const t of e)n++,yield t;if(n<t)throw new fu.sv("more peers required, seen: ".concat(n,"  min: ").concat(t),"NOT_FOUND")}()}catch(t){return Promise.reject(t)}}class Upe{constructor(e,t){var n;(0,Yo.Z)(this,"routers",void 0),(0,Yo.Z)(this,"started",void 0),(0,Yo.Z)(this,"components",void 0),this.routers=null!==(n=t.routers)&&void 0!==n?n:[],this.started=!1,this.components=e}isStarted(){return this.started}async start(){this.started=!0}async stop(){this.started=!1}findProviders(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){if(0===t.routers.length)throw new fu.sv("No content routers available",ppe.ERR_NO_ROUTERS_AVAILABLE);yield*ma(ya(...t.routers.map((t=>t.findProviders(e,n)))),(e=>Bpe(e,t.components.peerStore)),(e=>Lpe(e)),(e=>Mpe(e)))}()}catch(n){return Promise.reject(n)}}async provide(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===this.routers.length)throw new fu.sv("No content routers available",ppe.ERR_NO_ROUTERS_AVAILABLE);await Promise.all(this.routers.map((async n=>{await n.provide(e,t)})))}async put(e,t,n){if(!this.isStarted())throw new fu.sv(fpe.NOT_STARTED_YET,ppe.DHT_NOT_STARTED);await Promise.all(this.routers.map((async r=>{await r.put(e,t,n)})))}async get(e,t){if(!this.isStarted())throw new fu.sv(fpe.NOT_STARTED_YET,ppe.DHT_NOT_STARTED);return Promise.any(this.routers.map((async n=>n.get(e,t))))}}const Fpe=function(e){if(null!=e[Symbol.asyncIterator])return(async()=>{for await(const t of e)return t})();for(const t of e)return t};class Kpe{constructor(e,t){var n;(0,Yo.Z)(this,"log",void 0),(0,Yo.Z)(this,"peerId",void 0),(0,Yo.Z)(this,"peerStore",void 0),(0,Yo.Z)(this,"routers",void 0),this.log=e.logger.forComponent("libp2p:peer-routing"),this.peerId=e.peerId,this.peerStore=e.peerStore,this.routers=null!==(n=t.routers)&&void 0!==n?n:[]}async findPeer(e,t){if(0===this.routers.length)throw new fu.sv("No peer routers available",ppe.ERR_NO_ROUTERS_AVAILABLE);if(e.toString()===this.peerId.toString())throw new fu.sv("Should not try to find self",ppe.ERR_FIND_SELF);const n=this,r=await ma(ya(...this.routers.map((r=>async function*(){try{yield await r.findPeer(e,t)}catch(i){n.log.error(i)}}()))),(e=>CV(e,Boolean)),(e=>Bpe(e,this.peerStore)),(async e=>Fpe(e)));if(null!=r)return r;throw new fu.sv(fpe.NOT_FOUND,ppe.ERR_NOT_FOUND)}async*getClosestPeers(e,t){if(0===this.routers.length)throw new fu.sv("No peer routers available",ppe.ERR_NO_ROUTERS_AVAILABLE);yield*ma(ya(...this.routers.map((n=>n.getClosestPeers(e,t)))),(e=>Bpe(e,this.peerStore)),(e=>Lpe(e)),(e=>Mpe(e)))}}class jpe{constructor(e){(0,Yo.Z)(this,"log",void 0),(0,Yo.Z)(this,"topologies",void 0),(0,Yo.Z)(this,"handlers",void 0),(0,Yo.Z)(this,"components",void 0),this.log=e.logger.forComponent("libp2p:registrar"),this.topologies=new Map,this.handlers=new Map,this.components=e,this._onDisconnect=this._onDisconnect.bind(this),this._onPeerUpdate=this._onPeerUpdate.bind(this),this._onPeerIdentify=this._onPeerIdentify.bind(this),this.components.events.addEventListener("peer:disconnect",this._onDisconnect),this.components.events.addEventListener("peer:update",this._onPeerUpdate),this.components.events.addEventListener("peer:identify",this._onPeerIdentify)}getProtocols(){return Array.from(new Set([...this.handlers.keys()])).sort()}getHandler(e){const t=this.handlers.get(e);if(null==t)throw new fu.sv("No handler registered for protocol ".concat(e),ppe.ERR_NO_HANDLER_FOR_PROTOCOL);return t}getTopologies(e){const t=this.topologies.get(e);return null==t?[]:[...t.values()]}async handle(e,t,n){if(this.handlers.has(e))throw new fu.sv("Handler already registered for protocol ".concat(e),ppe.ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED);const r=g0.Z.bind({ignoreUndefined:!0})({maxInboundStreams:32,maxOutboundStreams:64},n);this.handlers.set(e,{handler:t,options:r}),await this.components.peerStore.merge(this.components.peerId,{protocols:[e]})}async unhandle(e){(Array.isArray(e)?e:[e]).forEach((e=>{this.handlers.delete(e)})),await this.components.peerStore.patch(this.components.peerId,{protocols:this.getProtocols()})}async register(e,t){if(null==t)throw new fu.sv("invalid topology",ppe.ERR_INVALID_PARAMETERS);const n="".concat((1e9*Math.random()).toString(36)).concat(Date.now());let r=this.topologies.get(e);return null==r&&(r=new Map,this.topologies.set(e,r)),r.set(n,t),n}unregister(e){for(const[t,n]of this.topologies.entries())n.has(e)&&(n.delete(e),0===n.size&&this.topologies.delete(t))}_onDisconnect(e){const t=e.detail;this.components.peerStore.get(t).then((e=>{for(const r of e.protocols){const e=this.topologies.get(r);if(null!=e)for(const r of e.values()){var n;null===(n=r.onDisconnect)||void 0===n||n.call(r,t)}}})).catch((e=>{e.code!==ppe.ERR_NOT_FOUND&&this.log.error("could not inform topologies of disconnecting peer %p",t,e)}))}_onPeerUpdate(e){var t;const{peer:n,previous:r}=e.detail,i=(null!==(t=null===r||void 0===r?void 0:r.protocols)&&void 0!==t?t:[]).filter((e=>!n.protocols.includes(e)));for(const s of i){const e=this.topologies.get(s);if(null!=e)for(const t of e.values()){var o;null===(o=t.onDisconnect)||void 0===o||o.call(t,n.id)}}}_onPeerIdentify(e){const t=e.detail.protocols,n=e.detail.connection,r=e.detail.peerId;for(const o of t){const e=this.topologies.get(o);if(null!=e)for(const t of e.values()){var i;n.transient&&!0!==t.notifyOnTransient||(null===(i=t.onConnect)||void 0===i||i.call(t,r,n))}}}}class Zpe extends Map{constructor(e){super(),(0,Yo.Z)(this,"metric",void 0);const{name:t,metrics:n}=e;this.metric=n.registerMetric(t),this.updateComponentMetric()}set(e,t){return super.set(e,t),this.updateComponentMetric(),this}delete(e){const t=super.delete(e);return this.updateComponentMetric(),t}clear(){super.clear(),this.updateComponentMetric()}updateComponentMetric(){this.metric.update(this.size)}}class zpe{constructor(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,Yo.Z)(this,"log",void 0),(0,Yo.Z)(this,"components",void 0),(0,Yo.Z)(this,"transports",void 0),(0,Yo.Z)(this,"listeners",void 0),(0,Yo.Z)(this,"faultTolerance",void 0),(0,Yo.Z)(this,"started",void 0),this.log=e.logger.forComponent("libp2p:transports"),this.components=e,this.started=!1,this.transports=new Map,this.listeners=function(e){const{name:t,metrics:n}=e;let r;return r=null!=n?new Zpe({name:t,metrics:n}):new Map,r}({name:"libp2p_transport_manager_listeners",metrics:this.components.metrics}),this.faultTolerance=null!==(t=n.faultTolerance)&&void 0!==t?t:fu.P7.FATAL_ALL}add(e){const t=e[Symbol.toStringTag];if(null==t)throw new fu.sv("Transport must have a valid tag",ppe.ERR_INVALID_KEY);if(this.transports.has(t))throw new fu.sv("There is already a transport with the tag ".concat(t),ppe.ERR_DUPLICATE_TRANSPORT);this.log("adding transport %s",t),this.transports.set(t,e),this.listeners.has(t)||this.listeners.set(t,[])}isStarted(){return this.started}start(){this.started=!0}async afterStart(){const e=this.components.addressManager.getListenAddrs();await this.listen(e)}async stop(){const e=[];for(const[t,n]of this.listeners)for(this.log("closing listeners for %s",t);n.length>0;){const t=n.pop();null!=t&&e.push(t.close())}await Promise.all(e),this.log("all listeners closed");for(const t of this.listeners.keys())this.listeners.set(t,[]);this.started=!1}async dial(e,t){const n=this.transportForMultiaddr(e);if(null==n)throw new fu.sv("No transport available for address ".concat(String(e)),ppe.ERR_TRANSPORT_UNAVAILABLE);try{return await n.dial(e,{...t,upgrader:this.components.upgrader})}catch(r){throw null==r.code&&(r.code=ppe.ERR_TRANSPORT_DIAL_FAILED),r}}getAddrs(){let e=[];for(const t of this.listeners.values())for(const n of t)e=[...e,...n.getAddrs()];return e}getTransports(){return Array.of(...this.transports.values())}getListeners(){return Array.of(...this.listeners.values()).flat()}transportForMultiaddr(e){for(const t of this.transports.values()){if(t.filter([e]).length>0)return t}}async listen(e){if(!this.isStarted())throw new fu.sv("Not started",ppe.ERR_NODE_NOT_STARTED);if(null==e||0===e.length)return void this.log("no addresses were provided for listening, this node is dial only");const t=[];for(const[r,i]of this.transports.entries()){const o=i.filter(e),s=[];for(const e of o){var n;this.log("creating listener for %s on %a",r,e);const t=i.createListener({upgrader:this.components.upgrader});let o=null!==(n=this.listeners.get(r))&&void 0!==n?n:[];null==o&&(o=[],this.listeners.set(r,o)),o.push(t),t.addEventListener("listening",(()=>{this.components.events.safeDispatchEvent("transport:listening",{detail:t})})),t.addEventListener("close",(()=>{const e=o.findIndex((e=>e===t));o.splice(e,1),this.components.events.safeDispatchEvent("transport:close",{detail:t})})),s.push(t.listen(e))}if(0===s.length){t.push(r);continue}if(null==(await Promise.allSettled(s)).find((e=>"fulfilled"===e.status))&&this.faultTolerance!==fu.P7.NO_FATAL)throw new fu.sv("Transport (".concat(r,") could not listen on any available address"),ppe.ERR_NO_VALID_ADDRESSES)}if(t.length===this.transports.size){const e="no valid addresses were provided for transports [".concat(t.join(", "),"]");if(this.faultTolerance===fu.P7.FATAL_ALL)throw new fu.sv(e,ppe.ERR_NO_VALID_ADDRESSES);this.log("libp2p in dial mode only: ".concat(e))}}async remove(e){var t;const n=null!==(t=this.listeners.get(e))&&void 0!==t?t:[];this.log.trace("removing transport %s",e);const r=[];for(this.log.trace("closing listeners for %s",e);n.length>0;){const e=n.pop();null!=e&&r.push(e.close())}await Promise.all(r),this.transports.delete(e),this.listeners.delete(e)}async removeAll(){const e=[];for(const t of this.transports.keys())e.push(this.remove(t));await Promise.all(e)}}class Vpe{constructor(e){var t;(0,Yo.Z)(this,"id",void 0),(0,Yo.Z)(this,"remoteAddr",void 0),(0,Yo.Z)(this,"remotePeer",void 0),(0,Yo.Z)(this,"direction",void 0),(0,Yo.Z)(this,"timeline",void 0),(0,Yo.Z)(this,"multiplexer",void 0),(0,Yo.Z)(this,"encryption",void 0),(0,Yo.Z)(this,"status",void 0),(0,Yo.Z)(this,"transient",void 0),(0,Yo.Z)(this,"log",void 0),(0,Yo.Z)(this,"tags",void 0),(0,Yo.Z)(this,"_newStream",void 0),(0,Yo.Z)(this,"_close",void 0),(0,Yo.Z)(this,"_abort",void 0),(0,Yo.Z)(this,"_getStreams",void 0),(0,Yo.Z)(this,Symbol.toStringTag,"Connection"),(0,Yo.Z)(this,fu.fL,!0);const{remoteAddr:n,remotePeer:r,newStream:i,close:o,abort:s,getStreams:a}=e;this.id="".concat(parseInt(String(1e9*Math.random())).toString(36)).concat(Date.now()),this.remoteAddr=n,this.remotePeer=r,this.direction=e.direction,this.status="open",this.timeline=e.timeline,this.multiplexer=e.multiplexer,this.encryption=e.encryption,this.transient=null!==(t=e.transient)&&void 0!==t&&t,this.log=e.logger.forComponent("libp2p:connection:".concat(this.direction,":").concat(this.id)),null==this.remoteAddr.getPeerId()&&(this.remoteAddr=this.remoteAddr.encapsulate("/p2p/".concat(this.remotePeer))),this._newStream=i,this._close=o,this._abort=s,this._getStreams=a,this.tags=[]}get streams(){return this._getStreams()}async newStream(e,t){if("closing"===this.status)throw new fu.sv("the connection is being closed","ERR_CONNECTION_BEING_CLOSED");if("closed"===this.status)throw new fu.sv("the connection is closed","ERR_CONNECTION_CLOSED");if(Array.isArray(e)||(e=[e]),this.transient&&!0!==(null===t||void 0===t?void 0:t.runOnTransientConnection))throw new fu.sv("Cannot open protocol stream on transient connection","ERR_TRANSIENT_CONNECTION");const n=await this._newStream(e,t);return n.direction="outbound",n}async close(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("closed"!==this.status&&"closing"!==this.status){if(this.log("closing connection to %a",this.remoteAddr),this.status="closing",null==e.signal){const t=AbortSignal.timeout(500);(0,fu.Wp)(1/0,t),e={...e,signal:t}}try{this.log.trace("closing all streams"),await Promise.all(this.streams.map((async t=>t.close(e)))),this.log.trace("closing underlying transport"),await this._close(e),this.log.trace("updating timeline with close time"),this.status="closed",this.timeline.close=Date.now()}catch(t){this.log.error("error encountered during graceful close of connection to %a",this.remoteAddr,t),this.abort(t)}}}abort(e){this.log.error("aborting connection to %a due to error",this.remoteAddr,e),this.status="closing",this.streams.forEach((t=>{t.abort(e)})),this.log.error("all streams aborted",this.streams.length),this._abort(e),this.timeline.close=Date.now(),this.status="closed"}}function Hpe(e,t,n){let r=0;return n.streams.forEach((n=>{n.direction===t&&n.protocol===e&&r++})),r}class qpe{constructor(e,t){var n;(0,Yo.Z)(this,"components",void 0),(0,Yo.Z)(this,"connectionEncryption",void 0),(0,Yo.Z)(this,"muxers",void 0),(0,Yo.Z)(this,"inboundUpgradeTimeout",void 0),(0,Yo.Z)(this,"events",void 0),(0,Yo.Z)(this,"log",void 0),this.components=e,this.connectionEncryption=new Map,this.log=e.logger.forComponent("libp2p:upgrader"),t.connectionEncryption.forEach((e=>{this.connectionEncryption.set(e.protocol,e)})),this.muxers=new Map,t.muxers.forEach((e=>{this.muxers.set(e.protocol,e)})),this.inboundUpgradeTimeout=null!==(n=t.inboundUpgradeTimeout)&&void 0!==n?n:3e4,this.events=e.events}async shouldBlockConnection(e,t,n){const r=this.components.connectionGater[n];if(void 0!==r&&await r(e,t))throw new fu.sv("The multiaddr connection is blocked by gater.".concat(n),ppe.ERR_CONNECTION_INTERCEPTED)}async upgradeInbound(e,t){if(!await this.components.connectionManager.acceptIncomingConnection(e))throw new fu.sv("connection denied",ppe.ERR_CONNECTION_DENIED);let n,r,i,o,s;const a=AbortSignal.timeout(this.inboundUpgradeTimeout),c=()=>{e.abort(new fu.sv("inbound upgrade timeout",fu.l9))};a.addEventListener("abort",c,{once:!0}),(0,fu.Wp)(1/0,a);try{var l,u,h;if(!0===await(null===(l=(u=this.components.connectionGater).denyInboundConnection)||void 0===l?void 0:l.call(u,e)))throw new fu.sv("The multiaddr connection is blocked by gater.acceptConnection",ppe.ERR_CONNECTION_INTERCEPTED);null===(h=this.components.metrics)||void 0===h||h.trackMultiaddrConnection(e),this.log("starting the inbound connection upgrade");let a=e;if(!0!==(null===t||void 0===t?void 0:t.skipProtection)){const t=this.components.connectionProtector;null!=t&&(this.log("protecting the inbound connection"),a=await t.protect(e))}try{if(n=a,!0!==(null===t||void 0===t?void 0:t.skipEncryption)){({conn:n,remotePeer:r,protocol:s}=await this._encryptInbound(a));const e={...a,...n};await this.shouldBlockConnection(r,e,"denyInboundEncryptedConnection")}else{const t=e.remoteAddr.getPeerId();if(null==t)throw new fu.sv("inbound connection that skipped encryption must have a peer id",ppe.ERR_INVALID_MULTIADDR);const n=Zh(t);s="native",r=n}if(i=n,null!=(null===t||void 0===t?void 0:t.muxerFactory))o=t.muxerFactory;else if(this.muxers.size>0){const e=await this._multiplexInbound({...a,...n},this.muxers);o=e.muxerFactory,i=e.stream}}catch(d){throw this.log.error("Failed to upgrade inbound connection",d),d}return await this.shouldBlockConnection(r,e,"denyInboundUpgradedConnection"),this.log("successfully upgraded inbound connection"),this._createConnection({cryptoProtocol:s,direction:"inbound",maConn:e,upgradedConn:i,muxerFactory:o,remotePeer:r,transient:null===t||void 0===t?void 0:t.transient})}finally{a.removeEventListener("abort",c),this.components.connectionManager.afterUpgradeInbound()}}async upgradeOutbound(e,t){var n;const r=e.remoteAddr.getPeerId();let i,o,s,a,c,l;null!=r&&(i=Zh(r),await this.shouldBlockConnection(i,e,"denyOutboundConnection")),null===(n=this.components.metrics)||void 0===n||n.trackMultiaddrConnection(e),this.log("Starting the outbound connection upgrade");let u=e;if(!0!==(null===t||void 0===t?void 0:t.skipProtection)){const t=this.components.connectionProtector;null!=t&&(u=await t.protect(e))}try{if(o=u,!0!==(null===t||void 0===t?void 0:t.skipEncryption)){({conn:o,remotePeer:s,protocol:c}=await this._encryptOutbound(u,i));const e={...u,...o};await this.shouldBlockConnection(s,e,"denyOutboundEncryptedConnection")}else{if(null==i)throw new fu.sv("Encryption was skipped but no peer id was passed",ppe.ERR_INVALID_PEER);c="native",s=i}if(a=o,null!=(null===t||void 0===t?void 0:t.muxerFactory))l=t.muxerFactory;else if(this.muxers.size>0){const e=await this._multiplexOutbound({...u,...o},this.muxers);l=e.muxerFactory,a=e.stream}}catch(h){throw this.log.error("Failed to upgrade outbound connection",h),await e.close(h),h}return await this.shouldBlockConnection(s,e,"denyOutboundUpgradedConnection"),this.log("Successfully upgraded outbound connection"),this._createConnection({cryptoProtocol:c,direction:"outbound",maConn:e,upgradedConn:a,muxerFactory:l,remotePeer:s,transient:null===t||void 0===t?void 0:t.transient})}_createConnection(e){var t,n,r=this;const{cryptoProtocol:i,direction:o,maConn:s,upgradedConn:a,remotePeer:c,muxerFactory:l,transient:u}=e;let h,d,f;null!=l&&(h=l.createStreamMuxer({direction:o,onIncomingStream:e=>{null!=f&&Promise.resolve().then((async()=>{var t;const n=this.components.registrar.getProtocols(),{stream:r,protocol:i}=await i4(e,n,{log:e.log,yieldBytes:!1});if(null==f)return;f.log("incoming stream opened on %s",i);const o=function(e,t){try{const{options:n}=t.getHandler(e);return n.maxInboundStreams}catch(n){if(n.code!==ppe.ERR_NO_HANDLER_FOR_PROTOCOL)throw n}return 32}(i,this.components.registrar);if(Hpe(i,"inbound",f)===o){const t=new fu.sv('Too many inbound protocol streams for protocol "'.concat(i,'" - limit ').concat(o),ppe.ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS);throw e.abort(t),t}e.source=r.source,e.sink=r.sink,e.protocol=i,null!=r.closeWrite&&(e.closeWrite=r.closeWrite),null!=r.closeRead&&(e.closeRead=r.closeRead),null!=r.close&&(e.close=r.close),await this.components.peerStore.merge(c,{protocols:[i]}),null===(t=this.components.metrics)||void 0===t||t.trackProtocolStream(e,f),this._onStream({connection:f,stream:e,protocol:i})})).catch((async t=>{this.log.error("error handling incoming stream id %s",e.id,t.message,t.code,t.stack),null==e.timeline.close&&await e.close()}))}}),d=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null==h)throw new fu.sv("Stream is not multiplexed",ppe.ERR_MUXER_UNAVAILABLE);f.log("starting new stream for protocols %s",e);const n=await h.newStream();f.log.trace("started new stream %s for protocols %s",n.id,e);try{var i;if(null==t.signal){r.log("No abort signal was passed while trying to negotiate protocols %s falling back to default timeout",e);const n=AbortSignal.timeout(3e4);(0,fu.Wp)(1/0,n),t={...t,signal:n}}n.log.trace("selecting protocol from protocols %s",e);const{stream:o,protocol:s}=await J5(n,e,{...t,log:n.log,yieldBytes:!0});n.log("selected protocol %s",s);const a=function(e,t){var n;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{const{options:n}=t.getHandler(e);if(null!=n.maxOutboundStreams)return n.maxOutboundStreams}catch(i){if(i.code!==ppe.ERR_NO_HANDLER_FOR_PROTOCOL)throw i}return null!==(n=r.maxOutboundStreams)&&void 0!==n?n:64}(s,r.components.registrar,t);if(Hpe(s,"outbound",f)>=a){const e=new fu.sv('Too many outbound protocol streams for protocol "'.concat(s,'" - limit ').concat(a),ppe.ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS);throw n.abort(e),e}return await r.components.peerStore.merge(c,{protocols:[s]}),n.source=o.source,n.sink=o.sink,n.protocol=s,null!=o.closeWrite&&(n.closeWrite=o.closeWrite),null!=o.closeRead&&(n.closeRead=o.closeRead),null!=o.close&&(n.close=o.close),null===(i=r.components.metrics)||void 0===i||i.trackProtocolStream(n,f),n}catch(o){if(f.log.error("could not create new stream for protocols %s",e,o),null==n.timeline.close&&n.abort(o),null!=o.code)throw o;throw new fu.sv(String(o),ppe.ERR_UNSUPPORTED_PROTOCOL)}},Promise.all([h.sink(a.source),a.sink(h.source)]).catch((e=>{this.log.error(e)})));const p=s.timeline;s.timeline=new Proxy(p,{set:function(){return null!=f&&"close"===(arguments.length<=1?void 0:arguments[1])&&null!=(arguments.length<=2?void 0:arguments[2])&&null==p.close&&(async()=>{try{"open"===f.status&&await f.close()}catch(e){r.log.error(e)}finally{r.events.safeDispatchEvent("connection:close",{detail:f})}})().catch((e=>{r.log.error(e)})),Reflect.set(...arguments)}}),s.timeline.upgraded=Date.now();var g;return g={remoteAddr:s.remoteAddr,remotePeer:c,status:"open",direction:o,timeline:s.timeline,multiplexer:null===(t=h)||void 0===t?void 0:t.protocol,encryption:i,transient:u,logger:this.components.logger,newStream:null!==(n=d)&&void 0!==n?n:()=>{throw new fu.sv("connection is not multiplexed",ppe.ERR_CONNECTION_NOT_MULTIPLEXED)},getStreams:()=>null!=h?h.streams:[],close:async e=>{null!=h&&(this.log.trace("close muxer"),await h.close(e)),this.log.trace("close maconn"),await s.close(e),this.log.trace("closed maconn")},abort:e=>{s.abort(e),null!=h&&h.abort(e)}},f=new Vpe(g),this.events.safeDispatchEvent("connection:open",{detail:f}),f}_onStream(e){const{connection:t,stream:n,protocol:r}=e,{handler:i,options:o}=this.components.registrar.getHandler(r);if(t.transient&&!0!==o.runOnTransientConnection)throw new fu.sv("Cannot open protocol stream on transient connection","ERR_TRANSIENT_CONNECTION");i({connection:t,stream:n})}async _encryptInbound(e){const t=Array.from(this.connectionEncryption.keys());this.log("handling inbound crypto protocol selection",t);try{const{stream:n,protocol:r}=await i4(e,t,{log:e.log}),i=this.connectionEncryption.get(r);if(null==i)throw new Error("no crypto module found for ".concat(r));return this.log("encrypting inbound connection using",r),{...await i.secureInbound(this.components.peerId,n),protocol:r}}catch(n){throw new fu.sv(String(n),ppe.ERR_ENCRYPTION_FAILED)}}async _encryptOutbound(e,t){const n=Array.from(this.connectionEncryption.keys());this.log("selecting outbound crypto protocol",n);try{e.log.trace("selecting encrypter from %s",n);const{stream:r,protocol:i}=await J5(e,n,{log:e.log,yieldBytes:!0}),o=this.connectionEncryption.get(i);if(null==o)throw new Error("no crypto module found for ".concat(i));return e.log("encrypting outbound connection to %p using %p",t),{...await o.secureOutbound(this.components.peerId,r,t),protocol:i}}catch(r){throw new fu.sv(String(r),ppe.ERR_ENCRYPTION_FAILED)}}async _multiplexOutbound(e,t){const n=Array.from(t.keys());this.log("outbound selecting muxer %s",n);try{e.log.trace("selecting stream muxer from %s",n);const{stream:r,protocol:i}=await J5(e,n,{log:e.log,yieldBytes:!0});e.log("selected %s as muxer protocol",i);return{stream:r,muxerFactory:t.get(i)}}catch(r){throw e.log.error("error multiplexing outbound stream",r),new fu.sv(String(r),ppe.ERR_MUXER_UNAVAILABLE)}}async _multiplexInbound(e,t){const n=Array.from(t.keys());this.log("inbound handling muxers %s",n);try{const{stream:r,protocol:i}=await i4(e,n,{log:e.log});return{stream:r,muxerFactory:t.get(i)}}catch(r){throw this.log.error("error multiplexing inbound stream",r),new fu.sv(String(r),ppe.ERR_MUXER_UNAVAILABLE)}}}var Gpe=new WeakMap,Wpe=new WeakSet;class Qpe extends fu.Le{constructor(e){var t,n,r,i,o,s,a,c;super(),Qd(this,Wpe),(0,Yo.Z)(this,"peerId",void 0),(0,Yo.Z)(this,"peerStore",void 0),(0,Yo.Z)(this,"contentRouting",void 0),(0,Yo.Z)(this,"peerRouting",void 0),(0,Yo.Z)(this,"metrics",void 0),(0,Yo.Z)(this,"services",void 0),(0,Yo.Z)(this,"logger",void 0),(0,Yo.Z)(this,"components",void 0),(0,dx.Z)(this,Gpe,{writable:!0,value:void 0}),(0,Yo.Z)(this,"log",void 0);const l=new fu.Le,u=l.dispatchEvent.bind(l);l.dispatchEvent=e=>{const t=u(e),n=this.dispatchEvent(new fu.Aw(e.type,{detail:e.detail}));return t||n},(0,fu.Wp)(1/0,l),CG(this,Gpe,!1),this.peerId=e.peerId,this.logger=null!==(t=e.logger)&&void 0!==t?t:npe(),this.log=this.logger.forComponent("libp2p"),this.services={};const h=this.components=function(){const e=new ape(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});return new Proxy(e,{get(t,n,r){if("string"===typeof n&&!lpe.includes(n)){const t=e.components[n];if(null==t&&!cpe.includes(n))throw new fu.sv("".concat(n," not set"),"ERR_SERVICE_MISSING");return t}return Reflect.get(t,n,r)},set:(t,n,r)=>("string"===typeof n?e.components[n]=r:Reflect.set(t,n,r),!0)})}({peerId:e.peerId,nodeInfo:null!==(n=e.nodeInfo)&&void 0!==n?n:{name:"libp2p",version:"1.0.0"},logger:this.logger,events:l,datastore:null!==(r=e.datastore)&&void 0!==r?r:new PV,connectionGater:upe(e.connectionGater)});this.peerStore=this.configureComponent("peerStore",new B3(h,{addressFilter:this.components.connectionGater.filterMultiaddrForPeer,...e.peerStore})),null!=e.metrics&&(this.metrics=this.configureComponent("metrics",e.metrics(this.components))),h.events.addEventListener("peer:update",(e=>{if(null==e.detail.previous){const t={id:e.detail.peer.id,multiaddrs:e.detail.peer.addresses.map((e=>e.multiaddr))};h.events.safeDispatchEvent("peer:discovery",{detail:t})}})),null!=e.connectionProtector&&this.configureComponent("connectionProtector",e.connectionProtector(h)),this.components.upgrader=new qpe(this.components,{connectionEncryption:(null!==(i=e.connectionEncryption)&&void 0!==i?i:[]).map(((e,t)=>this.configureComponent("connection-encryption-".concat(t),e(this.components)))),muxers:(null!==(o=e.streamMuxers)&&void 0!==o?o:[]).map(((e,t)=>this.configureComponent("stream-muxers-".concat(t),e(this.components)))),inboundUpgradeTimeout:e.connectionManager.inboundUpgradeTimeout}),this.configureComponent("transportManager",new zpe(this.components,e.transportManager)),this.configureComponent("connectionManager",new Ope(this.components,e.connectionManager)),this.configureComponent("registrar",new jpe(this.components)),this.configureComponent("addressManager",new spe(this.components,e.addresses));const d=(null!==(s=e.peerRouters)&&void 0!==s?s:[]).map(((e,t)=>this.configureComponent("peer-router-".concat(t),e(this.components))));this.peerRouting=this.components.peerRouting=this.configureComponent("peerRouting",new Kpe(this.components,{routers:d}));const f=(null!==(a=e.contentRouters)&&void 0!==a?a:[]).map(((e,t)=>this.configureComponent("content-router-".concat(t),e(this.components))));if(this.contentRouting=this.components.contentRouting=this.configureComponent("contentRouting",new Upe(this.components,{routers:f})),(null!==(c=e.peerDiscovery)&&void 0!==c?c:[]).forEach(((e,t)=>{this.configureComponent("peer-discovery-".concat(t),e(this.components)).addEventListener("peer",(e=>{Yd(this,Wpe,Ype).call(this,e)}))})),e.transports.forEach(((e,t)=>{this.components.transportManager.add(this.configureComponent("transport-".concat(t),e(this.components)))})),null!=e.services)for(const p of Object.keys(e.services)){const t=(0,e.services[p])(this.components);null!=t?(this.services[p]=t,this.configureComponent(p,t),null!=t[fu.wj]&&(this.log("registering service %s for content routing",p),f.push(t[fu.wj])),null!=t[fu.mV]&&(this.log("registering service %s for peer routing",p),d.push(t[fu.mV])),null!=t[fu.JX]&&(this.log("registering service %s for peer discovery",p),t[fu.JX].addEventListener("peer",(e=>{Yd(this,Wpe,Ype).call(this,e)})))):this.log.error("service factory %s returned null or undefined instance",p)}}configureComponent(e,t){return null==t&&this.log.error("component %s was null or undefined",e),this.components[e]=t,t}async start(){if(!(0,fx.Z)(this,Gpe)){CG(this,Gpe,!0),this.log("libp2p is starting");try{var e,t,n,r;await(null===(e=(t=this.components).beforeStart)||void 0===e?void 0:e.call(t)),await this.components.start(),await(null===(n=(r=this.components).afterStart)||void 0===n?void 0:n.call(r)),this.safeDispatchEvent("start",{detail:this}),this.log("libp2p has started")}catch(i){throw this.log.error("An error occurred starting libp2p",i),await this.stop(),i}}}async stop(){var e,t,n,r;(0,fx.Z)(this,Gpe)&&(this.log("libp2p is stopping"),CG(this,Gpe,!1),await(null===(e=(t=this.components).beforeStop)||void 0===e?void 0:e.call(t)),await this.components.stop(),await(null===(n=(r=this.components).afterStop)||void 0===n?void 0:n.call(r)),this.safeDispatchEvent("stop",{detail:this}),this.log("libp2p has stopped"))}isStarted(){return(0,fx.Z)(this,Gpe)}getConnections(e){return this.components.connectionManager.getConnections(e)}getDialQueue(){return this.components.connectionManager.getDialQueue()}getPeers(){const e=new ux;for(const t of this.components.connectionManager.getConnections())e.add(t.remotePeer);return Array.from(e)}async dial(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.components.connectionManager.openConnection(e,t)}async dialProtocol(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null==t)throw new fu.sv("no protocols were provided to open a stream",ppe.ERR_INVALID_PROTOCOLS_FOR_STREAM);if(0===(t=Array.isArray(t)?t:[t]).length)throw new fu.sv("no protocols were provided to open a stream",ppe.ERR_INVALID_PROTOCOLS_FOR_STREAM);return(await this.dial(e,n)).newStream(t,n)}getMultiaddrs(){return this.components.addressManager.getAddresses()}getProtocols(){return this.components.registrar.getProtocols()}async hangUp(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;(0,ng.h2)(e)&&(e=Zh(null!==(n=e.getPeerId())&&void 0!==n?n:""));await this.components.connectionManager.closeConnections(e,t)}async getPublicKey(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.log("getPublicKey %p",e),null!=e.publicKey)return e.publicKey;const n=await this.peerStore.get(e);if(null!=n.id.publicKey)return n.id.publicKey;const r=(0,Ls.z)([(0,yu.m)("/pk/"),e.multihash.digest]),i=await this.contentRouting.get(r,t);return xh(i),await this.peerStore.patch(e,{publicKey:i}),i}async handle(e,t,n){Array.isArray(e)||(e=[e]),await Promise.all(e.map((async e=>{await this.components.registrar.handle(e,t,n)})))}async unhandle(e){Array.isArray(e)||(e=[e]),await Promise.all(e.map((async e=>{await this.components.registrar.unhandle(e)})))}async register(e,t){return this.components.registrar.register(e,t)}unregister(e){this.components.registrar.unregister(e)}}function Ype(e){const{detail:t}=e;t.id.toString()!==this.peerId.toString()?this.components.peerStore.merge(t.id,{multiaddrs:t.multiaddrs}).catch((e=>{this.log.error(e)})):this.log.error(new Error(ppe.ERR_DISCOVERED_SELF))}async function Jpe(e){var t;return null!==(t=e.peerId)&&void 0!==t||(e.peerId=await TA()),new Qpe(function(e){var t,n;const r=(0,g0.Z)(gpe,e);if(null==r.transports||r.transports.length<1)throw new fu.sv(fpe.ERR_TRANSPORTS_REQUIRED,ppe.ERR_TRANSPORTS_REQUIRED);if(null===r.connectionProtector&&null!=(null===(t=globalThis.process)||void 0===t||null===(n=t.env)||void 0===n?void 0:n.LIBP2P_FORCE_PNET))throw new fu.sv(fpe.ERR_PROTECTOR_REQUIRED,ppe.ERR_PROTECTOR_REQUIRED);return r}(e))}async function Xpe(e){var t;const n=new yV,r=new PV,i=await async function(e){const t=await Jpe(e);return!1!==e.start&&await t.start(),t}({connectionManager:{minConnections:0},datastore:r,transports:[e=>new BL(e,o),NU(),pz(),bF(),cP({discoverRelays:1})],connectionEncryption:[sd()],streamMuxers:[Gd()],services:{identify:TO(),autoNAT:wS(),delegatedRouting:()=>Xm("https://delegated-ipfs.dev")}});var o;const s=[BG({gateways:["".concat(null!==(t=e.protocol)&&void 0!==t?t:"http","://").concat(e.host,":").concat(e.port)]})];(function(){const e="explore.ipld.gatewayEnabled";console.info("\ud83c\udf9b\ufe0f Customise whether ipld-explorer-components fetches content from gateways by setting an '".concat(e,"' value to true/false in localStorage. e.g. localStorage.setItem('explore.ipld.gatewayEnabled', false) -- NOTE: defaults to true"));const t=localStorage.getItem(e);return null==t||JSON.parse(t)})()&&s.push(BG());const a=await tpe({blockBrokers:[...s],hashers:await(0,Xr.i)(17,18,19,20,27,30),datastore:r,blockstore:n,libp2p:i});return await Promise.allSettled([ei(a,"dag-json",{hello:"world"}),ei(a,"dag-cbor",{hello:"world"},27),ei(a,"json",{hello:"world"},20),ei(a,"json",{hello:"world"},30),ei(a,"raw",(new TextEncoder).encode("hello"),30)]),a}const $pe={kuboGatewayOptions:{host:"127.0.0.1",port:"8080",protocol:"http"},error:null};let ege=null;const tge={name:"helia",reducer(e,t){var n;let{type:r,payload:i,error:o}=t;var s;return e=null!==(n=e)&&void 0!==n?n:$pe,"HELIA_INIT_FINISHED"===r?Object.assign({},e,{kuboGatewayOptions:null!==(s=i.kuboGatewayOptions)&&void 0!==s?s:e.kuboGatewayOptions,error:null}):"HELIA_INIT_FAILED"===r?Object.assign({},e,{error:o}):e},selectHelia:()=>ege,selectHeliaReady:()=>null!==ege,selectHeliaIdentity:()=>{var e,t,n,r;const i=null===(e=ege)||void 0===e||null===(t=e.libp2p.services)||void 0===t?void 0:t.identify;return null!==(n=null===i||void 0===i||null===(r=i.host)||void 0===r?void 0:r.agentVersion.split(" ")[0])&&void 0!==n?n:"null"},doInitHelia:()=>async e=>{let{dispatch:t,getState:n}=e;t({type:"HELIA_INIT_STARTED"});const r=Object.assign({},n().helia.kuboGatewayOptions,function(e){let t={};if(null!=globalThis.localStorage)try{var n;const r=null!==(n=globalThis.localStorage.getItem(e))&&void 0!==n?n:"{}";t=JSON.parse(r)}catch(r){console.error("Error reading '".concat(e,"' value from localStorage"),r)}return t}("kuboGateway"));try{return console.info("\ud83c\udf9b\ufe0f Customise your Kubo gateway opts by setting an `kuboGateway` value in localStorage. e.g. localStorage.setItem('kuboGateway', JSON.stringify({port: '1337'}))"),console.time("HELIA_INIT"),ege=await Xpe(r),console.timeEnd("HELIA_INIT"),t({type:"HELIA_INIT_FINISHED",payload:{kuboGatewayOptions:r,provider:"helia"}})}catch(i){return t({type:"HELIA_INIT_FAILED",error:i})}}},nge=tge;n(24461);var rge=n(72791),ige=n(87945),oge=n(218);const sge=n.p+"static/media/spinner.2b9ba5ad729c470bcc2f15327fe033d5.svg";const age=n.p+"static/media/upload.62e1d0494e4ab941631324eac71c71a4.svg";class cge extends rge.Component{constructor(e){super(e),this.state={file:{}},this.handleOnChange=this.handleOnChange.bind(this),this.handleOnSubmit=this.handleOnSubmit.bind(this)}handleOnSubmit(e){e.preventDefault()}handleOnChange(){document.getElementById("car-loader-image").src=sge;const e=document.getElementById("car-file").files[0];this.props.doUploadUserProvidedCar(e,age)}render(){const{t:e}=this.props;return rge.createElement("form",{"data-id":"IpldCarExploreForm",className:"sans-serif black-80 flex",onSubmit:this.handleOnSubmit,encType:"multipart/form-data"},rge.createElement("div",{className:"flex-auto"},rge.createElement("div",{className:"relative"},rge.createElement("input",{id:"car-file",type:"file",accept:".car",className:"input-reset bn pa2 mb2 db w-100 f6 br-0 placeholder-light focus-outline",style:{borderRadius:"3px 0 0 3px",backgroundColor:"white",padding:"5px 0px 5px 5px",width:"99%"},"aria-describedby":"name-desc",onChange:this.handleOnChange}),rge.createElement("small",{id:"car-file-desc",className:"o-0 absolute f6 black-60 db mb2"},e("IpldCarExploreForm.uploadCarFile")),rge.createElement("img",{id:"car-loader-image",alt:"placeholder for upload and loader",src:age,className:"absolute",style:{top:"0px",right:"0px",height:"30px",width:"30px",paddingRight:"10px"}}))))}}(0,oge.$)("doUploadUserProvidedCar",(0,ige.Zh)("explore")(cge));function lge(){return lge=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},lge.apply(this,arguments)}const uge=e=>rge.createElement("svg",lge({viewBox:"0 0 100 100"},e),rge.createElement("path",{d:"M87.714 44.764c0-1.157-.45-2.245-1.269-3.062a4.304 4.304 0 0 0-3.063-1.269 4.304 4.304 0 0 0-3.062 1.269 4.337 4.337 0 0 0 0 6.125c.602.602 1.351 1 2.164 1.172v2.442l-14.686 9.276v-19.79l4.498-2.842v-3.717a4.27 4.27 0 0 0 1.827-1.067 4.337 4.337 0 0 0 0-6.125 4.337 4.337 0 0 0-6.126 0 4.304 4.304 0 0 0-1.269 3.063c0 1.157.45 2.245 1.269 3.062a4.282 4.282 0 0 0 1.963 1.107v2.391L51.236 48.627v-8.901l9.304-5.877v-7.051a4.282 4.282 0 0 0 1.986-1.114 4.336 4.336 0 0 0-.001-6.125 4.337 4.337 0 0 0-6.125 0h-.001a4.337 4.337 0 0 0 0 6.125c.52.519 1.145.859 1.804 1.059v5.818l-6.967 4.401V15.561a4.283 4.283 0 0 0 2.008-1.12 4.337 4.337 0 0 0-.001-6.126 4.337 4.337 0 0 0-6.125 0h-.001a4.337 4.337 0 0 0 .001 6.126 4.273 4.273 0 0 0 1.782 1.053v15.881l-7.229-4.566v-3.436a4.292 4.292 0 0 0 2.008-1.12 4.337 4.337 0 0 0 0-6.125 4.337 4.337 0 0 0-6.126 0 4.304 4.304 0 0 0-1.269 3.063c0 1.157.45 2.245 1.269 3.062a4.276 4.276 0 0 0 1.781 1.053v4.79l9.565 6.042v21.108l-7.708-4.226v-7.809a4.275 4.275 0 0 0 2.034-1.128 4.337 4.337 0 0 0 0-6.125 4.337 4.337 0 0 0-6.126 0 4.304 4.304 0 0 0-1.269 3.063c0 1.157.45 2.245 1.269 3.062a4.284 4.284 0 0 0 1.756 1.046v6.61L27.15 43.322v-6.217a4.28 4.28 0 0 0 1.984-1.117 4.3 4.3 0 0 0 1.27-3.063c0-1.157-.45-2.245-1.269-3.062a4.336 4.336 0 0 0-6.126 0 4.337 4.337 0 0 0 0 6.125c.51.51 1.132.858 1.804 1.062v7.621l3.646 2.004v13.632l-10.582-5.77v-2.418a4.29 4.29 0 0 0 2.051-1.133 4.337 4.337 0 0 0 0-6.125 4.304 4.304 0 0 0-3.062-1.269 4.304 4.304 0 0 0-3.063 1.269 4.337 4.337 0 0 0 0 6.125 4.285 4.285 0 0 0 1.738 1.041v3.812L48.9 74.108v11.397a4.277 4.277 0 0 0-1.783 1.053 4.337 4.337 0 0 0 0 6.125 4.32 4.32 0 0 0 3.063 1.266 4.316 4.316 0 0 0 3.063-1.267 4.337 4.337 0 0 0 0-6.125 4.29 4.29 0 0 0-2.008-1.119V73.943L84.82 52.727v-3.892a4.29 4.29 0 0 0 1.625-1.008 4.3 4.3 0 0 0 1.269-3.063zM30.586 61.468V47.844L48.9 57.91v13.542l-18.314-9.984zm34.876-19.065v19.79l-14.227 8.986v-19.79l14.227-8.986zm3.067-12.164c0-.676.264-1.312.742-1.79a2.525 2.525 0 0 1 1.79-.74c.647 0 1.296.247 1.789.74a2.536 2.536 0 0 1 0 3.581 2.535 2.535 0 0 1-3.579 0 2.516 2.516 0 0 1-.742-1.791zm-10.857-9.407a2.534 2.534 0 0 1 3.58 0 2.534 2.534 0 0 1 0 3.58 2.534 2.534 0 0 1-3.58 0 2.534 2.534 0 0 1 0-3.58zM48.389 9.589a2.536 2.536 0 0 1 3.581 0c.987.987.987 2.593.001 3.58a2.536 2.536 0 0 1-3.581 0 2.535 2.535 0 0 1-.001-3.58zM38.084 19.19c0-.676.264-1.312.742-1.79a2.525 2.525 0 0 1 1.79-.74c.647 0 1.296.247 1.789.74a2.536 2.536 0 0 1 0 3.581 2.535 2.535 0 0 1-3.579 0 2.52 2.52 0 0 1-.742-1.791zm-.453 19.832c0-.676.264-1.312.742-1.79a2.525 2.525 0 0 1 1.79-.74c.647 0 1.296.247 1.789.74a2.536 2.536 0 0 1 0 3.581 2.535 2.535 0 0 1-3.58 0 2.525 2.525 0 0 1-.741-1.791zm-13.348-7.887a2.524 2.524 0 0 1 1.789-.74 2.526 2.526 0 0 1 2.532 2.531c0 .677-.264 1.312-.742 1.79-.422.422-.984.647-1.562.696h-.456c-.577-.049-1.139-.274-1.561-.696a2.534 2.534 0 0 1 0-3.581zm-9.207 14.999a2.514 2.514 0 0 1 1.79-.742 2.534 2.534 0 0 1 1.789 4.322 2.533 2.533 0 0 1-3.579 0 2.533 2.533 0 0 1 0-3.58zM51.97 91.411a2.534 2.534 0 0 1-3.58 0 2.534 2.534 0 0 1 0-3.58 2.536 2.536 0 0 1 3.58 0 2.534 2.534 0 0 1 0 3.58zm33.202-44.857c-.955.955-2.624.957-3.579 0a2.534 2.534 0 0 1 1.789-4.322c.677 0 1.312.264 1.791.742.478.478.741 1.113.741 1.79s-.263 1.311-.742 1.79z"}));class hge extends rge.Component{constructor(e){super(e),this.state={path:""},this.handleOnChange=this.handleOnChange.bind(this),this.handleOnSubmit=this.handleOnSubmit.bind(this)}handleOnSubmit(e){e.preventDefault(),this.props.doExploreUserProvidedPath(this.state.path)}handleOnChange(e){const t=e.target.value;this.setState({path:t})}render(){const{t:e}=this.props;return rge.createElement("form",{"data-id":"IpldExploreForm",className:"sans-serif black-80 flex",onSubmit:this.handleOnSubmit},rge.createElement("div",{className:"flex-auto"},rge.createElement("div",{className:"relative"},rge.createElement("input",{id:"ipfs-path",className:"input-reset bn pa2 mb2 db w-100 f6 br-0 placeholder-light focus-outline",style:{borderRadius:"3px 0 0 3px"},type:"text",placeholder:"QmHash","aria-describedby":"name-desc",onChange:this.handleOnChange,value:this.state.path}),rge.createElement("small",{id:"ipfs-path-desc",className:"o-0 absolute f6 black-60 db mb2"},"Paste in a CID or IPFS path"))),rge.createElement("div",{className:"flex-none"},rge.createElement("button",{type:"submit",className:"button-reset dib lh-copy pv1 pl2 pr3 ba f7 fw4 focus-outline white bg-aqua bn",style:{borderRadius:"0 3px 3px 0"}},rge.createElement(uge,{style:{height:24},className:"dib fill-current-color v-mid navy 0-100"}),rge.createElement("span",{className:"ml2 navy 0-100"},e("IpldExploreForm.explore")))))}}const dge=(0,oge.$)("doExploreUserProvidedPath",(0,ige.Zh)("explore")(hge));n(39278);var fge=n(5803),pge=n(51483);const gge=(0,fge.ZP)((()=>n.e(480).then(n.bind(n,90480))),{fallback:rge.createElement(pge.Z,null)});var yge=n(21568),mge=n(18970),vge=n(14964);const bge=n.p+"static/media/ipld.c2e6094fbcd21952d9a1019f204a629e.svg";var wge=n(59714);const Ege=(0,ige.Zh)("explore")((e=>{let{t:t}=e;return rge.createElement(wge.Z,{className:"tl dib pa4 avenir measure-wide-l lh-copy dark-gray ba-l b--black-10"},rge.createElement("div",{className:"tc"},rge.createElement("a",{className:"link",href:"https://ipld.io"},rge.createElement("img",{src:bge,alt:"IPLD",style:{height:60}}))),rge.createElement(ige.cC,{i18nKey:"AboutIpld.paragraph1",t:t},rge.createElement("p",null,"IPLD is ",rge.createElement("strong",null,"the data model of the content-addressable web.")," It allows us to treat all hash-linked data structures as subsets of a unified information space, unifying all data models that link data with hashes as instances of IPLD.")),rge.createElement(ige.cC,{i18nKey:"AboutIpld.paragraph2",t:t},rge.createElement("p",null,"Content addressing through hashes has become a widely-used means of connecting data in distributed systems, from the blockchains that run your favorite cryptocurrencies, to the commits that back your code, to the web\u2019s content at large. Yet, whilst all of these tools rely on some common primitives, their specific underlying data structures are not interoperable.")),rge.createElement(ige.cC,{i18nKey:"AboutIpld.paragraph3",t:t},rge.createElement("p",null,"Enter IPLD: a single namespace for all hash-inspired protocols. Through IPLD, links can be traversed across protocols, allowing you to explore data regardless of the underlying protocol.")))}));var Age=n(29405);const Sge=e=>{let{cid:t,name:n,type:r}=e;return rge.createElement("a",{className:"flex items-center lh-copy pl3 pl0-l pv3 bb b--black-10 link focus-outline",href:"#/explore/".concat(t)},rge.createElement("span",{className:"flex items-center justify-center w3 h3 w3-m h3-m w3-l h3-l flex-none br-100 tc",style:{background:(0,yge.$j)(r)}},rge.createElement("span",{className:"montserrat fw3 f6 snow",title:(0,yge.RB)(r)},(0,yge.Yn)(r))),rge.createElement("span",{className:"pl3 truncate"},rge.createElement("h2",{className:"ma0 fw4 f5 db black montserrat"},n),rge.createElement("span",{className:"f7 db blue truncate monospace"},t)))},_ge=(0,ige.Zh)("explore")((e=>{let{t:t,embed:n,runTour:r=!1,joyrideCallback:i}=e;return rge.createElement("div",{className:"mw9 center explore-sug-2"},rge.createElement(mge.ql,null,rge.createElement("title",null,t("StartExploringPage.title"))),rge.createElement("div",{className:"flex-l"},rge.createElement("div",{className:"flex-auto-l mr3-l"},rge.createElement("div",{className:"pl3 pl0-l pt4 pt2-l"},rge.createElement("h1",{className:"f3 f2-l ma0 fw4 montserrat charcoal"},t("StartExploringPage.header")),rge.createElement("p",{className:"lh-copy f5 avenir charcoal-muted"},t("StartExploringPage.leadParagraph"))),n?rge.createElement(dge,null):null,rge.createElement("ul",{className:"list pl0 ma0 mt4 mt0-l bt bn-l b--black-10"},rge.createElement("li",null,rge.createElement(Sge,{name:"Project Apollo Archives",cid:"QmSnuWmxptJZdLJpKRarxBMS2Ju2oANVrgbr2xWbie9b2D",type:"dag-pb"})),rge.createElement("li",null,rge.createElement(Sge,{name:"XKCD Archives",cid:"QmdmQXB2mzChmMeKY47C43LxUdg1NDJ5MWcKMKxDu7RgQm",type:"dag-pb"})),rge.createElement("li",null,rge.createElement(Sge,{name:"HAMT-sharded Wikipedia mirror (>20M files)",cid:"bafybeiaysi4s6lnjev27ln5icwm6tueaw2vdykrtjkwiphwekaywqhcjze",type:"hamt-sharded-directory"})),rge.createElement("li",null,rge.createElement(Sge,{name:"B-tree search index from ipfs-geoip",cid:"bafyreif3tfdpr5n4jdrbielmcapwvbpcthepfkwq2vwonmlhirbjmotedi",type:"dag-cbor"})),rge.createElement("li",null,rge.createElement(Sge,{name:"DAG-CBOR Block",cid:"bafyreicnokmhmrnlp2wjhyk2haep4tqxiptwfrp2rrs7rzq7uk766chqvq",type:"dag-cbor"})),rge.createElement("li",null,rge.createElement(Sge,{name:"dag-cbor hello world (keccak-256)",cid:"bafyrwigbexamue2ba3hmtai7hwlcmd6ekiqsduyf5avv7oz6ln3radvjde",type:"dag-cbor"})),rge.createElement("li",null,rge.createElement(Sge,{name:"Ceramic LogEntry for sgb.chat Ambassador proposal",cid:"bagcqcerarvdwmhvk73mze3e2n6yvpt5h7fh3eae7n6y3hizsflz5grpyeczq",type:"dag-jose"})),rge.createElement("li",null,rge.createElement(Sge,{name:"hello world (blake3)",cid:"bagaaihraf4oq2kddg6o5ewlu6aol6xab75xkwbgzx2dlot7cdun7iirve23a",type:"dag-json"})),rge.createElement("li",null,rge.createElement(Sge,{name:"hello world",cid:"baguqeerasords4njcts6vs7qvdjfcvgnume4hqohf65zsfguprqphs3icwea",type:"dag-json"})),rge.createElement("li",null,rge.createElement(Sge,{name:"hello world (sha3-512)",cid:"bagaaifcavabu6fzheerrmtxbbwv7jjhc3kaldmm7lbnvfopyrthcvod4m6ygpj3unrcggkzhvcwv5wnhc5ufkgzlsji7agnmofovc2g4a3ui7ja",type:"json"})),rge.createElement("li",null,rge.createElement(Sge,{name:'Raw Block for "hello"',cid:"bafkreibm6jg3ux5qumhcn2b3flc3tyu6dmlb4xa7u5bf44yegnrjhc4yeq",type:"raw"})),rge.createElement("li",null,rge.createElement(Sge,{name:'Raw Block for "hello" (blake3)',cid:"bafkr4ihkr4ld3m4gqkjf4reryxsy2s5tkbxprqkow6fin2iiyvreuzzab4",type:"raw"})))),rge.createElement("div",{className:"pt2-l"},rge.createElement(Ege,null))),rge.createElement(vge.ZP,{run:r,steps:Age.V.getSteps({t:t}),styles:Age.V.styles,callback:i,scrollToFirstStep:!0}))}))},59536:(e,t,n)=>{"use strict";n.d(t,{A$:()=>u,NZ:()=>c,SD:()=>a,uU:()=>l});var r=n(839),i=n(1315),o=n(20099),s=n(40791);function a(e,t){if(!e)return null;try{return s.CID.asCID(e)||s.CID.parse(e,t)}catch(n){return null}}function c(e){const t=a(e);if(null==t)return null;switch(t.code){case r.code:return r.name;case i.code:return i.name;case o.code:return o.name;default:return null}}function l(e){const t=a(e);return t?t.code:null}function u(e){const t=a(e);return t?t.toString():null}},48236:(e,t,n)=>{"use strict";function r(e){switch(e){case 113:return"dag-cbor";case 112:return"dag-pb";case 120:return"git-raw";case 85:return"raw";case 512:return"json";case 297:return"dag-json";case 133:return"dag-jose";default:return"codec code ".concat(e,"=unknown")}}n.d(t,{Z:()=>r})},14824:(e,t,n)=>{"use strict";n.d(t,{C:()=>ie,i:()=>ne});var r=n(9837),i=n.n(r);new Uint8Array(0);var o=function e(t,n,r){n=n||[];var i=r=r||0;for(;t>=c;)n[r++]=255&t|s,t/=128;for(;t&a;)n[r++]=255&t|s,t>>>=7;return n[r]=0|t,e.bytes=r-i+1,n},s=128,a=-128,c=Math.pow(2,31);var l=function e(t,n){var r,i=0,o=0,s=n=n||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");r=t[s++],i+=o<28?(r&h)<<o:(r&h)*Math.pow(2,o),o+=7}while(r>=u);return e.bytes=s-n,i},u=128,h=127;var d=Math.pow(2,7),f=Math.pow(2,14),p=Math.pow(2,21),g=Math.pow(2,28),y=Math.pow(2,35),m=Math.pow(2,42),v=Math.pow(2,49),b=Math.pow(2,56),w=Math.pow(2,63);const E={encode:o,decode:l,encodingLength:function(e){return e<d?1:e<f?2:e<p?3:e<g?4:e<y?5:e<m?6:e<v?7:e<b?8:e<w?9:10}},A=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return E.encode(e,t,n),t},S=e=>E.encodingLength(e),_=(e,t)=>{const n=t.byteLength,r=S(e),i=r+S(n),o=new Uint8Array(i+n);return A(e,o,0),A(n,o,r),o.set(t,i),new I(e,n,t,o)};class I{constructor(e,t,n,r){this.code=e,this.size=t,this.digest=n,this.bytes=r}}const C=e=>{let{name:t,code:n,encode:r}=e;return new T(t,n,r)};class T{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?_(this.code,t):t.then((e=>_(this.code,e)))}throw Error("Unknown type, must be binary type")}}function k(e){return t=>new Uint8Array(e.array(t))}C({code:23,name:"sha3-224",encode:k(i().sha3_224)}),C({code:22,name:"sha3-256",encode:k(i().sha3_256)}),C({code:21,name:"sha3-384",encode:k(i().sha3_384)});const R=C({code:20,name:"sha3-512",encode:k(i().sha3_512)}),x=(C({code:24,name:"shake-128",encode:e=>new Uint8Array(i().shake128.array(e,256))}),C({code:25,name:"shake-256",encode:e=>new Uint8Array(i().shake256.array(e,512))}),C({code:26,name:"keccak-224",encode:k(i().keccak224)}),C({code:27,name:"keccak-256",encode:k(i().keccak256)}));C({code:28,name:"keccak-384",encode:k(i().keccak384)}),C({code:29,name:"keccak-512",encode:k(i().keccak512)});function P(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))}"function"===typeof SuppressedError&&SuppressedError;class D{constructor(){this.mutex=Promise.resolve()}lock(){let e=()=>{};return this.mutex=this.mutex.then((()=>new Promise(e))),new Promise((t=>{e=t}))}dispatch(e){return P(this,void 0,void 0,(function*(){const t=yield this.lock();try{return yield Promise.resolve(e())}finally{t()}}))}}var O;const N="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:n.g,B=null!==(O=N.Buffer)&&void 0!==O?O:null,L=N.TextEncoder?new N.TextEncoder:null;function M(e,t){return(15&e)+(e>>6|e>>3&8)<<4|(15&t)+(t>>6|t>>3&8)}function U(e,t){const n=t.length>>1;for(let r=0;r<n;r++){const n=r<<1;e[r]=M(t.charCodeAt(n),t.charCodeAt(n+1))}}const F="a".charCodeAt(0)-10,K="0".charCodeAt(0);function j(e,t,n){let r=0;for(let i=0;i<n;i++){let n=t[i]>>>4;e[r++]=n>9?n+F:n+K,n=15&t[i],e[r++]=n>9?n+F:n+K}return String.fromCharCode.apply(null,e)}const Z=null!==B?e=>{if("string"===typeof e){const t=B.from(e,"utf8");return new Uint8Array(t.buffer,t.byteOffset,t.length)}if(B.isBuffer(e))return new Uint8Array(e.buffer,e.byteOffset,e.length);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Invalid data type!")}:e=>{if("string"===typeof e)return L.encode(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Invalid data type!")},z="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",V=new Uint8Array(256);for(let oe=0;oe<z.length;oe++)V[z.charCodeAt(oe)]=oe;function H(e){let t=Math.floor(.75*e.length);const n=e.length;return"="===e[n-1]&&(t-=1,"="===e[n-2]&&(t-=1)),t}function q(e){const t=H(e),n=e.length,r=new Uint8Array(t);let i=0;for(let o=0;o<n;o+=4){const t=V[e.charCodeAt(o)],n=V[e.charCodeAt(o+1)],s=V[e.charCodeAt(o+2)],a=V[e.charCodeAt(o+3)];r[i]=t<<2|n>>4,i+=1,r[i]=(15&n)<<4|s>>2,i+=1,r[i]=(3&s)<<6|63&a,i+=1}return r}const G=16384,W=4,Q=new D,Y=new Map;function J(e,t){return P(this,void 0,void 0,(function*(){let n=null,r=null,i=!1;if("undefined"===typeof WebAssembly)throw new Error("WebAssembly is not supported in this environment!");const o=()=>new DataView(n.exports.memory.buffer).getUint32(n.exports.STATE_SIZE,!0),s=Q.dispatch((()=>P(this,void 0,void 0,(function*(){if(!Y.has(e.name)){const t=q(e.data),n=WebAssembly.compile(t);Y.set(e.name,n)}const t=yield Y.get(e.name);n=yield WebAssembly.instantiate(t,{})})))),a=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;i=!0,n.exports.Hash_Init(e)},c=e=>{if(!i)throw new Error("update() called before init()");(e=>{let t=0;for(;t<e.length;){const i=e.subarray(t,t+G);t+=i.length,r.set(i),n.exports.Hash_Update(i.length)}})(Z(e))},l=new Uint8Array(2*t),u=function(e){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!i)throw new Error("digest() called before init()");return i=!1,n.exports.Hash_Final(o),"binary"===e?r.slice(0,t):j(l,r,t)},h=e=>"string"===typeof e?e.length<G/4:e.byteLength<G;let d=h;switch(e.name){case"argon2":case"scrypt":d=()=>!0;break;case"blake2b":case"blake2s":d=(e,t)=>t<=512&&h(e);break;case"blake3":d=(e,t)=>0===t&&h(e);break;case"xxhash64":case"xxhash3":case"xxhash128":d=()=>!1}return yield(()=>P(this,void 0,void 0,(function*(){n||(yield s);const e=n.exports.Hash_GetBuffer(),t=n.exports.memory.buffer;r=new Uint8Array(t,e,G)})))(),{getMemory:()=>r,writeMemory:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;r.set(e,t)},getExports:()=>n.exports,setMemorySize:e=>{n.exports.Hash_SetMemorySize(e);const t=n.exports.Hash_GetBuffer(),i=n.exports.memory.buffer;r=new Uint8Array(i,t,e)},init:a,update:c,digest:u,save:()=>{if(!i)throw new Error("save() can only be called after init() and before digest()");const t=n.exports.Hash_GetState(),r=o(),s=n.exports.memory.buffer,a=new Uint8Array(s,t,r),c=new Uint8Array(W+r);return U(c,e.hash),c.set(a,W),c},load:t=>{if(!(t instanceof Uint8Array))throw new Error("load() expects an Uint8Array generated by save()");const r=n.exports.Hash_GetState(),s=o(),a=W+s,c=n.exports.memory.buffer;if(t.length!==a)throw new Error("Bad state length (expected ".concat(a," bytes, got ").concat(t.length,")"));if(!function(e,t){if(e.length!==2*t.length)return!1;for(let n=0;n<t.length;n++){const r=n<<1;if(t[n]!==M(e.charCodeAt(r),e.charCodeAt(r+1)))return!1}return!0}(e.hash,t.subarray(0,W)))throw new Error("This state was written by an incompatible hash implementation");const l=t.subarray(W);new Uint8Array(c,r,s).set(l),i=!0},calculate:function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!d(e,i))return a(i),c(e),u("hex",o);const s=Z(e);return r.set(s),n.exports.Hash_Calculate(s.length,i,o),j(l,r,t)},hashLength:t}}))}new D;new D;new DataView(new ArrayBuffer(4));new D;var X={name:"blake3",data:"AGFzbQEAAAABMQdgAAF/YAl/f39+f39/f38AYAZ/f39/fn8AYAF/AGADf39/AGABfgBgBX9/fn9/AX8DDg0AAQIDBAUGAwMDAwAEBQQBAQICBg4CfwFBgJgFC38AQYAICwdwCAZtZW1vcnkCAA5IYXNoX0dldEJ1ZmZlcgAACUhhc2hfSW5pdAAIC0hhc2hfVXBkYXRlAAkKSGFzaF9GaW5hbAAKDUhhc2hfR2V0U3RhdGUACw5IYXNoX0NhbGN1bGF0ZQAMClNUQVRFX1NJWkUDAQqcWw0FAEGACQujAwQCfwF+AX8EfiMAQeAAayIJJAACQCABRQ0AIAcgBXIhCiAEQQBHrSELIAdBACACQQFGGyAGciAFciEMA0AgACgCACEHIAlBACkDgIkBNwMAIAlBACkDiIkBNwMIIAlBACkDkIkBNwMQIAlBACkDmIkBNwMYIAlBIGogCSAHQcAAIAMgDBACIAkgCSkDQCAJKQMghSINNwMAIAkgCSkDSCAJKQMohSIONwMIIAkgCSkDUCAJKQMwhSIPNwMQIAkgCSkDWCAJKQM4hSIQNwMYIAdBwABqIQcgAiEEAkADQCAFIQYCQAJAIARBf2oiBA4CAwABCyAKIQYLIAlBIGogCSAHQcAAIAMgBhACIAkgCSkDQCAJKQMghSINNwMAIAkgCSkDSCAJKQMohSIONwMIIAkgCSkDUCAJKQMwhSIPNwMQIAkgCSkDWCAJKQM4hSIQNwMYIAdBwABqIQcMAAsLIAggEDcDGCAIIA83AxAgCCAONwMIIAggDTcDACAIQSBqIQggAEEEaiEAIAMgC3whAyABQX9qIgENAAsLIAlB4ABqJAALhBwCDH4ffyACKQMgIQYgAikDOCEHIAIpAzAhCCACKQMAIQkgAikDKCEKIAIpAxAhCyACKQMIIQwgAikDGCENIAAgASkDACIONwMAIAAgASkDCCIPNwMIIAAgASkDECIQNwMQIAAgD0IgiKcgDaciAmogASkDGCIRQiCIpyISaiITIA1CIIinIgFqIBMgBXNBEHQgE0EQdnIiFEG66r+qemoiFSASc0EUdyIWaiIXIA6nIAmnIhNqIBCnIhJqIhggCUIgiKciBWogGCAEp3NBEHciGEHnzKfQBmoiGSASc0EUdyISaiIaIBhzQRh3IhsgGWoiHCASc0EZdyIdaiAHpyISaiIeIAdCIIinIhhqIB4gD6cgC6ciGWogEaciH2oiICALQiCIpyIhaiAgIANzQRB0ICBBEHZyIiBB8ua74wNqIiIgH3NBFHciH2oiIyAgc0EYdyIkc0EQdyIeIA5CIIinIAynIiBqIBBCIIinIiVqIiYgDEIgiKciA2ogJiAEQiCIp3NBEHciJkGF3Z7be2oiJyAlc0EUdyIlaiIoICZzQRh3IiYgJ2oiJ2oiKSAdc0EUdyIdaiIqIBlqIBcgFHNBGHciKyAVaiIsIBZzQRl3IhYgI2ogCKciFGoiFyAIQiCIpyIVaiAXICZzQRB3IhcgHGoiHCAWc0EUdyIWaiIjIBdzQRh3IiYgHGoiLSAWc0EZdyIuaiIcIBVqICcgJXNBGXciJSAaaiAGpyIWaiIaIAZCIIinIhdqIBogK3NBEHciGiAkICJqIiJqIiQgJXNBFHciJWoiJyAac0EYdyIrIBxzQRB3Ii8gIiAfc0EZdyIfIChqIAqnIhpqIiIgCkIgiKciHGogIiAbc0EQdyIbICxqIiIgH3NBFHciH2oiKCAbc0EYdyIbICJqIiJqIiwgLnNBFHciLmoiMCAnICBqICogHnNBGHciHiApaiInIB1zQRl3Ih1qIikgAmogGyApc0EQdyIbIC1qIikgHXNBFHciHWoiKiAbc0EYdyIbIClqIikgHXNBGXciHWogGGoiLSAWaiAtICMgAWogIiAfc0EZdyIfaiIiIBNqIB4gInNBEHciHiArICRqIiJqIiMgH3NBFHciH2oiJCAec0EYdyIec0EQdyIrICggA2ogIiAlc0EZdyIiaiIlIBpqICYgJXNBEHciJSAnaiImICJzQRR3IiJqIicgJXNBGHciJSAmaiImaiIoIB1zQRR3Ih1qIi0gAWogMCAvc0EYdyIvICxqIiwgLnNBGXciLiAkaiAXaiIkIBJqICQgJXNBEHciJCApaiIlIC5zQRR3IilqIi4gJHNBGHciJCAlaiIlIClzQRl3IilqIjAgEmogJiAic0EZdyIiICpqIAVqIiYgHGogJiAvc0EQdyImIB4gI2oiHmoiIyAic0EUdyIiaiIqICZzQRh3IiYgMHNBEHciLyAeIB9zQRl3Ih4gJ2ogFGoiHyAhaiAfIBtzQRB3IhsgLGoiHyAec0EUdyIeaiInIBtzQRh3IhsgH2oiH2oiLCApc0EUdyIpaiIwICogA2ogLSArc0EYdyIqIChqIiggHXNBGXciHWoiKyAZaiAbICtzQRB3IhsgJWoiJSAdc0EUdyIdaiIrIBtzQRh3IhsgJWoiJSAdc0EZdyIdaiAWaiItIAVqIC0gLiAVaiAfIB5zQRl3Ih5qIh8gIGogKiAfc0EQdyIfICYgI2oiI2oiJiAec0EUdyIeaiIqIB9zQRh3Ih9zQRB3Ii0gJyAaaiAjICJzQRl3IiJqIiMgFGogJCAjc0EQdyIjIChqIiQgInNBFHciImoiJyAjc0EYdyIjICRqIiRqIiggHXNBFHciHWoiLiAVaiAwIC9zQRh3Ii8gLGoiLCApc0EZdyIpICpqIBxqIiogGGogKiAjc0EQdyIjICVqIiUgKXNBFHciKWoiKiAjc0EYdyIjICVqIiUgKXNBGXciKWoiMCAYaiAkICJzQRl3IiIgK2ogAmoiJCAhaiAkIC9zQRB3IiQgHyAmaiIfaiImICJzQRR3IiJqIisgJHNBGHciJCAwc0EQdyIvIB8gHnNBGXciHiAnaiAXaiIfIBNqIB8gG3NBEHciGyAsaiIfIB5zQRR3Ih5qIicgG3NBGHciGyAfaiIfaiIsIClzQRR3IilqIjAgKyAaaiAuIC1zQRh3IisgKGoiKCAdc0EZdyIdaiItIAFqIBsgLXNBEHciGyAlaiIlIB1zQRR3Ih1qIi0gG3NBGHciGyAlaiIlIB1zQRl3Ih1qIAVqIi4gAmogLiAqIBJqIB8gHnNBGXciHmoiHyADaiArIB9zQRB3Ih8gJCAmaiIkaiImIB5zQRR3Ih5qIiogH3NBGHciH3NBEHciKyAnIBRqICQgInNBGXciImoiJCAXaiAjICRzQRB3IiMgKGoiJCAic0EUdyIiaiInICNzQRh3IiMgJGoiJGoiKCAdc0EUdyIdaiIuIBJqIDAgL3NBGHciLyAsaiIsIClzQRl3IikgKmogIWoiKiAWaiAqICNzQRB3IiMgJWoiJSApc0EUdyIpaiIqICNzQRh3IiMgJWoiJSApc0EZdyIpaiIwIBZqICQgInNBGXciIiAtaiAZaiIkIBNqICQgL3NBEHciJCAfICZqIh9qIiYgInNBFHciImoiLSAkc0EYdyIkIDBzQRB3Ii8gHyAec0EZdyIeICdqIBxqIh8gIGogHyAbc0EQdyIbICxqIh8gHnNBFHciHmoiJyAbc0EYdyIbIB9qIh9qIiwgKXNBFHciKWoiMCAvc0EYdyIvICxqIiwgKXNBGXciKSAqIBhqIB8gHnNBGXciHmoiHyAaaiAuICtzQRh3IiogH3NBEHciHyAkICZqIiRqIiYgHnNBFHciHmoiK2ogE2oiLiAFaiAuICcgF2ogJCAic0EZdyIiaiIkIBxqICMgJHNBEHciIyAqIChqIiRqIicgInNBFHciImoiKCAjc0EYdyIjc0EQdyIqIC0gFGogJCAdc0EZdyIdaiIkIBVqIBsgJHNBEHciGyAlaiIkIB1zQRR3Ih1qIiUgG3NBGHciGyAkaiIkaiItIClzQRR3IilqIi4gFmogKyAfc0EYdyIfICZqIiYgHnNBGXciHiAoaiAhaiIoIANqICggG3NBEHciGyAsaiIoIB5zQRR3Ih5qIisgG3NBGHciGyAoaiIoIB5zQRl3Ih5qIiwgFGogMCAkIB1zQRl3Ih1qIAJqIiQgGWogJCAfc0EQdyIfICMgJ2oiI2oiJCAdc0EUdyIdaiInIB9zQRh3Ih8gLHNBEHciLCAjICJzQRl3IiIgJWogAWoiIyAgaiAjIC9zQRB3IiMgJmoiJSAic0EUdyIiaiImICNzQRh3IiMgJWoiJWoiLyAec0EUdyIeaiIwICxzQRh3IiwgL2oiLyAec0EZdyIeICsgHGogJSAic0EZdyIiaiIlICFqIC4gKnNBGHciKiAlc0EQdyIlIB8gJGoiH2oiJCAic0EUdyIiaiIraiATaiIuIBpqIC4gJiAXaiAfIB1zQRl3Ih1qIh8gEmogGyAfc0EQdyIbICogLWoiH2oiJiAdc0EUdyIdaiIqIBtzQRh3IhtzQRB3Ii0gJyAYaiAfIClzQRl3Ih9qIicgBWogIyAnc0EQdyIjIChqIicgH3NBFHciH2oiKCAjc0EYdyIjICdqIidqIikgHnNBFHciHmoiLiAhaiArICVzQRh3IiEgJGoiJCAic0EZdyIiICpqIBVqIiUgA2ogJSAjc0EQdyIjIC9qIiUgInNBFHciImoiKiAjc0EYdyIjICVqIiUgInNBGXciImoiKyATaiAnIB9zQRl3IhMgMGogIGoiHyACaiAfICFzQRB3IiEgGyAmaiIbaiIfIBNzQRR3IhNqIiYgIXNBGHciISArc0EQdyInICggGyAdc0EZdyIbaiAZaiIdIAFqIB0gLHNBEHciHSAkaiIkIBtzQRR3IhtqIiggHXNBGHciHSAkaiIkaiIrICJzQRR3IiJqIiwgJ3NBGHciJyAraiIrICJzQRl3IiIgKiAcaiAkIBtzQRl3IhxqIhsgGGogLiAtc0EYdyIYIBtzQRB3IhsgISAfaiIhaiIfIBxzQRR3IhxqIiRqIBJqIhIgGmogEiAoIBZqICEgE3NBGXciE2oiISACaiAjICFzQRB3IgIgGCApaiIYaiIhIBNzQRR3IhNqIhYgAnNBGHciAnNBEHciEiAmIAVqIBggHnNBGXciBWoiGCAXaiAdIBhzQRB3IhggJWoiFyAFc0EUdyIFaiIaIBhzQRh3IhggF2oiF2oiHSAic0EUdyIeaiIiNgIAIAAgFyAFc0EZdyIFICxqICBqIiAgFGogICAkIBtzQRh3IhRzQRB3IiAgAiAhaiICaiIhIAVzQRR3IgVqIhcgIHNBGHciIDYCMCAAIBYgFCAfaiIUIBxzQRl3IhxqIAFqIgEgFWogASAYc0EQdyIBICtqIhggHHNBFHciFWoiFiABc0EYdyIBIBhqIhggFXNBGXc2AhAgACAXNgIEIAAgAiATc0EZdyICIBpqIANqIhMgGWogEyAnc0EQdyITIBRqIhkgAnNBFHciAmoiAyATc0EYdyITNgI0IAAgIiASc0EYdyISIB1qIhQgHnNBGXc2AhQgACATIBlqIhM2AiAgACAYNgIkIAAgAzYCCCAAIAE2AjggACAgICFqIgEgBXNBGXc2AhggACAUNgIoIAAgFjYCDCAAIBI2AjwgACATIAJzQRl3NgIcIAAgATYCLAulEgsDfwR+An8BfgF/BH4DfwF+An8BfgR/IwBB0AJrIgEkAAJAIABFDQACQAJAQQAtAImKAUEGdEEALQCIigFqIgINAEGACSEDDAELQaCJAUGACUGACCACayICIAAgAiAASRsiAhAEIAAgAmsiAEUNASABQaABakEAKQPQiQE3AwAgAUGoAWpBACkD2IkBNwMAIAFBACkDoIkBIgQ3A3AgAUEAKQOoiQEiBTcDeCABQQApA7CJASIGNwOAASABQQApA7iJASIHNwOIASABQQApA8iJATcDmAFBAC0AiooBIQhBAC0AiYoBIQlBACkDwIkBIQpBAC0AiIoBIQsgAUGwAWpBACkD4IkBNwMAIAFBuAFqQQApA+iJATcDACABQcABakEAKQPwiQE3AwAgAUHIAWpBACkD+IkBNwMAIAFB0AFqQQApA4CKATcDACABIAs6ANgBIAEgCjcDkAEgASAIIAlFckECciIIOgDZASABIAc3A/gBIAEgBjcD8AEgASAFNwPoASABIAQ3A+ABIAEgAUHgAWogAUGYAWogCyAKIAhB/wFxEAIgASkDICEEIAEpAwAhBSABKQMoIQYgASkDCCEHIAEpAzAhDCABKQMQIQ0gASkDOCEOIAEpAxghDyAKEAVBAEIANwOAigFBAEIANwP4iQFBAEIANwPwiQFBAEIANwPoiQFBAEIANwPgiQFBAEIANwPYiQFBAEIANwPQiQFBAEIANwPIiQFBAEEAKQOAiQE3A6CJAUEAQQApA4iJATcDqIkBQQBBACkDkIkBNwOwiQFBAEEAKQOYiQE3A7iJAUEAQQAtAJCKASILQQFqOgCQigFBAEEAKQPAiQFCAXw3A8CJASALQQV0IgtBqYoBaiAOIA+FNwMAIAtBoYoBaiAMIA2FNwMAIAtBmYoBaiAGIAeFNwMAIAtBkYoBaiAEIAWFNwMAQQBBADsBiIoBIAJBgAlqIQMLAkAgAEGBCEkNACABQdQCaiEQQQApA8CJASEEIAFBKGohEQNAIARCCoYhCkIBIABBAXKteUI/hYanIQIDQCACIhJBAXYhAiAKIBJBf2qtg0IAUg0ACyASQQp2rSETAkACQCASQYAISw0AIAFBADsB2AEgAUIANwPQASABQgA3A8gBIAFCADcDwAEgAUIANwO4ASABQgA3A7ABIAFCADcDqAEgAUIANwOgASABQgA3A5gBIAFBACkDgIkBNwNwIAFBACkDiIkBNwN4IAFBACkDkIkBNwOAASABQQAtAIqKAToA2gEgAUEAKQOYiQE3A4gBIAEgBDcDkAEgAUHwAGogAyASEAQgASABKQNwIgQ3AwAgASABKQN4IgU3AwggASABKQOAASIGNwMQIAEgASkDiAEiBzcDGCABIAEpA5gBNwMoIAEgASkDoAE3AzAgASABKQOoATcDOCABLQDaASECIAEtANkBIQsgASkDkAEhCiABIAEtANgBIgg6AGggASAKNwMgIAEgASkDsAE3A0AgASABKQO4ATcDSCABIAEpA8ABNwNQIAEgASkDyAE3A1ggASABKQPQATcDYCABIAIgC0VyQQJyIgI6AGkgASAHNwO4AiABIAY3A7ACIAEgBTcDqAIgASAENwOgAiABQeABaiABQaACaiARIAggCiACQf8BcRACIAEpA4ACIQQgASkD4AEhBSABKQOIAiEGIAEpA+gBIQcgASkDkAIhDCABKQPwASENIAEpA5gCIQ4gASkD+AEhDyAKEAVBAEEALQCQigEiAkEBajoAkIoBIAJBBXQiAkGpigFqIA4gD4U3AwAgAkGhigFqIAwgDYU3AwAgAkGZigFqIAYgB4U3AwAgAkGRigFqIAQgBYU3AwAMAQsCQAJAIAMgEiAEQQAtAIqKASICIAEQBiIUQQJLDQAgASkDGCEKIAEpAxAhBCABKQMIIQUgASkDACEGDAELIAJBBHIhFUEAKQOYiQEhDUEAKQOQiQEhDkEAKQOIiQEhD0EAKQOAiQEhFgNAIBRBfmoiF0EBdiIYQQFqIhlBA3EhCEEAIQkCQCAXQQZJDQAgGUF8cSEaQQAhCSABIQIgECELA0AgCyACQcABajYCACALQXxqIAJBgAFqNgIAIAtBeGogAkHAAGo2AgAgC0F0aiACNgIAIAJBgAJqIQIgC0EQaiELIBogCUEEaiIJRw0ACwsCQCAIRQ0AIAEgCUEGdGohAiABQcgCaiAJQQJ0aiELA0AgCyACNgIAIAJBwABqIQIgC0EEaiELIAhBf2oiCA0ACwsgAUHIAmohCyABQaACaiECIBkhCANAIAsoAgAhCSABIA03A/gBIAEgDjcD8AEgASAPNwPoASABIBY3A+ABIAFB8ABqIAFB4AFqIAlBwABCACAVEAIgASkDkAEhCiABKQNwIQQgASkDmAEhBSABKQN4IQYgASkDoAEhByABKQOAASEMIAJBGGogASkDqAEgASkDiAGFNwMAIAJBEGogByAMhTcDACACQQhqIAUgBoU3AwAgAiAKIASFNwMAIAJBIGohAiALQQRqIQsgCEF/aiIIDQALAkACQCAXQX5xQQJqIBRJDQAgGSEUDAELIAFBoAJqIBlBBXRqIgIgASAZQQZ0aiILKQMANwMAIAIgCykDCDcDCCACIAspAxA3AxAgAiALKQMYNwMYIBhBAmohFAsgASABKQOgAiIGNwMAIAEgASkDqAIiBTcDCCABIAEpA7ACIgQ3AxAgASABKQO4AiIKNwMYIBRBAksNAAsLIAEpAyAhByABKQMoIQwgASkDMCENIAEpAzghDkEAKQPAiQEQBUEAQQAtAJCKASICQQFqOgCQigEgAkEFdCICQamKAWogCjcDACACQaGKAWogBDcDACACQZmKAWogBTcDACACQZGKAWogBjcDAEEAKQPAiQEgE0IBiHwQBUEAQQAtAJCKASICQQFqOgCQigEgAkEFdCICQamKAWogDjcDACACQaGKAWogDTcDACACQZmKAWogDDcDACACQZGKAWogBzcDAAtBAEEAKQPAiQEgE3wiBDcDwIkBIAMgEmohAyAAIBJrIgBBgAhLDQALIABFDQELQaCJASADIAAQBEEAKQPAiQEQBQsgAUHQAmokAAuGBwIJfwF+IwBBwABrIgMkAAJAAkAgAC0AaCIERQ0AAkBBwAAgBGsiBSACIAUgAkkbIgZFDQAgBkEDcSEHQQAhBQJAIAZBBEkNACAAIARqIQggBkF8cSEJQQAhBQNAIAggBWoiCkEoaiABIAVqIgstAAA6AAAgCkEpaiALQQFqLQAAOgAAIApBKmogC0ECai0AADoAACAKQStqIAtBA2otAAA6AAAgCSAFQQRqIgVHDQALCwJAIAdFDQAgASAFaiEKIAUgBGogAGpBKGohBQNAIAUgCi0AADoAACAKQQFqIQogBUEBaiEFIAdBf2oiBw0ACwsgAC0AaCEECyAAIAQgBmoiBzoAaCABIAZqIQECQCACIAZrIgINAEEAIQIMAgsgAyAAIABBKGpBwAAgACkDICAALQBqIABB6QBqIgUtAAAiCkVyEAIgACADKQMgIAMpAwCFNwMAIAAgAykDKCADKQMIhTcDCCAAIAMpAzAgAykDEIU3AxAgACADKQM4IAMpAxiFNwMYIABBADoAaCAFIApBAWo6AAAgAEHgAGpCADcDACAAQdgAakIANwMAIABB0ABqQgA3AwAgAEHIAGpCADcDACAAQcAAakIANwMAIABBOGpCADcDACAAQTBqQgA3AwAgAEIANwMoC0EAIQcgAkHBAEkNACAAQekAaiIKLQAAIQUgAC0AaiELIAApAyAhDANAIAMgACABQcAAIAwgCyAFQf8BcUVyQf8BcRACIAAgAykDICADKQMAhTcDACAAIAMpAyggAykDCIU3AwggACADKQMwIAMpAxCFNwMQIAAgAykDOCADKQMYhTcDGCAKIAVBAWoiBToAACABQcAAaiEBIAJBQGoiAkHAAEsNAAsLAkBBwAAgB0H/AXEiBmsiBSACIAUgAkkbIglFDQAgCUEDcSELQQAhBQJAIAlBBEkNACAAIAZqIQcgCUH8AHEhCEEAIQUDQCAHIAVqIgJBKGogASAFaiIKLQAAOgAAIAJBKWogCkEBai0AADoAACACQSpqIApBAmotAAA6AAAgAkEraiAKQQNqLQAAOgAAIAggBUEEaiIFRw0ACwsCQCALRQ0AIAEgBWohASAFIAZqIABqQShqIQUDQCAFIAEtAAA6AAAgAUEBaiEBIAVBAWohBSALQX9qIgsNAAsLIAAtAGghBwsgACAHIAlqOgBoIANBwABqJAAL3gMEBX8DfgV/Bn4jAEHQAWsiASQAAkAgAHunIgJBAC0AkIoBIgNPDQBBAC0AiooBQQRyIQQgAUEoaiEFQQApA5iJASEAQQApA5CJASEGQQApA4iJASEHQQApA4CJASEIIAMhCQNAIAEgADcDGCABIAY3AxAgASAHNwMIIAEgCDcDACABIANBBXQiA0HRiQFqIgopAwA3AyggASADQdmJAWoiCykDADcDMCABIANB4YkBaiIMKQMANwM4IAEgA0HpiQFqIg0pAwA3A0AgASADQfGJAWopAwA3A0ggASADQfmJAWopAwA3A1AgASADQYGKAWopAwA3A1ggA0GJigFqKQMAIQ4gAUHAADoAaCABIA43A2AgAUIANwMgIAEgBDoAaSABIAA3A4gBIAEgBjcDgAEgASAHNwN4IAEgCDcDcCABQZABaiABQfAAaiAFQcAAQgAgBEH/AXEQAiABKQOwASEOIAEpA5ABIQ8gASkDuAEhECABKQOYASERIAEpA8ABIRIgASkDoAEhEyANIAEpA8gBIAEpA6gBhTcDACAMIBIgE4U3AwAgCyAQIBGFNwMAIAogDiAPhTcDACAJQX9qIglB/wFxIgMgAksNAAtBACAJOgCQigELIAFB0AFqJAALwwkCCn8FfiMAQeACayIFJAACQAJAIAFBgAhLDQAgBSAANgL8ASAFQfwBaiABQYAIRiIGQRAgAkEBIANBAUECIAQQASAGQQp0IgcgAU8NASAFQeAAaiIGQgA3AwAgBUHYAGoiCEIANwMAIAVB0ABqIglCADcDACAFQcgAaiIKQgA3AwAgBUHAAGoiC0IANwMAIAVBOGoiDEIANwMAIAVBMGoiDUIANwMAIAUgAzoAaiAFQgA3AyggBUEAOwFoIAVBACkDgIkBNwMAIAVBACkDiIkBNwMIIAVBACkDkIkBNwMQIAVBACkDmIkBNwMYIAUgAUGACEYiDq0gAnw3AyAgBSAAIAdqQQAgASAOGxAEIAVBiAFqQTBqIA0pAwA3AwAgBUGIAWpBOGogDCkDADcDACAFIAUpAwAiDzcDiAEgBSAFKQMIIhA3A5ABIAUgBSkDECIRNwOYASAFIAUpAxgiEjcDoAEgBSAFKQMoNwOwASAFLQBqIQAgBS0AaSEHIAUpAyAhAiAFLQBoIQEgBUGIAWpBwABqIAspAwA3AwAgBUGIAWpByABqIAopAwA3AwAgBUGIAWpB0ABqIAkpAwA3AwAgBUGIAWpB2ABqIAgpAwA3AwAgBUGIAWpB4ABqIAYpAwA3AwAgBSABOgDwASAFIAI3A6gBIAUgACAHRXJBAnIiADoA8QEgBSASNwOYAiAFIBE3A5ACIAUgEDcDiAIgBSAPNwOAAiAFQaACaiAFQYACaiAFQbABaiABIAIgAEH/AXEQAiAFKQPAAiECIAUpA6ACIQ8gBSkDyAIhECAFKQOoAiERIAUpA9ACIRIgBSkDsAIhEyAEIA5BBXRqIgEgBSkD2AIgBSkDuAKFNwMYIAEgEiAThTcDECABIBAgEYU3AwggASACIA+FNwMAQQJBASAOGyEGDAELIABCASABQX9qQQp2QQFyrXlCP4WGIg+nQQp0Ig4gAiADIAUQBiEHIAAgDmogASAOayAPQv///wGDIAJ8IAMgBUHAAEEgIA5BgAhLG2oQBiEBAkAgB0EBRw0AIAQgBSkDADcDACAEIAUpAwg3AwggBCAFKQMQNwMQIAQgBSkDGDcDGCAEIAUpAyA3AyAgBCAFKQMoNwMoIAQgBSkDMDcDMCAEIAUpAzg3AzhBAiEGDAELQQAhBkEAIQACQCABIAdqIglBAkkNACAJQX5qIgpBAXZBAWoiBkEDcSEOQQAhBwJAIApBBkkNACAGQXxxIQggBUGUAWohAUEAIQcgBSEAA0AgASAAQcABajYCACABQXxqIABBgAFqNgIAIAFBeGogAEHAAGo2AgAgAUF0aiAANgIAIABBgAJqIQAgAUEQaiEBIAggB0EEaiIHRw0ACwsgCkF+cSEIAkAgDkUNACAFIAdBBnRqIQEgBUGIAWogB0ECdGohAANAIAAgATYCACABQcAAaiEBIABBBGohACAOQX9qIg4NAAsLIAhBAmohAAsgBUGIAWogBkEBQgBBACADQQRyQQBBACAEEAEgACAJTw0AIAQgBkEFdGoiASAFIAZBBnRqIgApAwA3AwAgASAAKQMINwMIIAEgACkDEDcDECABIAApAxg3AxggBkEBaiEGCyAFQeACaiQAIAYLrRAIAn8EfgF/AX4EfwR+BH8EfiMAQfABayIBJAACQCAARQ0AAkBBAC0AkIoBIgINACABQTBqQQApA9CJATcDACABQThqQQApA9iJATcDACABQQApA6CJASIDNwMAIAFBACkDqIkBIgQ3AwggAUEAKQOwiQEiBTcDECABQQApA7iJASIGNwMYIAFBACkDyIkBNwMoQQAtAIqKASECQQAtAImKASEHQQApA8CJASEIQQAtAIiKASEJIAFBwABqQQApA+CJATcDACABQcgAakEAKQPoiQE3AwAgAUHQAGpBACkD8IkBNwMAIAFB2ABqQQApA/iJATcDACABQeAAakEAKQOAigE3AwAgASAJOgBoIAEgCDcDICABIAIgB0VyIgJBAnI6AGkgAUEoaiEKQgAhCEGACSELIAJBCnJB/wFxIQwDQCABQbABaiABIAogCUH/AXEgCCAMEAIgASABKQPQASINIAEpA7ABhTcDcCABIAEpA9gBIg4gASkDuAGFNwN4IAEgASkD4AEiDyABKQPAAYU3A4ABIAEgASkD6AEiECAGhTcDqAEgASAPIAWFNwOgASABIA4gBIU3A5gBIAEgDSADhTcDkAEgASAQIAEpA8gBhTcDiAEgAEHAACAAQcAASRsiEUF/aiESAkACQCARQQdxIhMNACABQfAAaiECIAshByARIRQMAQsgEUH4AHEhFCABQfAAaiECIAshBwNAIAcgAi0AADoAACAHQQFqIQcgAkEBaiECIBNBf2oiEw0ACwsCQCASQQdJDQADQCAHIAIpAAA3AAAgB0EIaiEHIAJBCGohAiAUQXhqIhQNAAsLIAhCAXwhCCALIBFqIQsgACARayIADQAMAgsLAkACQAJAQQAtAImKASIHQQZ0QQBBAC0AiIoBIhFrRg0AIAEgEToAaCABQQApA4CKATcDYCABQQApA/iJATcDWCABQQApA/CJATcDUCABQQApA+iJATcDSCABQQApA+CJATcDQCABQQApA9iJATcDOCABQQApA9CJATcDMCABQQApA8iJATcDKCABQQApA8CJASIINwMgIAFBACkDuIkBIgM3AxggAUEAKQOwiQEiBDcDECABQQApA6iJASIFNwMIIAFBACkDoIkBIgY3AwAgAUEALQCKigEiEyAHRXJBAnIiCzoAaSATQQRyIRNBACkDmIkBIQ1BACkDkIkBIQ5BACkDiIkBIQ9BACkDgIkBIRAMAQtBwAAhESABQcAAOgBoQgAhCCABQgA3AyAgAUEAKQOYiQEiDTcDGCABQQApA5CJASIONwMQIAFBACkDiIkBIg83AwggAUEAKQOAiQEiEDcDACABQQAtAIqKAUEEciITOgBpIAEgAkF+aiICQQV0IgdByYoBaikDADcDYCABIAdBwYoBaikDADcDWCABIAdBuYoBaikDADcDUCABIAdBsYoBaikDADcDSCABIAdBqYoBaikDADcDQCABIAdBoYoBaikDADcDOCABIAdBmYoBaikDADcDMCABIAdBkYoBaikDADcDKCATIQsgECEGIA8hBSAOIQQgDSEDIAJFDQELIAJBf2oiB0EFdCIUQZGKAWopAwAhFSAUQZmKAWopAwAhFiAUQaGKAWopAwAhFyAUQamKAWopAwAhGCABIAM3A4gBIAEgBDcDgAEgASAFNwN4IAEgBjcDcCABQbABaiABQfAAaiABQShqIhQgESAIIAtB/wFxEAIgASATOgBpIAFBwAA6AGggASAYNwNAIAEgFzcDOCABIBY3AzAgASAVNwMoIAFCADcDICABIA03AxggASAONwMQIAEgDzcDCCABIBA3AwAgASABKQPoASABKQPIAYU3A2AgASABKQPgASABKQPAAYU3A1ggASABKQPYASABKQO4AYU3A1AgASABKQPQASABKQOwAYU3A0ggB0UNACACQQV0QemJAWohAiATQf8BcSERA0AgAkFoaikDACEIIAJBcGopAwAhAyACQXhqKQMAIQQgAikDACEFIAEgDTcDiAEgASAONwOAASABIA83A3ggASAQNwNwIAFBsAFqIAFB8ABqIBRBwABCACAREAIgASATOgBpIAFBwAA6AGggASAFNwNAIAEgBDcDOCABIAM3AzAgASAINwMoIAFCADcDICABIA03AxggASAONwMQIAEgDzcDCCABIBA3AwAgASABKQPoASABKQPIAYU3A2AgASABKQPgASABKQPAAYU3A1ggASABKQPYASABKQO4AYU3A1AgASABKQPQASABKQOwAYU3A0ggAkFgaiECIAdBf2oiBw0ACwsgAUEoaiEJQgAhCEGACSELIBNBCHJB/wFxIQoDQCABQbABaiABIAlBwAAgCCAKEAIgASABKQPQASIDIAEpA7ABhTcDcCABIAEpA9gBIgQgASkDuAGFNwN4IAEgASkD4AEiBSABKQPAAYU3A4ABIAEgDSABKQPoASIGhTcDqAEgASAOIAWFNwOgASABIA8gBIU3A5gBIAEgECADhTcDkAEgASAGIAEpA8gBhTcDiAEgAEHAACAAQcAASRsiEUF/aiESAkACQCARQQdxIhMNACABQfAAaiECIAshByARIRQMAQsgEUH4AHEhFCABQfAAaiECIAshBwNAIAcgAi0AADoAACAHQQFqIQcgAkEBaiECIBNBf2oiEw0ACwsCQCASQQdJDQADQCAHIAIpAAA3AAAgB0EIaiEHIAJBCGohAiAUQXhqIhQNAAsLIAhCAXwhCCALIBFqIQsgACARayIADQALCyABQfABaiQAC6MCAQR+AkACQCAAQSBGDQBCq7OP/JGjs/DbACEBQv+kuYjFkdqCm38hAkLy5rvjo6f9p6V/IQNC58yn0NbQ67O7fyEEQQAhAAwBC0EAKQOYCSEBQQApA5AJIQJBACkDiAkhA0EAKQOACSEEQRAhAAtBACAAOgCKigFBAEIANwOAigFBAEIANwP4iQFBAEIANwPwiQFBAEIANwPoiQFBAEIANwPgiQFBAEIANwPYiQFBAEIANwPQiQFBAEIANwPIiQFBAEIANwPAiQFBACABNwO4iQFBACACNwOwiQFBACADNwOoiQFBACAENwOgiQFBACABNwOYiQFBACACNwOQiQFBACADNwOIiQFBACAENwOAiQFBAEEAOgCQigFBAEEAOwGIigELBgAgABADCwYAIAAQBwsGAEGAiQELqwIBBH4CQAJAIAFBIEYNAEKrs4/8kaOz8NsAIQNC/6S5iMWR2oKbfyEEQvLmu+Ojp/2npX8hBULnzKfQ1tDrs7t/IQZBACEBDAELQQApA5gJIQNBACkDkAkhBEEAKQOICSEFQQApA4AJIQZBECEBC0EAIAE6AIqKAUEAQgA3A4CKAUEAQgA3A/iJAUEAQgA3A/CJAUEAQgA3A+iJAUEAQgA3A+CJAUEAQgA3A9iJAUEAQgA3A9CJAUEAQgA3A8iJAUEAQgA3A8CJAUEAIAM3A7iJAUEAIAQ3A7CJAUEAIAU3A6iJAUEAIAY3A6CJAUEAIAM3A5iJAUEAIAQ3A5CJAUEAIAU3A4iJAUEAIAY3A4CJAUEAQQA6AJCKAUEAQQA7AYiKASAAEAMgAhAHCwsLAQBBgAgLBHgHAAA=",hash:"540e8b8e"};new D;function $(e){return!Number.isInteger(e)||e<8||e%8!==0?new Error("Invalid variant! Valid values: 8, 16, ..."):null}new D;new D;new D;new D;new D;new D;new D;new D;new D;new D;new D;new D;new D;new ArrayBuffer(8);new D;new ArrayBuffer(8);new D;new ArrayBuffer(8);new D;new D;new D;var ee=n(72667),te=n(56324);async function ne(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Promise.all(n.map(ie))}function re(e){return{...e,encode:e.encode.bind(e),digest:e.digest.bind(e)}}async function ie(e){switch(e){case te.sha256.code:return re(te.sha256);case te.sha512.code:return re(te.sha512);case 17:return re((0,ee.D)({name:"sha1",code:e,encode:async e=>{var t;const r=null!==(t=globalThis.crypto)&&void 0!==t?t:(await Promise.all([n.e(433),n.e(3)]).then(n.t.bind(n,86433,19))).webcrypto,i=await r.subtle.digest("SHA-1",e);return new Uint8Array(i)}}));case R.code:return re(R);case x.code:return re(x);case 30:return re((0,ee.D)({name:"blake3",code:e,encode:async e=>{const t=await function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:256,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if($(e))return Promise.reject($(e));let n=null,r=0;if(null!==t){if(n=Z(t),32!==n.length)return Promise.reject(new Error("Key length must be exactly 32 bytes"));r=32}const i=e/8,o=i;return J(X,i).then((e=>{32===r&&e.writeMemory(n),e.init(r);const t={init:32===r?()=>(e.writeMemory(n),e.init(r),t):()=>(e.init(r),t),update:n=>(e.update(n),t),digest:t=>e.digest(t,o),save:()=>e.save(),load:n=>(e.load(n),t),blockSize:64,digestSize:i};return t}))}();return t.init(),t.update(e),t.digest("binary")}}));default:throw new Error("unknown multihasher code '".concat(e,"'"))}}},29405:(e,t,n)=>{"use strict";n.d(t,{V:()=>i,_:()=>o});var r=n(72791);const i={getSteps:e=>{let{t:t}=e;return[{content:r.createElement("div",{className:"montserrat charcoal"},r.createElement("h2",{className:"f3 fw4"},t("tour.projects.title")),r.createElement("p",{className:"tl f6"},t("tour.projects.paragraph1"))),placement:"center",target:"body"}]},styles:{options:{width:"500px",primaryColor:"#69c4cd",textColor:"#34373f",zIndex:999}}},o={getSteps:e=>{let{t:t}=e;return[{content:r.createElement("div",{className:"montserrat charcoal"},r.createElement("h2",{className:"f3 fw4"},t("tour.explorer.step1.title")),r.createElement("p",{className:"tl f6"},t("tour.explorer.step1.paragraph1"))),placement:"center",target:"body"},{content:r.createElement("div",{className:"montserrat charcoal"},r.createElement("h2",{className:"f3 fw4"},t("tour.explorer.step2.title")),r.createElement("p",{className:"tl f6"},t("tour.explorer.step2.paragraph1")),r.createElement("p",{className:"tl f6"},t("tour.explorer.step2.paragraph2"))),placement:"bottom",target:".joyride-explorer-crumbs"},{content:r.createElement("div",{className:"montserrat charcoal"},r.createElement("h2",{className:"f3 fw4"},t("tour.explorer.step3.title")),r.createElement("p",{className:"tl f6"},t("tour.explorer.step3.paragraph1"))),placement:"right",target:".joyride-explorer-node"},{content:r.createElement("div",{className:"montserrat charcoal"},r.createElement("h2",{className:"f3 fw4"},t("tour.explorer.step4.title")),r.createElement("p",{className:"tl f6"},t("tour.explorer.step4.paragraph1"))),placement:"left",target:".joyride-explorer-cid"},{content:r.createElement("div",{className:"montserrat charcoal"},r.createElement("h2",{className:"f3 fw4"},t("tour.explorer.step5.title")),r.createElement("p",{className:"tl f6"},t("tour.explorer.step5.paragraph1"))),locale:{last:"Finish"},placement:"left",target:".joyride-explorer-graph"}]},styles:{options:{width:"500px",primaryColor:"#69c4cd",textColor:"#34373f",zIndex:999}}}},52917:(e,t,n)=>{"use strict";n.d(t,{kU:()=>h,Dp:()=>u,ET:()=>d});const r=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==n[s])throw new TypeError(o+" is ambiguous");n[s]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var r=0,i=0;e[t]===c;)r++,t++;for(var o=(e.length-t)*l+1>>>0,s=new Uint8Array(o);e[t];){var u=n[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=o-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*s[d]>>>0,s[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=o-i;f!==o&&0===s[f];)f++;for(var p=new Uint8Array(r+(o-f)),g=r;f!==o;)p[g++]=s[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,o=t.length;i!==o&&0===t[i];)i++,n++;for(var s=(o-i)*u+1>>>0,l=new Uint8Array(s);i!==o;){for(var h=t[i],d=0,f=s-1;(0!==h||d<r)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");r=d,i++}for(var p=s-r;p!==s&&0===l[p];)p++;for(var g=c.repeat(n);p<s;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:h,decode:function(e){var n=h(e);if(n)return n;throw new Error("Non-".concat(t," character"))}}};var i=n(53268);class o{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(e));throw Error("Unknown type, must be binary type")}}class s{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(e),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return c(this,e)}}class a{constructor(e){this.decoders=e}or(e){return c(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(e),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}}const c=(e,t)=>new a({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class l{constructor(e,t,n,r){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=r,this.encoder=new o(e,t,n),this.decoder=new s(e,t,r)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const u=e=>{let{name:t,prefix:n,encode:r,decode:i}=e;return new l(t,n,r,i)},h=e=>{let{prefix:t,name:n,alphabet:o}=e;const{encode:s,decode:a}=r(o,n);return u({prefix:t,name:n,encode:s,decode:e=>(0,i.oQ)(a(e))})},d=e=>{let{name:t,prefix:n,bitsPerChar:r,alphabet:i}=e;return u({prefix:n,name:t,encode:e=>((e,t,n)=>{const r="="===t[t.length-1],i=(1<<n)-1;let o="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>n;)s-=n,o+=t[i&a>>s];if(s&&(o+=t[i&a<<n-s]),r)for(;o.length*n&7;)o+="=";return o})(e,i,r),decode:e=>((e,t,n,r)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*n/8|0);let a=0,c=0,l=0;for(let u=0;u<o;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError("Non-".concat(r," character"));c=c<<n|t,a+=n,a>=8&&(a-=8,s[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s})(e,i,r,t)})}},85970:(e,t,n)=>{"use strict";n.r(t),n.d(t,{base32:()=>i,base32hex:()=>c,base32hexpad:()=>u,base32hexpadupper:()=>h,base32hexupper:()=>l,base32pad:()=>s,base32padupper:()=>a,base32upper:()=>o,base32z:()=>d});var r=n(52917);const i=(0,r.ET)({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),o=(0,r.ET)({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),s=(0,r.ET)({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),a=(0,r.ET)({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),c=(0,r.ET)({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),l=(0,r.ET)({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),u=(0,r.ET)({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),h=(0,r.ET)({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),d=(0,r.ET)({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})},39984:(e,t,n)=>{"use strict";n.r(t),n.d(t,{base58btc:()=>i,base58flickr:()=>o});var r=n(52917);const i=(0,r.kU)({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),o=(0,r.kU)({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})},98117:(e,t,n)=>{"use strict";n.r(t),n.d(t,{base64:()=>i,base64pad:()=>o,base64url:()=>s,base64urlpad:()=>a});var r=n(52917);const i=(0,r.ET)({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),o=(0,r.ET)({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),s=(0,r.ET)({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),a=(0,r.ET)({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})},3734:(e,t,n)=>{"use strict";n.d(t,{gh:()=>R});var r={};n.r(r),n.d(r,{base10:()=>h});var i={};n.r(i),n.d(i,{base16:()=>d,base16upper:()=>f});var o={};n.r(o),n.d(o,{base2:()=>p});var s={};n.r(s),n.d(s,{base256emoji:()=>v});var a={};n.r(a),n.d(a,{base36:()=>w,base36upper:()=>E});var c={};n.r(c),n.d(c,{base8:()=>_});var l={};n.r(l),n.d(l,{identity:()=>C});var u=n(52917);const h=(0,u.kU)({prefix:"9",name:"base10",alphabet:"0123456789"}),d=(0,u.ET)({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),f=(0,u.ET)({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),p=(0,u.ET)({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),g=Array.from("\ud83d\ude80\ud83e\ude90\u2604\ud83d\udef0\ud83c\udf0c\ud83c\udf11\ud83c\udf12\ud83c\udf13\ud83c\udf14\ud83c\udf15\ud83c\udf16\ud83c\udf17\ud83c\udf18\ud83c\udf0d\ud83c\udf0f\ud83c\udf0e\ud83d\udc09\u2600\ud83d\udcbb\ud83d\udda5\ud83d\udcbe\ud83d\udcbf\ud83d\ude02\u2764\ud83d\ude0d\ud83e\udd23\ud83d\ude0a\ud83d\ude4f\ud83d\udc95\ud83d\ude2d\ud83d\ude18\ud83d\udc4d\ud83d\ude05\ud83d\udc4f\ud83d\ude01\ud83d\udd25\ud83e\udd70\ud83d\udc94\ud83d\udc96\ud83d\udc99\ud83d\ude22\ud83e\udd14\ud83d\ude06\ud83d\ude44\ud83d\udcaa\ud83d\ude09\u263a\ud83d\udc4c\ud83e\udd17\ud83d\udc9c\ud83d\ude14\ud83d\ude0e\ud83d\ude07\ud83c\udf39\ud83e\udd26\ud83c\udf89\ud83d\udc9e\u270c\u2728\ud83e\udd37\ud83d\ude31\ud83d\ude0c\ud83c\udf38\ud83d\ude4c\ud83d\ude0b\ud83d\udc97\ud83d\udc9a\ud83d\ude0f\ud83d\udc9b\ud83d\ude42\ud83d\udc93\ud83e\udd29\ud83d\ude04\ud83d\ude00\ud83d\udda4\ud83d\ude03\ud83d\udcaf\ud83d\ude48\ud83d\udc47\ud83c\udfb6\ud83d\ude12\ud83e\udd2d\u2763\ud83d\ude1c\ud83d\udc8b\ud83d\udc40\ud83d\ude2a\ud83d\ude11\ud83d\udca5\ud83d\ude4b\ud83d\ude1e\ud83d\ude29\ud83d\ude21\ud83e\udd2a\ud83d\udc4a\ud83e\udd73\ud83d\ude25\ud83e\udd24\ud83d\udc49\ud83d\udc83\ud83d\ude33\u270b\ud83d\ude1a\ud83d\ude1d\ud83d\ude34\ud83c\udf1f\ud83d\ude2c\ud83d\ude43\ud83c\udf40\ud83c\udf37\ud83d\ude3b\ud83d\ude13\u2b50\u2705\ud83e\udd7a\ud83c\udf08\ud83d\ude08\ud83e\udd18\ud83d\udca6\u2714\ud83d\ude23\ud83c\udfc3\ud83d\udc90\u2639\ud83c\udf8a\ud83d\udc98\ud83d\ude20\u261d\ud83d\ude15\ud83c\udf3a\ud83c\udf82\ud83c\udf3b\ud83d\ude10\ud83d\udd95\ud83d\udc9d\ud83d\ude4a\ud83d\ude39\ud83d\udde3\ud83d\udcab\ud83d\udc80\ud83d\udc51\ud83c\udfb5\ud83e\udd1e\ud83d\ude1b\ud83d\udd34\ud83d\ude24\ud83c\udf3c\ud83d\ude2b\u26bd\ud83e\udd19\u2615\ud83c\udfc6\ud83e\udd2b\ud83d\udc48\ud83d\ude2e\ud83d\ude46\ud83c\udf7b\ud83c\udf43\ud83d\udc36\ud83d\udc81\ud83d\ude32\ud83c\udf3f\ud83e\udde1\ud83c\udf81\u26a1\ud83c\udf1e\ud83c\udf88\u274c\u270a\ud83d\udc4b\ud83d\ude30\ud83e\udd28\ud83d\ude36\ud83e\udd1d\ud83d\udeb6\ud83d\udcb0\ud83c\udf53\ud83d\udca2\ud83e\udd1f\ud83d\ude41\ud83d\udea8\ud83d\udca8\ud83e\udd2c\u2708\ud83c\udf80\ud83c\udf7a\ud83e\udd13\ud83d\ude19\ud83d\udc9f\ud83c\udf31\ud83d\ude16\ud83d\udc76\ud83e\udd74\u25b6\u27a1\u2753\ud83d\udc8e\ud83d\udcb8\u2b07\ud83d\ude28\ud83c\udf1a\ud83e\udd8b\ud83d\ude37\ud83d\udd7a\u26a0\ud83d\ude45\ud83d\ude1f\ud83d\ude35\ud83d\udc4e\ud83e\udd32\ud83e\udd20\ud83e\udd27\ud83d\udccc\ud83d\udd35\ud83d\udc85\ud83e\uddd0\ud83d\udc3e\ud83c\udf52\ud83d\ude17\ud83e\udd11\ud83c\udf0a\ud83e\udd2f\ud83d\udc37\u260e\ud83d\udca7\ud83d\ude2f\ud83d\udc86\ud83d\udc46\ud83c\udfa4\ud83d\ude47\ud83c\udf51\u2744\ud83c\udf34\ud83d\udca3\ud83d\udc38\ud83d\udc8c\ud83d\udccd\ud83e\udd40\ud83e\udd22\ud83d\udc45\ud83d\udca1\ud83d\udca9\ud83d\udc50\ud83d\udcf8\ud83d\udc7b\ud83e\udd10\ud83e\udd2e\ud83c\udfbc\ud83e\udd75\ud83d\udea9\ud83c\udf4e\ud83c\udf4a\ud83d\udc7c\ud83d\udc8d\ud83d\udce3\ud83e\udd42"),y=g.reduce(((e,t,n)=>(e[n]=t,e)),[]),m=g.reduce(((e,t,n)=>(e[t.codePointAt(0)]=n,e)),[]);const v=(0,u.Dp)({prefix:"\ud83d\ude80",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=y[t]),"")},decode:function(e){const t=[];for(const n of e){const e=m[n.codePointAt(0)];if(void 0===e)throw new Error("Non-base256emoji character: ".concat(n));t.push(e)}return new Uint8Array(t)}});var b=n(85970);const w=(0,u.kU)({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),E=(0,u.kU)({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var A=n(39984),S=n(98117);const _=(0,u.ET)({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var I=n(53268);const C=(0,u.Dp)({prefix:"\0",name:"identity",encode:e=>(0,I.BB)(e),decode:e=>(0,I.mL)(e)});n(22171),n(57203);var T=n(46847),k=n(56324);n(19264);const R={...l,...o,...c,...r,...i,...b,...a,...A,...S,...s}},53268:(e,t,n)=>{"use strict";n.d(t,{BB:()=>s,fS:()=>r,mL:()=>o,oQ:()=>i});new Uint8Array(0);const r=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0},i=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},o=e=>(new TextEncoder).encode(e),s=e=>(new TextDecoder).decode(e)},40791:(e,t,n)=>{"use strict";n.d(t,{CID:()=>h});var r=n(85970),i=n(39984),o=n(53268),s=n(44253),a=n(174);const c=(e,t)=>{const{bytes:n,version:o}=e;return 0===o?f(n,u(e),t||i.base58btc.encoder):p(n,u(e),t||r.base32.encoder)},l=new WeakMap,u=e=>{const t=l.get(e);if(null==t){const t=new Map;return l.set(e,t),t}return t};class h{constructor(e,t,n,r){this.code=t,this.version=e,this.multihash=n,this.bytes=r,this["/"]=r}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==g)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==y)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return h.createV0(t)}default:throw Error("Can not convert CID version ".concat(this.version," to version 0. This is a bug please report"))}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=s.Ue(e,t);return h.createV1(this.code,n)}case 1:return this;default:throw Error("Can not convert CID version ".concat(this.version," to version 1. This is a bug please report"))}}equals(e){return h.equals(this,e)}static equals(e,t){const n=t;return n&&e.code===n.code&&e.version===n.version&&s.fS(e.multihash,n.multihash)}toString(e){return c(this,e)}toJSON(){return{"/":c(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID(".concat(this.toString(),")")}static asCID(e){if(null==e)return null;const t=e;if(t instanceof h)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:n,multihash:r,bytes:i}=t;return new h(e,n,r,i||m(e,n,r.bytes))}if(!0===t[v]){const{version:e,multihash:n,code:r}=t,i=s.Jx(n);return h.create(e,r,i)}return null}static create(e,t,n){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==g)throw new Error("Version 0 CID must use dag-pb (code: ".concat(g,") block encoding"));return new h(e,t,n,n.bytes);case 1:{const r=m(e,t,n.bytes);return new h(e,t,n,r)}default:throw new Error("Invalid version")}}static createV0(e){return h.create(0,g,e)}static createV1(e,t){return h.create(1,e,t)}static decode(e){const[t,n]=h.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=h.inspectBytes(e),n=t.size-t.multihashSize,r=(0,o.oQ)(e.subarray(n,n+t.multihashSize));if(r.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=r.subarray(t.multihashSize-t.digestSize),a=new s.zZ(t.multihashCode,t.digestSize,i,r);return[0===t.version?h.createV0(a):h.createV1(t.codec,a),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[n,r]=a.Jx(e.subarray(t));return t+=r,n};let r=n(),i=g;if(18===r?(r=0,t=0):i=n(),0!==r&&1!==r)throw new RangeError("Invalid CID version ".concat(r));const o=t,s=n(),c=n(),l=t+c;return{version:r,codec:i,multihashCode:s,digestSize:c,multihashSize:l-o,size:l}}static parse(e,t){const[n,r]=d(e,t),i=h.decode(r);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return u(i).set(n,e),i}}const d=(e,t)=>{switch(e[0]){case"Q":{const n=t||i.base58btc;return[i.base58btc.prefix,n.decode("".concat(i.base58btc.prefix).concat(e))]}case i.base58btc.prefix:{const n=t||i.base58btc;return[i.base58btc.prefix,n.decode(e)]}case r.base32.prefix:{const n=t||r.base32;return[r.base32.prefix,n.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},f=(e,t,n)=>{const{prefix:r}=n;if(r!==i.base58btc.prefix)throw Error("Cannot string encode V0 in ".concat(n.name," encoding"));const o=t.get(r);if(null==o){const i=n.encode(e).slice(1);return t.set(r,i),i}return o},p=(e,t,n)=>{const{prefix:r}=n,i=t.get(r);if(null==i){const i=n.encode(e);return t.set(r,i),i}return i},g=112,y=18,m=(e,t,n)=>{const r=a.P$(e),i=r+a.P$(t),o=new Uint8Array(i+n.byteLength);return a.mL(e,o,0),a.mL(t,o,r),o.set(n,i),o},v=Symbol.for("@ipld/js-cid/CID")},22171:(e,t,n)=>{"use strict";n.r(t),n.d(t,{code:()=>s,decode:()=>c,encode:()=>a,name:()=>o});const r=new TextEncoder,i=new TextDecoder,o="json",s=512,a=e=>r.encode(JSON.stringify(e)),c=e=>JSON.parse(i.decode(e))},57203:(e,t,n)=>{"use strict";n.r(t),n.d(t,{code:()=>o,decode:()=>a,encode:()=>s,name:()=>i});var r=n(53268);const i="raw",o=85,s=e=>(0,r.oQ)(e),a=e=>(0,r.oQ)(e)},44253:(e,t,n)=>{"use strict";n.d(t,{Jx:()=>s,Ue:()=>o,fS:()=>a,zZ:()=>c});var r=n(53268),i=n(174);const o=(e,t)=>{const n=t.byteLength,r=i.P$(e),o=r+i.P$(n),s=new Uint8Array(o+n);return i.mL(e,s,0),i.mL(n,s,r),s.set(t,o),new c(e,n,t,s)},s=e=>{const t=(0,r.oQ)(e),[n,o]=i.Jx(t),[s,a]=i.Jx(t.subarray(o)),l=t.subarray(o+a);if(l.byteLength!==s)throw new Error("Incorrect length");return new c(n,s,l,t)},a=(e,t)=>{if(e===t)return!0;{const n=t;return e.code===n.code&&e.size===n.size&&n.bytes instanceof Uint8Array&&(0,r.fS)(e.bytes,n.bytes)}};class c{constructor(e,t,n,r){this.code=e,this.size=t,this.digest=n,this.bytes=r}}},72667:(e,t,n)=>{"use strict";n.d(t,{D:()=>i});var r=n(44253);const i=e=>{let{name:t,code:n,encode:r}=e;return new o(t,n,r)};class o{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?r.Ue(this.code,t):t.then((e=>r.Ue(this.code,e)))}throw Error("Unknown type, must be binary type")}}},46847:(e,t,n)=>{"use strict";n.r(t),n.d(t,{identity:()=>s});var r=n(53268),i=n(44253);const o=r.oQ,s={code:0,name:"identity",encode:o,digest:e=>i.Ue(0,o(e))}},56324:(e,t,n)=>{"use strict";n.r(t),n.d(t,{sha256:()=>o,sha512:()=>s});var r=n(72667);const i=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),o=(0,r.D)({name:"sha2-256",code:18,encode:i("SHA-256")}),s=(0,r.D)({name:"sha2-512",code:19,encode:i("SHA-512")})},19264:(e,t,n)=>{"use strict";n.d(t,{CID:()=>r.CID});n(53268);var r=n(40791);n(44253),n(72667),n(174)},174:(e,t,n)=>{"use strict";n.d(t,{Jx:()=>w,mL:()=>E,P$:()=>A});var r=function e(t,n,r){n=n||[];var a=r=r||0;for(;t>=s;)n[r++]=255&t|i,t/=128;for(;t&o;)n[r++]=255&t|i,t>>>=7;return n[r]=0|t,e.bytes=r-a+1,n},i=128,o=-128,s=Math.pow(2,31);var a=function e(t,n){var r,i=0,o=0,s=n=n||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");r=t[s++],i+=o<28?(r&l)<<o:(r&l)*Math.pow(2,o),o+=7}while(r>=c);return e.bytes=s-n,i},c=128,l=127;var u=Math.pow(2,7),h=Math.pow(2,14),d=Math.pow(2,21),f=Math.pow(2,28),p=Math.pow(2,35),g=Math.pow(2,42),y=Math.pow(2,49),m=Math.pow(2,56),v=Math.pow(2,63);const b={encode:r,decode:a,encodingLength:function(e){return e<u?1:e<h?2:e<d?3:e<f?4:e<p?5:e<g?6:e<y?7:e<m?8:e<v?9:10}},w=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return[b.decode(e,t),b.decode.bytes]},E=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return b.encode(e,t,n),t},A=e=>b.encodingLength(e)},82193:(e,t,n)=>{var r=n(1426);e.exports=function(){return"undefined"!==typeof window&&"object"===typeof window.process&&"renderer"===window.process.type||(!("undefined"===typeof r||"object"!==typeof r.versions||!r.versions.electron)||"object"===typeof navigator&&"string"===typeof navigator.userAgent&&navigator.userAgent.indexOf("Electron")>=0)}},7341:(e,t,n)=>{"use strict";n.d(t,{rb:()=>Ie,ml:()=>Pe,ET:()=>xe});const r=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==n[s])throw new TypeError(o+" is ambiguous");n[s]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var r=0,i=0;e[t]===c;)r++,t++;for(var o=(e.length-t)*l+1>>>0,s=new Uint8Array(o);e[t];){var u=n[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=o-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*s[d]>>>0,s[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=o-i;f!==o&&0===s[f];)f++;for(var p=new Uint8Array(r+(o-f)),g=r;f!==o;)p[g++]=s[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,o=t.length;i!==o&&0===t[i];)i++,n++;for(var s=(o-i)*u+1>>>0,l=new Uint8Array(s);i!==o;){for(var h=t[i],d=0,f=s-1;(0!==h||d<r)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");r=d,i++}for(var p=s-r;p!==s&&0===l[p];)p++;for(var g=c.repeat(n);p<s;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:h,decode:function(e){var n=h(e);if(n)return n;throw new Error("Non-".concat(t," character"))}}},i=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class o{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(e));throw Error("Unknown type, must be binary type")}}class s{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(e),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return c(this,e)}}class a{constructor(e){this.decoders=e}or(e){return c(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(e),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}}const c=(e,t)=>new a({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class l{constructor(e,t,n,r){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=r,this.encoder=new o(e,t,n),this.decoder=new s(e,t,r)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const u=e=>{let{name:t,prefix:n,encode:r,decode:i}=e;return new l(t,n,r,i)},h=e=>{let{prefix:t,name:n,alphabet:o}=e;const{encode:s,decode:a}=r(o,n);return u({prefix:t,name:n,encode:s,decode:e=>i(a(e))})},d=e=>{let{name:t,prefix:n,bitsPerChar:r,alphabet:i}=e;return u({prefix:n,name:t,encode:e=>((e,t,n)=>{const r="="===t[t.length-1],i=(1<<n)-1;let o="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>n;)s-=n,o+=t[i&a>>s];if(s&&(o+=t[i&a<<n-s]),r)for(;o.length*n&7;)o+="=";return o})(e,i,r),decode:e=>((e,t,n,r)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*n/8|0);let a=0,c=0,l=0;for(let u=0;u<o;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError("Non-".concat(r," character"));c=c<<n|t,a+=n,a>=8&&(a-=8,s[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s})(e,i,r,t)})},f=h({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),p=(h({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),d({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}));d({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),d({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),d({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),d({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),d({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),d({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),d({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),d({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var g=function e(t,n,r){n=n||[];var i=r=r||0;for(;t>=v;)n[r++]=255&t|y,t/=128;for(;t&m;)n[r++]=255&t|y,t>>>=7;return n[r]=0|t,e.bytes=r-i+1,n},y=128,m=-128,v=Math.pow(2,31);var b=function e(t,n){var r,i=0,o=0,s=n=n||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");r=t[s++],i+=o<28?(r&E)<<o:(r&E)*Math.pow(2,o),o+=7}while(r>=w);return e.bytes=s-n,i},w=128,E=127;var A=Math.pow(2,7),S=Math.pow(2,14),_=Math.pow(2,21),I=Math.pow(2,28),C=Math.pow(2,35),T=Math.pow(2,42),k=Math.pow(2,49),R=Math.pow(2,56),x=Math.pow(2,63);const P={encode:g,decode:b,encodingLength:function(e){return e<A?1:e<S?2:e<_?3:e<I?4:e<C?5:e<T?6:e<k?7:e<R?8:e<x?9:10}},D=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return[P.decode(e,t),P.decode.bytes]},O=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return P.encode(e,t,n),t},N=e=>P.encodingLength(e);class B{constructor(e,t,n,r){this.code=e,this.size=t,this.digest=n,this.bytes=r}}var L=n(95321);const M=ce("dns4"),U=ce("dns6"),F=ce("dnsaddr"),K=ae(ce("dns"),F,M,U),j=ae(ce("ip4"),ce("ip6")),Z=ae(se(j,ce("tcp")),se(K,ce("tcp"))),z=se(j,ce("udp")),V=se(z,ce("utp")),H=se(z,ce("quic")),q=ae(se(Z,ce("ws")),se(K,ce("ws"))),G=ae(se(Z,ce("wss")),se(K,ce("wss")),se(Z,ce("tls"),ce("ws")),se(K,ce("tls"),ce("ws"))),W=ae(se(Z,ce("http")),se(j,ce("http")),se(K,ce("http"))),Q=ae(se(Z,ce("https")),se(j,ce("https")),se(K,ce("https"))),Y=se(z,ce("webrtc"),ce("certhash")),J=ae(se(Y,ce("p2p")),Y),X=ae(se(q,ce("p2p-webrtc-star"),ce("p2p")),se(G,ce("p2p-webrtc-star"),ce("p2p")),se(q,ce("p2p-webrtc-star")),se(G,ce("p2p-webrtc-star"))),$=(ae(se(q,ce("p2p-websocket-star"),ce("p2p")),se(G,ce("p2p-websocket-star"),ce("p2p")),se(q,ce("p2p-websocket-star")),se(G,ce("p2p-websocket-star"))),ae(se(W,ce("p2p-webrtc-direct"),ce("p2p")),se(Q,ce("p2p-webrtc-direct"),ce("p2p")),se(W,ce("p2p-webrtc-direct")),se(Q,ce("p2p-webrtc-direct")))),ee=ae(q,G,W,Q,X,$,Z,V,H,K,J),te=(ae(se(ee,ce("p2p-stardust"),ce("p2p")),se(ee,ce("p2p-stardust"))),ae(se(ee,ce("p2p")),X,$,J,ce("p2p"))),ne=ae(se(te,ce("p2p-circuit"),te),se(te,ce("p2p-circuit")),se(ce("p2p-circuit"),te),se(ee,ce("p2p-circuit")),se(ce("p2p-circuit"),ee),ce("p2p-circuit")),re=()=>ae(se(ne,re),ne),ie=re();ae(se(ie,te,ie),se(te,ie),se(ie,te),ie,te);function oe(e){return function(t){let n;try{n=(0,L.HM)(t)}catch(i){return!1}const r=e(n.protoNames());return null!==r&&(!0===r||!1===r?r:0===r.length)}}function se(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];function r(e){if(e.length<t.length)return null;let n=e;return t.some((t=>(n="function"===typeof t?t().partialMatch(e):t.partialMatch(e),Array.isArray(n)&&(e=n),null===n))),n}return{toString:function(){return"{ "+t.join(" ")+" }"},input:t,matches:oe(r),partialMatch:r}}function ae(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];function r(e){let n=null;return t.some((t=>{const r="function"===typeof t?t().partialMatch(e):t.partialMatch(e);return null!=r&&(n=r,!0)})),n}return{toString:function(){return"{ "+t.join(" ")+" }"},input:t,matches:oe(r),partialMatch:r}}function ce(e){const t=e;return{toString:function(){return t},matches:function(e){let n;try{n=(0,L.HM)(e)}catch(i){return!1}const r=n.protoNames();return 1===r.length&&r[0]===t},partialMatch:function(e){return 0===e.length?null:e[0]===t?e.slice(1):null}}}const le=(e,t)=>{const{bytes:n,version:r}=e;return 0===r?pe(n,he(e),t||f.encoder):ge(n,he(e),t||p.encoder)},ue=new WeakMap,he=e=>{const t=ue.get(e);if(null==t){const t=new Map;return ue.set(e,t),t}return t};class de{constructor(e,t,n,r){this.code=t,this.version=e,this.multihash=n,this.bytes=r,this["/"]=r}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==ye)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==me)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return de.createV0(t)}default:throw Error("Can not convert CID version ".concat(this.version," to version 0. This is a bug please report"))}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=((e,t)=>{const n=t.byteLength,r=N(e),i=r+N(n),o=new Uint8Array(i+n);return O(e,o,0),O(n,o,r),o.set(t,i),new B(e,n,t,o)})(e,t);return de.createV1(this.code,n)}case 1:return this;default:throw Error("Can not convert CID version ".concat(this.version," to version 1. This is a bug please report"))}}equals(e){return de.equals(this,e)}static equals(e,t){const n=t;return n&&e.code===n.code&&e.version===n.version&&((e,t)=>{if(e===t)return!0;{const n=t;return e.code===n.code&&e.size===n.size&&n.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0})(e.bytes,n.bytes)}})(e.multihash,n.multihash)}toString(e){return le(this,e)}toJSON(){return{"/":le(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID(".concat(this.toString(),")")}static asCID(e){if(null==e)return null;const t=e;if(t instanceof de)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:n,multihash:r,bytes:i}=t;return new de(e,n,r,i||ve(e,n,r.bytes))}if(!0===t[be]){const{version:e,multihash:n,code:r}=t,o=(e=>{const t=i(e),[n,r]=D(t),[o,s]=D(t.subarray(r)),a=t.subarray(r+s);if(a.byteLength!==o)throw new Error("Incorrect length");return new B(n,o,a,t)})(n);return de.create(e,r,o)}return null}static create(e,t,n){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==ye)throw new Error("Version 0 CID must use dag-pb (code: ".concat(ye,") block encoding"));return new de(e,t,n,n.bytes);case 1:{const r=ve(e,t,n.bytes);return new de(e,t,n,r)}default:throw new Error("Invalid version")}}static createV0(e){return de.create(0,ye,e)}static createV1(e,t){return de.create(1,e,t)}static decode(e){const[t,n]=de.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=de.inspectBytes(e),n=t.size-t.multihashSize,r=i(e.subarray(n,n+t.multihashSize));if(r.byteLength!==t.multihashSize)throw new Error("Incorrect length");const o=r.subarray(t.multihashSize-t.digestSize),s=new B(t.multihashCode,t.digestSize,o,r);return[0===t.version?de.createV0(s):de.createV1(t.codec,s),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[n,r]=D(e.subarray(t));return t+=r,n};let r=n(),i=ye;if(18===r?(r=0,t=0):i=n(),0!==r&&1!==r)throw new RangeError("Invalid CID version ".concat(r));const o=t,s=n(),a=n(),c=t+a;return{version:r,codec:i,multihashCode:s,digestSize:a,multihashSize:c-o,size:c}}static parse(e,t){const[n,r]=fe(e,t),i=de.decode(r);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return he(i).set(n,e),i}}const fe=(e,t)=>{switch(e[0]){case"Q":{const n=t||f;return[f.prefix,n.decode("".concat(f.prefix).concat(e))]}case f.prefix:{const n=t||f;return[f.prefix,n.decode(e)]}case p.prefix:{const n=t||p;return[p.prefix,n.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},pe=(e,t,n)=>{const{prefix:r}=n;if(r!==f.prefix)throw Error("Cannot string encode V0 in ".concat(n.name," encoding"));const i=t.get(r);if(null==i){const i=n.encode(e).slice(1);return t.set(r,i),i}return i},ge=(e,t,n)=>{const{prefix:r}=n,i=t.get(r);if(null==i){const i=n.encode(e);return t.set(r,i),i}return i},ye=112,me=18,ve=(e,t,n)=>{const r=N(e),i=r+N(t),o=new Uint8Array(i+n.byteLength);return O(e,o,0),O(t,o,r),o.set(n,i),o},be=Symbol.for("@ipld/js-cid/CID");var we=n(16791),Ee=n(18601);const Ae=/^\/(ip[fn]s)\/([^/?#]+)/,Se=/^https?:\/\/([^/]+)\.(ip[fn]s)\.[^/?]+/,_e=/^(([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])\.)+([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])$/;function Ie(e){try{return ke(e)?Boolean(de.parse(e)):e instanceof Uint8Array?Boolean(de.decode(e)):Boolean(de.asCID(e))}catch{return!1}}function Ce(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2;const i=Re(e);if(!1===i)return!1;const o=i.match(t);if(null==o)return!1;if("ipfs"!==o[n])return!1;let s=o[r];return null!=s&&t===Se&&(s=s.toLowerCase()),Ie(s)}function Te(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2;const i=Re(e);if(!1===i)return!1;const o=i.match(t);if(null==o)return!1;if("ipns"!==o[n])return!1;let s=o[r];if(null!=s&&t===Se){if(s=s.toLowerCase(),Ie(s))return!0;try{!s.includes(".")&&s.includes("-")&&(s=s.replace(/--/g,"@").replace(/-/g,".").replace(/@/g,"-"));const{hostname:e}=new we.URL("http://".concat(s));return _e.test(e)}catch(a){return!1}}return!0}function ke(e){return"string"===typeof e}function Re(e){return e instanceof Uint8Array?(0,Ee.B)(e,"base58btc"):!!ke(e)&&e}const xe=e=>Ce(e,Ae)||Te(e,Ae),Pe=e=>Ce(e,Ae)},14456:(e,t,n)=>{var r=n(60463);e.exports=function(e,t){return r(e,t)===e}},50887:e=>{"use strict";e.exports=e=>{if("[object Object]"!==Object.prototype.toString.call(e))return!1;const t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}},49355:(e,t,n)=>{var r=n(98059);e.exports=function(e,t){return r(e,t)===e}},16791:(e,t,n)=>{"use strict";const{URLWithLegacySupport:r,format:i,URLSearchParams:o,defaultBase:s}=n(85732),a=n(89640);e.exports={URL:r,URLSearchParams:o,format:i,relative:a,defaultBase:s}},89640:(e,t,n)=>{"use strict";const{URLWithLegacySupport:r,format:i}=n(85732);e.exports=function(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3?arguments[3]:void 0,a=n.protocol?n.protocol.replace(":",""):"http";a=(o[a]||s||a)+":";try{t=new r(e)}catch(l){t={}}const c=Object.assign({},n,{protocol:a||t.protocol,host:n.host||t.host});return new r(e,i(c)).toString()}},85732:e=>{"use strict";const t="undefined"!==typeof navigator&&"ReactNative"===navigator.product;const n=self.URL,r=t?"http://localhost":self.location?self.location.protocol+"//"+self.location.host:"";e.exports={URLWithLegacySupport:class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r;this.super=new n(e,t),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(e){this.super.hash=e}set host(e){this.super.host=e}set hostname(e){this.super.hostname=e}set href(e){this.super.href=e}set password(e){this.super.password=e}set pathname(e){this.super.pathname=e}set port(e){this.super.port=e}set protocol(e){this.super.protocol=e}set search(e){this.super.search=e}set username(e){this.super.username=e}static createObjectURL(e){return n.createObjectURL(e)}static revokeObjectURL(e){n.revokeObjectURL(e)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}},URLSearchParams:self.URLSearchParams,defaultBase:r,format:function(e){if("string"===typeof e){return new n(e).toString()}if(!(e instanceof n)){const t=e.username&&e.password?"".concat(e.username,":").concat(e.password,"@"):"",n=e.auth?e.auth+"@":"",r=e.port?":"+e.port:"",i=e.protocol?e.protocol+"//":"",o=e.host||"",s=e.hostname||"",a=e.search||(e.query?"?"+e.query:""),c=e.hash||"",l=e.pathname||"",u=e.path||l+a;return"".concat(i).concat(t||n).concat(o||s+r).concat(u).concat(c)}}}},50464:e=>{"use strict";e.exports=async e=>{const t=[];for await(const n of e)t.push(n);return t}},84744:e=>{"use strict";e.exports=async e=>{for await(const t of e)return t}},26723:e=>{"use strict";e.exports=async e=>{let t;for await(const n of e)t=n;return t}},27889:e=>{"use strict";e.exports=async function*(e,t){for await(const n of e)yield t(n)}},79023:e=>{const t=function(){let e;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(;n.length;)e=n.shift()(e);return e},n=e=>e&&("function"===typeof e[Symbol.asyncIterator]||"function"===typeof e[Symbol.iterator]||"function"===typeof e.next),r=e=>e&&"function"===typeof e.sink&&n(e.source),i=e=>t=>(e.sink(t),e.source),o=function(){for(var e=arguments.length,o=new Array(e),s=0;s<e;s++)o[s]=arguments[s];if(r(o[0])){const e=o[0];o[0]=()=>e.source}else if(n(o[0])){const e=o[0];o[0]=()=>e}if(o.length>1&&r(o[o.length-1])&&(o[o.length-1]=o[o.length-1].sink),o.length>2)for(let t=1;t<o.length-1;t++)r(o[t])&&(o[t]=i(o[t]));return t(...o)};e.exports=o,e.exports.pipe=o,e.exports.rawPipe=t,e.exports.isIterable=n,e.exports.isDuplex=r},16386:(e,t,n)=>{var r=n(60463);e.exports=function(e,t){return null==e?"":(e=String(e),r(e.charAt(0),t)+e.substr(1))}},60463:e=>{var t={tr:{regexp:/\u0130|\u0049|\u0049\u0307/g,map:{"\u0130":"i",I:"\u0131","I\u0307":"i"}},az:{regexp:/[\u0130]/g,map:{"\u0130":"i",I:"\u0131","I\u0307":"i"}},lt:{regexp:/[\u0049\u004A\u012E\u00CC\u00CD\u0128]/g,map:{I:"i\u0307",J:"j\u0307","\u012e":"\u012f\u0307","\xcc":"i\u0307\u0300","\xcd":"i\u0307\u0301","\u0128":"i\u0307\u0303"}}};e.exports=function(e,n){var r=t[n];return e=null==e?"":String(e),r&&(e=e.replace(r.regexp,(function(e){return r.map[e]}))),e.toLowerCase()}},77288:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(s,a)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=i(n(58322));function s(e){let t,n,i,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"maxAge";const a=()=>r(this,void 0,void 0,(function*(){if(void 0!==t)return;const a=a=>r(this,void 0,void 0,(function*(){i=o.default();const r=a[1][s]-Date.now();return r<=0?(e.delete(a[0]),void i.resolve()):(t=a[0],n=setTimeout((()=>{e.delete(a[0]),i&&i.resolve()}),r),"function"===typeof n.unref&&n.unref(),i.promise)}));try{for(const t of e)yield a(t)}catch(c){}t=void 0})),c=e.set.bind(e);return e.set=(r,o)=>{e.has(r)&&e.delete(r);const s=c(r,o);return t&&t===r&&(t=void 0,void 0!==n&&(clearTimeout(n),n=void 0),void 0!==i&&(i.reject(void 0),i=void 0)),a(),s},a(),e}t.default=s,e.exports=s,e.exports.default=s},58322:e=>{"use strict";e.exports=()=>{const e={};return e.promise=new Promise(((t,n)=>{e.resolve=t,e.reject=n})),e}},89842:function(e,t,n){"use strict";const r=n(50887),{hasOwnProperty:i}=Object.prototype,{propertyIsEnumerable:o}=Object,s=(e,t,n)=>Object.defineProperty(e,t,{value:n,writable:!0,enumerable:!0,configurable:!0}),a=this,c={concatArrays:!1,ignoreUndefined:!1},l=e=>{const t=[];for(const n in e)i.call(e,n)&&t.push(n);if(Object.getOwnPropertySymbols){const n=Object.getOwnPropertySymbols(e);for(const r of n)o.call(e,r)&&t.push(r)}return t};function u(e){return Array.isArray(e)?function(e){const t=e.slice(0,0);return l(e).forEach((n=>{s(t,n,u(e[n]))})),t}(e):r(e)?function(e){const t=null===Object.getPrototypeOf(e)?Object.create(null):{};return l(e).forEach((n=>{s(t,n,u(e[n]))})),t}(e):e}const h=(e,t,n,r)=>(n.forEach((n=>{"undefined"===typeof t[n]&&r.ignoreUndefined||(n in e&&e[n]!==Object.getPrototypeOf(e)?s(e,n,f(e[n],t[n],r)):s(e,n,u(t[n])))})),e),d=(e,t,n)=>{let r=e.slice(0,0),o=0;return[e,t].forEach((t=>{const a=[];for(let n=0;n<t.length;n++)i.call(t,n)&&(a.push(String(n)),s(r,o++,t===e?t[n]:u(t[n])));r=h(r,t,l(t).filter((e=>!a.includes(e))),n)})),r};function f(e,t,n){return n.concatArrays&&Array.isArray(e)&&Array.isArray(t)?d(e,t,n):r(t)&&r(e)?h(e,t,l(t),n):u(t)}e.exports=function(){const e=f(u(c),this!==a&&this||{},c);let t={_:{}};for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];for(const s of i)if(void 0!==s){if(!r(s))throw new TypeError("`"+s+"` is not an Option Object");t=f(t,{_:s},e)}return t._}},94804:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(89842);const i=n.n(r)()},26034:e=>{function t(e){return function(t){return Math.round(t*e)}}e.exports={seconds:t(1e3),minutes:t(6e4),hours:t(36e5),days:t(864e5),weeks:t(6048e5),months:t(26298e5),years:t(315576e5)}},78193:e=>{var t=1e3,n=60*t,r=60*n,i=24*r,o=7*i,s=365.25*i;function a(e,t,n,r){var i=t>=1.5*n;return Math.round(e/n)+" "+r+(i?"s":"")}e.exports=function(e,c){c=c||{};var l=typeof e;if("string"===l&&e.length>0)return function(e){if((e=String(e)).length>100)return;var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!a)return;var c=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*s;case"weeks":case"week":case"w":return c*o;case"days":case"day":case"d":return c*i;case"hours":case"hour":case"hrs":case"hr":case"h":return c*r;case"minutes":case"minute":case"mins":case"min":case"m":return c*n;case"seconds":case"second":case"secs":case"sec":case"s":return c*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}(e);if("number"===l&&isFinite(e))return c.long?function(e){var o=Math.abs(e);if(o>=i)return a(e,o,i,"day");if(o>=r)return a(e,o,r,"hour");if(o>=n)return a(e,o,n,"minute");if(o>=t)return a(e,o,t,"second");return e+" ms"}(e):function(e){var o=Math.abs(e);if(o>=i)return Math.round(e/i)+"d";if(o>=r)return Math.round(e/r)+"h";if(o>=n)return Math.round(e/n)+"m";if(o>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},33543:(e,t,n)=>{"use strict";const{encodeText:r}=n(61348);e.exports=class{constructor(e,t,n,i){this.name=e,this.code=t,this.codeBuf=r(this.code),this.alphabet=i,this.codec=n(i)}encode(e){return this.codec.encode(e)}decode(e){for(const t of e)if(this.alphabet&&this.alphabet.indexOf(t)<0)throw new Error("invalid character '".concat(t,"' in '").concat(e,"'"));return this.codec.decode(e)}}},39213:(e,t,n)=>{"use strict";const r=n(19814),i=n(33543),{rfc4648:o}=n(31186),{decodeText:s,encodeText:a}=n(61348),c=[["identity","\0",()=>({encode:s,decode:a}),""],["base2","0",o(1),"01"],["base8","7",o(3),"01234567"],["base10","9",r,"0123456789"],["base16","f",o(4),"0123456789abcdef"],["base16upper","F",o(4),"0123456789ABCDEF"],["base32hex","v",o(5),"0123456789abcdefghijklmnopqrstuv"],["base32hexupper","V",o(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV"],["base32hexpad","t",o(5),"0123456789abcdefghijklmnopqrstuv="],["base32hexpadupper","T",o(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV="],["base32","b",o(5),"abcdefghijklmnopqrstuvwxyz234567"],["base32upper","B",o(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"],["base32pad","c",o(5),"abcdefghijklmnopqrstuvwxyz234567="],["base32padupper","C",o(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567="],["base32z","h",o(5),"ybndrfg8ejkmcpqxot1uwisza345h769"],["base36","k",r,"0123456789abcdefghijklmnopqrstuvwxyz"],["base36upper","K",r,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"],["base58btc","z",r,"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"],["base58flickr","Z",r,"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"],["base64","m",o(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"],["base64pad","M",o(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="],["base64url","u",o(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"],["base64urlpad","U",o(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_="]],l=c.reduce(((e,t)=>(e[t[0]]=new i(t[0],t[1],t[2],t[3]),e)),{}),u=c.reduce(((e,t)=>(e[t[1]]=l[t[0]],e)),{});e.exports={names:l,codes:u}},80141:(e,t,n)=>{"use strict";const r=n(39213),{encodeText:i,decodeText:o,concat:s}=n(61348);function a(e){if(Object.prototype.hasOwnProperty.call(r.names,e))return r.names[e];if(Object.prototype.hasOwnProperty.call(r.codes,e))return r.codes[e];throw new Error("Unsupported encoding: ".concat(e))}(t=e.exports=function(e,t){if(!t)throw new Error("requires an encoded Uint8Array");const{name:n,codeBuf:r}=a(e);return function(e,t){const n=a(e);n.decode(o(t))}(n,t),s([r,t],r.length+t.length)}).encode=function(e,t){const n=a(e),r=i(n.encode(t));return s([n.codeBuf,r],n.codeBuf.length+r.length)},t.decode=function(e){e instanceof Uint8Array&&(e=o(e));const t=e[0];return["f","F","v","V","t","T","b","B","c","C","h","k","K"].includes(t)&&(e=e.toLowerCase()),a(e[0]).decode(e.substring(1))},t.isEncoded=function(e){if(e instanceof Uint8Array&&(e=o(e)),"[object String]"!==Object.prototype.toString.call(e))return!1;try{return a(e[0]).name}catch(t){return!1}},t.encoding=a,t.encodingFromData=function(e){return e instanceof Uint8Array&&(e=o(e)),a(e[0])};const c=Object.freeze(r.names),l=Object.freeze(r.codes);t.names=c,t.codes=l},31186:e=>{"use strict";e.exports={rfc4648:e=>t=>({encode:n=>((e,t,n)=>{const r="="===t[t.length-1],i=(1<<n)-1;let o="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>n;)s-=n,o+=t[i&a>>s];if(s&&(o+=t[i&a<<n-s]),r)for(;o.length*n&7;)o+="=";return o})(n,t,e),decode:n=>((e,t,n)=>{const r={};for(let l=0;l<t.length;++l)r[t[l]]=l;let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*n/8|0);let s=0,a=0,c=0;for(let l=0;l<i;++l){const t=r[e[l]];if(void 0===t)throw new SyntaxError("Invalid character "+e[l]);a=a<<n|t,s+=n,s>=8&&(s-=8,o[c++]=255&a>>s)}if(s>=n||255&a<<8-s)throw new SyntaxError("Unexpected end of data");return o})(n,t,e)})}},61348:e=>{"use strict";const t=new TextDecoder,n=new TextEncoder;e.exports={decodeText:e=>t.decode(e),encodeText:e=>n.encode(e),concat:function(e,t){const n=new Uint8Array(t);let r=0;for(const i of e)n.set(i,r),r+=i.length;return n}}},3598:(e,t,n)=>{"use strict";n.d(t,{kU:()=>d,Dp:()=>h,ET:()=>f});var r=n(96156),i=n(25671);const o=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==n[s])throw new TypeError(o+" is ambiguous");n[s]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var r=0,i=0;e[t]===c;)r++,t++;for(var o=(e.length-t)*l+1>>>0,s=new Uint8Array(o);e[t];){var u=n[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=o-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*s[d]>>>0,s[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=o-i;f!==o&&0===s[f];)f++;for(var p=new Uint8Array(r+(o-f)),g=r;f!==o;)p[g++]=s[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,o=t.length;i!==o&&0===t[i];)i++,n++;for(var s=(o-i)*u+1>>>0,l=new Uint8Array(s);i!==o;){for(var h=t[i],d=0,f=s-1;(0!==h||d<r)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");r=d,i++}for(var p=s-r;p!==s&&0===l[p];)p++;for(var g=c.repeat(n);p<s;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:h,decode:function(e){var n=h(e);if(n)return n;throw new Error("Non-".concat(t," character"))}}};class s{constructor(e,t,n){(0,r.Z)(this,"name",void 0),(0,r.Z)(this,"prefix",void 0),(0,r.Z)(this,"baseEncode",void 0),this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(e));throw Error("Unknown type, must be binary type")}}class a{constructor(e,t,n){if((0,r.Z)(this,"name",void 0),(0,r.Z)(this,"prefix",void 0),(0,r.Z)(this,"baseDecode",void 0),(0,r.Z)(this,"prefixCodePoint",void 0),this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(e),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return l(this,e)}}class c{constructor(e){(0,r.Z)(this,"decoders",void 0),this.decoders=e}or(e){return l(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(null!=n)return n.decode(e);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(e),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}}function l(e,t){var n,r;return new c({...null!==(n=e.decoders)&&void 0!==n?n:{[e.prefix]:e},...null!==(r=t.decoders)&&void 0!==r?r:{[t.prefix]:t}})}class u{constructor(e,t,n,i){(0,r.Z)(this,"name",void 0),(0,r.Z)(this,"prefix",void 0),(0,r.Z)(this,"baseEncode",void 0),(0,r.Z)(this,"baseDecode",void 0),(0,r.Z)(this,"encoder",void 0),(0,r.Z)(this,"decoder",void 0),this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=i,this.encoder=new s(e,t,n),this.decoder=new a(e,t,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}function h(e){let{name:t,prefix:n,encode:r,decode:i}=e;return new u(t,n,r,i)}function d(e){let{name:t,prefix:n,alphabet:r}=e;const{encode:s,decode:a}=o(r,t);return h({prefix:n,name:t,encode:s,decode:e=>(0,i.oQ)(a(e))})}function f(e){let{name:t,prefix:n,bitsPerChar:r,alphabet:i}=e;return h({prefix:n,name:t,encode:e=>function(e,t,n){const r="="===t[t.length-1],i=(1<<n)-1;let o="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>n;)s-=n,o+=t[i&a>>s];if(0!==s&&(o+=t[i&a<<n-s]),r)for(;0!==(o.length*n&7);)o+="=";return o}(e,i,r),decode:e=>function(e,t,n,r){const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*n/8|0);let a=0,c=0,l=0;for(let u=0;u<o;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError("Non-".concat(r," character"));c=c<<n|t,a+=n,a>=8&&(a-=8,s[l++]=255&c>>a)}if(a>=n||0!==(255&c<<8-a))throw new SyntaxError("Unexpected end of data");return s}(e,i,r,t)})}},3886:(e,t,n)=>{"use strict";n.r(t),n.d(t,{base32:()=>i,base32hex:()=>c,base32hexpad:()=>u,base32hexpadupper:()=>h,base32hexupper:()=>l,base32pad:()=>s,base32padupper:()=>a,base32upper:()=>o,base32z:()=>d});var r=n(3598);const i=(0,r.ET)({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),o=(0,r.ET)({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),s=(0,r.ET)({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),a=(0,r.ET)({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),c=(0,r.ET)({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),l=(0,r.ET)({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),u=(0,r.ET)({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),h=(0,r.ET)({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),d=(0,r.ET)({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})},55577:(e,t,n)=>{"use strict";n.r(t),n.d(t,{base58btc:()=>i,base58flickr:()=>o});var r=n(3598);const i=(0,r.kU)({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),o=(0,r.kU)({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})},52704:(e,t,n)=>{"use strict";n.d(t,{gh:()=>ee});var r={};n.r(r),n.d(r,{base10:()=>y});var i={};n.r(i),n.d(i,{base16:()=>m,base16upper:()=>v});var o={};n.r(o),n.d(o,{base2:()=>b});var s={};n.r(s),n.d(s,{base256emoji:()=>S});var a={};n.r(a),n.d(a,{base36:()=>I,base36upper:()=>C});var c={};n.r(c),n.d(c,{base64:()=>k,base64pad:()=>R,base64url:()=>x,base64urlpad:()=>P});var l={};n.r(l),n.d(l,{base8:()=>D});var u={};n.r(u),n.d(u,{identity:()=>N});var h={};n.r(h),n.d(h,{code:()=>U,decode:()=>K,encode:()=>F,name:()=>M});var d={};n.r(d),n.d(d,{code:()=>Z,decode:()=>V,encode:()=>z,name:()=>j});var f={};n.r(f),n.d(f,{identity:()=>G});var p={};n.r(p),n.d(p,{sha256:()=>X,sha512:()=>$});var g=n(3598);const y=(0,g.kU)({prefix:"9",name:"base10",alphabet:"0123456789"}),m=(0,g.ET)({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),v=(0,g.ET)({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),b=(0,g.ET)({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),w=Array.from("\ud83d\ude80\ud83e\ude90\u2604\ud83d\udef0\ud83c\udf0c\ud83c\udf11\ud83c\udf12\ud83c\udf13\ud83c\udf14\ud83c\udf15\ud83c\udf16\ud83c\udf17\ud83c\udf18\ud83c\udf0d\ud83c\udf0f\ud83c\udf0e\ud83d\udc09\u2600\ud83d\udcbb\ud83d\udda5\ud83d\udcbe\ud83d\udcbf\ud83d\ude02\u2764\ud83d\ude0d\ud83e\udd23\ud83d\ude0a\ud83d\ude4f\ud83d\udc95\ud83d\ude2d\ud83d\ude18\ud83d\udc4d\ud83d\ude05\ud83d\udc4f\ud83d\ude01\ud83d\udd25\ud83e\udd70\ud83d\udc94\ud83d\udc96\ud83d\udc99\ud83d\ude22\ud83e\udd14\ud83d\ude06\ud83d\ude44\ud83d\udcaa\ud83d\ude09\u263a\ud83d\udc4c\ud83e\udd17\ud83d\udc9c\ud83d\ude14\ud83d\ude0e\ud83d\ude07\ud83c\udf39\ud83e\udd26\ud83c\udf89\ud83d\udc9e\u270c\u2728\ud83e\udd37\ud83d\ude31\ud83d\ude0c\ud83c\udf38\ud83d\ude4c\ud83d\ude0b\ud83d\udc97\ud83d\udc9a\ud83d\ude0f\ud83d\udc9b\ud83d\ude42\ud83d\udc93\ud83e\udd29\ud83d\ude04\ud83d\ude00\ud83d\udda4\ud83d\ude03\ud83d\udcaf\ud83d\ude48\ud83d\udc47\ud83c\udfb6\ud83d\ude12\ud83e\udd2d\u2763\ud83d\ude1c\ud83d\udc8b\ud83d\udc40\ud83d\ude2a\ud83d\ude11\ud83d\udca5\ud83d\ude4b\ud83d\ude1e\ud83d\ude29\ud83d\ude21\ud83e\udd2a\ud83d\udc4a\ud83e\udd73\ud83d\ude25\ud83e\udd24\ud83d\udc49\ud83d\udc83\ud83d\ude33\u270b\ud83d\ude1a\ud83d\ude1d\ud83d\ude34\ud83c\udf1f\ud83d\ude2c\ud83d\ude43\ud83c\udf40\ud83c\udf37\ud83d\ude3b\ud83d\ude13\u2b50\u2705\ud83e\udd7a\ud83c\udf08\ud83d\ude08\ud83e\udd18\ud83d\udca6\u2714\ud83d\ude23\ud83c\udfc3\ud83d\udc90\u2639\ud83c\udf8a\ud83d\udc98\ud83d\ude20\u261d\ud83d\ude15\ud83c\udf3a\ud83c\udf82\ud83c\udf3b\ud83d\ude10\ud83d\udd95\ud83d\udc9d\ud83d\ude4a\ud83d\ude39\ud83d\udde3\ud83d\udcab\ud83d\udc80\ud83d\udc51\ud83c\udfb5\ud83e\udd1e\ud83d\ude1b\ud83d\udd34\ud83d\ude24\ud83c\udf3c\ud83d\ude2b\u26bd\ud83e\udd19\u2615\ud83c\udfc6\ud83e\udd2b\ud83d\udc48\ud83d\ude2e\ud83d\ude46\ud83c\udf7b\ud83c\udf43\ud83d\udc36\ud83d\udc81\ud83d\ude32\ud83c\udf3f\ud83e\udde1\ud83c\udf81\u26a1\ud83c\udf1e\ud83c\udf88\u274c\u270a\ud83d\udc4b\ud83d\ude30\ud83e\udd28\ud83d\ude36\ud83e\udd1d\ud83d\udeb6\ud83d\udcb0\ud83c\udf53\ud83d\udca2\ud83e\udd1f\ud83d\ude41\ud83d\udea8\ud83d\udca8\ud83e\udd2c\u2708\ud83c\udf80\ud83c\udf7a\ud83e\udd13\ud83d\ude19\ud83d\udc9f\ud83c\udf31\ud83d\ude16\ud83d\udc76\ud83e\udd74\u25b6\u27a1\u2753\ud83d\udc8e\ud83d\udcb8\u2b07\ud83d\ude28\ud83c\udf1a\ud83e\udd8b\ud83d\ude37\ud83d\udd7a\u26a0\ud83d\ude45\ud83d\ude1f\ud83d\ude35\ud83d\udc4e\ud83e\udd32\ud83e\udd20\ud83e\udd27\ud83d\udccc\ud83d\udd35\ud83d\udc85\ud83e\uddd0\ud83d\udc3e\ud83c\udf52\ud83d\ude17\ud83e\udd11\ud83c\udf0a\ud83e\udd2f\ud83d\udc37\u260e\ud83d\udca7\ud83d\ude2f\ud83d\udc86\ud83d\udc46\ud83c\udfa4\ud83d\ude47\ud83c\udf51\u2744\ud83c\udf34\ud83d\udca3\ud83d\udc38\ud83d\udc8c\ud83d\udccd\ud83e\udd40\ud83e\udd22\ud83d\udc45\ud83d\udca1\ud83d\udca9\ud83d\udc50\ud83d\udcf8\ud83d\udc7b\ud83e\udd10\ud83e\udd2e\ud83c\udfbc\ud83e\udd75\ud83d\udea9\ud83c\udf4e\ud83c\udf4a\ud83d\udc7c\ud83d\udc8d\ud83d\udce3\ud83e\udd42"),E=w.reduce(((e,t,n)=>(e[n]=t,e)),[]),A=w.reduce(((e,t,n)=>(e[t.codePointAt(0)]=n,e)),[]);const S=(0,g.Dp)({prefix:"\ud83d\ude80",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=E[t]),"")},decode:function(e){const t=[];for(const n of e){const e=A[n.codePointAt(0)];if(void 0===e)throw new Error("Non-base256emoji character: ".concat(n));t.push(e)}return new Uint8Array(t)}});var _=n(3886);const I=(0,g.kU)({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),C=(0,g.kU)({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var T=n(55577);const k=(0,g.ET)({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),R=(0,g.ET)({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),x=(0,g.ET)({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),P=(0,g.ET)({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),D=(0,g.ET)({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var O=n(25671);const N=(0,g.Dp)({prefix:"\0",name:"identity",encode:e=>(0,O.BB)(e),decode:e=>(0,O.mL)(e)}),B=new TextEncoder,L=new TextDecoder,M="json",U=512;function F(e){return B.encode(JSON.stringify(e))}function K(e){return JSON.parse(L.decode(e))}const j="raw",Z=85;function z(e){return(0,O.oQ)(e)}function V(e){return(0,O.oQ)(e)}var H=n(71178);const q=O.oQ;const G={code:0,name:"identity",encode:q,digest:function(e){return H.Ue(0,q(e))}};var W=n(96156);function Q(e){let{name:t,code:n,encode:r}=e;return new Y(t,n,r)}class Y{constructor(e,t,n){(0,W.Z)(this,"name",void 0),(0,W.Z)(this,"code",void 0),(0,W.Z)(this,"encode",void 0),this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?H.Ue(this.code,t):t.then((e=>H.Ue(this.code,e)))}throw Error("Unknown type, must be binary type")}}function J(e){return async t=>new Uint8Array(await crypto.subtle.digest(e,t))}const X=Q({name:"sha2-256",code:18,encode:J("SHA-256")}),$=Q({name:"sha2-512",code:19,encode:J("SHA-512")});n(47652),n(97777);const ee={...u,...o,...l,...r,...i,..._,...a,...T,...c,...s}},25671:(e,t,n)=>{"use strict";n.d(t,{BB:()=>s,fS:()=>r,mL:()=>o,oQ:()=>i});new Uint8Array(0);function r(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0}function i(e){if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}function o(e){return(new TextEncoder).encode(e)}function s(e){return(new TextDecoder).decode(e)}},47652:(e,t,n)=>{"use strict";n.d(t,{k0:()=>d});var r=n(96156),i=n(3886),o=n(55577),s=n(25671),a=n(71178),c=n(97777);function l(e,t){const{bytes:n,version:r}=e;return 0===r?function(e,t,n){const{prefix:r}=n;if(r!==o.base58btc.prefix)throw Error("Cannot string encode V0 in ".concat(n.name," encoding"));const i=t.get(r);if(null==i){const i=n.encode(e).slice(1);return t.set(r,i),i}return i}(n,h(e),null!==t&&void 0!==t?t:o.base58btc.encoder):function(e,t,n){const{prefix:r}=n,i=t.get(r);if(null==i){const i=n.encode(e);return t.set(r,i),i}return i}(n,h(e),null!==t&&void 0!==t?t:i.base32.encoder)}const u=new WeakMap;function h(e){const t=u.get(e);if(null==t){const t=new Map;return u.set(e,t),t}return t}class d{constructor(e,t,n,i){(0,r.Z)(this,"code",void 0),(0,r.Z)(this,"version",void 0),(0,r.Z)(this,"multihash",void 0),(0,r.Z)(this,"bytes",void 0),(0,r.Z)(this,"/",void 0),(0,r.Z)(this,Symbol.toStringTag,"CID"),this.code=t,this.version=e,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==f)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==p)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return d.createV0(t)}default:throw Error("Can not convert CID version ".concat(this.version," to version 0. This is a bug please report"))}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=a.Ue(e,t);return d.createV1(this.code,n)}case 1:return this;default:throw Error("Can not convert CID version ".concat(this.version," to version 1. This is a bug please report"))}}equals(e){return d.equals(this,e)}static equals(e,t){const n=t;return null!=n&&e.code===n.code&&e.version===n.version&&a.fS(e.multihash,n.multihash)}toString(e){return l(this,e)}toJSON(){return{"/":l(this)}}link(){return this}[Symbol.for("nodejs.util.inspect.custom")](){return"CID(".concat(this.toString(),")")}static asCID(e){if(null==e)return null;const t=e;if(t instanceof d)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:n,multihash:r,bytes:i}=t;return new d(e,n,r,null!==i&&void 0!==i?i:g(e,n,r.bytes))}if(!0===t[y]){const{version:e,multihash:n,code:r}=t,i=a.Jx(n);return d.create(e,r,i)}return null}static create(e,t,n){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==f)throw new Error("Version 0 CID must use dag-pb (code: ".concat(f,") block encoding"));return new d(e,t,n,n.bytes);case 1:{const r=g(e,t,n.bytes);return new d(e,t,n,r)}default:throw new Error("Invalid version")}}static createV0(e){return d.create(0,f,e)}static createV1(e,t){return d.create(1,e,t)}static decode(e){const[t,n]=d.decodeFirst(e);if(0!==n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=d.inspectBytes(e),n=t.size-t.multihashSize,r=(0,s.oQ)(e.subarray(n,n+t.multihashSize));if(r.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=r.subarray(t.multihashSize-t.digestSize),o=new a.zZ(t.multihashCode,t.digestSize,i,r);return[0===t.version?d.createV0(o):d.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[n,r]=c.Jx(e.subarray(t));return t+=r,n};let r=n(),i=f;if(18===r?(r=0,t=0):i=n(),0!==r&&1!==r)throw new RangeError("Invalid CID version ".concat(r));const o=t,s=n(),a=n(),l=t+a;return{version:r,codec:i,multihashCode:s,digestSize:a,multihashSize:l-o,size:l}}static parse(e,t){const[n,r]=function(e,t){switch(e[0]){case"Q":{const n=null!==t&&void 0!==t?t:o.base58btc;return[o.base58btc.prefix,n.decode("".concat(o.base58btc.prefix).concat(e))]}case o.base58btc.prefix:{const n=null!==t&&void 0!==t?t:o.base58btc;return[o.base58btc.prefix,n.decode(e)]}case i.base32.prefix:{const n=null!==t&&void 0!==t?t:i.base32;return[i.base32.prefix,n.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}(e,t),s=d.decode(r);if(0===s.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return h(s).set(n,e),s}}const f=112,p=18;function g(e,t,n){const r=c.P$(e),i=r+c.P$(t),o=new Uint8Array(i+n.byteLength);return c.mL(e,o,0),c.mL(t,o,r),o.set(n,i),o}const y=Symbol.for("@ipld/js-cid/CID")},71178:(e,t,n)=>{"use strict";n.d(t,{Jx:()=>a,Ue:()=>s,fS:()=>c,zZ:()=>l});var r=n(96156),i=n(25671),o=n(97777);function s(e,t){const n=t.byteLength,r=o.P$(e),i=r+o.P$(n),s=new Uint8Array(i+n);return o.mL(e,s,0),o.mL(n,s,r),s.set(t,i),new l(e,n,t,s)}function a(e){const t=(0,i.oQ)(e),[n,r]=o.Jx(t),[s,a]=o.Jx(t.subarray(r)),c=t.subarray(r+a);if(c.byteLength!==s)throw new Error("Incorrect length");return new l(n,s,c,t)}function c(e,t){if(e===t)return!0;{const n=t;return e.code===n.code&&e.size===n.size&&n.bytes instanceof Uint8Array&&(0,i.fS)(e.bytes,n.bytes)}}class l{constructor(e,t,n,i){(0,r.Z)(this,"code",void 0),(0,r.Z)(this,"size",void 0),(0,r.Z)(this,"digest",void 0),(0,r.Z)(this,"bytes",void 0),this.code=e,this.size=t,this.digest=n,this.bytes=i}}},97777:(e,t,n)=>{"use strict";n.d(t,{Jx:()=>w,mL:()=>E,P$:()=>A});var r=function e(t,n,r){n=n||[];var a=r=r||0;for(;t>=s;)n[r++]=255&t|i,t/=128;for(;t&o;)n[r++]=255&t|i,t>>>=7;return n[r]=0|t,e.bytes=r-a+1,n},i=128,o=-128,s=Math.pow(2,31);var a=function e(t,n){var r,i=0,o=0,s=n=n||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");r=t[s++],i+=o<28?(r&l)<<o:(r&l)*Math.pow(2,o),o+=7}while(r>=c);return e.bytes=s-n,i},c=128,l=127;var u=Math.pow(2,7),h=Math.pow(2,14),d=Math.pow(2,21),f=Math.pow(2,28),p=Math.pow(2,35),g=Math.pow(2,42),y=Math.pow(2,49),m=Math.pow(2,56),v=Math.pow(2,63);const b={encode:r,decode:a,encodingLength:function(e){return e<u?1:e<h?2:e<d?3:e<f?4:e<p?5:e<g?6:e<y?7:e<m?8:e<v?9:10}};function w(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return[b.decode(e,t),b.decode.bytes]}function E(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return b.encode(e,t,n),t}function A(e){return b.encodingLength(e)}},2044:e=>{e.exports=function e(r,i){var o,s=0,a=0,c=i=i||0,l=r.length;do{if(c>=l)throw e.bytes=0,new RangeError("Could not decode varint");o=r[c++],s+=a<28?(o&n)<<a:(o&n)*Math.pow(2,a),a+=7}while(o>=t);return e.bytes=c-i,s};var t=128,n=127},36076:e=>{e.exports=function e(i,o,s){o=o||[];var a=s=s||0;for(;i>=r;)o[s++]=255&i|t,i/=128;for(;i&n;)o[s++]=255&i|t,i>>>=7;return o[s]=0|i,e.bytes=s-a+1,o};var t=128,n=-128,r=Math.pow(2,31)},36414:(e,t,n)=>{e.exports={encode:n(36076),decode:n(2044),encodingLength:n(5592)}},5592:e=>{var t=Math.pow(2,7),n=Math.pow(2,14),r=Math.pow(2,21),i=Math.pow(2,28),o=Math.pow(2,35),s=Math.pow(2,42),a=Math.pow(2,49),c=Math.pow(2,56),l=Math.pow(2,63);e.exports=function(e){return e<t?1:e<n?2:e<r?3:e<i?4:e<o?5:e<s?6:e<a?7:e<c?8:e<l?9:10}},58280:e=>{"use strict";const t=Object.freeze({identity:0,sha1:17,"sha2-256":18,"sha2-512":19,"sha3-512":20,"sha3-384":21,"sha3-256":22,"sha3-224":23,"shake-128":24,"shake-256":25,"keccak-224":26,"keccak-256":27,"keccak-384":28,"keccak-512":29,blake3:30,"murmur3-128":34,"murmur3-32":35,"dbl-sha2-256":86,md4:212,md5:213,bmt:214,"sha2-256-trunc254-padded":4114,"ripemd-128":4178,"ripemd-160":4179,"ripemd-256":4180,"ripemd-320":4181,x11:4352,kangarootwelve:7425,"sm3-256":21325,"blake2b-8":45569,"blake2b-16":45570,"blake2b-24":45571,"blake2b-32":45572,"blake2b-40":45573,"blake2b-48":45574,"blake2b-56":45575,"blake2b-64":45576,"blake2b-72":45577,"blake2b-80":45578,"blake2b-88":45579,"blake2b-96":45580,"blake2b-104":45581,"blake2b-112":45582,"blake2b-120":45583,"blake2b-128":45584,"blake2b-136":45585,"blake2b-144":45586,"blake2b-152":45587,"blake2b-160":45588,"blake2b-168":45589,"blake2b-176":45590,"blake2b-184":45591,"blake2b-192":45592,"blake2b-200":45593,"blake2b-208":45594,"blake2b-216":45595,"blake2b-224":45596,"blake2b-232":45597,"blake2b-240":45598,"blake2b-248":45599,"blake2b-256":45600,"blake2b-264":45601,"blake2b-272":45602,"blake2b-280":45603,"blake2b-288":45604,"blake2b-296":45605,"blake2b-304":45606,"blake2b-312":45607,"blake2b-320":45608,"blake2b-328":45609,"blake2b-336":45610,"blake2b-344":45611,"blake2b-352":45612,"blake2b-360":45613,"blake2b-368":45614,"blake2b-376":45615,"blake2b-384":45616,"blake2b-392":45617,"blake2b-400":45618,"blake2b-408":45619,"blake2b-416":45620,"blake2b-424":45621,"blake2b-432":45622,"blake2b-440":45623,"blake2b-448":45624,"blake2b-456":45625,"blake2b-464":45626,"blake2b-472":45627,"blake2b-480":45628,"blake2b-488":45629,"blake2b-496":45630,"blake2b-504":45631,"blake2b-512":45632,"blake2s-8":45633,"blake2s-16":45634,"blake2s-24":45635,"blake2s-32":45636,"blake2s-40":45637,"blake2s-48":45638,"blake2s-56":45639,"blake2s-64":45640,"blake2s-72":45641,"blake2s-80":45642,"blake2s-88":45643,"blake2s-96":45644,"blake2s-104":45645,"blake2s-112":45646,"blake2s-120":45647,"blake2s-128":45648,"blake2s-136":45649,"blake2s-144":45650,"blake2s-152":45651,"blake2s-160":45652,"blake2s-168":45653,"blake2s-176":45654,"blake2s-184":45655,"blake2s-192":45656,"blake2s-200":45657,"blake2s-208":45658,"blake2s-216":45659,"blake2s-224":45660,"blake2s-232":45661,"blake2s-240":45662,"blake2s-248":45663,"blake2s-256":45664,"skein256-8":45825,"skein256-16":45826,"skein256-24":45827,"skein256-32":45828,"skein256-40":45829,"skein256-48":45830,"skein256-56":45831,"skein256-64":45832,"skein256-72":45833,"skein256-80":45834,"skein256-88":45835,"skein256-96":45836,"skein256-104":45837,"skein256-112":45838,"skein256-120":45839,"skein256-128":45840,"skein256-136":45841,"skein256-144":45842,"skein256-152":45843,"skein256-160":45844,"skein256-168":45845,"skein256-176":45846,"skein256-184":45847,"skein256-192":45848,"skein256-200":45849,"skein256-208":45850,"skein256-216":45851,"skein256-224":45852,"skein256-232":45853,"skein256-240":45854,"skein256-248":45855,"skein256-256":45856,"skein512-8":45857,"skein512-16":45858,"skein512-24":45859,"skein512-32":45860,"skein512-40":45861,"skein512-48":45862,"skein512-56":45863,"skein512-64":45864,"skein512-72":45865,"skein512-80":45866,"skein512-88":45867,"skein512-96":45868,"skein512-104":45869,"skein512-112":45870,"skein512-120":45871,"skein512-128":45872,"skein512-136":45873,"skein512-144":45874,"skein512-152":45875,"skein512-160":45876,"skein512-168":45877,"skein512-176":45878,"skein512-184":45879,"skein512-192":45880,"skein512-200":45881,"skein512-208":45882,"skein512-216":45883,"skein512-224":45884,"skein512-232":45885,"skein512-240":45886,"skein512-248":45887,"skein512-256":45888,"skein512-264":45889,"skein512-272":45890,"skein512-280":45891,"skein512-288":45892,"skein512-296":45893,"skein512-304":45894,"skein512-312":45895,"skein512-320":45896,"skein512-328":45897,"skein512-336":45898,"skein512-344":45899,"skein512-352":45900,"skein512-360":45901,"skein512-368":45902,"skein512-376":45903,"skein512-384":45904,"skein512-392":45905,"skein512-400":45906,"skein512-408":45907,"skein512-416":45908,"skein512-424":45909,"skein512-432":45910,"skein512-440":45911,"skein512-448":45912,"skein512-456":45913,"skein512-464":45914,"skein512-472":45915,"skein512-480":45916,"skein512-488":45917,"skein512-496":45918,"skein512-504":45919,"skein512-512":45920,"skein1024-8":45921,"skein1024-16":45922,"skein1024-24":45923,"skein1024-32":45924,"skein1024-40":45925,"skein1024-48":45926,"skein1024-56":45927,"skein1024-64":45928,"skein1024-72":45929,"skein1024-80":45930,"skein1024-88":45931,"skein1024-96":45932,"skein1024-104":45933,"skein1024-112":45934,"skein1024-120":45935,"skein1024-128":45936,"skein1024-136":45937,"skein1024-144":45938,"skein1024-152":45939,"skein1024-160":45940,"skein1024-168":45941,"skein1024-176":45942,"skein1024-184":45943,"skein1024-192":45944,"skein1024-200":45945,"skein1024-208":45946,"skein1024-216":45947,"skein1024-224":45948,"skein1024-232":45949,"skein1024-240":45950,"skein1024-248":45951,"skein1024-256":45952,"skein1024-264":45953,"skein1024-272":45954,"skein1024-280":45955,"skein1024-288":45956,"skein1024-296":45957,"skein1024-304":45958,"skein1024-312":45959,"skein1024-320":45960,"skein1024-328":45961,"skein1024-336":45962,"skein1024-344":45963,"skein1024-352":45964,"skein1024-360":45965,"skein1024-368":45966,"skein1024-376":45967,"skein1024-384":45968,"skein1024-392":45969,"skein1024-400":45970,"skein1024-408":45971,"skein1024-416":45972,"skein1024-424":45973,"skein1024-432":45974,"skein1024-440":45975,"skein1024-448":45976,"skein1024-456":45977,"skein1024-464":45978,"skein1024-472":45979,"skein1024-480":45980,"skein1024-488":45981,"skein1024-496":45982,"skein1024-504":45983,"skein1024-512":45984,"skein1024-520":45985,"skein1024-528":45986,"skein1024-536":45987,"skein1024-544":45988,"skein1024-552":45989,"skein1024-560":45990,"skein1024-568":45991,"skein1024-576":45992,"skein1024-584":45993,"skein1024-592":45994,"skein1024-600":45995,"skein1024-608":45996,"skein1024-616":45997,"skein1024-624":45998,"skein1024-632":45999,"skein1024-640":46e3,"skein1024-648":46001,"skein1024-656":46002,"skein1024-664":46003,"skein1024-672":46004,"skein1024-680":46005,"skein1024-688":46006,"skein1024-696":46007,"skein1024-704":46008,"skein1024-712":46009,"skein1024-720":46010,"skein1024-728":46011,"skein1024-736":46012,"skein1024-744":46013,"skein1024-752":46014,"skein1024-760":46015,"skein1024-768":46016,"skein1024-776":46017,"skein1024-784":46018,"skein1024-792":46019,"skein1024-800":46020,"skein1024-808":46021,"skein1024-816":46022,"skein1024-824":46023,"skein1024-832":46024,"skein1024-840":46025,"skein1024-848":46026,"skein1024-856":46027,"skein1024-864":46028,"skein1024-872":46029,"skein1024-880":46030,"skein1024-888":46031,"skein1024-896":46032,"skein1024-904":46033,"skein1024-912":46034,"skein1024-920":46035,"skein1024-928":46036,"skein1024-936":46037,"skein1024-944":46038,"skein1024-952":46039,"skein1024-960":46040,"skein1024-968":46041,"skein1024-976":46042,"skein1024-984":46043,"skein1024-992":46044,"skein1024-1000":46045,"skein1024-1008":46046,"skein1024-1016":46047,"skein1024-1024":46048,"poseidon-bls12_381-a2-fc1":46081,"poseidon-bls12_381-a2-fc1-sc":46082});e.exports={names:t}},53765:(e,t,n)=>{"use strict";const r=n(80141),i=n(36414),{names:o}=n(58280),{toString:s}=n(88238),{fromString:a}=n(27271),{concat:c}=n(94450),l={};for(const g in o){const e=g;l[o[e]]=e}function u(e){if(!(e instanceof Uint8Array))throw new Error("multihash must be a Uint8Array");if(e.length<2)throw new Error("multihash too short. must be > 2 bytes.");const t=i.decode(e);if(!f(t))throw new Error("multihash unknown function code: 0x".concat(t.toString(16)));e=e.slice(i.decode.bytes);const n=i.decode(e);if(n<0)throw new Error("multihash invalid length: ".concat(n));if((e=e.slice(i.decode.bytes)).length!==n)throw new Error("multihash length inconsistent: 0x".concat(s(e,"base16")));return{code:t,name:l[t],length:n,digest:e}}function h(e){let t=e;if("string"===typeof e){if(void 0===o[e])throw new Error("Unrecognized hash function named: ".concat(e));t=o[e]}if("number"!==typeof t)throw new Error("Hash function code should be a number. Got: ".concat(t));if(void 0===l[t]&&!d(t))throw new Error("Unrecognized function code: ".concat(t));return t}function d(e){return e>0&&e<16}function f(e){return!!d(e)||!!l[e]}function p(e){u(e)}Object.freeze(l),e.exports={names:o,codes:l,toHexString:function(e){if(!(e instanceof Uint8Array))throw new Error("must be passed a Uint8Array");return s(e,"base16")},fromHexString:function(e){return a(e,"base16")},toB58String:function(e){if(!(e instanceof Uint8Array))throw new Error("must be passed a Uint8Array");return s(r.encode("base58btc",e)).slice(1)},fromB58String:function(e){const t=e instanceof Uint8Array?s(e):e;return r.decode("z"+t)},decode:u,encode:function(e,t,n){if(!e||void 0===t)throw new Error("multihash encode requires at least two args: digest, code");const r=h(t);if(!(e instanceof Uint8Array))throw new Error("digest should be a Uint8Array");if(null==n&&(n=e.length),n&&e.length!==n)throw new Error("digest length should be equal to specified length.");const o=i.encode(r),s=i.encode(n);return c([o,s,e],o.length+s.length+e.length)},coerceCode:h,isAppCode:d,validate:p,prefix:function(e){return p(e),e.subarray(0,2)},isValidCode:f}},27922:function(e,t){(function(){var e,n,r,i,o,s,a,c;c=function(e){return[(e&255<<24)>>>24,(e&255<<16)>>>16,(65280&e)>>>8,255&e].join(".")},a=function(e){var t,r,i,o,s,a;for(t=[],i=o=0;o<=3&&0!==e.length;i=++o){if(i>0){if("."!==e[0])throw new Error("Invalid IP");e=e.substring(1)}s=(a=n(e))[0],r=a[1],e=e.substring(r),t.push(s)}if(0!==e.length)throw new Error("Invalid IP");switch(t.length){case 1:if(t[0]>4294967295)throw new Error("Invalid IP");return t[0]>>>0;case 2:if(t[0]>255||t[1]>16777215)throw new Error("Invalid IP");return(t[0]<<24|t[1])>>>0;case 3:if(t[0]>255||t[1]>255||t[2]>65535)throw new Error("Invalid IP");return(t[0]<<24|t[1]<<16|t[2])>>>0;case 4:if(t[0]>255||t[1]>255||t[2]>255||t[3]>255)throw new Error("Invalid IP");return(t[0]<<24|t[1]<<16|t[2]<<8|t[3])>>>0;default:throw new Error("Invalid IP")}},i=(r=function(e){return e.charCodeAt(0)})("0"),s=r("a"),o=r("A"),n=function(e){var t,n,a,c,l;for(c=0,t=10,n="9",a=0,e.length>1&&"0"===e[a]&&("x"===e[a+1]||"X"===e[a+1]?(a+=2,t=16):"0"<=e[a+1]&&e[a+1]<="9"&&(a++,t=8,n="7")),l=a;a<e.length;){if("0"<=e[a]&&e[a]<=n)c=c*t+(r(e[a])-i)>>>0;else{if(16!==t)break;if("a"<=e[a]&&e[a]<="f")c=c*t+(10+r(e[a])-s)>>>0;else{if(!("A"<=e[a]&&e[a]<="F"))break;c=c*t+(10+r(e[a])-o)>>>0}}if(c>4294967295)throw new Error("too large");a++}if(a===l)throw new Error("empty octet");return[c,a]},e=function(){function e(e,t){var n,r,i;if("string"!==typeof e)throw new Error("Missing `net' parameter");if(t||(i=e.split("/",2),e=i[0],t=i[1]),t||(t=32),"string"===typeof t&&t.indexOf(".")>-1){try{this.maskLong=a(t)}catch(o){throw o,new Error("Invalid mask: "+t)}for(n=r=32;r>=0;n=--r)if(this.maskLong===4294967295<<32-n>>>0){this.bitmask=n;break}}else{if(!t&&0!==t)throw new Error("Invalid mask: empty");this.bitmask=parseInt(t,10),this.maskLong=0,this.bitmask>0&&(this.maskLong=4294967295<<32-this.bitmask>>>0)}try{this.netLong=(a(e)&this.maskLong)>>>0}catch(o){throw o,new Error("Invalid net address: "+e)}if(!(this.bitmask<=32))throw new Error("Invalid mask for ip4: "+t);this.size=Math.pow(2,32-this.bitmask),this.base=c(this.netLong),this.mask=c(this.maskLong),this.hostmask=c(~this.maskLong),this.first=this.bitmask<=30?c(this.netLong+1):this.base,this.last=this.bitmask<=30?c(this.netLong+this.size-2):c(this.netLong+this.size-1),this.broadcast=this.bitmask<=30?c(this.netLong+this.size-1):void 0}return e.prototype.contains=function(t){return"string"===typeof t&&(t.indexOf("/")>0||4!==t.split(".").length)&&(t=new e(t)),t instanceof e?this.contains(t.base)&&this.contains(t.broadcast||t.last):(a(t)&this.maskLong)>>>0===(this.netLong&this.maskLong)>>>0},e.prototype.next=function(t){return null==t&&(t=1),new e(c(this.netLong+this.size*t),this.mask)},e.prototype.forEach=function(e){var t,n,r;for(r=a(this.first),n=a(this.last),t=0;r<=n;)e(c(r),r,t),t++,r++},e.prototype.toString=function(){return this.base+"/"+this.bitmask},e}(),t.ip2long=a,t.long2ip=c,t.Netmask=e}).call(this)},17870:(e,t,n)=>{var r=n(60463),i=n(63358),o=n(91741),s=n(66437);e.exports=function(e,t,n){if(null==e)return"";return n="string"!==typeof n?" ":n,e=String(e).replace(o,"$1 $2").replace(s,"$1 $2").replace(i,(function(e,t,r){return 0===t||t===r.length-e.length?"":n})),r(e,t)}},91741:e=>{e.exports=/([a-z\xB5\xDF-\xF6\xF8-\xFF\u0101\u0103\u0105\u0107\u0109\u010B\u010D\u010F\u0111\u0113\u0115\u0117\u0119\u011B\u011D\u011F\u0121\u0123\u0125\u0127\u0129\u012B\u012D\u012F\u0131\u0133\u0135\u0137\u0138\u013A\u013C\u013E\u0140\u0142\u0144\u0146\u0148\u0149\u014B\u014D\u014F\u0151\u0153\u0155\u0157\u0159\u015B\u015D\u015F\u0161\u0163\u0165\u0167\u0169\u016B\u016D\u016F\u0171\u0173\u0175\u0177\u017A\u017C\u017E-\u0180\u0183\u0185\u0188\u018C\u018D\u0192\u0195\u0199-\u019B\u019E\u01A1\u01A3\u01A5\u01A8\u01AA\u01AB\u01AD\u01B0\u01B4\u01B6\u01B9\u01BA\u01BD-\u01BF\u01C6\u01C9\u01CC\u01CE\u01D0\u01D2\u01D4\u01D6\u01D8\u01DA\u01DC\u01DD\u01DF\u01E1\u01E3\u01E5\u01E7\u01E9\u01EB\u01ED\u01EF\u01F0\u01F3\u01F5\u01F9\u01FB\u01FD\u01FF\u0201\u0203\u0205\u0207\u0209\u020B\u020D\u020F\u0211\u0213\u0215\u0217\u0219\u021B\u021D\u021F\u0221\u0223\u0225\u0227\u0229\u022B\u022D\u022F\u0231\u0233-\u0239\u023C\u023F\u0240\u0242\u0247\u0249\u024B\u024D\u024F-\u0293\u0295-\u02AF\u0371\u0373\u0377\u037B-\u037D\u0390\u03AC-\u03CE\u03D0\u03D1\u03D5-\u03D7\u03D9\u03DB\u03DD\u03DF\u03E1\u03E3\u03E5\u03E7\u03E9\u03EB\u03ED\u03EF-\u03F3\u03F5\u03F8\u03FB\u03FC\u0430-\u045F\u0461\u0463\u0465\u0467\u0469\u046B\u046D\u046F\u0471\u0473\u0475\u0477\u0479\u047B\u047D\u047F\u0481\u048B\u048D\u048F\u0491\u0493\u0495\u0497\u0499\u049B\u049D\u049F\u04A1\u04A3\u04A5\u04A7\u04A9\u04AB\u04AD\u04AF\u04B1\u04B3\u04B5\u04B7\u04B9\u04BB\u04BD\u04BF\u04C2\u04C4\u04C6\u04C8\u04CA\u04CC\u04CE\u04CF\u04D1\u04D3\u04D5\u04D7\u04D9\u04DB\u04DD\u04DF\u04E1\u04E3\u04E5\u04E7\u04E9\u04EB\u04ED\u04EF\u04F1\u04F3\u04F5\u04F7\u04F9\u04FB\u04FD\u04FF\u0501\u0503\u0505\u0507\u0509\u050B\u050D\u050F\u0511\u0513\u0515\u0517\u0519\u051B\u051D\u051F\u0521\u0523\u0525\u0527\u0529\u052B\u052D\u052F\u0561-\u0587\u13F8-\u13FD\u1D00-\u1D2B\u1D6B-\u1D77\u1D79-\u1D9A\u1E01\u1E03\u1E05\u1E07\u1E09\u1E0B\u1E0D\u1E0F\u1E11\u1E13\u1E15\u1E17\u1E19\u1E1B\u1E1D\u1E1F\u1E21\u1E23\u1E25\u1E27\u1E29\u1E2B\u1E2D\u1E2F\u1E31\u1E33\u1E35\u1E37\u1E39\u1E3B\u1E3D\u1E3F\u1E41\u1E43\u1E45\u1E47\u1E49\u1E4B\u1E4D\u1E4F\u1E51\u1E53\u1E55\u1E57\u1E59\u1E5B\u1E5D\u1E5F\u1E61\u1E63\u1E65\u1E67\u1E69\u1E6B\u1E6D\u1E6F\u1E71\u1E73\u1E75\u1E77\u1E79\u1E7B\u1E7D\u1E7F\u1E81\u1E83\u1E85\u1E87\u1E89\u1E8B\u1E8D\u1E8F\u1E91\u1E93\u1E95-\u1E9D\u1E9F\u1EA1\u1EA3\u1EA5\u1EA7\u1EA9\u1EAB\u1EAD\u1EAF\u1EB1\u1EB3\u1EB5\u1EB7\u1EB9\u1EBB\u1EBD\u1EBF\u1EC1\u1EC3\u1EC5\u1EC7\u1EC9\u1ECB\u1ECD\u1ECF\u1ED1\u1ED3\u1ED5\u1ED7\u1ED9\u1EDB\u1EDD\u1EDF\u1EE1\u1EE3\u1EE5\u1EE7\u1EE9\u1EEB\u1EED\u1EEF\u1EF1\u1EF3\u1EF5\u1EF7\u1EF9\u1EFB\u1EFD\u1EFF-\u1F07\u1F10-\u1F15\u1F20-\u1F27\u1F30-\u1F37\u1F40-\u1F45\u1F50-\u1F57\u1F60-\u1F67\u1F70-\u1F7D\u1F80-\u1F87\u1F90-\u1F97\u1FA0-\u1FA7\u1FB0-\u1FB4\u1FB6\u1FB7\u1FBE\u1FC2-\u1FC4\u1FC6\u1FC7\u1FD0-\u1FD3\u1FD6\u1FD7\u1FE0-\u1FE7\u1FF2-\u1FF4\u1FF6\u1FF7\u210A\u210E\u210F\u2113\u212F\u2134\u2139\u213C\u213D\u2146-\u2149\u214E\u2184\u2C30-\u2C5E\u2C61\u2C65\u2C66\u2C68\u2C6A\u2C6C\u2C71\u2C73\u2C74\u2C76-\u2C7B\u2C81\u2C83\u2C85\u2C87\u2C89\u2C8B\u2C8D\u2C8F\u2C91\u2C93\u2C95\u2C97\u2C99\u2C9B\u2C9D\u2C9F\u2CA1\u2CA3\u2CA5\u2CA7\u2CA9\u2CAB\u2CAD\u2CAF\u2CB1\u2CB3\u2CB5\u2CB7\u2CB9\u2CBB\u2CBD\u2CBF\u2CC1\u2CC3\u2CC5\u2CC7\u2CC9\u2CCB\u2CCD\u2CCF\u2CD1\u2CD3\u2CD5\u2CD7\u2CD9\u2CDB\u2CDD\u2CDF\u2CE1\u2CE3\u2CE4\u2CEC\u2CEE\u2CF3\u2D00-\u2D25\u2D27\u2D2D\uA641\uA643\uA645\uA647\uA649\uA64B\uA64D\uA64F\uA651\uA653\uA655\uA657\uA659\uA65B\uA65D\uA65F\uA661\uA663\uA665\uA667\uA669\uA66B\uA66D\uA681\uA683\uA685\uA687\uA689\uA68B\uA68D\uA68F\uA691\uA693\uA695\uA697\uA699\uA69B\uA723\uA725\uA727\uA729\uA72B\uA72D\uA72F-\uA731\uA733\uA735\uA737\uA739\uA73B\uA73D\uA73F\uA741\uA743\uA745\uA747\uA749\uA74B\uA74D\uA74F\uA751\uA753\uA755\uA757\uA759\uA75B\uA75D\uA75F\uA761\uA763\uA765\uA767\uA769\uA76B\uA76D\uA76F\uA771-\uA778\uA77A\uA77C\uA77F\uA781\uA783\uA785\uA787\uA78C\uA78E\uA791\uA793-\uA795\uA797\uA799\uA79B\uA79D\uA79F\uA7A1\uA7A3\uA7A5\uA7A7\uA7A9\uA7B5\uA7B7\uA7FA\uAB30-\uAB5A\uAB60-\uAB65\uAB70-\uABBF\uFB00-\uFB06\uFB13-\uFB17\uFF41-\uFF5A0-9\xB2\xB3\xB9\xBC-\xBE\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u09F4-\u09F9\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0B72-\u0B77\u0BE6-\u0BF2\u0C66-\u0C6F\u0C78-\u0C7E\u0CE6-\u0CEF\u0D66-\u0D75\u0DE6-\u0DEF\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F33\u1040-\u1049\u1090-\u1099\u1369-\u137C\u16EE-\u16F0\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1946-\u194F\u19D0-\u19DA\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\u2070\u2074-\u2079\u2080-\u2089\u2150-\u2182\u2185-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2CFD\u3007\u3021-\u3029\u3038-\u303A\u3192-\u3195\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\uA620-\uA629\uA6E6-\uA6EF\uA830-\uA835\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uA9F0-\uA9F9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19])([A-Z\xC0-\xD6\xD8-\xDE\u0100\u0102\u0104\u0106\u0108\u010A\u010C\u010E\u0110\u0112\u0114\u0116\u0118\u011A\u011C\u011E\u0120\u0122\u0124\u0126\u0128\u012A\u012C\u012E\u0130\u0132\u0134\u0136\u0139\u013B\u013D\u013F\u0141\u0143\u0145\u0147\u014A\u014C\u014E\u0150\u0152\u0154\u0156\u0158\u015A\u015C\u015E\u0160\u0162\u0164\u0166\u0168\u016A\u016C\u016E\u0170\u0172\u0174\u0176\u0178\u0179\u017B\u017D\u0181\u0182\u0184\u0186\u0187\u0189-\u018B\u018E-\u0191\u0193\u0194\u0196-\u0198\u019C\u019D\u019F\u01A0\u01A2\u01A4\u01A6\u01A7\u01A9\u01AC\u01AE\u01AF\u01B1-\u01B3\u01B5\u01B7\u01B8\u01BC\u01C4\u01C7\u01CA\u01CD\u01CF\u01D1\u01D3\u01D5\u01D7\u01D9\u01DB\u01DE\u01E0\u01E2\u01E4\u01E6\u01E8\u01EA\u01EC\u01EE\u01F1\u01F4\u01F6-\u01F8\u01FA\u01FC\u01FE\u0200\u0202\u0204\u0206\u0208\u020A\u020C\u020E\u0210\u0212\u0214\u0216\u0218\u021A\u021C\u021E\u0220\u0222\u0224\u0226\u0228\u022A\u022C\u022E\u0230\u0232\u023A\u023B\u023D\u023E\u0241\u0243-\u0246\u0248\u024A\u024C\u024E\u0370\u0372\u0376\u037F\u0386\u0388-\u038A\u038C\u038E\u038F\u0391-\u03A1\u03A3-\u03AB\u03CF\u03D2-\u03D4\u03D8\u03DA\u03DC\u03DE\u03E0\u03E2\u03E4\u03E6\u03E8\u03EA\u03EC\u03EE\u03F4\u03F7\u03F9\u03FA\u03FD-\u042F\u0460\u0462\u0464\u0466\u0468\u046A\u046C\u046E\u0470\u0472\u0474\u0476\u0478\u047A\u047C\u047E\u0480\u048A\u048C\u048E\u0490\u0492\u0494\u0496\u0498\u049A\u049C\u049E\u04A0\u04A2\u04A4\u04A6\u04A8\u04AA\u04AC\u04AE\u04B0\u04B2\u04B4\u04B6\u04B8\u04BA\u04BC\u04BE\u04C0\u04C1\u04C3\u04C5\u04C7\u04C9\u04CB\u04CD\u04D0\u04D2\u04D4\u04D6\u04D8\u04DA\u04DC\u04DE\u04E0\u04E2\u04E4\u04E6\u04E8\u04EA\u04EC\u04EE\u04F0\u04F2\u04F4\u04F6\u04F8\u04FA\u04FC\u04FE\u0500\u0502\u0504\u0506\u0508\u050A\u050C\u050E\u0510\u0512\u0514\u0516\u0518\u051A\u051C\u051E\u0520\u0522\u0524\u0526\u0528\u052A\u052C\u052E\u0531-\u0556\u10A0-\u10C5\u10C7\u10CD\u13A0-\u13F5\u1E00\u1E02\u1E04\u1E06\u1E08\u1E0A\u1E0C\u1E0E\u1E10\u1E12\u1E14\u1E16\u1E18\u1E1A\u1E1C\u1E1E\u1E20\u1E22\u1E24\u1E26\u1E28\u1E2A\u1E2C\u1E2E\u1E30\u1E32\u1E34\u1E36\u1E38\u1E3A\u1E3C\u1E3E\u1E40\u1E42\u1E44\u1E46\u1E48\u1E4A\u1E4C\u1E4E\u1E50\u1E52\u1E54\u1E56\u1E58\u1E5A\u1E5C\u1E5E\u1E60\u1E62\u1E64\u1E66\u1E68\u1E6A\u1E6C\u1E6E\u1E70\u1E72\u1E74\u1E76\u1E78\u1E7A\u1E7C\u1E7E\u1E80\u1E82\u1E84\u1E86\u1E88\u1E8A\u1E8C\u1E8E\u1E90\u1E92\u1E94\u1E9E\u1EA0\u1EA2\u1EA4\u1EA6\u1EA8\u1EAA\u1EAC\u1EAE\u1EB0\u1EB2\u1EB4\u1EB6\u1EB8\u1EBA\u1EBC\u1EBE\u1EC0\u1EC2\u1EC4\u1EC6\u1EC8\u1ECA\u1ECC\u1ECE\u1ED0\u1ED2\u1ED4\u1ED6\u1ED8\u1EDA\u1EDC\u1EDE\u1EE0\u1EE2\u1EE4\u1EE6\u1EE8\u1EEA\u1EEC\u1EEE\u1EF0\u1EF2\u1EF4\u1EF6\u1EF8\u1EFA\u1EFC\u1EFE\u1F08-\u1F0F\u1F18-\u1F1D\u1F28-\u1F2F\u1F38-\u1F3F\u1F48-\u1F4D\u1F59\u1F5B\u1F5D\u1F5F\u1F68-\u1F6F\u1FB8-\u1FBB\u1FC8-\u1FCB\u1FD8-\u1FDB\u1FE8-\u1FEC\u1FF8-\u1FFB\u2102\u2107\u210B-\u210D\u2110-\u2112\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u2130-\u2133\u213E\u213F\u2145\u2183\u2C00-\u2C2E\u2C60\u2C62-\u2C64\u2C67\u2C69\u2C6B\u2C6D-\u2C70\u2C72\u2C75\u2C7E-\u2C80\u2C82\u2C84\u2C86\u2C88\u2C8A\u2C8C\u2C8E\u2C90\u2C92\u2C94\u2C96\u2C98\u2C9A\u2C9C\u2C9E\u2CA0\u2CA2\u2CA4\u2CA6\u2CA8\u2CAA\u2CAC\u2CAE\u2CB0\u2CB2\u2CB4\u2CB6\u2CB8\u2CBA\u2CBC\u2CBE\u2CC0\u2CC2\u2CC4\u2CC6\u2CC8\u2CCA\u2CCC\u2CCE\u2CD0\u2CD2\u2CD4\u2CD6\u2CD8\u2CDA\u2CDC\u2CDE\u2CE0\u2CE2\u2CEB\u2CED\u2CF2\uA640\uA642\uA644\uA646\uA648\uA64A\uA64C\uA64E\uA650\uA652\uA654\uA656\uA658\uA65A\uA65C\uA65E\uA660\uA662\uA664\uA666\uA668\uA66A\uA66C\uA680\uA682\uA684\uA686\uA688\uA68A\uA68C\uA68E\uA690\uA692\uA694\uA696\uA698\uA69A\uA722\uA724\uA726\uA728\uA72A\uA72C\uA72E\uA732\uA734\uA736\uA738\uA73A\uA73C\uA73E\uA740\uA742\uA744\uA746\uA748\uA74A\uA74C\uA74E\uA750\uA752\uA754\uA756\uA758\uA75A\uA75C\uA75E\uA760\uA762\uA764\uA766\uA768\uA76A\uA76C\uA76E\uA779\uA77B\uA77D\uA77E\uA780\uA782\uA784\uA786\uA78B\uA78D\uA790\uA792\uA796\uA798\uA79A\uA79C\uA79E\uA7A0\uA7A2\uA7A4\uA7A6\uA7A8\uA7AA-\uA7AD\uA7B0-\uA7B4\uA7B6\uFF21-\uFF3A])/g},66437:e=>{e.exports=/([A-Z\xC0-\xD6\xD8-\xDE\u0100\u0102\u0104\u0106\u0108\u010A\u010C\u010E\u0110\u0112\u0114\u0116\u0118\u011A\u011C\u011E\u0120\u0122\u0124\u0126\u0128\u012A\u012C\u012E\u0130\u0132\u0134\u0136\u0139\u013B\u013D\u013F\u0141\u0143\u0145\u0147\u014A\u014C\u014E\u0150\u0152\u0154\u0156\u0158\u015A\u015C\u015E\u0160\u0162\u0164\u0166\u0168\u016A\u016C\u016E\u0170\u0172\u0174\u0176\u0178\u0179\u017B\u017D\u0181\u0182\u0184\u0186\u0187\u0189-\u018B\u018E-\u0191\u0193\u0194\u0196-\u0198\u019C\u019D\u019F\u01A0\u01A2\u01A4\u01A6\u01A7\u01A9\u01AC\u01AE\u01AF\u01B1-\u01B3\u01B5\u01B7\u01B8\u01BC\u01C4\u01C7\u01CA\u01CD\u01CF\u01D1\u01D3\u01D5\u01D7\u01D9\u01DB\u01DE\u01E0\u01E2\u01E4\u01E6\u01E8\u01EA\u01EC\u01EE\u01F1\u01F4\u01F6-\u01F8\u01FA\u01FC\u01FE\u0200\u0202\u0204\u0206\u0208\u020A\u020C\u020E\u0210\u0212\u0214\u0216\u0218\u021A\u021C\u021E\u0220\u0222\u0224\u0226\u0228\u022A\u022C\u022E\u0230\u0232\u023A\u023B\u023D\u023E\u0241\u0243-\u0246\u0248\u024A\u024C\u024E\u0370\u0372\u0376\u037F\u0386\u0388-\u038A\u038C\u038E\u038F\u0391-\u03A1\u03A3-\u03AB\u03CF\u03D2-\u03D4\u03D8\u03DA\u03DC\u03DE\u03E0\u03E2\u03E4\u03E6\u03E8\u03EA\u03EC\u03EE\u03F4\u03F7\u03F9\u03FA\u03FD-\u042F\u0460\u0462\u0464\u0466\u0468\u046A\u046C\u046E\u0470\u0472\u0474\u0476\u0478\u047A\u047C\u047E\u0480\u048A\u048C\u048E\u0490\u0492\u0494\u0496\u0498\u049A\u049C\u049E\u04A0\u04A2\u04A4\u04A6\u04A8\u04AA\u04AC\u04AE\u04B0\u04B2\u04B4\u04B6\u04B8\u04BA\u04BC\u04BE\u04C0\u04C1\u04C3\u04C5\u04C7\u04C9\u04CB\u04CD\u04D0\u04D2\u04D4\u04D6\u04D8\u04DA\u04DC\u04DE\u04E0\u04E2\u04E4\u04E6\u04E8\u04EA\u04EC\u04EE\u04F0\u04F2\u04F4\u04F6\u04F8\u04FA\u04FC\u04FE\u0500\u0502\u0504\u0506\u0508\u050A\u050C\u050E\u0510\u0512\u0514\u0516\u0518\u051A\u051C\u051E\u0520\u0522\u0524\u0526\u0528\u052A\u052C\u052E\u0531-\u0556\u10A0-\u10C5\u10C7\u10CD\u13A0-\u13F5\u1E00\u1E02\u1E04\u1E06\u1E08\u1E0A\u1E0C\u1E0E\u1E10\u1E12\u1E14\u1E16\u1E18\u1E1A\u1E1C\u1E1E\u1E20\u1E22\u1E24\u1E26\u1E28\u1E2A\u1E2C\u1E2E\u1E30\u1E32\u1E34\u1E36\u1E38\u1E3A\u1E3C\u1E3E\u1E40\u1E42\u1E44\u1E46\u1E48\u1E4A\u1E4C\u1E4E\u1E50\u1E52\u1E54\u1E56\u1E58\u1E5A\u1E5C\u1E5E\u1E60\u1E62\u1E64\u1E66\u1E68\u1E6A\u1E6C\u1E6E\u1E70\u1E72\u1E74\u1E76\u1E78\u1E7A\u1E7C\u1E7E\u1E80\u1E82\u1E84\u1E86\u1E88\u1E8A\u1E8C\u1E8E\u1E90\u1E92\u1E94\u1E9E\u1EA0\u1EA2\u1EA4\u1EA6\u1EA8\u1EAA\u1EAC\u1EAE\u1EB0\u1EB2\u1EB4\u1EB6\u1EB8\u1EBA\u1EBC\u1EBE\u1EC0\u1EC2\u1EC4\u1EC6\u1EC8\u1ECA\u1ECC\u1ECE\u1ED0\u1ED2\u1ED4\u1ED6\u1ED8\u1EDA\u1EDC\u1EDE\u1EE0\u1EE2\u1EE4\u1EE6\u1EE8\u1EEA\u1EEC\u1EEE\u1EF0\u1EF2\u1EF4\u1EF6\u1EF8\u1EFA\u1EFC\u1EFE\u1F08-\u1F0F\u1F18-\u1F1D\u1F28-\u1F2F\u1F38-\u1F3F\u1F48-\u1F4D\u1F59\u1F5B\u1F5D\u1F5F\u1F68-\u1F6F\u1FB8-\u1FBB\u1FC8-\u1FCB\u1FD8-\u1FDB\u1FE8-\u1FEC\u1FF8-\u1FFB\u2102\u2107\u210B-\u210D\u2110-\u2112\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u2130-\u2133\u213E\u213F\u2145\u2183\u2C00-\u2C2E\u2C60\u2C62-\u2C64\u2C67\u2C69\u2C6B\u2C6D-\u2C70\u2C72\u2C75\u2C7E-\u2C80\u2C82\u2C84\u2C86\u2C88\u2C8A\u2C8C\u2C8E\u2C90\u2C92\u2C94\u2C96\u2C98\u2C9A\u2C9C\u2C9E\u2CA0\u2CA2\u2CA4\u2CA6\u2CA8\u2CAA\u2CAC\u2CAE\u2CB0\u2CB2\u2CB4\u2CB6\u2CB8\u2CBA\u2CBC\u2CBE\u2CC0\u2CC2\u2CC4\u2CC6\u2CC8\u2CCA\u2CCC\u2CCE\u2CD0\u2CD2\u2CD4\u2CD6\u2CD8\u2CDA\u2CDC\u2CDE\u2CE0\u2CE2\u2CEB\u2CED\u2CF2\uA640\uA642\uA644\uA646\uA648\uA64A\uA64C\uA64E\uA650\uA652\uA654\uA656\uA658\uA65A\uA65C\uA65E\uA660\uA662\uA664\uA666\uA668\uA66A\uA66C\uA680\uA682\uA684\uA686\uA688\uA68A\uA68C\uA68E\uA690\uA692\uA694\uA696\uA698\uA69A\uA722\uA724\uA726\uA728\uA72A\uA72C\uA72E\uA732\uA734\uA736\uA738\uA73A\uA73C\uA73E\uA740\uA742\uA744\uA746\uA748\uA74A\uA74C\uA74E\uA750\uA752\uA754\uA756\uA758\uA75A\uA75C\uA75E\uA760\uA762\uA764\uA766\uA768\uA76A\uA76C\uA76E\uA779\uA77B\uA77D\uA77E\uA780\uA782\uA784\uA786\uA78B\uA78D\uA790\uA792\uA796\uA798\uA79A\uA79C\uA79E\uA7A0\uA7A2\uA7A4\uA7A6\uA7A8\uA7AA-\uA7AD\uA7B0-\uA7B4\uA7B6\uFF21-\uFF3A])([A-Z\xC0-\xD6\xD8-\xDE\u0100\u0102\u0104\u0106\u0108\u010A\u010C\u010E\u0110\u0112\u0114\u0116\u0118\u011A\u011C\u011E\u0120\u0122\u0124\u0126\u0128\u012A\u012C\u012E\u0130\u0132\u0134\u0136\u0139\u013B\u013D\u013F\u0141\u0143\u0145\u0147\u014A\u014C\u014E\u0150\u0152\u0154\u0156\u0158\u015A\u015C\u015E\u0160\u0162\u0164\u0166\u0168\u016A\u016C\u016E\u0170\u0172\u0174\u0176\u0178\u0179\u017B\u017D\u0181\u0182\u0184\u0186\u0187\u0189-\u018B\u018E-\u0191\u0193\u0194\u0196-\u0198\u019C\u019D\u019F\u01A0\u01A2\u01A4\u01A6\u01A7\u01A9\u01AC\u01AE\u01AF\u01B1-\u01B3\u01B5\u01B7\u01B8\u01BC\u01C4\u01C7\u01CA\u01CD\u01CF\u01D1\u01D3\u01D5\u01D7\u01D9\u01DB\u01DE\u01E0\u01E2\u01E4\u01E6\u01E8\u01EA\u01EC\u01EE\u01F1\u01F4\u01F6-\u01F8\u01FA\u01FC\u01FE\u0200\u0202\u0204\u0206\u0208\u020A\u020C\u020E\u0210\u0212\u0214\u0216\u0218\u021A\u021C\u021E\u0220\u0222\u0224\u0226\u0228\u022A\u022C\u022E\u0230\u0232\u023A\u023B\u023D\u023E\u0241\u0243-\u0246\u0248\u024A\u024C\u024E\u0370\u0372\u0376\u037F\u0386\u0388-\u038A\u038C\u038E\u038F\u0391-\u03A1\u03A3-\u03AB\u03CF\u03D2-\u03D4\u03D8\u03DA\u03DC\u03DE\u03E0\u03E2\u03E4\u03E6\u03E8\u03EA\u03EC\u03EE\u03F4\u03F7\u03F9\u03FA\u03FD-\u042F\u0460\u0462\u0464\u0466\u0468\u046A\u046C\u046E\u0470\u0472\u0474\u0476\u0478\u047A\u047C\u047E\u0480\u048A\u048C\u048E\u0490\u0492\u0494\u0496\u0498\u049A\u049C\u049E\u04A0\u04A2\u04A4\u04A6\u04A8\u04AA\u04AC\u04AE\u04B0\u04B2\u04B4\u04B6\u04B8\u04BA\u04BC\u04BE\u04C0\u04C1\u04C3\u04C5\u04C7\u04C9\u04CB\u04CD\u04D0\u04D2\u04D4\u04D6\u04D8\u04DA\u04DC\u04DE\u04E0\u04E2\u04E4\u04E6\u04E8\u04EA\u04EC\u04EE\u04F0\u04F2\u04F4\u04F6\u04F8\u04FA\u04FC\u04FE\u0500\u0502\u0504\u0506\u0508\u050A\u050C\u050E\u0510\u0512\u0514\u0516\u0518\u051A\u051C\u051E\u0520\u0522\u0524\u0526\u0528\u052A\u052C\u052E\u0531-\u0556\u10A0-\u10C5\u10C7\u10CD\u13A0-\u13F5\u1E00\u1E02\u1E04\u1E06\u1E08\u1E0A\u1E0C\u1E0E\u1E10\u1E12\u1E14\u1E16\u1E18\u1E1A\u1E1C\u1E1E\u1E20\u1E22\u1E24\u1E26\u1E28\u1E2A\u1E2C\u1E2E\u1E30\u1E32\u1E34\u1E36\u1E38\u1E3A\u1E3C\u1E3E\u1E40\u1E42\u1E44\u1E46\u1E48\u1E4A\u1E4C\u1E4E\u1E50\u1E52\u1E54\u1E56\u1E58\u1E5A\u1E5C\u1E5E\u1E60\u1E62\u1E64\u1E66\u1E68\u1E6A\u1E6C\u1E6E\u1E70\u1E72\u1E74\u1E76\u1E78\u1E7A\u1E7C\u1E7E\u1E80\u1E82\u1E84\u1E86\u1E88\u1E8A\u1E8C\u1E8E\u1E90\u1E92\u1E94\u1E9E\u1EA0\u1EA2\u1EA4\u1EA6\u1EA8\u1EAA\u1EAC\u1EAE\u1EB0\u1EB2\u1EB4\u1EB6\u1EB8\u1EBA\u1EBC\u1EBE\u1EC0\u1EC2\u1EC4\u1EC6\u1EC8\u1ECA\u1ECC\u1ECE\u1ED0\u1ED2\u1ED4\u1ED6\u1ED8\u1EDA\u1EDC\u1EDE\u1EE0\u1EE2\u1EE4\u1EE6\u1EE8\u1EEA\u1EEC\u1EEE\u1EF0\u1EF2\u1EF4\u1EF6\u1EF8\u1EFA\u1EFC\u1EFE\u1F08-\u1F0F\u1F18-\u1F1D\u1F28-\u1F2F\u1F38-\u1F3F\u1F48-\u1F4D\u1F59\u1F5B\u1F5D\u1F5F\u1F68-\u1F6F\u1FB8-\u1FBB\u1FC8-\u1FCB\u1FD8-\u1FDB\u1FE8-\u1FEC\u1FF8-\u1FFB\u2102\u2107\u210B-\u210D\u2110-\u2112\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u2130-\u2133\u213E\u213F\u2145\u2183\u2C00-\u2C2E\u2C60\u2C62-\u2C64\u2C67\u2C69\u2C6B\u2C6D-\u2C70\u2C72\u2C75\u2C7E-\u2C80\u2C82\u2C84\u2C86\u2C88\u2C8A\u2C8C\u2C8E\u2C90\u2C92\u2C94\u2C96\u2C98\u2C9A\u2C9C\u2C9E\u2CA0\u2CA2\u2CA4\u2CA6\u2CA8\u2CAA\u2CAC\u2CAE\u2CB0\u2CB2\u2CB4\u2CB6\u2CB8\u2CBA\u2CBC\u2CBE\u2CC0\u2CC2\u2CC4\u2CC6\u2CC8\u2CCA\u2CCC\u2CCE\u2CD0\u2CD2\u2CD4\u2CD6\u2CD8\u2CDA\u2CDC\u2CDE\u2CE0\u2CE2\u2CEB\u2CED\u2CF2\uA640\uA642\uA644\uA646\uA648\uA64A\uA64C\uA64E\uA650\uA652\uA654\uA656\uA658\uA65A\uA65C\uA65E\uA660\uA662\uA664\uA666\uA668\uA66A\uA66C\uA680\uA682\uA684\uA686\uA688\uA68A\uA68C\uA68E\uA690\uA692\uA694\uA696\uA698\uA69A\uA722\uA724\uA726\uA728\uA72A\uA72C\uA72E\uA732\uA734\uA736\uA738\uA73A\uA73C\uA73E\uA740\uA742\uA744\uA746\uA748\uA74A\uA74C\uA74E\uA750\uA752\uA754\uA756\uA758\uA75A\uA75C\uA75E\uA760\uA762\uA764\uA766\uA768\uA76A\uA76C\uA76E\uA779\uA77B\uA77D\uA77E\uA780\uA782\uA784\uA786\uA78B\uA78D\uA790\uA792\uA796\uA798\uA79A\uA79C\uA79E\uA7A0\uA7A2\uA7A4\uA7A6\uA7A8\uA7AA-\uA7AD\uA7B0-\uA7B4\uA7B6\uFF21-\uFF3A][a-z\xB5\xDF-\xF6\xF8-\xFF\u0101\u0103\u0105\u0107\u0109\u010B\u010D\u010F\u0111\u0113\u0115\u0117\u0119\u011B\u011D\u011F\u0121\u0123\u0125\u0127\u0129\u012B\u012D\u012F\u0131\u0133\u0135\u0137\u0138\u013A\u013C\u013E\u0140\u0142\u0144\u0146\u0148\u0149\u014B\u014D\u014F\u0151\u0153\u0155\u0157\u0159\u015B\u015D\u015F\u0161\u0163\u0165\u0167\u0169\u016B\u016D\u016F\u0171\u0173\u0175\u0177\u017A\u017C\u017E-\u0180\u0183\u0185\u0188\u018C\u018D\u0192\u0195\u0199-\u019B\u019E\u01A1\u01A3\u01A5\u01A8\u01AA\u01AB\u01AD\u01B0\u01B4\u01B6\u01B9\u01BA\u01BD-\u01BF\u01C6\u01C9\u01CC\u01CE\u01D0\u01D2\u01D4\u01D6\u01D8\u01DA\u01DC\u01DD\u01DF\u01E1\u01E3\u01E5\u01E7\u01E9\u01EB\u01ED\u01EF\u01F0\u01F3\u01F5\u01F9\u01FB\u01FD\u01FF\u0201\u0203\u0205\u0207\u0209\u020B\u020D\u020F\u0211\u0213\u0215\u0217\u0219\u021B\u021D\u021F\u0221\u0223\u0225\u0227\u0229\u022B\u022D\u022F\u0231\u0233-\u0239\u023C\u023F\u0240\u0242\u0247\u0249\u024B\u024D\u024F-\u0293\u0295-\u02AF\u0371\u0373\u0377\u037B-\u037D\u0390\u03AC-\u03CE\u03D0\u03D1\u03D5-\u03D7\u03D9\u03DB\u03DD\u03DF\u03E1\u03E3\u03E5\u03E7\u03E9\u03EB\u03ED\u03EF-\u03F3\u03F5\u03F8\u03FB\u03FC\u0430-\u045F\u0461\u0463\u0465\u0467\u0469\u046B\u046D\u046F\u0471\u0473\u0475\u0477\u0479\u047B\u047D\u047F\u0481\u048B\u048D\u048F\u0491\u0493\u0495\u0497\u0499\u049B\u049D\u049F\u04A1\u04A3\u04A5\u04A7\u04A9\u04AB\u04AD\u04AF\u04B1\u04B3\u04B5\u04B7\u04B9\u04BB\u04BD\u04BF\u04C2\u04C4\u04C6\u04C8\u04CA\u04CC\u04CE\u04CF\u04D1\u04D3\u04D5\u04D7\u04D9\u04DB\u04DD\u04DF\u04E1\u04E3\u04E5\u04E7\u04E9\u04EB\u04ED\u04EF\u04F1\u04F3\u04F5\u04F7\u04F9\u04FB\u04FD\u04FF\u0501\u0503\u0505\u0507\u0509\u050B\u050D\u050F\u0511\u0513\u0515\u0517\u0519\u051B\u051D\u051F\u0521\u0523\u0525\u0527\u0529\u052B\u052D\u052F\u0561-\u0587\u13F8-\u13FD\u1D00-\u1D2B\u1D6B-\u1D77\u1D79-\u1D9A\u1E01\u1E03\u1E05\u1E07\u1E09\u1E0B\u1E0D\u1E0F\u1E11\u1E13\u1E15\u1E17\u1E19\u1E1B\u1E1D\u1E1F\u1E21\u1E23\u1E25\u1E27\u1E29\u1E2B\u1E2D\u1E2F\u1E31\u1E33\u1E35\u1E37\u1E39\u1E3B\u1E3D\u1E3F\u1E41\u1E43\u1E45\u1E47\u1E49\u1E4B\u1E4D\u1E4F\u1E51\u1E53\u1E55\u1E57\u1E59\u1E5B\u1E5D\u1E5F\u1E61\u1E63\u1E65\u1E67\u1E69\u1E6B\u1E6D\u1E6F\u1E71\u1E73\u1E75\u1E77\u1E79\u1E7B\u1E7D\u1E7F\u1E81\u1E83\u1E85\u1E87\u1E89\u1E8B\u1E8D\u1E8F\u1E91\u1E93\u1E95-\u1E9D\u1E9F\u1EA1\u1EA3\u1EA5\u1EA7\u1EA9\u1EAB\u1EAD\u1EAF\u1EB1\u1EB3\u1EB5\u1EB7\u1EB9\u1EBB\u1EBD\u1EBF\u1EC1\u1EC3\u1EC5\u1EC7\u1EC9\u1ECB\u1ECD\u1ECF\u1ED1\u1ED3\u1ED5\u1ED7\u1ED9\u1EDB\u1EDD\u1EDF\u1EE1\u1EE3\u1EE5\u1EE7\u1EE9\u1EEB\u1EED\u1EEF\u1EF1\u1EF3\u1EF5\u1EF7\u1EF9\u1EFB\u1EFD\u1EFF-\u1F07\u1F10-\u1F15\u1F20-\u1F27\u1F30-\u1F37\u1F40-\u1F45\u1F50-\u1F57\u1F60-\u1F67\u1F70-\u1F7D\u1F80-\u1F87\u1F90-\u1F97\u1FA0-\u1FA7\u1FB0-\u1FB4\u1FB6\u1FB7\u1FBE\u1FC2-\u1FC4\u1FC6\u1FC7\u1FD0-\u1FD3\u1FD6\u1FD7\u1FE0-\u1FE7\u1FF2-\u1FF4\u1FF6\u1FF7\u210A\u210E\u210F\u2113\u212F\u2134\u2139\u213C\u213D\u2146-\u2149\u214E\u2184\u2C30-\u2C5E\u2C61\u2C65\u2C66\u2C68\u2C6A\u2C6C\u2C71\u2C73\u2C74\u2C76-\u2C7B\u2C81\u2C83\u2C85\u2C87\u2C89\u2C8B\u2C8D\u2C8F\u2C91\u2C93\u2C95\u2C97\u2C99\u2C9B\u2C9D\u2C9F\u2CA1\u2CA3\u2CA5\u2CA7\u2CA9\u2CAB\u2CAD\u2CAF\u2CB1\u2CB3\u2CB5\u2CB7\u2CB9\u2CBB\u2CBD\u2CBF\u2CC1\u2CC3\u2CC5\u2CC7\u2CC9\u2CCB\u2CCD\u2CCF\u2CD1\u2CD3\u2CD5\u2CD7\u2CD9\u2CDB\u2CDD\u2CDF\u2CE1\u2CE3\u2CE4\u2CEC\u2CEE\u2CF3\u2D00-\u2D25\u2D27\u2D2D\uA641\uA643\uA645\uA647\uA649\uA64B\uA64D\uA64F\uA651\uA653\uA655\uA657\uA659\uA65B\uA65D\uA65F\uA661\uA663\uA665\uA667\uA669\uA66B\uA66D\uA681\uA683\uA685\uA687\uA689\uA68B\uA68D\uA68F\uA691\uA693\uA695\uA697\uA699\uA69B\uA723\uA725\uA727\uA729\uA72B\uA72D\uA72F-\uA731\uA733\uA735\uA737\uA739\uA73B\uA73D\uA73F\uA741\uA743\uA745\uA747\uA749\uA74B\uA74D\uA74F\uA751\uA753\uA755\uA757\uA759\uA75B\uA75D\uA75F\uA761\uA763\uA765\uA767\uA769\uA76B\uA76D\uA76F\uA771-\uA778\uA77A\uA77C\uA77F\uA781\uA783\uA785\uA787\uA78C\uA78E\uA791\uA793-\uA795\uA797\uA799\uA79B\uA79D\uA79F\uA7A1\uA7A3\uA7A5\uA7A7\uA7A9\uA7B5\uA7B7\uA7FA\uAB30-\uAB5A\uAB60-\uAB65\uAB70-\uABBF\uFB00-\uFB06\uFB13-\uFB17\uFF41-\uFF5A])/g},63358:e=>{e.exports=/[^A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AD\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC0-9\xB2\xB3\xB9\xBC-\xBE\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u09F4-\u09F9\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0B72-\u0B77\u0BE6-\u0BF2\u0C66-\u0C6F\u0C78-\u0C7E\u0CE6-\u0CEF\u0D66-\u0D75\u0DE6-\u0DEF\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F33\u1040-\u1049\u1090-\u1099\u1369-\u137C\u16EE-\u16F0\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1946-\u194F\u19D0-\u19DA\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\u2070\u2074-\u2079\u2080-\u2089\u2150-\u2182\u2185-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2CFD\u3007\u3021-\u3029\u3038-\u303A\u3192-\u3195\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\uA620-\uA629\uA6E6-\uA6EF\uA830-\uA835\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uA9F0-\uA9F9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19]+/g},18605:(e,t,n)=>{var r=n(60392);function i(e,t){r.cipher.registerAlgorithm(e,(function(){return new r.aes.Algorithm(e,t)}))}n(33397),n(14533),n(63877),e.exports=r.aes=r.aes||{},r.aes.startEncrypting=function(e,t,n,r){var i=g({key:e,output:n,decrypt:!1,mode:r});return i.start(t),i},r.aes.createEncryptionCipher=function(e,t){return g({key:e,output:null,decrypt:!1,mode:t})},r.aes.startDecrypting=function(e,t,n,r){var i=g({key:e,output:n,decrypt:!0,mode:r});return i.start(t),i},r.aes.createDecryptionCipher=function(e,t){return g({key:e,output:null,decrypt:!0,mode:t})},r.aes.Algorithm=function(e,t){u||d();var n=this;n.name=e,n.mode=new t({blockSize:16,cipher:{encrypt:function(e,t){return p(n._w,e,t,!1)},decrypt:function(e,t){return p(n._w,e,t,!0)}}}),n._init=!1},r.aes.Algorithm.prototype.initialize=function(e){if(!this._init){var t,n=e.key;if("string"!==typeof n||16!==n.length&&24!==n.length&&32!==n.length){if(r.util.isArray(n)&&(16===n.length||24===n.length||32===n.length)){t=n,n=r.util.createBuffer();for(var i=0;i<t.length;++i)n.putByte(t[i])}}else n=r.util.createBuffer(n);if(!r.util.isArray(n)){t=n,n=[];var o=t.length();if(16===o||24===o||32===o){o>>>=2;for(i=0;i<o;++i)n.push(t.getInt32())}}if(!r.util.isArray(n)||4!==n.length&&6!==n.length&&8!==n.length)throw new Error("Invalid key parameter.");var s=this.mode.name,a=-1!==["CFB","OFB","CTR","GCM"].indexOf(s);this._w=f(n,e.decrypt&&!a),this._init=!0}},r.aes._expandKey=function(e,t){return u||d(),f(e,t)},r.aes._updateBlock=p,i("AES-ECB",r.cipher.modes.ecb),i("AES-CBC",r.cipher.modes.cbc),i("AES-CFB",r.cipher.modes.cfb),i("AES-OFB",r.cipher.modes.ofb),i("AES-CTR",r.cipher.modes.ctr),i("AES-GCM",r.cipher.modes.gcm);var o,s,a,c,l,u=!1,h=4;function d(){u=!0,a=[0,1,2,4,8,16,32,64,128,27,54];for(var e=new Array(256),t=0;t<128;++t)e[t]=t<<1,e[t+128]=t+128<<1^283;o=new Array(256),s=new Array(256),c=new Array(4),l=new Array(4);for(t=0;t<4;++t)c[t]=new Array(256),l[t]=new Array(256);var n,r,i,h,d,f,p,g=0,y=0;for(t=0;t<256;++t){h=(h=y^y<<1^y<<2^y<<3^y<<4)>>8^255&h^99,o[g]=h,s[h]=g,f=(d=e[h])<<24^h<<16^h<<8^h^d,p=((n=e[g])^(r=e[n])^(i=e[r]))<<24^(g^i)<<16^(g^r^i)<<8^g^n^i;for(var m=0;m<4;++m)c[m][g]=f,l[m][h]=p,f=f<<24|f>>>8,p=p<<24|p>>>8;0===g?g=y=1:(g=n^e[e[e[n^i]]],y^=e[e[y]])}}function f(e,t){for(var n,r=e.slice(0),i=1,s=r.length,c=h*(s+6+1),u=s;u<c;++u)n=r[u-1],u%s===0?(n=o[n>>>16&255]<<24^o[n>>>8&255]<<16^o[255&n]<<8^o[n>>>24]^a[i]<<24,i++):s>6&&u%s===4&&(n=o[n>>>24]<<24^o[n>>>16&255]<<16^o[n>>>8&255]<<8^o[255&n]),r[u]=r[u-s]^n;if(t){for(var d,f=l[0],p=l[1],g=l[2],y=l[3],m=r.slice(0),v=(u=0,(c=r.length)-h);u<c;u+=h,v-=h)if(0===u||u===c-h)m[u]=r[v],m[u+1]=r[v+3],m[u+2]=r[v+2],m[u+3]=r[v+1];else for(var b=0;b<h;++b)d=r[v+b],m[u+(3&-b)]=f[o[d>>>24]]^p[o[d>>>16&255]]^g[o[d>>>8&255]]^y[o[255&d]];r=m}return r}function p(e,t,n,r){var i,a,u,h,d,f,p,g,y,m,v,b,w=e.length/4-1;r?(i=l[0],a=l[1],u=l[2],h=l[3],d=s):(i=c[0],a=c[1],u=c[2],h=c[3],d=o),f=t[0]^e[0],p=t[r?3:1]^e[1],g=t[2]^e[2],y=t[r?1:3]^e[3];for(var E=3,A=1;A<w;++A)m=i[f>>>24]^a[p>>>16&255]^u[g>>>8&255]^h[255&y]^e[++E],v=i[p>>>24]^a[g>>>16&255]^u[y>>>8&255]^h[255&f]^e[++E],b=i[g>>>24]^a[y>>>16&255]^u[f>>>8&255]^h[255&p]^e[++E],y=i[y>>>24]^a[f>>>16&255]^u[p>>>8&255]^h[255&g]^e[++E],f=m,p=v,g=b;n[0]=d[f>>>24]<<24^d[p>>>16&255]<<16^d[g>>>8&255]<<8^d[255&y]^e[++E],n[r?3:1]=d[p>>>24]<<24^d[g>>>16&255]<<16^d[y>>>8&255]<<8^d[255&f]^e[++E],n[2]=d[g>>>24]<<24^d[y>>>16&255]<<16^d[f>>>8&255]<<8^d[255&p]^e[++E],n[r?1:3]=d[y>>>24]<<24^d[f>>>16&255]<<16^d[p>>>8&255]<<8^d[255&g]^e[++E]}function g(e){var t,n="AES-"+((e=e||{}).mode||"CBC").toUpperCase(),i=(t=e.decrypt?r.cipher.createDecipher(n,e.key):r.cipher.createCipher(n,e.key)).start;return t.start=function(e,n){var o=null;n instanceof r.util.ByteBuffer&&(o=n,n={}),(n=n||{}).output=o,n.iv=e,i.call(t,n)},t}},85049:(e,t,n)=>{var r=n(60392);n(63877),n(72886);var i=e.exports=r.asn1=r.asn1||{};function o(e,t,n){if(n>t){var r=new Error("Too few bytes to parse DER.");throw r.available=e.length(),r.remaining=t,r.requested=n,r}}i.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},i.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},i.create=function(e,t,n,o,s){if(r.util.isArray(o)){for(var a=[],c=0;c<o.length;++c)void 0!==o[c]&&a.push(o[c]);o=a}var l={tagClass:e,type:t,constructed:n,composed:n||r.util.isArray(o),value:o};return s&&"bitStringContents"in s&&(l.bitStringContents=s.bitStringContents,l.original=i.copy(l)),l},i.copy=function(e,t){var n;if(r.util.isArray(e)){n=[];for(var o=0;o<e.length;++o)n.push(i.copy(e[o],t));return n}return"string"===typeof e?e:(n={tagClass:e.tagClass,type:e.type,constructed:e.constructed,composed:e.composed,value:i.copy(e.value,t)},t&&!t.excludeBitStringContents&&(n.bitStringContents=e.bitStringContents),n)},i.equals=function(e,t,n){if(r.util.isArray(e)){if(!r.util.isArray(t))return!1;if(e.length!==t.length)return!1;for(var o=0;o<e.length;++o)if(!i.equals(e[o],t[o]))return!1;return!0}if(typeof e!==typeof t)return!1;if("string"===typeof e)return e===t;var s=e.tagClass===t.tagClass&&e.type===t.type&&e.constructed===t.constructed&&e.composed===t.composed&&i.equals(e.value,t.value);return n&&n.includeBitStringContents&&(s=s&&e.bitStringContents===t.bitStringContents),s},i.getBerValueLength=function(e){var t=e.getByte();if(128!==t)return 128&t?e.getInt((127&t)<<3):t};function s(e,t,n,r){var a;o(e,t,2);var c=e.getByte();t--;var l=192&c,u=31&c;a=e.length();var h,d,f=function(e,t){var n=e.getByte();if(t--,128!==n){var r;if(128&n){var i=127&n;o(e,t,i),r=e.getInt(i<<3)}else r=n;if(r<0)throw new Error("Negative length: "+r);return r}}(e,t);if(t-=a-e.length(),void 0!==f&&f>t){if(r.strict){var p=new Error("Too few bytes to read ASN.1 value.");throw p.available=e.length(),p.remaining=t,p.requested=f,p}f=t}var g=32===(32&c);if(g)if(h=[],void 0===f)for(;;){if(o(e,t,2),e.bytes(2)===String.fromCharCode(0,0)){e.getBytes(2),t-=2;break}a=e.length(),h.push(s(e,t,n+1,r)),t-=a-e.length()}else for(;f>0;)a=e.length(),h.push(s(e,f,n+1,r)),t-=a-e.length(),f-=a-e.length();if(void 0===h&&l===i.Class.UNIVERSAL&&u===i.Type.BITSTRING&&(d=e.bytes(f)),void 0===h&&r.decodeBitStrings&&l===i.Class.UNIVERSAL&&u===i.Type.BITSTRING&&f>1){var y=e.read,m=t,v=0;if(u===i.Type.BITSTRING&&(o(e,t,1),v=e.getByte(),t--),0===v)try{a=e.length();var b=s(e,t,n+1,{strict:!0,decodeBitStrings:!0}),w=a-e.length();t-=w,u==i.Type.BITSTRING&&w++;var E=b.tagClass;w!==f||E!==i.Class.UNIVERSAL&&E!==i.Class.CONTEXT_SPECIFIC||(h=[b])}catch(S){}void 0===h&&(e.read=y,t=m)}if(void 0===h){if(void 0===f){if(r.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");f=t}if(u===i.Type.BMPSTRING)for(h="";f>0;f-=2)o(e,t,2),h+=String.fromCharCode(e.getInt16()),t-=2;else h=e.getBytes(f),t-=f}var A=void 0===d?null:{bitStringContents:d};return i.create(l,u,g,h,A)}i.fromDer=function(e,t){void 0===t&&(t={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),"boolean"===typeof t&&(t={strict:t,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in t||(t.strict=!0),"parseAllBytes"in t||(t.parseAllBytes=!0),"decodeBitStrings"in t||(t.decodeBitStrings=!0),"string"===typeof e&&(e=r.util.createBuffer(e));var n=e.length(),i=s(e,e.length(),0,t);if(t.parseAllBytes&&0!==e.length()){var o=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw o.byteCount=n,o.remaining=e.length(),o}return i},i.toDer=function(e){var t=r.util.createBuffer(),n=e.tagClass|e.type,o=r.util.createBuffer(),s=!1;if("bitStringContents"in e&&(s=!0,e.original&&(s=i.equals(e,e.original))),s)o.putBytes(e.bitStringContents);else if(e.composed){e.constructed?n|=32:o.putByte(0);for(var a=0;a<e.value.length;++a)void 0!==e.value[a]&&o.putBuffer(i.toDer(e.value[a]))}else if(e.type===i.Type.BMPSTRING)for(a=0;a<e.value.length;++a)o.putInt16(e.value.charCodeAt(a));else e.type===i.Type.INTEGER&&e.value.length>1&&(0===e.value.charCodeAt(0)&&0===(128&e.value.charCodeAt(1))||255===e.value.charCodeAt(0)&&128===(128&e.value.charCodeAt(1)))?o.putBytes(e.value.substr(1)):o.putBytes(e.value);if(t.putByte(n),o.length()<=127)t.putByte(127&o.length());else{var c=o.length(),l="";do{l+=String.fromCharCode(255&c),c>>>=8}while(c>0);t.putByte(128|l.length);for(a=l.length-1;a>=0;--a)t.putByte(l.charCodeAt(a))}return t.putBuffer(o),t},i.oidToDer=function(e){var t,n,i,o,s=e.split("."),a=r.util.createBuffer();a.putByte(40*parseInt(s[0],10)+parseInt(s[1],10));for(var c=2;c<s.length;++c){t=!0,n=[],i=parseInt(s[c],10);do{o=127&i,i>>>=7,t||(o|=128),n.push(o),t=!1}while(i>0);for(var l=n.length-1;l>=0;--l)a.putByte(n[l])}return a},i.derToOid=function(e){var t;"string"===typeof e&&(e=r.util.createBuffer(e));var n=e.getByte();t=Math.floor(n/40)+"."+n%40;for(var i=0;e.length()>0;)i<<=7,128&(n=e.getByte())?i+=127&n:(t+="."+(i+n),i=0);return t},i.utcTimeToDate=function(e){var t=new Date,n=parseInt(e.substr(0,2),10);n=n>=50?1900+n:2e3+n;var r=parseInt(e.substr(2,2),10)-1,i=parseInt(e.substr(4,2),10),o=parseInt(e.substr(6,2),10),s=parseInt(e.substr(8,2),10),a=0;if(e.length>11){var c=e.charAt(10),l=10;"+"!==c&&"-"!==c&&(a=parseInt(e.substr(10,2),10),l+=2)}if(t.setUTCFullYear(n,r,i),t.setUTCHours(o,s,a,0),l&&("+"===(c=e.charAt(l))||"-"===c)){var u=60*parseInt(e.substr(l+1,2),10)+parseInt(e.substr(l+4,2),10);u*=6e4,"+"===c?t.setTime(+t-u):t.setTime(+t+u)}return t},i.generalizedTimeToDate=function(e){var t=new Date,n=parseInt(e.substr(0,4),10),r=parseInt(e.substr(4,2),10)-1,i=parseInt(e.substr(6,2),10),o=parseInt(e.substr(8,2),10),s=parseInt(e.substr(10,2),10),a=parseInt(e.substr(12,2),10),c=0,l=0,u=!1;"Z"===e.charAt(e.length-1)&&(u=!0);var h=e.length-5,d=e.charAt(h);"+"!==d&&"-"!==d||(l=60*parseInt(e.substr(h+1,2),10)+parseInt(e.substr(h+4,2),10),l*=6e4,"+"===d&&(l*=-1),u=!0);return"."===e.charAt(14)&&(c=1e3*parseFloat(e.substr(14),10)),u?(t.setUTCFullYear(n,r,i),t.setUTCHours(o,s,a,c),t.setTime(+t+l)):(t.setFullYear(n,r,i),t.setHours(o,s,a,c)),t},i.dateToUtcTime=function(e){if("string"===typeof e)return e;var t="",n=[];n.push((""+e.getUTCFullYear()).substr(2)),n.push(""+(e.getUTCMonth()+1)),n.push(""+e.getUTCDate()),n.push(""+e.getUTCHours()),n.push(""+e.getUTCMinutes()),n.push(""+e.getUTCSeconds());for(var r=0;r<n.length;++r)n[r].length<2&&(t+="0"),t+=n[r];return t+="Z"},i.dateToGeneralizedTime=function(e){if("string"===typeof e)return e;var t="",n=[];n.push(""+e.getUTCFullYear()),n.push(""+(e.getUTCMonth()+1)),n.push(""+e.getUTCDate()),n.push(""+e.getUTCHours()),n.push(""+e.getUTCMinutes()),n.push(""+e.getUTCSeconds());for(var r=0;r<n.length;++r)n[r].length<2&&(t+="0"),t+=n[r];return t+="Z"},i.integerToDer=function(e){var t=r.util.createBuffer();if(e>=-128&&e<128)return t.putSignedInt(e,8);if(e>=-32768&&e<32768)return t.putSignedInt(e,16);if(e>=-8388608&&e<8388608)return t.putSignedInt(e,24);if(e>=-2147483648&&e<2147483648)return t.putSignedInt(e,32);var n=new Error("Integer too large; max is 32-bits.");throw n.integer=e,n},i.derToInteger=function(e){"string"===typeof e&&(e=r.util.createBuffer(e));var t=8*e.length();if(t>32)throw new Error("Integer too large; max is 32-bits.");return e.getSignedInt(t)},i.validate=function(e,t,n,o){var s=!1;if(e.tagClass!==t.tagClass&&"undefined"!==typeof t.tagClass||e.type!==t.type&&"undefined"!==typeof t.type)o&&(e.tagClass!==t.tagClass&&o.push("["+t.name+'] Expected tag class "'+t.tagClass+'", got "'+e.tagClass+'"'),e.type!==t.type&&o.push("["+t.name+'] Expected type "'+t.type+'", got "'+e.type+'"'));else if(e.constructed===t.constructed||"undefined"===typeof t.constructed){if(s=!0,t.value&&r.util.isArray(t.value))for(var a=0,c=0;s&&c<t.value.length;++c)s=t.value[c].optional||!1,e.value[a]&&((s=i.validate(e.value[a],t.value[c],n,o))?++a:t.value[c].optional&&(s=!0)),!s&&o&&o.push("["+t.name+'] Tag class "'+t.tagClass+'", type "'+t.type+'" expected value length "'+t.value.length+'", got "'+e.value.length+'"');if(s&&n)if(t.capture&&(n[t.capture]=e.value),t.captureAsn1&&(n[t.captureAsn1]=e),t.captureBitStringContents&&"bitStringContents"in e&&(n[t.captureBitStringContents]=e.bitStringContents),t.captureBitStringValue&&"bitStringContents"in e)if(e.bitStringContents.length<2)n[t.captureBitStringValue]="";else{if(0!==e.bitStringContents.charCodeAt(0))throw new Error("captureBitStringValue only supported for zero unused bits");n[t.captureBitStringValue]=e.bitStringContents.slice(1)}}else o&&o.push("["+t.name+'] Expected constructed "'+t.constructed+'", got "'+e.constructed+'"');return s};var a=/[^\\u0000-\\u00ff]/;i.prettyPrint=function(e,t,n){var o="";n=n||2,(t=t||0)>0&&(o+="\n");for(var s="",c=0;c<t*n;++c)s+=" ";switch(o+=s+"Tag: ",e.tagClass){case i.Class.UNIVERSAL:o+="Universal:";break;case i.Class.APPLICATION:o+="Application:";break;case i.Class.CONTEXT_SPECIFIC:o+="Context-Specific:";break;case i.Class.PRIVATE:o+="Private:"}if(e.tagClass===i.Class.UNIVERSAL)switch(o+=e.type,e.type){case i.Type.NONE:o+=" (None)";break;case i.Type.BOOLEAN:o+=" (Boolean)";break;case i.Type.INTEGER:o+=" (Integer)";break;case i.Type.BITSTRING:o+=" (Bit string)";break;case i.Type.OCTETSTRING:o+=" (Octet string)";break;case i.Type.NULL:o+=" (Null)";break;case i.Type.OID:o+=" (Object Identifier)";break;case i.Type.ODESC:o+=" (Object Descriptor)";break;case i.Type.EXTERNAL:o+=" (External or Instance of)";break;case i.Type.REAL:o+=" (Real)";break;case i.Type.ENUMERATED:o+=" (Enumerated)";break;case i.Type.EMBEDDED:o+=" (Embedded PDV)";break;case i.Type.UTF8:o+=" (UTF8)";break;case i.Type.ROID:o+=" (Relative Object Identifier)";break;case i.Type.SEQUENCE:o+=" (Sequence)";break;case i.Type.SET:o+=" (Set)";break;case i.Type.PRINTABLESTRING:o+=" (Printable String)";break;case i.Type.IA5String:o+=" (IA5String (ASCII))";break;case i.Type.UTCTIME:o+=" (UTC time)";break;case i.Type.GENERALIZEDTIME:o+=" (Generalized time)";break;case i.Type.BMPSTRING:o+=" (BMP String)"}else o+=e.type;if(o+="\n",o+=s+"Constructed: "+e.constructed+"\n",e.composed){var l=0,u="";for(c=0;c<e.value.length;++c)void 0!==e.value[c]&&(l+=1,u+=i.prettyPrint(e.value[c],t+1,n),c+1<e.value.length&&(u+=","));o+=s+"Sub values: "+l+u}else{if(o+=s+"Value: ",e.type===i.Type.OID){var h=i.derToOid(e.value);o+=h,r.pki&&r.pki.oids&&h in r.pki.oids&&(o+=" ("+r.pki.oids[h]+") ")}if(e.type===i.Type.INTEGER)try{o+=i.derToInteger(e.value)}catch(f){o+="0x"+r.util.bytesToHex(e.value)}else if(e.type===i.Type.BITSTRING){if(e.value.length>1?o+="0x"+r.util.bytesToHex(e.value.slice(1)):o+="(none)",e.value.length>0){var d=e.value.charCodeAt(0);1==d?o+=" (1 unused bit shown)":d>1&&(o+=" ("+d+" unused bits shown)")}}else if(e.type===i.Type.OCTETSTRING)a.test(e.value)||(o+="("+e.value+") "),o+="0x"+r.util.bytesToHex(e.value);else if(e.type===i.Type.UTF8)try{o+=r.util.decodeUtf8(e.value)}catch(p){if("URI malformed"!==p.message)throw p;o+="0x"+r.util.bytesToHex(e.value)+" (malformed UTF8)"}else e.type===i.Type.PRINTABLESTRING||e.type===i.Type.IA5String?o+=e.value:a.test(e.value)?o+="0x"+r.util.bytesToHex(e.value):0===e.value.length?o+="[null]":o+=e.value}return o}},65754:(e,t,n)=>{var r=n(62678).Buffer,i={};e.exports=i;var o={};i.encode=function(e,t,n){if("string"!==typeof t)throw new TypeError('"alphabet" must be a string.');if(void 0!==n&&"number"!==typeof n)throw new TypeError('"maxline" must be a number.');var r="";if(e instanceof Uint8Array){var i=0,o=t.length,s=t.charAt(0),a=[0];for(i=0;i<e.length;++i){for(var c=0,l=e[i];c<a.length;++c)l+=a[c]<<8,a[c]=l%o,l=l/o|0;for(;l>0;)a.push(l%o),l=l/o|0}for(i=0;0===e[i]&&i<e.length-1;++i)r+=s;for(i=a.length-1;i>=0;--i)r+=t[a[i]]}else r=function(e,t){var n=0,r=t.length,i=t.charAt(0),o=[0];for(n=0;n<e.length();++n){for(var s=0,a=e.at(n);s<o.length;++s)a+=o[s]<<8,o[s]=a%r,a=a/r|0;for(;a>0;)o.push(a%r),a=a/r|0}var c="";for(n=0;0===e.at(n)&&n<e.length()-1;++n)c+=i;for(n=o.length-1;n>=0;--n)c+=t[o[n]];return c}(e,t);if(n){var u=new RegExp(".{1,"+n+"}","g");r=r.match(u).join("\r\n")}return r},i.decode=function(e,t){if("string"!==typeof e)throw new TypeError('"input" must be a string.');if("string"!==typeof t)throw new TypeError('"alphabet" must be a string.');var n=o[t];if(!n){n=o[t]=[];for(var i=0;i<t.length;++i)n[t.charCodeAt(i)]=i}e=e.replace(/\s/g,"");var s=t.length,a=t.charAt(0),c=[0];for(i=0;i<e.length;i++){var l=n[e.charCodeAt(i)];if(void 0===l)return;for(var u=0,h=l;u<c.length;++u)h+=c[u]*s,c[u]=255&h,h>>=8;for(;h>0;)c.push(255&h),h>>=8}for(var d=0;e[d]===a&&d<e.length-1;++d)c.push(0);return"undefined"!==typeof r?r.from(c.reverse()):new Uint8Array(c.reverse())}},33397:(e,t,n)=>{var r=n(60392);n(63877),e.exports=r.cipher=r.cipher||{},r.cipher.algorithms=r.cipher.algorithms||{},r.cipher.createCipher=function(e,t){var n=e;if("string"===typeof n&&(n=r.cipher.getAlgorithm(n))&&(n=n()),!n)throw new Error("Unsupported algorithm: "+e);return new r.cipher.BlockCipher({algorithm:n,key:t,decrypt:!1})},r.cipher.createDecipher=function(e,t){var n=e;if("string"===typeof n&&(n=r.cipher.getAlgorithm(n))&&(n=n()),!n)throw new Error("Unsupported algorithm: "+e);return new r.cipher.BlockCipher({algorithm:n,key:t,decrypt:!0})},r.cipher.registerAlgorithm=function(e,t){e=e.toUpperCase(),r.cipher.algorithms[e]=t},r.cipher.getAlgorithm=function(e){return(e=e.toUpperCase())in r.cipher.algorithms?r.cipher.algorithms[e]:null};var i=r.cipher.BlockCipher=function(e){this.algorithm=e.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=e.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=e.decrypt,this.algorithm.initialize(e)};i.prototype.start=function(e){e=e||{};var t={};for(var n in e)t[n]=e[n];t.decrypt=this._decrypt,this._finish=!1,this._input=r.util.createBuffer(),this.output=e.output||r.util.createBuffer(),this.mode.start(t)},i.prototype.update=function(e){for(e&&this._input.putBuffer(e);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},i.prototype.finish=function(e){!e||"ECB"!==this.mode.name&&"CBC"!==this.mode.name||(this.mode.pad=function(t){return e(this.blockSize,t,!1)},this.mode.unpad=function(t){return e(this.blockSize,t,!0)});var t={};return t.decrypt=this._decrypt,t.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,t))&&(this._finish=!0,this.update(),!(this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,t))&&!(this.mode.afterFinish&&!this.mode.afterFinish(this.output,t)))}},14533:(e,t,n)=>{var r=n(60392);n(63877),r.cipher=r.cipher||{};var i=e.exports=r.cipher.modes=r.cipher.modes||{};function o(e,t){if("string"===typeof e&&(e=r.util.createBuffer(e)),r.util.isArray(e)&&e.length>4){var n=e;e=r.util.createBuffer();for(var i=0;i<n.length;++i)e.putByte(n[i])}if(e.length()<t)throw new Error("Invalid IV length; got "+e.length()+" bytes and expected "+t+" bytes.");if(!r.util.isArray(e)){var o=[],s=t/4;for(i=0;i<s;++i)o.push(e.getInt32());e=o}return e}function s(e){e[e.length-1]=e[e.length-1]+1&4294967295}function a(e){return[e/4294967296|0,4294967295&e]}i.ecb=function(e){e=e||{},this.name="ECB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},i.ecb.prototype.start=function(e){},i.ecb.prototype.encrypt=function(e,t,n){if(e.length()<this.blockSize&&!(n&&e.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(r=0;r<this._ints;++r)t.putInt32(this._outBlock[r])},i.ecb.prototype.decrypt=function(e,t,n){if(e.length()<this.blockSize&&!(n&&e.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(r=0;r<this._ints;++r)t.putInt32(this._outBlock[r])},i.ecb.prototype.pad=function(e,t){var n=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(n,n),!0},i.ecb.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var n=e.length(),r=e.at(n-1);return!(r>this.blockSize<<2)&&(e.truncate(r),!0)},i.cbc=function(e){e=e||{},this.name="CBC",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},i.cbc.prototype.start=function(e){if(null===e.iv){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else{if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=o(e.iv,this.blockSize),this._prev=this._iv.slice(0)}},i.cbc.prototype.encrypt=function(e,t,n){if(e.length()<this.blockSize&&!(n&&e.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=this._prev[r]^e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(r=0;r<this._ints;++r)t.putInt32(this._outBlock[r]);this._prev=this._outBlock},i.cbc.prototype.decrypt=function(e,t,n){if(e.length()<this.blockSize&&!(n&&e.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(r=0;r<this._ints;++r)t.putInt32(this._prev[r]^this._outBlock[r]);this._prev=this._inBlock.slice(0)},i.cbc.prototype.pad=function(e,t){var n=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(n,n),!0},i.cbc.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var n=e.length(),r=e.at(n-1);return!(r>this.blockSize<<2)&&(e.truncate(r),!0)},i.cfb=function(e){e=e||{},this.name="CFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=r.util.createBuffer(),this._partialBytes=0},i.cfb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=o(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},i.cfb.prototype.encrypt=function(e,t,n){var r=e.length();if(0===r)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&r>=this.blockSize)for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32()^this._outBlock[i],t.putInt32(this._inBlock[i]);else{var o=(this.blockSize-r)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(o>0)e.read-=this.blockSize;else for(i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!n)return t.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;t.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0}},i.cfb.prototype.decrypt=function(e,t,n){var r=e.length();if(0===r)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&r>=this.blockSize)for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32(),t.putInt32(this._inBlock[i]^this._outBlock[i]);else{var o=(this.blockSize-r)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(o>0)e.read-=this.blockSize;else for(i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!n)return t.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;t.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0}},i.ofb=function(e){e=e||{},this.name="OFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=r.util.createBuffer(),this._partialBytes=0},i.ofb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=o(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},i.ofb.prototype.encrypt=function(e,t,n){var r=e.length();if(0===e.length())return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&r>=this.blockSize)for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];else{var o=(this.blockSize-r)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(o>0)e.read-=this.blockSize;else for(i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!n)return t.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;t.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0}},i.ofb.prototype.decrypt=i.ofb.prototype.encrypt,i.ctr=function(e){e=e||{},this.name="CTR",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=r.util.createBuffer(),this._partialBytes=0},i.ctr.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=o(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},i.ctr.prototype.encrypt=function(e,t,n){var r=e.length();if(0===r)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&r>=this.blockSize)for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]);else{var o=(this.blockSize-r)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(o>0&&(e.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!n)return t.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;t.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0}s(this._inBlock)},i.ctr.prototype.decrypt=i.ctr.prototype.encrypt,i.gcm=function(e){e=e||{},this.name="GCM",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=r.util.createBuffer(),this._partialBytes=0,this._R=3774873600},i.gcm.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");var t,n=r.util.createBuffer(e.iv);if(this._cipherLength=0,t="additionalData"in e?r.util.createBuffer(e.additionalData):r.util.createBuffer(),this._tagLength="tagLength"in e?e.tagLength:128,this._tag=null,e.decrypt&&(this._tag=r.util.createBuffer(e.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var i=n.length();if(12===i)this._j0=[n.getInt32(),n.getInt32(),n.getInt32(),1];else{for(this._j0=[0,0,0,0];n.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[n.getInt32(),n.getInt32(),n.getInt32(),n.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(a(8*i)))}this._inBlock=this._j0.slice(0),s(this._inBlock),this._partialBytes=0,t=r.util.createBuffer(t),this._aDataLength=a(8*t.length());var o=t.length()%this.blockSize;for(o&&t.fillWithByte(0,this.blockSize-o),this._s=[0,0,0,0];t.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()])},i.gcm.prototype.encrypt=function(e,t,n){var r=e.length();if(0===r)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&r>=this.blockSize){for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^=e.getInt32());this._cipherLength+=this.blockSize}else{var o=(this.blockSize-r)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(o<=0||n){if(n){var a=r%this.blockSize;this._cipherLength+=a,this._partialOutput.truncate(this.blockSize-a)}else this._cipherLength+=this.blockSize;for(i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!n)return e.read-=this.blockSize,t.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;t.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),s(this._inBlock)},i.gcm.prototype.decrypt=function(e,t,n){var r=e.length();if(r<this.blockSize&&!(n&&r>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),s(this._inBlock),this._hashBlock[0]=e.getInt32(),this._hashBlock[1]=e.getInt32(),this._hashBlock[2]=e.getInt32(),this._hashBlock[3]=e.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^this._hashBlock[i]);r<this.blockSize?this._cipherLength+=r%this.blockSize:this._cipherLength+=this.blockSize},i.gcm.prototype.afterFinish=function(e,t){var n=!0;t.decrypt&&t.overflow&&e.truncate(this.blockSize-t.overflow),this.tag=r.util.createBuffer();var i=this._aDataLength.concat(a(8*this._cipherLength));this._s=this.ghash(this._hashSubkey,this._s,i);var o=[];this.cipher.encrypt(this._j0,o);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^o[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),t.decrypt&&this.tag.bytes()!==this._tag&&(n=!1),n},i.gcm.prototype.multiply=function(e,t){for(var n=[0,0,0,0],r=t.slice(0),i=0;i<128;++i){e[i/32|0]&1<<31-i%32&&(n[0]^=r[0],n[1]^=r[1],n[2]^=r[2],n[3]^=r[3]),this.pow(r,r)}return n},i.gcm.prototype.pow=function(e,t){for(var n=1&e[3],r=3;r>0;--r)t[r]=e[r]>>>1|(1&e[r-1])<<31;t[0]=e[0]>>>1,n&&(t[0]^=this._R)},i.gcm.prototype.tableMultiply=function(e){for(var t=[0,0,0,0],n=0;n<32;++n){var r=e[n/8|0]>>>4*(7-n%8)&15,i=this._m[n][r];t[0]^=i[0],t[1]^=i[1],t[2]^=i[2],t[3]^=i[3]}return t},i.gcm.prototype.ghash=function(e,t,n){return t[0]^=n[0],t[1]^=n[1],t[2]^=n[2],t[3]^=n[3],this.tableMultiply(t)},i.gcm.prototype.generateHashTable=function(e,t){for(var n=8/t,r=4*n,i=16*n,o=new Array(i),s=0;s<i;++s){var a=[0,0,0,0],c=(r-1-s%r)*t;a[s/r|0]=1<<t-1<<c,o[s]=this.generateSubHashTable(this.multiply(a,e),t)}return o},i.gcm.prototype.generateSubHashTable=function(e,t){var n=1<<t,r=n>>>1,i=new Array(n);i[r]=e.slice(0);for(var o=r>>>1;o>0;)this.pow(i[2*o],i[o]=[]),o>>=1;for(o=2;o<r;){for(var s=1;s<o;++s){var a=i[o],c=i[s];i[o+s]=[a[0]^c[0],a[1]^c[1],a[2]^c[2],a[3]^c[3]]}o*=2}for(i[0]=[0,0,0,0],o=r+1;o<n;++o){var l=i[o^r];i[o]=[e[0]^l[0],e[1]^l[1],e[2]^l[2],e[3]^l[3]]}return i}},71400:(e,t,n)=>{var r=n(60392);function i(e,t){r.cipher.registerAlgorithm(e,(function(){return new r.des.Algorithm(e,t)}))}n(33397),n(14533),n(63877),e.exports=r.des=r.des||{},r.des.startEncrypting=function(e,t,n,r){var i=p({key:e,output:n,decrypt:!1,mode:r||(null===t?"ECB":"CBC")});return i.start(t),i},r.des.createEncryptionCipher=function(e,t){return p({key:e,output:null,decrypt:!1,mode:t})},r.des.startDecrypting=function(e,t,n,r){var i=p({key:e,output:n,decrypt:!0,mode:r||(null===t?"ECB":"CBC")});return i.start(t),i},r.des.createDecryptionCipher=function(e,t){return p({key:e,output:null,decrypt:!0,mode:t})},r.des.Algorithm=function(e,t){var n=this;n.name=e,n.mode=new t({blockSize:8,cipher:{encrypt:function(e,t){return f(n._keys,e,t,!1)},decrypt:function(e,t){return f(n._keys,e,t,!0)}}}),n._init=!1},r.des.Algorithm.prototype.initialize=function(e){if(!this._init){var t=r.util.createBuffer(e.key);if(0===this.name.indexOf("3DES")&&24!==t.length())throw new Error("Invalid Triple-DES key size: "+8*t.length());this._keys=function(e){for(var t,n=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],i=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],o=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],a=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],c=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],l=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],u=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],h=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],d=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],f=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],p=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],g=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],y=e.length()>8?3:1,m=[],v=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],b=0,w=0;w<y;w++){var E=e.getInt32(),A=e.getInt32();E^=(t=252645135&(E>>>4^A))<<4,E^=t=65535&((A^=t)>>>-16^E),E^=(t=858993459&(E>>>2^(A^=t<<-16)))<<2,E^=t=65535&((A^=t)>>>-16^E),E^=(t=1431655765&(E>>>1^(A^=t<<-16)))<<1,E^=t=16711935&((A^=t)>>>8^E),t=(E^=(t=1431655765&(E>>>1^(A^=t<<8)))<<1)<<8|(A^=t)>>>20&240,E=A<<24|A<<8&16711680|A>>>8&65280|A>>>24&240,A=t;for(var S=0;S<v.length;++S){v[S]?(E=E<<2|E>>>26,A=A<<2|A>>>26):(E=E<<1|E>>>27,A=A<<1|A>>>27),A&=-15;var _=n[(E&=-15)>>>28]|r[E>>>24&15]|i[E>>>20&15]|o[E>>>16&15]|s[E>>>12&15]|a[E>>>8&15]|c[E>>>4&15],I=l[A>>>28]|u[A>>>24&15]|h[A>>>20&15]|d[A>>>16&15]|f[A>>>12&15]|p[A>>>8&15]|g[A>>>4&15];t=65535&(I>>>16^_),m[b++]=_^t,m[b++]=I^t<<16}}return m}(t),this._init=!0}},i("DES-ECB",r.cipher.modes.ecb),i("DES-CBC",r.cipher.modes.cbc),i("DES-CFB",r.cipher.modes.cfb),i("DES-OFB",r.cipher.modes.ofb),i("DES-CTR",r.cipher.modes.ctr),i("3DES-ECB",r.cipher.modes.ecb),i("3DES-CBC",r.cipher.modes.cbc),i("3DES-CFB",r.cipher.modes.cfb),i("3DES-OFB",r.cipher.modes.ofb),i("3DES-CTR",r.cipher.modes.ctr);var o=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],s=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],a=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],c=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],l=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],u=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],h=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],d=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function f(e,t,n,r){var i,f,p=32===e.length?3:9;i=3===p?r?[30,-2,-2]:[0,32,2]:r?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var g=t[0],y=t[1];g^=(f=252645135&(g>>>4^y))<<4,g^=(f=65535&(g>>>16^(y^=f)))<<16,g^=f=858993459&((y^=f)>>>2^g),g^=f=16711935&((y^=f<<2)>>>8^g),g=(g^=(f=1431655765&(g>>>1^(y^=f<<8)))<<1)<<1|g>>>31,y=(y^=f)<<1|y>>>31;for(var m=0;m<p;m+=3){for(var v=i[m+1],b=i[m+2],w=i[m];w!=v;w+=b){var E=y^e[w],A=(y>>>4|y<<28)^e[w+1];f=g,g=y,y=f^(s[E>>>24&63]|c[E>>>16&63]|u[E>>>8&63]|d[63&E]|o[A>>>24&63]|a[A>>>16&63]|l[A>>>8&63]|h[63&A])}f=g,g=y,y=f}y=y>>>1|y<<31,y^=f=1431655765&((g=g>>>1|g<<31)>>>1^y),y^=(f=16711935&(y>>>8^(g^=f<<1)))<<8,y^=(f=858993459&(y>>>2^(g^=f)))<<2,y^=f=65535&((g^=f)>>>16^y),y^=f=252645135&((g^=f<<16)>>>4^y),g^=f<<4,n[0]=g,n[1]=y}function p(e){var t,n="DES-"+((e=e||{}).mode||"CBC").toUpperCase(),i=(t=e.decrypt?r.cipher.createDecipher(n,e.key):r.cipher.createCipher(n,e.key)).start;return t.start=function(e,n){var o=null;n instanceof r.util.ByteBuffer&&(o=n,n={}),(n=n||{}).output=o,n.iv=e,i.call(t,n)},t}},60392:e=>{e.exports={options:{usePureJavaScript:!1}}},70878:(e,t,n)=>{var r=n(60392);n(10029),n(63877),(e.exports=r.hmac=r.hmac||{}).create=function(){var e=null,t=null,n=null,i=null,o={start:function(o,s){if(null!==o)if("string"===typeof o){if(!((o=o.toLowerCase())in r.md.algorithms))throw new Error('Unknown hash algorithm "'+o+'"');t=r.md.algorithms[o].create()}else t=o;if(null===s)s=e;else{if("string"===typeof s)s=r.util.createBuffer(s);else if(r.util.isArray(s)){var a=s;s=r.util.createBuffer();for(var c=0;c<a.length;++c)s.putByte(a[c])}var l=s.length();l>t.blockLength&&(t.start(),t.update(s.bytes()),s=t.digest()),n=r.util.createBuffer(),i=r.util.createBuffer(),l=s.length();for(c=0;c<l;++c){a=s.at(c);n.putByte(54^a),i.putByte(92^a)}if(l<t.blockLength)for(a=t.blockLength-l,c=0;c<a;++c)n.putByte(54),i.putByte(92);e=s,n=n.bytes(),i=i.bytes()}t.start(),t.update(n)},update:function(e){t.update(e)},getMac:function(){var e=t.digest().bytes();return t.start(),t.update(i),t.update(e),t.digest()}};return o.digest=o.getMac,o}},3055:(e,t,n)=>{var r,i=n(60392);e.exports=i.jsbn=i.jsbn||{};function o(e,t,n){this.data=[],null!=e&&("number"==typeof e?this.fromNumber(e,t,n):null==t&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function s(){return new o(null)}function a(e,t,n,r,i,o){for(var s=16383&t,a=t>>14;--o>=0;){var c=16383&this.data[e],l=this.data[e++]>>14,u=a*c+l*s;i=((c=s*c+((16383&u)<<14)+n.data[r]+i)>>28)+(u>>14)+a*l,n.data[r++]=268435455&c}return i}i.jsbn.BigInteger=o,"undefined"===typeof navigator?(o.prototype.am=a,r=28):"Microsoft Internet Explorer"==navigator.appName?(o.prototype.am=function(e,t,n,r,i,o){for(var s=32767&t,a=t>>15;--o>=0;){var c=32767&this.data[e],l=this.data[e++]>>15,u=a*c+l*s;i=((c=s*c+((32767&u)<<15)+n.data[r]+(1073741823&i))>>>30)+(u>>>15)+a*l+(i>>>30),n.data[r++]=1073741823&c}return i},r=30):"Netscape"!=navigator.appName?(o.prototype.am=function(e,t,n,r,i,o){for(;--o>=0;){var s=t*this.data[e++]+n.data[r]+i;i=Math.floor(s/67108864),n.data[r++]=67108863&s}return i},r=26):(o.prototype.am=a,r=28),o.prototype.DB=r,o.prototype.DM=(1<<r)-1,o.prototype.DV=1<<r;o.prototype.FV=Math.pow(2,52),o.prototype.F1=52-r,o.prototype.F2=2*r-52;var c,l,u="0123456789abcdefghijklmnopqrstuvwxyz",h=new Array;for(c="0".charCodeAt(0),l=0;l<=9;++l)h[c++]=l;for(c="a".charCodeAt(0),l=10;l<36;++l)h[c++]=l;for(c="A".charCodeAt(0),l=10;l<36;++l)h[c++]=l;function d(e){return u.charAt(e)}function f(e,t){var n=h[e.charCodeAt(t)];return null==n?-1:n}function p(e){var t=s();return t.fromInt(e),t}function g(e){var t,n=1;return 0!=(t=e>>>16)&&(e=t,n+=16),0!=(t=e>>8)&&(e=t,n+=8),0!=(t=e>>4)&&(e=t,n+=4),0!=(t=e>>2)&&(e=t,n+=2),0!=(t=e>>1)&&(e=t,n+=1),n}function y(e){this.m=e}function m(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function v(e,t){return e&t}function b(e,t){return e|t}function w(e,t){return e^t}function E(e,t){return e&~t}function A(e){if(0==e)return-1;var t=0;return 0==(65535&e)&&(e>>=16,t+=16),0==(255&e)&&(e>>=8,t+=8),0==(15&e)&&(e>>=4,t+=4),0==(3&e)&&(e>>=2,t+=2),0==(1&e)&&++t,t}function S(e){for(var t=0;0!=e;)e&=e-1,++t;return t}function _(){}function I(e){return e}function C(e){this.r2=s(),this.q3=s(),o.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}y.prototype.convert=function(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e},y.prototype.revert=function(e){return e},y.prototype.reduce=function(e){e.divRemTo(this.m,null,e)},y.prototype.mulTo=function(e,t,n){e.multiplyTo(t,n),this.reduce(n)},y.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},m.prototype.convert=function(e){var t=s();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(o.ZERO)>0&&this.m.subTo(t,t),t},m.prototype.revert=function(e){var t=s();return e.copyTo(t),this.reduce(t),t},m.prototype.reduce=function(e){for(;e.t<=this.mt2;)e.data[e.t++]=0;for(var t=0;t<this.m.t;++t){var n=32767&e.data[t],r=n*this.mpl+((n*this.mph+(e.data[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(n=t+this.m.t,e.data[n]+=this.m.am(0,r,e,t,0,this.m.t);e.data[n]>=e.DV;)e.data[n]-=e.DV,e.data[++n]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)},m.prototype.mulTo=function(e,t,n){e.multiplyTo(t,n),this.reduce(n)},m.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},o.prototype.copyTo=function(e){for(var t=this.t-1;t>=0;--t)e.data[t]=this.data[t];e.t=this.t,e.s=this.s},o.prototype.fromInt=function(e){this.t=1,this.s=e<0?-1:0,e>0?this.data[0]=e:e<-1?this.data[0]=e+this.DV:this.t=0},o.prototype.fromString=function(e,t){var n;if(16==t)n=4;else if(8==t)n=3;else if(256==t)n=8;else if(2==t)n=1;else if(32==t)n=5;else{if(4!=t)return void this.fromRadix(e,t);n=2}this.t=0,this.s=0;for(var r=e.length,i=!1,s=0;--r>=0;){var a=8==n?255&e[r]:f(e,r);a<0?"-"==e.charAt(r)&&(i=!0):(i=!1,0==s?this.data[this.t++]=a:s+n>this.DB?(this.data[this.t-1]|=(a&(1<<this.DB-s)-1)<<s,this.data[this.t++]=a>>this.DB-s):this.data[this.t-1]|=a<<s,(s+=n)>=this.DB&&(s-=this.DB))}8==n&&0!=(128&e[0])&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&o.ZERO.subTo(this,this)},o.prototype.clamp=function(){for(var e=this.s&this.DM;this.t>0&&this.data[this.t-1]==e;)--this.t},o.prototype.dlShiftTo=function(e,t){var n;for(n=this.t-1;n>=0;--n)t.data[n+e]=this.data[n];for(n=e-1;n>=0;--n)t.data[n]=0;t.t=this.t+e,t.s=this.s},o.prototype.drShiftTo=function(e,t){for(var n=e;n<this.t;++n)t.data[n-e]=this.data[n];t.t=Math.max(this.t-e,0),t.s=this.s},o.prototype.lShiftTo=function(e,t){var n,r=e%this.DB,i=this.DB-r,o=(1<<i)-1,s=Math.floor(e/this.DB),a=this.s<<r&this.DM;for(n=this.t-1;n>=0;--n)t.data[n+s+1]=this.data[n]>>i|a,a=(this.data[n]&o)<<r;for(n=s-1;n>=0;--n)t.data[n]=0;t.data[s]=a,t.t=this.t+s+1,t.s=this.s,t.clamp()},o.prototype.rShiftTo=function(e,t){t.s=this.s;var n=Math.floor(e/this.DB);if(n>=this.t)t.t=0;else{var r=e%this.DB,i=this.DB-r,o=(1<<r)-1;t.data[0]=this.data[n]>>r;for(var s=n+1;s<this.t;++s)t.data[s-n-1]|=(this.data[s]&o)<<i,t.data[s-n]=this.data[s]>>r;r>0&&(t.data[this.t-n-1]|=(this.s&o)<<i),t.t=this.t-n,t.clamp()}},o.prototype.subTo=function(e,t){for(var n=0,r=0,i=Math.min(e.t,this.t);n<i;)r+=this.data[n]-e.data[n],t.data[n++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r-=e.s;n<this.t;)r+=this.data[n],t.data[n++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;n<e.t;)r-=e.data[n],t.data[n++]=r&this.DM,r>>=this.DB;r-=e.s}t.s=r<0?-1:0,r<-1?t.data[n++]=this.DV+r:r>0&&(t.data[n++]=r),t.t=n,t.clamp()},o.prototype.multiplyTo=function(e,t){var n=this.abs(),r=e.abs(),i=n.t;for(t.t=i+r.t;--i>=0;)t.data[i]=0;for(i=0;i<r.t;++i)t.data[i+n.t]=n.am(0,r.data[i],t,i,0,n.t);t.s=0,t.clamp(),this.s!=e.s&&o.ZERO.subTo(t,t)},o.prototype.squareTo=function(e){for(var t=this.abs(),n=e.t=2*t.t;--n>=0;)e.data[n]=0;for(n=0;n<t.t-1;++n){var r=t.am(n,t.data[n],e,2*n,0,1);(e.data[n+t.t]+=t.am(n+1,2*t.data[n],e,2*n+1,r,t.t-n-1))>=t.DV&&(e.data[n+t.t]-=t.DV,e.data[n+t.t+1]=1)}e.t>0&&(e.data[e.t-1]+=t.am(n,t.data[n],e,2*n,0,1)),e.s=0,e.clamp()},o.prototype.divRemTo=function(e,t,n){var r=e.abs();if(!(r.t<=0)){var i=this.abs();if(i.t<r.t)return null!=t&&t.fromInt(0),void(null!=n&&this.copyTo(n));null==n&&(n=s());var a=s(),c=this.s,l=e.s,u=this.DB-g(r.data[r.t-1]);u>0?(r.lShiftTo(u,a),i.lShiftTo(u,n)):(r.copyTo(a),i.copyTo(n));var h=a.t,d=a.data[h-1];if(0!=d){var f=d*(1<<this.F1)+(h>1?a.data[h-2]>>this.F2:0),p=this.FV/f,y=(1<<this.F1)/f,m=1<<this.F2,v=n.t,b=v-h,w=null==t?s():t;for(a.dlShiftTo(b,w),n.compareTo(w)>=0&&(n.data[n.t++]=1,n.subTo(w,n)),o.ONE.dlShiftTo(h,w),w.subTo(a,a);a.t<h;)a.data[a.t++]=0;for(;--b>=0;){var E=n.data[--v]==d?this.DM:Math.floor(n.data[v]*p+(n.data[v-1]+m)*y);if((n.data[v]+=a.am(0,E,n,b,0,h))<E)for(a.dlShiftTo(b,w),n.subTo(w,n);n.data[v]<--E;)n.subTo(w,n)}null!=t&&(n.drShiftTo(h,t),c!=l&&o.ZERO.subTo(t,t)),n.t=h,n.clamp(),u>0&&n.rShiftTo(u,n),c<0&&o.ZERO.subTo(n,n)}}},o.prototype.invDigit=function(){if(this.t<1)return 0;var e=this.data[0];if(0==(1&e))return 0;var t=3&e;return(t=(t=(t=(t=t*(2-(15&e)*t)&15)*(2-(255&e)*t)&255)*(2-((65535&e)*t&65535))&65535)*(2-e*t%this.DV)%this.DV)>0?this.DV-t:-t},o.prototype.isEven=function(){return 0==(this.t>0?1&this.data[0]:this.s)},o.prototype.exp=function(e,t){if(e>4294967295||e<1)return o.ONE;var n=s(),r=s(),i=t.convert(this),a=g(e)-1;for(i.copyTo(n);--a>=0;)if(t.sqrTo(n,r),(e&1<<a)>0)t.mulTo(r,i,n);else{var c=n;n=r,r=c}return t.revert(n)},o.prototype.toString=function(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var n,r=(1<<t)-1,i=!1,o="",s=this.t,a=this.DB-s*this.DB%t;if(s-- >0)for(a<this.DB&&(n=this.data[s]>>a)>0&&(i=!0,o=d(n));s>=0;)a<t?(n=(this.data[s]&(1<<a)-1)<<t-a,n|=this.data[--s]>>(a+=this.DB-t)):(n=this.data[s]>>(a-=t)&r,a<=0&&(a+=this.DB,--s)),n>0&&(i=!0),i&&(o+=d(n));return i?o:"0"},o.prototype.negate=function(){var e=s();return o.ZERO.subTo(this,e),e},o.prototype.abs=function(){return this.s<0?this.negate():this},o.prototype.compareTo=function(e){var t=this.s-e.s;if(0!=t)return t;var n=this.t;if(0!=(t=n-e.t))return this.s<0?-t:t;for(;--n>=0;)if(0!=(t=this.data[n]-e.data[n]))return t;return 0},o.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+g(this.data[this.t-1]^this.s&this.DM)},o.prototype.mod=function(e){var t=s();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(o.ZERO)>0&&e.subTo(t,t),t},o.prototype.modPowInt=function(e,t){var n;return n=e<256||t.isEven()?new y(t):new m(t),this.exp(e,n)},o.ZERO=p(0),o.ONE=p(1),_.prototype.convert=I,_.prototype.revert=I,_.prototype.mulTo=function(e,t,n){e.multiplyTo(t,n)},_.prototype.sqrTo=function(e,t){e.squareTo(t)},C.prototype.convert=function(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=s();return e.copyTo(t),this.reduce(t),t},C.prototype.revert=function(e){return e},C.prototype.reduce=function(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)},C.prototype.mulTo=function(e,t,n){e.multiplyTo(t,n),this.reduce(n)},C.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)};var T=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],k=(1<<26)/T[T.length-1];o.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))},o.prototype.toRadix=function(e){if(null==e&&(e=10),0==this.signum()||e<2||e>36)return"0";var t=this.chunkSize(e),n=Math.pow(e,t),r=p(n),i=s(),o=s(),a="";for(this.divRemTo(r,i,o);i.signum()>0;)a=(n+o.intValue()).toString(e).substr(1)+a,i.divRemTo(r,i,o);return o.intValue().toString(e)+a},o.prototype.fromRadix=function(e,t){this.fromInt(0),null==t&&(t=10);for(var n=this.chunkSize(t),r=Math.pow(t,n),i=!1,s=0,a=0,c=0;c<e.length;++c){var l=f(e,c);l<0?"-"==e.charAt(c)&&0==this.signum()&&(i=!0):(a=t*a+l,++s>=n&&(this.dMultiply(r),this.dAddOffset(a,0),s=0,a=0))}s>0&&(this.dMultiply(Math.pow(t,s)),this.dAddOffset(a,0)),i&&o.ZERO.subTo(this,this)},o.prototype.fromNumber=function(e,t,n){if("number"==typeof t)if(e<2)this.fromInt(1);else for(this.fromNumber(e,n),this.testBit(e-1)||this.bitwiseTo(o.ONE.shiftLeft(e-1),b,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(o.ONE.shiftLeft(e-1),this);else{var r=new Array,i=7&e;r.length=1+(e>>3),t.nextBytes(r),i>0?r[0]&=(1<<i)-1:r[0]=0,this.fromString(r,256)}},o.prototype.bitwiseTo=function(e,t,n){var r,i,o=Math.min(e.t,this.t);for(r=0;r<o;++r)n.data[r]=t(this.data[r],e.data[r]);if(e.t<this.t){for(i=e.s&this.DM,r=o;r<this.t;++r)n.data[r]=t(this.data[r],i);n.t=this.t}else{for(i=this.s&this.DM,r=o;r<e.t;++r)n.data[r]=t(i,e.data[r]);n.t=e.t}n.s=t(this.s,e.s),n.clamp()},o.prototype.changeBit=function(e,t){var n=o.ONE.shiftLeft(e);return this.bitwiseTo(n,t,n),n},o.prototype.addTo=function(e,t){for(var n=0,r=0,i=Math.min(e.t,this.t);n<i;)r+=this.data[n]+e.data[n],t.data[n++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r+=e.s;n<this.t;)r+=this.data[n],t.data[n++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;n<e.t;)r+=e.data[n],t.data[n++]=r&this.DM,r>>=this.DB;r+=e.s}t.s=r<0?-1:0,r>0?t.data[n++]=r:r<-1&&(t.data[n++]=this.DV+r),t.t=n,t.clamp()},o.prototype.dMultiply=function(e){this.data[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()},o.prototype.dAddOffset=function(e,t){if(0!=e){for(;this.t<=t;)this.data[this.t++]=0;for(this.data[t]+=e;this.data[t]>=this.DV;)this.data[t]-=this.DV,++t>=this.t&&(this.data[this.t++]=0),++this.data[t]}},o.prototype.multiplyLowerTo=function(e,t,n){var r,i=Math.min(this.t+e.t,t);for(n.s=0,n.t=i;i>0;)n.data[--i]=0;for(r=n.t-this.t;i<r;++i)n.data[i+this.t]=this.am(0,e.data[i],n,i,0,this.t);for(r=Math.min(e.t,t);i<r;++i)this.am(0,e.data[i],n,i,0,t-i);n.clamp()},o.prototype.multiplyUpperTo=function(e,t,n){--t;var r=n.t=this.t+e.t-t;for(n.s=0;--r>=0;)n.data[r]=0;for(r=Math.max(t-this.t,0);r<e.t;++r)n.data[this.t+r-t]=this.am(t-r,e.data[r],n,0,0,this.t+r-t);n.clamp(),n.drShiftTo(1,n)},o.prototype.modInt=function(e){if(e<=0)return 0;var t=this.DV%e,n=this.s<0?e-1:0;if(this.t>0)if(0==t)n=this.data[0]%e;else for(var r=this.t-1;r>=0;--r)n=(t*n+this.data[r])%e;return n},o.prototype.millerRabin=function(e){var t=this.subtract(o.ONE),n=t.getLowestSetBit();if(n<=0)return!1;for(var r,i=t.shiftRight(n),s={nextBytes:function(e){for(var t=0;t<e.length;++t)e[t]=Math.floor(256*Math.random())}},a=0;a<e;++a){do{r=new o(this.bitLength(),s)}while(r.compareTo(o.ONE)<=0||r.compareTo(t)>=0);var c=r.modPow(i,this);if(0!=c.compareTo(o.ONE)&&0!=c.compareTo(t)){for(var l=1;l++<n&&0!=c.compareTo(t);)if(0==(c=c.modPowInt(2,this)).compareTo(o.ONE))return!1;if(0!=c.compareTo(t))return!1}}return!0},o.prototype.clone=function(){var e=s();return this.copyTo(e),e},o.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this.data[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this.data[0];if(0==this.t)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]},o.prototype.byteValue=function(){return 0==this.t?this.s:this.data[0]<<24>>24},o.prototype.shortValue=function(){return 0==this.t?this.s:this.data[0]<<16>>16},o.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this.data[0]<=0?0:1},o.prototype.toByteArray=function(){var e=this.t,t=new Array;t[0]=this.s;var n,r=this.DB-e*this.DB%8,i=0;if(e-- >0)for(r<this.DB&&(n=this.data[e]>>r)!=(this.s&this.DM)>>r&&(t[i++]=n|this.s<<this.DB-r);e>=0;)r<8?(n=(this.data[e]&(1<<r)-1)<<8-r,n|=this.data[--e]>>(r+=this.DB-8)):(n=this.data[e]>>(r-=8)&255,r<=0&&(r+=this.DB,--e)),0!=(128&n)&&(n|=-256),0==i&&(128&this.s)!=(128&n)&&++i,(i>0||n!=this.s)&&(t[i++]=n);return t},o.prototype.equals=function(e){return 0==this.compareTo(e)},o.prototype.min=function(e){return this.compareTo(e)<0?this:e},o.prototype.max=function(e){return this.compareTo(e)>0?this:e},o.prototype.and=function(e){var t=s();return this.bitwiseTo(e,v,t),t},o.prototype.or=function(e){var t=s();return this.bitwiseTo(e,b,t),t},o.prototype.xor=function(e){var t=s();return this.bitwiseTo(e,w,t),t},o.prototype.andNot=function(e){var t=s();return this.bitwiseTo(e,E,t),t},o.prototype.not=function(){for(var e=s(),t=0;t<this.t;++t)e.data[t]=this.DM&~this.data[t];return e.t=this.t,e.s=~this.s,e},o.prototype.shiftLeft=function(e){var t=s();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t},o.prototype.shiftRight=function(e){var t=s();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t},o.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=this.data[e])return e*this.DB+A(this.data[e]);return this.s<0?this.t*this.DB:-1},o.prototype.bitCount=function(){for(var e=0,t=this.s&this.DM,n=0;n<this.t;++n)e+=S(this.data[n]^t);return e},o.prototype.testBit=function(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:0!=(this.data[t]&1<<e%this.DB)},o.prototype.setBit=function(e){return this.changeBit(e,b)},o.prototype.clearBit=function(e){return this.changeBit(e,E)},o.prototype.flipBit=function(e){return this.changeBit(e,w)},o.prototype.add=function(e){var t=s();return this.addTo(e,t),t},o.prototype.subtract=function(e){var t=s();return this.subTo(e,t),t},o.prototype.multiply=function(e){var t=s();return this.multiplyTo(e,t),t},o.prototype.divide=function(e){var t=s();return this.divRemTo(e,t,null),t},o.prototype.remainder=function(e){var t=s();return this.divRemTo(e,null,t),t},o.prototype.divideAndRemainder=function(e){var t=s(),n=s();return this.divRemTo(e,t,n),new Array(t,n)},o.prototype.modPow=function(e,t){var n,r,i=e.bitLength(),o=p(1);if(i<=0)return o;n=i<18?1:i<48?3:i<144?4:i<768?5:6,r=i<8?new y(t):t.isEven()?new C(t):new m(t);var a=new Array,c=3,l=n-1,u=(1<<n)-1;if(a[1]=r.convert(this),n>1){var h=s();for(r.sqrTo(a[1],h);c<=u;)a[c]=s(),r.mulTo(h,a[c-2],a[c]),c+=2}var d,f,v=e.t-1,b=!0,w=s();for(i=g(e.data[v])-1;v>=0;){for(i>=l?d=e.data[v]>>i-l&u:(d=(e.data[v]&(1<<i+1)-1)<<l-i,v>0&&(d|=e.data[v-1]>>this.DB+i-l)),c=n;0==(1&d);)d>>=1,--c;if((i-=c)<0&&(i+=this.DB,--v),b)a[d].copyTo(o),b=!1;else{for(;c>1;)r.sqrTo(o,w),r.sqrTo(w,o),c-=2;c>0?r.sqrTo(o,w):(f=o,o=w,w=f),r.mulTo(w,a[d],o)}for(;v>=0&&0==(e.data[v]&1<<i);)r.sqrTo(o,w),f=o,o=w,w=f,--i<0&&(i=this.DB-1,--v)}return r.revert(o)},o.prototype.modInverse=function(e){var t=e.isEven();if(this.isEven()&&t||0==e.signum())return o.ZERO;for(var n=e.clone(),r=this.clone(),i=p(1),s=p(0),a=p(0),c=p(1);0!=n.signum();){for(;n.isEven();)n.rShiftTo(1,n),t?(i.isEven()&&s.isEven()||(i.addTo(this,i),s.subTo(e,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(e,s),s.rShiftTo(1,s);for(;r.isEven();)r.rShiftTo(1,r),t?(a.isEven()&&c.isEven()||(a.addTo(this,a),c.subTo(e,c)),a.rShiftTo(1,a)):c.isEven()||c.subTo(e,c),c.rShiftTo(1,c);n.compareTo(r)>=0?(n.subTo(r,n),t&&i.subTo(a,i),s.subTo(c,s)):(r.subTo(n,r),t&&a.subTo(i,a),c.subTo(s,c))}return 0!=r.compareTo(o.ONE)?o.ZERO:c.compareTo(e)>=0?c.subtract(e):c.signum()<0?(c.addTo(e,c),c.signum()<0?c.add(e):c):c},o.prototype.pow=function(e){return this.exp(e,new _)},o.prototype.gcd=function(e){var t=this.s<0?this.negate():this.clone(),n=e.s<0?e.negate():e.clone();if(t.compareTo(n)<0){var r=t;t=n,n=r}var i=t.getLowestSetBit(),o=n.getLowestSetBit();if(o<0)return t;for(i<o&&(o=i),o>0&&(t.rShiftTo(o,t),n.rShiftTo(o,n));t.signum()>0;)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=n.getLowestSetBit())>0&&n.rShiftTo(i,n),t.compareTo(n)>=0?(t.subTo(n,t),t.rShiftTo(1,t)):(n.subTo(t,n),n.rShiftTo(1,n));return o>0&&n.lShiftTo(o,n),n},o.prototype.isProbablePrime=function(e){var t,n=this.abs();if(1==n.t&&n.data[0]<=T[T.length-1]){for(t=0;t<T.length;++t)if(n.data[0]==T[t])return!0;return!1}if(n.isEven())return!1;for(t=1;t<T.length;){for(var r=T[t],i=t+1;i<T.length&&r<k;)r*=T[i++];for(r=n.modInt(r);t<i;)if(r%T[t++]==0)return!1}return n.millerRabin(e)}},10029:(e,t,n)=>{var r=n(60392);e.exports=r.md=r.md||{},r.md.algorithms=r.md.algorithms||{}},72886:(e,t,n)=>{var r=n(60392);r.pki=r.pki||{};var i=e.exports=r.pki.oids=r.oids=r.oids||{};function o(e,t){i[e]=t,i[t]=e}function s(e,t){i[e]=t}o("1.2.840.113549.1.1.1","rsaEncryption"),o("1.2.840.113549.1.1.4","md5WithRSAEncryption"),o("1.2.840.113549.1.1.5","sha1WithRSAEncryption"),o("1.2.840.113549.1.1.7","RSAES-OAEP"),o("1.2.840.113549.1.1.8","mgf1"),o("1.2.840.113549.1.1.9","pSpecified"),o("1.2.840.113549.1.1.10","RSASSA-PSS"),o("1.2.840.113549.1.1.11","sha256WithRSAEncryption"),o("1.2.840.113549.1.1.12","sha384WithRSAEncryption"),o("1.2.840.113549.1.1.13","sha512WithRSAEncryption"),o("1.3.101.112","EdDSA25519"),o("1.2.840.10040.4.3","dsa-with-sha1"),o("1.3.14.3.2.7","desCBC"),o("1.3.14.3.2.26","sha1"),o("1.3.14.3.2.29","sha1WithRSASignature"),o("2.16.840.1.101.3.4.2.1","sha256"),o("2.16.840.1.101.3.4.2.2","sha384"),o("2.16.840.1.101.3.4.2.3","sha512"),o("2.16.840.1.101.3.4.2.4","sha224"),o("2.16.840.1.101.3.4.2.5","sha512-224"),o("2.16.840.1.101.3.4.2.6","sha512-256"),o("1.2.840.113549.2.2","md2"),o("1.2.840.113549.2.5","md5"),o("1.2.840.113549.1.7.1","data"),o("1.2.840.113549.1.7.2","signedData"),o("1.2.840.113549.1.7.3","envelopedData"),o("1.2.840.113549.1.7.4","signedAndEnvelopedData"),o("1.2.840.113549.1.7.5","digestedData"),o("1.2.840.113549.1.7.6","encryptedData"),o("1.2.840.113549.1.9.1","emailAddress"),o("1.2.840.113549.1.9.2","unstructuredName"),o("1.2.840.113549.1.9.3","contentType"),o("1.2.840.113549.1.9.4","messageDigest"),o("1.2.840.113549.1.9.5","signingTime"),o("1.2.840.113549.1.9.6","counterSignature"),o("1.2.840.113549.1.9.7","challengePassword"),o("1.2.840.113549.1.9.8","unstructuredAddress"),o("1.2.840.113549.1.9.14","extensionRequest"),o("1.2.840.113549.1.9.20","friendlyName"),o("1.2.840.113549.1.9.21","localKeyId"),o("1.2.840.113549.1.9.22.1","x509Certificate"),o("1.2.840.113549.1.12.10.1.1","keyBag"),o("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag"),o("1.2.840.113549.1.12.10.1.3","certBag"),o("1.2.840.113549.1.12.10.1.4","crlBag"),o("1.2.840.113549.1.12.10.1.5","secretBag"),o("1.2.840.113549.1.12.10.1.6","safeContentsBag"),o("1.2.840.113549.1.5.13","pkcs5PBES2"),o("1.2.840.113549.1.5.12","pkcs5PBKDF2"),o("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4"),o("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4"),o("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC"),o("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC"),o("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC"),o("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC"),o("1.2.840.113549.2.7","hmacWithSHA1"),o("1.2.840.113549.2.8","hmacWithSHA224"),o("1.2.840.113549.2.9","hmacWithSHA256"),o("1.2.840.113549.2.10","hmacWithSHA384"),o("1.2.840.113549.2.11","hmacWithSHA512"),o("1.2.840.113549.3.7","des-EDE3-CBC"),o("2.16.840.1.101.3.4.1.2","aes128-CBC"),o("2.16.840.1.101.3.4.1.22","aes192-CBC"),o("2.16.840.1.101.3.4.1.42","aes256-CBC"),o("2.5.4.3","commonName"),o("2.5.4.4","surname"),o("2.5.4.5","serialNumber"),o("2.5.4.6","countryName"),o("2.5.4.7","localityName"),o("2.5.4.8","stateOrProvinceName"),o("2.5.4.9","streetAddress"),o("2.5.4.10","organizationName"),o("2.5.4.11","organizationalUnitName"),o("2.5.4.12","title"),o("2.5.4.13","description"),o("2.5.4.15","businessCategory"),o("2.5.4.17","postalCode"),o("2.5.4.42","givenName"),o("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName"),o("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName"),o("2.16.840.1.113730.1.1","nsCertType"),o("2.16.840.1.113730.1.13","nsComment"),s("2.5.29.1","authorityKeyIdentifier"),s("2.5.29.2","keyAttributes"),s("2.5.29.3","certificatePolicies"),s("2.5.29.4","keyUsageRestriction"),s("2.5.29.5","policyMapping"),s("2.5.29.6","subtreesConstraint"),s("2.5.29.7","subjectAltName"),s("2.5.29.8","issuerAltName"),s("2.5.29.9","subjectDirectoryAttributes"),s("2.5.29.10","basicConstraints"),s("2.5.29.11","nameConstraints"),s("2.5.29.12","policyConstraints"),s("2.5.29.13","basicConstraints"),o("2.5.29.14","subjectKeyIdentifier"),o("2.5.29.15","keyUsage"),s("2.5.29.16","privateKeyUsagePeriod"),o("2.5.29.17","subjectAltName"),o("2.5.29.18","issuerAltName"),o("2.5.29.19","basicConstraints"),s("2.5.29.20","cRLNumber"),s("2.5.29.21","cRLReason"),s("2.5.29.22","expirationDate"),s("2.5.29.23","instructionCode"),s("2.5.29.24","invalidityDate"),s("2.5.29.25","cRLDistributionPoints"),s("2.5.29.26","issuingDistributionPoint"),s("2.5.29.27","deltaCRLIndicator"),s("2.5.29.28","issuingDistributionPoint"),s("2.5.29.29","certificateIssuer"),s("2.5.29.30","nameConstraints"),o("2.5.29.31","cRLDistributionPoints"),o("2.5.29.32","certificatePolicies"),s("2.5.29.33","policyMappings"),s("2.5.29.34","policyConstraints"),o("2.5.29.35","authorityKeyIdentifier"),s("2.5.29.36","policyConstraints"),o("2.5.29.37","extKeyUsage"),s("2.5.29.46","freshestCRL"),s("2.5.29.54","inhibitAnyPolicy"),o("1.3.6.1.4.1.11129.2.4.2","timestampList"),o("1.3.6.1.5.5.7.1.1","authorityInfoAccess"),o("1.3.6.1.5.5.7.3.1","serverAuth"),o("1.3.6.1.5.5.7.3.2","clientAuth"),o("1.3.6.1.5.5.7.3.3","codeSigning"),o("1.3.6.1.5.5.7.3.4","emailProtection"),o("1.3.6.1.5.5.7.3.8","timeStamping")},29835:(e,t,n)=>{var r=n(60392);if(n(18605),n(85049),n(71400),n(10029),n(72886),n(16019),n(16193),n(33860),n(50654),n(25493),n(63877),"undefined"===typeof i)var i=r.jsbn.BigInteger;var o=r.asn1,s=r.pki=r.pki||{};e.exports=s.pbe=r.pbe=r.pbe||{};var a=s.oids,c={name:"EncryptedPrivateKeyInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},l={name:"PBES2Algorithms",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},u={name:"pkcs-12PbeParams",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"iterations"}]};function h(e,t){return e.start().update(t).digest().getBytes()}function d(e){var t;if(e){if(!(t=s.oids[o.derToOid(e)])){var n=new Error("Unsupported PRF OID.");throw n.oid=e,n.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],n}}else t="hmacWithSHA1";return f(t)}function f(e){var t=r.md;switch(e){case"hmacWithSHA224":t=r.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":e=e.substr(8).toLowerCase();break;default:var n=new Error("Unsupported PRF algorithm.");throw n.algorithm=e,n.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],n}if(!t||!(e in t))throw new Error("Unknown hash algorithm: "+e);return t[e].create()}s.encryptPrivateKeyInfo=function(e,t,n){(n=n||{}).saltSize=n.saltSize||8,n.count=n.count||2048,n.algorithm=n.algorithm||"aes128",n.prfAlgorithm=n.prfAlgorithm||"sha1";var i,c,l,u=r.random.getBytesSync(n.saltSize),h=n.count,d=o.integerToDer(h);if(0===n.algorithm.indexOf("aes")||"des"===n.algorithm){var p,g,y;switch(n.algorithm){case"aes128":i=16,p=16,g=a["aes128-CBC"],y=r.aes.createEncryptionCipher;break;case"aes192":i=24,p=16,g=a["aes192-CBC"],y=r.aes.createEncryptionCipher;break;case"aes256":i=32,p=16,g=a["aes256-CBC"],y=r.aes.createEncryptionCipher;break;case"des":i=8,p=8,g=a.desCBC,y=r.des.createEncryptionCipher;break;default:throw(A=new Error("Cannot encrypt private key. Unknown encryption algorithm.")).algorithm=n.algorithm,A}var m="hmacWith"+n.prfAlgorithm.toUpperCase(),v=f(m),b=r.pkcs5.pbkdf2(t,u,h,i,v),w=r.random.getBytesSync(p);(S=y(b)).start(w),S.update(o.toDer(e)),S.finish(),l=S.output.getBytes();var E=function(e,t,n,i){var a=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,e),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,t.getBytes())]);"hmacWithSHA1"!==i&&a.value.push(o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,r.util.hexToBytes(n.toString(16))),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(s.oids[i]).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")]));return a}(u,d,i,m);c=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(a.pkcs5PBES2).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(a.pkcs5PBKDF2).getBytes()),E]),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(g).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,w)])])])}else{var A;if("3des"!==n.algorithm)throw(A=new Error("Cannot encrypt private key. Unknown encryption algorithm.")).algorithm=n.algorithm,A;i=24;var S,_=new r.util.ByteBuffer(u);b=s.pbe.generatePkcs12Key(t,_,1,h,i),w=s.pbe.generatePkcs12Key(t,_,2,h,i);(S=r.des.createEncryptionCipher(b)).start(w),S.update(o.toDer(e)),S.finish(),l=S.output.getBytes(),c=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(a["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,u),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,d.getBytes())])])}return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[c,o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,l)])},s.decryptPrivateKeyInfo=function(e,t){var n=null,i={},a=[];if(!o.validate(e,c,i,a)){var l=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw l.errors=a,l}var u=o.derToOid(i.encryptionOid),h=s.pbe.getCipher(u,i.encryptionParams,t),d=r.util.createBuffer(i.encryptedData);return h.update(d),h.finish()&&(n=o.fromDer(h.output)),n},s.encryptedPrivateKeyToPem=function(e,t){var n={type:"ENCRYPTED PRIVATE KEY",body:o.toDer(e).getBytes()};return r.pem.encode(n,{maxline:t})},s.encryptedPrivateKeyFromPem=function(e){var t=r.pem.decode(e)[0];if("ENCRYPTED PRIVATE KEY"!==t.type){var n=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw n.headerType=t.type,n}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return o.fromDer(t.body)},s.encryptRsaPrivateKey=function(e,t,n){if(!(n=n||{}).legacy){var i=s.wrapRsaPrivateKey(s.privateKeyToAsn1(e));return i=s.encryptPrivateKeyInfo(i,t,n),s.encryptedPrivateKeyToPem(i)}var a,c,l,u;switch(n.algorithm){case"aes128":a="AES-128-CBC",l=16,c=r.random.getBytesSync(16),u=r.aes.createEncryptionCipher;break;case"aes192":a="AES-192-CBC",l=24,c=r.random.getBytesSync(16),u=r.aes.createEncryptionCipher;break;case"aes256":a="AES-256-CBC",l=32,c=r.random.getBytesSync(16),u=r.aes.createEncryptionCipher;break;case"3des":a="DES-EDE3-CBC",l=24,c=r.random.getBytesSync(8),u=r.des.createEncryptionCipher;break;case"des":a="DES-CBC",l=8,c=r.random.getBytesSync(8),u=r.des.createEncryptionCipher;break;default:var h=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+n.algorithm+'".');throw h.algorithm=n.algorithm,h}var d=u(r.pbe.opensslDeriveBytes(t,c.substr(0,8),l));d.start(c),d.update(o.toDer(s.privateKeyToAsn1(e))),d.finish();var f={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:a,parameters:r.util.bytesToHex(c).toUpperCase()},body:d.output.getBytes()};return r.pem.encode(f)},s.decryptRsaPrivateKey=function(e,t){var n=null,i=r.pem.decode(e)[0];if("ENCRYPTED PRIVATE KEY"!==i.type&&"PRIVATE KEY"!==i.type&&"RSA PRIVATE KEY"!==i.type)throw(l=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".')).headerType=l,l;if(i.procType&&"ENCRYPTED"===i.procType.type){var a,c;switch(i.dekInfo.algorithm){case"DES-CBC":a=8,c=r.des.createDecryptionCipher;break;case"DES-EDE3-CBC":a=24,c=r.des.createDecryptionCipher;break;case"AES-128-CBC":a=16,c=r.aes.createDecryptionCipher;break;case"AES-192-CBC":a=24,c=r.aes.createDecryptionCipher;break;case"AES-256-CBC":a=32,c=r.aes.createDecryptionCipher;break;case"RC2-40-CBC":a=5,c=function(e){return r.rc2.createDecryptionCipher(e,40)};break;case"RC2-64-CBC":a=8,c=function(e){return r.rc2.createDecryptionCipher(e,64)};break;case"RC2-128-CBC":a=16,c=function(e){return r.rc2.createDecryptionCipher(e,128)};break;default:var l;throw(l=new Error('Could not decrypt private key; unsupported encryption algorithm "'+i.dekInfo.algorithm+'".')).algorithm=i.dekInfo.algorithm,l}var u=r.util.hexToBytes(i.dekInfo.parameters),h=c(r.pbe.opensslDeriveBytes(t,u.substr(0,8),a));if(h.start(u),h.update(r.util.createBuffer(i.body)),!h.finish())return n;n=h.output.getBytes()}else n=i.body;return null!==(n="ENCRYPTED PRIVATE KEY"===i.type?s.decryptPrivateKeyInfo(o.fromDer(n),t):o.fromDer(n))&&(n=s.privateKeyFromAsn1(n)),n},s.pbe.generatePkcs12Key=function(e,t,n,i,o,s){var a,c;if("undefined"===typeof s||null===s){if(!("sha1"in r.md))throw new Error('"sha1" hash algorithm unavailable.');s=r.md.sha1.create()}var l=s.digestLength,u=s.blockLength,h=new r.util.ByteBuffer,d=new r.util.ByteBuffer;if(null!==e&&void 0!==e){for(c=0;c<e.length;c++)d.putInt16(e.charCodeAt(c));d.putInt16(0)}var f=d.length(),p=t.length(),g=new r.util.ByteBuffer;g.fillWithByte(n,u);var y=u*Math.ceil(p/u),m=new r.util.ByteBuffer;for(c=0;c<y;c++)m.putByte(t.at(c%p));var v=u*Math.ceil(f/u),b=new r.util.ByteBuffer;for(c=0;c<v;c++)b.putByte(d.at(c%f));var w=m;w.putBuffer(b);for(var E=Math.ceil(o/l),A=1;A<=E;A++){var S=new r.util.ByteBuffer;S.putBytes(g.bytes()),S.putBytes(w.bytes());for(var _=0;_<i;_++)s.start(),s.update(S.getBytes()),S=s.digest();var I=new r.util.ByteBuffer;for(c=0;c<u;c++)I.putByte(S.at(c%l));var C=Math.ceil(p/u)+Math.ceil(f/u),T=new r.util.ByteBuffer;for(a=0;a<C;a++){var k=new r.util.ByteBuffer(w.getBytes(u)),R=511;for(c=I.length()-1;c>=0;c--)R>>=8,R+=I.at(c)+k.at(c),k.setAt(c,255&R);T.putBuffer(k)}w=T,h.putBuffer(S)}return h.truncate(h.length()-o),h},s.pbe.getCipher=function(e,t,n){switch(e){case s.oids.pkcs5PBES2:return s.pbe.getCipherForPBES2(e,t,n);case s.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case s.oids["pbewithSHAAnd40BitRC2-CBC"]:return s.pbe.getCipherForPKCS12PBE(e,t,n);default:var r=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw r.oid=e,r.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],r}},s.pbe.getCipherForPBES2=function(e,t,n){var i,a={},c=[];if(!o.validate(t,l,a,c))throw(i=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.")).errors=c,i;if((e=o.derToOid(a.kdfOid))!==s.oids.pkcs5PBKDF2)throw(i=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.")).oid=e,i.supportedOids=["pkcs5PBKDF2"],i;if((e=o.derToOid(a.encOid))!==s.oids["aes128-CBC"]&&e!==s.oids["aes192-CBC"]&&e!==s.oids["aes256-CBC"]&&e!==s.oids["des-EDE3-CBC"]&&e!==s.oids.desCBC)throw(i=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.")).oid=e,i.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],i;var u,h,f=a.kdfSalt,p=r.util.createBuffer(a.kdfIterationCount);switch(p=p.getInt(p.length()<<3),s.oids[e]){case"aes128-CBC":u=16,h=r.aes.createDecryptionCipher;break;case"aes192-CBC":u=24,h=r.aes.createDecryptionCipher;break;case"aes256-CBC":u=32,h=r.aes.createDecryptionCipher;break;case"des-EDE3-CBC":u=24,h=r.des.createDecryptionCipher;break;case"desCBC":u=8,h=r.des.createDecryptionCipher}var g=d(a.prfOid),y=r.pkcs5.pbkdf2(n,f,p,u,g),m=a.encIv,v=h(y);return v.start(m),v},s.pbe.getCipherForPKCS12PBE=function(e,t,n){var i={},a=[];if(!o.validate(t,u,i,a))throw(g=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.")).errors=a,g;var c,l,h,f=r.util.createBuffer(i.salt),p=r.util.createBuffer(i.iterations);switch(p=p.getInt(p.length()<<3),e){case s.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:c=24,l=8,h=r.des.startDecrypting;break;case s.oids["pbewithSHAAnd40BitRC2-CBC"]:c=5,l=8,h=function(e,t){var n=r.rc2.createDecryptionCipher(e,40);return n.start(t,null),n};break;default:var g;throw(g=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.")).oid=e,g}var y=d(i.prfOid),m=s.pbe.generatePkcs12Key(n,f,1,p,c,y);return y.start(),h(m,s.pbe.generatePkcs12Key(n,f,2,p,l,y))},s.pbe.opensslDeriveBytes=function(e,t,n,i){if("undefined"===typeof i||null===i){if(!("md5"in r.md))throw new Error('"md5" hash algorithm unavailable.');i=r.md.md5.create()}null===t&&(t="");for(var o=[h(i,e+t)],s=16,a=1;s<n;++a,s+=16)o.push(h(i,o[a-1]+e+t));return o.join("").substr(0,n)}},16019:(e,t,n)=>{var r=n(62678).Buffer,i=n(60392);n(70878),n(10029),n(63877);var o,s=i.pkcs5=i.pkcs5||{};i.util.isNodejs&&!i.options.usePureJavaScript&&(o=n(25819)),e.exports=i.pbkdf2=s.pbkdf2=function(e,t,n,s,a,c){if("function"===typeof a&&(c=a,a=null),i.util.isNodejs&&!i.options.usePureJavaScript&&o.pbkdf2&&(null===a||"object"!==typeof a)&&(o.pbkdf2Sync.length>4||!a||"sha1"===a))return"string"!==typeof a&&(a="sha1"),e=r.from(e,"binary"),t=r.from(t,"binary"),c?4===o.pbkdf2Sync.length?o.pbkdf2(e,t,n,s,(function(e,t){if(e)return c(e);c(null,t.toString("binary"))})):o.pbkdf2(e,t,n,s,a,(function(e,t){if(e)return c(e);c(null,t.toString("binary"))})):4===o.pbkdf2Sync.length?o.pbkdf2Sync(e,t,n,s).toString("binary"):o.pbkdf2Sync(e,t,n,s,a).toString("binary");if("undefined"!==typeof a&&null!==a||(a="sha1"),"string"===typeof a){if(!(a in i.md.algorithms))throw new Error("Unknown hash algorithm: "+a);a=i.md[a].create()}var l=a.digestLength;if(s>4294967295*l){var u=new Error("Derived key is too long.");if(c)return c(u);throw u}var h=Math.ceil(s/l),d=s-(h-1)*l,f=i.hmac.create();f.start(a,e);var p,g,y,m="";if(!c){for(var v=1;v<=h;++v){f.start(null,null),f.update(t),f.update(i.util.int32ToBytes(v)),p=y=f.digest().getBytes();for(var b=2;b<=n;++b)f.start(null,null),f.update(y),g=f.digest().getBytes(),p=i.util.xorBytes(p,g,l),y=g;m+=v<h?p:p.substr(0,d)}return m}v=1;function w(){if(v>h)return c(null,m);f.start(null,null),f.update(t),f.update(i.util.int32ToBytes(v)),p=y=f.digest().getBytes(),b=2,E()}function E(){if(b<=n)return f.start(null,null),f.update(y),g=f.digest().getBytes(),p=i.util.xorBytes(p,g,l),y=g,++b,i.util.setImmediate(E);m+=v<h?p:p.substr(0,d),++v,w()}w()}},16193:(e,t,n)=>{var r=n(60392);n(63877);var i=e.exports=r.pem=r.pem||{};function o(e){for(var t=e.name+": ",n=[],r=function(e,t){return" "+t},i=0;i<e.values.length;++i)n.push(e.values[i].replace(/^(\S+\r\n)/,r));t+=n.join(",")+"\r\n";var o=0,s=-1;for(i=0;i<t.length;++i,++o)if(o>65&&-1!==s){var a=t[s];","===a?(++s,t=t.substr(0,s)+"\r\n "+t.substr(s)):t=t.substr(0,s)+"\r\n"+a+t.substr(s+1),o=i-s-1,s=-1,++i}else" "!==t[i]&&"\t"!==t[i]&&","!==t[i]||(s=i);return t}function s(e){return e.replace(/^\s+/,"")}i.encode=function(e,t){t=t||{};var n,i="-----BEGIN "+e.type+"-----\r\n";if(e.procType&&(i+=o(n={name:"Proc-Type",values:[String(e.procType.version),e.procType.type]})),e.contentDomain&&(i+=o(n={name:"Content-Domain",values:[e.contentDomain]})),e.dekInfo&&(n={name:"DEK-Info",values:[e.dekInfo.algorithm]},e.dekInfo.parameters&&n.values.push(e.dekInfo.parameters),i+=o(n)),e.headers)for(var s=0;s<e.headers.length;++s)i+=o(e.headers[s]);return e.procType&&(i+="\r\n"),i+=r.util.encode64(e.body,t.maxline||64)+"\r\n",i+="-----END "+e.type+"-----\r\n"},i.decode=function(e){for(var t,n=[],i=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,o=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,a=/\r?\n/;t=i.exec(e);){var c=t[1];"NEW CERTIFICATE REQUEST"===c&&(c="CERTIFICATE REQUEST");var l={type:c,procType:null,contentDomain:null,dekInfo:null,headers:[],body:r.util.decode64(t[3])};if(n.push(l),t[2]){for(var u=t[2].split(a),h=0;t&&h<u.length;){for(var d=u[h].replace(/\s+$/,""),f=h+1;f<u.length;++f){var p=u[f];if(!/\s/.test(p[0]))break;d+=p,h=f}if(t=d.match(o)){for(var g={name:t[1],values:[]},y=t[2].split(","),m=0;m<y.length;++m)g.values.push(s(y[m]));if(l.procType)if(l.contentDomain||"Content-Domain"!==g.name)if(l.dekInfo||"DEK-Info"!==g.name)l.headers.push(g);else{if(0===g.values.length)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');l.dekInfo={algorithm:y[0],parameters:y[1]||null}}else l.contentDomain=y[0]||"";else{if("Proc-Type"!==g.name)throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(2!==g.values.length)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');l.procType={version:y[0],type:y[1]}}}++h}if("ENCRYPTED"===l.procType&&!l.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(0===n.length)throw new Error("Invalid PEM formatted message.");return n}},22627:(e,t,n)=>{var r=n(60392);n(63877),n(33860),n(50928);var i=e.exports=r.pkcs1=r.pkcs1||{};function o(e,t,n){n||(n=r.md.sha1.create());for(var i="",o=Math.ceil(t/n.digestLength),s=0;s<o;++s){var a=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,255&s);n.start(),n.update(e+a),i+=n.digest().getBytes()}return i.substring(0,t)}i.encode_rsa_oaep=function(e,t,n){var i,s,a,c;"string"===typeof n?(i=n,s=arguments[3]||void 0,a=arguments[4]||void 0):n&&(i=n.label||void 0,s=n.seed||void 0,a=n.md||void 0,n.mgf1&&n.mgf1.md&&(c=n.mgf1.md)),a?a.start():a=r.md.sha1.create(),c||(c=a);var l=Math.ceil(e.n.bitLength()/8),u=l-2*a.digestLength-2;if(t.length>u)throw(y=new Error("RSAES-OAEP input message length is too long.")).length=t.length,y.maxLength=u,y;i||(i=""),a.update(i,"raw");for(var h=a.digest(),d="",f=u-t.length,p=0;p<f;p++)d+="\0";var g=h.getBytes()+d+"\x01"+t;if(s){if(s.length!==a.digestLength){var y;throw(y=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.")).seedLength=s.length,y.digestLength=a.digestLength,y}}else s=r.random.getBytes(a.digestLength);var m=o(s,l-a.digestLength-1,c),v=r.util.xorBytes(g,m,g.length),b=o(v,a.digestLength,c);return"\0"+r.util.xorBytes(s,b,s.length)+v},i.decode_rsa_oaep=function(e,t,n){var i,s,a;"string"===typeof n?(i=n,s=arguments[3]||void 0):n&&(i=n.label||void 0,s=n.md||void 0,n.mgf1&&n.mgf1.md&&(a=n.mgf1.md));var c=Math.ceil(e.n.bitLength()/8);if(t.length!==c)throw(m=new Error("RSAES-OAEP encoded message length is invalid.")).length=t.length,m.expectedLength=c,m;if(void 0===s?s=r.md.sha1.create():s.start(),a||(a=s),c<2*s.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");i||(i=""),s.update(i,"raw");for(var l=s.digest().getBytes(),u=t.charAt(0),h=t.substring(1,s.digestLength+1),d=t.substring(1+s.digestLength),f=o(d,s.digestLength,a),p=o(r.util.xorBytes(h,f,h.length),c-s.digestLength-1,a),g=r.util.xorBytes(d,p,d.length),y=g.substring(0,s.digestLength),m="\0"!==u,v=0;v<s.digestLength;++v)m|=l.charAt(v)!==y.charAt(v);for(var b=1,w=s.digestLength,E=s.digestLength;E<g.length;E++){var A=g.charCodeAt(E);m|=A&(b?65534:0),w+=b&=1&A^1}if(m||1!==g.charCodeAt(w))throw new Error("Invalid RSAES-OAEP padding.");return g.substring(w+1)}},5132:(e,t,n)=>{var r=n(60392);n(63877),n(3055),n(33860),function(){if(r.prime)e.exports=r.prime;else{var t=e.exports=r.prime=r.prime||{},n=r.jsbn.BigInteger,i=[6,4,2,4,2,4,6,2],o=new n(null);o.fromInt(30);var s=function(e,t){return e|t};t.generateProbablePrime=function(e,t,i){"function"===typeof t&&(i=t,t={});var o=(t=t||{}).algorithm||"PRIMEINC";"string"===typeof o&&(o={name:o}),o.options=o.options||{};var s=t.prng||r.random,c={nextBytes:function(e){for(var t=s.getBytesSync(e.length),n=0;n<e.length;++n)e[n]=t.charCodeAt(n)}};if("PRIMEINC"===o.name)return function(e,t,i,o){if("workers"in i)return function(e,t,i,o){if("undefined"===typeof Worker)return a(e,t,i,o);var s=l(e,t),c=i.workers,u=i.workLoad||100,h=30*u/8,d=i.workerScript||"forge/prime.worker.js";if(-1===c)return r.util.estimateCores((function(e,t){e&&(t=2),c=t-1,f()}));function f(){c=Math.max(1,c);for(var r=[],i=0;i<c;++i)r[i]=new Worker(d);for(i=0;i<c;++i)r[i].addEventListener("message",f);var a=!1;function f(i){if(!a){0;var c=i.data;if(c.found){for(var d=0;d<r.length;++d)r[d].terminate();return a=!0,o(null,new n(c.prime,16))}s.bitLength()>e&&(s=l(e,t));var f=s.toString(16);i.target.postMessage({hex:f,workLoad:u}),s.dAddOffset(h,0)}}}f()}(e,t,i,o);return a(e,t,i,o)}(e,c,o.options,i);throw new Error("Invalid prime generation algorithm: "+o.name)}}function a(e,t,n,r){var i=l(e,t),o=function(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}(i.bitLength());"millerRabinTests"in n&&(o=n.millerRabinTests);var s=10;"maxBlockTime"in n&&(s=n.maxBlockTime),c(i,e,t,0,o,s,r)}function c(e,t,n,o,s,a,u){var h=+new Date;do{if(e.bitLength()>t&&(e=l(t,n)),e.isProbablePrime(s))return u(null,e);e.dAddOffset(i[o++%8],0)}while(a<0||+new Date-h<a);r.util.setImmediate((function(){c(e,t,n,o,s,a,u)}))}function l(e,t){var r=new n(e,t),i=e-1;return r.testBit(i)||r.bitwiseTo(n.ONE.shiftLeft(i),s,r),r.dAddOffset(31-r.mod(o).byteValue(),0),r}}()},6140:(e,t,n)=>{var r=n(1426),i=n(60392);n(63877);var o=null;!i.util.isNodejs||i.options.usePureJavaScript||r.versions["node-webkit"]||(o=n(25819)),(e.exports=i.prng=i.prng||{}).create=function(e){for(var t={plugin:e,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},n=e.md,r=new Array(32),s=0;s<32;++s)r[s]=n.create();function a(){if(t.pools[0].messageLength>=32)return c();var e=32-t.pools[0].messageLength<<5;t.collect(t.seedFileSync(e)),c()}function c(){t.reseeds=4294967295===t.reseeds?0:t.reseeds+1;var e=t.plugin.md.create();e.update(t.keyBytes);for(var n=1,r=0;r<32;++r)t.reseeds%n===0&&(e.update(t.pools[r].digest().getBytes()),t.pools[r].start()),n<<=1;t.keyBytes=e.digest().getBytes(),e.start(),e.update(t.keyBytes);var i=e.digest().getBytes();t.key=t.plugin.formatKey(t.keyBytes),t.seed=t.plugin.formatSeed(i),t.generated=0}function l(e){var t=null,n=i.util.globalScope,r=n.crypto||n.msCrypto;r&&r.getRandomValues&&(t=function(e){return r.getRandomValues(e)});var o=i.util.createBuffer();if(t)for(;o.length()<e;){var s=Math.max(1,Math.min(e-o.length(),65536)/4),a=new Uint32Array(Math.floor(s));try{t(a);for(var c=0;c<a.length;++c)o.putInt32(a[c])}catch(f){if(!("undefined"!==typeof QuotaExceededError&&f instanceof QuotaExceededError))throw f}}if(o.length()<e)for(var l,u,h,d=Math.floor(65536*Math.random());o.length()<e;){u=16807*(65535&d),u+=(32767&(l=16807*(d>>16)))<<16,d=4294967295&(u=(2147483647&(u+=l>>15))+(u>>31));for(c=0;c<3;++c)h=d>>>(c<<3),h^=Math.floor(256*Math.random()),o.putByte(255&h)}return o.getBytes(e)}return t.pools=r,t.pool=0,t.generate=function(e,n){if(!n)return t.generateSync(e);var r=t.plugin.cipher,o=t.plugin.increment,s=t.plugin.formatKey,a=t.plugin.formatSeed,l=i.util.createBuffer();t.key=null,function u(h){if(h)return n(h);if(l.length()>=e)return n(null,l.getBytes(e));t.generated>1048575&&(t.key=null);if(null===t.key)return i.util.nextTick((function(){!function(e){if(t.pools[0].messageLength>=32)return c(),e();var n=32-t.pools[0].messageLength<<5;t.seedFile(n,(function(n,r){if(n)return e(n);t.collect(r),c(),e()}))}(u)}));var d=r(t.key,t.seed);t.generated+=d.length,l.putBytes(d),t.key=s(r(t.key,o(t.seed))),t.seed=a(r(t.key,t.seed)),i.util.setImmediate(u)}()},t.generateSync=function(e){var n=t.plugin.cipher,r=t.plugin.increment,o=t.plugin.formatKey,s=t.plugin.formatSeed;t.key=null;for(var c=i.util.createBuffer();c.length()<e;){t.generated>1048575&&(t.key=null),null===t.key&&a();var l=n(t.key,t.seed);t.generated+=l.length,c.putBytes(l),t.key=o(n(t.key,r(t.seed))),t.seed=s(n(t.key,t.seed))}return c.getBytes(e)},o?(t.seedFile=function(e,t){o.randomBytes(e,(function(e,n){if(e)return t(e);t(null,n.toString())}))},t.seedFileSync=function(e){return o.randomBytes(e).toString()}):(t.seedFile=function(e,t){try{t(null,l(e))}catch(n){t(n)}},t.seedFileSync=l),t.collect=function(e){for(var n=e.length,r=0;r<n;++r)t.pools[t.pool].update(e.substr(r,1)),t.pool=31===t.pool?0:t.pool+1},t.collectInt=function(e,n){for(var r="",i=0;i<n;i+=8)r+=String.fromCharCode(e>>i&255);t.collect(r)},t.registerWorker=function(e){if(e===self)t.seedFile=function(e,t){self.addEventListener("message",(function e(n){var r=n.data;r.forge&&r.forge.prng&&(self.removeEventListener("message",e),t(r.forge.prng.err,r.forge.prng.bytes))})),self.postMessage({forge:{prng:{needed:e}}})};else{e.addEventListener("message",(function(n){var r=n.data;r.forge&&r.forge.prng&&t.seedFile(r.forge.prng.needed,(function(t,n){e.postMessage({forge:{prng:{err:t,bytes:n}}})}))}))}},t}},33860:(e,t,n)=>{var r=n(60392);n(18605),n(77404),n(6140),n(63877),r.random&&r.random.getBytes?e.exports=r.random:function(t){var n={},i=new Array(4),o=r.util.createBuffer();function s(){var e=r.prng.create(n);return e.getBytes=function(t,n){return e.generate(t,n)},e.getBytesSync=function(t){return e.generate(t)},e}n.formatKey=function(e){var t=r.util.createBuffer(e);return(e=new Array(4))[0]=t.getInt32(),e[1]=t.getInt32(),e[2]=t.getInt32(),e[3]=t.getInt32(),r.aes._expandKey(e,!1)},n.formatSeed=function(e){var t=r.util.createBuffer(e);return(e=new Array(4))[0]=t.getInt32(),e[1]=t.getInt32(),e[2]=t.getInt32(),e[3]=t.getInt32(),e},n.cipher=function(e,t){return r.aes._updateBlock(e,t,i,!1),o.putInt32(i[0]),o.putInt32(i[1]),o.putInt32(i[2]),o.putInt32(i[3]),o.getBytes()},n.increment=function(e){return++e[3],e},n.md=r.md.sha256;var a=s(),c=null,l=r.util.globalScope,u=l.crypto||l.msCrypto;if(u&&u.getRandomValues&&(c=function(e){return u.getRandomValues(e)}),r.options.usePureJavaScript||!r.util.isNodejs&&!c){if("undefined"===typeof window||window.document,a.collectInt(+new Date,32),"undefined"!==typeof navigator){var h="";for(var d in navigator)try{"string"==typeof navigator[d]&&(h+=navigator[d])}catch(f){}a.collect(h),h=null}t&&(t().mousemove((function(e){a.collectInt(e.clientX,16),a.collectInt(e.clientY,16)})),t().keypress((function(e){a.collectInt(e.charCode,8)})))}if(r.random)for(var d in a)r.random[d]=a[d];else r.random=a;r.random.createInstance=s,e.exports=r.random}("undefined"!==typeof jQuery?jQuery:null)},50654:(e,t,n)=>{var r=n(60392);n(63877);var i=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],o=[1,2,3,5],s=function(e,t){return e<<t&65535|(65535&e)>>16-t},a=function(e,t){return(65535&e)>>t|e<<16-t&65535};e.exports=r.rc2=r.rc2||{},r.rc2.expandKey=function(e,t){"string"===typeof e&&(e=r.util.createBuffer(e)),t=t||128;var n,o=e,s=e.length(),a=t,c=Math.ceil(a/8),l=255>>(7&a);for(n=s;n<128;n++)o.putByte(i[o.at(n-1)+o.at(n-s)&255]);for(o.setAt(128-c,i[o.at(128-c)&l]),n=127-c;n>=0;n--)o.setAt(n,i[o.at(n+1)^o.at(n+c)]);return o};var c=function(e,t,n){var i,c,l,u,h=!1,d=null,f=null,p=null,g=[];for(e=r.rc2.expandKey(e,t),l=0;l<64;l++)g.push(e.getInt16Le());n?(i=function(e){for(l=0;l<4;l++)e[l]+=g[u]+(e[(l+3)%4]&e[(l+2)%4])+(~e[(l+3)%4]&e[(l+1)%4]),e[l]=s(e[l],o[l]),u++},c=function(e){for(l=0;l<4;l++)e[l]+=g[63&e[(l+3)%4]]}):(i=function(e){for(l=3;l>=0;l--)e[l]=a(e[l],o[l]),e[l]-=g[u]+(e[(l+3)%4]&e[(l+2)%4])+(~e[(l+3)%4]&e[(l+1)%4]),u--},c=function(e){for(l=3;l>=0;l--)e[l]-=g[63&e[(l+3)%4]]});var y=function(e){var t=[];for(l=0;l<4;l++){var r=d.getInt16Le();null!==p&&(n?r^=p.getInt16Le():p.putInt16Le(r)),t.push(65535&r)}u=n?0:63;for(var i=0;i<e.length;i++)for(var o=0;o<e[i][0];o++)e[i][1](t);for(l=0;l<4;l++)null!==p&&(n?p.putInt16Le(t[l]):t[l]^=p.getInt16Le()),f.putInt16Le(t[l])},m=null;return m={start:function(e,t){e&&"string"===typeof e&&(e=r.util.createBuffer(e)),h=!1,d=r.util.createBuffer(),f=t||new r.util.createBuffer,p=e,m.output=f},update:function(e){for(h||d.putBuffer(e);d.length()>=8;)y([[5,i],[1,c],[6,i],[1,c],[5,i]])},finish:function(e){var t=!0;if(n)if(e)t=e(8,d,!n);else{var r=8===d.length()?8:8-d.length();d.fillWithByte(r,r)}if(t&&(h=!0,m.update()),!n&&(t=0===d.length()))if(e)t=e(8,f,!n);else{var i=f.length(),o=f.at(i-1);o>i?t=!1:f.truncate(o)}return t}}};r.rc2.startEncrypting=function(e,t,n){var i=r.rc2.createEncryptionCipher(e,128);return i.start(t,n),i},r.rc2.createEncryptionCipher=function(e,t){return c(e,t,!0)},r.rc2.startDecrypting=function(e,t,n){var i=r.rc2.createDecryptionCipher(e,128);return i.start(t,n),i},r.rc2.createDecryptionCipher=function(e,t){return c(e,t,!1)}},25493:(e,t,n)=>{var r=n(60392);if(n(85049),n(3055),n(72886),n(22627),n(5132),n(33860),n(63877),"undefined"===typeof i)var i=r.jsbn.BigInteger;var o=r.util.isNodejs?n(25819):null,s=r.asn1,a=r.util;r.pki=r.pki||{},e.exports=r.pki.rsa=r.rsa=r.rsa||{};var c=r.pki,l=[6,4,2,4,2,4,6,2],u={name:"PrivateKeyInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},h={name:"RSAPrivateKey",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},d={name:"RSAPublicKey",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},f=r.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:s.Class.UNIVERSAL,type:s.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},p={name:"DigestInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:s.Class.UNIVERSAL,type:s.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:s.Class.UNIVERSAL,type:s.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},g=function(e){var t;if(!(e.algorithm in c.oids)){var n=new Error("Unknown message digest algorithm.");throw n.algorithm=e.algorithm,n}t=c.oids[e.algorithm];var r=s.oidToDer(t).getBytes(),i=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[]),o=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[]);o.value.push(s.create(s.Class.UNIVERSAL,s.Type.OID,!1,r)),o.value.push(s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,""));var a=s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,e.digest().getBytes());return i.value.push(o),i.value.push(a),s.toDer(i).getBytes()},y=function(e,t,n){if(n)return e.modPow(t.e,t.n);if(!t.p||!t.q)return e.modPow(t.d,t.n);var o;t.dP||(t.dP=t.d.mod(t.p.subtract(i.ONE))),t.dQ||(t.dQ=t.d.mod(t.q.subtract(i.ONE))),t.qInv||(t.qInv=t.q.modInverse(t.p));do{o=new i(r.util.bytesToHex(r.random.getBytes(t.n.bitLength()/8)),16)}while(o.compareTo(t.n)>=0||!o.gcd(t.n).equals(i.ONE));for(var s=(e=e.multiply(o.modPow(t.e,t.n)).mod(t.n)).mod(t.p).modPow(t.dP,t.p),a=e.mod(t.q).modPow(t.dQ,t.q);s.compareTo(a)<0;)s=s.add(t.p);var c=s.subtract(a).multiply(t.qInv).mod(t.p).multiply(t.q).add(a);return c=c.multiply(o.modInverse(t.n)).mod(t.n)};function m(e,t,n){var i=r.util.createBuffer(),o=Math.ceil(t.n.bitLength()/8);if(e.length>o-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=e.length,s.max=o-11,s}i.putByte(0),i.putByte(n);var a,c=o-3-e.length;if(0===n||1===n){a=0===n?0:255;for(var l=0;l<c;++l)i.putByte(a)}else for(;c>0;){var u=0,h=r.random.getBytes(c);for(l=0;l<c;++l)0===(a=h.charCodeAt(l))?++u:i.putByte(a);c=u}return i.putByte(0),i.putBytes(e),i}function v(e,t,n,i){var o=Math.ceil(t.n.bitLength()/8),s=r.util.createBuffer(e),a=s.getByte(),c=s.getByte();if(0!==a||n&&0!==c&&1!==c||!n&&2!=c||n&&0===c&&"undefined"===typeof i)throw new Error("Encryption block is invalid.");var l=0;if(0===c){l=o-3-i;for(var u=0;u<l;++u)if(0!==s.getByte())throw new Error("Encryption block is invalid.")}else if(1===c)for(l=0;s.length()>1;){if(255!==s.getByte()){--s.read;break}++l}else if(2===c)for(l=0;s.length()>1;){if(0===s.getByte()){--s.read;break}++l}if(0!==s.getByte()||l!==o-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function b(e){var t=e.toString(16);t[0]>="8"&&(t="00"+t);var n=r.util.hexToBytes(t);return n.length>1&&(0===n.charCodeAt(0)&&0===(128&n.charCodeAt(1))||255===n.charCodeAt(0)&&128===(128&n.charCodeAt(1)))?n.substr(1):n}function w(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}function E(e){return r.util.isNodejs&&"function"===typeof o[e]}function A(e){return"undefined"!==typeof a.globalScope&&"object"===typeof a.globalScope.crypto&&"object"===typeof a.globalScope.crypto.subtle&&"function"===typeof a.globalScope.crypto.subtle[e]}function S(e){return"undefined"!==typeof a.globalScope&&"object"===typeof a.globalScope.msCrypto&&"object"===typeof a.globalScope.msCrypto.subtle&&"function"===typeof a.globalScope.msCrypto.subtle[e]}function _(e){for(var t=r.util.hexToBytes(e.toString(16)),n=new Uint8Array(t.length),i=0;i<t.length;++i)n[i]=t.charCodeAt(i);return n}c.rsa.encrypt=function(e,t,n){var o,s=n,a=Math.ceil(t.n.bitLength()/8);!1!==n&&!0!==n?(s=2===n,o=m(e,t,n)):(o=r.util.createBuffer()).putBytes(e);for(var c=new i(o.toHex(),16),l=y(c,t,s).toString(16),u=r.util.createBuffer(),h=a-Math.ceil(l.length/2);h>0;)u.putByte(0),--h;return u.putBytes(r.util.hexToBytes(l)),u.getBytes()},c.rsa.decrypt=function(e,t,n,o){var s=Math.ceil(t.n.bitLength()/8);if(e.length!==s){var a=new Error("Encrypted message length is invalid.");throw a.length=e.length,a.expected=s,a}var c=new i(r.util.createBuffer(e).toHex(),16);if(c.compareTo(t.n)>=0)throw new Error("Encrypted message is invalid.");for(var l=y(c,t,n).toString(16),u=r.util.createBuffer(),h=s-Math.ceil(l.length/2);h>0;)u.putByte(0),--h;return u.putBytes(r.util.hexToBytes(l)),!1!==o?v(u.getBytes(),t,n):u.getBytes()},c.rsa.createKeyPairGenerationState=function(e,t,n){"string"===typeof e&&(e=parseInt(e,10)),e=e||2048;var o,s=(n=n||{}).prng||r.random,a={nextBytes:function(e){for(var t=s.getBytesSync(e.length),n=0;n<e.length;++n)e[n]=t.charCodeAt(n)}},c=n.algorithm||"PRIMEINC";if("PRIMEINC"!==c)throw new Error("Invalid key generation algorithm: "+c);return(o={algorithm:c,state:0,bits:e,rng:a,eInt:t||65537,e:new i(null),p:null,q:null,qBits:e>>1,pBits:e-(e>>1),pqState:0,num:null,keys:null}).e.fromInt(o.eInt),o},c.rsa.stepKeyPairGenerationState=function(e,t){"algorithm"in e||(e.algorithm="PRIMEINC");var n=new i(null);n.fromInt(30);for(var r,o=0,s=function(e,t){return e|t},a=+new Date,u=0;null===e.keys&&(t<=0||u<t);){if(0===e.state){var h=null===e.p?e.pBits:e.qBits,d=h-1;0===e.pqState?(e.num=new i(h,e.rng),e.num.testBit(d)||e.num.bitwiseTo(i.ONE.shiftLeft(d),s,e.num),e.num.dAddOffset(31-e.num.mod(n).byteValue(),0),o=0,++e.pqState):1===e.pqState?e.num.bitLength()>h?e.pqState=0:e.num.isProbablePrime(w(e.num.bitLength()))?++e.pqState:e.num.dAddOffset(l[o++%8],0):2===e.pqState?e.pqState=0===e.num.subtract(i.ONE).gcd(e.e).compareTo(i.ONE)?3:0:3===e.pqState&&(e.pqState=0,null===e.p?e.p=e.num:e.q=e.num,null!==e.p&&null!==e.q&&++e.state,e.num=null)}else if(1===e.state)e.p.compareTo(e.q)<0&&(e.num=e.p,e.p=e.q,e.q=e.num),++e.state;else if(2===e.state)e.p1=e.p.subtract(i.ONE),e.q1=e.q.subtract(i.ONE),e.phi=e.p1.multiply(e.q1),++e.state;else if(3===e.state)0===e.phi.gcd(e.e).compareTo(i.ONE)?++e.state:(e.p=null,e.q=null,e.state=0);else if(4===e.state)e.n=e.p.multiply(e.q),e.n.bitLength()===e.bits?++e.state:(e.q=null,e.state=0);else if(5===e.state){var f=e.e.modInverse(e.phi);e.keys={privateKey:c.rsa.setPrivateKey(e.n,e.e,f,e.p,e.q,f.mod(e.p1),f.mod(e.q1),e.q.modInverse(e.p)),publicKey:c.rsa.setPublicKey(e.n,e.e)}}u+=(r=+new Date)-a,a=r}return null!==e.keys},c.rsa.generateKeyPair=function(e,t,n,l){if(1===arguments.length?"object"===typeof e?(n=e,e=void 0):"function"===typeof e&&(l=e,e=void 0):2===arguments.length?"number"===typeof e?"function"===typeof t?(l=t,t=void 0):"number"!==typeof t&&(n=t,t=void 0):(n=e,l=t,e=void 0,t=void 0):3===arguments.length&&("number"===typeof t?"function"===typeof n&&(l=n,n=void 0):(l=n,n=t,t=void 0)),n=n||{},void 0===e&&(e=n.bits||2048),void 0===t&&(t=n.e||65537),!r.options.usePureJavaScript&&!n.prng&&e>=256&&e<=16384&&(65537===t||3===t))if(l){if(E("generateKeyPair"))return o.generateKeyPair("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},(function(e,t,n){if(e)return l(e);l(null,{privateKey:c.privateKeyFromPem(n),publicKey:c.publicKeyFromPem(t)})}));if(A("generateKey")&&A("exportKey"))return a.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:_(t),hash:{name:"SHA-256"}},!0,["sign","verify"]).then((function(e){return a.globalScope.crypto.subtle.exportKey("pkcs8",e.privateKey)})).then(void 0,(function(e){l(e)})).then((function(e){if(e){var t=c.privateKeyFromAsn1(s.fromDer(r.util.createBuffer(e)));l(null,{privateKey:t,publicKey:c.setRsaPublicKey(t.n,t.e)})}}));if(S("generateKey")&&S("exportKey")){var u=a.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:_(t),hash:{name:"SHA-256"}},!0,["sign","verify"]);return u.oncomplete=function(e){var t=e.target.result,n=a.globalScope.msCrypto.subtle.exportKey("pkcs8",t.privateKey);n.oncomplete=function(e){var t=e.target.result,n=c.privateKeyFromAsn1(s.fromDer(r.util.createBuffer(t)));l(null,{privateKey:n,publicKey:c.setRsaPublicKey(n.n,n.e)})},n.onerror=function(e){l(e)}},void(u.onerror=function(e){l(e)})}}else if(E("generateKeyPairSync")){var h=o.generateKeyPairSync("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:c.privateKeyFromPem(h.privateKey),publicKey:c.publicKeyFromPem(h.publicKey)}}var d=c.rsa.createKeyPairGenerationState(e,t,n);if(!l)return c.rsa.stepKeyPairGenerationState(d,0),d.keys;!function(e,t,n){"function"===typeof t&&(n=t,t={});t=t||{};var o={algorithm:{name:t.algorithm||"PRIMEINC",options:{workers:t.workers||2,workLoad:t.workLoad||100,workerScript:t.workerScript}}};"prng"in t&&(o.prng=t.prng);function s(){a(e.pBits,(function(t,r){return t?n(t):(e.p=r,null!==e.q?l(t,e.q):void a(e.qBits,l))}))}function a(e,t){r.prime.generateProbablePrime(e,o,t)}function l(t,r){if(t)return n(t);if(e.q=r,e.p.compareTo(e.q)<0){var o=e.p;e.p=e.q,e.q=o}if(0!==e.p.subtract(i.ONE).gcd(e.e).compareTo(i.ONE))return e.p=null,void s();if(0!==e.q.subtract(i.ONE).gcd(e.e).compareTo(i.ONE))return e.q=null,void a(e.qBits,l);if(e.p1=e.p.subtract(i.ONE),e.q1=e.q.subtract(i.ONE),e.phi=e.p1.multiply(e.q1),0!==e.phi.gcd(e.e).compareTo(i.ONE))return e.p=e.q=null,void s();if(e.n=e.p.multiply(e.q),e.n.bitLength()!==e.bits)return e.q=null,void a(e.qBits,l);var u=e.e.modInverse(e.phi);e.keys={privateKey:c.rsa.setPrivateKey(e.n,e.e,u,e.p,e.q,u.mod(e.p1),u.mod(e.q1),e.q.modInverse(e.p)),publicKey:c.rsa.setPublicKey(e.n,e.e)},n(null,e.keys)}s()}(d,n,l)},c.setRsaPublicKey=c.rsa.setPublicKey=function(e,t){var n={n:e,e:t,encrypt:function(e,t,i){if("string"===typeof t?t=t.toUpperCase():void 0===t&&(t="RSAES-PKCS1-V1_5"),"RSAES-PKCS1-V1_5"===t)t={encode:function(e,t,n){return m(e,t,2).getBytes()}};else if("RSA-OAEP"===t||"RSAES-OAEP"===t)t={encode:function(e,t){return r.pkcs1.encode_rsa_oaep(t,e,i)}};else if(-1!==["RAW","NONE","NULL",null].indexOf(t))t={encode:function(e){return e}};else if("string"===typeof t)throw new Error('Unsupported encryption scheme: "'+t+'".');var o=t.encode(e,n,!0);return c.rsa.encrypt(o,n,!0)},verify:function(e,t,i,o){"string"===typeof i?i=i.toUpperCase():void 0===i&&(i="RSASSA-PKCS1-V1_5"),void 0===o&&(o={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in o||(o._parseAllDigestBytes=!0),"RSASSA-PKCS1-V1_5"===i?i={verify:function(e,t){t=v(t,n,!0);var i=s.fromDer(t,{parseAllBytes:o._parseAllDigestBytes}),a={},c=[];if(!s.validate(i,p,a,c))throw(l=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.")).errors=c,l;var l,u=s.derToOid(a.algorithmIdentifier);if(u!==r.oids.md2&&u!==r.oids.md5&&u!==r.oids.sha1&&u!==r.oids.sha224&&u!==r.oids.sha256&&u!==r.oids.sha384&&u!==r.oids.sha512&&u!==r.oids["sha512-224"]&&u!==r.oids["sha512-256"])throw(l=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.")).oid=u,l;if((u===r.oids.md2||u===r.oids.md5)&&!("parameters"in a))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return e===a.digest}}:"NONE"!==i&&"NULL"!==i&&null!==i||(i={verify:function(e,t){return e===(t=v(t,n,!0))}});var a=c.rsa.decrypt(t,n,!0,!1);return i.verify(e,a,n.n.bitLength())}};return n},c.setRsaPrivateKey=c.rsa.setPrivateKey=function(e,t,n,i,o,s,a,l){var u={n:e,e:t,d:n,p:i,q:o,dP:s,dQ:a,qInv:l,decrypt:function(e,t,n){"string"===typeof t?t=t.toUpperCase():void 0===t&&(t="RSAES-PKCS1-V1_5");var i=c.rsa.decrypt(e,u,!1,!1);if("RSAES-PKCS1-V1_5"===t)t={decode:v};else if("RSA-OAEP"===t||"RSAES-OAEP"===t)t={decode:function(e,t){return r.pkcs1.decode_rsa_oaep(t,e,n)}};else{if(-1===["RAW","NONE","NULL",null].indexOf(t))throw new Error('Unsupported encryption scheme: "'+t+'".');t={decode:function(e){return e}}}return t.decode(i,u,!1)},sign:function(e,t){var n=!1;"string"===typeof t&&(t=t.toUpperCase()),void 0===t||"RSASSA-PKCS1-V1_5"===t?(t={encode:g},n=1):"NONE"!==t&&"NULL"!==t&&null!==t||(t={encode:function(){return e}},n=1);var r=t.encode(e,u.n.bitLength());return c.rsa.encrypt(r,u,n)}};return u},c.wrapRsaPrivateKey=function(e){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(0).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(c.oids.rsaEncryption).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")]),s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,s.toDer(e).getBytes())])},c.privateKeyFromAsn1=function(e){var t,n,o,a,l,d,f,p,g={},y=[];if(s.validate(e,u,g,y)&&(e=s.fromDer(r.util.createBuffer(g.privateKey))),g={},y=[],!s.validate(e,h,g,y)){var m=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw m.errors=y,m}return t=r.util.createBuffer(g.privateKeyModulus).toHex(),n=r.util.createBuffer(g.privateKeyPublicExponent).toHex(),o=r.util.createBuffer(g.privateKeyPrivateExponent).toHex(),a=r.util.createBuffer(g.privateKeyPrime1).toHex(),l=r.util.createBuffer(g.privateKeyPrime2).toHex(),d=r.util.createBuffer(g.privateKeyExponent1).toHex(),f=r.util.createBuffer(g.privateKeyExponent2).toHex(),p=r.util.createBuffer(g.privateKeyCoefficient).toHex(),c.setRsaPrivateKey(new i(t,16),new i(n,16),new i(o,16),new i(a,16),new i(l,16),new i(d,16),new i(f,16),new i(p,16))},c.privateKeyToAsn1=c.privateKeyToRSAPrivateKey=function(e){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(0).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,b(e.n)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,b(e.e)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,b(e.d)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,b(e.p)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,b(e.q)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,b(e.dP)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,b(e.dQ)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,b(e.qInv))])},c.publicKeyFromAsn1=function(e){var t={},n=[];if(s.validate(e,f,t,n)){var o,a=s.derToOid(t.publicKeyOid);if(a!==c.oids.rsaEncryption)throw(o=new Error("Cannot read public key. Unknown OID.")).oid=a,o;e=t.rsaPublicKey}if(n=[],!s.validate(e,d,t,n))throw(o=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.")).errors=n,o;var l=r.util.createBuffer(t.publicKeyModulus).toHex(),u=r.util.createBuffer(t.publicKeyExponent).toHex();return c.setRsaPublicKey(new i(l,16),new i(u,16))},c.publicKeyToAsn1=c.publicKeyToSubjectPublicKeyInfo=function(e){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(c.oids.rsaEncryption).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")]),s.create(s.Class.UNIVERSAL,s.Type.BITSTRING,!1,[c.publicKeyToRSAPublicKey(e)])])},c.publicKeyToRSAPublicKey=function(e){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,b(e.n)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,b(e.e))])}},50928:(e,t,n)=>{var r=n(60392);n(10029),n(63877);var i=e.exports=r.sha1=r.sha1||{};r.md.sha1=r.md.algorithms.sha1=i,i.create=function(){s||(o=String.fromCharCode(128),o+=r.util.fillString(String.fromCharCode(0),64),s=!0);var e=null,t=r.util.createBuffer(),n=new Array(80),i={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var n=i.messageLengthSize/4,o=0;o<n;++o)i.fullMessageLength.push(0);return t=r.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},i}};return i.start(),i.update=function(o,s){"utf8"===s&&(o=r.util.encodeUtf8(o));var c=o.length;i.messageLength+=c,c=[c/4294967296>>>0,c>>>0];for(var l=i.fullMessageLength.length-1;l>=0;--l)i.fullMessageLength[l]+=c[1],c[1]=c[0]+(i.fullMessageLength[l]/4294967296>>>0),i.fullMessageLength[l]=i.fullMessageLength[l]>>>0,c[0]=c[1]/4294967296>>>0;return t.putBytes(o),a(e,n,t),(t.read>2048||0===t.length())&&t.compact(),i},i.digest=function(){var s=r.util.createBuffer();s.putBytes(t.bytes());var c,l=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize&i.blockLength-1;s.putBytes(o.substr(0,i.blockLength-l));for(var u=8*i.fullMessageLength[0],h=0;h<i.fullMessageLength.length-1;++h)u+=(c=8*i.fullMessageLength[h+1])/4294967296>>>0,s.putInt32(u>>>0),u=c>>>0;s.putInt32(u);var d={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};a(d,n,s);var f=r.util.createBuffer();return f.putInt32(d.h0),f.putInt32(d.h1),f.putInt32(d.h2),f.putInt32(d.h3),f.putInt32(d.h4),f},i};var o=null,s=!1;function a(e,t,n){for(var r,i,o,s,a,c,l,u=n.length();u>=64;){for(i=e.h0,o=e.h1,s=e.h2,a=e.h3,c=e.h4,l=0;l<16;++l)r=n.getInt32(),t[l]=r,r=(i<<5|i>>>27)+(a^o&(s^a))+c+1518500249+r,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=r;for(;l<20;++l)r=(r=t[l-3]^t[l-8]^t[l-14]^t[l-16])<<1|r>>>31,t[l]=r,r=(i<<5|i>>>27)+(a^o&(s^a))+c+1518500249+r,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=r;for(;l<32;++l)r=(r=t[l-3]^t[l-8]^t[l-14]^t[l-16])<<1|r>>>31,t[l]=r,r=(i<<5|i>>>27)+(o^s^a)+c+1859775393+r,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=r;for(;l<40;++l)r=(r=t[l-6]^t[l-16]^t[l-28]^t[l-32])<<2|r>>>30,t[l]=r,r=(i<<5|i>>>27)+(o^s^a)+c+1859775393+r,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=r;for(;l<60;++l)r=(r=t[l-6]^t[l-16]^t[l-28]^t[l-32])<<2|r>>>30,t[l]=r,r=(i<<5|i>>>27)+(o&s|a&(o^s))+c+2400959708+r,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=r;for(;l<80;++l)r=(r=t[l-6]^t[l-16]^t[l-28]^t[l-32])<<2|r>>>30,t[l]=r,r=(i<<5|i>>>27)+(o^s^a)+c+3395469782+r,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=r;e.h0=e.h0+i|0,e.h1=e.h1+o|0,e.h2=e.h2+s|0,e.h3=e.h3+a|0,e.h4=e.h4+c|0,u-=64}}},77404:(e,t,n)=>{var r=n(60392);n(10029),n(63877);var i=e.exports=r.sha256=r.sha256||{};r.md.sha256=r.md.algorithms.sha256=i,i.create=function(){s||(o=String.fromCharCode(128),o+=r.util.fillString(String.fromCharCode(0),64),a=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],s=!0);var e=null,t=r.util.createBuffer(),n=new Array(64),i={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var n=i.messageLengthSize/4,o=0;o<n;++o)i.fullMessageLength.push(0);return t=r.util.createBuffer(),e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},i}};return i.start(),i.update=function(o,s){"utf8"===s&&(o=r.util.encodeUtf8(o));var a=o.length;i.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var l=i.fullMessageLength.length-1;l>=0;--l)i.fullMessageLength[l]+=a[1],a[1]=a[0]+(i.fullMessageLength[l]/4294967296>>>0),i.fullMessageLength[l]=i.fullMessageLength[l]>>>0,a[0]=a[1]/4294967296>>>0;return t.putBytes(o),c(e,n,t),(t.read>2048||0===t.length())&&t.compact(),i},i.digest=function(){var s=r.util.createBuffer();s.putBytes(t.bytes());var a,l=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize&i.blockLength-1;s.putBytes(o.substr(0,i.blockLength-l));for(var u=8*i.fullMessageLength[0],h=0;h<i.fullMessageLength.length-1;++h)u+=(a=8*i.fullMessageLength[h+1])/4294967296>>>0,s.putInt32(u>>>0),u=a>>>0;s.putInt32(u);var d={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};c(d,n,s);var f=r.util.createBuffer();return f.putInt32(d.h0),f.putInt32(d.h1),f.putInt32(d.h2),f.putInt32(d.h3),f.putInt32(d.h4),f.putInt32(d.h5),f.putInt32(d.h6),f.putInt32(d.h7),f},i};var o=null,s=!1,a=null;function c(e,t,n){for(var r,i,o,s,c,l,u,h,d,f,p,g,y,m=n.length();m>=64;){for(c=0;c<16;++c)t[c]=n.getInt32();for(;c<64;++c)r=((r=t[c-2])>>>17|r<<15)^(r>>>19|r<<13)^r>>>10,i=((i=t[c-15])>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,t[c]=r+t[c-7]+i+t[c-16]|0;for(l=e.h0,u=e.h1,h=e.h2,d=e.h3,f=e.h4,p=e.h5,g=e.h6,y=e.h7,c=0;c<64;++c)o=(l>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10),s=l&u|h&(l^u),r=y+((f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7))+(g^f&(p^g))+a[c]+t[c],y=g,g=p,p=f,f=d+r>>>0,d=h,h=u,u=l,l=r+(i=o+s)>>>0;e.h0=e.h0+l|0,e.h1=e.h1+u|0,e.h2=e.h2+h|0,e.h3=e.h3+d|0,e.h4=e.h4+f|0,e.h5=e.h5+p|0,e.h6=e.h6+g|0,e.h7=e.h7+y|0,m-=64}}},34770:(e,t,n)=>{var r=n(60392);n(10029),n(63877);var i=e.exports=r.sha512=r.sha512||{};r.md.sha512=r.md.algorithms.sha512=i;var o=r.sha384=r.sha512.sha384=r.sha512.sha384||{};o.create=function(){return i.create("SHA-384")},r.md.sha384=r.md.algorithms.sha384=o,r.sha512.sha256=r.sha512.sha256||{create:function(){return i.create("SHA-512/256")}},r.md["sha512/256"]=r.md.algorithms["sha512/256"]=r.sha512.sha256,r.sha512.sha224=r.sha512.sha224||{create:function(){return i.create("SHA-512/224")}},r.md["sha512/224"]=r.md.algorithms["sha512/224"]=r.sha512.sha224,i.create=function(e){if(a||(s=String.fromCharCode(128),s+=r.util.fillString(String.fromCharCode(0),128),c=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],(l={})["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],l["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],l["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],l["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],a=!0),"undefined"===typeof e&&(e="SHA-512"),!(e in l))throw new Error("Invalid SHA-512 algorithm: "+e);for(var t=l[e],n=null,i=r.util.createBuffer(),o=new Array(80),h=0;h<80;++h)o[h]=new Array(2);var d=64;switch(e){case"SHA-384":d=48;break;case"SHA-512/256":d=32;break;case"SHA-512/224":d=28}var f={algorithm:e.replace("-","").toLowerCase(),blockLength:128,digestLength:d,messageLength:0,fullMessageLength:null,messageLengthSize:16,start:function(){f.messageLength=0,f.fullMessageLength=f.messageLength128=[];for(var e=f.messageLengthSize/4,o=0;o<e;++o)f.fullMessageLength.push(0);i=r.util.createBuffer(),n=new Array(t.length);for(o=0;o<t.length;++o)n[o]=t[o].slice(0);return f}};return f.start(),f.update=function(e,t){"utf8"===t&&(e=r.util.encodeUtf8(e));var s=e.length;f.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var a=f.fullMessageLength.length-1;a>=0;--a)f.fullMessageLength[a]+=s[1],s[1]=s[0]+(f.fullMessageLength[a]/4294967296>>>0),f.fullMessageLength[a]=f.fullMessageLength[a]>>>0,s[0]=s[1]/4294967296>>>0;return i.putBytes(e),u(n,o,i),(i.read>2048||0===i.length())&&i.compact(),f},f.digest=function(){var t=r.util.createBuffer();t.putBytes(i.bytes());var a,c=f.fullMessageLength[f.fullMessageLength.length-1]+f.messageLengthSize&f.blockLength-1;t.putBytes(s.substr(0,f.blockLength-c));for(var l=8*f.fullMessageLength[0],h=0;h<f.fullMessageLength.length-1;++h)l+=(a=8*f.fullMessageLength[h+1])/4294967296>>>0,t.putInt32(l>>>0),l=a>>>0;t.putInt32(l);var d=new Array(n.length);for(h=0;h<n.length;++h)d[h]=n[h].slice(0);u(d,o,t);var p,g=r.util.createBuffer();p="SHA-512"===e?d.length:"SHA-384"===e?d.length-2:d.length-4;for(h=0;h<p;++h)g.putInt32(d[h][0]),h===p-1&&"SHA-512/224"===e||g.putInt32(d[h][1]);return g},f};var s=null,a=!1,c=null,l=null;function u(e,t,n){for(var r,i,o,s,a,l,u,h,d,f,p,g,y,m,v,b,w,E,A,S,_,I,C,T,k,R,x,P,D,O,N,B,L,M=n.length();M>=128;){for(x=0;x<16;++x)t[x][0]=n.getInt32()>>>0,t[x][1]=n.getInt32()>>>0;for(;x<80;++x)r=(((P=(O=t[x-2])[0])>>>19|(D=O[1])<<13)^(D>>>29|P<<3)^P>>>6)>>>0,i=((P<<13|D>>>19)^(D<<3|P>>>29)^(P<<26|D>>>6))>>>0,o=(((P=(B=t[x-15])[0])>>>1|(D=B[1])<<31)^(P>>>8|D<<24)^P>>>7)>>>0,s=((P<<31|D>>>1)^(P<<24|D>>>8)^(P<<25|D>>>7))>>>0,N=t[x-7],L=t[x-16],D=i+N[1]+s+L[1],t[x][0]=r+N[0]+o+L[0]+(D/4294967296>>>0)>>>0,t[x][1]=D>>>0;for(p=e[0][0],g=e[0][1],y=e[1][0],m=e[1][1],v=e[2][0],b=e[2][1],w=e[3][0],E=e[3][1],A=e[4][0],S=e[4][1],_=e[5][0],I=e[5][1],C=e[6][0],T=e[6][1],k=e[7][0],R=e[7][1],x=0;x<80;++x)u=((A>>>14|S<<18)^(A>>>18|S<<14)^(S>>>9|A<<23))>>>0,h=(C^A&(_^C))>>>0,a=((p>>>28|g<<4)^(g>>>2|p<<30)^(g>>>7|p<<25))>>>0,l=((p<<4|g>>>28)^(g<<30|p>>>2)^(g<<25|p>>>7))>>>0,d=(p&y|v&(p^y))>>>0,f=(g&m|b&(g^m))>>>0,D=R+(((A<<18|S>>>14)^(A<<14|S>>>18)^(S<<23|A>>>9))>>>0)+((T^S&(I^T))>>>0)+c[x][1]+t[x][1],r=k+u+h+c[x][0]+t[x][0]+(D/4294967296>>>0)>>>0,i=D>>>0,o=a+d+((D=l+f)/4294967296>>>0)>>>0,s=D>>>0,k=C,R=T,C=_,T=I,_=A,I=S,A=w+r+((D=E+i)/4294967296>>>0)>>>0,S=D>>>0,w=v,E=b,v=y,b=m,y=p,m=g,p=r+o+((D=i+s)/4294967296>>>0)>>>0,g=D>>>0;D=e[0][1]+g,e[0][0]=e[0][0]+p+(D/4294967296>>>0)>>>0,e[0][1]=D>>>0,D=e[1][1]+m,e[1][0]=e[1][0]+y+(D/4294967296>>>0)>>>0,e[1][1]=D>>>0,D=e[2][1]+b,e[2][0]=e[2][0]+v+(D/4294967296>>>0)>>>0,e[2][1]=D>>>0,D=e[3][1]+E,e[3][0]=e[3][0]+w+(D/4294967296>>>0)>>>0,e[3][1]=D>>>0,D=e[4][1]+S,e[4][0]=e[4][0]+A+(D/4294967296>>>0)>>>0,e[4][1]=D>>>0,D=e[5][1]+I,e[5][0]=e[5][0]+_+(D/4294967296>>>0)>>>0,e[5][1]=D>>>0,D=e[6][1]+T,e[6][0]=e[6][0]+C+(D/4294967296>>>0)>>>0,e[6][1]=D>>>0,D=e[7][1]+R,e[7][0]=e[7][0]+k+(D/4294967296>>>0)>>>0,e[7][1]=D>>>0,M-=128}}},63877:(e,t,n)=>{var r=n(1426),i=n(62678).Buffer,o=n(60392),s=n(65754),a=e.exports=o.util=o.util||{};function c(e){if(8!==e&&16!==e&&24!==e&&32!==e)throw new Error("Only 8, 16, 24, or 32 bits supported: "+e)}function l(e){if(this.data="",this.read=0,"string"===typeof e)this.data=e;else if(a.isArrayBuffer(e)||a.isArrayBufferView(e))if("undefined"!==typeof i&&e instanceof i)this.data=e.toString("binary");else{var t=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,t)}catch(r){for(var n=0;n<t.length;++n)this.putByte(t[n])}}else(e instanceof l||"object"===typeof e&&"string"===typeof e.data&&"number"===typeof e.read)&&(this.data=e.data,this.read=e.read);this._constructedStringLength=0}!function(){if("undefined"!==typeof r&&r.nextTick&&!r.browser)return a.nextTick=r.nextTick,void("function"===typeof setImmediate?a.setImmediate=setImmediate:a.setImmediate=a.nextTick);if("function"===typeof setImmediate)return a.setImmediate=function(){return setImmediate.apply(void 0,arguments)},void(a.nextTick=function(e){return setImmediate(e)});if(a.setImmediate=function(e){setTimeout(e,0)},"undefined"!==typeof window&&"function"===typeof window.postMessage){var e="forge.setImmediate",t=[];a.setImmediate=function(n){t.push(n),1===t.length&&window.postMessage(e,"*")},window.addEventListener("message",(function(n){if(n.source===window&&n.data===e){n.stopPropagation();var r=t.slice();t.length=0,r.forEach((function(e){e()}))}}),!0)}if("undefined"!==typeof MutationObserver){var n=Date.now(),i=!0,o=document.createElement("div");t=[];new MutationObserver((function(){var e=t.slice();t.length=0,e.forEach((function(e){e()}))})).observe(o,{attributes:!0});var s=a.setImmediate;a.setImmediate=function(e){Date.now()-n>15?(n=Date.now(),s(e)):(t.push(e),1===t.length&&o.setAttribute("a",i=!i))}}a.nextTick=a.setImmediate}(),a.isNodejs="undefined"!==typeof r&&r.versions&&r.versions.node,a.globalScope=a.isNodejs?n.g:"undefined"===typeof self?window:self,a.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},a.isArrayBuffer=function(e){return"undefined"!==typeof ArrayBuffer&&e instanceof ArrayBuffer},a.isArrayBufferView=function(e){return e&&a.isArrayBuffer(e.buffer)&&void 0!==e.byteLength},a.ByteBuffer=l,a.ByteStringBuffer=l;a.ByteStringBuffer.prototype._optimizeConstructedString=function(e){this._constructedStringLength+=e,this._constructedStringLength>4096&&(this.data.substr(0,1),this._constructedStringLength=0)},a.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},a.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},a.ByteStringBuffer.prototype.putByte=function(e){return this.putBytes(String.fromCharCode(e))},a.ByteStringBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);for(var n=this.data;t>0;)1&t&&(n+=e),(t>>>=1)>0&&(e+=e);return this.data=n,this._optimizeConstructedString(t),this},a.ByteStringBuffer.prototype.putBytes=function(e){return this.data+=e,this._optimizeConstructedString(e.length),this},a.ByteStringBuffer.prototype.putString=function(e){return this.putBytes(a.encodeUtf8(e))},a.ByteStringBuffer.prototype.putInt16=function(e){return this.putBytes(String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},a.ByteStringBuffer.prototype.putInt24=function(e){return this.putBytes(String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},a.ByteStringBuffer.prototype.putInt32=function(e){return this.putBytes(String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},a.ByteStringBuffer.prototype.putInt16Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255))},a.ByteStringBuffer.prototype.putInt24Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255))},a.ByteStringBuffer.prototype.putInt32Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255))},a.ByteStringBuffer.prototype.putInt=function(e,t){c(t);var n="";do{t-=8,n+=String.fromCharCode(e>>t&255)}while(t>0);return this.putBytes(n)},a.ByteStringBuffer.prototype.putSignedInt=function(e,t){return e<0&&(e+=2<<t-1),this.putInt(e,t)},a.ByteStringBuffer.prototype.putBuffer=function(e){return this.putBytes(e.getBytes())},a.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},a.ByteStringBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e},a.ByteStringBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e},a.ByteStringBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e},a.ByteStringBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e},a.ByteStringBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e},a.ByteStringBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e},a.ByteStringBuffer.prototype.getInt=function(e){c(e);var t=0;do{t=(t<<8)+this.data.charCodeAt(this.read++),e-=8}while(e>0);return t},a.ByteStringBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),n=2<<e-2;return t>=n&&(t-=n<<1),t},a.ByteStringBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):0===e?t="":(t=0===this.read?this.data:this.data.slice(this.read),this.clear()),t},a.ByteStringBuffer.prototype.bytes=function(e){return"undefined"===typeof e?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},a.ByteStringBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)},a.ByteStringBuffer.prototype.setAt=function(e,t){return this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1),this},a.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},a.ByteStringBuffer.prototype.copy=function(){var e=a.createBuffer(this.data);return e.read=this.read,e},a.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},a.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},a.ByteStringBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);return this.data=this.data.substr(this.read,t),this.read=0,this},a.ByteStringBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var n=this.data.charCodeAt(t);n<16&&(e+="0"),e+=n.toString(16)}return e},a.ByteStringBuffer.prototype.toString=function(){return a.decodeUtf8(this.bytes())},a.DataBuffer=function(e,t){t=t||{},this.read=t.readOffset||0,this.growSize=t.growSize||1024;var n=a.isArrayBuffer(e),r=a.isArrayBufferView(e);if(n||r)return this.data=n?new DataView(e):new DataView(e.buffer,e.byteOffset,e.byteLength),void(this.write="writeOffset"in t?t.writeOffset:this.data.byteLength);this.data=new DataView(new ArrayBuffer(0)),this.write=0,null!==e&&void 0!==e&&this.putBytes(e),"writeOffset"in t&&(this.write=t.writeOffset)},a.DataBuffer.prototype.length=function(){return this.write-this.read},a.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},a.DataBuffer.prototype.accommodate=function(e,t){if(this.length()>=e)return this;t=Math.max(t||this.growSize,e);var n=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),r=new Uint8Array(this.length()+t);return r.set(n),this.data=new DataView(r.buffer),this},a.DataBuffer.prototype.putByte=function(e){return this.accommodate(1),this.data.setUint8(this.write++,e),this},a.DataBuffer.prototype.fillWithByte=function(e,t){this.accommodate(t);for(var n=0;n<t;++n)this.data.setUint8(e);return this},a.DataBuffer.prototype.putBytes=function(e,t){if(a.isArrayBufferView(e)){var n=(r=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)).byteLength-r.byteOffset;return this.accommodate(n),new Uint8Array(this.data.buffer,this.write).set(r),this.write+=n,this}if(a.isArrayBuffer(e)){var r=new Uint8Array(e);return this.accommodate(r.byteLength),new Uint8Array(this.data.buffer).set(r,this.write),this.write+=r.byteLength,this}if(e instanceof a.DataBuffer||"object"===typeof e&&"number"===typeof e.read&&"number"===typeof e.write&&a.isArrayBufferView(e.data)){r=new Uint8Array(e.data.byteLength,e.read,e.length());return this.accommodate(r.byteLength),new Uint8Array(e.data.byteLength,this.write).set(r),this.write+=r.byteLength,this}if(e instanceof a.ByteStringBuffer&&(e=e.data,t="binary"),t=t||"binary","string"===typeof e){var i;if("hex"===t)return this.accommodate(Math.ceil(e.length/2)),i=new Uint8Array(this.data.buffer,this.write),this.write+=a.binary.hex.decode(e,i,this.write),this;if("base64"===t)return this.accommodate(3*Math.ceil(e.length/4)),i=new Uint8Array(this.data.buffer,this.write),this.write+=a.binary.base64.decode(e,i,this.write),this;if("utf8"===t&&(e=a.encodeUtf8(e),t="binary"),"binary"===t||"raw"===t)return this.accommodate(e.length),i=new Uint8Array(this.data.buffer,this.write),this.write+=a.binary.raw.decode(i),this;if("utf16"===t)return this.accommodate(2*e.length),i=new Uint16Array(this.data.buffer,this.write),this.write+=a.text.utf16.encode(i),this;throw new Error("Invalid encoding: "+t)}throw Error("Invalid parameter: "+e)},a.DataBuffer.prototype.putBuffer=function(e){return this.putBytes(e),e.clear(),this},a.DataBuffer.prototype.putString=function(e){return this.putBytes(e,"utf16")},a.DataBuffer.prototype.putInt16=function(e){return this.accommodate(2),this.data.setInt16(this.write,e),this.write+=2,this},a.DataBuffer.prototype.putInt24=function(e){return this.accommodate(3),this.data.setInt16(this.write,e>>8&65535),this.data.setInt8(this.write,e>>16&255),this.write+=3,this},a.DataBuffer.prototype.putInt32=function(e){return this.accommodate(4),this.data.setInt32(this.write,e),this.write+=4,this},a.DataBuffer.prototype.putInt16Le=function(e){return this.accommodate(2),this.data.setInt16(this.write,e,!0),this.write+=2,this},a.DataBuffer.prototype.putInt24Le=function(e){return this.accommodate(3),this.data.setInt8(this.write,e>>16&255),this.data.setInt16(this.write,e>>8&65535,!0),this.write+=3,this},a.DataBuffer.prototype.putInt32Le=function(e){return this.accommodate(4),this.data.setInt32(this.write,e,!0),this.write+=4,this},a.DataBuffer.prototype.putInt=function(e,t){c(t),this.accommodate(t/8);do{t-=8,this.data.setInt8(this.write++,e>>t&255)}while(t>0);return this},a.DataBuffer.prototype.putSignedInt=function(e,t){return c(t),this.accommodate(t/8),e<0&&(e+=2<<t-1),this.putInt(e,t)},a.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},a.DataBuffer.prototype.getInt16=function(){var e=this.data.getInt16(this.read);return this.read+=2,e},a.DataBuffer.prototype.getInt24=function(){var e=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,e},a.DataBuffer.prototype.getInt32=function(){var e=this.data.getInt32(this.read);return this.read+=4,e},a.DataBuffer.prototype.getInt16Le=function(){var e=this.data.getInt16(this.read,!0);return this.read+=2,e},a.DataBuffer.prototype.getInt24Le=function(){var e=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,e},a.DataBuffer.prototype.getInt32Le=function(){var e=this.data.getInt32(this.read,!0);return this.read+=4,e},a.DataBuffer.prototype.getInt=function(e){c(e);var t=0;do{t=(t<<8)+this.data.getInt8(this.read++),e-=8}while(e>0);return t},a.DataBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),n=2<<e-2;return t>=n&&(t-=n<<1),t},a.DataBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):0===e?t="":(t=0===this.read?this.data:this.data.slice(this.read),this.clear()),t},a.DataBuffer.prototype.bytes=function(e){return"undefined"===typeof e?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},a.DataBuffer.prototype.at=function(e){return this.data.getUint8(this.read+e)},a.DataBuffer.prototype.setAt=function(e,t){return this.data.setUint8(e,t),this},a.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},a.DataBuffer.prototype.copy=function(){return new a.DataBuffer(this)},a.DataBuffer.prototype.compact=function(){if(this.read>0){var e=new Uint8Array(this.data.buffer,this.read),t=new Uint8Array(e.byteLength);t.set(e),this.data=new DataView(t),this.write-=this.read,this.read=0}return this},a.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},a.DataBuffer.prototype.truncate=function(e){return this.write=Math.max(0,this.length()-e),this.read=Math.min(this.read,this.write),this},a.DataBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.byteLength;++t){var n=this.data.getUint8(t);n<16&&(e+="0"),e+=n.toString(16)}return e},a.DataBuffer.prototype.toString=function(e){var t=new Uint8Array(this.data,this.read,this.length());if("binary"===(e=e||"utf8")||"raw"===e)return a.binary.raw.encode(t);if("hex"===e)return a.binary.hex.encode(t);if("base64"===e)return a.binary.base64.encode(t);if("utf8"===e)return a.text.utf8.decode(t);if("utf16"===e)return a.text.utf16.decode(t);throw new Error("Invalid encoding: "+e)},a.createBuffer=function(e,t){return t=t||"raw",void 0!==e&&"utf8"===t&&(e=a.encodeUtf8(e)),new a.ByteBuffer(e)},a.fillString=function(e,t){for(var n="";t>0;)1&t&&(n+=e),(t>>>=1)>0&&(e+=e);return n},a.xorBytes=function(e,t,n){for(var r="",i="",o="",s=0,a=0;n>0;--n,++s)i=e.charCodeAt(s)^t.charCodeAt(s),a>=10&&(r+=o,o="",a=0),o+=String.fromCharCode(i),++a;return r+=o},a.hexToBytes=function(e){var t="",n=0;for(!0&e.length&&(n=1,t+=String.fromCharCode(parseInt(e[0],16)));n<e.length;n+=2)t+=String.fromCharCode(parseInt(e.substr(n,2),16));return t},a.bytesToHex=function(e){return a.createBuffer(e).toHex()},a.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e)};var u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],d="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";a.encode64=function(e,t){for(var n,r,i,o="",s="",a=0;a<e.length;)n=e.charCodeAt(a++),r=e.charCodeAt(a++),i=e.charCodeAt(a++),o+=u.charAt(n>>2),o+=u.charAt((3&n)<<4|r>>4),isNaN(r)?o+="==":(o+=u.charAt((15&r)<<2|i>>6),o+=isNaN(i)?"=":u.charAt(63&i)),t&&o.length>t&&(s+=o.substr(0,t)+"\r\n",o=o.substr(t));return s+=o},a.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var t,n,r,i,o="",s=0;s<e.length;)t=h[e.charCodeAt(s++)-43],n=h[e.charCodeAt(s++)-43],r=h[e.charCodeAt(s++)-43],i=h[e.charCodeAt(s++)-43],o+=String.fromCharCode(t<<2|n>>4),64!==r&&(o+=String.fromCharCode((15&n)<<4|r>>2),64!==i&&(o+=String.fromCharCode((3&r)<<6|i)));return o},a.encodeUtf8=function(e){return unescape(encodeURIComponent(e))},a.decodeUtf8=function(e){return decodeURIComponent(escape(e))},a.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:s.encode,decode:s.decode}},a.binary.raw.encode=function(e){return String.fromCharCode.apply(null,e)},a.binary.raw.decode=function(e,t,n){var r=t;r||(r=new Uint8Array(e.length));for(var i=n=n||0,o=0;o<e.length;++o)r[i++]=e.charCodeAt(o);return t?i-n:r},a.binary.hex.encode=a.bytesToHex,a.binary.hex.decode=function(e,t,n){var r=t;r||(r=new Uint8Array(Math.ceil(e.length/2)));var i=0,o=n=n||0;for(1&e.length&&(i=1,r[o++]=parseInt(e[0],16));i<e.length;i+=2)r[o++]=parseInt(e.substr(i,2),16);return t?o-n:r},a.binary.base64.encode=function(e,t){for(var n,r,i,o="",s="",a=0;a<e.byteLength;)n=e[a++],r=e[a++],i=e[a++],o+=u.charAt(n>>2),o+=u.charAt((3&n)<<4|r>>4),isNaN(r)?o+="==":(o+=u.charAt((15&r)<<2|i>>6),o+=isNaN(i)?"=":u.charAt(63&i)),t&&o.length>t&&(s+=o.substr(0,t)+"\r\n",o=o.substr(t));return s+=o},a.binary.base64.decode=function(e,t,n){var r,i,o,s,a=t;a||(a=new Uint8Array(3*Math.ceil(e.length/4))),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var c=0,l=n=n||0;c<e.length;)r=h[e.charCodeAt(c++)-43],i=h[e.charCodeAt(c++)-43],o=h[e.charCodeAt(c++)-43],s=h[e.charCodeAt(c++)-43],a[l++]=r<<2|i>>4,64!==o&&(a[l++]=(15&i)<<4|o>>2,64!==s&&(a[l++]=(3&o)<<6|s));return t?l-n:a.subarray(0,l)},a.binary.base58.encode=function(e,t){return a.binary.baseN.encode(e,d,t)},a.binary.base58.decode=function(e,t){return a.binary.baseN.decode(e,d,t)},a.text={utf8:{},utf16:{}},a.text.utf8.encode=function(e,t,n){e=a.encodeUtf8(e);var r=t;r||(r=new Uint8Array(e.length));for(var i=n=n||0,o=0;o<e.length;++o)r[i++]=e.charCodeAt(o);return t?i-n:r},a.text.utf8.decode=function(e){return a.decodeUtf8(String.fromCharCode.apply(null,e))},a.text.utf16.encode=function(e,t,n){var r=t;r||(r=new Uint8Array(2*e.length));for(var i=new Uint16Array(r.buffer),o=n=n||0,s=n,a=0;a<e.length;++a)i[s++]=e.charCodeAt(a),o+=2;return t?o-n:r},a.text.utf16.decode=function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))},a.deflate=function(e,t,n){if(t=a.decode64(e.deflate(a.encode64(t)).rval),n){var r=2;32&t.charCodeAt(1)&&(r=6),t=t.substring(r,t.length-4)}return t},a.inflate=function(e,t,n){var r=e.inflate(a.encode64(t)).rval;return null===r?null:a.decode64(r)};var f=function(e,t,n){if(!e)throw new Error("WebStorage not available.");var r;if(null===n?r=e.removeItem(t):(n=a.encode64(JSON.stringify(n)),r=e.setItem(t,n)),"undefined"!==typeof r&&!0!==r.rval){var i=new Error(r.error.message);throw i.id=r.error.id,i.name=r.error.name,i}},p=function(e,t){if(!e)throw new Error("WebStorage not available.");var n=e.getItem(t);if(e.init)if(null===n.rval){if(n.error){var r=new Error(n.error.message);throw r.id=n.error.id,r.name=n.error.name,r}n=null}else n=n.rval;return null!==n&&(n=JSON.parse(a.decode64(n))),n},g=function(e,t,n,r){var i=p(e,t);null===i&&(i={}),i[n]=r,f(e,t,i)},y=function(e,t,n){var r=p(e,t);return null!==r&&(r=n in r?r[n]:null),r},m=function(e,t,n){var r=p(e,t);if(null!==r&&n in r){delete r[n];var i=!0;for(var o in r){i=!1;break}i&&(r=null),f(e,t,r)}},v=function(e,t){f(e,t,null)},b=function(e,t,n){var r,i=null;"undefined"===typeof n&&(n=["web","flash"]);var o=!1,s=null;for(var a in n){r=n[a];try{if("flash"===r||"both"===r){if(null===t[0])throw new Error("Flash local storage not available.");i=e.apply(this,t),o="flash"===r}"web"!==r&&"both"!==r||(t[0]=localStorage,i=e.apply(this,t),o=!0)}catch(c){s=c}if(o)break}if(!o)throw s;return i};a.setItem=function(e,t,n,r,i){b(g,arguments,i)},a.getItem=function(e,t,n,r){return b(y,arguments,r)},a.removeItem=function(e,t,n,r){b(m,arguments,r)},a.clearItems=function(e,t,n){b(v,arguments,n)},a.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},a.format=function(e){for(var t,n,r=/%./g,i=0,o=[],s=0;t=r.exec(e);){(n=e.substring(s,r.lastIndex-2)).length>0&&o.push(n),s=r.lastIndex;var a=t[0][1];switch(a){case"s":case"o":i<arguments.length?o.push(arguments[1+i++]):o.push("<?>");break;case"%":o.push("%");break;default:o.push("<%"+a+"?>")}}return o.push(e.substring(s)),o.join("")},a.formatNumber=function(e,t,n,r){var i=e,o=isNaN(t=Math.abs(t))?2:t,s=void 0===n?",":n,a=void 0===r?".":r,c=i<0?"-":"",l=parseInt(i=Math.abs(+i||0).toFixed(o),10)+"",u=l.length>3?l.length%3:0;return c+(u?l.substr(0,u)+a:"")+l.substr(u).replace(/(\d{3})(?=\d)/g,"$1"+a)+(o?s+Math.abs(i-l).toFixed(o).slice(2):"")},a.formatSize=function(e){return e=e>=1073741824?a.formatNumber(e/1073741824,2,".","")+" GiB":e>=1048576?a.formatNumber(e/1048576,2,".","")+" MiB":e>=1024?a.formatNumber(e/1024,0)+" KiB":a.formatNumber(e,0)+" bytes"},a.bytesFromIP=function(e){return-1!==e.indexOf(".")?a.bytesFromIPv4(e):-1!==e.indexOf(":")?a.bytesFromIPv6(e):null},a.bytesFromIPv4=function(e){if(4!==(e=e.split(".")).length)return null;for(var t=a.createBuffer(),n=0;n<e.length;++n){var r=parseInt(e[n],10);if(isNaN(r))return null;t.putByte(r)}return t.getBytes()},a.bytesFromIPv6=function(e){for(var t=0,n=2*(8-(e=e.split(":").filter((function(e){return 0===e.length&&++t,!0}))).length+t),r=a.createBuffer(),i=0;i<8;++i)if(e[i]&&0!==e[i].length){var o=a.hexToBytes(e[i]);o.length<2&&r.putByte(0),r.putBytes(o)}else r.fillWithByte(0,n),n=0;return r.getBytes()},a.bytesToIP=function(e){return 4===e.length?a.bytesToIPv4(e):16===e.length?a.bytesToIPv6(e):null},a.bytesToIPv4=function(e){if(4!==e.length)return null;for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t.join(".")},a.bytesToIPv6=function(e){if(16!==e.length)return null;for(var t=[],n=[],r=0,i=0;i<e.length;i+=2){for(var o=a.bytesToHex(e[i]+e[i+1]);"0"===o[0]&&"0"!==o;)o=o.substr(1);if("0"===o){var s=n[n.length-1],c=t.length;s&&c===s.end+1?(s.end=c,s.end-s.start>n[r].end-n[r].start&&(r=n.length-1)):n.push({start:c,end:c})}t.push(o)}if(n.length>0){var l=n[r];l.end-l.start>0&&(t.splice(l.start,l.end-l.start+1,""),0===l.start&&t.unshift(""),7===l.end&&t.push(""))}return t.join(":")},a.estimateCores=function(e,t){if("function"===typeof e&&(t=e,e={}),e=e||{},"cores"in a&&!e.update)return t(null,a.cores);if("undefined"!==typeof navigator&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return a.cores=navigator.hardwareConcurrency,t(null,a.cores);if("undefined"===typeof Worker)return a.cores=1,t(null,a.cores);if("undefined"===typeof Blob)return a.cores=2,t(null,a.cores);var n=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",(function(e){for(var t=Date.now(),n=t+4;Date.now()<n;);self.postMessage({st:t,et:n})}))}.toString(),")()"],{type:"application/javascript"}));!function e(r,i,o){if(0===i){var s=Math.floor(r.reduce((function(e,t){return e+t}),0)/r.length);return a.cores=Math.max(1,s),URL.revokeObjectURL(n),t(null,a.cores)}!function(e,t){for(var r=[],i=[],o=0;o<e;++o){var s=new Worker(n);s.addEventListener("message",(function(n){if(i.push(n.data),i.length===e){for(var o=0;o<e;++o)r[o].terminate();t(null,i)}})),r.push(s)}for(o=0;o<e;++o)r[o].postMessage(o)}(o,(function(t,n){r.push(function(e,t){for(var n=[],r=0;r<e;++r)for(var i=t[r],o=n[r]=[],s=0;s<e;++s)if(r!==s){var a=t[s];(i.st>a.st&&i.st<a.et||a.st>i.st&&a.st<i.et)&&o.push(s)}return n.reduce((function(e,t){return Math.max(e,t.length)}),0)}(o,n)),e(r,i-1,o)}))}([],5,16)}},31725:e=>{"use strict";var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(i){return!1}}()?Object.assign:function(e,i){for(var o,s,a=function(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),c=1;c<arguments.length;c++){for(var l in o=Object(arguments[c]))n.call(o,l)&&(a[l]=o[l]);if(t){s=t(o);for(var u=0;u<s.length;u++)r.call(o,s[u])&&(a[s[u]]=o[s[u]])}}return a}},11842:(e,t)=>{t.endianness=function(){return"LE"},t.hostname=function(){return"undefined"!==typeof location?location.hostname:""},t.loadavg=function(){return[]},t.uptime=function(){return 0},t.freemem=function(){return Number.MAX_VALUE},t.totalmem=function(){return Number.MAX_VALUE},t.cpus=function(){return[]},t.type=function(){return"Browser"},t.release=function(){return"undefined"!==typeof navigator?navigator.appVersion:""},t.networkInterfaces=t.getNetworkInterfaces=function(){return{}},t.arch=function(){return"javascript"},t.platform=function(){return"browser"},t.tmpdir=t.tmpDir=function(){return"/tmp"},t.EOL="\n",t.homedir=function(){return"/"}},23596:(e,t,n)=>{"use strict";const r=n(57528),i=n(77288),o=n(3781),s=new WeakMap;e.exports=function(e){let{cachePromiseRejection:t=!1,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{maxAge:a,cacheKey:c}=n,l=n.cache||new Map;if(Number.isSafeInteger(a))i(l);else if("undefined"!==typeof a)throw new TypeError("maxAge is not a safe integer.");const u=async function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];const s=c?c(r):r[0],u=l.get(s);if(u)return u.data;const h=e.apply(this,r);l.set(s,{data:h,maxAge:2**31-1});const[{reason:d}]=await o([h]);return!t&&d?l.delete(s):a&&l.set(s,{data:h,maxAge:Date.now()+a}),h};return r(u,e),s.set(u,l),u},e.exports.clear=e=>{if(!s.has(e))throw new Error("Can't clear a function that was not memoized!");const t=s.get(e);if("function"!==typeof t.clear)throw new TypeError("The cache Map can't be cleared!");t.clear()}},57528:e=>{"use strict";const t=(e,t,r,i)=>{if("length"===r||"prototype"===r)return;if("arguments"===r||"caller"===r)return;const o=Object.getOwnPropertyDescriptor(e,r),s=Object.getOwnPropertyDescriptor(t,r);!n(o,s)&&i||Object.defineProperty(e,r,s)},n=function(e,t){return void 0===e||e.configurable||e.writable===t.writable&&e.enumerable===t.enumerable&&e.configurable===t.configurable&&(e.writable||e.value===t.value)},r=(e,t)=>"/* Wrapped ".concat(e,"*/\n").concat(t),i=Object.getOwnPropertyDescriptor(Function.prototype,"toString"),o=Object.getOwnPropertyDescriptor(Function.prototype.toString,"name");e.exports=function(e,n){let{ignoreNonConfigurable:s=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{name:a}=e;for(const r of Reflect.ownKeys(n))t(e,n,r,s);return((e,t)=>{const n=Object.getPrototypeOf(t);n!==Object.getPrototypeOf(e)&&Object.setPrototypeOf(e,n)})(e,n),((e,t,n)=>{const s=""===n?"":"with ".concat(n.trim(),"() "),a=r.bind(null,s,t.toString());Object.defineProperty(a,"name",o),Object.defineProperty(e,"toString",{...i,value:a})})(e,n,a),e}},68702:(e,t,n)=>{"use strict";n.d(t,{Z:()=>Z});var r=n(97143),i=n.n(r);class o extends Error{constructor(e){super(e),this.name="TimeoutError"}}class s extends Error{constructor(e){super(),this.name="AbortError",this.message=e}}const a=e=>void 0===globalThis.DOMException?new s(e):new DOMException(e),c=e=>{const t=void 0===e.reason?a("This operation was aborted."):e.reason;return t instanceof Error?t:a(t)};var l,u=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};l=new WeakMap;const h=class{constructor(){l.set(this,[])}enqueue(e,t){const n={priority:(t={priority:0,...t}).priority,run:e};if(this.size&&u(this,l,"f")[this.size-1].priority>=t.priority)return void u(this,l,"f").push(n);const r=function(e,t,n){let r=0,i=e.length;for(;i>0;){const o=Math.trunc(i/2);let s=r+o;n(e[s],t)<=0?(r=++s,i-=o+1):i=o}return r}(u(this,l,"f"),n,((e,t)=>t.priority-e.priority));u(this,l,"f").splice(r,0,n)}dequeue(){const e=u(this,l,"f").shift();return null===e||void 0===e?void 0:e.run}filter(e){return u(this,l,"f").filter((t=>t.priority===e.priority)).map((e=>e.run))}get size(){return u(this,l,"f").length}};var d,f,p,g,y,m,v,b,w,E,A,S,_,I,C,T,k,R,x,P,D,O,N,B,L,M,U=function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n},F=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};class K extends Error{}class j extends(i()){constructor(e){var t,n,r,i;if(super(),d.add(this),f.set(this,void 0),p.set(this,void 0),g.set(this,0),y.set(this,void 0),m.set(this,void 0),v.set(this,0),b.set(this,void 0),w.set(this,void 0),E.set(this,void 0),A.set(this,void 0),S.set(this,0),_.set(this,void 0),I.set(this,void 0),C.set(this,void 0),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!("number"===typeof(e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:h,...e}).intervalCap&&e.intervalCap>=1))throw new TypeError("Expected `intervalCap` to be a number from 1 and up, got `".concat(null!==(n=null===(t=e.intervalCap)||void 0===t?void 0:t.toString())&&void 0!==n?n:"","` (").concat(typeof e.intervalCap,")"));if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError("Expected `interval` to be a finite number >= 0, got `".concat(null!==(i=null===(r=e.interval)||void 0===r?void 0:r.toString())&&void 0!==i?i:"","` (").concat(typeof e.interval,")"));U(this,f,e.carryoverConcurrencyCount,"f"),U(this,p,e.intervalCap===Number.POSITIVE_INFINITY||0===e.interval,"f"),U(this,y,e.intervalCap,"f"),U(this,m,e.interval,"f"),U(this,E,new e.queueClass,"f"),U(this,A,e.queueClass,"f"),this.concurrency=e.concurrency,this.timeout=e.timeout,U(this,C,!0===e.throwOnTimeout,"f"),U(this,I,!1===e.autoStart,"f")}get concurrency(){return F(this,_,"f")}set concurrency(e){if(!("number"===typeof e&&e>=1))throw new TypeError("Expected `concurrency` to be a number from 1 and up, got `".concat(e,"` (").concat(typeof e,")"));U(this,_,e,"f"),F(this,d,"m",B).call(this)}async add(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t={timeout:this.timeout,throwOnTimeout:F(this,C,"f"),...t},new Promise(((n,r)=>{F(this,E,"f").enqueue((async()=>{var i,s,a;U(this,S,(s=F(this,S,"f"),++s),"f"),U(this,g,(a=F(this,g,"f"),++a),"f");try{if(null===(i=t.signal)||void 0===i?void 0:i.aborted)throw new K("The task was aborted.");let r=e({signal:t.signal});t.timeout&&(r=function(e,t,n,r){let i;const s=new Promise(((s,a)=>{if("number"!==typeof t||1!==Math.sign(t))throw new TypeError("Expected `milliseconds` to be a positive number, got `".concat(t,"`"));if(t!==Number.POSITIVE_INFINITY){if((r={customTimers:{setTimeout:setTimeout,clearTimeout:clearTimeout},...r}).signal){const{signal:e}=r;e.aborted&&a(c(e)),e.addEventListener("abort",(()=>{a(c(e))}))}i=r.customTimers.setTimeout.call(void 0,(()=>{if("function"===typeof n){try{s(n())}catch(c){a(c)}return}const r="string"===typeof n?n:"Promise timed out after ".concat(t," milliseconds"),i=n instanceof Error?n:new o(r);"function"===typeof e.cancel&&e.cancel(),a(i)}),t),(async()=>{try{s(await e)}catch(t){a(t)}finally{r.customTimers.clearTimeout.call(void 0,i)}})()}else s(e)}));return s.clear=()=>{clearTimeout(i),i=void 0},s}(Promise.resolve(r),t.timeout)),t.signal&&(r=Promise.race([r,F(this,d,"m",L).call(this,t.signal)]));const s=await r;n(s),this.emit("completed",s)}catch(l){if(l instanceof o&&!t.throwOnTimeout)return void n();r(l),this.emit("error",l)}finally{F(this,d,"m",R).call(this)}}),t),this.emit("add"),F(this,d,"m",D).call(this)}))}async addAll(e,t){return Promise.all(e.map((async e=>this.add(e,t))))}start(){return F(this,I,"f")?(U(this,I,!1,"f"),F(this,d,"m",B).call(this),this):this}pause(){U(this,I,!0,"f")}clear(){U(this,E,new(F(this,A,"f")),"f")}async onEmpty(){0!==F(this,E,"f").size&&await F(this,d,"m",M).call(this,"empty")}async onSizeLessThan(e){F(this,E,"f").size<e||await F(this,d,"m",M).call(this,"next",(()=>F(this,E,"f").size<e))}async onIdle(){0===F(this,S,"f")&&0===F(this,E,"f").size||await F(this,d,"m",M).call(this,"idle")}get size(){return F(this,E,"f").size}sizeBy(e){return F(this,E,"f").filter(e).length}get pending(){return F(this,S,"f")}get isPaused(){return F(this,I,"f")}}f=new WeakMap,p=new WeakMap,g=new WeakMap,y=new WeakMap,m=new WeakMap,v=new WeakMap,b=new WeakMap,w=new WeakMap,E=new WeakMap,A=new WeakMap,S=new WeakMap,_=new WeakMap,I=new WeakMap,C=new WeakMap,d=new WeakSet,T=function(){return F(this,p,"f")||F(this,g,"f")<F(this,y,"f")},k=function(){return F(this,S,"f")<F(this,_,"f")},R=function(){var e;U(this,S,(e=F(this,S,"f"),--e),"f"),F(this,d,"m",D).call(this),this.emit("next")},x=function(){F(this,d,"m",N).call(this),F(this,d,"m",O).call(this),U(this,w,void 0,"f")},P=function(){const e=Date.now();if(void 0===F(this,b,"f")){const t=F(this,v,"f")-e;if(!(t<0))return void 0===F(this,w,"f")&&U(this,w,setTimeout((()=>{F(this,d,"m",x).call(this)}),t),"f"),!0;U(this,g,F(this,f,"f")?F(this,S,"f"):0,"f")}return!1},D=function(){if(0===F(this,E,"f").size)return F(this,b,"f")&&clearInterval(F(this,b,"f")),U(this,b,void 0,"f"),this.emit("empty"),0===F(this,S,"f")&&this.emit("idle"),!1;if(!F(this,I,"f")){const e=!F(this,d,"a",P);if(F(this,d,"a",T)&&F(this,d,"a",k)){const t=F(this,E,"f").dequeue();return!!t&&(this.emit("active"),t(),e&&F(this,d,"m",O).call(this),!0)}}return!1},O=function(){F(this,p,"f")||void 0!==F(this,b,"f")||(U(this,b,setInterval((()=>{F(this,d,"m",N).call(this)}),F(this,m,"f")),"f"),U(this,v,Date.now()+F(this,m,"f"),"f"))},N=function(){0===F(this,g,"f")&&0===F(this,S,"f")&&F(this,b,"f")&&(clearInterval(F(this,b,"f")),U(this,b,void 0,"f")),U(this,g,F(this,f,"f")?F(this,S,"f"):0,"f"),F(this,d,"m",B).call(this)},B=function(){for(;F(this,d,"m",D).call(this););},L=async function(e){return new Promise(((t,n)=>{e.addEventListener("abort",(()=>{n(new K("The task was aborted."))}),{once:!0})}))},M=async function(e,t){return new Promise((n=>{const r=()=>{t&&!t()||(this.off(e,r),n())};this.on(e,r)}))};const Z=j},92963:e=>{"use strict";const t=async e=>{try{return{isFulfilled:!0,isRejected:!1,value:await e}}catch(t){return{isFulfilled:!1,isRejected:!0,reason:t}}};e.exports=t,e.exports.default=t},3781:(e,t,n)=>{"use strict";const r=n(92963),i=n(56266);e.exports=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{concurrency:n=1/0}=t,o=i(n);return Promise.all(e.map((e=>e&&"function"===typeof e.then?r(e):r("function"===typeof e?o((()=>e())):Promise.resolve(e)))))}},56266:(e,t,n)=>{"use strict";const r=n(23731),i=e=>{if(!Number.isInteger(e)&&e!==1/0||!(e>0))return Promise.reject(new TypeError("Expected `concurrency` to be a number from 1 and up"));const t=[];let n=0;const i=()=>{n--,t.length>0&&t.shift()()},o=function(e,t){n++;for(var o=arguments.length,s=new Array(o>2?o-2:0),a=2;a<o;a++)s[a-2]=arguments[a];const c=r(e,...s);t(c),c.then(i,i)},s=function(r){for(var i=arguments.length,s=new Array(i>1?i-1:0),a=1;a<i;a++)s[a-1]=arguments[a];return new Promise((i=>function(r,i){for(var s=arguments.length,a=new Array(s>2?s-2:0),c=2;c<s;c++)a[c-2]=arguments[c];n<e?o(r,i,...a):t.push(o.bind(null,r,i,...a))}(r,i,...s)))};return Object.defineProperties(s,{activeCount:{get:()=>n},pendingCount:{get:()=>t.length},clearQueue:{value:()=>{t.length=0}}}),s};e.exports=i,e.exports.default=i},23731:e=>{"use strict";const t=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return new Promise((t=>{t(e(...n))}))};e.exports=t,e.exports.default=t},22910:(e,t,n)=>{var r=n(17870);e.exports=function(e,t){return r(e,t,"-")}},87265:(e,t,n)=>{var r=n(97394),i=n(32996);e.exports=function(e,t,n){return i(r(e,t,n),t)}},15102:(e,t,n)=>{var r=n(17870);e.exports=function(e,t){return r(e,t,"/")}},43809:e=>{"function"===typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},49499:e=>{e.exports=function(e){return e&&"object"===typeof e&&"function"===typeof e.copy&&"function"===typeof e.fill&&"function"===typeof e.readUInt8}},50145:(e,t,n)=>{var r=n(1426),i=/%[sdj%]/g;t.format=function(e){if(!m(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(a(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,o=r.length,s=String(e).replace(i,(function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return e}})),c=r[n];n<o;c=r[++n])g(c)||!w(c)?s+=" "+c:s+=" "+a(c);return s},t.deprecate=function(e,i){if(v(n.g.process))return function(){return t.deprecate(e,i).apply(this,arguments)};if(!0===r.noDeprecation)return e;var o=!1;return function(){if(!o){if(r.throwDeprecation)throw new Error(i);r.traceDeprecation?console.trace(i):console.error(i),o=!0}return e.apply(this,arguments)}};var o,s={};function a(e,n){var r={seen:[],stylize:l};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),p(n)?r.showHidden=n:n&&t._extend(r,n),v(r.showHidden)&&(r.showHidden=!1),v(r.depth)&&(r.depth=2),v(r.colors)&&(r.colors=!1),v(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=c),u(r,e,r.depth)}function c(e,t){var n=a.styles[t];return n?"\x1b["+a.colors[n][0]+"m"+e+"\x1b["+a.colors[n][1]+"m":e}function l(e,t){return e}function u(e,n,r){if(e.customInspect&&n&&S(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,e);return m(i)||(i=u(e,i,r)),i}var o=function(e,t){if(v(t))return e.stylize("undefined","undefined");if(m(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}if(y(t))return e.stylize(""+t,"number");if(p(t))return e.stylize(""+t,"boolean");if(g(t))return e.stylize("null","null")}(e,n);if(o)return o;var s=Object.keys(n),a=function(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}(s);if(e.showHidden&&(s=Object.getOwnPropertyNames(n)),A(n)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return h(n);if(0===s.length){if(S(n)){var c=n.name?": "+n.name:"";return e.stylize("[Function"+c+"]","special")}if(b(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(E(n))return e.stylize(Date.prototype.toString.call(n),"date");if(A(n))return h(n)}var l,w="",_=!1,I=["{","}"];(f(n)&&(_=!0,I=["[","]"]),S(n))&&(w=" [Function"+(n.name?": "+n.name:"")+"]");return b(n)&&(w=" "+RegExp.prototype.toString.call(n)),E(n)&&(w=" "+Date.prototype.toUTCString.call(n)),A(n)&&(w=" "+h(n)),0!==s.length||_&&0!=n.length?r<0?b(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),l=_?function(e,t,n,r,i){for(var o=[],s=0,a=t.length;s<a;++s)T(t,String(s))?o.push(d(e,t,n,r,String(s),!0)):o.push("");return i.forEach((function(i){i.match(/^\d+$/)||o.push(d(e,t,n,r,i,!0))})),o}(e,n,r,a,s):s.map((function(t){return d(e,n,r,a,t,_)})),e.seen.pop(),function(e,t,n){var r=e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0);if(r>60)return n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1];return n[0]+t+" "+e.join(", ")+" "+n[1]}(l,w,I)):I[0]+w+I[1]}function h(e){return"["+Error.prototype.toString.call(e)+"]"}function d(e,t,n,r,i,o){var s,a,c;if((c=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?a=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(a=e.stylize("[Setter]","special")),T(r,i)||(s="["+i+"]"),a||(e.seen.indexOf(c.value)<0?(a=g(n)?u(e,c.value,null):u(e,c.value,n-1)).indexOf("\n")>-1&&(a=o?a.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+a.split("\n").map((function(e){return"   "+e})).join("\n")):a=e.stylize("[Circular]","special")),v(s)){if(o&&i.match(/^\d+$/))return a;(s=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+a}function f(e){return Array.isArray(e)}function p(e){return"boolean"===typeof e}function g(e){return null===e}function y(e){return"number"===typeof e}function m(e){return"string"===typeof e}function v(e){return void 0===e}function b(e){return w(e)&&"[object RegExp]"===_(e)}function w(e){return"object"===typeof e&&null!==e}function E(e){return w(e)&&"[object Date]"===_(e)}function A(e){return w(e)&&("[object Error]"===_(e)||e instanceof Error)}function S(e){return"function"===typeof e}function _(e){return Object.prototype.toString.call(e)}function I(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(e){if(v(o)&&(o={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_GIT_REV:"9c10520",REACT_APP_VERSION:"4.2.1"}.NODE_DEBUG||""),e=e.toUpperCase(),!s[e])if(new RegExp("\\b"+e+"\\b","i").test(o)){var n=r.pid;s[e]=function(){var r=t.format.apply(t,arguments);console.error("%s %d: %s",e,n,r)}}else s[e]=function(){};return s[e]},t.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=f,t.isBoolean=p,t.isNull=g,t.isNullOrUndefined=function(e){return null==e},t.isNumber=y,t.isString=m,t.isSymbol=function(e){return"symbol"===typeof e},t.isUndefined=v,t.isRegExp=b,t.isObject=w,t.isDate=E,t.isError=A,t.isFunction=S,t.isPrimitive=function(e){return null===e||"boolean"===typeof e||"number"===typeof e||"string"===typeof e||"symbol"===typeof e||"undefined"===typeof e},t.isBuffer=n(49499);var C=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function T(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",function(){var e=new Date,t=[I(e.getHours()),I(e.getMinutes()),I(e.getSeconds())].join(":");return[e.getDate(),C[e.getMonth()],t].join(" ")}(),t.format.apply(t,arguments))},t.inherits=n(43809),t._extend=function(e,t){if(!t||!w(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}},67643:(e,t,n)=>{"use strict";var r=n(1426),i="win32"===r.platform,o=n(50145);function s(e,t){for(var n=[],r=0;r<e.length;r++){var i=e[r];i&&"."!==i&&(".."===i?n.length&&".."!==n[n.length-1]?n.pop():t&&n.push(".."):n.push(i))}return n}function a(e){for(var t=e.length-1,n=0;n<=t&&!e[n];n++);for(var r=t;r>=0&&!e[r];r--);return 0===n&&r===t?e:n>r?[]:e.slice(n,r+1)}var c=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/,l=/^([\s\S]*?)((?:\.{1,2}|[^\\\/]+?|)(\.[^.\/\\]*|))(?:[\\\/]*)$/,u={};function h(e){var t=c.exec(e),n=(t[1]||"")+(t[2]||""),r=t[3]||"",i=l.exec(r);return[n,i[1],i[2],i[3]]}function d(e){var t=c.exec(e),n=t[1]||"",r=!!n&&":"!==n[1];return{device:n,isUnc:r,isAbsolute:r||!!t[2],tail:t[3]}}function f(e){return"\\\\"+e.replace(/^[\\\/]+/,"").replace(/[\\\/]+/g,"\\")}u.resolve=function(){for(var e="",t="",n=!1,i=arguments.length-1;i>=-1;i--){var a;if(i>=0?a=arguments[i]:e?(a={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_GIT_REV:"9c10520",REACT_APP_VERSION:"4.2.1"}["="+e])&&a.substr(0,3).toLowerCase()===e.toLowerCase()+"\\"||(a=e+"\\"):a=r.cwd(),!o.isString(a))throw new TypeError("Arguments to path.resolve must be strings");if(a){var c=d(a),l=c.device,u=c.isUnc,h=c.isAbsolute,p=c.tail;if((!l||!e||l.toLowerCase()===e.toLowerCase())&&(e||(e=l),n||(t=p+"\\"+t,n=h),e&&n))break}}return u&&(e=f(e)),e+(n?"\\":"")+(t=s(t.split(/[\\\/]+/),!n).join("\\"))||"."},u.normalize=function(e){var t=d(e),n=t.device,r=t.isUnc,i=t.isAbsolute,o=t.tail,a=/[\\\/]$/.test(o);return(o=s(o.split(/[\\\/]+/),!i).join("\\"))||i||(o="."),o&&a&&(o+="\\"),r&&(n=f(n)),n+(i?"\\":"")+o},u.isAbsolute=function(e){return d(e).isAbsolute},u.join=function(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(!o.isString(n))throw new TypeError("Arguments to path.join must be strings");n&&e.push(n)}var r=e.join("\\");return/^[\\\/]{2}[^\\\/]/.test(e[0])||(r=r.replace(/^[\\\/]{2,}/,"\\")),u.normalize(r)},u.relative=function(e,t){e=u.resolve(e),t=u.resolve(t);for(var n=e.toLowerCase(),r=t.toLowerCase(),i=a(t.split("\\")),o=a(n.split("\\")),s=a(r.split("\\")),c=Math.min(o.length,s.length),l=c,h=0;h<c;h++)if(o[h]!==s[h]){l=h;break}if(0==l)return t;var d=[];for(h=l;h<o.length;h++)d.push("..");return(d=d.concat(i.slice(l))).join("\\")},u._makeLong=function(e){if(!o.isString(e))return e;if(!e)return"";var t=u.resolve(e);return/^[a-zA-Z]\:\\/.test(t)?"\\\\?\\"+t:/^\\\\[^?.]/.test(t)?"\\\\?\\UNC\\"+t.substring(2):e},u.dirname=function(e){var t=h(e),n=t[0],r=t[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},u.basename=function(e,t){var n=h(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},u.extname=function(e){return h(e)[3]},u.format=function(e){if(!o.isObject(e))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof e);var t=e.root||"";if(!o.isString(t))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof e.root);var n=e.dir,r=e.base||"";return n?n[n.length-1]===u.sep?n+r:n+u.sep+r:r},u.parse=function(e){if(!o.isString(e))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof e);var t=h(e);if(!t||4!==t.length)throw new TypeError("Invalid path '"+e+"'");return{root:t[0],dir:t[0]+t[1].slice(0,-1),base:t[2],ext:t[3],name:t[2].slice(0,t[2].length-t[3].length)}},u.sep="\\",u.delimiter=";";var p=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,g={};function y(e){return p.exec(e).slice(1)}g.resolve=function(){for(var e="",t=!1,n=arguments.length-1;n>=-1&&!t;n--){var i=n>=0?arguments[n]:r.cwd();if(!o.isString(i))throw new TypeError("Arguments to path.resolve must be strings");i&&(e=i+"/"+e,t="/"===i[0])}return(t?"/":"")+(e=s(e.split("/"),!t).join("/"))||"."},g.normalize=function(e){var t=g.isAbsolute(e),n=e&&"/"===e[e.length-1];return(e=s(e.split("/"),!t).join("/"))||t||(e="."),e&&n&&(e+="/"),(t?"/":"")+e},g.isAbsolute=function(e){return"/"===e.charAt(0)},g.join=function(){for(var e="",t=0;t<arguments.length;t++){var n=arguments[t];if(!o.isString(n))throw new TypeError("Arguments to path.join must be strings");n&&(e+=e?"/"+n:n)}return g.normalize(e)},g.relative=function(e,t){e=g.resolve(e).substr(1),t=g.resolve(t).substr(1);for(var n=a(e.split("/")),r=a(t.split("/")),i=Math.min(n.length,r.length),o=i,s=0;s<i;s++)if(n[s]!==r[s]){o=s;break}var c=[];for(s=o;s<n.length;s++)c.push("..");return(c=c.concat(r.slice(o))).join("/")},g._makeLong=function(e){return e},g.dirname=function(e){var t=y(e),n=t[0],r=t[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},g.basename=function(e,t){var n=y(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},g.extname=function(e){return y(e)[3]},g.format=function(e){if(!o.isObject(e))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof e);var t=e.root||"";if(!o.isString(t))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof e.root);return(e.dir?e.dir+g.sep:"")+(e.base||"")},g.parse=function(e){if(!o.isString(e))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof e);var t=y(e);if(!t||4!==t.length)throw new TypeError("Invalid path '"+e+"'");return t[1]=t[1]||"",t[2]=t[2]||"",t[3]=t[3]||"",{root:t[0],dir:t[0]+t[1].slice(0,-1),base:t[2],ext:t[3],name:t[2].slice(0,t[2].length-t[3].length)}},g.sep="/",g.delimiter=":",e.exports=i?u:g,e.exports.posix=g,e.exports.win32=u},33187:(e,t,n)=>{"use strict";n.d(t,{Z:()=>se});var r="undefined"!==typeof window&&"undefined"!==typeof document&&"undefined"!==typeof navigator,i=function(){for(var e=["Edge","Trident","Firefox"],t=0;t<e.length;t+=1)if(r&&navigator.userAgent.indexOf(e[t])>=0)return 1;return 0}();var o=r&&window.Promise?function(e){var t=!1;return function(){t||(t=!0,window.Promise.resolve().then((function(){t=!1,e()})))}}:function(e){var t=!1;return function(){t||(t=!0,setTimeout((function(){t=!1,e()}),i))}};function s(e){return e&&"[object Function]"==={}.toString.call(e)}function a(e,t){if(1!==e.nodeType)return[];var n=e.ownerDocument.defaultView.getComputedStyle(e,null);return t?n[t]:n}function c(e){return"HTML"===e.nodeName?e:e.parentNode||e.host}function l(e){if(!e)return document.body;switch(e.nodeName){case"HTML":case"BODY":return e.ownerDocument.body;case"#document":return e.body}var t=a(e),n=t.overflow,r=t.overflowX,i=t.overflowY;return/(auto|scroll|overlay)/.test(n+i+r)?e:l(c(e))}function u(e){return e&&e.referenceNode?e.referenceNode:e}var h=r&&!(!window.MSInputMethodContext||!document.documentMode),d=r&&/MSIE 10/.test(navigator.userAgent);function f(e){return 11===e?h:10===e?d:h||d}function p(e){if(!e)return document.documentElement;for(var t=f(10)?document.body:null,n=e.offsetParent||null;n===t&&e.nextElementSibling;)n=(e=e.nextElementSibling).offsetParent;var r=n&&n.nodeName;return r&&"BODY"!==r&&"HTML"!==r?-1!==["TH","TD","TABLE"].indexOf(n.nodeName)&&"static"===a(n,"position")?p(n):n:e?e.ownerDocument.documentElement:document.documentElement}function g(e){return null!==e.parentNode?g(e.parentNode):e}function y(e,t){if(!e||!e.nodeType||!t||!t.nodeType)return document.documentElement;var n=e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_FOLLOWING,r=n?e:t,i=n?t:e,o=document.createRange();o.setStart(r,0),o.setEnd(i,0);var s=o.commonAncestorContainer;if(e!==s&&t!==s||r.contains(i))return function(e){var t=e.nodeName;return"BODY"!==t&&("HTML"===t||p(e.firstElementChild)===e)}(s)?s:p(s);var a=g(e);return a.host?y(a.host,t):y(e,g(t).host)}function m(e){var t="top"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top")?"scrollTop":"scrollLeft",n=e.nodeName;if("BODY"===n||"HTML"===n){var r=e.ownerDocument.documentElement;return(e.ownerDocument.scrollingElement||r)[t]}return e[t]}function v(e,t){var n="x"===t?"Left":"Top",r="Left"===n?"Right":"Bottom";return parseFloat(e["border"+n+"Width"])+parseFloat(e["border"+r+"Width"])}function b(e,t,n,r){return Math.max(t["offset"+e],t["scroll"+e],n["client"+e],n["offset"+e],n["scroll"+e],f(10)?parseInt(n["offset"+e])+parseInt(r["margin"+("Height"===e?"Top":"Left")])+parseInt(r["margin"+("Height"===e?"Bottom":"Right")]):0)}function w(e){var t=e.body,n=e.documentElement,r=f(10)&&getComputedStyle(n);return{height:b("Height",t,n,r),width:b("Width",t,n,r)}}var E=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),A=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},S=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function _(e){return S({},e,{right:e.left+e.width,bottom:e.top+e.height})}function I(e){var t={};try{if(f(10)){t=e.getBoundingClientRect();var n=m(e,"top"),r=m(e,"left");t.top+=n,t.left+=r,t.bottom+=n,t.right+=r}else t=e.getBoundingClientRect()}catch(d){}var i={left:t.left,top:t.top,width:t.right-t.left,height:t.bottom-t.top},o="HTML"===e.nodeName?w(e.ownerDocument):{},s=o.width||e.clientWidth||i.width,c=o.height||e.clientHeight||i.height,l=e.offsetWidth-s,u=e.offsetHeight-c;if(l||u){var h=a(e);l-=v(h,"x"),u-=v(h,"y"),i.width-=l,i.height-=u}return _(i)}function C(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=f(10),i="HTML"===t.nodeName,o=I(e),s=I(t),c=l(e),u=a(t),h=parseFloat(u.borderTopWidth),d=parseFloat(u.borderLeftWidth);n&&i&&(s.top=Math.max(s.top,0),s.left=Math.max(s.left,0));var p=_({top:o.top-s.top-h,left:o.left-s.left-d,width:o.width,height:o.height});if(p.marginTop=0,p.marginLeft=0,!r&&i){var g=parseFloat(u.marginTop),y=parseFloat(u.marginLeft);p.top-=h-g,p.bottom-=h-g,p.left-=d-y,p.right-=d-y,p.marginTop=g,p.marginLeft=y}return(r&&!n?t.contains(c):t===c&&"BODY"!==c.nodeName)&&(p=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=m(t,"top"),i=m(t,"left"),o=n?-1:1;return e.top+=r*o,e.bottom+=r*o,e.left+=i*o,e.right+=i*o,e}(p,t)),p}function T(e){var t=e.nodeName;if("BODY"===t||"HTML"===t)return!1;if("fixed"===a(e,"position"))return!0;var n=c(e);return!!n&&T(n)}function k(e){if(!e||!e.parentElement||f())return document.documentElement;for(var t=e.parentElement;t&&"none"===a(t,"transform");)t=t.parentElement;return t||document.documentElement}function R(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o={top:0,left:0},s=i?k(e):y(e,u(t));if("viewport"===r)o=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.ownerDocument.documentElement,r=C(e,n),i=Math.max(n.clientWidth,window.innerWidth||0),o=Math.max(n.clientHeight,window.innerHeight||0),s=t?0:m(n),a=t?0:m(n,"left");return _({top:s-r.top+r.marginTop,left:a-r.left+r.marginLeft,width:i,height:o})}(s,i);else{var a=void 0;"scrollParent"===r?"BODY"===(a=l(c(t))).nodeName&&(a=e.ownerDocument.documentElement):a="window"===r?e.ownerDocument.documentElement:r;var h=C(a,s,i);if("HTML"!==a.nodeName||T(s))o=h;else{var d=w(e.ownerDocument),f=d.height,p=d.width;o.top+=h.top-h.marginTop,o.bottom=f+h.top,o.left+=h.left-h.marginLeft,o.right=p+h.left}}var g="number"===typeof(n=n||0);return o.left+=g?n:n.left||0,o.top+=g?n:n.top||0,o.right-=g?n:n.right||0,o.bottom-=g?n:n.bottom||0,o}function x(e,t,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(-1===e.indexOf("auto"))return e;var s=R(n,r,o,i),a={top:{width:s.width,height:t.top-s.top},right:{width:s.right-t.right,height:s.height},bottom:{width:s.width,height:s.bottom-t.bottom},left:{width:t.left-s.left,height:s.height}},c=Object.keys(a).map((function(e){return S({key:e},a[e],{area:(t=a[e],t.width*t.height)});var t})).sort((function(e,t){return t.area-e.area})),l=c.filter((function(e){var t=e.width,r=e.height;return t>=n.clientWidth&&r>=n.clientHeight})),u=l.length>0?l[0].key:c[0].key,h=e.split("-")[1];return u+(h?"-"+h:"")}function P(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return C(n,r?k(t):y(t,u(n)),r)}function D(e){var t=e.ownerDocument.defaultView.getComputedStyle(e),n=parseFloat(t.marginTop||0)+parseFloat(t.marginBottom||0),r=parseFloat(t.marginLeft||0)+parseFloat(t.marginRight||0);return{width:e.offsetWidth+r,height:e.offsetHeight+n}}function O(e){var t={left:"right",right:"left",bottom:"top",top:"bottom"};return e.replace(/left|right|bottom|top/g,(function(e){return t[e]}))}function N(e,t,n){n=n.split("-")[0];var r=D(e),i={width:r.width,height:r.height},o=-1!==["right","left"].indexOf(n),s=o?"top":"left",a=o?"left":"top",c=o?"height":"width",l=o?"width":"height";return i[s]=t[s]+t[c]/2-r[c]/2,i[a]=n===a?t[a]-r[l]:t[O(a)],i}function B(e,t){return Array.prototype.find?e.find(t):e.filter(t)[0]}function L(e,t,n){return(void 0===n?e:e.slice(0,function(e,t,n){if(Array.prototype.findIndex)return e.findIndex((function(e){return e[t]===n}));var r=B(e,(function(e){return e[t]===n}));return e.indexOf(r)}(e,"name",n))).forEach((function(e){e.function&&console.warn("`modifier.function` is deprecated, use `modifier.fn`!");var n=e.function||e.fn;e.enabled&&s(n)&&(t.offsets.popper=_(t.offsets.popper),t.offsets.reference=_(t.offsets.reference),t=n(t,e))})),t}function M(){if(!this.state.isDestroyed){var e={instance:this,styles:{},arrowStyles:{},attributes:{},flipped:!1,offsets:{}};e.offsets.reference=P(this.state,this.popper,this.reference,this.options.positionFixed),e.placement=x(this.options.placement,e.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding),e.originalPlacement=e.placement,e.positionFixed=this.options.positionFixed,e.offsets.popper=N(this.popper,e.offsets.reference,e.placement),e.offsets.popper.position=this.options.positionFixed?"fixed":"absolute",e=L(this.modifiers,e),this.state.isCreated?this.options.onUpdate(e):(this.state.isCreated=!0,this.options.onCreate(e))}}function U(e,t){return e.some((function(e){var n=e.name;return e.enabled&&n===t}))}function F(e){for(var t=[!1,"ms","Webkit","Moz","O"],n=e.charAt(0).toUpperCase()+e.slice(1),r=0;r<t.length;r++){var i=t[r],o=i?""+i+n:e;if("undefined"!==typeof document.body.style[o])return o}return null}function K(){return this.state.isDestroyed=!0,U(this.modifiers,"applyStyle")&&(this.popper.removeAttribute("x-placement"),this.popper.style.position="",this.popper.style.top="",this.popper.style.left="",this.popper.style.right="",this.popper.style.bottom="",this.popper.style.willChange="",this.popper.style[F("transform")]=""),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}function j(e){var t=e.ownerDocument;return t?t.defaultView:window}function Z(e,t,n,r){var i="BODY"===e.nodeName,o=i?e.ownerDocument.defaultView:e;o.addEventListener(t,n,{passive:!0}),i||Z(l(o.parentNode),t,n,r),r.push(o)}function z(e,t,n,r){n.updateBound=r,j(e).addEventListener("resize",n.updateBound,{passive:!0});var i=l(e);return Z(i,"scroll",n.updateBound,n.scrollParents),n.scrollElement=i,n.eventsEnabled=!0,n}function V(){this.state.eventsEnabled||(this.state=z(this.reference,this.options,this.state,this.scheduleUpdate))}function H(){var e,t;this.state.eventsEnabled&&(cancelAnimationFrame(this.scheduleUpdate),this.state=(e=this.reference,t=this.state,j(e).removeEventListener("resize",t.updateBound),t.scrollParents.forEach((function(e){e.removeEventListener("scroll",t.updateBound)})),t.updateBound=null,t.scrollParents=[],t.scrollElement=null,t.eventsEnabled=!1,t))}function q(e){return""!==e&&!isNaN(parseFloat(e))&&isFinite(e)}function G(e,t){Object.keys(t).forEach((function(n){var r="";-1!==["width","height","top","right","bottom","left"].indexOf(n)&&q(t[n])&&(r="px"),e.style[n]=t[n]+r}))}var W=r&&/Firefox/i.test(navigator.userAgent);function Q(e,t,n){var r=B(e,(function(e){return e.name===t})),i=!!r&&e.some((function(e){return e.name===n&&e.enabled&&e.order<r.order}));if(!i){var o="`"+t+"`",s="`"+n+"`";console.warn(s+" modifier is required by "+o+" modifier in order to work, be sure to include it before "+o+"!")}return i}var Y=["auto-start","auto","auto-end","top-start","top","top-end","right-start","right","right-end","bottom-end","bottom","bottom-start","left-end","left","left-start"],J=Y.slice(3);function X(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=J.indexOf(e),r=J.slice(n+1).concat(J.slice(0,n));return t?r.reverse():r}var $="flip",ee="clockwise",te="counterclockwise";function ne(e,t,n,r){var i=[0,0],o=-1!==["right","left"].indexOf(r),s=e.split(/(\+|\-)/).map((function(e){return e.trim()})),a=s.indexOf(B(s,(function(e){return-1!==e.search(/,|\s/)})));s[a]&&-1===s[a].indexOf(",")&&console.warn("Offsets separated by white space(s) are deprecated, use a comma (,) instead.");var c=/\s*,\s*|\s+/,l=-1!==a?[s.slice(0,a).concat([s[a].split(c)[0]]),[s[a].split(c)[1]].concat(s.slice(a+1))]:[s];return l=l.map((function(e,r){var i=(1===r?!o:o)?"height":"width",s=!1;return e.reduce((function(e,t){return""===e[e.length-1]&&-1!==["+","-"].indexOf(t)?(e[e.length-1]=t,s=!0,e):s?(e[e.length-1]+=t,s=!1,e):e.concat(t)}),[]).map((function(e){return function(e,t,n,r){var i=e.match(/((?:\-|\+)?\d*\.?\d*)(.*)/),o=+i[1],s=i[2];if(!o)return e;if(0===s.indexOf("%")){return _("%p"===s?n:r)[t]/100*o}if("vh"===s||"vw"===s)return("vh"===s?Math.max(document.documentElement.clientHeight,window.innerHeight||0):Math.max(document.documentElement.clientWidth,window.innerWidth||0))/100*o;return o}(e,i,t,n)}))})),l.forEach((function(e,t){e.forEach((function(n,r){q(n)&&(i[t]+=n*("-"===e[r-1]?-1:1))}))})),i}var re={shift:{order:100,enabled:!0,fn:function(e){var t=e.placement,n=t.split("-")[0],r=t.split("-")[1];if(r){var i=e.offsets,o=i.reference,s=i.popper,a=-1!==["bottom","top"].indexOf(n),c=a?"left":"top",l=a?"width":"height",u={start:A({},c,o[c]),end:A({},c,o[c]+o[l]-s[l])};e.offsets.popper=S({},s,u[r])}return e}},offset:{order:200,enabled:!0,fn:function(e,t){var n=t.offset,r=e.placement,i=e.offsets,o=i.popper,s=i.reference,a=r.split("-")[0],c=void 0;return c=q(+n)?[+n,0]:ne(n,o,s,a),"left"===a?(o.top+=c[0],o.left-=c[1]):"right"===a?(o.top+=c[0],o.left+=c[1]):"top"===a?(o.left+=c[0],o.top-=c[1]):"bottom"===a&&(o.left+=c[0],o.top+=c[1]),e.popper=o,e},offset:0},preventOverflow:{order:300,enabled:!0,fn:function(e,t){var n=t.boundariesElement||p(e.instance.popper);e.instance.reference===n&&(n=p(n));var r=F("transform"),i=e.instance.popper.style,o=i.top,s=i.left,a=i[r];i.top="",i.left="",i[r]="";var c=R(e.instance.popper,e.instance.reference,t.padding,n,e.positionFixed);i.top=o,i.left=s,i[r]=a,t.boundaries=c;var l=t.priority,u=e.offsets.popper,h={primary:function(e){var n=u[e];return u[e]<c[e]&&!t.escapeWithReference&&(n=Math.max(u[e],c[e])),A({},e,n)},secondary:function(e){var n="right"===e?"left":"top",r=u[n];return u[e]>c[e]&&!t.escapeWithReference&&(r=Math.min(u[n],c[e]-("right"===e?u.width:u.height))),A({},n,r)}};return l.forEach((function(e){var t=-1!==["left","top"].indexOf(e)?"primary":"secondary";u=S({},u,h[t](e))})),e.offsets.popper=u,e},priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,fn:function(e){var t=e.offsets,n=t.popper,r=t.reference,i=e.placement.split("-")[0],o=Math.floor,s=-1!==["top","bottom"].indexOf(i),a=s?"right":"bottom",c=s?"left":"top",l=s?"width":"height";return n[a]<o(r[c])&&(e.offsets.popper[c]=o(r[c])-n[l]),n[c]>o(r[a])&&(e.offsets.popper[c]=o(r[a])),e}},arrow:{order:500,enabled:!0,fn:function(e,t){var n;if(!Q(e.instance.modifiers,"arrow","keepTogether"))return e;var r=t.element;if("string"===typeof r){if(!(r=e.instance.popper.querySelector(r)))return e}else if(!e.instance.popper.contains(r))return console.warn("WARNING: `arrow.element` must be child of its popper element!"),e;var i=e.placement.split("-")[0],o=e.offsets,s=o.popper,c=o.reference,l=-1!==["left","right"].indexOf(i),u=l?"height":"width",h=l?"Top":"Left",d=h.toLowerCase(),f=l?"left":"top",p=l?"bottom":"right",g=D(r)[u];c[p]-g<s[d]&&(e.offsets.popper[d]-=s[d]-(c[p]-g)),c[d]+g>s[p]&&(e.offsets.popper[d]+=c[d]+g-s[p]),e.offsets.popper=_(e.offsets.popper);var y=c[d]+c[u]/2-g/2,m=a(e.instance.popper),v=parseFloat(m["margin"+h]),b=parseFloat(m["border"+h+"Width"]),w=y-e.offsets.popper[d]-v-b;return w=Math.max(Math.min(s[u]-g,w),0),e.arrowElement=r,e.offsets.arrow=(A(n={},d,Math.round(w)),A(n,f,""),n),e},element:"[x-arrow]"},flip:{order:600,enabled:!0,fn:function(e,t){if(U(e.instance.modifiers,"inner"))return e;if(e.flipped&&e.placement===e.originalPlacement)return e;var n=R(e.instance.popper,e.instance.reference,t.padding,t.boundariesElement,e.positionFixed),r=e.placement.split("-")[0],i=O(r),o=e.placement.split("-")[1]||"",s=[];switch(t.behavior){case $:s=[r,i];break;case ee:s=X(r);break;case te:s=X(r,!0);break;default:s=t.behavior}return s.forEach((function(a,c){if(r!==a||s.length===c+1)return e;r=e.placement.split("-")[0],i=O(r);var l=e.offsets.popper,u=e.offsets.reference,h=Math.floor,d="left"===r&&h(l.right)>h(u.left)||"right"===r&&h(l.left)<h(u.right)||"top"===r&&h(l.bottom)>h(u.top)||"bottom"===r&&h(l.top)<h(u.bottom),f=h(l.left)<h(n.left),p=h(l.right)>h(n.right),g=h(l.top)<h(n.top),y=h(l.bottom)>h(n.bottom),m="left"===r&&f||"right"===r&&p||"top"===r&&g||"bottom"===r&&y,v=-1!==["top","bottom"].indexOf(r),b=!!t.flipVariations&&(v&&"start"===o&&f||v&&"end"===o&&p||!v&&"start"===o&&g||!v&&"end"===o&&y),w=!!t.flipVariationsByContent&&(v&&"start"===o&&p||v&&"end"===o&&f||!v&&"start"===o&&y||!v&&"end"===o&&g),E=b||w;(d||m||E)&&(e.flipped=!0,(d||m)&&(r=s[c+1]),E&&(o=function(e){return"end"===e?"start":"start"===e?"end":e}(o)),e.placement=r+(o?"-"+o:""),e.offsets.popper=S({},e.offsets.popper,N(e.instance.popper,e.offsets.reference,e.placement)),e=L(e.instance.modifiers,e,"flip"))})),e},behavior:"flip",padding:5,boundariesElement:"viewport",flipVariations:!1,flipVariationsByContent:!1},inner:{order:700,enabled:!1,fn:function(e){var t=e.placement,n=t.split("-")[0],r=e.offsets,i=r.popper,o=r.reference,s=-1!==["left","right"].indexOf(n),a=-1===["top","left"].indexOf(n);return i[s?"left":"top"]=o[n]-(a?i[s?"width":"height"]:0),e.placement=O(t),e.offsets.popper=_(i),e}},hide:{order:800,enabled:!0,fn:function(e){if(!Q(e.instance.modifiers,"hide","preventOverflow"))return e;var t=e.offsets.reference,n=B(e.instance.modifiers,(function(e){return"preventOverflow"===e.name})).boundaries;if(t.bottom<n.top||t.left>n.right||t.top>n.bottom||t.right<n.left){if(!0===e.hide)return e;e.hide=!0,e.attributes["x-out-of-boundaries"]=""}else{if(!1===e.hide)return e;e.hide=!1,e.attributes["x-out-of-boundaries"]=!1}return e}},computeStyle:{order:850,enabled:!0,fn:function(e,t){var n=t.x,r=t.y,i=e.offsets.popper,o=B(e.instance.modifiers,(function(e){return"applyStyle"===e.name})).gpuAcceleration;void 0!==o&&console.warn("WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!");var s=void 0!==o?o:t.gpuAcceleration,a=p(e.instance.popper),c=I(a),l={position:i.position},u=function(e,t){var n=e.offsets,r=n.popper,i=n.reference,o=Math.round,s=Math.floor,a=function(e){return e},c=o(i.width),l=o(r.width),u=-1!==["left","right"].indexOf(e.placement),h=-1!==e.placement.indexOf("-"),d=t?u||h||c%2===l%2?o:s:a,f=t?o:a;return{left:d(c%2===1&&l%2===1&&!h&&t?r.left-1:r.left),top:f(r.top),bottom:f(r.bottom),right:d(r.right)}}(e,window.devicePixelRatio<2||!W),h="bottom"===n?"top":"bottom",d="right"===r?"left":"right",f=F("transform"),g=void 0,y=void 0;if(y="bottom"===h?"HTML"===a.nodeName?-a.clientHeight+u.bottom:-c.height+u.bottom:u.top,g="right"===d?"HTML"===a.nodeName?-a.clientWidth+u.right:-c.width+u.right:u.left,s&&f)l[f]="translate3d("+g+"px, "+y+"px, 0)",l[h]=0,l[d]=0,l.willChange="transform";else{var m="bottom"===h?-1:1,v="right"===d?-1:1;l[h]=y*m,l[d]=g*v,l.willChange=h+", "+d}var b={"x-placement":e.placement};return e.attributes=S({},b,e.attributes),e.styles=S({},l,e.styles),e.arrowStyles=S({},e.offsets.arrow,e.arrowStyles),e},gpuAcceleration:!0,x:"bottom",y:"right"},applyStyle:{order:900,enabled:!0,fn:function(e){var t,n;return G(e.instance.popper,e.styles),t=e.instance.popper,n=e.attributes,Object.keys(n).forEach((function(e){!1!==n[e]?t.setAttribute(e,n[e]):t.removeAttribute(e)})),e.arrowElement&&Object.keys(e.arrowStyles).length&&G(e.arrowElement,e.arrowStyles),e},onLoad:function(e,t,n,r,i){var o=P(i,t,e,n.positionFixed),s=x(n.placement,o,t,e,n.modifiers.flip.boundariesElement,n.modifiers.flip.padding);return t.setAttribute("x-placement",s),G(t,{position:n.positionFixed?"fixed":"absolute"}),n},gpuAcceleration:void 0}},ie={placement:"bottom",positionFixed:!1,eventsEnabled:!0,removeOnDestroy:!1,onCreate:function(){},onUpdate:function(){},modifiers:re},oe=function(){function e(t,n){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scheduleUpdate=function(){return requestAnimationFrame(r.update)},this.update=o(this.update.bind(this)),this.options=S({},e.Defaults,i),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=t&&t.jquery?t[0]:t,this.popper=n&&n.jquery?n[0]:n,this.options.modifiers={},Object.keys(S({},e.Defaults.modifiers,i.modifiers)).forEach((function(t){r.options.modifiers[t]=S({},e.Defaults.modifiers[t]||{},i.modifiers?i.modifiers[t]:{})})),this.modifiers=Object.keys(this.options.modifiers).map((function(e){return S({name:e},r.options.modifiers[e])})).sort((function(e,t){return e.order-t.order})),this.modifiers.forEach((function(e){e.enabled&&s(e.onLoad)&&e.onLoad(r.reference,r.popper,r.options,e,r.state)})),this.update();var a=this.options.eventsEnabled;a&&this.enableEventListeners(),this.state.eventsEnabled=a}return E(e,[{key:"update",value:function(){return M.call(this)}},{key:"destroy",value:function(){return K.call(this)}},{key:"enableEventListeners",value:function(){return V.call(this)}},{key:"disableEventListeners",value:function(){return H.call(this)}}]),e}();oe.Utils=("undefined"!==typeof window?window:n.g).PopperUtils,oe.placements=Y,oe.Defaults=ie;const se=oe},1426:e=>{var t,n,r=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"===typeof setTimeout?setTimeout:i}catch(e){t=i}try{n="function"===typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var a,c=[],l=!1,u=-1;function h(){l&&a&&(l=!1,a.length?c=a.concat(c):u=-1,c.length&&d())}function d(){if(!l){var e=s(h);l=!0;for(var t=c.length;t;){for(a=c,c=[];++u<t;)a&&a[u].run();u=-1,t=c.length}a=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{return n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function p(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new f(e,t)),1!==c.length||l||s(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=p,r.addListener=p,r.once=p,r.off=p,r.removeListener=p,r.removeAllListeners=p,r.emit=p,r.prependListener=p,r.prependOnceListener=p,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},80888:(e,t,n)=>{"use strict";var r=n(79047);function i(){}function o(){}o.resetWarningCache=i,e.exports=function(){function e(e,t,n,i,o,s){if(s!==r){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:i};return n.PropTypes=n,n}},52007:(e,t,n)=>{e.exports=n(80888)()},79047:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},90095:(e,t,n)=>{"use strict";e.exports=c;var r,i=n(97469),o=i.LongBits,s=i.utf8;function a(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function c(e){this.buf=e,this.pos=0,this.len=e.length}var l="undefined"!==typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new c(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new c(e);throw Error("illegal buffer")},u=function(){return i.Buffer?function(e){return(c.create=function(e){return i.Buffer.isBuffer(e)?new r(e):l(e)})(e)}:l};function h(){var e=new o(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw a(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw a(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function d(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function f(){if(this.pos+8>this.len)throw a(this,8);return new o(d(this.buf,this.pos+=4),d(this.buf,this.pos+=4))}c.create=u(),c.prototype._slice=i.Array.prototype.subarray||i.Array.prototype.slice,c.prototype.uint32=function(){var e=4294967295;return function(){if(e=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return e;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return e}}(),c.prototype.int32=function(){return 0|this.uint32()},c.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},c.prototype.bool=function(){return 0!==this.uint32()},c.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return d(this.buf,this.pos+=4)},c.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|d(this.buf,this.pos+=4)},c.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var e=i.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},c.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var e=i.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},c.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw a(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,n):t===n?new this.buf.constructor(0):this._slice.call(this.buf,t,n)},c.prototype.string=function(){var e=this.bytes();return s.read(e,0,e.length)},c.prototype.skip=function(e){if("number"===typeof e){if(this.pos+e>this.len)throw a(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw a(this)}while(128&this.buf[this.pos++]);return this},c.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!==(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},c._configure=function(e){r=e,c.create=u(),r._configure();var t=i.Long?"toLong":"toNumber";i.merge(c.prototype,{int64:function(){return h.call(this)[t](!1)},uint64:function(){return h.call(this)[t](!0)},sint64:function(){return h.call(this).zzDecode()[t](!1)},fixed64:function(){return f.call(this)[t](!0)},sfixed64:function(){return f.call(this)[t](!1)}})}},48418:(e,t,n)=>{"use strict";e.exports=o;var r=n(90095);(o.prototype=Object.create(r.prototype)).constructor=o;var i=n(97469);function o(e){r.call(this,e)}o._configure=function(){i.Buffer&&(o.prototype._slice=i.Buffer.prototype.slice)},o.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},o._configure()},41537:(e,t,n)=>{"use strict";e.exports=i;var r=n(97469);function i(e,t){this.lo=e>>>0,this.hi=t>>>0}var o=i.zero=new i(0,0);o.toNumber=function(){return 0},o.zzEncode=o.zzDecode=function(){return this},o.length=function(){return 1};var s=i.zeroHash="\0\0\0\0\0\0\0\0";i.fromNumber=function(e){if(0===e)return o;var t=e<0;t&&(e=-e);var n=e>>>0,r=(e-n)/4294967296>>>0;return t&&(r=~r>>>0,n=~n>>>0,++n>4294967295&&(n=0,++r>4294967295&&(r=0))),new i(n,r)},i.from=function(e){if("number"===typeof e)return i.fromNumber(e);if(r.isString(e)){if(!r.Long)return i.fromNumber(parseInt(e,10));e=r.Long.fromString(e)}return e.low||e.high?new i(e.low>>>0,e.high>>>0):o},i.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+4294967296*n)}return this.lo+4294967296*this.hi},i.prototype.toLong=function(e){return r.Long?new r.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var a=String.prototype.charCodeAt;i.fromHash=function(e){return e===s?o:new i((a.call(e,0)|a.call(e,1)<<8|a.call(e,2)<<16|a.call(e,3)<<24)>>>0,(a.call(e,4)|a.call(e,5)<<8|a.call(e,6)<<16|a.call(e,7)<<24)>>>0)},i.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},i.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},i.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},i.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10}},97469:function(e,t,n){"use strict";var r=t;function i(e,t,n){for(var r=Object.keys(t),i=0;i<r.length;++i)void 0!==e[r[i]]&&n||(e[r[i]]=t[r[i]]);return e}function o(e){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&i(this,n)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return e},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}r.asPromise=n(17206),r.base64=n(70001),r.EventEmitter=n(27111),r.float=n(30802),r.inquire=n(77172),r.utf8=n(93861),r.pool=n(58236),r.LongBits=n(41537),r.isNode=Boolean("undefined"!==typeof n.g&&n.g&&n.g.process&&n.g.process.versions&&n.g.process.versions.node),r.global=r.isNode&&n.g||"undefined"!==typeof window&&window||"undefined"!==typeof self&&self||this,r.emptyArray=Object.freeze?Object.freeze([]):[],r.emptyObject=Object.freeze?Object.freeze({}):{},r.isInteger=Number.isInteger||function(e){return"number"===typeof e&&isFinite(e)&&Math.floor(e)===e},r.isString=function(e){return"string"===typeof e||e instanceof String},r.isObject=function(e){return e&&"object"===typeof e},r.isset=r.isSet=function(e,t){var n=e[t];return!(null==n||!e.hasOwnProperty(t))&&("object"!==typeof n||(Array.isArray(n)?n.length:Object.keys(n).length)>0)},r.Buffer=function(){try{var e=r.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(t){return null}}(),r._Buffer_from=null,r._Buffer_allocUnsafe=null,r.newBuffer=function(e){return"number"===typeof e?r.Buffer?r._Buffer_allocUnsafe(e):new r.Array(e):r.Buffer?r._Buffer_from(e):"undefined"===typeof Uint8Array?e:new Uint8Array(e)},r.Array="undefined"!==typeof Uint8Array?Uint8Array:Array,r.Long=r.global.dcodeIO&&r.global.dcodeIO.Long||r.global.Long||r.inquire("long"),r.key2Re=/^true|false|0|1$/,r.key32Re=/^-?(?:0|[1-9][0-9]*)$/,r.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,r.longToHash=function(e){return e?r.LongBits.from(e).toHash():r.LongBits.zeroHash},r.longFromHash=function(e,t){var n=r.LongBits.fromHash(e);return r.Long?r.Long.fromBits(n.lo,n.hi,t):n.toNumber(Boolean(t))},r.merge=i,r.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},r.newError=o,r.ProtocolError=o("ProtocolError"),r.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var e=Object.keys(this),n=e.length-1;n>-1;--n)if(1===t[e[n]]&&void 0!==this[e[n]]&&null!==this[e[n]])return e[n]}},r.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}},r.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},r._configure=function(){var e=r.Buffer;e?(r._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,n){return new e(t,n)},r._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):r._Buffer_from=r._Buffer_allocUnsafe=null}},21748:(e,t,n)=>{"use strict";e.exports=h;var r,i=n(97469),o=i.LongBits,s=i.base64,a=i.utf8;function c(e,t,n){this.fn=e,this.len=t,this.next=void 0,this.val=n}function l(){}function u(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function h(){this.len=0,this.head=new c(l,0,0),this.tail=this.head,this.states=null}var d=function(){return i.Buffer?function(){return(h.create=function(){return new r})()}:function(){return new h}};function f(e,t,n){t[n]=255&e}function p(e,t){this.len=e,this.next=void 0,this.val=t}function g(e,t,n){for(;e.hi;)t[n++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[n++]=127&e.lo|128,e.lo=e.lo>>>7;t[n++]=e.lo}function y(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}h.create=d(),h.alloc=function(e){return new i.Array(e)},i.Array!==Array&&(h.alloc=i.pool(h.alloc,i.Array.prototype.subarray)),h.prototype._push=function(e,t,n){return this.tail=this.tail.next=new c(e,t,n),this.len+=t,this},p.prototype=Object.create(c.prototype),p.prototype.fn=function(e,t,n){for(;e>127;)t[n++]=127&e|128,e>>>=7;t[n]=e},h.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new p((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},h.prototype.int32=function(e){return e<0?this._push(g,10,o.fromNumber(e)):this.uint32(e)},h.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},h.prototype.uint64=function(e){var t=o.from(e);return this._push(g,t.length(),t)},h.prototype.int64=h.prototype.uint64,h.prototype.sint64=function(e){var t=o.from(e).zzEncode();return this._push(g,t.length(),t)},h.prototype.bool=function(e){return this._push(f,1,e?1:0)},h.prototype.fixed32=function(e){return this._push(y,4,e>>>0)},h.prototype.sfixed32=h.prototype.fixed32,h.prototype.fixed64=function(e){var t=o.from(e);return this._push(y,4,t.lo)._push(y,4,t.hi)},h.prototype.sfixed64=h.prototype.fixed64,h.prototype.float=function(e){return this._push(i.float.writeFloatLE,4,e)},h.prototype.double=function(e){return this._push(i.float.writeDoubleLE,8,e)};var m=i.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var r=0;r<e.length;++r)t[n+r]=e[r]};h.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(f,1,0);if(i.isString(e)){var n=h.alloc(t=s.length(e));s.decode(e,n,0),e=n}return this.uint32(t)._push(m,t,e)},h.prototype.string=function(e){var t=a.length(e);return t?this.uint32(t)._push(a.write,t,e):this._push(f,1,0)},h.prototype.fork=function(){return this.states=new u(this),this.head=this.tail=new c(l,0,0),this.len=0,this},h.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new c(l,0,0),this.len=0),this},h.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this},h.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t},h._configure=function(e){r=e,h.create=d(),r._configure()}},4080:(e,t,n)=>{"use strict";e.exports=o;var r=n(21748);(o.prototype=Object.create(r.prototype)).constructor=o;var i=n(97469);function o(){r.call(this)}function s(e,t,n){e.length<40?i.utf8.write(e,t,n):t.utf8Write?t.utf8Write(e,n):t.write(e,n)}o._configure=function(){o.alloc=i._Buffer_allocUnsafe,o.writeBytesBuffer=i.Buffer&&i.Buffer.prototype instanceof Uint8Array&&"set"===i.Buffer.prototype.set.name?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var r=0;r<e.length;)t[n++]=e[r++]}},o.prototype.bytes=function(e){i.isString(e)&&(e=i._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(o.writeBytesBuffer,t,e),this},o.prototype.string=function(e){var t=i.Buffer.byteLength(e);return this.uint32(t),t&&this._push(s,t,e),this},o._configure()},57896:(e,t,n)=>{const r=n(8139),i=n(15339),o=n(64052),s=n(3654),{RateLimiterClusterMaster:a,RateLimiterClusterMasterPM2:c,RateLimiterCluster:l}=n(85503),u=n(22408),h=n(38134),d=n(95e3),f=n(14066),p=n(33081),g=n(10438),y=n(84819);e.exports={RateLimiterRedis:r,RateLimiterMongo:i,RateLimiterMySQL:o,RateLimiterPostgres:s,RateLimiterMemory:u,RateLimiterMemcache:h,RateLimiterClusterMaster:a,RateLimiterClusterMasterPM2:c,RateLimiterCluster:l,RLWrapperBlackAndWhite:d,RateLimiterUnion:f,RateLimiterQueue:p,BurstyRateLimiter:g,RateLimiterRes:y}},10438:(e,t,n)=>{const r=n(84819);e.exports=class{constructor(e,t){this._rateLimiter=e,this._burstLimiter=t}_combineRes(e,t){return e?new r(e.remainingPoints,Math.min(e.msBeforeNext,t?t.msBeforeNext:0),e.consumedPoints,e.isFirstInDuration):null}consume(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._rateLimiter.consume(e,t,n).catch((i=>i instanceof r?this._burstLimiter.consume(e,t,n).then((e=>Promise.resolve(this._combineRes(i,e)))).catch((e=>e instanceof r?Promise.reject(this._combineRes(i,e)):Promise.reject(e))):Promise.reject(i)))}get(e){return Promise.all([this._rateLimiter.get(e),this._burstLimiter.get(e)]).then((e=>{let[t,n]=e;return this._combineRes(t,n)}))}get points(){return this._rateLimiter.points}}},95e3:(e,t,n)=>{const r=n(84819);e.exports=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.limiter=e.limiter,this.blackList=e.blackList,this.whiteList=e.whiteList,this.isBlackListed=e.isBlackListed,this.isWhiteListed=e.isWhiteListed,this.runActionAnyway=e.runActionAnyway}get limiter(){return this._limiter}set limiter(e){if("undefined"===typeof e)throw new Error("limiter is not set");this._limiter=e}get runActionAnyway(){return this._runActionAnyway}set runActionAnyway(e){this._runActionAnyway="undefined"!==typeof e&&e}get blackList(){return this._blackList}set blackList(e){this._blackList=Array.isArray(e)?e:[]}get isBlackListed(){return this._isBlackListed}set isBlackListed(e){if("undefined"===typeof e&&(e=()=>!1),"function"!==typeof e)throw new Error("isBlackListed must be function");this._isBlackListed=e}get whiteList(){return this._whiteList}set whiteList(e){this._whiteList=Array.isArray(e)?e:[]}get isWhiteListed(){return this._isWhiteListed}set isWhiteListed(e){if("undefined"===typeof e&&(e=()=>!1),"function"!==typeof e)throw new Error("isWhiteListed must be function");this._isWhiteListed=e}isBlackListedSomewhere(e){return this.blackList.indexOf(e)>=0||this.isBlackListed(e)}isWhiteListedSomewhere(e){return this.whiteList.indexOf(e)>=0||this.isWhiteListed(e)}getBlackRes(){return new r(0,Number.MAX_SAFE_INTEGER,0,!1)}getWhiteRes(){return new r(Number.MAX_SAFE_INTEGER,0,0,!1)}rejectBlack(){return Promise.reject(this.getBlackRes())}resolveBlack(){return Promise.resolve(this.getBlackRes())}resolveWhite(){return Promise.resolve(this.getWhiteRes())}consume(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.isWhiteListedSomewhere(e)?t=this.resolveWhite():this.isBlackListedSomewhere(e)&&(t=this.rejectBlack()),"undefined"===typeof t?this.limiter.consume(e,n):(this.runActionAnyway&&this.limiter.consume(e,n).catch((()=>{})),t)}block(e,t){let n;return this.isWhiteListedSomewhere(e)?n=this.resolveWhite():this.isBlackListedSomewhere(e)&&(n=this.resolveBlack()),"undefined"===typeof n?this.limiter.block(e,t):(this.runActionAnyway&&this.limiter.block(e,t).catch((()=>{})),n)}penalty(e,t){let n;return this.isWhiteListedSomewhere(e)?n=this.resolveWhite():this.isBlackListedSomewhere(e)&&(n=this.resolveBlack()),"undefined"===typeof n?this.limiter.penalty(e,t):(this.runActionAnyway&&this.limiter.penalty(e,t).catch((()=>{})),n)}reward(e,t){let n;return this.isWhiteListedSomewhere(e)?n=this.resolveWhite():this.isBlackListedSomewhere(e)&&(n=this.resolveBlack()),"undefined"===typeof n?this.limiter.reward(e,t):(this.runActionAnyway&&this.limiter.reward(e,t).catch((()=>{})),n)}get(e){let t;return this.isWhiteListedSomewhere(e)?t=this.resolveWhite():this.isBlackListedSomewhere(e)&&(t=this.resolveBlack()),"undefined"===typeof t||this.runActionAnyway?this.limiter.get(e):t}delete(e){return this.limiter.delete(e)}}},88855:e=>{e.exports=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.points=e.points,this.duration=e.duration,this.blockDuration=e.blockDuration,this.execEvenly=e.execEvenly,this.execEvenlyMinDelayMs=e.execEvenlyMinDelayMs,this.keyPrefix=e.keyPrefix}get points(){return this._points}set points(e){this._points=e>=0?e:4}get duration(){return this._duration}set duration(e){this._duration="undefined"===typeof e?1:e}get msDuration(){return 1e3*this.duration}get blockDuration(){return this._blockDuration}set blockDuration(e){this._blockDuration="undefined"===typeof e?0:e}get msBlockDuration(){return 1e3*this.blockDuration}get execEvenly(){return this._execEvenly}set execEvenly(e){this._execEvenly="undefined"!==typeof e&&Boolean(e)}get execEvenlyMinDelayMs(){return this._execEvenlyMinDelayMs}set execEvenlyMinDelayMs(e){this._execEvenlyMinDelayMs="undefined"===typeof e?Math.ceil(this.msDuration/this.points):e}get keyPrefix(){return this._keyPrefix}set keyPrefix(e){if("undefined"===typeof e&&(e="rlflx"),"string"!==typeof e)throw new Error("keyPrefix must be string");this._keyPrefix=e}_getKeySecDuration(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e&&e.customDuration>=0?e.customDuration:this.duration}getKey(e){return this.keyPrefix.length>0?"".concat(this.keyPrefix,":").concat(e):e}parseKey(e){return e.substring(this.keyPrefix.length)}consume(){throw new Error("You have to implement the method 'consume'!")}penalty(){throw new Error("You have to implement the method 'penalty'!")}reward(){throw new Error("You have to implement the method 'reward'!")}get(){throw new Error("You have to implement the method 'get'!")}set(){throw new Error("You have to implement the method 'set'!")}block(){throw new Error("You have to implement the method 'block'!")}delete(){throw new Error("You have to implement the method 'delete'!")}}},85503:(e,t,n)=>{var r=n(1426);const i=n(81265),o=n(35539),s=n(88855),a=n(22408),c=n(84819),l="rate_limiter_flexible";let u=null;const h=function(e,t,n,r){let i;i=null===r||!0===r||!1===r?r:{remainingPoints:r.remainingPoints,msBeforeNext:r.msBeforeNext,consumedPoints:r.consumedPoints,isFirstInDuration:r.isFirstInDuration},e.send({channel:l,keyPrefix:t.keyPrefix,promiseId:t.promiseId,type:n,data:i})},d=function(e){setTimeout((()=>{this._initiated?r.send(e):"undefined"!==typeof this._promises[e.promiseId]&&d.call(this,e)}),30)},f=function(e,t,n,i,o){const s={channel:l,keyPrefix:this.keyPrefix,func:e,promiseId:t,data:{key:n,arg:i,opts:o}};this._initiated?r.send(s):d.call(this,s)},p=function(e,t){if(!t||t.channel!==l||"undefined"===typeof this._rateLimiters[t.keyPrefix])return!1;let n;switch(t.func){case"consume":n=this._rateLimiters[t.keyPrefix].consume(t.data.key,t.data.arg,t.data.opts);break;case"penalty":n=this._rateLimiters[t.keyPrefix].penalty(t.data.key,t.data.arg,t.data.opts);break;case"reward":n=this._rateLimiters[t.keyPrefix].reward(t.data.key,t.data.arg,t.data.opts);break;case"block":n=this._rateLimiters[t.keyPrefix].block(t.data.key,t.data.arg,t.data.opts);break;case"get":n=this._rateLimiters[t.keyPrefix].get(t.data.key,t.data.opts);break;case"delete":n=this._rateLimiters[t.keyPrefix].delete(t.data.key,t.data.opts);break;default:return!1}n&&n.then((n=>{h(e,t,"resolve",n)})).catch((n=>{h(e,t,"reject",n)}))},g=function(e){if(!e||e.channel!==l||e.keyPrefix!==this.keyPrefix)return!1;if(this._promises[e.promiseId]){let t;switch(clearTimeout(this._promises[e.promiseId].timeoutId),t=null===e.data||!0===e.data||!1===e.data?e.data:new c(e.data.remainingPoints,e.data.msBeforeNext,e.data.consumedPoints,e.data.isFirstInDuration),e.type){case"resolve":this._promises[e.promiseId].resolve(t);break;case"reject":this._promises[e.promiseId].reject(t);break;default:throw new Error("RateLimiterCluster: no such message type '".concat(e.type,"'"))}delete this._promises[e.promiseId]}},y=function(){return{points:this.points,duration:this.duration,blockDuration:this.blockDuration,execEvenly:this.execEvenly,execEvenlyMinDelayMs:this.execEvenlyMinDelayMs,keyPrefix:this.keyPrefix}},m=function(e,t){const n=r.hrtime();let i=n[0].toString()+n[1].toString();return"undefined"!==typeof this._promises[i]&&(i+=o.randomBytes(12).toString("base64")),this._promises[i]={resolve:e,reject:t,timeoutId:setTimeout((()=>{delete this._promises[i],t(new Error("RateLimiterCluster timeout: no answer from master in time"))}),this.timeoutMs)},i};e.exports={RateLimiterClusterMaster:class{constructor(){if(u)return u;this._rateLimiters={},i.setMaxListeners(0),i.on("message",((e,t)=>{t&&t.channel===l&&"init"===t.type?("undefined"===typeof this._rateLimiters[t.opts.keyPrefix]&&(this._rateLimiters[t.opts.keyPrefix]=new a(t.opts)),e.send({channel:l,type:"init",keyPrefix:t.opts.keyPrefix})):p.call(this,e,t)})),u=this}},RateLimiterClusterMasterPM2:class{constructor(e){if(u)return u;this._rateLimiters={},e.launchBus(((t,n)=>{n.on("process:msg",(t=>{const n=t.raw;if(n&&n.channel===l&&"init"===n.type)"undefined"===typeof this._rateLimiters[n.opts.keyPrefix]&&(this._rateLimiters[n.opts.keyPrefix]=new a(n.opts)),e.sendDataToProcessId(t.process.pm_id,{data:{},topic:l,channel:l,type:"init",keyPrefix:n.opts.keyPrefix},((e,t)=>{e&&console.log(e,t)}));else{p.call(this,{send:n=>{const r=n;r.topic=l,"undefined"===typeof r.data&&(r.data={}),e.sendDataToProcessId(t.process.pm_id,r,((e,t)=>{e&&console.log(e,t)}))}},n)}}))})),u=this}},RateLimiterCluster:class extends s{get timeoutMs(){return this._timeoutMs}set timeoutMs(e){this._timeoutMs="undefined"===typeof e?5e3:Math.abs(parseInt(e))}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(e),r.setMaxListeners(0),this.timeoutMs=e.timeoutMs,this._initiated=!1,r.on("message",(e=>{e&&e.channel===l&&"init"===e.type&&e.keyPrefix===this.keyPrefix?this._initiated=!0:g.call(this,e)})),r.send({channel:l,type:"init",opts:y.call(this)}),this._promises={}}consume(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise(((r,i)=>{const o=m.call(this,r,i);f.call(this,"consume",o,e,t,n)}))}penalty(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise(((r,i)=>{const o=m.call(this,r,i);f.call(this,"penalty",o,e,t,n)}))}reward(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise(((r,i)=>{const o=m.call(this,r,i);f.call(this,"reward",o,e,t,n)}))}block(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise(((r,i)=>{const o=m.call(this,r,i);f.call(this,"block",o,e,t,n)}))}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(((n,r)=>{const i=m.call(this,n,r);f.call(this,"get",i,e,t)}))}delete(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(((n,r)=>{const i=m.call(this,n,r);f.call(this,"delete",i,e,t)}))}}}},38134:(e,t,n)=>{const r=n(41434),i=n(84819);e.exports=class extends r{constructor(e){super(e),this.client=e.storeClient}_getRateLimiterRes(e,t,n){const r=new i;return r.consumedPoints=parseInt(n.consumedPoints),r.isFirstInDuration=n.consumedPoints===t,r.remainingPoints=Math.max(this.points-r.consumedPoints,0),r.msBeforeNext=n.msBeforeNext,r}_upsert(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return new Promise(((o,s)=>{const a=Date.now(),c=Math.floor(n/1e3);r?this.client.set(e,t,c,(n=>{n?s(n):this.client.set("".concat(e,"_expire"),c>0?a+1e3*c:-1,c,(()=>{o({consumedPoints:t,msBeforeNext:c>0?1e3*c:-1})}))})):this.client.incr(e,t,((l,u)=>{l||!1===u?this.client.add(e,t,c,((l,u)=>{if(l||!u)if("undefined"===typeof i.attemptNumber||i.attemptNumber<3){const a=Object.assign({},i);a.attemptNumber=a.attemptNumber?a.attemptNumber+1:1,this._upsert(e,t,n,r,a).then((e=>o(e))).catch((e=>s(e)))}else s(new Error("Can not add key"));else this.client.add("".concat(e,"_expire"),c>0?a+1e3*c:-1,c,(()=>{o({consumedPoints:t,msBeforeNext:c>0?1e3*c:-1})}))})):this.client.get("".concat(e,"_expire"),((e,t)=>{if(e)s(e);else{const e=!1===t?0:t,n={consumedPoints:u,msBeforeNext:e>=0?Math.max(e-a,0):-1};o(n)}}))}))}))}_get(e){return new Promise(((t,n)=>{const r=Date.now();this.client.get(e,((i,o)=>{o?this.client.get("".concat(e,"_expire"),((e,i)=>{if(e)n(e);else{const e=!1===i?0:i,n={consumedPoints:o,msBeforeNext:e>=0?Math.max(e-r,0):-1};t(n)}})):t(null)}))}))}_delete(e){return new Promise(((t,n)=>{this.client.del(e,((r,i)=>{r?n(r):!1===i?t(i):this.client.del("".concat(e,"_expire"),(e=>{e?n(e):t(i)}))}))}))}}},22408:(e,t,n)=>{const r=n(88855),i=n(14327),o=n(84819);e.exports=class extends r{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this._memoryStorage=new i}consume(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise(((r,i)=>{const o=this.getKey(e),s=this._getKeySecDuration(n);let a=this._memoryStorage.incrby(o,t,s);if(a.remainingPoints=Math.max(this.points-a.consumedPoints,0),a.consumedPoints>this.points)this.blockDuration>0&&a.consumedPoints<=this.points+t&&(a=this._memoryStorage.set(o,a.consumedPoints,this.blockDuration)),i(a);else if(this.execEvenly&&a.msBeforeNext>0&&!a.isFirstInDuration){let e=Math.ceil(a.msBeforeNext/(a.remainingPoints+2));e<this.execEvenlyMinDelayMs&&(e=a.consumedPoints*this.execEvenlyMinDelayMs),setTimeout(r,e,a)}else r(a)}))}penalty(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=this.getKey(e);return new Promise((e=>{const i=this._getKeySecDuration(n),o=this._memoryStorage.incrby(r,t,i);o.remainingPoints=Math.max(this.points-o.consumedPoints,0),e(o)}))}reward(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=this.getKey(e);return new Promise((e=>{const i=this._getKeySecDuration(n),o=this._memoryStorage.incrby(r,-t,i);o.remainingPoints=Math.max(this.points-o.consumedPoints,0),e(o)}))}block(e,t){const n=1e3*t,r=this.points+1;return this._memoryStorage.set(this.getKey(e),r,t),Promise.resolve(new o(0,0===n?-1:n,r))}set(e,t,n){const r=1e3*(n>=0?n:this.duration);return this._memoryStorage.set(this.getKey(e),t,n),Promise.resolve(new o(0,0===r?-1:r,t))}get(e){const t=this._memoryStorage.get(this.getKey(e));return null!==t&&(t.remainingPoints=Math.max(this.points-t.consumedPoints,0)),Promise.resolve(t)}delete(e){return Promise.resolve(this._memoryStorage.delete(this.getKey(e)))}}},15339:(e,t,n)=>{const r=n(41434),i=n(84819);function o(e){try{const t=e.client?e.client:e,{version:n}=t.topology.s.options.metadata.driver,r=n.split(".").map((e=>parseInt(e)));return{major:r[0],feature:r[1],patch:r[2]}}catch(t){return{major:0,feature:0,patch:0}}}class s extends r{constructor(e){super(e),this.dbName=e.dbName,this.tableName=e.tableName,this.indexKeyPrefix=e.indexKeyPrefix,e.mongo?this.client=e.mongo:this.client=e.storeClient,"function"===typeof this.client.then?this.client.then((e=>{this.client=e,this._initCollection(),this._driverVersion=o(this.client)})):(this._initCollection(),this._driverVersion=o(this.client))}get dbName(){return this._dbName}set dbName(e){this._dbName="undefined"===typeof e?s.getDbName():e}static getDbName(){return"node-rate-limiter-flexible"}get tableName(){return this._tableName}set tableName(e){this._tableName="undefined"===typeof e?this.keyPrefix:e}get client(){return this._client}set client(e){if("undefined"===typeof e)throw new Error("mongo is not set");this._client=e}get indexKeyPrefix(){return this._indexKeyPrefix}set indexKeyPrefix(e){this._indexKeyPrefix=e||{}}_initCollection(){const e=("function"===typeof this.client.db?this.client.db(this.dbName):this.client).collection(this.tableName);e.createIndex({expire:-1},{expireAfterSeconds:0}),e.createIndex(Object.assign({},this.indexKeyPrefix,{key:1}),{unique:!0}),this._collection=e}_getRateLimiterRes(e,t,n){const r=new i;let o;return o="undefined"===typeof n.value?n:n.value,r.isFirstInDuration=o.points===t,r.consumedPoints=o.points,r.remainingPoints=Math.max(this.points-r.consumedPoints,0),r.msBeforeNext=null!==o.expire?Math.max(new Date(o.expire).getTime()-Date.now(),0):-1,r}_upsert(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(!this._collection)return Promise.reject(Error("Mongo connection is not established"));const o=i.attrs||{};let s,a;r?(s={key:e},s=Object.assign(s,o),a={$set:{key:e,points:t,expire:n>0?new Date(Date.now()+n):null}},a.$set=Object.assign(a.$set,o)):(s={$or:[{expire:{$gt:new Date}},{expire:{$eq:null}}],key:e},s=Object.assign(s,o),a={$setOnInsert:{key:e,expire:n>0?new Date(Date.now()+n):null},$inc:{points:t}},a.$setOnInsert=Object.assign(a.$setOnInsert,o));const c={upsert:!0};return this._driverVersion.major>=4||3===this._driverVersion.major&&this._driverVersion.feature>=7||this._driverVersion.feature>=6&&this._driverVersion.patch>=7?c.returnDocument="after":c.returnOriginal=!1,new Promise(((i,l)=>{this._collection.findOneAndUpdate(s,a,c).then((e=>{i(e)})).catch((s=>{if(s&&11e3===s.code){const s=Object.assign({$or:[{expire:{$lte:new Date}},{expire:{$eq:null}}],key:e},o),a={$set:Object.assign({key:e,points:t,expire:n>0?new Date(Date.now()+n):null},o)};this._collection.findOneAndUpdate(s,a,c).then((e=>{i(e)})).catch((o=>{o&&11e3===o.code?this._upsert(e,t,n,r).then((e=>i(e))).catch((e=>l(e))):l(o)}))}else l(s)}))}))}_get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this._collection)return Promise.reject(Error("Mongo connection is not established"));const n=t.attrs||{},r=Object.assign({key:e,$or:[{expire:{$gt:new Date}},{expire:{$eq:null}}]},n);return this._collection.findOne(r)}_delete(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this._collection)return Promise.reject(Error("Mongo connection is not established"));const n=t.attrs||{},r=Object.assign({key:e},n);return this._collection.deleteOne(r).then((e=>e.deletedCount>0))}}e.exports=s},64052:(e,t,n)=>{const r=n(41434),i=n(84819);e.exports=class extends r{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e),this.client=e.storeClient,this.clientType=e.storeType,this.dbName=e.dbName,this.tableName=e.tableName,this.clearExpiredByTimeout=e.clearExpiredByTimeout,this.tableCreated=e.tableCreated,this.tableCreated?(this.clearExpiredByTimeout&&this._clearExpiredHourAgo(),"function"===typeof t&&t()):this._createDbAndTable().then((()=>{this.tableCreated=!0,this.clearExpiredByTimeout&&this._clearExpiredHourAgo(),"function"===typeof t&&t()})).catch((e=>{if("function"!==typeof t)throw e;t(e)}))}clearExpired(e){return new Promise((t=>{this._getConnection().then((n=>{n.query("DELETE FROM ??.?? WHERE expire < ?",[this.dbName,this.tableName,e],(()=>{this._releaseConnection(n),t()}))})).catch((()=>{t()}))}))}_clearExpiredHourAgo(){this._clearExpiredTimeoutId&&clearTimeout(this._clearExpiredTimeoutId),this._clearExpiredTimeoutId=setTimeout((()=>{this.clearExpired(Date.now()-36e5).then((()=>{this._clearExpiredHourAgo()}))}),3e5),this._clearExpiredTimeoutId.unref()}_getConnection(){switch(this.clientType){case"pool":return new Promise(((e,t)=>{this.client.getConnection(((n,r)=>{if(n)return t(n);e(r)}))}));case"sequelize":return this.client.connectionManager.getConnection();case"knex":return this.client.client.acquireConnection();default:return Promise.resolve(this.client)}}_releaseConnection(e){switch(this.clientType){case"pool":return e.release();case"sequelize":return this.client.connectionManager.releaseConnection(e);case"knex":return this.client.client.releaseConnection(e);default:return!0}}_createDbAndTable(){return new Promise(((e,t)=>{this._getConnection().then((n=>{n.query("CREATE DATABASE IF NOT EXISTS `".concat(this.dbName,"`;"),(r=>{if(r)return this._releaseConnection(n),t(r);n.query(this._getCreateTableStmt(),(r=>{if(r)return this._releaseConnection(n),t(r);this._releaseConnection(n),e()}))}))})).catch((e=>{t(e)}))}))}_getCreateTableStmt(){return"CREATE TABLE IF NOT EXISTS `".concat(this.dbName,"`.`").concat(this.tableName,"` (")+"`key` VARCHAR(255) CHARACTER SET utf8 NOT NULL,`points` INT(9) NOT NULL default 0,`expire` BIGINT UNSIGNED,PRIMARY KEY (`key`)) ENGINE = INNODB;"}get clientType(){return this._clientType}set clientType(e){if("undefined"===typeof e)if("Connection"===this.client.constructor.name)e="connection";else if("Pool"===this.client.constructor.name)e="pool";else{if("Sequelize"!==this.client.constructor.name)throw new Error("storeType is not defined");e="sequelize"}this._clientType=e.toLowerCase()}get dbName(){return this._dbName}set dbName(e){this._dbName="undefined"===typeof e?"rtlmtrflx":e}get tableName(){return this._tableName}set tableName(e){this._tableName="undefined"===typeof e?this.keyPrefix:e}get tableCreated(){return this._tableCreated}set tableCreated(e){this._tableCreated="undefined"!==typeof e&&!!e}get clearExpiredByTimeout(){return this._clearExpiredByTimeout}set clearExpiredByTimeout(e){this._clearExpiredByTimeout="undefined"===typeof e||Boolean(e)}_getRateLimiterRes(e,t,n){const r=new i,[o]=n;return r.isFirstInDuration=t===o.points,r.consumedPoints=r.isFirstInDuration?t:o.points,r.remainingPoints=Math.max(this.points-r.consumedPoints,0),r.msBeforeNext=o.expire?Math.max(o.expire-Date.now(),0):-1,r}_upsertTransaction(e,t,n,r,i){return new Promise(((o,s)=>{e.query("BEGIN",(a=>{if(a)return e.rollback(),s(a);const c=Date.now(),l=r>0?c+r:null;let u,h;i?(u="INSERT INTO ??.?? VALUES (?, ?, ?)\n          ON DUPLICATE KEY UPDATE \n            points = ?, \n            expire = ?;",h=[this.dbName,this.tableName,t,n,l,n,l]):(u="INSERT INTO ??.?? VALUES (?, ?, ?)\n          ON DUPLICATE KEY UPDATE \n            points = IF(expire <= ?, ?, points + (?)), \n            expire = IF(expire <= ?, ?, expire);",h=[this.dbName,this.tableName,t,n,l,c,n,n,c,l]),e.query(u,h,(n=>{if(n)return e.rollback(),s(n);e.query("SELECT points, expire FROM ??.?? WHERE `key` = ?;",[this.dbName,this.tableName,t],((t,n)=>{if(t)return e.rollback(),s(t);e.query("COMMIT",(t=>{if(t)return e.rollback(),s(t);o(n)}))}))}))}))}))}_upsert(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this.tableCreated?new Promise(((i,o)=>{this._getConnection().then((s=>{this._upsertTransaction(s,e,t,n,r).then((e=>{i(e),this._releaseConnection(s)})).catch((e=>{o(e),this._releaseConnection(s)}))})).catch((e=>{o(e)}))})):Promise.reject(Error("Table is not created yet"))}_get(e){return this.tableCreated?new Promise(((t,n)=>{this._getConnection().then((r=>{r.query("SELECT points, expire FROM ??.?? WHERE `key` = ? AND (`expire` > ? OR `expire` IS NULL)",[this.dbName,this.tableName,e,Date.now()],((e,i)=>{e?n(e):0===i.length?t(null):t(i),this._releaseConnection(r)}))})).catch((e=>{n(e)}))})):Promise.reject(Error("Table is not created yet"))}_delete(e){return this.tableCreated?new Promise(((t,n)=>{this._getConnection().then((r=>{r.query("DELETE FROM ??.?? WHERE `key` = ?",[this.dbName,this.tableName,e],((e,i)=>{e?n(e):t(i.affectedRows>0),this._releaseConnection(r)}))})).catch((e=>{n(e)}))})):Promise.reject(Error("Table is not created yet"))}}},3654:(e,t,n)=>{const r=n(41434),i=n(84819);e.exports=class extends r{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e),this.client=e.storeClient,this.clientType=e.storeType,this.tableName=e.tableName,this.schemaName=e.schemaName,this.clearExpiredByTimeout=e.clearExpiredByTimeout,this.tableCreated=e.tableCreated,this.tableCreated?(this.clearExpiredByTimeout&&this._clearExpiredHourAgo(),"function"===typeof t&&t()):this._createTable().then((()=>{this.tableCreated=!0,this.clearExpiredByTimeout&&this._clearExpiredHourAgo(),"function"===typeof t&&t()})).catch((e=>{if("function"!==typeof t)throw e;t(e)}))}_getTableIdentifier(){return this.schemaName?'"'.concat(this.schemaName,'"."').concat(this.tableName,'"'):'"'.concat(this.tableName,'"')}clearExpired(e){return new Promise((t=>{const n={name:"rlflx-clear-expired",text:"DELETE FROM ".concat(this._getTableIdentifier()," WHERE expire < $1"),values:[e]};this._query(n).then((()=>{t()})).catch((()=>{t()}))}))}_clearExpiredHourAgo(){this._clearExpiredTimeoutId&&clearTimeout(this._clearExpiredTimeoutId),this._clearExpiredTimeoutId=setTimeout((()=>{this.clearExpired(Date.now()-36e5).then((()=>{this._clearExpiredHourAgo()}))}),3e5),this._clearExpiredTimeoutId.unref()}_getConnection(){switch(this.clientType){case"pool":default:return Promise.resolve(this.client);case"sequelize":return this.client.connectionManager.getConnection();case"knex":return this.client.client.acquireConnection();case"typeorm":return Promise.resolve(this.client.driver.master)}}_releaseConnection(e){switch(this.clientType){case"pool":case"typeorm":default:return!0;case"sequelize":return this.client.connectionManager.releaseConnection(e);case"knex":return this.client.client.releaseConnection(e)}}_createTable(){return new Promise(((e,t)=>{this._query({text:this._getCreateTableStmt()}).then((()=>{e()})).catch((n=>{"23505"===n.code?e():t(n)}))}))}_getCreateTableStmt(){return"CREATE TABLE IF NOT EXISTS ".concat(this._getTableIdentifier()," (\n      key varchar(255) PRIMARY KEY,\n      points integer NOT NULL DEFAULT 0,\n      expire bigint\n    );")}get clientType(){return this._clientType}set clientType(e){const t=this.client.constructor.name;if("undefined"===typeof e)if("Client"===t)e="client";else if("Pool"===t||"BoundPool"===t)e="pool";else{if("Sequelize"!==t)throw new Error("storeType is not defined");e="sequelize"}this._clientType=e.toLowerCase()}get tableName(){return this._tableName}set tableName(e){this._tableName="undefined"===typeof e?this.keyPrefix:e}get schemaName(){return this._schemaName}set schemaName(e){this._schemaName=e}get tableCreated(){return this._tableCreated}set tableCreated(e){this._tableCreated="undefined"!==typeof e&&!!e}get clearExpiredByTimeout(){return this._clearExpiredByTimeout}set clearExpiredByTimeout(e){this._clearExpiredByTimeout="undefined"===typeof e||Boolean(e)}_getRateLimiterRes(e,t,n){const r=new i,o=n.rows[0];return r.isFirstInDuration=t===o.points,r.consumedPoints=r.isFirstInDuration?t:o.points,r.remainingPoints=Math.max(this.points-r.consumedPoints,0),r.msBeforeNext=o.expire?Math.max(o.expire-Date.now(),0):-1,r}_query(e){const t=this.tableName.toLowerCase(),n={name:"".concat(t,":").concat(e.name),text:e.text,values:e.values};return new Promise(((e,t)=>{this._getConnection().then((r=>{r.query(n).then((t=>{e(t),this._releaseConnection(r)})).catch((e=>{t(e),this._releaseConnection(r)}))})).catch((e=>{t(e)}))}))}_upsert(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!this.tableCreated)return Promise.reject(Error("Table is not created yet"));const i=n>0?Date.now()+n:null,o=r?" $3 ":" CASE\n             WHEN ".concat(this._getTableIdentifier(),".expire <= $4 THEN $3\n             ELSE ").concat(this._getTableIdentifier(),".expire\n            END ");return this._query({name:r?"rlflx-upsert-force":"rlflx-upsert",text:"\n            INSERT INTO ".concat(this._getTableIdentifier()," VALUES ($1, $2, $3)\n              ON CONFLICT(key) DO UPDATE SET\n                points = CASE\n                          WHEN (").concat(this._getTableIdentifier(),".expire <= $4 OR 1=").concat(r?1:0,") THEN $2\n                          ELSE ").concat(this._getTableIdentifier(),".points + ($2)\n                         END,\n                expire = ").concat(o,"\n            RETURNING points, expire;"),values:[e,t,i,Date.now()]})}_get(e){return this.tableCreated?new Promise(((t,n)=>{this._query({name:"rlflx-get",text:"\n            SELECT points, expire FROM ".concat(this._getTableIdentifier()," WHERE key = $1 AND (expire > $2 OR expire IS NULL);"),values:[e,Date.now()]}).then((e=>{0===e.rowCount&&(e=null),t(e)})).catch((e=>{n(e)}))})):Promise.reject(Error("Table is not created yet"))}_delete(e){return this.tableCreated?this._query({name:"rlflx-delete",text:"DELETE FROM ".concat(this._getTableIdentifier()," WHERE key = $1"),values:[e]}).then((e=>e.rowCount>0)):Promise.reject(Error("Table is not created yet"))}}},33081:(e,t,n)=>{const r=n(14688),i=4294967295,o="limiter";e.exports=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{maxQueueSize:i};this._queueLimiters={KEY_DEFAULT:new s(e,t)},this._limiterFlexible=e,this._maxQueueSize=t.maxQueueSize}getTokensRemaining(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o;return this._queueLimiters[e]?this._queueLimiters[e].getTokensRemaining():Promise.resolve(this._limiterFlexible.points)}removeTokens(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o;return this._queueLimiters[t]||(this._queueLimiters[t]=new s(this._limiterFlexible,{key:t,maxQueueSize:this._maxQueueSize})),this._queueLimiters[t].removeTokens(e)}};class s{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{maxQueueSize:i,key:o};this._key=t.key,this._waitTimeout=null,this._queue=[],this._limiterFlexible=e,this._maxQueueSize=t.maxQueueSize}getTokensRemaining(){return this._limiterFlexible.get(this._key).then((e=>null!==e?e.remainingPoints:this._limiterFlexible.points))}removeTokens(e){const t=this;return new Promise(((n,i)=>{e>t._limiterFlexible.points?i(new r("Requested tokens ".concat(e," exceeds maximum ").concat(t._limiterFlexible.points," tokens per interval"))):t._queue.length>0?t._queueRequest.call(t,n,i,e):t._limiterFlexible.consume(t._key,e).then((e=>{n(e.remainingPoints)})).catch((r=>{r instanceof Error?i(r):(t._queueRequest.call(t,n,i,e),null===t._waitTimeout&&(t._waitTimeout=setTimeout(t._processFIFO.bind(t),r.msBeforeNext)))}))}))}_queueRequest(e,t,n){const i=this;i._queue.length<i._maxQueueSize?i._queue.push({resolve:e,reject:t,tokens:n}):t(new r("Number of requests reached it's maximum ".concat(i._maxQueueSize)))}_processFIFO(){const e=this;if(null!==e._waitTimeout&&(clearTimeout(e._waitTimeout),e._waitTimeout=null),0===e._queue.length)return;const t=e._queue.shift();e._limiterFlexible.consume(e._key,t.tokens).then((n=>{t.resolve(n.remainingPoints),e._processFIFO.call(e)})).catch((n=>{n instanceof Error?(t.reject(n),e._processFIFO.call(e)):(e._queue.unshift(t),null===e._waitTimeout&&(e._waitTimeout=setTimeout(e._processFIFO.bind(e),n.msBeforeNext)))}))}}},8139:(e,t,n)=>{const r=n(41434),i=n(84819),o="redis.call('set', KEYS[1], 0, 'EX', ARGV[2], 'NX') local consumed = redis.call('incrby', KEYS[1], ARGV[1]) local ttl = redis.call('pttl', KEYS[1]) if ttl == -1 then   redis.call('expire', KEYS[1], ARGV[2])   ttl = 1000 * ARGV[2] end return {consumed, ttl} ";e.exports=class extends r{constructor(e){super(e),this.client=e.storeClient,this._rejectIfRedisNotReady=!!e.rejectIfRedisNotReady,this.useRedisPackage=e.useRedisPackage||"Commander"===this.client.constructor.name||!1,this.useRedis3AndLowerPackage=e.useRedis3AndLowerPackage,"function"===typeof this.client.defineCommand&&this.client.defineCommand("rlflxIncr",{numberOfKeys:1,lua:o})}_isRedisReady(){return!this._rejectIfRedisNotReady||(!this.client.status||"ready"===this.client.status)&&!("function"===typeof this.client.isReady&&!this.client.isReady())}_getRateLimiterRes(e,t,n){let[r,o]=n;Array.isArray(r)&&([,r]=r,[,o]=o);const s=new i;return s.consumedPoints=parseInt(r),s.isFirstInDuration=s.consumedPoints===t,s.remainingPoints=Math.max(this.points-s.consumedPoints,0),s.msBeforeNext=o,s}async _upsert(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!this._isRedisReady())throw new Error("Redis connection is not ready");const i=Math.floor(n/1e3),s=this.client.multi();return r?(i>0?this.useRedisPackage||this.useRedis3AndLowerPackage?s.set(e,t,{EX:i}):s.set(e,t,"EX",i):s.set(e,t),this.useRedisPackage||this.useRedis3AndLowerPackage?s.pTTL(e).exec(!0):s.pttl(e).exec(!0)):i>0?this.useRedisPackage||this.useRedis3AndLowerPackage?this.useRedis3AndLowerPackage?new Promise(((n,r)=>{const s=function(e,t){return e?r(e):n(t)};"function"===typeof this.client.rlflxIncr?this.client.rlflxIncr(e,t,i,s):this.client.eval(o,1,e,t,i,s)})):this.client.eval(o,{keys:[e],arguments:[String(t),String(i)]}):this.client.rlflxIncr([e].concat([String(t),String(i)])):this.useRedisPackage||this.useRedis3AndLowerPackage?s.incrBy(e,t).pTTL(e).exec(!0):s.incrby(e,t).pttl(e).exec(!0)}async _get(e){if(!this._isRedisReady())throw new Error("Redis connection is not ready");return this.useRedisPackage||this.useRedis3AndLowerPackage?this.client.multi().get(e).pTTL(e).exec(!0).then((e=>{const[t]=e;return null===t?null:e})):this.client.multi().get(e).pttl(e).exec().then((e=>{const[[,t]]=e;return null===t?null:e}))}_delete(e){return this.client.del(e).then((e=>e>0))}}},84819:e=>{e.exports=class{constructor(e,t,n,r){this.remainingPoints="undefined"===typeof e?0:e,this.msBeforeNext="undefined"===typeof t?0:t,this.consumedPoints="undefined"===typeof n?0:n,this.isFirstInDuration="undefined"!==typeof r&&r}get msBeforeNext(){return this._msBeforeNext}set msBeforeNext(e){return this._msBeforeNext=e,this}get remainingPoints(){return this._remainingPoints}set remainingPoints(e){return this._remainingPoints=e,this}get consumedPoints(){return this._consumedPoints}set consumedPoints(e){return this._consumedPoints=e,this}get isFirstInDuration(){return this._isFirstInDuration}set isFirstInDuration(e){this._isFirstInDuration=Boolean(e)}_getDecoratedProperties(){return{remainingPoints:this.remainingPoints,msBeforeNext:this.msBeforeNext,consumedPoints:this.consumedPoints,isFirstInDuration:this.isFirstInDuration}}[Symbol.for("nodejs.util.inspect.custom")](){return this._getDecoratedProperties()}toString(){return JSON.stringify(this._getDecoratedProperties())}toJSON(){return this._getDecoratedProperties()}}},41434:(e,t,n)=>{const r=n(88855),i=n(96704),o=n(84819);e.exports=class extends r{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(e),this.inMemoryBlockOnConsumed=e.inMemoryBlockOnConsumed,this.inMemoryBlockDuration=e.inMemoryBlockDuration,this.insuranceLimiter=e.insuranceLimiter,this._inMemoryBlockedKeys=new i}get client(){return this._client}set client(e){if("undefined"===typeof e)throw new Error("storeClient is not set");this._client=e}_afterConsume(e,t,n,r,i){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const s=this._getRateLimiterRes(n,r,i);if(this.inMemoryBlockOnConsumed>0&&!(this.inMemoryBlockDuration>0)&&s.consumedPoints>=this.inMemoryBlockOnConsumed)return this._inMemoryBlockedKeys.addMs(n,s.msBeforeNext),s.consumedPoints>this.points?t(s):e(s);if(s.consumedPoints>this.points){let e=Promise.resolve();this.blockDuration>0&&s.consumedPoints<=this.points+r&&(s.msBeforeNext=this.msBlockDuration,e=this._block(n,s.consumedPoints,this.msBlockDuration,o)),this.inMemoryBlockOnConsumed>0&&s.consumedPoints>=this.inMemoryBlockOnConsumed&&(this._inMemoryBlockedKeys.add(n,this.inMemoryBlockDuration),s.msBeforeNext=this.msInMemoryBlockDuration),e.then((()=>{t(s)})).catch((e=>{t(e)}))}else if(this.execEvenly&&s.msBeforeNext>0&&!s.isFirstInDuration){let t=Math.ceil(s.msBeforeNext/(s.remainingPoints+2));t<this.execEvenlyMinDelayMs&&(t=s.consumedPoints*this.execEvenlyMinDelayMs),setTimeout(e,t,s)}else e(s)}_handleError(e,t,n,i,o){let s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{};this.insuranceLimiter instanceof r?this.insuranceLimiter[t](o,s,a).then((e=>{n(e)})).catch((e=>{i(e)})):i(e)}getInMemoryBlockMsBeforeExpire(e){return this.inMemoryBlockOnConsumed>0?this._inMemoryBlockedKeys.msBeforeExpire(e):0}get inMemoryBlockOnConsumed(){return this._inMemoryBlockOnConsumed}set inMemoryBlockOnConsumed(e){if(this._inMemoryBlockOnConsumed=e?parseInt(e):0,this.inMemoryBlockOnConsumed>0&&this.points>this.inMemoryBlockOnConsumed)throw new Error('inMemoryBlockOnConsumed option must be greater or equal "points" option')}get inMemoryBlockDuration(){return this._inMemoryBlockDuration}set inMemoryBlockDuration(e){if(this._inMemoryBlockDuration=e?parseInt(e):0,this.inMemoryBlockDuration>0&&0===this.inMemoryBlockOnConsumed)throw new Error("inMemoryBlockOnConsumed option must be set up")}get msInMemoryBlockDuration(){return 1e3*this._inMemoryBlockDuration}get insuranceLimiter(){return this._insuranceLimiter}set insuranceLimiter(e){if("undefined"!==typeof e&&!(e instanceof r))throw new Error("insuranceLimiter must be instance of RateLimiterAbstract");this._insuranceLimiter=e,this._insuranceLimiter&&(this._insuranceLimiter.blockDuration=this.blockDuration,this._insuranceLimiter.execEvenly=this.execEvenly)}block(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=1e3*t;return this._block(this.getKey(e),this.points+1,r,n)}set(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i=1e3*(n>=0?n:this.duration);return this._block(this.getKey(e),t,i,r)}consume(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise(((r,i)=>{const s=this.getKey(e),a=this.getInMemoryBlockMsBeforeExpire(s);if(a>0)return i(new o(0,a));this._upsert(s,t,1e3*this._getKeySecDuration(n),!1,n).then((e=>{this._afterConsume(r,i,s,t,e)})).catch((o=>{this._handleError(o,"consume",r,i,e,t,n)}))}))}penalty(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=this.getKey(e);return new Promise(((i,o)=>{this._upsert(r,t,1e3*this._getKeySecDuration(n),!1,n).then((e=>{i(this._getRateLimiterRes(r,t,e))})).catch((r=>{this._handleError(r,"penalty",i,o,e,t,n)}))}))}reward(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=this.getKey(e);return new Promise(((i,o)=>{this._upsert(r,-t,1e3*this._getKeySecDuration(n),!1,n).then((e=>{i(this._getRateLimiterRes(r,-t,e))})).catch((r=>{this._handleError(r,"reward",i,o,e,t,n)}))}))}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=this.getKey(e);return new Promise(((r,i)=>{this._get(n,t).then((e=>{r(null===e||"undefined"===typeof e?null:this._getRateLimiterRes(n,0,e))})).catch((n=>{this._handleError(n,"get",r,i,e,t)}))}))}delete(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=this.getKey(e);return new Promise(((r,i)=>{this._delete(n,t).then((e=>{this._inMemoryBlockedKeys.delete(n),r(e)})).catch((n=>{this._handleError(n,"delete",r,i,e,t)}))}))}deleteInMemoryBlockedAll(){this._inMemoryBlockedKeys.delete()}_getRateLimiterRes(e,t,n){throw new Error("You have to implement the method '_getRateLimiterRes'!")}_block(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return new Promise(((i,s)=>{this._upsert(e,t,n,!0,r).then((()=>{i(new o(0,n>0?n:-1,t))})).catch((t=>{this._handleError(t,"block",i,s,this.parseKey(e),n/1e3,r)}))}))}_get(e){throw new Error("You have to implement the method '_get'!")}_delete(e){throw new Error("You have to implement the method '_delete'!")}_upsert(e,t,n){throw new Error("You have to implement the method '_upsert'!")}}},14066:(e,t,n)=>{const r=n(88855);e.exports=class{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(t.length<1)throw new Error("RateLimiterUnion: at least one limiter have to be passed");t.forEach((e=>{if(!(e instanceof r))throw new Error("RateLimiterUnion: all limiters have to be instance of RateLimiterAbstract")})),this._limiters=t}consume(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return new Promise(((n,r)=>{const i=[];this._limiters.forEach((n=>{i.push(n.consume(e,t).catch((e=>({rejected:!0,rej:e}))))})),Promise.all(i).then((e=>{const t={};let i=!1;e.forEach((e=>{!0===e.rejected&&(i=!0)}));for(let n=0;n<e.length;n++)i&&!0===e[n].rejected?t[this._limiters[n].keyPrefix]=e[n].rej:i||(t[this._limiters[n].keyPrefix]=e[n]);i?r(t):n(t)}))}))}}},79682:e=>{e.exports=class{constructor(){this._keys={},this._addedKeysAmount=0}collectExpired(){const e=Date.now();Object.keys(this._keys).forEach((t=>{this._keys[t]<=e&&delete this._keys[t]})),this._addedKeysAmount=Object.keys(this._keys).length}add(e,t){this.addMs(e,1e3*t)}addMs(e,t){this._keys[e]=Date.now()+t,this._addedKeysAmount++,this._addedKeysAmount>999&&this.collectExpired()}msBeforeExpire(e){const t=this._keys[e];if(t&&t>=Date.now()){this.collectExpired();const e=Date.now();return t>=e?t-e:0}return 0}delete(e){e?delete this._keys[e]:Object.keys(this._keys).forEach((e=>{delete this._keys[e]}))}}},96704:(e,t,n)=>{const r=n(79682);e.exports=r},14327:(e,t,n)=>{const r=n(29359),i=n(84819);e.exports=class{constructor(){this._storage={}}incrby(e,t,n){if(this._storage[e]){const r=this._storage[e].expiresAt?this._storage[e].expiresAt.getTime()-(new Date).getTime():-1;return 0!==r?(this._storage[e].value=this._storage[e].value+t,new i(0,r,this._storage[e].value,!1)):this.set(e,t,n)}return this.set(e,t,n)}set(e,t,n){const o=1e3*n;return this._storage[e]&&this._storage[e].timeoutId&&clearTimeout(this._storage[e].timeoutId),this._storage[e]=new r(t,o>0?new Date(Date.now()+o):null),o>0&&(this._storage[e].timeoutId=setTimeout((()=>{delete this._storage[e]}),o),this._storage[e].timeoutId.unref&&this._storage[e].timeoutId.unref()),new i(0,0===o?-1:o,this._storage[e].value,!0)}get(e){if(this._storage[e]){const t=this._storage[e].expiresAt?this._storage[e].expiresAt.getTime()-(new Date).getTime():-1;return new i(0,t,this._storage[e].value,!1)}return null}delete(e){return!!this._storage[e]&&(this._storage[e].timeoutId&&clearTimeout(this._storage[e].timeoutId),delete this._storage[e],!0)}}},29359:e=>{e.exports=class{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.value=e,this.expiresAt=t,this.timeoutId=n}get value(){return this._value}set value(e){this._value=parseInt(e)}get expiresAt(){return this._expiresAt}set expiresAt(e){e instanceof Date||!Number.isInteger(e)||(e=new Date(e)),this._expiresAt=e}get timeoutId(){return this._timeoutId}set timeoutId(e){this._timeoutId=e}}},14688:e=>{e.exports=class extends Error{constructor(e,t){super(),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="CustomError",this.message=e,t&&(this.extra=t)}}},12743:(e,t,n)=>{"use strict";n.r(t),n.d(t,{FILE:()=>r,TEXT:()=>o,URL:()=>i});var r="__NATIVE_FILE__",i="__NATIVE_URL__",o="__NATIVE_TEXT__"},60348:(e,t,n)=>{"use strict";n.d(t,{L:()=>_e,W:()=>Ie});var r=n(72791);function i(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var o="function"===typeof Symbol&&Symbol.observable||"@@observable",s=function(){return Math.random().toString(36).substring(7).split("").join(".")},a={INIT:"@@redux/INIT"+s(),REPLACE:"@@redux/REPLACE"+s(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+s()}};function c(e){if("object"!==typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function l(e,t,n){var r;if("function"===typeof t&&"function"===typeof n||"function"===typeof n&&"function"===typeof arguments[3])throw new Error(i(0));if("function"===typeof t&&"undefined"===typeof n&&(n=t,t=void 0),"undefined"!==typeof n){if("function"!==typeof n)throw new Error(i(1));return n(l)(e,t)}if("function"!==typeof e)throw new Error(i(2));var s=e,u=t,h=[],d=h,f=!1;function p(){d===h&&(d=h.slice())}function g(){if(f)throw new Error(i(3));return u}function y(e){if("function"!==typeof e)throw new Error(i(4));if(f)throw new Error(i(5));var t=!0;return p(),d.push(e),function(){if(t){if(f)throw new Error(i(6));t=!1,p();var n=d.indexOf(e);d.splice(n,1),h=null}}}function m(e){if(!c(e))throw new Error(i(7));if("undefined"===typeof e.type)throw new Error(i(8));if(f)throw new Error(i(9));try{f=!0,u=s(u,e)}finally{f=!1}for(var t=h=d,n=0;n<t.length;n++){(0,t[n])()}return e}return m({type:a.INIT}),(r={dispatch:m,subscribe:y,getState:g,replaceReducer:function(e){if("function"!==typeof e)throw new Error(i(10));s=e,m({type:a.REPLACE})}})[o]=function(){var e,t=y;return(e={subscribe:function(e){if("object"!==typeof e||null===e)throw new Error(i(11));function n(){e.next&&e.next(g())}return n(),{unsubscribe:t(n)}}})[o]=function(){return this},e},r}var u="dnd-core/INIT_COORDS",h="dnd-core/BEGIN_DRAG",d="dnd-core/PUBLISH_DRAG_SOURCE",f="dnd-core/HOVER",p="dnd-core/DROP",g="dnd-core/END_DRAG",y=function(e,t){return e===t};function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var w={initialSourceClientOffset:null,initialClientOffset:null,clientOffset:null};function E(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w,r=arguments.length>1?arguments[1]:void 0,i=r.payload;switch(r.type){case u:case h:return{initialSourceClientOffset:i.sourceClientOffset,initialClientOffset:i.clientOffset,clientOffset:i.clientOffset};case f:return e=n.clientOffset,t=i.clientOffset,!e&&!t||e&&t&&e.x===t.x&&e.y===t.y?n:v(v({},n),{},{clientOffset:i.clientOffset});case g:case p:return w;default:return n}}var A="dnd-core/ADD_SOURCE",S="dnd-core/ADD_TARGET",_="dnd-core/REMOVE_SOURCE",I="dnd-core/REMOVE_TARGET";function C(e){return C="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C(e)}function T(e){return"object"===C(e)}function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){x(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var P={itemType:null,item:null,sourceId:null,targetIds:[],dropResult:null,didDrop:!1,isSourcePublic:null};function D(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P,r=arguments.length>1?arguments[1]:void 0,i=r.payload;switch(r.type){case h:return R(R({},n),{},{itemType:i.itemType,item:i.item,sourceId:i.sourceId,isSourcePublic:i.isSourcePublic,dropResult:null,didDrop:!1});case d:return R(R({},n),{},{isSourcePublic:!0});case f:return R(R({},n),{},{targetIds:i.targetIds});case I:return-1===n.targetIds.indexOf(i.targetId)?n:R(R({},n),{},{targetIds:(e=n.targetIds,t=i.targetId,e.filter((function(e){return e!==t})))});case p:return R(R({},n),{},{dropResult:i.dropResult,didDrop:!0,targetIds:[]});case g:return R(R({},n),{},{itemType:null,item:null,sourceId:null,dropResult:null,didDrop:!1,isSourcePublic:null,targetIds:[]});default:return n}}function O(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;switch((arguments.length>1?arguments[1]:void 0).type){case A:case S:return e+1;case _:case I:return e-1;default:return e}}var N=[],B=[];function L(){var e=arguments.length>1?arguments[1]:void 0;switch(e.type){case f:break;case A:case S:case I:case _:return N;default:return B}var t=e.payload,n=t.targetIds,r=void 0===n?[]:n,i=t.prevTargetIds,o=void 0===i?[]:i,s=function(e,t){var n=new Map,r=function(e){n.set(e,n.has(e)?n.get(e)+1:1)};e.forEach(r),t.forEach(r);var i=[];return n.forEach((function(e,t){1===e&&i.push(t)})),i}(r,o),a=s.length>0||!function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:y;if(e.length!==t.length)return!1;for(var r=0;r<e.length;++r)if(!n(e[r],t[r]))return!1;return!0}(r,o);if(!a)return N;var c=o[o.length-1],l=r[r.length-1];return c!==l&&(c&&s.push(c),l&&s.push(l)),s}function M(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)+1}function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach((function(t){K(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function K(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;return{dirtyHandlerIds:L(r.dirtyHandlerIds,{type:i.type,payload:F(F({},i.payload),{},{prevTargetIds:(e=r,t="dragOperation.targetIds",n=[],t.split(".").reduce((function(e,t){return e&&e[t]?e[t]:n||null}),e))})}),dragOffset:E(r.dragOffset,i),refCount:O(r.refCount,i),dragOperation:D(r.dragOperation,i),stateId:M(r.stateId)}}N.__IS_NONE__=!0,B.__IS_ALL__=!0;var Z=n(5204);function z(e,t){return{type:u,payload:{sourceClientOffset:t||null,clientOffset:e||null}}}var V={type:u,payload:{clientOffset:null,sourceClientOffset:null}};function H(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{publishSource:!0},r=n.publishSource,i=void 0===r||r,o=n.clientOffset,s=n.getSourceClientOffset,a=e.getMonitor(),c=e.getRegistry();e.dispatch(z(o)),function(e,t,n){(0,Z.k)(!t.isDragging(),"Cannot call beginDrag while dragging."),e.forEach((function(e){(0,Z.k)(n.getSource(e),"Expected sourceIds to be registered.")}))}(t,a,c);var l=function(e,t){for(var n=null,r=e.length-1;r>=0;r--)if(t.canDragSource(e[r])){n=e[r];break}return n}(t,a);if(null!==l){var u=null;if(o){if(!s)throw new Error("getSourceClientOffset must be defined");!function(e){(0,Z.k)("function"===typeof e,"When clientOffset is provided, getSourceClientOffset must be a function.")}(s),u=s(l)}e.dispatch(z(o,u));var d=c.getSource(l).beginDrag(a,l);!function(e){(0,Z.k)(T(e),"Item must be an object.")}(d),c.pinSource(l);var f=c.getSourceType(l);return{type:h,payload:{itemType:f,item:d,sourceId:l,clientOffset:o||null,sourceClientOffset:u||null,isSourcePublic:!!i}}}e.dispatch(V)}}function q(e){return function(){if(e.getMonitor().isDragging())return{type:d}}}function G(e,t){return null===t?null===e:Array.isArray(e)?e.some((function(e){return e===t})):e===t}function W(e){return function(t){var n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).clientOffset;!function(e){(0,Z.k)(Array.isArray(e),"Expected targetIds to be an array.")}(t);var r=t.slice(0),i=e.getMonitor(),o=e.getRegistry();return function(e,t,n){(0,Z.k)(t.isDragging(),"Cannot call hover while not dragging."),(0,Z.k)(!t.didDrop(),"Cannot call hover after drop.");for(var r=0;r<e.length;r++){var i=e[r];(0,Z.k)(e.lastIndexOf(i)===r,"Expected targetIds to be unique in the passed array.");var o=n.getTarget(i);(0,Z.k)(o,"Expected targetIds to be registered.")}}(r,i,o),function(e,t,n){for(var r=e.length-1;r>=0;r--){var i=e[r];G(t.getTargetType(i),n)||e.splice(r,1)}}(r,o,i.getItemType()),function(e,t,n){e.forEach((function(e){n.getTarget(e).hover(t,e)}))}(r,i,o),{type:f,payload:{targetIds:r,clientOffset:n||null}}}}function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach((function(t){J(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function J(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function X(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.getMonitor(),r=e.getRegistry();!function(e){(0,Z.k)(e.isDragging(),"Cannot call drop while not dragging."),(0,Z.k)(!e.didDrop(),"Cannot call drop twice during one drag operation.")}(n);var i=function(e){var t=e.getTargetIds().filter(e.canDropOnTarget,e);return t.reverse(),t}(n);i.forEach((function(i,o){var s=function(e,t,n,r){var i=n.getTarget(e),o=i?i.drop(r,e):void 0;(function(e){(0,Z.k)("undefined"===typeof e||T(e),"Drop result must either be an object or undefined.")})(o),"undefined"===typeof o&&(o=0===t?{}:r.getDropResult());return o}(i,o,r,n),a={type:p,payload:{dropResult:Y(Y({},t),s)}};e.dispatch(a)}))}}function $(e){return function(){var t=e.getMonitor(),n=e.getRegistry();!function(e){(0,Z.k)(e.isDragging(),"Cannot call endDrag while not dragging.")}(t);var r=t.getSourceId();null!=r&&(n.getSource(r,!0).endDrag(t,r),n.unpinSource());return{type:g}}}function ee(e,t){return{x:e.x-t.x,y:e.y-t.y}}function te(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ne,re=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store=t,this.registry=n}var t,n,r;return t=e,n=[{key:"subscribeToStateChange",value:function(e){var t=this,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{handlerIds:void 0}).handlerIds;(0,Z.k)("function"===typeof e,"listener must be a function."),(0,Z.k)("undefined"===typeof n||Array.isArray(n),"handlerIds, when specified, must be an array of strings.");var r=this.store.getState().stateId;return this.store.subscribe((function(){var i=t.store.getState(),o=i.stateId;try{var s=o===r||o===r+1&&!function(e,t){return e!==N&&(e===B||"undefined"===typeof t||(n=e,t.filter((function(e){return n.indexOf(e)>-1}))).length>0);var n}(i.dirtyHandlerIds,n);s||e()}finally{r=o}}))}},{key:"subscribeToOffsetChange",value:function(e){var t=this;(0,Z.k)("function"===typeof e,"listener must be a function.");var n=this.store.getState().dragOffset;return this.store.subscribe((function(){var r=t.store.getState().dragOffset;r!==n&&(n=r,e())}))}},{key:"canDragSource",value:function(e){if(!e)return!1;var t=this.registry.getSource(e);return(0,Z.k)(t,"Expected to find a valid source."),!this.isDragging()&&t.canDrag(this,e)}},{key:"canDropOnTarget",value:function(e){if(!e)return!1;var t=this.registry.getTarget(e);return(0,Z.k)(t,"Expected to find a valid target."),!(!this.isDragging()||this.didDrop())&&G(this.registry.getTargetType(e),this.getItemType())&&t.canDrop(this,e)}},{key:"isDragging",value:function(){return Boolean(this.getItemType())}},{key:"isDraggingSource",value:function(e){if(!e)return!1;var t=this.registry.getSource(e,!0);return(0,Z.k)(t,"Expected to find a valid source."),!(!this.isDragging()||!this.isSourcePublic())&&this.registry.getSourceType(e)===this.getItemType()&&t.isDragging(this,e)}},{key:"isOverTarget",value:function(e){if(!e)return!1;var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shallow:!1}).shallow;if(!this.isDragging())return!1;var n=this.registry.getTargetType(e),r=this.getItemType();if(r&&!G(n,r))return!1;var i=this.getTargetIds();if(!i.length)return!1;var o=i.indexOf(e);return t?o===i.length-1:o>-1}},{key:"getItemType",value:function(){return this.store.getState().dragOperation.itemType}},{key:"getItem",value:function(){return this.store.getState().dragOperation.item}},{key:"getSourceId",value:function(){return this.store.getState().dragOperation.sourceId}},{key:"getTargetIds",value:function(){return this.store.getState().dragOperation.targetIds}},{key:"getDropResult",value:function(){return this.store.getState().dragOperation.dropResult}},{key:"didDrop",value:function(){return this.store.getState().dragOperation.didDrop}},{key:"isSourcePublic",value:function(){return Boolean(this.store.getState().dragOperation.isSourcePublic)}},{key:"getInitialClientOffset",value:function(){return this.store.getState().dragOffset.initialClientOffset}},{key:"getInitialSourceClientOffset",value:function(){return this.store.getState().dragOffset.initialSourceClientOffset}},{key:"getClientOffset",value:function(){return this.store.getState().dragOffset.clientOffset}},{key:"getSourceClientOffset",value:function(){return function(e){var t,n,r=e.clientOffset,i=e.initialClientOffset,o=e.initialSourceClientOffset;return r&&i&&o?ee((n=o,{x:(t=r).x+n.x,y:t.y+n.y}),i):null}(this.store.getState().dragOffset)}},{key:"getDifferenceFromInitialOffset",value:function(){return function(e){var t=e.clientOffset,n=e.initialClientOffset;return t&&n?ee(t,n):null}(this.store.getState().dragOffset)}}],n&&te(t.prototype,n),r&&te(t,r),e}(),ie=0;function oe(e){return oe="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},oe(e)}function se(e,t){t&&Array.isArray(e)?e.forEach((function(e){return se(e,!1)})):(0,Z.k)("string"===typeof e||"symbol"===oe(e),t?"Type can only be a string, a symbol, or an array of either.":"Type can only be a string or a symbol.")}!function(e){e.SOURCE="SOURCE",e.TARGET="TARGET"}(ne||(ne={}));const ae="undefined"!==typeof n.g?n.g:self,ce=ae.MutationObserver||ae.WebKitMutationObserver;function le(e){return function(){const t=setTimeout(r,0),n=setInterval(r,50);function r(){clearTimeout(t),clearInterval(n),e()}}}const ue="function"===typeof ce?function(e){let t=1;const n=new ce(e),r=document.createTextNode("");return n.observe(r,{characterData:!0}),function(){t=-t,r.data=t}}:le;class he{call(){try{this.task&&this.task()}catch(e){this.onError(e)}finally{this.task=null,this.release(this)}}constructor(e,t){this.onError=e,this.release=t,this.task=null}}const de=new class{enqueueTask(e){const{queue:t,requestFlush:n}=this;t.length||(n(),this.flushing=!0),t[t.length]=e}constructor(){this.queue=[],this.pendingErrors=[],this.flushing=!1,this.index=0,this.capacity=1024,this.flush=()=>{const{queue:e}=this;for(;this.index<e.length;){const t=this.index;if(this.index++,e[t].call(),this.index>this.capacity){for(let t=0,n=e.length-this.index;t<n;t++)e[t]=e[t+this.index];e.length-=this.index,this.index=0}}e.length=0,this.index=0,this.flushing=!1},this.registerPendingError=e=>{this.pendingErrors.push(e),this.requestErrorThrow()},this.requestFlush=ue(this.flush),this.requestErrorThrow=le((()=>{if(this.pendingErrors.length)throw this.pendingErrors.shift()}))}},fe=new class{create(e){const t=this.freeTasks,n=t.length?t.pop():new he(this.onError,(e=>t[t.length]=e));return n.task=e,n}constructor(e){this.onError=e,this.freeTasks=[]}}(de.registerPendingError);function pe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ge(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(c){i=!0,o=c}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return ye(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ye(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ye(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function me(e){var t=(ie++).toString();switch(e){case ne.SOURCE:return"S".concat(t);case ne.TARGET:return"T".concat(t);default:throw new Error("Unknown Handler Role: ".concat(e))}}function ve(e){switch(e[0]){case"S":return ne.SOURCE;case"T":return ne.TARGET;default:(0,Z.k)(!1,"Cannot parse handler ID: ".concat(e))}}function be(e,t){var n=e.entries(),r=!1;do{var i=n.next(),o=i.done;if(ge(i.value,2)[1]===t)return!0;r=!!o}while(!r);return!1}var we=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.types=new Map,this.dragSources=new Map,this.dropTargets=new Map,this.pinnedSourceId=null,this.pinnedSource=null,this.store=t}var t,n,r;return t=e,n=[{key:"addSource",value:function(e,t){se(e),function(e){(0,Z.k)("function"===typeof e.canDrag,"Expected canDrag to be a function."),(0,Z.k)("function"===typeof e.beginDrag,"Expected beginDrag to be a function."),(0,Z.k)("function"===typeof e.endDrag,"Expected endDrag to be a function.")}(t);var n=this.addHandler(ne.SOURCE,e,t);return this.store.dispatch(function(e){return{type:A,payload:{sourceId:e}}}(n)),n}},{key:"addTarget",value:function(e,t){se(e,!0),function(e){(0,Z.k)("function"===typeof e.canDrop,"Expected canDrop to be a function."),(0,Z.k)("function"===typeof e.hover,"Expected hover to be a function."),(0,Z.k)("function"===typeof e.drop,"Expected beginDrag to be a function.")}(t);var n=this.addHandler(ne.TARGET,e,t);return this.store.dispatch(function(e){return{type:S,payload:{targetId:e}}}(n)),n}},{key:"containsHandler",value:function(e){return be(this.dragSources,e)||be(this.dropTargets,e)}},{key:"getSource",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,Z.k)(this.isSourceId(e),"Expected a valid source ID."),t&&e===this.pinnedSourceId?this.pinnedSource:this.dragSources.get(e)}},{key:"getTarget",value:function(e){return(0,Z.k)(this.isTargetId(e),"Expected a valid target ID."),this.dropTargets.get(e)}},{key:"getSourceType",value:function(e){return(0,Z.k)(this.isSourceId(e),"Expected a valid source ID."),this.types.get(e)}},{key:"getTargetType",value:function(e){return(0,Z.k)(this.isTargetId(e),"Expected a valid target ID."),this.types.get(e)}},{key:"isSourceId",value:function(e){return ve(e)===ne.SOURCE}},{key:"isTargetId",value:function(e){return ve(e)===ne.TARGET}},{key:"removeSource",value:function(e){var t,n=this;(0,Z.k)(this.getSource(e),"Expected an existing source."),this.store.dispatch(function(e){return{type:_,payload:{sourceId:e}}}(e)),t=function(){n.dragSources.delete(e),n.types.delete(e)},de.enqueueTask(fe.create(t))}},{key:"removeTarget",value:function(e){(0,Z.k)(this.getTarget(e),"Expected an existing target."),this.store.dispatch(function(e){return{type:I,payload:{targetId:e}}}(e)),this.dropTargets.delete(e),this.types.delete(e)}},{key:"pinSource",value:function(e){var t=this.getSource(e);(0,Z.k)(t,"Expected an existing source."),this.pinnedSourceId=e,this.pinnedSource=t}},{key:"unpinSource",value:function(){(0,Z.k)(this.pinnedSource,"No source is pinned at the time."),this.pinnedSourceId=null,this.pinnedSource=null}},{key:"addHandler",value:function(e,t,n){var r=me(e);return this.types.set(r,t),e===ne.SOURCE?this.dragSources.set(r,n):e===ne.TARGET&&this.dropTargets.set(r,n),r}}],n&&pe(t.prototype,n),r&&pe(t,r),e}();function Ee(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ae=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.isSetUp=!1,this.handleRefCountChange=function(){var e=t.store.getState().refCount>0;t.backend&&(e&&!t.isSetUp?(t.backend.setup(),t.isSetUp=!0):!e&&t.isSetUp&&(t.backend.teardown(),t.isSetUp=!1))};var r=function(e){var t="undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__;return l(j,e&&t&&t({name:"dnd-core",instanceId:"dnd-core"}))}(n);this.store=r,this.monitor=new re(r,new we(r)),r.subscribe(this.handleRefCountChange)}var t,n,r;return t=e,n=[{key:"receiveBackend",value:function(e){this.backend=e}},{key:"getMonitor",value:function(){return this.monitor}},{key:"getBackend",value:function(){return this.backend}},{key:"getRegistry",value:function(){return this.monitor.registry}},{key:"getActions",value:function(){var e=this,t=this.store.dispatch,n=function(e){return{beginDrag:H(e),publishDragSource:q(e),hover:W(e),drop:X(e),endDrag:$(e)}}(this);return Object.keys(n).reduce((function(r,i){var o,s=n[i];return r[i]=(o=s,function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var s=o.apply(e,r);"undefined"!==typeof s&&t(s)}),r}),{})}},{key:"dispatch",value:function(e){this.store.dispatch(e)}}],n&&Ee(t.prototype,n),r&&Ee(t,r),e}();function Se(e,t,n,r){var i=new Ae(r),o=e(i,t,n);return i.receiveBackend(o),i}var _e=r.createContext({dragDropManager:void 0});function Ie(e,t,n,r){return{dragDropManager:Se(e,t,n,r)}}},94231:(e,t,n)=>{"use strict";n.d(t,{H:()=>s});var r=n(5204);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=!1,s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.targetId=null,this.internalMonitor=t.getMonitor()}var t,n,s;return t=e,(n=[{key:"receiveHandlerId",value:function(e){this.targetId=e}},{key:"getHandlerId",value:function(){return this.targetId}},{key:"subscribeToStateChange",value:function(e,t){return this.internalMonitor.subscribeToStateChange(e,t)}},{key:"canDrop",value:function(){if(!this.targetId)return!1;(0,r.k)(!o,"You may not call monitor.canDrop() inside your canDrop() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target-monitor");try{return o=!0,this.internalMonitor.canDropOnTarget(this.targetId)}finally{o=!1}}},{key:"isOver",value:function(e){return!!this.targetId&&this.internalMonitor.isOverTarget(this.targetId,e)}},{key:"getItemType",value:function(){return this.internalMonitor.getItemType()}},{key:"getItem",value:function(){return this.internalMonitor.getItem()}},{key:"getDropResult",value:function(){return this.internalMonitor.getDropResult()}},{key:"didDrop",value:function(){return this.internalMonitor.didDrop()}},{key:"getInitialClientOffset",value:function(){return this.internalMonitor.getInitialClientOffset()}},{key:"getInitialSourceClientOffset",value:function(){return this.internalMonitor.getInitialSourceClientOffset()}},{key:"getSourceClientOffset",value:function(){return this.internalMonitor.getSourceClientOffset()}},{key:"getClientOffset",value:function(){return this.internalMonitor.getClientOffset()}},{key:"getDifferenceFromInitialOffset",value:function(){return this.internalMonitor.getDifferenceFromInitialOffset()}}])&&i(t.prototype,n),s&&i(t,s),e}()},81274:(e,t,n)=>{"use strict";n.d(t,{Y:()=>a});var r=n(62702),i=n(90795),o=n(53864);function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hooks=(0,i.p)({dropTarget:function(e,t){n.clearDropTarget(),n.dropTargetOptions=t,(0,o.d)(e)?n.dropTargetRef=e:n.dropTargetNode=e,n.reconnect()}}),this.handlerId=null,this.dropTargetRef=null,this.dropTargetOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDropTarget=null,this.lastConnectedDropTargetOptions=null,this.backend=t}var t,n,a;return t=e,(n=[{key:"reconnect",value:function(){var e=this.didHandlerIdChange()||this.didDropTargetChange()||this.didOptionsChange();e&&this.disconnectDropTarget();var t=this.dropTarget;this.handlerId&&(t?e&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDropTarget=t,this.lastConnectedDropTargetOptions=this.dropTargetOptions,this.unsubscribeDropTarget=this.backend.connectDropTarget(this.handlerId,t,this.dropTargetOptions)):this.lastConnectedDropTarget=t)}},{key:"receiveHandlerId",value:function(e){e!==this.handlerId&&(this.handlerId=e,this.reconnect())}},{key:"didHandlerIdChange",value:function(){return this.lastConnectedHandlerId!==this.handlerId}},{key:"didDropTargetChange",value:function(){return this.lastConnectedDropTarget!==this.dropTarget}},{key:"didOptionsChange",value:function(){return!(0,r.w)(this.lastConnectedDropTargetOptions,this.dropTargetOptions)}},{key:"disconnectDropTarget",value:function(){this.unsubscribeDropTarget&&(this.unsubscribeDropTarget(),this.unsubscribeDropTarget=void 0)}},{key:"clearDropTarget",value:function(){this.dropTargetRef=null,this.dropTargetNode=null}},{key:"connectTarget",get:function(){return this.dropTarget}},{key:"dropTargetOptions",get:function(){return this.dropTargetOptionsInternal},set:function(e){this.dropTargetOptionsInternal=e}},{key:"dropTarget",get:function(){return this.dropTargetNode||this.dropTargetRef&&this.dropTargetRef.current}}])&&s(t.prototype,n),a&&s(t,a),e}()},64472:(e,t,n)=>{"use strict";function r(e,t,n){var r=n.getRegistry(),i=r.addTarget(e,t);return[i,function(){return r.removeTarget(i)}]}function i(e,t,n){var r=n.getRegistry(),i=r.addSource(e,t);return[i,function(){return r.removeSource(i)}]}n.d(t,{n:()=>r,w:()=>i})},90795:(e,t,n)=>{"use strict";n.d(t,{p:()=>a});var r=n(72791),i=n(5204);function o(e,t){"function"===typeof e?e(t):e.current=t}function s(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!(0,r.isValidElement)(t)){var s=t;return e(s,n),s}var a=t;!function(e){if("string"!==typeof e.type){var t=e.type.displayName||e.type.name||"the component";throw new Error("Only native element nodes can now be passed to React DnD connectors."+"You can either wrap ".concat(t," into a <div>, or turn it into a ")+"drag source or a drop target itself.")}}(a);var c=n?function(t){return e(t,n)}:e;return function(e,t){var n=e.ref;return(0,i.k)("string"!==typeof n,"Cannot connect React DnD to an element with an existing string ref. Please convert it to use a callback ref instead, or wrap it into a <span> or <div>. Read more: https://facebook.github.io/react/docs/more-about-refs.html#the-ref-callback-attribute"),n?(0,r.cloneElement)(e,{ref:function(e){o(n,e),o(t,e)}}):(0,r.cloneElement)(e,{ref:t})}(a,c)}}function a(e){var t={};return Object.keys(e).forEach((function(n){var r=e[n];if(n.endsWith("Ref"))t[n]=e[n];else{var i=s(r);t[n]=function(){return i}}})),t}},16533:(e,t,n)=>{"use strict";n.d(t,{DropTarget:()=>L});var r=n(5204);function i(e){return i="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function o(e){return"function"===typeof e}function s(){}function a(e){if(!function(e){return"object"===i(e)&&null!==e}(e))return!1;if(null===Object.getPrototypeOf(e))return!0;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}var c=n(64472);function l(e){return l="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function u(e,t){return"string"===typeof e||"symbol"===l(e)||!!t&&Array.isArray(e)&&e.every((function(e){return u(e,!1)}))}var h=n(81274),d=n(94231);function f(e){return(t=e)&&t.prototype&&"function"===typeof t.prototype.render||function(e){var t;return"Symbol(react.forward_ref)"===(null===e||void 0===e||null===(t=e.$$typeof)||void 0===t?void 0:t.toString())}(e);var t}var p=n(72791),g=n(62702),y=n(62110),m=n.n(y),v=n(60348);function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function E(e,t,n){return t&&w(e.prototype,t),n&&w(e,n),e}var A=function(){var e=function(){function e(t){b(this,e),this.isDisposed=!1,this.action=o(t)?t:s}return E(e,[{key:"dispose",value:function(){this.isDisposed||(this.action(),this.isDisposed=!0)}}],[{key:"isDisposable",value:function(e){return Boolean(e&&o(e.dispose))}},{key:"_fixup",value:function(t){return e.isDisposable(t)?t:e.empty}},{key:"create",value:function(t){return new e(t)}}]),e}();return e.empty={dispose:s},e}(),S=function(){function e(){b(this,e),this.isDisposed=!1;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this.disposables=n}return E(e,[{key:"add",value:function(e){this.isDisposed?e.dispose():this.disposables.push(e)}},{key:"remove",value:function(e){var t=!1;if(!this.isDisposed){var n=this.disposables.indexOf(e);-1!==n&&(t=!0,this.disposables.splice(n,1),e.dispose())}return t}},{key:"clear",value:function(){if(!this.isDisposed){for(var e=this.disposables.length,t=new Array(e),n=0;n<e;n++)t[n]=this.disposables[n];this.disposables=[];for(var r=0;r<e;r++)t[r].dispose()}}},{key:"dispose",value:function(){if(!this.isDisposed){this.isDisposed=!0;for(var e=this.disposables.length,t=new Array(e),n=0;n<e;n++)t[n]=this.disposables[n];this.disposables=[];for(var r=0;r<e;r++)t[r].dispose()}}}]),e}(),_=function(){function e(){b(this,e),this.isDisposed=!1}return E(e,[{key:"getDisposable",value:function(){return this.current}},{key:"setDisposable",value:function(e){var t=this.isDisposed;if(!t){var n=this.current;this.current=e,n&&n.dispose()}t&&e&&e.dispose()}},{key:"dispose",value:function(){if(!this.isDisposed){this.isDisposed=!0;var e=this.current;this.current=void 0,e&&e.dispose()}}}]),e}();function I(e){return I="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I(e)}function C(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(c){i=!0,o=c}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return T(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function R(e,t){return R=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},R(e,t)}function x(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=P(e);if(t){var i=P(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===I(t)||"function"===typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function P(e){return P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},P(e)}function D(e){var t=e.DecoratedComponent,n=e.createHandler,i=e.createMonitor,o=e.createConnector,s=e.registerHandler,a=e.containerDisplayName,c=e.getType,l=e.collect,u=e.options.arePropsEqual,h=void 0===u?g.w:u,d=t,y=t.displayName||t.name||"Component",b=function(){var e=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&R(e,t)}(b,e);var t,a,u,m=x(b);function b(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,b),(t=m.call(this,e)).decoratedRef=p.createRef(),t.handleChange=function(){var e=t.getCurrentState();(0,g.w)(e,t.state)||t.setState(e)},t.disposable=new _,t.receiveProps(e),t.dispose(),t}return t=b,(a=[{key:"getHandlerId",value:function(){return this.handlerId}},{key:"getDecoratedComponentInstance",value:function(){return(0,r.k)(this.decoratedRef.current,"In order to access an instance of the decorated component, it must either be a class component or use React.forwardRef()"),this.decoratedRef.current}},{key:"shouldComponentUpdate",value:function(e,t){return!h(e,this.props)||!(0,g.w)(t,this.state)}},{key:"componentDidMount",value:function(){this.disposable=new _,this.currentType=void 0,this.receiveProps(this.props),this.handleChange()}},{key:"componentDidUpdate",value:function(e){h(this.props,e)||(this.receiveProps(this.props),this.handleChange())}},{key:"componentWillUnmount",value:function(){this.dispose()}},{key:"receiveProps",value:function(e){this.handler&&(this.handler.receiveProps(e),this.receiveType(c(e)))}},{key:"receiveType",value:function(e){if(this.handlerMonitor&&this.manager&&this.handlerConnector&&e!==this.currentType){this.currentType=e;var t=C(s(e,this.handler,this.manager),2),n=t[0],r=t[1];this.handlerId=n,this.handlerMonitor.receiveHandlerId(n),this.handlerConnector.receiveHandlerId(n);var i=this.manager.getMonitor().subscribeToStateChange(this.handleChange,{handlerIds:[n]});this.disposable.setDisposable(new S(new A(i),new A(r)))}}},{key:"dispose",value:function(){this.disposable.dispose(),this.handlerConnector&&this.handlerConnector.receiveHandlerId(null)}},{key:"getCurrentState",value:function(){return this.handlerConnector?l(this.handlerConnector.hooks,this.handlerMonitor,this.props):{}}},{key:"render",value:function(){var e=this;return p.createElement(v.L.Consumer,null,(function(t){var n=t.dragDropManager;return e.receiveDragDropManager(n),"undefined"!==typeof requestAnimationFrame&&requestAnimationFrame((function(){var t;return null===(t=e.handlerConnector)||void 0===t?void 0:t.reconnect()})),p.createElement(d,Object.assign({},e.props,e.getCurrentState(),{ref:f(d)?e.decoratedRef:null}))}))}},{key:"receiveDragDropManager",value:function(e){void 0===this.manager&&((0,r.k)(void 0!==e,"Could not find the drag and drop manager in the context of %s. Make sure to render a DndProvider component in your top-level component. Read more: http://react-dnd.github.io/react-dnd/docs/troubleshooting#could-not-find-the-drag-and-drop-manager-in-the-context",y,y),void 0!==e&&(this.manager=e,this.handlerMonitor=i(e),this.handlerConnector=o(e.getBackend()),this.handler=n(this.handlerMonitor,this.decoratedRef)))}}])&&k(t.prototype,a),u&&k(t,u),b}(p.Component);return e.DecoratedComponent=t,e.displayName="".concat(a,"(").concat(y,")"),e}();return m()(b,t)}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var N=["canDrop","hover","drop"],B=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.props=null,this.spec=t,this.monitor=n,this.ref=r}var t,n,r;return t=e,(n=[{key:"receiveProps",value:function(e){this.props=e}},{key:"receiveMonitor",value:function(e){this.monitor=e}},{key:"canDrop",value:function(){return!this.spec.canDrop||this.spec.canDrop(this.props,this.monitor)}},{key:"hover",value:function(){this.spec.hover&&this.props&&this.spec.hover(this.props,this.monitor,function(e){var t=e.current;return null==t?null:t.decoratedRef?t.decoratedRef.current:t}(this.ref))}},{key:"drop",value:function(){if(this.spec.drop)return this.spec.drop(this.props,this.monitor,this.ref.current)}}])&&O(t.prototype,n),r&&O(t,r),e}();function L(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=e;"function"!==typeof e&&((0,r.k)(u(e,!0),'Expected "type" provided as the first argument to DropTarget to be a string, an array of strings, or a function that returns either given the current props. Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target',e),o=function(){return e}),(0,r.k)(a(t),'Expected "spec" provided as the second argument to DropTarget to be a plain object. Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target',t);var s=function(e){return Object.keys(e).forEach((function(t){(0,r.k)(N.indexOf(t)>-1,'Expected the drop target specification to only have some of the following keys: %s. Instead received a specification with an unexpected "%s" key. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target',N.join(", "),t),(0,r.k)("function"===typeof e[t],"Expected %s in the drop target specification to be a function. Instead received a specification with %s: %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target",t,t,e[t])})),function(t,n){return new B(e,t,n)}}(t);return(0,r.k)("function"===typeof n,'Expected "collect" provided as the third argument to DropTarget to be a function that returns a plain object of props to inject. Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target',n),(0,r.k)(a(i),'Expected "options" provided as the fourth argument to DropTarget to be a plain object when specified. Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target',n),function(e){return D({containerDisplayName:"DropTarget",createHandler:s,registerHandler:c.n,createMonitor:function(e){return new d.H(e)},createConnector:function(e){return new h.Y(e)},DecoratedComponent:e,getType:o,collect:n,options:i})}}},77208:(e,t,n)=>{"use strict";n.d(t,{DropTarget:()=>i.DropTarget});var r=n(17810);n.o(r,"DropTarget")&&n.d(t,{DropTarget:function(){return r.DropTarget}});var i=n(16533)},85848:()=>{},38302:()=>{},17810:(e,t,n)=>{"use strict";var r=n(7473);n.o(r,"DropTarget")&&n.d(t,{DropTarget:function(){return r.DropTarget}});var i=n(38302);n.o(i,"DropTarget")&&n.d(t,{DropTarget:function(){return i.DropTarget}});var o=n(85807);n.o(o,"DropTarget")&&n.d(t,{DropTarget:function(){return o.DropTarget}});var s=n(85848);n.o(s,"DropTarget")&&n.d(t,{DropTarget:function(){return s.DropTarget}})},7473:()=>{},85807:()=>{},53864:(e,t,n)=>{"use strict";function r(e){return r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e){return null!==e&&"object"===r(e)&&Object.prototype.hasOwnProperty.call(e,"current")}n.d(t,{d:()=>i})},34463:(e,t,n)=>{"use strict";var r=n(72791),i=n(31725),o=n(45296);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!r)throw Error(s(227));function a(e,t,n,r,i,o,s,a,c){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(u){this.onError(u)}}var c=!1,l=null,u=!1,h=null,d={onError:function(e){c=!0,l=e}};function f(e,t,n,r,i,o,s,u,h){c=!1,l=null,a.apply(d,arguments)}var p=null,g=null,y=null;function m(e,t,n){var r=e.type||"unknown-event";e.currentTarget=y(n),function(e,t,n,r,i,o,a,d,p){if(f.apply(this,arguments),c){if(!c)throw Error(s(198));var g=l;c=!1,l=null,u||(u=!0,h=g)}}(r,t,void 0,e),e.currentTarget=null}var v=null,b={};function w(){if(v)for(var e in b){var t=b[e],n=v.indexOf(e);if(!(-1<n))throw Error(s(96,e));if(!A[n]){if(!t.extractEvents)throw Error(s(97,e));for(var r in A[n]=t,n=t.eventTypes){var i=void 0,o=n[r],a=t,c=r;if(S.hasOwnProperty(c))throw Error(s(99,c));S[c]=o;var l=o.phasedRegistrationNames;if(l){for(i in l)l.hasOwnProperty(i)&&E(l[i],a,c);i=!0}else o.registrationName?(E(o.registrationName,a,c),i=!0):i=!1;if(!i)throw Error(s(98,r,e))}}}}function E(e,t,n){if(_[e])throw Error(s(100,e));_[e]=t,I[e]=t.eventTypes[n].dependencies}var A=[],S={},_={},I={};function C(e){var t,n=!1;for(t in e)if(e.hasOwnProperty(t)){var r=e[t];if(!b.hasOwnProperty(t)||b[t]!==r){if(b[t])throw Error(s(102,t));b[t]=r,n=!0}}n&&w()}var T=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),k=null,R=null,x=null;function P(e){if(e=g(e)){if("function"!==typeof k)throw Error(s(280));var t=e.stateNode;t&&(t=p(t),k(e.stateNode,e.type,t))}}function D(e){R?x?x.push(e):x=[e]:R=e}function O(){if(R){var e=R,t=x;if(x=R=null,P(e),t)for(e=0;e<t.length;e++)P(t[e])}}function N(e,t){return e(t)}function B(e,t,n,r,i){return e(t,n,r,i)}function L(){}var M=N,U=!1,F=!1;function K(){null===R&&null===x||(L(),O())}function j(e,t,n){if(F)return e(t,n);F=!0;try{return M(e,t,n)}finally{F=!1,K()}}var Z=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,z=Object.prototype.hasOwnProperty,V={},H={};function q(e,t,n,r,i,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o}var G={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){G[e]=new q(e,0,!1,e,null,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];G[t]=new q(t,1,!1,e[1],null,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){G[e]=new q(e,2,!1,e.toLowerCase(),null,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){G[e]=new q(e,2,!1,e,null,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){G[e]=new q(e,3,!1,e.toLowerCase(),null,!1)})),["checked","multiple","muted","selected"].forEach((function(e){G[e]=new q(e,3,!0,e,null,!1)})),["capture","download"].forEach((function(e){G[e]=new q(e,4,!1,e,null,!1)})),["cols","rows","size","span"].forEach((function(e){G[e]=new q(e,6,!1,e,null,!1)})),["rowSpan","start"].forEach((function(e){G[e]=new q(e,5,!1,e.toLowerCase(),null,!1)}));var W=/[\-:]([a-z])/g;function Q(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(W,Q);G[t]=new q(t,1,!1,e,null,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(W,Q);G[t]=new q(t,1,!1,e,"http://www.w3.org/1999/xlink",!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(W,Q);G[t]=new q(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1)})),["tabIndex","crossOrigin"].forEach((function(e){G[e]=new q(e,1,!1,e.toLowerCase(),null,!1)})),G.xlinkHref=new q("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0),["src","href","action","formAction"].forEach((function(e){G[e]=new q(e,1,!1,e.toLowerCase(),null,!0)}));var Y=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function J(e,t,n,r){var i=G.hasOwnProperty(t)?G[t]:null;(null!==i?0===i.type:!r&&(2<t.length&&("o"===t[0]||"O"===t[0])&&("n"===t[1]||"N"===t[1])))||(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!z.call(H,e)||!z.call(V,e)&&(Z.test(e)?H[e]=!0:(V[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}Y.hasOwnProperty("ReactCurrentDispatcher")||(Y.ReactCurrentDispatcher={current:null}),Y.hasOwnProperty("ReactCurrentBatchConfig")||(Y.ReactCurrentBatchConfig={suspense:null});var X=/^(.*)[\\\/]/,$="function"===typeof Symbol&&Symbol.for,ee=$?Symbol.for("react.element"):60103,te=$?Symbol.for("react.portal"):60106,ne=$?Symbol.for("react.fragment"):60107,re=$?Symbol.for("react.strict_mode"):60108,ie=$?Symbol.for("react.profiler"):60114,oe=$?Symbol.for("react.provider"):60109,se=$?Symbol.for("react.context"):60110,ae=$?Symbol.for("react.concurrent_mode"):60111,ce=$?Symbol.for("react.forward_ref"):60112,le=$?Symbol.for("react.suspense"):60113,ue=$?Symbol.for("react.suspense_list"):60120,he=$?Symbol.for("react.memo"):60115,de=$?Symbol.for("react.lazy"):60116,fe=$?Symbol.for("react.block"):60121,pe="function"===typeof Symbol&&Symbol.iterator;function ge(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=pe&&e[pe]||e["@@iterator"])?e:null}function ye(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case ne:return"Fragment";case te:return"Portal";case ie:return"Profiler";case re:return"StrictMode";case le:return"Suspense";case ue:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case se:return"Context.Consumer";case oe:return"Context.Provider";case ce:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case he:return ye(e.type);case fe:return ye(e.render);case de:if(e=1===e._status?e._result:null)return ye(e)}return null}function me(e){var t="";do{e:switch(e.tag){case 3:case 4:case 6:case 7:case 10:case 9:var n="";break e;default:var r=e._debugOwner,i=e._debugSource,o=ye(e.type);n=null,r&&(n=ye(r.type)),r=o,o="",i?o=" (at "+i.fileName.replace(X,"")+":"+i.lineNumber+")":n&&(o=" (created by "+n+")"),n="\n    in "+(r||"Unknown")+o}t+=n,e=e.return}while(e);return t}function ve(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}function be(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function we(e){e._valueTracker||(e._valueTracker=function(e){var t=be(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function Ee(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=be(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Ae(e,t){var n=t.checked;return i({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Se(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=ve(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function _e(e,t){null!=(t=t.checked)&&J(e,"checked",t,!1)}function Ie(e,t){_e(e,t);var n=ve(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?Te(e,t.type,n):t.hasOwnProperty("defaultValue")&&Te(e,t.type,ve(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Ce(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function Te(e,t,n){"number"===t&&e.ownerDocument.activeElement===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}function ke(e,t){return e=i({children:void 0},t),(t=function(e){var t="";return r.Children.forEach(e,(function(e){null!=e&&(t+=e)})),t}(t.children))&&(e.children=t),e}function Re(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ve(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function xe(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return i({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Pe(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(Array.isArray(n)){if(!(1>=n.length))throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:ve(n)}}function De(e,t){var n=ve(t.value),r=ve(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function Oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}var Ne="http://www.w3.org/1999/xhtml",Be="http://www.w3.org/2000/svg";function Le(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Me(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?Le(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var Ue,Fe,Ke=(Fe=function(e,t){if(e.namespaceURI!==Be||"innerHTML"in e)e.innerHTML=t;else{for((Ue=Ue||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Ue.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return Fe(e,t)}))}:Fe);function je(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}function Ze(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var ze={animationend:Ze("Animation","AnimationEnd"),animationiteration:Ze("Animation","AnimationIteration"),animationstart:Ze("Animation","AnimationStart"),transitionend:Ze("Transition","TransitionEnd")},Ve={},He={};function qe(e){if(Ve[e])return Ve[e];if(!ze[e])return e;var t,n=ze[e];for(t in n)if(n.hasOwnProperty(t)&&t in He)return Ve[e]=n[t];return e}T&&(He=document.createElement("div").style,"AnimationEvent"in window||(delete ze.animationend.animation,delete ze.animationiteration.animation,delete ze.animationstart.animation),"TransitionEvent"in window||delete ze.transitionend.transition);var Ge=qe("animationend"),We=qe("animationiteration"),Qe=qe("animationstart"),Ye=qe("transitionend"),Je="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Xe=new("function"===typeof WeakMap?WeakMap:Map);function $e(e){var t=Xe.get(e);return void 0===t&&(t=new Map,Xe.set(e,t)),t}function et(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(1026&(t=e).effectTag)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function tt(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function nt(e){if(et(e)!==e)throw Error(s(188))}function rt(e){if(e=function(e){var t=e.alternate;if(!t){if(null===(t=et(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return nt(i),e;if(o===r)return nt(i),t;o=o.sibling}throw Error(s(188))}if(n.return!==r.return)n=i,r=o;else{for(var a=!1,c=i.child;c;){if(c===n){a=!0,n=i,r=o;break}if(c===r){a=!0,r=i,n=o;break}c=c.sibling}if(!a){for(c=o.child;c;){if(c===n){a=!0,n=o,r=i;break}if(c===r){a=!0,r=o,n=i;break}c=c.sibling}if(!a)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e),!e)return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}function it(e,t){if(null==t)throw Error(s(30));return null==e?t:Array.isArray(e)?Array.isArray(t)?(e.push.apply(e,t),e):(e.push(t),e):Array.isArray(t)?[e].concat(t):[e,t]}function ot(e,t,n){Array.isArray(e)?e.forEach(t,n):e&&t.call(n,e)}var st=null;function at(e){if(e){var t=e._dispatchListeners,n=e._dispatchInstances;if(Array.isArray(t))for(var r=0;r<t.length&&!e.isPropagationStopped();r++)m(e,t[r],n[r]);else t&&m(e,t,n);e._dispatchListeners=null,e._dispatchInstances=null,e.isPersistent()||e.constructor.release(e)}}function ct(e){if(null!==e&&(st=it(st,e)),e=st,st=null,e){if(ot(e,at),st)throw Error(s(95));if(u)throw e=h,u=!1,h=null,e}}function lt(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}function ut(e){if(!T)return!1;var t=(e="on"+e)in document;return t||((t=document.createElement("div")).setAttribute(e,"return;"),t="function"===typeof t[e]),t}var ht=[];function dt(e){e.topLevelType=null,e.nativeEvent=null,e.targetInst=null,e.ancestors.length=0,10>ht.length&&ht.push(e)}function ft(e,t,n,r){if(ht.length){var i=ht.pop();return i.topLevelType=e,i.eventSystemFlags=r,i.nativeEvent=t,i.targetInst=n,i}return{topLevelType:e,eventSystemFlags:r,nativeEvent:t,targetInst:n,ancestors:[]}}function pt(e){var t=e.targetInst,n=t;do{if(!n){e.ancestors.push(n);break}var r=n;if(3===r.tag)r=r.stateNode.containerInfo;else{for(;r.return;)r=r.return;r=3!==r.tag?null:r.stateNode.containerInfo}if(!r)break;5!==(t=n.tag)&&6!==t||e.ancestors.push(n),n=On(r)}while(n);for(n=0;n<e.ancestors.length;n++){t=e.ancestors[n];var i=lt(e.nativeEvent);r=e.topLevelType;var o=e.nativeEvent,s=e.eventSystemFlags;0===n&&(s|=64);for(var a=null,c=0;c<A.length;c++){var l=A[c];l&&(l=l.extractEvents(r,t,o,i,s))&&(a=it(a,l))}ct(a)}}function gt(e,t,n){if(!n.has(e)){switch(e){case"scroll":Qt(t,"scroll",!0);break;case"focus":case"blur":Qt(t,"focus",!0),Qt(t,"blur",!0),n.set("blur",null),n.set("focus",null);break;case"cancel":case"close":ut(e)&&Qt(t,e,!0);break;case"invalid":case"submit":case"reset":break;default:-1===Je.indexOf(e)&&Wt(e,t)}n.set(e,null)}}var yt,mt,vt,bt=!1,wt=[],Et=null,At=null,St=null,_t=new Map,It=new Map,Ct=[],Tt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput close cancel copy cut paste click change contextmenu reset submit".split(" "),kt="focus blur dragenter dragleave mouseover mouseout pointerover pointerout gotpointercapture lostpointercapture".split(" ");function Rt(e,t,n,r,i){return{blockedOn:e,topLevelType:t,eventSystemFlags:32|n,nativeEvent:i,container:r}}function xt(e,t){switch(e){case"focus":case"blur":Et=null;break;case"dragenter":case"dragleave":At=null;break;case"mouseover":case"mouseout":St=null;break;case"pointerover":case"pointerout":_t.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":It.delete(t.pointerId)}}function Pt(e,t,n,r,i,o){return null===e||e.nativeEvent!==o?(e=Rt(t,n,r,i,o),null!==t&&(null!==(t=Nn(t))&&mt(t)),e):(e.eventSystemFlags|=r,e)}function Dt(e){var t=On(e.target);if(null!==t){var n=et(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=tt(n)))return e.blockedOn=t,void o.unstable_runWithPriority(e.priority,(function(){vt(n)}))}else if(3===t&&n.stateNode.hydrate)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ot(e){if(null!==e.blockedOn)return!1;var t=$t(e.topLevelType,e.eventSystemFlags,e.container,e.nativeEvent);if(null!==t){var n=Nn(t);return null!==n&&mt(n),e.blockedOn=t,!1}return!0}function Nt(e,t,n){Ot(e)&&n.delete(t)}function Bt(){for(bt=!1;0<wt.length;){var e=wt[0];if(null!==e.blockedOn){null!==(e=Nn(e.blockedOn))&&yt(e);break}var t=$t(e.topLevelType,e.eventSystemFlags,e.container,e.nativeEvent);null!==t?e.blockedOn=t:wt.shift()}null!==Et&&Ot(Et)&&(Et=null),null!==At&&Ot(At)&&(At=null),null!==St&&Ot(St)&&(St=null),_t.forEach(Nt),It.forEach(Nt)}function Lt(e,t){e.blockedOn===t&&(e.blockedOn=null,bt||(bt=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,Bt)))}function Mt(e){function t(t){return Lt(t,e)}if(0<wt.length){Lt(wt[0],e);for(var n=1;n<wt.length;n++){var r=wt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Et&&Lt(Et,e),null!==At&&Lt(At,e),null!==St&&Lt(St,e),_t.forEach(t),It.forEach(t),n=0;n<Ct.length;n++)(r=Ct[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Ct.length&&null===(n=Ct[0]).blockedOn;)Dt(n),null===n.blockedOn&&Ct.shift()}var Ut={},Ft=new Map,Kt=new Map,jt=["abort","abort",Ge,"animationEnd",We,"animationIteration",Qe,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",Ye,"transitionEnd","waiting","waiting"];function Zt(e,t){for(var n=0;n<e.length;n+=2){var r=e[n],i=e[n+1],o="on"+(i[0].toUpperCase()+i.slice(1));o={phasedRegistrationNames:{bubbled:o,captured:o+"Capture"},dependencies:[r],eventPriority:t},Kt.set(r,t),Ft.set(r,o),Ut[i]=o}}Zt("blur blur cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focus focus input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),Zt("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),Zt(jt,2);for(var zt="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),Vt=0;Vt<zt.length;Vt++)Kt.set(zt[Vt],0);var Ht=o.unstable_UserBlockingPriority,qt=o.unstable_runWithPriority,Gt=!0;function Wt(e,t){Qt(t,e,!1)}function Qt(e,t,n){var r=Kt.get(t);switch(void 0===r?2:r){case 0:r=Yt.bind(null,t,1,e);break;case 1:r=Jt.bind(null,t,1,e);break;default:r=Xt.bind(null,t,1,e)}n?e.addEventListener(t,r,!0):e.addEventListener(t,r,!1)}function Yt(e,t,n,r){U||L();var i=Xt,o=U;U=!0;try{B(i,e,t,n,r)}finally{(U=o)||K()}}function Jt(e,t,n,r){qt(Ht,Xt.bind(null,e,t,n,r))}function Xt(e,t,n,r){if(Gt)if(0<wt.length&&-1<Tt.indexOf(e))e=Rt(null,e,t,n,r),wt.push(e);else{var i=$t(e,t,n,r);if(null===i)xt(e,r);else if(-1<Tt.indexOf(e))e=Rt(i,e,t,n,r),wt.push(e);else if(!function(e,t,n,r,i){switch(t){case"focus":return Et=Pt(Et,e,t,n,r,i),!0;case"dragenter":return At=Pt(At,e,t,n,r,i),!0;case"mouseover":return St=Pt(St,e,t,n,r,i),!0;case"pointerover":var o=i.pointerId;return _t.set(o,Pt(_t.get(o)||null,e,t,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,It.set(o,Pt(It.get(o)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r)){xt(e,r),e=ft(e,r,null,t);try{j(pt,e)}finally{dt(e)}}}}function $t(e,t,n,r){if(null!==(n=On(n=lt(r)))){var i=et(n);if(null===i)n=null;else{var o=i.tag;if(13===o){if(null!==(n=tt(i)))return n;n=null}else if(3===o){if(i.stateNode.hydrate)return 3===i.tag?i.stateNode.containerInfo:null;n=null}else i!==n&&(n=null)}}e=ft(e,r,n,t);try{j(pt,e)}finally{dt(e)}return null}var en={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},tn=["Webkit","ms","Moz","O"];function nn(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||en.hasOwnProperty(e)&&en[e]?(""+t).trim():t+"px"}function rn(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=nn(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(en).forEach((function(e){tn.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),en[t]=en[e]}))}));var on=i({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function sn(e,t){if(t){if(on[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e,""));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62,""))}}function an(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var cn=Ne;function ln(e,t){var n=$e(e=9===e.nodeType||11===e.nodeType?e:e.ownerDocument);t=I[t];for(var r=0;r<t.length;r++)gt(t[r],e,n)}function un(){}function hn(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function dn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function fn(e,t){var n,r=dn(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=dn(r)}}function pn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?pn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function gn(){for(var e=window,t=hn();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=hn((e=t.contentWindow).document)}return t}function yn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var mn="$",vn="/$",bn="$?",wn="$!",En=null,An=null;function Sn(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function _n(e,t){return"textarea"===e||"option"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var In="function"===typeof setTimeout?setTimeout:void 0,Cn="function"===typeof clearTimeout?clearTimeout:void 0;function Tn(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break}return e}function kn(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if(n===mn||n===wn||n===bn){if(0===t)return e;t--}else n===vn&&t++}e=e.previousSibling}return null}var Rn=Math.random().toString(36).slice(2),xn="__reactInternalInstance$"+Rn,Pn="__reactEventHandlers$"+Rn,Dn="__reactContainere$"+Rn;function On(e){var t=e[xn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Dn]||n[xn]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=kn(e);null!==e;){if(n=e[xn])return n;e=kn(e)}return t}n=(e=n).parentNode}return null}function Nn(e){return!(e=e[xn]||e[Dn])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function Bn(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function Ln(e){return e[Pn]||null}function Mn(e){do{e=e.return}while(e&&5!==e.tag);return e||null}function Un(e,t){var n=e.stateNode;if(!n)return null;var r=p(n);if(!r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}function Fn(e,t,n){(t=Un(e,n.dispatchConfig.phasedRegistrationNames[t]))&&(n._dispatchListeners=it(n._dispatchListeners,t),n._dispatchInstances=it(n._dispatchInstances,e))}function Kn(e){if(e&&e.dispatchConfig.phasedRegistrationNames){for(var t=e._targetInst,n=[];t;)n.push(t),t=Mn(t);for(t=n.length;0<t--;)Fn(n[t],"captured",e);for(t=0;t<n.length;t++)Fn(n[t],"bubbled",e)}}function jn(e,t,n){e&&n&&n.dispatchConfig.registrationName&&(t=Un(e,n.dispatchConfig.registrationName))&&(n._dispatchListeners=it(n._dispatchListeners,t),n._dispatchInstances=it(n._dispatchInstances,e))}function Zn(e){e&&e.dispatchConfig.registrationName&&jn(e._targetInst,null,e)}function zn(e){ot(e,Kn)}var Vn=null,Hn=null,qn=null;function Gn(){if(qn)return qn;var e,t,n=Hn,r=n.length,i="value"in Vn?Vn.value:Vn.textContent,o=i.length;for(e=0;e<r&&n[e]===i[e];e++);var s=r-e;for(t=1;t<=s&&n[r-t]===i[o-t];t++);return qn=i.slice(e,1<t?1-t:void 0)}function Wn(){return!0}function Qn(){return!1}function Yn(e,t,n,r){for(var i in this.dispatchConfig=e,this._targetInst=t,this.nativeEvent=n,e=this.constructor.Interface)e.hasOwnProperty(i)&&((t=e[i])?this[i]=t(n):"target"===i?this.target=r:this[i]=n[i]);return this.isDefaultPrevented=(null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue)?Wn:Qn,this.isPropagationStopped=Qn,this}function Jn(e,t,n,r){if(this.eventPool.length){var i=this.eventPool.pop();return this.call(i,e,t,n,r),i}return new this(e,t,n,r)}function Xn(e){if(!(e instanceof this))throw Error(s(279));e.destructor(),10>this.eventPool.length&&this.eventPool.push(e)}function $n(e){e.eventPool=[],e.getPooled=Jn,e.release=Xn}i(Yn.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Wn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Wn)},persist:function(){this.isPersistent=Wn},isPersistent:Qn,destructor:function(){var e,t=this.constructor.Interface;for(e in t)this[e]=null;this.nativeEvent=this._targetInst=this.dispatchConfig=null,this.isPropagationStopped=this.isDefaultPrevented=Qn,this._dispatchInstances=this._dispatchListeners=null}}),Yn.Interface={type:null,target:null,currentTarget:function(){return null},eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null},Yn.extend=function(e){function t(){}function n(){return r.apply(this,arguments)}var r=this;t.prototype=r.prototype;var o=new t;return i(o,n.prototype),n.prototype=o,n.prototype.constructor=n,n.Interface=i({},r.Interface,e),n.extend=r.extend,$n(n),n},$n(Yn);var er=Yn.extend({data:null}),tr=Yn.extend({data:null}),nr=[9,13,27,32],rr=T&&"CompositionEvent"in window,ir=null;T&&"documentMode"in document&&(ir=document.documentMode);var or=T&&"TextEvent"in window&&!ir,sr=T&&(!rr||ir&&8<ir&&11>=ir),ar=String.fromCharCode(32),cr={beforeInput:{phasedRegistrationNames:{bubbled:"onBeforeInput",captured:"onBeforeInputCapture"},dependencies:["compositionend","keypress","textInput","paste"]},compositionEnd:{phasedRegistrationNames:{bubbled:"onCompositionEnd",captured:"onCompositionEndCapture"},dependencies:"blur compositionend keydown keypress keyup mousedown".split(" ")},compositionStart:{phasedRegistrationNames:{bubbled:"onCompositionStart",captured:"onCompositionStartCapture"},dependencies:"blur compositionstart keydown keypress keyup mousedown".split(" ")},compositionUpdate:{phasedRegistrationNames:{bubbled:"onCompositionUpdate",captured:"onCompositionUpdateCapture"},dependencies:"blur compositionupdate keydown keypress keyup mousedown".split(" ")}},lr=!1;function ur(e,t){switch(e){case"keyup":return-1!==nr.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"blur":return!0;default:return!1}}function hr(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var dr=!1;var fr={eventTypes:cr,extractEvents:function(e,t,n,r){var i;if(rr)e:{switch(e){case"compositionstart":var o=cr.compositionStart;break e;case"compositionend":o=cr.compositionEnd;break e;case"compositionupdate":o=cr.compositionUpdate;break e}o=void 0}else dr?ur(e,n)&&(o=cr.compositionEnd):"keydown"===e&&229===n.keyCode&&(o=cr.compositionStart);return o?(sr&&"ko"!==n.locale&&(dr||o!==cr.compositionStart?o===cr.compositionEnd&&dr&&(i=Gn()):(Hn="value"in(Vn=r)?Vn.value:Vn.textContent,dr=!0)),o=er.getPooled(o,t,n,r),i?o.data=i:null!==(i=hr(n))&&(o.data=i),zn(o),i=o):i=null,(e=or?function(e,t){switch(e){case"compositionend":return hr(t);case"keypress":return 32!==t.which?null:(lr=!0,ar);case"textInput":return(e=t.data)===ar&&lr?null:e;default:return null}}(e,n):function(e,t){if(dr)return"compositionend"===e||!rr&&ur(e,t)?(e=Gn(),qn=Hn=Vn=null,dr=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return sr&&"ko"!==t.locale?null:t.data}}(e,n))?((t=tr.getPooled(cr.beforeInput,t,n,r)).data=e,zn(t)):t=null,null===i?t:null===t?i:[i,t]}},pr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function gr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!pr[e.type]:"textarea"===t}var yr={change:{phasedRegistrationNames:{bubbled:"onChange",captured:"onChangeCapture"},dependencies:"blur change click focus input keydown keyup selectionchange".split(" ")}};function mr(e,t,n){return(e=Yn.getPooled(yr.change,e,t,n)).type="change",D(n),zn(e),e}var vr=null,br=null;function wr(e){ct(e)}function Er(e){if(Ee(Bn(e)))return e}function Ar(e,t){if("change"===e)return t}var Sr=!1;function _r(){vr&&(vr.detachEvent("onpropertychange",Ir),br=vr=null)}function Ir(e){if("value"===e.propertyName&&Er(br))if(e=mr(br,e,lt(e)),U)ct(e);else{U=!0;try{N(wr,e)}finally{U=!1,K()}}}function Cr(e,t,n){"focus"===e?(_r(),br=n,(vr=t).attachEvent("onpropertychange",Ir)):"blur"===e&&_r()}function Tr(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Er(br)}function kr(e,t){if("click"===e)return Er(t)}function Rr(e,t){if("input"===e||"change"===e)return Er(t)}T&&(Sr=ut("input")&&(!document.documentMode||9<document.documentMode));var xr={eventTypes:yr,_isInputEventSupported:Sr,extractEvents:function(e,t,n,r){var i=t?Bn(t):window,o=i.nodeName&&i.nodeName.toLowerCase();if("select"===o||"input"===o&&"file"===i.type)var s=Ar;else if(gr(i))if(Sr)s=Rr;else{s=Tr;var a=Cr}else(o=i.nodeName)&&"input"===o.toLowerCase()&&("checkbox"===i.type||"radio"===i.type)&&(s=kr);if(s&&(s=s(e,t)))return mr(s,n,r);a&&a(e,i,t),"blur"===e&&(e=i._wrapperState)&&e.controlled&&"number"===i.type&&Te(i,"number",i.value)}},Pr=Yn.extend({view:null,detail:null}),Dr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Or(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Dr[e])&&!!t[e]}function Nr(){return Or}var Br=0,Lr=0,Mr=!1,Ur=!1,Fr=Pr.extend({screenX:null,screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:Nr,button:null,buttons:null,relatedTarget:function(e){return e.relatedTarget||(e.fromElement===e.srcElement?e.toElement:e.fromElement)},movementX:function(e){if("movementX"in e)return e.movementX;var t=Br;return Br=e.screenX,Mr?"mousemove"===e.type?e.screenX-t:0:(Mr=!0,0)},movementY:function(e){if("movementY"in e)return e.movementY;var t=Lr;return Lr=e.screenY,Ur?"mousemove"===e.type?e.screenY-t:0:(Ur=!0,0)}}),Kr=Fr.extend({pointerId:null,width:null,height:null,pressure:null,tangentialPressure:null,tiltX:null,tiltY:null,twist:null,pointerType:null,isPrimary:null}),jr={mouseEnter:{registrationName:"onMouseEnter",dependencies:["mouseout","mouseover"]},mouseLeave:{registrationName:"onMouseLeave",dependencies:["mouseout","mouseover"]},pointerEnter:{registrationName:"onPointerEnter",dependencies:["pointerout","pointerover"]},pointerLeave:{registrationName:"onPointerLeave",dependencies:["pointerout","pointerover"]}},Zr={eventTypes:jr,extractEvents:function(e,t,n,r,i){var o="mouseover"===e||"pointerover"===e,s="mouseout"===e||"pointerout"===e;if(o&&0===(32&i)&&(n.relatedTarget||n.fromElement)||!s&&!o)return null;(o=r.window===r?r:(o=r.ownerDocument)?o.defaultView||o.parentWindow:window,s)?(s=t,null!==(t=(t=n.relatedTarget||n.toElement)?On(t):null)&&(t!==et(t)||5!==t.tag&&6!==t.tag)&&(t=null)):s=null;if(s===t)return null;if("mouseout"===e||"mouseover"===e)var a=Fr,c=jr.mouseLeave,l=jr.mouseEnter,u="mouse";else"pointerout"!==e&&"pointerover"!==e||(a=Kr,c=jr.pointerLeave,l=jr.pointerEnter,u="pointer");if(e=null==s?o:Bn(s),o=null==t?o:Bn(t),(c=a.getPooled(c,s,n,r)).type=u+"leave",c.target=e,c.relatedTarget=o,(n=a.getPooled(l,t,n,r)).type=u+"enter",n.target=o,n.relatedTarget=e,u=t,(r=s)&&u)e:{for(l=u,s=0,e=a=r;e;e=Mn(e))s++;for(e=0,t=l;t;t=Mn(t))e++;for(;0<s-e;)a=Mn(a),s--;for(;0<e-s;)l=Mn(l),e--;for(;s--;){if(a===l||a===l.alternate)break e;a=Mn(a),l=Mn(l)}a=null}else a=null;for(l=a,a=[];r&&r!==l&&(null===(s=r.alternate)||s!==l);)a.push(r),r=Mn(r);for(r=[];u&&u!==l&&(null===(s=u.alternate)||s!==l);)r.push(u),u=Mn(u);for(u=0;u<a.length;u++)jn(a[u],"bubbled",c);for(u=r.length;0<u--;)jn(r[u],"captured",n);return 0===(64&i)?[c]:[c,n]}};var zr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},Vr=Object.prototype.hasOwnProperty;function Hr(e,t){if(zr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++)if(!Vr.call(t,n[r])||!zr(e[n[r]],t[n[r]]))return!1;return!0}var qr=T&&"documentMode"in document&&11>=document.documentMode,Gr={select:{phasedRegistrationNames:{bubbled:"onSelect",captured:"onSelectCapture"},dependencies:"blur contextmenu dragend focus keydown keyup mousedown mouseup selectionchange".split(" ")}},Wr=null,Qr=null,Yr=null,Jr=!1;function Xr(e,t){var n=t.window===t?t.document:9===t.nodeType?t:t.ownerDocument;return Jr||null==Wr||Wr!==hn(n)?null:("selectionStart"in(n=Wr)&&yn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},Yr&&Hr(Yr,n)?null:(Yr=n,(e=Yn.getPooled(Gr.select,Qr,e,t)).type="select",e.target=Wr,zn(e),e))}var $r={eventTypes:Gr,extractEvents:function(e,t,n,r,i,o){if(!(o=!(i=o||(r.window===r?r.document:9===r.nodeType?r:r.ownerDocument)))){e:{i=$e(i),o=I.onSelect;for(var s=0;s<o.length;s++)if(!i.has(o[s])){i=!1;break e}i=!0}o=!i}if(o)return null;switch(i=t?Bn(t):window,e){case"focus":(gr(i)||"true"===i.contentEditable)&&(Wr=i,Qr=t,Yr=null);break;case"blur":Yr=Qr=Wr=null;break;case"mousedown":Jr=!0;break;case"contextmenu":case"mouseup":case"dragend":return Jr=!1,Xr(n,r);case"selectionchange":if(qr)break;case"keydown":case"keyup":return Xr(n,r)}return null}},ei=Yn.extend({animationName:null,elapsedTime:null,pseudoElement:null}),ti=Yn.extend({clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),ni=Pr.extend({relatedTarget:null});function ri(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}var ii={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},oi={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},si=Pr.extend({key:function(e){if(e.key){var t=ii[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=ri(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?oi[e.keyCode]||"Unidentified":""},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:Nr,charCode:function(e){return"keypress"===e.type?ri(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?ri(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),ai=Fr.extend({dataTransfer:null}),ci=Pr.extend({touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:Nr}),li=Yn.extend({propertyName:null,elapsedTime:null,pseudoElement:null}),ui=Fr.extend({deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:null,deltaMode:null}),hi={eventTypes:Ut,extractEvents:function(e,t,n,r){var i=Ft.get(e);if(!i)return null;switch(e){case"keypress":if(0===ri(n))return null;case"keydown":case"keyup":e=si;break;case"blur":case"focus":e=ni;break;case"click":if(2===n.button)return null;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":e=Fr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":e=ai;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":e=ci;break;case Ge:case We:case Qe:e=ei;break;case Ye:e=li;break;case"scroll":e=Pr;break;case"wheel":e=ui;break;case"copy":case"cut":case"paste":e=ti;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":e=Kr;break;default:e=Yn}return zn(t=e.getPooled(i,t,n,r)),t}};if(v)throw Error(s(101));v=Array.prototype.slice.call("ResponderEventPlugin SimpleEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin".split(" ")),w(),p=Ln,g=Nn,y=Bn,C({SimpleEventPlugin:hi,EnterLeaveEventPlugin:Zr,ChangeEventPlugin:xr,SelectEventPlugin:$r,BeforeInputEventPlugin:fr});var di=[],fi=-1;function pi(e){0>fi||(e.current=di[fi],di[fi]=null,fi--)}function gi(e,t){fi++,di[fi]=e.current,e.current=t}var yi={},mi={current:yi},vi={current:!1},bi=yi;function wi(e,t){var n=e.type.contextTypes;if(!n)return yi;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in n)o[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Ei(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ai(){pi(vi),pi(mi)}function Si(e,t,n){if(mi.current!==yi)throw Error(s(168));gi(mi,t),gi(vi,n)}function _i(e,t,n){var r=e.stateNode;if(e=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var o in r=r.getChildContext())if(!(o in e))throw Error(s(108,ye(t)||"Unknown",o));return i({},n,{},r)}function Ii(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||yi,bi=mi.current,gi(mi,e),gi(vi,vi.current),!0}function Ci(e,t,n){var r=e.stateNode;if(!r)throw Error(s(169));n?(e=_i(e,t,bi),r.__reactInternalMemoizedMergedChildContext=e,pi(vi),pi(mi),gi(mi,e)):pi(vi),gi(vi,n)}var Ti=o.unstable_runWithPriority,ki=o.unstable_scheduleCallback,Ri=o.unstable_cancelCallback,xi=o.unstable_requestPaint,Pi=o.unstable_now,Di=o.unstable_getCurrentPriorityLevel,Oi=o.unstable_ImmediatePriority,Ni=o.unstable_UserBlockingPriority,Bi=o.unstable_NormalPriority,Li=o.unstable_LowPriority,Mi=o.unstable_IdlePriority,Ui={},Fi=o.unstable_shouldYield,Ki=void 0!==xi?xi:function(){},ji=null,Zi=null,zi=!1,Vi=Pi(),Hi=1e4>Vi?Pi:function(){return Pi()-Vi};function qi(){switch(Di()){case Oi:return 99;case Ni:return 98;case Bi:return 97;case Li:return 96;case Mi:return 95;default:throw Error(s(332))}}function Gi(e){switch(e){case 99:return Oi;case 98:return Ni;case 97:return Bi;case 96:return Li;case 95:return Mi;default:throw Error(s(332))}}function Wi(e,t){return e=Gi(e),Ti(e,t)}function Qi(e,t,n){return e=Gi(e),ki(e,t,n)}function Yi(e){return null===ji?(ji=[e],Zi=ki(Oi,Xi)):ji.push(e),Ui}function Ji(){if(null!==Zi){var e=Zi;Zi=null,Ri(e)}Xi()}function Xi(){if(!zi&&null!==ji){zi=!0;var e=0;try{var t=ji;Wi(99,(function(){for(;e<t.length;e++){var n=t[e];do{n=n(!0)}while(null!==n)}})),ji=null}catch(n){throw null!==ji&&(ji=ji.slice(e+1)),ki(Oi,Ji),n}finally{zi=!1}}}function $i(e,t,n){return 1073741821-(1+((1073741821-e+t/10)/(n/=10)|0))*n}function eo(e,t){if(e&&e.defaultProps)for(var n in t=i({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}var to={current:null},no=null,ro=null,io=null;function oo(){io=ro=no=null}function so(e){var t=to.current;pi(to),e.type._context._currentValue=t}function ao(e,t){for(;null!==e;){var n=e.alternate;if(e.childExpirationTime<t)e.childExpirationTime=t,null!==n&&n.childExpirationTime<t&&(n.childExpirationTime=t);else{if(!(null!==n&&n.childExpirationTime<t))break;n.childExpirationTime=t}e=e.return}}function co(e,t){no=e,io=ro=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(e.expirationTime>=t&&(Ls=!0),e.firstContext=null)}function lo(e,t){if(io!==e&&!1!==t&&0!==t)if("number"===typeof t&&1073741823!==t||(io=e,t=1073741823),t={context:e,observedBits:t,next:null},null===ro){if(null===no)throw Error(s(308));ro=t,no.dependencies={expirationTime:0,firstContext:t,responders:null}}else ro=ro.next=t;return e._currentValue}var uo=!1;function ho(e){e.updateQueue={baseState:e.memoizedState,baseQueue:null,shared:{pending:null},effects:null}}function fo(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,baseQueue:e.baseQueue,shared:e.shared,effects:e.effects})}function po(e,t){return(e={expirationTime:e,suspenseConfig:t,tag:0,payload:null,callback:null,next:null}).next=e}function go(e,t){if(null!==(e=e.updateQueue)){var n=(e=e.shared).pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}}function yo(e,t){var n=e.alternate;null!==n&&fo(n,e),null===(n=(e=e.updateQueue).baseQueue)?(e.baseQueue=t.next=t,t.next=t):(t.next=n.next,n.next=t)}function mo(e,t,n,r){var o=e.updateQueue;uo=!1;var s=o.baseQueue,a=o.shared.pending;if(null!==a){if(null!==s){var c=s.next;s.next=a.next,a.next=c}s=a,o.shared.pending=null,null!==(c=e.alternate)&&(null!==(c=c.updateQueue)&&(c.baseQueue=a))}if(null!==s){c=s.next;var l=o.baseState,u=0,h=null,d=null,f=null;if(null!==c)for(var p=c;;){if((a=p.expirationTime)<r){var g={expirationTime:p.expirationTime,suspenseConfig:p.suspenseConfig,tag:p.tag,payload:p.payload,callback:p.callback,next:null};null===f?(d=f=g,h=l):f=f.next=g,a>u&&(u=a)}else{null!==f&&(f=f.next={expirationTime:1073741823,suspenseConfig:p.suspenseConfig,tag:p.tag,payload:p.payload,callback:p.callback,next:null}),Ac(a,p.suspenseConfig);e:{var y=e,m=p;switch(a=t,g=n,m.tag){case 1:if("function"===typeof(y=m.payload)){l=y.call(g,l,a);break e}l=y;break e;case 3:y.effectTag=-4097&y.effectTag|64;case 0:if(null===(a="function"===typeof(y=m.payload)?y.call(g,l,a):y)||void 0===a)break e;l=i({},l,a);break e;case 2:uo=!0}}null!==p.callback&&(e.effectTag|=32,null===(a=o.effects)?o.effects=[p]:a.push(p))}if(null===(p=p.next)||p===c){if(null===(a=o.shared.pending))break;p=s.next=a.next,a.next=c,o.baseQueue=s=a,o.shared.pending=null}}null===f?h=l:f.next=d,o.baseState=h,o.baseQueue=f,Sc(u),e.expirationTime=u,e.memoizedState=l}}function vo(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=i,i=n,"function"!==typeof r)throw Error(s(191,r));r.call(i)}}}var bo=Y.ReactCurrentBatchConfig,wo=(new r.Component).refs;function Eo(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:i({},t,n),e.memoizedState=n,0===e.expirationTime&&(e.updateQueue.baseState=n)}var Ao={isMounted:function(e){return!!(e=e._reactInternalFiber)&&et(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternalFiber;var r=lc(),i=bo.suspense;(i=po(r=uc(r,e,i),i)).payload=t,void 0!==n&&null!==n&&(i.callback=n),go(e,i),hc(e,r)},enqueueReplaceState:function(e,t,n){e=e._reactInternalFiber;var r=lc(),i=bo.suspense;(i=po(r=uc(r,e,i),i)).tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),go(e,i),hc(e,r)},enqueueForceUpdate:function(e,t){e=e._reactInternalFiber;var n=lc(),r=bo.suspense;(r=po(n=uc(n,e,r),r)).tag=2,void 0!==t&&null!==t&&(r.callback=t),go(e,r),hc(e,n)}};function So(e,t,n,r,i,o,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,s):!t.prototype||!t.prototype.isPureReactComponent||(!Hr(n,r)||!Hr(i,o))}function _o(e,t,n){var r=!1,i=yi,o=t.contextType;return"object"===typeof o&&null!==o?o=lo(o):(i=Ei(t)?bi:mi.current,o=(r=null!==(r=t.contextTypes)&&void 0!==r)?wi(e,i):yi),t=new t(n,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Ao,e.stateNode=t,t._reactInternalFiber=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function Io(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Ao.enqueueReplaceState(t,t.state,null)}function Co(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=wo,ho(e);var o=t.contextType;"object"===typeof o&&null!==o?i.context=lo(o):(o=Ei(t)?bi:mi.current,i.context=wi(e,o)),mo(e,n,i,r),i.state=e.memoizedState,"function"===typeof(o=t.getDerivedStateFromProps)&&(Eo(e,t,o,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&Ao.enqueueReplaceState(i,i.state,null),mo(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.effectTag|=4)}var To=Array.isArray;function ko(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var r=n.stateNode}if(!r)throw Error(s(147,e));var i=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===i?t.ref:(t=function(e){var t=r.refs;t===wo&&(t=r.refs={}),null===e?delete t[i]:t[i]=e},t._stringRef=i,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function Ro(e,t){if("textarea"!==e.type)throw Error(s(31,"[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t,""))}function xo(e){function t(t,n){if(e){var r=t.lastEffect;null!==r?(r.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n,n.nextEffect=null,n.effectTag=8}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=zc(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.effectTag=2,n):r:(t.effectTag=2,n):n}function a(t){return e&&null===t.alternate&&(t.effectTag=2),t}function c(e,t,n,r){return null===t||6!==t.tag?((t=qc(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function l(e,t,n,r){return null!==t&&t.elementType===n.type?((r=i(t,n.props)).ref=ko(e,t,n),r.return=e,r):((r=Vc(n.type,n.key,n.props,null,e.mode,r)).ref=ko(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Gc(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function h(e,t,n,r,o){return null===t||7!==t.tag?((t=Hc(n,e.mode,r,o)).return=e,t):((t=i(t,n)).return=e,t)}function d(e,t,n){if("string"===typeof t||"number"===typeof t)return(t=qc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case ee:return(n=Vc(t.type,t.key,t.props,null,e.mode,n)).ref=ko(e,null,t),n.return=e,n;case te:return(t=Gc(t,e.mode,n)).return=e,t}if(To(t)||ge(t))return(t=Hc(t,e.mode,n,null)).return=e,t;Ro(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n||"number"===typeof n)return null!==i?null:c(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case ee:return n.key===i?n.type===ne?h(e,t,n.props.children,r,i):l(e,t,n,r):null;case te:return n.key===i?u(e,t,n,r):null}if(To(n)||ge(n))return null!==i?null:h(e,t,n,r,null);Ro(e,n)}return null}function p(e,t,n,r,i){if("string"===typeof r||"number"===typeof r)return c(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case ee:return e=e.get(null===r.key?n:r.key)||null,r.type===ne?h(t,e,r.props.children,i,r.key):l(t,e,r,i);case te:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i)}if(To(r)||ge(r))return h(t,e=e.get(n)||null,r,i,null);Ro(t,r)}return null}function g(i,s,a,c){for(var l=null,u=null,h=s,g=s=0,y=null;null!==h&&g<a.length;g++){h.index>g?(y=h,h=null):y=h.sibling;var m=f(i,h,a[g],c);if(null===m){null===h&&(h=y);break}e&&h&&null===m.alternate&&t(i,h),s=o(m,s,g),null===u?l=m:u.sibling=m,u=m,h=y}if(g===a.length)return n(i,h),l;if(null===h){for(;g<a.length;g++)null!==(h=d(i,a[g],c))&&(s=o(h,s,g),null===u?l=h:u.sibling=h,u=h);return l}for(h=r(i,h);g<a.length;g++)null!==(y=p(h,i,g,a[g],c))&&(e&&null!==y.alternate&&h.delete(null===y.key?g:y.key),s=o(y,s,g),null===u?l=y:u.sibling=y,u=y);return e&&h.forEach((function(e){return t(i,e)})),l}function y(i,a,c,l){var u=ge(c);if("function"!==typeof u)throw Error(s(150));if(null==(c=u.call(c)))throw Error(s(151));for(var h=u=null,g=a,y=a=0,m=null,v=c.next();null!==g&&!v.done;y++,v=c.next()){g.index>y?(m=g,g=null):m=g.sibling;var b=f(i,g,v.value,l);if(null===b){null===g&&(g=m);break}e&&g&&null===b.alternate&&t(i,g),a=o(b,a,y),null===h?u=b:h.sibling=b,h=b,g=m}if(v.done)return n(i,g),u;if(null===g){for(;!v.done;y++,v=c.next())null!==(v=d(i,v.value,l))&&(a=o(v,a,y),null===h?u=v:h.sibling=v,h=v);return u}for(g=r(i,g);!v.done;y++,v=c.next())null!==(v=p(g,i,y,v.value,l))&&(e&&null!==v.alternate&&g.delete(null===v.key?y:v.key),a=o(v,a,y),null===h?u=v:h.sibling=v,h=v);return e&&g.forEach((function(e){return t(i,e)})),u}return function(e,r,o,c){var l="object"===typeof o&&null!==o&&o.type===ne&&null===o.key;l&&(o=o.props.children);var u="object"===typeof o&&null!==o;if(u)switch(o.$$typeof){case ee:e:{for(u=o.key,l=r;null!==l;){if(l.key===u){if(7===l.tag){if(o.type===ne){n(e,l.sibling),(r=i(l,o.props.children)).return=e,e=r;break e}}else if(l.elementType===o.type){n(e,l.sibling),(r=i(l,o.props)).ref=ko(e,l,o),r.return=e,e=r;break e}n(e,l);break}t(e,l),l=l.sibling}o.type===ne?((r=Hc(o.props.children,e.mode,c,o.key)).return=e,e=r):((c=Vc(o.type,o.key,o.props,null,e.mode,c)).ref=ko(e,r,o),c.return=e,e=c)}return a(e);case te:e:{for(l=o.key;null!==r;){if(r.key===l){if(4===r.tag&&r.stateNode.containerInfo===o.containerInfo&&r.stateNode.implementation===o.implementation){n(e,r.sibling),(r=i(r,o.children||[])).return=e,e=r;break e}n(e,r);break}t(e,r),r=r.sibling}(r=Gc(o,e.mode,c)).return=e,e=r}return a(e)}if("string"===typeof o||"number"===typeof o)return o=""+o,null!==r&&6===r.tag?(n(e,r.sibling),(r=i(r,o)).return=e,e=r):(n(e,r),(r=qc(o,e.mode,c)).return=e,e=r),a(e);if(To(o))return g(e,r,o,c);if(ge(o))return y(e,r,o,c);if(u&&Ro(e,o),"undefined"===typeof o&&!l)switch(e.tag){case 1:case 0:throw e=e.type,Error(s(152,e.displayName||e.name||"Component"))}return n(e,r)}}var Po=xo(!0),Do=xo(!1),Oo={},No={current:Oo},Bo={current:Oo},Lo={current:Oo};function Mo(e){if(e===Oo)throw Error(s(174));return e}function Uo(e,t){switch(gi(Lo,t),gi(Bo,e),gi(No,Oo),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Me(null,"");break;default:t=Me(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}pi(No),gi(No,t)}function Fo(){pi(No),pi(Bo),pi(Lo)}function Ko(e){Mo(Lo.current);var t=Mo(No.current),n=Me(t,e.type);t!==n&&(gi(Bo,e),gi(No,n))}function jo(e){Bo.current===e&&(pi(No),pi(Bo))}var Zo={current:0};function zo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||n.data===bn||n.data===wn))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(64&t.effectTag))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function Vo(e,t){return{responder:e,props:t}}var Ho=Y.ReactCurrentDispatcher,qo=Y.ReactCurrentBatchConfig,Go=0,Wo=null,Qo=null,Yo=null,Jo=!1;function Xo(){throw Error(s(321))}function $o(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!zr(e[n],t[n]))return!1;return!0}function es(e,t,n,r,i,o){if(Go=o,Wo=t,t.memoizedState=null,t.updateQueue=null,t.expirationTime=0,Ho.current=null===e||null===e.memoizedState?Ss:_s,e=n(r,i),t.expirationTime===Go){o=0;do{if(t.expirationTime=0,!(25>o))throw Error(s(301));o+=1,Yo=Qo=null,t.updateQueue=null,Ho.current=Is,e=n(r,i)}while(t.expirationTime===Go)}if(Ho.current=As,t=null!==Qo&&null!==Qo.next,Go=0,Yo=Qo=Wo=null,Jo=!1,t)throw Error(s(300));return e}function ts(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Yo?Wo.memoizedState=Yo=e:Yo=Yo.next=e,Yo}function ns(){if(null===Qo){var e=Wo.alternate;e=null!==e?e.memoizedState:null}else e=Qo.next;var t=null===Yo?Wo.memoizedState:Yo.next;if(null!==t)Yo=t,Qo=e;else{if(null===e)throw Error(s(310));e={memoizedState:(Qo=e).memoizedState,baseState:Qo.baseState,baseQueue:Qo.baseQueue,queue:Qo.queue,next:null},null===Yo?Wo.memoizedState=Yo=e:Yo=Yo.next=e}return Yo}function rs(e,t){return"function"===typeof t?t(e):t}function is(e){var t=ns(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=Qo,i=r.baseQueue,o=n.pending;if(null!==o){if(null!==i){var a=i.next;i.next=o.next,o.next=a}r.baseQueue=i=o,n.pending=null}if(null!==i){i=i.next,r=r.baseState;var c=a=o=null,l=i;do{var u=l.expirationTime;if(u<Go){var h={expirationTime:l.expirationTime,suspenseConfig:l.suspenseConfig,action:l.action,eagerReducer:l.eagerReducer,eagerState:l.eagerState,next:null};null===c?(a=c=h,o=r):c=c.next=h,u>Wo.expirationTime&&(Wo.expirationTime=u,Sc(u))}else null!==c&&(c=c.next={expirationTime:1073741823,suspenseConfig:l.suspenseConfig,action:l.action,eagerReducer:l.eagerReducer,eagerState:l.eagerState,next:null}),Ac(u,l.suspenseConfig),r=l.eagerReducer===e?l.eagerState:e(r,l.action);l=l.next}while(null!==l&&l!==i);null===c?o=r:c.next=a,zr(r,t.memoizedState)||(Ls=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}return[t.memoizedState,n.dispatch]}function os(e){var t=ns(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var a=i=i.next;do{o=e(o,a.action),a=a.next}while(a!==i);zr(o,t.memoizedState)||(Ls=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function ss(e){var t=ts();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e=(e=t.queue={pending:null,dispatch:null,lastRenderedReducer:rs,lastRenderedState:e}).dispatch=Es.bind(null,Wo,e),[t.memoizedState,e]}function as(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=Wo.updateQueue)?(t={lastEffect:null},Wo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function cs(){return ns().memoizedState}function ls(e,t,n,r){var i=ts();Wo.effectTag|=e,i.memoizedState=as(1|t,n,void 0,void 0===r?null:r)}function us(e,t,n,r){var i=ns();r=void 0===r?null:r;var o=void 0;if(null!==Qo){var s=Qo.memoizedState;if(o=s.destroy,null!==r&&$o(r,s.deps))return void as(t,n,o,r)}Wo.effectTag|=e,i.memoizedState=as(1|t,n,o,r)}function hs(e,t){return ls(516,4,e,t)}function ds(e,t){return us(516,4,e,t)}function fs(e,t){return us(4,2,e,t)}function ps(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function gs(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,us(4,2,ps.bind(null,t,e),n)}function ys(){}function ms(e,t){return ts().memoizedState=[e,void 0===t?null:t],e}function vs(e,t){var n=ns();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&$o(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function bs(e,t){var n=ns();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&$o(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function ws(e,t,n){var r=qi();Wi(98>r?98:r,(function(){e(!0)})),Wi(97<r?97:r,(function(){var r=qo.suspense;qo.suspense=void 0===t?null:t;try{e(!1),n()}finally{qo.suspense=r}}))}function Es(e,t,n){var r=lc(),i=bo.suspense;i={expirationTime:r=uc(r,e,i),suspenseConfig:i,action:n,eagerReducer:null,eagerState:null,next:null};var o=t.pending;if(null===o?i.next=i:(i.next=o.next,o.next=i),t.pending=i,o=e.alternate,e===Wo||null!==o&&o===Wo)Jo=!0,i.expirationTime=Go,Wo.expirationTime=Go;else{if(0===e.expirationTime&&(null===o||0===o.expirationTime)&&null!==(o=t.lastRenderedReducer))try{var s=t.lastRenderedState,a=o(s,n);if(i.eagerReducer=o,i.eagerState=a,zr(a,s))return}catch(c){}hc(e,r)}}var As={readContext:lo,useCallback:Xo,useContext:Xo,useEffect:Xo,useImperativeHandle:Xo,useLayoutEffect:Xo,useMemo:Xo,useReducer:Xo,useRef:Xo,useState:Xo,useDebugValue:Xo,useResponder:Xo,useDeferredValue:Xo,useTransition:Xo},Ss={readContext:lo,useCallback:ms,useContext:lo,useEffect:hs,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,ls(4,2,ps.bind(null,t,e),n)},useLayoutEffect:function(e,t){return ls(4,2,e,t)},useMemo:function(e,t){var n=ts();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=ts();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e=(e=r.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t}).dispatch=Es.bind(null,Wo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},ts().memoizedState=e},useState:ss,useDebugValue:ys,useResponder:Vo,useDeferredValue:function(e,t){var n=ss(e),r=n[0],i=n[1];return hs((function(){var n=qo.suspense;qo.suspense=void 0===t?null:t;try{i(e)}finally{qo.suspense=n}}),[e,t]),r},useTransition:function(e){var t=ss(!1),n=t[0];return t=t[1],[ms(ws.bind(null,t,e),[t,e]),n]}},_s={readContext:lo,useCallback:vs,useContext:lo,useEffect:ds,useImperativeHandle:gs,useLayoutEffect:fs,useMemo:bs,useReducer:is,useRef:cs,useState:function(){return is(rs)},useDebugValue:ys,useResponder:Vo,useDeferredValue:function(e,t){var n=is(rs),r=n[0],i=n[1];return ds((function(){var n=qo.suspense;qo.suspense=void 0===t?null:t;try{i(e)}finally{qo.suspense=n}}),[e,t]),r},useTransition:function(e){var t=is(rs),n=t[0];return t=t[1],[vs(ws.bind(null,t,e),[t,e]),n]}},Is={readContext:lo,useCallback:vs,useContext:lo,useEffect:ds,useImperativeHandle:gs,useLayoutEffect:fs,useMemo:bs,useReducer:os,useRef:cs,useState:function(){return os(rs)},useDebugValue:ys,useResponder:Vo,useDeferredValue:function(e,t){var n=os(rs),r=n[0],i=n[1];return ds((function(){var n=qo.suspense;qo.suspense=void 0===t?null:t;try{i(e)}finally{qo.suspense=n}}),[e,t]),r},useTransition:function(e){var t=os(rs),n=t[0];return t=t[1],[vs(ws.bind(null,t,e),[t,e]),n]}},Cs=null,Ts=null,ks=!1;function Rs(e,t){var n=jc(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=t,n.return=e,n.effectTag=8,null!==e.lastEffect?(e.lastEffect.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n}function xs(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,!0);default:return!1}}function Ps(e){if(ks){var t=Ts;if(t){var n=t;if(!xs(e,t)){if(!(t=Tn(n.nextSibling))||!xs(e,t))return e.effectTag=-1025&e.effectTag|2,ks=!1,void(Cs=e);Rs(Cs,n)}Cs=e,Ts=Tn(t.firstChild)}else e.effectTag=-1025&e.effectTag|2,ks=!1,Cs=e}}function Ds(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Cs=e}function Os(e){if(e!==Cs)return!1;if(!ks)return Ds(e),ks=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!_n(t,e.memoizedProps))for(t=Ts;t;)Rs(e,t),t=Tn(t.nextSibling);if(Ds(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if(n===vn){if(0===t){Ts=Tn(e.nextSibling);break e}t--}else n!==mn&&n!==wn&&n!==bn||t++}e=e.nextSibling}Ts=null}}else Ts=Cs?Tn(e.stateNode.nextSibling):null;return!0}function Ns(){Ts=Cs=null,ks=!1}var Bs=Y.ReactCurrentOwner,Ls=!1;function Ms(e,t,n,r){t.child=null===e?Do(t,null,n,r):Po(t,e.child,n,r)}function Us(e,t,n,r,i){n=n.render;var o=t.ref;return co(t,i),r=es(e,t,n,r,o,i),null===e||Ls?(t.effectTag|=1,Ms(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.effectTag&=-517,e.expirationTime<=i&&(e.expirationTime=0),ta(e,t,i))}function Fs(e,t,n,r,i,o){if(null===e){var s=n.type;return"function"!==typeof s||Zc(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Vc(n.type,null,r,null,t.mode,o)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Ks(e,t,s,r,i,o))}return s=e.child,i<o&&(i=s.memoizedProps,(n=null!==(n=n.compare)?n:Hr)(i,r)&&e.ref===t.ref)?ta(e,t,o):(t.effectTag|=1,(e=zc(s,r)).ref=t.ref,e.return=t,t.child=e)}function Ks(e,t,n,r,i,o){return null!==e&&Hr(e.memoizedProps,r)&&e.ref===t.ref&&(Ls=!1,i<o)?(t.expirationTime=e.expirationTime,ta(e,t,o)):Zs(e,t,n,r,o)}function js(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.effectTag|=128)}function Zs(e,t,n,r,i){var o=Ei(n)?bi:mi.current;return o=wi(t,o),co(t,i),n=es(e,t,n,r,o,i),null===e||Ls?(t.effectTag|=1,Ms(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.effectTag&=-517,e.expirationTime<=i&&(e.expirationTime=0),ta(e,t,i))}function zs(e,t,n,r,i){if(Ei(n)){var o=!0;Ii(t)}else o=!1;if(co(t,i),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),_o(t,n,r),Co(t,n,r,i),r=!0;else if(null===e){var s=t.stateNode,a=t.memoizedProps;s.props=a;var c=s.context,l=n.contextType;"object"===typeof l&&null!==l?l=lo(l):l=wi(t,l=Ei(n)?bi:mi.current);var u=n.getDerivedStateFromProps,h="function"===typeof u||"function"===typeof s.getSnapshotBeforeUpdate;h||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a!==r||c!==l)&&Io(t,s,r,l),uo=!1;var d=t.memoizedState;s.state=d,mo(t,r,s,i),c=t.memoizedState,a!==r||d!==c||vi.current||uo?("function"===typeof u&&(Eo(t,n,u,r),c=t.memoizedState),(a=uo||So(t,n,a,r,d,c,l))?(h||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.effectTag|=4)):("function"===typeof s.componentDidMount&&(t.effectTag|=4),t.memoizedProps=r,t.memoizedState=c),s.props=r,s.state=c,s.context=l,r=a):("function"===typeof s.componentDidMount&&(t.effectTag|=4),r=!1)}else s=t.stateNode,fo(e,t),a=t.memoizedProps,s.props=t.type===t.elementType?a:eo(t.type,a),c=s.context,"object"===typeof(l=n.contextType)&&null!==l?l=lo(l):l=wi(t,l=Ei(n)?bi:mi.current),(h="function"===typeof(u=n.getDerivedStateFromProps)||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a!==r||c!==l)&&Io(t,s,r,l),uo=!1,c=t.memoizedState,s.state=c,mo(t,r,s,i),d=t.memoizedState,a!==r||c!==d||vi.current||uo?("function"===typeof u&&(Eo(t,n,u,r),d=t.memoizedState),(u=uo||So(t,n,a,r,c,d,l))?(h||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(r,d,l),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,d,l)),"function"===typeof s.componentDidUpdate&&(t.effectTag|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.effectTag|=256)):("function"!==typeof s.componentDidUpdate||a===e.memoizedProps&&c===e.memoizedState||(t.effectTag|=4),"function"!==typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&c===e.memoizedState||(t.effectTag|=256),t.memoizedProps=r,t.memoizedState=d),s.props=r,s.state=d,s.context=l,r=u):("function"!==typeof s.componentDidUpdate||a===e.memoizedProps&&c===e.memoizedState||(t.effectTag|=4),"function"!==typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&c===e.memoizedState||(t.effectTag|=256),r=!1);return Vs(e,t,n,r,o,i)}function Vs(e,t,n,r,i,o){js(e,t);var s=0!==(64&t.effectTag);if(!r&&!s)return i&&Ci(t,n,!1),ta(e,t,o);r=t.stateNode,Bs.current=t;var a=s&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.effectTag|=1,null!==e&&s?(t.child=Po(t,e.child,null,o),t.child=Po(t,null,a,o)):Ms(e,t,a,o),t.memoizedState=r.state,i&&Ci(t,n,!0),t.child}function Hs(e){var t=e.stateNode;t.pendingContext?Si(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Si(0,t.context,!1),Uo(e,t.containerInfo)}var qs,Gs,Ws,Qs,Ys={dehydrated:null,retryTime:0};function Js(e,t,n){var r,i=t.mode,o=t.pendingProps,s=Zo.current,a=!1;if((r=0!==(64&t.effectTag))||(r=0!==(2&s)&&(null===e||null!==e.memoizedState)),r?(a=!0,t.effectTag&=-65):null!==e&&null===e.memoizedState||void 0===o.fallback||!0===o.unstable_avoidThisFallback||(s|=1),gi(Zo,1&s),null===e){if(void 0!==o.fallback&&Ps(t),a){if(a=o.fallback,(o=Hc(null,i,0,null)).return=t,0===(2&t.mode))for(e=null!==t.memoizedState?t.child.child:t.child,o.child=e;null!==e;)e.return=o,e=e.sibling;return(n=Hc(a,i,n,null)).return=t,o.sibling=n,t.memoizedState=Ys,t.child=o,n}return i=o.children,t.memoizedState=null,t.child=Do(t,null,i,n)}if(null!==e.memoizedState){if(i=(e=e.child).sibling,a){if(o=o.fallback,(n=zc(e,e.pendingProps)).return=t,0===(2&t.mode)&&(a=null!==t.memoizedState?t.child.child:t.child)!==e.child)for(n.child=a;null!==a;)a.return=n,a=a.sibling;return(i=zc(i,o)).return=t,n.sibling=i,n.childExpirationTime=0,t.memoizedState=Ys,t.child=n,i}return n=Po(t,e.child,o.children,n),t.memoizedState=null,t.child=n}if(e=e.child,a){if(a=o.fallback,(o=Hc(null,i,0,null)).return=t,o.child=e,null!==e&&(e.return=o),0===(2&t.mode))for(e=null!==t.memoizedState?t.child.child:t.child,o.child=e;null!==e;)e.return=o,e=e.sibling;return(n=Hc(a,i,n,null)).return=t,o.sibling=n,n.effectTag|=2,o.childExpirationTime=0,t.memoizedState=Ys,t.child=o,n}return t.memoizedState=null,t.child=Po(t,e,o.children,n)}function Xs(e,t){e.expirationTime<t&&(e.expirationTime=t);var n=e.alternate;null!==n&&n.expirationTime<t&&(n.expirationTime=t),ao(e.return,t)}function $s(e,t,n,r,i,o){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailExpiration:0,tailMode:i,lastEffect:o}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailExpiration=0,s.tailMode=i,s.lastEffect=o)}function ea(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;if(Ms(e,t,r.children,n),0!==(2&(r=Zo.current)))r=1&r|2,t.effectTag|=64;else{if(null!==e&&0!==(64&e.effectTag))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Xs(e,n);else if(19===e.tag)Xs(e,n);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(gi(Zo,r),0===(2&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===zo(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),$s(t,!1,i,n,o,t.lastEffect);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===zo(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}$s(t,!0,n,null,o,t.lastEffect);break;case"together":$s(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}return t.child}function ta(e,t,n){null!==e&&(t.dependencies=e.dependencies);var r=t.expirationTime;if(0!==r&&Sc(r),t.childExpirationTime<n)return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=zc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=zc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function na(e,t){switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function ra(e,t,n){var r=t.pendingProps;switch(t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:case 17:return Ei(t.type)&&Ai(),null;case 3:return Fo(),pi(vi),pi(mi),(n=t.stateNode).pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||!Os(t)||(t.effectTag|=4),Gs(t),null;case 5:jo(t),n=Mo(Lo.current);var o=t.type;if(null!==e&&null!=t.stateNode)Ws(e,t,o,r,n),e.ref!==t.ref&&(t.effectTag|=128);else{if(!r){if(null===t.stateNode)throw Error(s(166));return null}if(e=Mo(No.current),Os(t)){r=t.stateNode,o=t.type;var a=t.memoizedProps;switch(r[xn]=t,r[Pn]=a,o){case"iframe":case"object":case"embed":Wt("load",r);break;case"video":case"audio":for(e=0;e<Je.length;e++)Wt(Je[e],r);break;case"source":Wt("error",r);break;case"img":case"image":case"link":Wt("error",r),Wt("load",r);break;case"form":Wt("reset",r),Wt("submit",r);break;case"details":Wt("toggle",r);break;case"input":Se(r,a),Wt("invalid",r),ln(n,"onChange");break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Wt("invalid",r),ln(n,"onChange");break;case"textarea":Pe(r,a),Wt("invalid",r),ln(n,"onChange")}for(var c in sn(o,a),e=null,a)if(a.hasOwnProperty(c)){var l=a[c];"children"===c?"string"===typeof l?r.textContent!==l&&(e=["children",l]):"number"===typeof l&&r.textContent!==""+l&&(e=["children",""+l]):_.hasOwnProperty(c)&&null!=l&&ln(n,c)}switch(o){case"input":we(r),Ce(r,a,!0);break;case"textarea":we(r),Oe(r);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(r.onclick=un)}n=e,t.updateQueue=n,null!==n&&(t.effectTag|=4)}else{switch(c=9===n.nodeType?n:n.ownerDocument,e===cn&&(e=Le(o)),e===cn?"script"===o?((e=c.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=c.createElement(o,{is:r.is}):(e=c.createElement(o),"select"===o&&(c=e,r.multiple?c.multiple=!0:r.size&&(c.size=r.size))):e=c.createElementNS(e,o),e[xn]=t,e[Pn]=r,qs(e,t,!1,!1),t.stateNode=e,c=an(o,r),o){case"iframe":case"object":case"embed":Wt("load",e),l=r;break;case"video":case"audio":for(l=0;l<Je.length;l++)Wt(Je[l],e);l=r;break;case"source":Wt("error",e),l=r;break;case"img":case"image":case"link":Wt("error",e),Wt("load",e),l=r;break;case"form":Wt("reset",e),Wt("submit",e),l=r;break;case"details":Wt("toggle",e),l=r;break;case"input":Se(e,r),l=Ae(e,r),Wt("invalid",e),ln(n,"onChange");break;case"option":l=ke(e,r);break;case"select":e._wrapperState={wasMultiple:!!r.multiple},l=i({},r,{value:void 0}),Wt("invalid",e),ln(n,"onChange");break;case"textarea":Pe(e,r),l=xe(e,r),Wt("invalid",e),ln(n,"onChange");break;default:l=r}sn(o,l);var u=l;for(a in u)if(u.hasOwnProperty(a)){var h=u[a];"style"===a?rn(e,h):"dangerouslySetInnerHTML"===a?null!=(h=h?h.__html:void 0)&&Ke(e,h):"children"===a?"string"===typeof h?("textarea"!==o||""!==h)&&je(e,h):"number"===typeof h&&je(e,""+h):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(_.hasOwnProperty(a)?null!=h&&ln(n,a):null!=h&&J(e,a,h,c))}switch(o){case"input":we(e),Ce(e,r,!1);break;case"textarea":we(e),Oe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+ve(r.value));break;case"select":e.multiple=!!r.multiple,null!=(n=r.value)?Re(e,!!r.multiple,n,!1):null!=r.defaultValue&&Re(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof l.onClick&&(e.onclick=un)}Sn(o,r)&&(t.effectTag|=4)}null!==t.ref&&(t.effectTag|=128)}return null;case 6:if(e&&null!=t.stateNode)Qs(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(s(166));n=Mo(Lo.current),Mo(No.current),Os(t)?(n=t.stateNode,r=t.memoizedProps,n[xn]=t,n.nodeValue!==r&&(t.effectTag|=4)):((n=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[xn]=t,t.stateNode=n)}return null;case 13:return pi(Zo),r=t.memoizedState,0!==(64&t.effectTag)?(t.expirationTime=n,t):(n=null!==r,r=!1,null===e?void 0!==t.memoizedProps.fallback&&Os(t):(r=null!==(o=e.memoizedState),n||null===o||null!==(o=e.child.sibling)&&(null!==(a=t.firstEffect)?(t.firstEffect=o,o.nextEffect=a):(t.firstEffect=t.lastEffect=o,o.nextEffect=null),o.effectTag=8)),n&&!r&&0!==(2&t.mode)&&(null===e&&!0!==t.memoizedProps.unstable_avoidThisFallback||0!==(1&Zo.current)?za===Oa&&(za=La):(za!==Oa&&za!==La||(za=Ma),0!==Wa&&null!==Ka&&(Yc(Ka,Za),Jc(Ka,Wa)))),(n||r)&&(t.effectTag|=4),null);case 4:return Fo(),Gs(t),null;case 10:return so(t),null;case 19:if(pi(Zo),null===(r=t.memoizedState))return null;if(o=0!==(64&t.effectTag),null===(a=r.rendering)){if(o)na(r,!1);else if(za!==Oa||null!==e&&0!==(64&e.effectTag))for(a=t.child;null!==a;){if(null!==(e=zo(a))){for(t.effectTag|=64,na(r,!1),null!==(o=e.updateQueue)&&(t.updateQueue=o,t.effectTag|=4),null===r.lastEffect&&(t.firstEffect=null),t.lastEffect=r.lastEffect,r=t.child;null!==r;)a=n,(o=r).effectTag&=2,o.nextEffect=null,o.firstEffect=null,o.lastEffect=null,null===(e=o.alternate)?(o.childExpirationTime=0,o.expirationTime=a,o.child=null,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null):(o.childExpirationTime=e.childExpirationTime,o.expirationTime=e.expirationTime,o.child=e.child,o.memoizedProps=e.memoizedProps,o.memoizedState=e.memoizedState,o.updateQueue=e.updateQueue,a=e.dependencies,o.dependencies=null===a?null:{expirationTime:a.expirationTime,firstContext:a.firstContext,responders:a.responders}),r=r.sibling;return gi(Zo,1&Zo.current|2),t.child}a=a.sibling}}else{if(!o)if(null!==(e=zo(a))){if(t.effectTag|=64,o=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.effectTag|=4),na(r,!0),null===r.tail&&"hidden"===r.tailMode&&!a.alternate)return null!==(t=t.lastEffect=r.lastEffect)&&(t.nextEffect=null),null}else 2*Hi()-r.renderingStartTime>r.tailExpiration&&1<n&&(t.effectTag|=64,o=!0,na(r,!1),t.expirationTime=t.childExpirationTime=n-1);r.isBackwards?(a.sibling=t.child,t.child=a):(null!==(n=r.last)?n.sibling=a:t.child=a,r.last=a)}return null!==r.tail?(0===r.tailExpiration&&(r.tailExpiration=Hi()+500),n=r.tail,r.rendering=n,r.tail=n.sibling,r.lastEffect=t.lastEffect,r.renderingStartTime=Hi(),n.sibling=null,t=Zo.current,gi(Zo,o?1&t|2:1&t),n):null}throw Error(s(156,t.tag))}function ia(e){switch(e.tag){case 1:Ei(e.type)&&Ai();var t=e.effectTag;return 4096&t?(e.effectTag=-4097&t|64,e):null;case 3:if(Fo(),pi(vi),pi(mi),0!==(64&(t=e.effectTag)))throw Error(s(285));return e.effectTag=-4097&t|64,e;case 5:return jo(e),null;case 13:return pi(Zo),4096&(t=e.effectTag)?(e.effectTag=-4097&t|64,e):null;case 19:return pi(Zo),null;case 4:return Fo(),null;case 10:return so(e),null;default:return null}}function oa(e,t){return{value:e,source:t,stack:me(t)}}qs=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Gs=function(){},Ws=function(e,t,n,r,o){var s=e.memoizedProps;if(s!==r){var a,c,l=t.stateNode;switch(Mo(No.current),e=null,n){case"input":s=Ae(l,s),r=Ae(l,r),e=[];break;case"option":s=ke(l,s),r=ke(l,r),e=[];break;case"select":s=i({},s,{value:void 0}),r=i({},r,{value:void 0}),e=[];break;case"textarea":s=xe(l,s),r=xe(l,r),e=[];break;default:"function"!==typeof s.onClick&&"function"===typeof r.onClick&&(l.onclick=un)}for(a in sn(n,r),n=null,s)if(!r.hasOwnProperty(a)&&s.hasOwnProperty(a)&&null!=s[a])if("style"===a)for(c in l=s[a])l.hasOwnProperty(c)&&(n||(n={}),n[c]="");else"dangerouslySetInnerHTML"!==a&&"children"!==a&&"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(_.hasOwnProperty(a)?e||(e=[]):(e=e||[]).push(a,null));for(a in r){var u=r[a];if(l=null!=s?s[a]:void 0,r.hasOwnProperty(a)&&u!==l&&(null!=u||null!=l))if("style"===a)if(l){for(c in l)!l.hasOwnProperty(c)||u&&u.hasOwnProperty(c)||(n||(n={}),n[c]="");for(c in u)u.hasOwnProperty(c)&&l[c]!==u[c]&&(n||(n={}),n[c]=u[c])}else n||(e||(e=[]),e.push(a,n)),n=u;else"dangerouslySetInnerHTML"===a?(u=u?u.__html:void 0,l=l?l.__html:void 0,null!=u&&l!==u&&(e=e||[]).push(a,u)):"children"===a?l===u||"string"!==typeof u&&"number"!==typeof u||(e=e||[]).push(a,""+u):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&(_.hasOwnProperty(a)?(null!=u&&ln(o,a),e||l===u||(e=[])):(e=e||[]).push(a,u))}n&&(e=e||[]).push("style",n),o=e,(t.updateQueue=o)&&(t.effectTag|=4)}},Qs=function(e,t,n,r){n!==r&&(t.effectTag|=4)};var sa="function"===typeof WeakSet?WeakSet:Set;function aa(e,t){var n=t.source,r=t.stack;null===r&&null!==n&&(r=me(n)),null!==n&&ye(n.type),t=t.value,null!==e&&1===e.tag&&ye(e.type);try{console.error(t)}catch(i){setTimeout((function(){throw i}))}}function ca(e){var t=e.ref;if(null!==t)if("function"===typeof t)try{t(null)}catch(n){Bc(e,n)}else t.current=null}function la(e,t){switch(t.tag){case 0:case 11:case 15:case 22:case 3:case 5:case 6:case 4:case 17:return;case 1:if(256&t.effectTag&&null!==e){var n=e.memoizedProps,r=e.memoizedState;t=(e=t.stateNode).getSnapshotBeforeUpdate(t.elementType===t.type?n:eo(t.type,n),r),e.__reactInternalSnapshotBeforeUpdate=t}return}throw Error(s(163))}function ua(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.destroy;n.destroy=void 0,void 0!==r&&r()}n=n.next}while(n!==t)}}function ha(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function da(e,t,n){switch(n.tag){case 0:case 11:case 15:case 22:return void ha(3,n);case 1:if(e=n.stateNode,4&n.effectTag)if(null===t)e.componentDidMount();else{var r=n.elementType===n.type?t.memoizedProps:eo(n.type,t.memoizedProps);e.componentDidUpdate(r,t.memoizedState,e.__reactInternalSnapshotBeforeUpdate)}return void(null!==(t=n.updateQueue)&&vo(n,t,e));case 3:if(null!==(t=n.updateQueue)){if(e=null,null!==n.child)switch(n.child.tag){case 5:case 1:e=n.child.stateNode}vo(n,t,e)}return;case 5:return e=n.stateNode,void(null===t&&4&n.effectTag&&Sn(n.type,n.memoizedProps)&&e.focus());case 6:case 4:case 12:case 19:case 17:case 20:case 21:return;case 13:return void(null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&Mt(n)))))}throw Error(s(163))}function fa(e,t,n){switch("function"===typeof Fc&&Fc(t),t.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var r=e.next;Wi(97<n?97:n,(function(){var e=r;do{var n=e.destroy;if(void 0!==n){var i=t;try{n()}catch(o){Bc(i,o)}}e=e.next}while(e!==r)}))}break;case 1:ca(t),"function"===typeof(n=t.stateNode).componentWillUnmount&&function(e,t){try{t.props=e.memoizedProps,t.state=e.memoizedState,t.componentWillUnmount()}catch(n){Bc(e,n)}}(t,n);break;case 5:ca(t);break;case 4:ba(e,t,n)}}function pa(e){var t=e.alternate;e.return=null,e.child=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.alternate=null,e.firstEffect=null,e.lastEffect=null,e.pendingProps=null,e.memoizedProps=null,e.stateNode=null,null!==t&&pa(t)}function ga(e){return 5===e.tag||3===e.tag||4===e.tag}function ya(e){e:{for(var t=e.return;null!==t;){if(ga(t)){var n=t;break e}t=t.return}throw Error(s(160))}switch(t=n.stateNode,n.tag){case 5:var r=!1;break;case 3:case 4:t=t.containerInfo,r=!0;break;default:throw Error(s(161))}16&n.effectTag&&(je(t,""),n.effectTag&=-17);e:t:for(n=e;;){for(;null===n.sibling;){if(null===n.return||ga(n.return)){n=null;break e}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.effectTag)continue t;if(null===n.child||4===n.tag)continue t;n.child.return=n,n=n.child}if(!(2&n.effectTag)){n=n.stateNode;break e}}r?ma(e,n,t):va(e,n,t)}function ma(e,t,n){var r=e.tag,i=5===r||6===r;if(i)e=i?e.stateNode:e.stateNode.instance,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=un));else if(4!==r&&null!==(e=e.child))for(ma(e,t,n),e=e.sibling;null!==e;)ma(e,t,n),e=e.sibling}function va(e,t,n){var r=e.tag,i=5===r||6===r;if(i)e=i?e.stateNode:e.stateNode.instance,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(va(e,t,n),e=e.sibling;null!==e;)va(e,t,n),e=e.sibling}function ba(e,t,n){for(var r,i,o=t,a=!1;;){if(!a){a=o.return;e:for(;;){if(null===a)throw Error(s(160));switch(r=a.stateNode,a.tag){case 5:i=!1;break e;case 3:case 4:r=r.containerInfo,i=!0;break e}a=a.return}a=!0}if(5===o.tag||6===o.tag){e:for(var c=e,l=o,u=n,h=l;;)if(fa(c,h,u),null!==h.child&&4!==h.tag)h.child.return=h,h=h.child;else{if(h===l)break e;for(;null===h.sibling;){if(null===h.return||h.return===l)break e;h=h.return}h.sibling.return=h.return,h=h.sibling}i?(c=r,l=o.stateNode,8===c.nodeType?c.parentNode.removeChild(l):c.removeChild(l)):r.removeChild(o.stateNode)}else if(4===o.tag){if(null!==o.child){r=o.stateNode.containerInfo,i=!0,o.child.return=o,o=o.child;continue}}else if(fa(e,o,n),null!==o.child){o.child.return=o,o=o.child;continue}if(o===t)break;for(;null===o.sibling;){if(null===o.return||o.return===t)return;4===(o=o.return).tag&&(a=!1)}o.sibling.return=o.return,o=o.sibling}}function wa(e,t){switch(t.tag){case 0:case 11:case 14:case 15:case 22:return void ua(3,t);case 1:case 12:case 17:return;case 5:var n=t.stateNode;if(null!=n){var r=t.memoizedProps,i=null!==e?e.memoizedProps:r;e=t.type;var o=t.updateQueue;if(t.updateQueue=null,null!==o){for(n[Pn]=r,"input"===e&&"radio"===r.type&&null!=r.name&&_e(n,r),an(e,i),t=an(e,r),i=0;i<o.length;i+=2){var a=o[i],c=o[i+1];"style"===a?rn(n,c):"dangerouslySetInnerHTML"===a?Ke(n,c):"children"===a?je(n,c):J(n,a,c,t)}switch(e){case"input":Ie(n,r);break;case"textarea":De(n,r);break;case"select":t=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!r.multiple,null!=(e=r.value)?Re(n,!!r.multiple,e,!1):t!==!!r.multiple&&(null!=r.defaultValue?Re(n,!!r.multiple,r.defaultValue,!0):Re(n,!!r.multiple,r.multiple?[]:"",!1))}}}return;case 6:if(null===t.stateNode)throw Error(s(162));return void(t.stateNode.nodeValue=t.memoizedProps);case 3:return void((t=t.stateNode).hydrate&&(t.hydrate=!1,Mt(t.containerInfo)));case 13:if(n=t,null===t.memoizedState?r=!1:(r=!0,n=t.child,Ya=Hi()),null!==n)e:for(e=n;;){if(5===e.tag)o=e.stateNode,r?"function"===typeof(o=o.style).setProperty?o.setProperty("display","none","important"):o.display="none":(o=e.stateNode,i=void 0!==(i=e.memoizedProps.style)&&null!==i&&i.hasOwnProperty("display")?i.display:null,o.style.display=nn("display",i));else if(6===e.tag)e.stateNode.nodeValue=r?"":e.memoizedProps;else{if(13===e.tag&&null!==e.memoizedState&&null===e.memoizedState.dehydrated){(o=e.child.sibling).return=e,e=o;continue}if(null!==e.child){e.child.return=e,e=e.child;continue}}if(e===n)break;for(;null===e.sibling;){if(null===e.return||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}return void Ea(t);case 19:return void Ea(t)}throw Error(s(163))}function Ea(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new sa),t.forEach((function(t){var r=Mc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}var Aa="function"===typeof WeakMap?WeakMap:Map;function Sa(e,t,n){(n=po(n,null)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){$a||($a=!0,ec=r),aa(e,t)},n}function _a(e,t,n){(n=po(n,null)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return aa(e,t),r(i)}}var o=e.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(n.callback=function(){"function"!==typeof r&&(null===tc?tc=new Set([this]):tc.add(this),aa(e,t));var n=t.stack;this.componentDidCatch(t.value,{componentStack:null!==n?n:""})}),n}var Ia,Ca=Math.ceil,Ta=Y.ReactCurrentDispatcher,ka=Y.ReactCurrentOwner,Ra=0,xa=8,Pa=16,Da=32,Oa=0,Na=1,Ba=2,La=3,Ma=4,Ua=5,Fa=Ra,Ka=null,ja=null,Za=0,za=Oa,Va=null,Ha=1073741823,qa=1073741823,Ga=null,Wa=0,Qa=!1,Ya=0,Ja=500,Xa=null,$a=!1,ec=null,tc=null,nc=!1,rc=null,ic=90,oc=null,sc=0,ac=null,cc=0;function lc(){return(Fa&(Pa|Da))!==Ra?1073741821-(Hi()/10|0):0!==cc?cc:cc=1073741821-(Hi()/10|0)}function uc(e,t,n){if(0===(2&(t=t.mode)))return 1073741823;var r=qi();if(0===(4&t))return 99===r?1073741823:1073741822;if((Fa&Pa)!==Ra)return Za;if(null!==n)e=$i(e,0|n.timeoutMs||5e3,250);else switch(r){case 99:e=1073741823;break;case 98:e=$i(e,150,100);break;case 97:case 96:e=$i(e,5e3,250);break;case 95:e=2;break;default:throw Error(s(326))}return null!==Ka&&e===Za&&--e,e}function hc(e,t){if(50<sc)throw sc=0,ac=null,Error(s(185));if(null!==(e=dc(e,t))){var n=qi();1073741823===t?(Fa&xa)!==Ra&&(Fa&(Pa|Da))===Ra?yc(e):(pc(e),Fa===Ra&&Ji()):pc(e),(4&Fa)===Ra||98!==n&&99!==n||(null===oc?oc=new Map([[e,t]]):(void 0===(n=oc.get(e))||n>t)&&oc.set(e,t))}}function dc(e,t){e.expirationTime<t&&(e.expirationTime=t);var n=e.alternate;null!==n&&n.expirationTime<t&&(n.expirationTime=t);var r=e.return,i=null;if(null===r&&3===e.tag)i=e.stateNode;else for(;null!==r;){if(n=r.alternate,r.childExpirationTime<t&&(r.childExpirationTime=t),null!==n&&n.childExpirationTime<t&&(n.childExpirationTime=t),null===r.return&&3===r.tag){i=r.stateNode;break}r=r.return}return null!==i&&(Ka===i&&(Sc(t),za===Ma&&Yc(i,Za)),Jc(i,t)),i}function fc(e){var t=e.lastExpiredTime;if(0!==t)return t;if(!Qc(e,t=e.firstPendingTime))return t;var n=e.lastPingedTime;return 2>=(e=n>(e=e.nextKnownPendingLevel)?n:e)&&t!==e?0:e}function pc(e){if(0!==e.lastExpiredTime)e.callbackExpirationTime=1073741823,e.callbackPriority=99,e.callbackNode=Yi(yc.bind(null,e));else{var t=fc(e),n=e.callbackNode;if(0===t)null!==n&&(e.callbackNode=null,e.callbackExpirationTime=0,e.callbackPriority=90);else{var r=lc();if(1073741823===t?r=99:1===t||2===t?r=95:r=0>=(r=10*(1073741821-t)-10*(1073741821-r))?99:250>=r?98:5250>=r?97:95,null!==n){var i=e.callbackPriority;if(e.callbackExpirationTime===t&&i>=r)return;n!==Ui&&Ri(n)}e.callbackExpirationTime=t,e.callbackPriority=r,t=1073741823===t?Yi(yc.bind(null,e)):Qi(r,gc.bind(null,e),{timeout:10*(1073741821-t)-Hi()}),e.callbackNode=t}}}function gc(e,t){if(cc=0,t)return Xc(e,t=lc()),pc(e),null;var n=fc(e);if(0!==n){if(t=e.callbackNode,(Fa&(Pa|Da))!==Ra)throw Error(s(327));if(Dc(),e===Ka&&n===Za||bc(e,n),null!==ja){var r=Fa;Fa|=Pa;for(var i=Ec();;)try{Ic();break}catch(c){wc(e,c)}if(oo(),Fa=r,Ta.current=i,za===Na)throw t=Va,bc(e,n),Yc(e,n),pc(e),t;if(null===ja)switch(i=e.finishedWork=e.current.alternate,e.finishedExpirationTime=n,r=za,Ka=null,r){case Oa:case Na:throw Error(s(345));case Ba:Xc(e,2<n?2:n);break;case La:if(Yc(e,n),n===(r=e.lastSuspendedTime)&&(e.nextKnownPendingLevel=kc(i)),1073741823===Ha&&10<(i=Ya+Ja-Hi())){if(Qa){var o=e.lastPingedTime;if(0===o||o>=n){e.lastPingedTime=n,bc(e,n);break}}if(0!==(o=fc(e))&&o!==n)break;if(0!==r&&r!==n){e.lastPingedTime=r;break}e.timeoutHandle=In(Rc.bind(null,e),i);break}Rc(e);break;case Ma:if(Yc(e,n),n===(r=e.lastSuspendedTime)&&(e.nextKnownPendingLevel=kc(i)),Qa&&(0===(i=e.lastPingedTime)||i>=n)){e.lastPingedTime=n,bc(e,n);break}if(0!==(i=fc(e))&&i!==n)break;if(0!==r&&r!==n){e.lastPingedTime=r;break}if(1073741823!==qa?r=10*(1073741821-qa)-Hi():1073741823===Ha?r=0:(r=10*(1073741821-Ha)-5e3,0>(r=(i=Hi())-r)&&(r=0),(n=10*(1073741821-n)-i)<(r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Ca(r/1960))-r)&&(r=n)),10<r){e.timeoutHandle=In(Rc.bind(null,e),r);break}Rc(e);break;case Ua:if(1073741823!==Ha&&null!==Ga){o=Ha;var a=Ga;if(0>=(r=0|a.busyMinDurationMs)?r=0:(i=0|a.busyDelayMs,r=(o=Hi()-(10*(1073741821-o)-(0|a.timeoutMs||5e3)))<=i?0:i+r-o),10<r){Yc(e,n),e.timeoutHandle=In(Rc.bind(null,e),r);break}}Rc(e);break;default:throw Error(s(329))}if(pc(e),e.callbackNode===t)return gc.bind(null,e)}}return null}function yc(e){var t=e.lastExpiredTime;if(t=0!==t?t:1073741823,(Fa&(Pa|Da))!==Ra)throw Error(s(327));if(Dc(),e===Ka&&t===Za||bc(e,t),null!==ja){var n=Fa;Fa|=Pa;for(var r=Ec();;)try{_c();break}catch(i){wc(e,i)}if(oo(),Fa=n,Ta.current=r,za===Na)throw n=Va,bc(e,t),Yc(e,t),pc(e),n;if(null!==ja)throw Error(s(261));e.finishedWork=e.current.alternate,e.finishedExpirationTime=t,Ka=null,Rc(e),pc(e)}return null}function mc(e,t){var n=Fa;Fa|=1;try{return e(t)}finally{(Fa=n)===Ra&&Ji()}}function vc(e,t){var n=Fa;Fa&=-2,Fa|=xa;try{return e(t)}finally{(Fa=n)===Ra&&Ji()}}function bc(e,t){e.finishedWork=null,e.finishedExpirationTime=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,Cn(n)),null!==ja)for(n=ja.return;null!==n;){var r=n;switch(r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Ai();break;case 3:Fo(),pi(vi),pi(mi);break;case 5:jo(r);break;case 4:Fo();break;case 13:case 19:pi(Zo);break;case 10:so(r)}n=n.return}Ka=e,ja=zc(e.current,null),Za=t,za=Oa,Va=null,qa=Ha=1073741823,Ga=null,Wa=0,Qa=!1}function wc(e,t){for(;;){try{if(oo(),Ho.current=As,Jo)for(var n=Wo.memoizedState;null!==n;){var r=n.queue;null!==r&&(r.pending=null),n=n.next}if(Go=0,Yo=Qo=Wo=null,Jo=!1,null===ja||null===ja.return)return za=Na,Va=t,ja=null;e:{var i=e,o=ja.return,s=ja,a=t;if(t=Za,s.effectTag|=2048,s.firstEffect=s.lastEffect=null,null!==a&&"object"===typeof a&&"function"===typeof a.then){var c=a;if(0===(2&s.mode)){var l=s.alternate;l?(s.updateQueue=l.updateQueue,s.memoizedState=l.memoizedState,s.expirationTime=l.expirationTime):(s.updateQueue=null,s.memoizedState=null)}var u=0!==(1&Zo.current),h=o;do{var d;if(d=13===h.tag){var f=h.memoizedState;if(null!==f)d=null!==f.dehydrated;else{var p=h.memoizedProps;d=void 0!==p.fallback&&(!0!==p.unstable_avoidThisFallback||!u)}}if(d){var g=h.updateQueue;if(null===g){var y=new Set;y.add(c),h.updateQueue=y}else g.add(c);if(0===(2&h.mode)){if(h.effectTag|=64,s.effectTag&=-2981,1===s.tag)if(null===s.alternate)s.tag=17;else{var m=po(1073741823,null);m.tag=2,go(s,m)}s.expirationTime=1073741823;break e}a=void 0,s=t;var v=i.pingCache;if(null===v?(v=i.pingCache=new Aa,a=new Set,v.set(c,a)):void 0===(a=v.get(c))&&(a=new Set,v.set(c,a)),!a.has(s)){a.add(s);var b=Lc.bind(null,i,c,s);c.then(b,b)}h.effectTag|=4096,h.expirationTime=t;break e}h=h.return}while(null!==h);a=Error((ye(s.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display."+me(s))}za!==Ua&&(za=Ba),a=oa(a,s),h=o;do{switch(h.tag){case 3:c=a,h.effectTag|=4096,h.expirationTime=t,yo(h,Sa(h,c,t));break e;case 1:c=a;var w=h.type,E=h.stateNode;if(0===(64&h.effectTag)&&("function"===typeof w.getDerivedStateFromError||null!==E&&"function"===typeof E.componentDidCatch&&(null===tc||!tc.has(E)))){h.effectTag|=4096,h.expirationTime=t,yo(h,_a(h,c,t));break e}}h=h.return}while(null!==h)}ja=Tc(ja)}catch(A){t=A;continue}break}}function Ec(){var e=Ta.current;return Ta.current=As,null===e?As:e}function Ac(e,t){e<Ha&&2<e&&(Ha=e),null!==t&&e<qa&&2<e&&(qa=e,Ga=t)}function Sc(e){e>Wa&&(Wa=e)}function _c(){for(;null!==ja;)ja=Cc(ja)}function Ic(){for(;null!==ja&&!Fi();)ja=Cc(ja)}function Cc(e){var t=Ia(e.alternate,e,Za);return e.memoizedProps=e.pendingProps,null===t&&(t=Tc(e)),ka.current=null,t}function Tc(e){ja=e;do{var t=ja.alternate;if(e=ja.return,0===(2048&ja.effectTag)){if(t=ra(t,ja,Za),1===Za||1!==ja.childExpirationTime){for(var n=0,r=ja.child;null!==r;){var i=r.expirationTime,o=r.childExpirationTime;i>n&&(n=i),o>n&&(n=o),r=r.sibling}ja.childExpirationTime=n}if(null!==t)return t;null!==e&&0===(2048&e.effectTag)&&(null===e.firstEffect&&(e.firstEffect=ja.firstEffect),null!==ja.lastEffect&&(null!==e.lastEffect&&(e.lastEffect.nextEffect=ja.firstEffect),e.lastEffect=ja.lastEffect),1<ja.effectTag&&(null!==e.lastEffect?e.lastEffect.nextEffect=ja:e.firstEffect=ja,e.lastEffect=ja))}else{if(null!==(t=ia(ja)))return t.effectTag&=2047,t;null!==e&&(e.firstEffect=e.lastEffect=null,e.effectTag|=2048)}if(null!==(t=ja.sibling))return t;ja=e}while(null!==ja);return za===Oa&&(za=Ua),null}function kc(e){var t=e.expirationTime;return t>(e=e.childExpirationTime)?t:e}function Rc(e){var t=qi();return Wi(99,xc.bind(null,e,t)),null}function xc(e,t){do{Dc()}while(null!==rc);if((Fa&(Pa|Da))!==Ra)throw Error(s(327));var n=e.finishedWork,r=e.finishedExpirationTime;if(null===n)return null;if(e.finishedWork=null,e.finishedExpirationTime=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackExpirationTime=0,e.callbackPriority=90,e.nextKnownPendingLevel=0;var i=kc(n);if(e.firstPendingTime=i,r<=e.lastSuspendedTime?e.firstSuspendedTime=e.lastSuspendedTime=e.nextKnownPendingLevel=0:r<=e.firstSuspendedTime&&(e.firstSuspendedTime=r-1),r<=e.lastPingedTime&&(e.lastPingedTime=0),r<=e.lastExpiredTime&&(e.lastExpiredTime=0),e===Ka&&(ja=Ka=null,Za=0),1<n.effectTag?null!==n.lastEffect?(n.lastEffect.nextEffect=n,i=n.firstEffect):i=n:i=n.firstEffect,null!==i){var o=Fa;Fa|=Da,ka.current=null,En=Gt;var a=gn();if(yn(a)){if("selectionStart"in a)var c={start:a.selectionStart,end:a.selectionEnd};else e:{var l=(c=(c=a.ownerDocument)&&c.defaultView||window).getSelection&&c.getSelection();if(l&&0!==l.rangeCount){c=l.anchorNode;var u=l.anchorOffset,h=l.focusNode;l=l.focusOffset;try{c.nodeType,h.nodeType}catch(C){c=null;break e}var d=0,f=-1,p=-1,g=0,y=0,m=a,v=null;t:for(;;){for(var b;m!==c||0!==u&&3!==m.nodeType||(f=d+u),m!==h||0!==l&&3!==m.nodeType||(p=d+l),3===m.nodeType&&(d+=m.nodeValue.length),null!==(b=m.firstChild);)v=m,m=b;for(;;){if(m===a)break t;if(v===c&&++g===u&&(f=d),v===h&&++y===l&&(p=d),null!==(b=m.nextSibling))break;v=(m=v).parentNode}m=b}c=-1===f||-1===p?null:{start:f,end:p}}else c=null}c=c||{start:0,end:0}}else c=null;An={activeElementDetached:null,focusedElem:a,selectionRange:c},Gt=!1,Xa=i;do{try{Pc()}catch(C){if(null===Xa)throw Error(s(330));Bc(Xa,C),Xa=Xa.nextEffect}}while(null!==Xa);Xa=i;do{try{for(a=e,c=t;null!==Xa;){var w=Xa.effectTag;if(16&w&&je(Xa.stateNode,""),128&w){var E=Xa.alternate;if(null!==E){var A=E.ref;null!==A&&("function"===typeof A?A(null):A.current=null)}}switch(1038&w){case 2:ya(Xa),Xa.effectTag&=-3;break;case 6:ya(Xa),Xa.effectTag&=-3,wa(Xa.alternate,Xa);break;case 1024:Xa.effectTag&=-1025;break;case 1028:Xa.effectTag&=-1025,wa(Xa.alternate,Xa);break;case 4:wa(Xa.alternate,Xa);break;case 8:ba(a,u=Xa,c),pa(u)}Xa=Xa.nextEffect}}catch(C){if(null===Xa)throw Error(s(330));Bc(Xa,C),Xa=Xa.nextEffect}}while(null!==Xa);if(A=An,E=gn(),w=A.focusedElem,c=A.selectionRange,E!==w&&w&&w.ownerDocument&&pn(w.ownerDocument.documentElement,w)){null!==c&&yn(w)&&(E=c.start,void 0===(A=c.end)&&(A=E),"selectionStart"in w?(w.selectionStart=E,w.selectionEnd=Math.min(A,w.value.length)):(A=(E=w.ownerDocument||document)&&E.defaultView||window).getSelection&&(A=A.getSelection(),u=w.textContent.length,a=Math.min(c.start,u),c=void 0===c.end?a:Math.min(c.end,u),!A.extend&&a>c&&(u=c,c=a,a=u),u=fn(w,a),h=fn(w,c),u&&h&&(1!==A.rangeCount||A.anchorNode!==u.node||A.anchorOffset!==u.offset||A.focusNode!==h.node||A.focusOffset!==h.offset)&&((E=E.createRange()).setStart(u.node,u.offset),A.removeAllRanges(),a>c?(A.addRange(E),A.extend(h.node,h.offset)):(E.setEnd(h.node,h.offset),A.addRange(E))))),E=[];for(A=w;A=A.parentNode;)1===A.nodeType&&E.push({element:A,left:A.scrollLeft,top:A.scrollTop});for("function"===typeof w.focus&&w.focus(),w=0;w<E.length;w++)(A=E[w]).element.scrollLeft=A.left,A.element.scrollTop=A.top}Gt=!!En,An=En=null,e.current=n,Xa=i;do{try{for(w=e;null!==Xa;){var S=Xa.effectTag;if(36&S&&da(w,Xa.alternate,Xa),128&S){E=void 0;var _=Xa.ref;if(null!==_){var I=Xa.stateNode;Xa.tag,E=I,"function"===typeof _?_(E):_.current=E}}Xa=Xa.nextEffect}}catch(C){if(null===Xa)throw Error(s(330));Bc(Xa,C),Xa=Xa.nextEffect}}while(null!==Xa);Xa=null,Ki(),Fa=o}else e.current=n;if(nc)nc=!1,rc=e,ic=t;else for(Xa=i;null!==Xa;)t=Xa.nextEffect,Xa.nextEffect=null,Xa=t;if(0===(t=e.firstPendingTime)&&(tc=null),1073741823===t?e===ac?sc++:(sc=0,ac=e):sc=0,"function"===typeof Uc&&Uc(n.stateNode,r),pc(e),$a)throw $a=!1,e=ec,ec=null,e;return(Fa&xa)!==Ra||Ji(),null}function Pc(){for(;null!==Xa;){var e=Xa.effectTag;0!==(256&e)&&la(Xa.alternate,Xa),0===(512&e)||nc||(nc=!0,Qi(97,(function(){return Dc(),null}))),Xa=Xa.nextEffect}}function Dc(){if(90!==ic){var e=97<ic?97:ic;return ic=90,Wi(e,Oc)}}function Oc(){if(null===rc)return!1;var e=rc;if(rc=null,(Fa&(Pa|Da))!==Ra)throw Error(s(331));var t=Fa;for(Fa|=Da,e=e.current.firstEffect;null!==e;){try{var n=e;if(0!==(512&n.effectTag))switch(n.tag){case 0:case 11:case 15:case 22:ua(5,n),ha(5,n)}}catch(r){if(null===e)throw Error(s(330));Bc(e,r)}n=e.nextEffect,e.nextEffect=null,e=n}return Fa=t,Ji(),!0}function Nc(e,t,n){go(e,t=Sa(e,t=oa(n,t),1073741823)),null!==(e=dc(e,1073741823))&&pc(e)}function Bc(e,t){if(3===e.tag)Nc(e,e,t);else for(var n=e.return;null!==n;){if(3===n.tag){Nc(n,e,t);break}if(1===n.tag){var r=n.stateNode;if("function"===typeof n.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===tc||!tc.has(r))){go(n,e=_a(n,e=oa(t,e),1073741823)),null!==(n=dc(n,1073741823))&&pc(n);break}}n=n.return}}function Lc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),Ka===e&&Za===n?za===Ma||za===La&&1073741823===Ha&&Hi()-Ya<Ja?bc(e,Za):Qa=!0:Qc(e,n)&&(0!==(t=e.lastPingedTime)&&t<n||(e.lastPingedTime=n,pc(e)))}function Mc(e,t){var n=e.stateNode;null!==n&&n.delete(t),0===(t=0)&&(t=uc(t=lc(),e,null)),null!==(e=dc(e,t))&&pc(e)}Ia=function(e,t,n){var r=t.expirationTime;if(null!==e){var i=t.pendingProps;if(e.memoizedProps!==i||vi.current)Ls=!0;else{if(r<n){switch(Ls=!1,t.tag){case 3:Hs(t),Ns();break;case 5:if(Ko(t),4&t.mode&&1!==n&&i.hidden)return t.expirationTime=t.childExpirationTime=1,null;break;case 1:Ei(t.type)&&Ii(t);break;case 4:Uo(t,t.stateNode.containerInfo);break;case 10:r=t.memoizedProps.value,i=t.type._context,gi(to,i._currentValue),i._currentValue=r;break;case 13:if(null!==t.memoizedState)return 0!==(r=t.child.childExpirationTime)&&r>=n?Js(e,t,n):(gi(Zo,1&Zo.current),null!==(t=ta(e,t,n))?t.sibling:null);gi(Zo,1&Zo.current);break;case 19:if(r=t.childExpirationTime>=n,0!==(64&e.effectTag)){if(r)return ea(e,t,n);t.effectTag|=64}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null),gi(Zo,Zo.current),!r)return null}return ta(e,t,n)}Ls=!1}}else Ls=!1;switch(t.expirationTime=0,t.tag){case 2:if(r=t.type,null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),e=t.pendingProps,i=wi(t,mi.current),co(t,n),i=es(null,t,r,e,i,n),t.effectTag|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof){if(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ei(r)){var o=!0;Ii(t)}else o=!1;t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,ho(t);var a=r.getDerivedStateFromProps;"function"===typeof a&&Eo(t,r,a,e),i.updater=Ao,t.stateNode=i,i._reactInternalFiber=t,Co(t,r,e,n),t=Vs(null,t,r,!0,o,n)}else t.tag=0,Ms(null,t,i,n),t=t.child;return t;case 16:e:{if(i=t.elementType,null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),e=t.pendingProps,function(e){if(-1===e._status){e._status=0;var t=e._ctor;t=t(),e._result=t,t.then((function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)}),(function(t){0===e._status&&(e._status=2,e._result=t)}))}}(i),1!==i._status)throw i._result;switch(i=i._result,t.type=i,o=t.tag=function(e){if("function"===typeof e)return Zc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===ce)return 11;if(e===he)return 14}return 2}(i),e=eo(i,e),o){case 0:t=Zs(null,t,i,e,n);break e;case 1:t=zs(null,t,i,e,n);break e;case 11:t=Us(null,t,i,e,n);break e;case 14:t=Fs(null,t,i,eo(i.type,e),r,n);break e}throw Error(s(306,i,""))}return t;case 0:return r=t.type,i=t.pendingProps,Zs(e,t,r,i=t.elementType===r?i:eo(r,i),n);case 1:return r=t.type,i=t.pendingProps,zs(e,t,r,i=t.elementType===r?i:eo(r,i),n);case 3:if(Hs(t),r=t.updateQueue,null===e||null===r)throw Error(s(282));if(r=t.pendingProps,i=null!==(i=t.memoizedState)?i.element:null,fo(e,t),mo(t,r,null,n),(r=t.memoizedState.element)===i)Ns(),t=ta(e,t,n);else{if((i=t.stateNode.hydrate)&&(Ts=Tn(t.stateNode.containerInfo.firstChild),Cs=t,i=ks=!0),i)for(n=Do(t,null,r,n),t.child=n;n;)n.effectTag=-3&n.effectTag|1024,n=n.sibling;else Ms(e,t,r,n),Ns();t=t.child}return t;case 5:return Ko(t),null===e&&Ps(t),r=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,a=i.children,_n(r,i)?a=null:null!==o&&_n(r,o)&&(t.effectTag|=16),js(e,t),4&t.mode&&1!==n&&i.hidden?(t.expirationTime=t.childExpirationTime=1,t=null):(Ms(e,t,a,n),t=t.child),t;case 6:return null===e&&Ps(t),null;case 13:return Js(e,t,n);case 4:return Uo(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Po(t,null,r,n):Ms(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,Us(e,t,r,i=t.elementType===r?i:eo(r,i),n);case 7:return Ms(e,t,t.pendingProps,n),t.child;case 8:case 12:return Ms(e,t,t.pendingProps.children,n),t.child;case 10:e:{r=t.type._context,i=t.pendingProps,a=t.memoizedProps,o=i.value;var c=t.type._context;if(gi(to,c._currentValue),c._currentValue=o,null!==a)if(c=a.value,0===(o=zr(c,o)?0:0|("function"===typeof r._calculateChangedBits?r._calculateChangedBits(c,o):1073741823))){if(a.children===i.children&&!vi.current){t=ta(e,t,n);break e}}else for(null!==(c=t.child)&&(c.return=t);null!==c;){var l=c.dependencies;if(null!==l){a=c.child;for(var u=l.firstContext;null!==u;){if(u.context===r&&0!==(u.observedBits&o)){1===c.tag&&((u=po(n,null)).tag=2,go(c,u)),c.expirationTime<n&&(c.expirationTime=n),null!==(u=c.alternate)&&u.expirationTime<n&&(u.expirationTime=n),ao(c.return,n),l.expirationTime<n&&(l.expirationTime=n);break}u=u.next}}else a=10===c.tag&&c.type===t.type?null:c.child;if(null!==a)a.return=c;else for(a=c;null!==a;){if(a===t){a=null;break}if(null!==(c=a.sibling)){c.return=a.return,a=c;break}a=a.return}c=a}Ms(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=(o=t.pendingProps).children,co(t,n),r=r(i=lo(i,o.unstable_observedBits)),t.effectTag|=1,Ms(e,t,r,n),t.child;case 14:return o=eo(i=t.type,t.pendingProps),Fs(e,t,i,o=eo(i.type,o),r,n);case 15:return Ks(e,t,t.type,t.pendingProps,r,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:eo(r,i),null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),t.tag=1,Ei(r)?(e=!0,Ii(t)):e=!1,co(t,n),_o(t,r,i),Co(t,r,i,n),Vs(null,t,r,!0,e,n);case 19:return ea(e,t,n)}throw Error(s(156,t.tag))};var Uc=null,Fc=null;function Kc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.effectTag=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childExpirationTime=this.expirationTime=0,this.alternate=null}function jc(e,t,n,r){return new Kc(e,t,n,r)}function Zc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function zc(e,t){var n=e.alternate;return null===n?((n=jc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.effectTag=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childExpirationTime=e.childExpirationTime,n.expirationTime=e.expirationTime,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{expirationTime:t.expirationTime,firstContext:t.firstContext,responders:t.responders},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Vc(e,t,n,r,i,o){var a=2;if(r=e,"function"===typeof e)Zc(e)&&(a=1);else if("string"===typeof e)a=5;else e:switch(e){case ne:return Hc(n.children,i,o,t);case ae:a=8,i|=7;break;case re:a=8,i|=1;break;case ie:return(e=jc(12,n,t,8|i)).elementType=ie,e.type=ie,e.expirationTime=o,e;case le:return(e=jc(13,n,t,i)).type=le,e.elementType=le,e.expirationTime=o,e;case ue:return(e=jc(19,n,t,i)).elementType=ue,e.expirationTime=o,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case oe:a=10;break e;case se:a=9;break e;case ce:a=11;break e;case he:a=14;break e;case de:a=16,r=null;break e;case fe:a=22;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=jc(a,n,t,i)).elementType=e,t.type=r,t.expirationTime=o,t}function Hc(e,t,n,r){return(e=jc(7,e,r,t)).expirationTime=n,e}function qc(e,t,n){return(e=jc(6,e,null,t)).expirationTime=n,e}function Gc(e,t,n){return(t=jc(4,null!==e.children?e.children:[],e.key,t)).expirationTime=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Wc(e,t,n){this.tag=t,this.current=null,this.containerInfo=e,this.pingCache=this.pendingChildren=null,this.finishedExpirationTime=0,this.finishedWork=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=90,this.lastExpiredTime=this.lastPingedTime=this.nextKnownPendingLevel=this.lastSuspendedTime=this.firstSuspendedTime=this.firstPendingTime=0}function Qc(e,t){var n=e.firstSuspendedTime;return e=e.lastSuspendedTime,0!==n&&n>=t&&e<=t}function Yc(e,t){var n=e.firstSuspendedTime,r=e.lastSuspendedTime;n<t&&(e.firstSuspendedTime=t),(r>t||0===n)&&(e.lastSuspendedTime=t),t<=e.lastPingedTime&&(e.lastPingedTime=0),t<=e.lastExpiredTime&&(e.lastExpiredTime=0)}function Jc(e,t){t>e.firstPendingTime&&(e.firstPendingTime=t);var n=e.firstSuspendedTime;0!==n&&(t>=n?e.firstSuspendedTime=e.lastSuspendedTime=e.nextKnownPendingLevel=0:t>=e.lastSuspendedTime&&(e.lastSuspendedTime=t+1),t>e.nextKnownPendingLevel&&(e.nextKnownPendingLevel=t))}function Xc(e,t){var n=e.lastExpiredTime;(0===n||n>t)&&(e.lastExpiredTime=t)}function $c(e,t,n,r){var i=t.current,o=lc(),a=bo.suspense;o=uc(o,i,a);e:if(n){t:{if(et(n=n._reactInternalFiber)!==n||1!==n.tag)throw Error(s(170));var c=n;do{switch(c.tag){case 3:c=c.stateNode.context;break t;case 1:if(Ei(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break t}}c=c.return}while(null!==c);throw Error(s(171))}if(1===n.tag){var l=n.type;if(Ei(l)){n=_i(n,l,c);break e}}n=c}else n=yi;return null===t.context?t.context=n:t.pendingContext=n,(t=po(o,a)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),go(i,t),hc(i,o),o}function el(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function tl(e,t){null!==(e=e.memoizedState)&&null!==e.dehydrated&&e.retryTime<t&&(e.retryTime=t)}function nl(e,t){tl(e,t),(e=e.alternate)&&tl(e,t)}function rl(e,t,n){var r=new Wc(e,t,n=null!=n&&!0===n.hydrate),i=jc(3,null,null,2===t?7:1===t?3:0);r.current=i,i.stateNode=r,ho(i),e[Dn]=r.current,n&&0!==t&&function(e,t){var n=$e(t);Tt.forEach((function(e){gt(e,t,n)})),kt.forEach((function(e){gt(e,t,n)}))}(0,9===e.nodeType?e:e.ownerDocument),this._internalRoot=r}function il(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function ol(e,t,n,r,i){var o=n._reactRootContainer;if(o){var s=o._internalRoot;if("function"===typeof i){var a=i;i=function(){var e=el(s);a.call(e)}}$c(t,s,e,i)}else{if(o=n._reactRootContainer=function(e,t){if(t||(t=!(!(t=e?9===e.nodeType?e.documentElement:e.firstChild:null)||1!==t.nodeType||!t.hasAttribute("data-reactroot"))),!t)for(var n;n=e.lastChild;)e.removeChild(n);return new rl(e,0,t?{hydrate:!0}:void 0)}(n,r),s=o._internalRoot,"function"===typeof i){var c=i;i=function(){var e=el(s);c.call(e)}}vc((function(){$c(t,s,e,i)}))}return el(s)}function sl(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!il(t))throw Error(s(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:te,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)}rl.prototype.render=function(e){$c(e,this._internalRoot,null,null)},rl.prototype.unmount=function(){var e=this._internalRoot,t=e.containerInfo;$c(null,e,null,(function(){t[Dn]=null}))},yt=function(e){if(13===e.tag){var t=$i(lc(),150,100);hc(e,t),nl(e,t)}},mt=function(e){13===e.tag&&(hc(e,3),nl(e,3))},vt=function(e){if(13===e.tag){var t=lc();hc(e,t=uc(t,e,null)),nl(e,t)}},k=function(e,t,n){switch(t){case"input":if(Ie(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=Ln(r);if(!i)throw Error(s(90));Ee(r),Ie(r,i)}}}break;case"textarea":De(e,n);break;case"select":null!=(t=n.value)&&Re(e,!!n.multiple,t,!1)}},N=mc,B=function(e,t,n,r,i){var o=Fa;Fa|=4;try{return Wi(98,e.bind(null,t,n,r,i))}finally{(Fa=o)===Ra&&Ji()}},L=function(){(Fa&(1|Pa|Da))===Ra&&(function(){if(null!==oc){var e=oc;oc=null,e.forEach((function(e,t){Xc(t,e),pc(t)})),Ji()}}(),Dc())},M=function(e,t){var n=Fa;Fa|=2;try{return e(t)}finally{(Fa=n)===Ra&&Ji()}};var al={Events:[Nn,Bn,Ln,C,S,zn,function(e){ot(e,Zn)},D,O,Xt,ct,Dc,{current:!1}]};!function(e){var t=e.findFiberByHostInstance;(function(e){if("undefined"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var t=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(t.isDisabled||!t.supportsFiber)return!0;try{var n=t.inject(e);Uc=function(e){try{t.onCommitFiberRoot(n,e,void 0,64===(64&e.current.effectTag))}catch(r){}},Fc=function(e){try{t.onCommitFiberUnmount(n,e)}catch(r){}}}catch(r){}})(i({},e,{overrideHookState:null,overrideProps:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Y.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=rt(e))?null:e.stateNode},findFiberByHostInstance:function(e){return t?t(e):null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null}))}({findFiberByHostInstance:On,bundleType:0,version:"16.14.0",rendererPackageName:"react-dom"}),t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=al,t.createPortal=sl,t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternalFiber;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw Error(s(268,Object.keys(e)))}return e=null===(e=rt(t))?null:e.stateNode},t.flushSync=function(e,t){if((Fa&(Pa|Da))!==Ra)throw Error(s(187));var n=Fa;Fa|=1;try{return Wi(99,e.bind(null,t))}finally{Fa=n,Ji()}},t.hydrate=function(e,t,n){if(!il(t))throw Error(s(200));return ol(null,e,t,!0,n)},t.render=function(e,t,n){if(!il(t))throw Error(s(200));return ol(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!il(e))throw Error(s(40));return!!e._reactRootContainer&&(vc((function(){ol(null,null,e,!1,(function(){e._reactRootContainer=null,e[Dn]=null}))})),!0)},t.unstable_batchedUpdates=mc,t.unstable_createPortal=function(e,t){return sl(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!il(n))throw Error(s(200));if(null==e||void 0===e._reactInternalFiber)throw Error(s(38));return ol(e,t,n,!1,r)},t.version="16.14.0"},54164:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(34463)},50077:e=>{"use strict";var t=Array.isArray,n=Object.keys,r=Object.prototype.hasOwnProperty,i="undefined"!==typeof Element;function o(e,s){if(e===s)return!0;if(e&&s&&"object"==typeof e&&"object"==typeof s){var a,c,l,u=t(e),h=t(s);if(u&&h){if((c=e.length)!=s.length)return!1;for(a=c;0!==a--;)if(!o(e[a],s[a]))return!1;return!0}if(u!=h)return!1;var d=e instanceof Date,f=s instanceof Date;if(d!=f)return!1;if(d&&f)return e.getTime()==s.getTime();var p=e instanceof RegExp,g=s instanceof RegExp;if(p!=g)return!1;if(p&&g)return e.toString()==s.toString();var y=n(e);if((c=y.length)!==n(s).length)return!1;for(a=c;0!==a--;)if(!r.call(s,y[a]))return!1;if(i&&e instanceof Element&&s instanceof Element)return e===s;for(a=c;0!==a--;)if(("_owner"!==(l=y[a])||!e.$$typeof)&&!o(e[l],s[l]))return!1;return!0}return e!==e&&s!==s}e.exports=function(e,t){try{return o(e,t)}catch(n){if(n.message&&n.message.match(/stack|recursion/i)||-2146828260===n.number)return console.warn("Warning: react-fast-compare does not handle circular references.",n.name,n.message),!1;throw n}}},18970:(e,t,n)=>{t.ql=void 0;var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=h(n(72791)),s=h(n(52007)),a=h(n(39475)),c=h(n(50077)),l=n(29893),u=n(98736);function h(e){return e&&e.__esModule?e:{default:e}}function d(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}var f=function(e){var t,n;return n=t=function(t){function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,t.apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,t),n.prototype.shouldComponentUpdate=function(e){return!(0,c.default)(this.props,e)},n.prototype.mapNestedChildrenToProps=function(e,t){if(!t)return null;switch(e.type){case u.TAG_NAMES.SCRIPT:case u.TAG_NAMES.NOSCRIPT:return{innerHTML:t};case u.TAG_NAMES.STYLE:return{cssText:t}}throw new Error("<"+e.type+" /> elements are self-closing and can not contain children. Refer to our API for more information.")},n.prototype.flattenArrayTypeChildren=function(e){var t,n=e.child,i=e.arrayTypeChildren,o=e.newChildProps,s=e.nestedChildren;return r({},i,((t={})[n.type]=[].concat(i[n.type]||[],[r({},o,this.mapNestedChildrenToProps(n,s))]),t))},n.prototype.mapObjectTypeChildren=function(e){var t,n,i=e.child,o=e.newProps,s=e.newChildProps,a=e.nestedChildren;switch(i.type){case u.TAG_NAMES.TITLE:return r({},o,((t={})[i.type]=a,t.titleAttributes=r({},s),t));case u.TAG_NAMES.BODY:return r({},o,{bodyAttributes:r({},s)});case u.TAG_NAMES.HTML:return r({},o,{htmlAttributes:r({},s)})}return r({},o,((n={})[i.type]=r({},s),n))},n.prototype.mapArrayTypeChildrenToProps=function(e,t){var n=r({},t);return Object.keys(e).forEach((function(t){var i;n=r({},n,((i={})[t]=e[t],i))})),n},n.prototype.warnOnInvalidChildren=function(e,t){return!0},n.prototype.mapChildrenToProps=function(e,t){var n=this,r={};return o.default.Children.forEach(e,(function(e){if(e&&e.props){var i=e.props,o=i.children,s=d(i,["children"]),a=(0,l.convertReactPropstoHtmlAttributes)(s);switch(n.warnOnInvalidChildren(e,o),e.type){case u.TAG_NAMES.LINK:case u.TAG_NAMES.META:case u.TAG_NAMES.NOSCRIPT:case u.TAG_NAMES.SCRIPT:case u.TAG_NAMES.STYLE:r=n.flattenArrayTypeChildren({child:e,arrayTypeChildren:r,newChildProps:a,nestedChildren:o});break;default:t=n.mapObjectTypeChildren({child:e,newProps:t,newChildProps:a,nestedChildren:o})}}})),t=this.mapArrayTypeChildrenToProps(r,t)},n.prototype.render=function(){var t=this.props,n=t.children,i=d(t,["children"]),s=r({},i);return n&&(s=this.mapChildrenToProps(n,s)),o.default.createElement(e,s)},i(n,null,[{key:"canUseDOM",set:function(t){e.canUseDOM=t}}]),n}(o.default.Component),t.propTypes={base:s.default.object,bodyAttributes:s.default.object,children:s.default.oneOfType([s.default.arrayOf(s.default.node),s.default.node]),defaultTitle:s.default.string,defer:s.default.bool,encodeSpecialCharacters:s.default.bool,htmlAttributes:s.default.object,link:s.default.arrayOf(s.default.object),meta:s.default.arrayOf(s.default.object),noscript:s.default.arrayOf(s.default.object),onChangeClientState:s.default.func,script:s.default.arrayOf(s.default.object),style:s.default.arrayOf(s.default.object),title:s.default.string,titleAttributes:s.default.object,titleTemplate:s.default.string},t.defaultProps={defer:!0,encodeSpecialCharacters:!0},t.peek=e.peek,t.rewind=function(){var t=e.rewind();return t||(t=(0,l.mapStateOnServer)({baseTag:[],bodyAttributes:{},encodeSpecialCharacters:!0,htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}})),t},n}((0,a.default)(l.reducePropsToState,l.handleClientStateChange,l.mapStateOnServer)((function(){return null})));f.renderStatic=f.rewind,t.ql=f},98736:(e,t)=>{t.__esModule=!0;t.ATTRIBUTE_NAMES={BODY:"bodyAttributes",HTML:"htmlAttributes",TITLE:"titleAttributes"};var n=t.TAG_NAMES={BASE:"base",BODY:"body",HEAD:"head",HTML:"html",LINK:"link",META:"meta",NOSCRIPT:"noscript",SCRIPT:"script",STYLE:"style",TITLE:"title"},r=(t.VALID_TAG_NAMES=Object.keys(n).map((function(e){return n[e]})),t.TAG_PROPERTIES={CHARSET:"charset",CSS_TEXT:"cssText",HREF:"href",HTTPEQUIV:"http-equiv",INNER_HTML:"innerHTML",ITEM_PROP:"itemprop",NAME:"name",PROPERTY:"property",REL:"rel",SRC:"src"},t.REACT_TAG_MAP={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"});t.HELMET_PROPS={DEFAULT_TITLE:"defaultTitle",DEFER:"defer",ENCODE_SPECIAL_CHARACTERS:"encodeSpecialCharacters",ON_CHANGE_CLIENT_STATE:"onChangeClientState",TITLE_TEMPLATE:"titleTemplate"},t.HTML_TAG_MAP=Object.keys(r).reduce((function(e,t){return e[r[t]]=t,e}),{}),t.SELF_CLOSING_TAGS=[n.NOSCRIPT,n.SCRIPT,n.STYLE],t.HELMET_ATTRIBUTE="data-react-helmet"},29893:(e,t,n)=>{t.__esModule=!0,t.warn=t.requestAnimationFrame=t.reducePropsToState=t.mapStateOnServer=t.handleClientStateChange=t.convertReactPropstoHtmlAttributes=void 0;var r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=c(n(72791)),s=c(n(31725)),a=n(98736);function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){return!1===(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])?String(e):String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")},u=function(e){var t=g(e,a.TAG_NAMES.TITLE),n=g(e,a.HELMET_PROPS.TITLE_TEMPLATE);if(n&&t)return n.replace(/%s/g,(function(){return t}));var r=g(e,a.HELMET_PROPS.DEFAULT_TITLE);return t||r||void 0},h=function(e){return g(e,a.HELMET_PROPS.ON_CHANGE_CLIENT_STATE)||function(){}},d=function(e,t){return t.filter((function(t){return"undefined"!==typeof t[e]})).map((function(t){return t[e]})).reduce((function(e,t){return i({},e,t)}),{})},f=function(e,t){return t.filter((function(e){return"undefined"!==typeof e[a.TAG_NAMES.BASE]})).map((function(e){return e[a.TAG_NAMES.BASE]})).reverse().reduce((function(t,n){if(!t.length)for(var r=Object.keys(n),i=0;i<r.length;i++){var o=r[i].toLowerCase();if(-1!==e.indexOf(o)&&n[o])return t.concat(n)}return t}),[])},p=function(e,t,n){var i={};return n.filter((function(t){return!!Array.isArray(t[e])||("undefined"!==typeof t[e]&&w("Helmet: "+e+' should be of type "Array". Instead found type "'+r(t[e])+'"'),!1)})).map((function(t){return t[e]})).reverse().reduce((function(e,n){var r={};n.filter((function(e){for(var n=void 0,o=Object.keys(e),s=0;s<o.length;s++){var c=o[s],l=c.toLowerCase();-1===t.indexOf(l)||n===a.TAG_PROPERTIES.REL&&"canonical"===e[n].toLowerCase()||l===a.TAG_PROPERTIES.REL&&"stylesheet"===e[l].toLowerCase()||(n=l),-1===t.indexOf(c)||c!==a.TAG_PROPERTIES.INNER_HTML&&c!==a.TAG_PROPERTIES.CSS_TEXT&&c!==a.TAG_PROPERTIES.ITEM_PROP||(n=c)}if(!n||!e[n])return!1;var u=e[n].toLowerCase();return i[n]||(i[n]={}),r[n]||(r[n]={}),!i[n][u]&&(r[n][u]=!0,!0)})).reverse().forEach((function(t){return e.push(t)}));for(var o=Object.keys(r),c=0;c<o.length;c++){var l=o[c],u=(0,s.default)({},i[l],r[l]);i[l]=u}return e}),[]).reverse()},g=function(e,t){for(var n=e.length-1;n>=0;n--){var r=e[n];if(r.hasOwnProperty(t))return r[t]}return null},y=function(){var e=Date.now();return function(t){var n=Date.now();n-e>16?(e=n,t(n)):setTimeout((function(){y(t)}),0)}}(),m=function(e){return clearTimeout(e)},v="undefined"!==typeof window?window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||y:n.g.requestAnimationFrame||y,b="undefined"!==typeof window?window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||m:n.g.cancelAnimationFrame||m,w=function(e){return console&&"function"===typeof console.warn&&console.warn(e)},E=null,A=function(e,t){var n=e.baseTag,r=e.bodyAttributes,i=e.htmlAttributes,o=e.linkTags,s=e.metaTags,c=e.noscriptTags,l=e.onChangeClientState,u=e.scriptTags,h=e.styleTags,d=e.title,f=e.titleAttributes;I(a.TAG_NAMES.BODY,r),I(a.TAG_NAMES.HTML,i),_(d,f);var p={baseTag:C(a.TAG_NAMES.BASE,n),linkTags:C(a.TAG_NAMES.LINK,o),metaTags:C(a.TAG_NAMES.META,s),noscriptTags:C(a.TAG_NAMES.NOSCRIPT,c),scriptTags:C(a.TAG_NAMES.SCRIPT,u),styleTags:C(a.TAG_NAMES.STYLE,h)},g={},y={};Object.keys(p).forEach((function(e){var t=p[e],n=t.newTags,r=t.oldTags;n.length&&(g[e]=n),r.length&&(y[e]=p[e].oldTags)})),t&&t(),l(e,g,y)},S=function(e){return Array.isArray(e)?e.join(""):e},_=function(e,t){"undefined"!==typeof e&&document.title!==e&&(document.title=S(e)),I(a.TAG_NAMES.TITLE,t)},I=function(e,t){var n=document.getElementsByTagName(e)[0];if(n){for(var r=n.getAttribute(a.HELMET_ATTRIBUTE),i=r?r.split(","):[],o=[].concat(i),s=Object.keys(t),c=0;c<s.length;c++){var l=s[c],u=t[l]||"";n.getAttribute(l)!==u&&n.setAttribute(l,u),-1===i.indexOf(l)&&i.push(l);var h=o.indexOf(l);-1!==h&&o.splice(h,1)}for(var d=o.length-1;d>=0;d--)n.removeAttribute(o[d]);i.length===o.length?n.removeAttribute(a.HELMET_ATTRIBUTE):n.getAttribute(a.HELMET_ATTRIBUTE)!==s.join(",")&&n.setAttribute(a.HELMET_ATTRIBUTE,s.join(","))}},C=function(e,t){var n=document.head||document.querySelector(a.TAG_NAMES.HEAD),r=n.querySelectorAll(e+"["+a.HELMET_ATTRIBUTE+"]"),i=Array.prototype.slice.call(r),o=[],s=void 0;return t&&t.length&&t.forEach((function(t){var n=document.createElement(e);for(var r in t)if(t.hasOwnProperty(r))if(r===a.TAG_PROPERTIES.INNER_HTML)n.innerHTML=t.innerHTML;else if(r===a.TAG_PROPERTIES.CSS_TEXT)n.styleSheet?n.styleSheet.cssText=t.cssText:n.appendChild(document.createTextNode(t.cssText));else{var c="undefined"===typeof t[r]?"":t[r];n.setAttribute(r,c)}n.setAttribute(a.HELMET_ATTRIBUTE,"true"),i.some((function(e,t){return s=t,n.isEqualNode(e)}))?i.splice(s,1):o.push(n)})),i.forEach((function(e){return e.parentNode.removeChild(e)})),o.forEach((function(e){return n.appendChild(e)})),{oldTags:i,newTags:o}},T=function(e){return Object.keys(e).reduce((function(t,n){var r="undefined"!==typeof e[n]?n+'="'+e[n]+'"':""+n;return t?t+" "+r:r}),"")},k=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(e).reduce((function(t,n){return t[a.REACT_TAG_MAP[n]||n]=e[n],t}),t)},R=function(e,t,n){switch(e){case a.TAG_NAMES.TITLE:return{toComponent:function(){return function(e,t,n){var r,i=((r={key:t})[a.HELMET_ATTRIBUTE]=!0,r),s=k(n,i);return[o.default.createElement(a.TAG_NAMES.TITLE,s,t)]}(0,t.title,t.titleAttributes)},toString:function(){return function(e,t,n,r){var i=T(n),o=S(t);return i?"<"+e+" "+a.HELMET_ATTRIBUTE+'="true" '+i+">"+l(o,r)+"</"+e+">":"<"+e+" "+a.HELMET_ATTRIBUTE+'="true">'+l(o,r)+"</"+e+">"}(e,t.title,t.titleAttributes,n)}};case a.ATTRIBUTE_NAMES.BODY:case a.ATTRIBUTE_NAMES.HTML:return{toComponent:function(){return k(t)},toString:function(){return T(t)}};default:return{toComponent:function(){return function(e,t){return t.map((function(t,n){var r,i=((r={key:n})[a.HELMET_ATTRIBUTE]=!0,r);return Object.keys(t).forEach((function(e){var n=a.REACT_TAG_MAP[e]||e;if(n===a.TAG_PROPERTIES.INNER_HTML||n===a.TAG_PROPERTIES.CSS_TEXT){var r=t.innerHTML||t.cssText;i.dangerouslySetInnerHTML={__html:r}}else i[n]=t[e]})),o.default.createElement(e,i)}))}(e,t)},toString:function(){return function(e,t,n){return t.reduce((function(t,r){var i=Object.keys(r).filter((function(e){return!(e===a.TAG_PROPERTIES.INNER_HTML||e===a.TAG_PROPERTIES.CSS_TEXT)})).reduce((function(e,t){var i="undefined"===typeof r[t]?t:t+'="'+l(r[t],n)+'"';return e?e+" "+i:i}),""),o=r.innerHTML||r.cssText||"",s=-1===a.SELF_CLOSING_TAGS.indexOf(e);return t+"<"+e+" "+a.HELMET_ATTRIBUTE+'="true" '+i+(s?"/>":">"+o+"</"+e+">")}),"")}(e,t,n)}}}};t.convertReactPropstoHtmlAttributes=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(e).reduce((function(t,n){return t[a.HTML_TAG_MAP[n]||n]=e[n],t}),t)},t.handleClientStateChange=function(e){E&&b(E),e.defer?E=v((function(){A(e,(function(){E=null}))})):(A(e),E=null)},t.mapStateOnServer=function(e){var t=e.baseTag,n=e.bodyAttributes,r=e.encode,i=e.htmlAttributes,o=e.linkTags,s=e.metaTags,c=e.noscriptTags,l=e.scriptTags,u=e.styleTags,h=e.title,d=void 0===h?"":h,f=e.titleAttributes;return{base:R(a.TAG_NAMES.BASE,t,r),bodyAttributes:R(a.ATTRIBUTE_NAMES.BODY,n,r),htmlAttributes:R(a.ATTRIBUTE_NAMES.HTML,i,r),link:R(a.TAG_NAMES.LINK,o,r),meta:R(a.TAG_NAMES.META,s,r),noscript:R(a.TAG_NAMES.NOSCRIPT,c,r),script:R(a.TAG_NAMES.SCRIPT,l,r),style:R(a.TAG_NAMES.STYLE,u,r),title:R(a.TAG_NAMES.TITLE,{title:d,titleAttributes:f},r)}},t.reducePropsToState=function(e){return{baseTag:f([a.TAG_PROPERTIES.HREF],e),bodyAttributes:d(a.ATTRIBUTE_NAMES.BODY,e),defer:g(e,a.HELMET_PROPS.DEFER),encode:g(e,a.HELMET_PROPS.ENCODE_SPECIAL_CHARACTERS),htmlAttributes:d(a.ATTRIBUTE_NAMES.HTML,e),linkTags:p(a.TAG_NAMES.LINK,[a.TAG_PROPERTIES.REL,a.TAG_PROPERTIES.HREF],e),metaTags:p(a.TAG_NAMES.META,[a.TAG_PROPERTIES.NAME,a.TAG_PROPERTIES.CHARSET,a.TAG_PROPERTIES.HTTPEQUIV,a.TAG_PROPERTIES.PROPERTY,a.TAG_PROPERTIES.ITEM_PROP],e),noscriptTags:p(a.TAG_NAMES.NOSCRIPT,[a.TAG_PROPERTIES.INNER_HTML],e),onChangeClientState:h(e),scriptTags:p(a.TAG_NAMES.SCRIPT,[a.TAG_PROPERTIES.SRC,a.TAG_PROPERTIES.INNER_HTML],e),styleTags:p(a.TAG_NAMES.STYLE,[a.TAG_PROPERTIES.CSS_TEXT],e),title:u(e),titleAttributes:d(a.ATTRIBUTE_NAMES.TITLE,e)}},t.requestAnimationFrame=v,t.warn=w},87945:(e,t,n)=>{"use strict";n.d(t,{a3:()=>ne,cC:()=>q,$G:()=>J,Zh:()=>te});var r=n(96156),i=n(81253),o=n(72791),s=n(90484),a=n(17399),c=n.n(a),l=/\s([^'"/\s><]+?)[\s/>]|([^\s=]+)=\s?(".*?"|'.*?')/g;function u(e){var t={type:"tag",name:"",voidElement:!1,attrs:{},children:[]},n=e.match(/<\/?([^\s]+?)[/\s>]/);if(n&&(t.name=n[1],(c()[n[1]]||"/"===e.charAt(e.length-2))&&(t.voidElement=!0),t.name.startsWith("!--"))){var r=e.indexOf("--\x3e");return{type:"comment",comment:-1!==r?e.slice(4,r):""}}for(var i=new RegExp(l),o=null;null!==(o=i.exec(e));)if(o[0].trim())if(o[1]){var s=o[1].trim(),a=[s,""];s.indexOf("=")>-1&&(a=s.split("=")),t.attrs[a[0]]=a[1],i.lastIndex--}else o[2]&&(t.attrs[o[2]]=o[3].trim().substring(1,o[3].length-1));return t}var h=/<[a-zA-Z0-9\-\!\/](?:"[^"]*"|'[^']*'|[^'">])*>/g,d=/^\s*$/,f=Object.create(null);function p(e,t){switch(t.type){case"text":return e+t.content;case"tag":return e+="<"+t.name+(t.attrs?function(e){var t=[];for(var n in e)t.push(n+'="'+e[n]+'"');return t.length?" "+t.join(" "):""}(t.attrs):"")+(t.voidElement?"/>":">"),t.voidElement?e:e+t.children.reduce(p,"")+"</"+t.name+">";case"comment":return e+"\x3c!--"+t.comment+"--\x3e"}}var g={parse:function(e,t){t||(t={}),t.components||(t.components=f);var n,r=[],i=[],o=-1,s=!1;if(0!==e.indexOf("<")){var a=e.indexOf("<");r.push({type:"text",content:-1===a?e:e.substring(0,a)})}return e.replace(h,(function(a,c){if(s){if(a!=="</"+n.name+">")return;s=!1}var l,h="/"!==a.charAt(1),f=a.startsWith("\x3c!--"),p=c+a.length,g=e.charAt(p);if(f){var y=u(a);return o<0?(r.push(y),r):((l=i[o]).children.push(y),r)}if(h&&(o++,"tag"===(n=u(a)).type&&t.components[n.name]&&(n.type="component",s=!0),n.voidElement||s||!g||"<"===g||n.children.push({type:"text",content:e.slice(p,e.indexOf("<",p))}),0===o&&r.push(n),(l=i[o-1])&&l.children.push(n),i[o]=n),(!h||n.voidElement)&&(o>-1&&(n.voidElement||n.name===a.slice(2,-1))&&(o--,n=-1===o?r:i[o]),!s&&"<"!==g&&g)){l=-1===o?r:i[o].children;var m=e.indexOf("<",p),v=e.slice(p,-1===m?void 0:m);d.test(v)&&(v=" "),(m>-1&&o+l.length>=0||" "!==v)&&l.push({type:"text",content:v})}})),r},stringify:function(e){return e.reduce((function(e,t){return e+p("",t)}),"")}};const y=g;function m(){if(console&&console.warn){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];"string"===typeof n[0]&&(n[0]="react-i18next:: ".concat(n[0])),(e=console).warn.apply(e,n)}}var v={};function b(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];"string"===typeof t[0]&&v[t[0]]||("string"===typeof t[0]&&(v[t[0]]=new Date),m.apply(void 0,t))}var w=function(e,t){return function(){if(e.isInitialized)t();else{e.on("initialized",(function n(){setTimeout((function(){e.off("initialized",n)}),0),t()}))}}};function E(e,t,n){e.loadNamespaces(t,w(e,n))}function A(e,t,n,r){"string"===typeof n&&(n=[n]),n.forEach((function(t){e.options.ns.indexOf(t)<0&&e.options.ns.push(t)})),e.loadLanguages(t,w(e,r))}var S=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,_={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"\xa9","&#169;":"\xa9","&reg;":"\xae","&#174;":"\xae","&hellip;":"\u2026","&#8230;":"\u2026","&#x2F;":"/","&#47;":"/"},I=function(e){return _[e]};var C,T={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:function(e){return e.replace(S,I)}};function k(){return T}function R(){return C}var x=["format"],P=["children","count","parent","i18nKey","context","tOptions","values","defaults","components","ns","i18n","t","shouldUnescape"];function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function N(e,t){if(!e)return!1;var n=e.props?e.props.children:e.children;return t?n.length>0:!!n}function B(e){return e?e.props?e.props.children:e.children:[]}function L(e){return Array.isArray(e)?e:[e]}function M(e,t){if(!e)return"";var n="",r=L(e),a=t.transSupportBasicHtmlNodes&&t.transKeepBasicHtmlNodesFor?t.transKeepBasicHtmlNodesFor:[];return r.forEach((function(e,r){if("string"===typeof e)n+="".concat(e);else if((0,o.isValidElement)(e)){var c=Object.keys(e.props).length,l=a.indexOf(e.type)>-1,u=e.props.children;if(!u&&l&&0===c)n+="<".concat(e.type,"/>");else if(u||l&&0===c)if(e.props.i18nIsDynamicList)n+="<".concat(r,"></").concat(r,">");else if(l&&1===c&&"string"===typeof u)n+="<".concat(e.type,">").concat(u,"</").concat(e.type,">");else{var h=M(u,t);n+="<".concat(r,">").concat(h,"</").concat(r,">")}else n+="<".concat(r,"></").concat(r,">")}else if(null===e)m("Trans: the passed in value is invalid - seems you passed in a null child.");else if("object"===(0,s.Z)(e)){var d=e.format,f=(0,i.Z)(e,x),p=Object.keys(f);if(1===p.length){var g=d?"".concat(p[0],", ").concat(d):p[0];n+="{{".concat(g,"}}")}else m("react-i18next: the passed in object contained more than one variable - the object should look like {{ value, format }} where format is optional.",e)}else m("Trans: the passed in value is invalid - seems you passed in a variable like {number} - please pass in variables for interpolation as full objects like {{number}}.",e)})),n}function U(e,t,n,r,i,a){if(""===t)return[];var c=r.transKeepBasicHtmlNodesFor||[],l=t&&new RegExp(c.join("|")).test(t);if(!e&&!l)return[t];var u={};!function e(t){L(t).forEach((function(t){"string"!==typeof t&&(N(t)?e(B(t)):"object"!==(0,s.Z)(t)||(0,o.isValidElement)(t)||Object.assign(u,t))}))}(e);var h=y.parse("<0>".concat(t,"</0>")),d=O(O({},u),i);function f(e,t,n){var r=B(e),i=g(r,t.children,n);return function(e){return"[object Array]"===Object.prototype.toString.call(e)&&e.every((function(e){return(0,o.isValidElement)(e)}))}(r)&&0===i.length?r:i}function p(e,t,n,r,i){e.dummy&&(e.children=t),n.push((0,o.cloneElement)(e,O(O({},e.props),{},{key:r}),i?void 0:t))}function g(t,i,u){var h=L(t);return L(i).reduce((function(t,i,y){var m=i.children&&i.children[0]&&i.children[0].content&&n.services.interpolator.interpolate(i.children[0].content,d,n.language);if("tag"===i.type){var v=h[parseInt(i.name,10)];!v&&1===u.length&&u[0][i.name]&&(v=u[0][i.name]),v||(v={});var b=0!==Object.keys(i.attrs).length?function(e,t){var n=O({},t);return n.props=Object.assign(e.props,t.props),n}({props:i.attrs},v):v,w=(0,o.isValidElement)(b),E=w&&N(i,!0)&&!i.voidElement,A=l&&"object"===(0,s.Z)(b)&&b.dummy&&!w,S="object"===(0,s.Z)(e)&&null!==e&&Object.hasOwnProperty.call(e,i.name);if("string"===typeof b){var _=n.services.interpolator.interpolate(b,d,n.language);t.push(_)}else if(N(b)||E){p(b,f(b,i,u),t,y)}else if(A){var I=g(h,i.children,u);t.push((0,o.cloneElement)(b,O(O({},b.props),{},{key:y}),I))}else if(Number.isNaN(parseFloat(i.name))){if(S)p(b,f(b,i,u),t,y,i.voidElement);else if(r.transSupportBasicHtmlNodes&&c.indexOf(i.name)>-1)if(i.voidElement)t.push((0,o.createElement)(i.name,{key:"".concat(i.name,"-").concat(y)}));else{var C=g(h,i.children,u);t.push((0,o.createElement)(i.name,{key:"".concat(i.name,"-").concat(y)},C))}else if(i.voidElement)t.push("<".concat(i.name," />"));else{var T=g(h,i.children,u);t.push("<".concat(i.name,">").concat(T,"</").concat(i.name,">"))}}else if("object"!==(0,s.Z)(b)||w)1===i.children.length&&m?t.push((0,o.cloneElement)(b,O(O({},b.props),{},{key:y}),m)):t.push((0,o.cloneElement)(b,O(O({},b.props),{},{key:y})));else{var k=i.children[0]?m:null;k&&t.push(k)}}else if("text"===i.type){var R=r.transWrapTextNodes,x=a?r.unescape(n.services.interpolator.interpolate(i.content,d,n.language)):n.services.interpolator.interpolate(i.content,d,n.language);R?t.push((0,o.createElement)(R,{key:"".concat(i.name,"-").concat(y)},x)):t.push(x)}return t}),[])}return B(g([{dummy:!0,children:e||[]}],h,L(e||[]))[0])}function F(e){var t=e.children,n=e.count,r=e.parent,s=e.i18nKey,a=e.context,c=e.tOptions,l=void 0===c?{}:c,u=e.values,h=e.defaults,d=e.components,f=e.ns,p=e.i18n,g=e.t,y=e.shouldUnescape,m=(0,i.Z)(e,P),v=p||R();if(!v)return b("You will need to pass in an i18next instance by using i18nextReactModule"),t;var w=g||v.t.bind(v)||function(e){return e};a&&(l.context=a);var E=O(O({},k()),v.options&&v.options.react),A=f||w.ns||v.options&&v.options.defaultNS;A="string"===typeof A?[A]:A||["translation"];var S=h||M(t,E)||E.transEmptyNodeValue||s,_=E.hashTransKey,I=s||(_?_(S):S),C=u?l.interpolation:{interpolation:O(O({},l.interpolation),{},{prefix:"#$?",suffix:"?$#"})},T=O(O(O(O({},l),{},{count:n},u),C),{},{defaultValue:S,ns:A}),x=U(d||t,I?w(I,T):S,v,E,T,y),D=void 0!==r?r:E.defaultTransParent;return D?(0,o.createElement)(D,m,x):x}var K=n(6610),j=n(5991);var Z=(0,o.createContext)(),z=function(){function e(){(0,K.Z)(this,e),this.usedNamespaces={}}return(0,j.Z)(e,[{key:"addUsedNamespaces",value:function(e){var t=this;e.forEach((function(e){t.usedNamespaces[e]||(t.usedNamespaces[e]=!0)}))}},{key:"getUsedNamespaces",value:function(){return Object.keys(this.usedNamespaces)}}]),e}();var V=["children","count","parent","i18nKey","context","tOptions","values","defaults","components","ns","i18n","t","shouldUnescape"];function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function q(e){var t=e.children,n=e.count,s=e.parent,a=e.i18nKey,c=e.context,l=e.tOptions,u=void 0===l?{}:l,h=e.values,d=e.defaults,f=e.components,p=e.ns,g=e.i18n,y=e.t,m=e.shouldUnescape,v=(0,i.Z)(e,V),b=(0,o.useContext)(Z)||{},w=b.i18n,E=b.defaultNS,A=g||w||R(),S=y||A&&A.t.bind(A);return F(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({children:t,count:n,parent:s,i18nKey:a,context:c,tOptions:u,values:h,defaults:d,components:f,ns:p||S&&S.ns||E||A&&A.options&&A.options.defaultNS,i18n:A,t:y,shouldUnescape:m},v))}var G=n(28481);function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Y=function(e,t){var n=(0,o.useRef)();return(0,o.useEffect)((function(){n.current=t?n.current:e}),[e,t]),n.current};function J(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.i18n,r=(0,o.useContext)(Z)||{},i=r.i18n,a=r.defaultNS,c=n||i||R();if(c&&!c.reportNamespaces&&(c.reportNamespaces=new z),!c){b("You will need to pass in an i18next instance by using initReactI18next");var l=function(e,t){return"string"===typeof t?t:t&&"object"===(0,s.Z)(t)&&"string"===typeof t.defaultValue?t.defaultValue:Array.isArray(e)?e[e.length-1]:e},u=[l,{},!1];return u.t=l,u.i18n={},u.ready=!1,u}c.options.react&&void 0!==c.options.react.wait&&b("It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");var h=Q(Q(Q({},k()),c.options.react),t),d=h.useSuspense,f=h.keyPrefix,p=e||a||c.options&&c.options.defaultNS;p="string"===typeof p?[p]:p||["translation"],c.reportNamespaces.addUsedNamespaces&&c.reportNamespaces.addUsedNamespaces(p);var g=(c.isInitialized||c.initializedStoreOnce)&&p.every((function(e){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.languages&&t.languages.length?void 0!==t.options.ignoreJSONStructure?t.hasLoadedNamespace(e,{lng:n.lng,precheck:function(t,r){if(n.bindI18n&&n.bindI18n.indexOf("languageChanging")>-1&&t.services.backendConnector.backend&&t.isLanguageChangingTo&&!r(t.isLanguageChangingTo,e))return!1}}):function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=t.languages[0],i=!!t.options&&t.options.fallbackLng,o=t.languages[t.languages.length-1];if("cimode"===r.toLowerCase())return!0;var s=function(e,n){var r=t.services.backendConnector.state["".concat(e,"|").concat(n)];return-1===r||2===r};return!(n.bindI18n&&n.bindI18n.indexOf("languageChanging")>-1&&t.services.backendConnector.backend&&t.isLanguageChangingTo&&!s(t.isLanguageChangingTo,e))&&(!!t.hasResourceBundle(r,e)||!(t.services.backendConnector.backend&&(!t.options.resources||t.options.partialBundledLanguages))||!(!s(r,e)||i&&!s(o,e)))}(e,t,n):(b("i18n.languages were undefined or empty",t.languages),!0)}(e,c,h)}));function y(){return c.getFixedT(t.lng||null,"fallback"===h.nsMode?p:p[0],f)}var m=(0,o.useState)(y),v=(0,G.Z)(m,2),w=v[0],S=v[1],_=p.join();t.lng&&(_="".concat(t.lng).concat(_));var I=Y(_),C=(0,o.useRef)(!0);(0,o.useEffect)((function(){var e=h.bindI18n,n=h.bindI18nStore;function r(){C.current&&S(y)}return C.current=!0,g||d||(t.lng?A(c,t.lng,p,(function(){C.current&&S(y)})):E(c,p,(function(){C.current&&S(y)}))),g&&I&&I!==_&&C.current&&S(y),e&&c&&c.on(e,r),n&&c&&c.store.on(n,r),function(){C.current=!1,e&&c&&e.split(" ").forEach((function(e){return c.off(e,r)})),n&&c&&n.split(" ").forEach((function(e){return c.store.off(e,r)}))}}),[c,_]);var T=(0,o.useRef)(!0);(0,o.useEffect)((function(){C.current&&!T.current&&S(y),T.current=!1}),[c,f]);var x=[w,c,g];if(x.t=w,x.i18n=c,x.ready=g,g)return x;if(!g&&!d)return x;throw new Promise((function(e){t.lng?A(c,t.lng,p,(function(){return e()})):E(c,p,(function(){return e()}))}))}var X=["forwardedRef"];function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function te(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(n){function r(r){var s=r.forwardedRef,a=(0,i.Z)(r,X),c=J(e,ee(ee({},a),{},{keyPrefix:t.keyPrefix})),l=(0,G.Z)(c,3),u=l[0],h=l[1],d=l[2],f=ee(ee({},a),{},{t:u,i18n:h,tReady:d});return t.withRef&&s?f.ref=s:!t.withRef&&s&&(f.forwardedRef=s),(0,o.createElement)(n,f)}var s;r.displayName="withI18nextTranslation(".concat((s=n).displayName||s.name||("string"===typeof s&&s.length>0?s:"Unknown"),")"),r.WrappedComponent=n;return t.withRef?(0,o.forwardRef)((function(e,t){return(0,o.createElement)(r,Object.assign({},e,{forwardedRef:t}))})):r}}function ne(e){var t=e.i18n,n=e.defaultNS,r=e.children,i=(0,o.useMemo)((function(){return{i18n:t,defaultNS:n}}),[t,n]);return(0,o.createElement)(Z.Provider,{value:i},r)}},11372:(e,t)=>{"use strict";var n="function"===typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,i=n?Symbol.for("react.portal"):60106,o=n?Symbol.for("react.fragment"):60107,s=n?Symbol.for("react.strict_mode"):60108,a=n?Symbol.for("react.profiler"):60114,c=n?Symbol.for("react.provider"):60109,l=n?Symbol.for("react.context"):60110,u=n?Symbol.for("react.async_mode"):60111,h=n?Symbol.for("react.concurrent_mode"):60111,d=n?Symbol.for("react.forward_ref"):60112,f=n?Symbol.for("react.suspense"):60113,p=n?Symbol.for("react.suspense_list"):60120,g=n?Symbol.for("react.memo"):60115,y=n?Symbol.for("react.lazy"):60116,m=n?Symbol.for("react.block"):60121,v=n?Symbol.for("react.fundamental"):60117,b=n?Symbol.for("react.responder"):60118,w=n?Symbol.for("react.scope"):60119;function E(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case u:case h:case o:case a:case s:case f:return e;default:switch(e=e&&e.$$typeof){case l:case d:case y:case g:case c:return e;default:return t}}case i:return t}}}function A(e){return E(e)===h}t.AsyncMode=u,t.ConcurrentMode=h,t.ContextConsumer=l,t.ContextProvider=c,t.Element=r,t.ForwardRef=d,t.Fragment=o,t.Lazy=y,t.Memo=g,t.Portal=i,t.Profiler=a,t.StrictMode=s,t.Suspense=f,t.isAsyncMode=function(e){return A(e)||E(e)===u},t.isConcurrentMode=A,t.isContextConsumer=function(e){return E(e)===l},t.isContextProvider=function(e){return E(e)===c},t.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return E(e)===d},t.isFragment=function(e){return E(e)===o},t.isLazy=function(e){return E(e)===y},t.isMemo=function(e){return E(e)===g},t.isPortal=function(e){return E(e)===i},t.isProfiler=function(e){return E(e)===a},t.isStrictMode=function(e){return E(e)===s},t.isSuspense=function(e){return E(e)===f},t.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===o||e===h||e===a||e===s||e===f||e===p||"object"===typeof e&&null!==e&&(e.$$typeof===y||e.$$typeof===g||e.$$typeof===c||e.$$typeof===l||e.$$typeof===d||e.$$typeof===v||e.$$typeof===b||e.$$typeof===w||e.$$typeof===m)},t.typeOf=E},57441:(e,t,n)=>{"use strict";e.exports=n(11372)},14964:(e,t,n)=>{"use strict";n.d(t,{Q_:()=>ot,ZP:()=>Yt});var r=n(72791);function i(e){return function(t){return typeof t===e}}var o=i("function"),s=function(e){return"RegExp"===Object.prototype.toString.call(e).slice(8,-1)},a=function(e){return!c(e)&&!function(e){return null===e}(e)&&(o(e)||"object"===typeof e)},c=i("undefined"),l=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};function u(e,t){if(e===t)return!0;if(e&&a(e)&&t&&a(t)){if(e.constructor!==t.constructor)return!1;if(Array.isArray(e)&&Array.isArray(t))return function(e,t){var n=e.length;if(n!==t.length)return!1;for(var r=n;0!==r--;)if(!u(e[r],t[r]))return!1;return!0}(e,t);if(e instanceof Map&&t instanceof Map)return function(e,t){var n,r,i,o;if(e.size!==t.size)return!1;try{for(var s=l(e.entries()),a=s.next();!a.done;a=s.next()){var c=a.value;if(!t.has(c[0]))return!1}}catch(f){n={error:f}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}try{for(var h=l(e.entries()),d=h.next();!d.done;d=h.next())if(!u((c=d.value)[1],t.get(c[0])))return!1}catch(p){i={error:p}}finally{try{d&&!d.done&&(o=h.return)&&o.call(h)}finally{if(i)throw i.error}}return!0}(e,t);if(e instanceof Set&&t instanceof Set)return function(e,t){var n,r;if(e.size!==t.size)return!1;try{for(var i=l(e.entries()),o=i.next();!o.done;o=i.next()){var s=o.value;if(!t.has(s[0]))return!1}}catch(a){n={error:a}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return!0}(e,t);if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t))return function(e,t){if(e.byteLength!==t.byteLength)return!1;for(var n=new DataView(e.buffer),r=new DataView(t.buffer),i=e.byteLength;i--;)if(n.getUint8(i)!==r.getUint8(i))return!1;return!0}(e,t);if(s(e)&&s(t))return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(var i=n.length;0!==i--;)if(!Object.prototype.hasOwnProperty.call(t,n[i]))return!1;for(i=n.length;0!==i--;){var o=n[i];if(("_owner"!==o||!e.$$typeof)&&!u(e[o],t[o]))return!1}return!0}return!(!Number.isNaN(e)||!Number.isNaN(t))||e===t}var h=["innerHTML","ownerDocument","style","attributes","nodeValue"],d=["Array","ArrayBuffer","AsyncFunction","AsyncGenerator","AsyncGeneratorFunction","Date","Error","Function","Generator","GeneratorFunction","HTMLElement","Map","Object","Promise","RegExp","Set","WeakMap","WeakSet"],f=["bigint","boolean","null","number","string","symbol","undefined"];function p(e){var t,n=Object.prototype.toString.call(e).slice(8,-1);return/HTML\w+Element/.test(n)?"HTMLElement":(t=n,d.includes(t)?n:void 0)}function g(e){return function(t){return p(t)===e}}function y(e){return function(t){return typeof t===e}}function m(e){if(null===e)return"null";switch(typeof e){case"bigint":return"bigint";case"boolean":return"boolean";case"number":return"number";case"string":return"string";case"symbol":return"symbol";case"undefined":return"undefined"}if(m.array(e))return"Array";if(m.plainFunction(e))return"Function";var t=p(e);return t||"Object"}m.array=Array.isArray,m.arrayOf=function(e,t){return!(!m.array(e)&&!m.function(t))&&e.every((function(e){return t(e)}))},m.asyncGeneratorFunction=function(e){return"AsyncGeneratorFunction"===p(e)},m.asyncFunction=g("AsyncFunction"),m.bigint=y("bigint"),m.boolean=function(e){return!0===e||!1===e},m.date=g("Date"),m.defined=function(e){return!m.undefined(e)},m.domElement=function(e){return m.object(e)&&!m.plainObject(e)&&1===e.nodeType&&m.string(e.nodeName)&&h.every((function(t){return t in e}))},m.empty=function(e){return m.string(e)&&0===e.length||m.array(e)&&0===e.length||m.object(e)&&!m.map(e)&&!m.set(e)&&0===Object.keys(e).length||m.set(e)&&0===e.size||m.map(e)&&0===e.size},m.error=g("Error"),m.function=y("function"),m.generator=function(e){return m.iterable(e)&&m.function(e.next)&&m.function(e.throw)},m.generatorFunction=g("GeneratorFunction"),m.instanceOf=function(e,t){return!(!e||!t)&&Object.getPrototypeOf(e)===t.prototype},m.iterable=function(e){return!m.nullOrUndefined(e)&&m.function(e[Symbol.iterator])},m.map=g("Map"),m.nan=function(e){return Number.isNaN(e)},m.null=function(e){return null===e},m.nullOrUndefined=function(e){return m.null(e)||m.undefined(e)},m.number=function(e){return y("number")(e)&&!m.nan(e)},m.numericString=function(e){return m.string(e)&&e.length>0&&!Number.isNaN(Number(e))},m.object=function(e){return!m.nullOrUndefined(e)&&(m.function(e)||"object"===typeof e)},m.oneOf=function(e,t){return!!m.array(e)&&e.indexOf(t)>-1},m.plainFunction=g("Function"),m.plainObject=function(e){if("Object"!==p(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.getPrototypeOf({})},m.primitive=function(e){return m.null(e)||(t=typeof e,f.includes(t));var t},m.promise=g("Promise"),m.propertyOf=function(e,t,n){if(!m.object(e)||!t)return!1;var r=e[t];return m.function(n)?n(r):m.defined(r)},m.regexp=g("RegExp"),m.set=g("Set"),m.string=y("string"),m.symbol=y("symbol"),m.undefined=y("undefined"),m.weakMap=g("WeakMap"),m.weakSet=g("WeakSet");const v=m;function b(e,t,n){var r=n.actual,i=n.key,o=n.previous,s=n.type,a=T(e,i),c=T(t,i),l=[a,c].every(v.number)&&("increased"===s?a<c:a>c);return v.undefined(r)||(l=l&&c===r),v.undefined(o)||(l=l&&a===o),l}function w(e,t,n){var r=n.key,i=n.type,o=n.value,s=T(e,r),a=T(t,r),c="added"===i?s:a,l="added"===i?a:s;return v.nullOrUndefined(o)?[s,a].every(v.array)?!l.every(I(c)):[s,a].every(v.plainObject)?function(e,t){return t.some((function(t){return!e.includes(t)}))}(Object.keys(c),Object.keys(l)):![s,a].every((function(e){return v.primitive(e)&&v.defined(e)}))&&("added"===i?!v.defined(s)&&v.defined(a):v.defined(s)&&!v.defined(a)):v.defined(c)?!(!v.array(c)&&!v.plainObject(c))&&function(e,t,n){return!!C(e,t)&&([e,t].every(v.array)?!e.some(S(n))&&t.some(S(n)):[e,t].every(v.plainObject)?!Object.entries(e).some(A(n))&&Object.entries(t).some(A(n)):t===n)}(c,l,o):u(l,o)}function E(e,t,n){var r=(void 0===n?{}:n).key,i=T(e,r),o=T(t,r);if(!C(i,o))throw new TypeError("Inputs have different types");if(!function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.every((function(e){return v.string(e)||v.array(e)||v.plainObject(e)}))}(i,o))throw new TypeError("Inputs don't have length");return[i,o].every(v.plainObject)&&(i=Object.keys(i),o=Object.keys(o)),[i,o]}function A(e){return function(t){var n=t[0],r=t[1];return v.array(e)?u(e,r)||e.some((function(e){return u(e,r)||v.array(r)&&I(r)(e)})):v.plainObject(e)&&e[n]?!!e[n]&&u(e[n],r):u(e,r)}}function S(e){return function(t){return v.array(e)?e.some((function(e){return u(e,t)||v.array(t)&&I(t)(e)})):u(e,t)}}function _(e,t){return v.array(e)?e.some((function(e){return u(e,t)})):u(e,t)}function I(e){return function(t){return e.some((function(e){return u(e,t)}))}}function C(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.every(v.array)||e.every(v.number)||e.every(v.plainObject)||e.every(v.string)}function T(e,t){return v.plainObject(e)||v.array(e)?v.string(t)?t.split(".").reduce((function(e,t){return e&&e[t]}),e):v.number(t)?e[t]:e:e}function k(e,t){if([e,t].some(v.nullOrUndefined))throw new Error("Missing required parameters");if(![e,t].every((function(e){return v.plainObject(e)||v.array(e)})))throw new Error("Expected plain objects or array");var n=function(n,r,i){try{var o=T(e,n),s=T(t,n),a=v.defined(r),c=v.defined(i);if(a||c){var l=c?_(i,o):!_(r,o),h=_(r,s);return l&&h}return[o,s].every(v.array)||[o,s].every(v.plainObject)?!u(o,s):o!==s}catch(d){return!1}};return{added:function(n,r){try{return w(e,t,{key:n,type:"added",value:r})}catch(i){return!1}},changed:n,changedFrom:function(n,r,i){if(!v.defined(n))return!1;try{var o=T(e,n),s=T(t,n),a=v.defined(i);return _(r,o)&&(a?_(i,s):!a)}catch(c){return!1}},changedTo:function(e,t){return!!v.defined(e)&&n(e,t)},decreased:function(n,r,i){if(!v.defined(n))return!1;try{return b(e,t,{key:n,actual:r,previous:i,type:"decreased"})}catch(o){return!1}},emptied:function(n){try{var r=E(e,t,{key:n}),i=r[0],o=r[1];return!!i.length&&!o.length}catch(s){return!1}},filled:function(n){try{var r=E(e,t,{key:n}),i=r[0],o=r[1];return!i.length&&!!o.length}catch(s){return!1}},increased:function(n,r,i){if(!v.defined(n))return!1;try{return b(e,t,{key:n,actual:r,previous:i,type:"increased"})}catch(o){return!1}},removed:function(n,r){try{return w(e,t,{key:n,type:"removed",value:r})}catch(i){return!1}}}}var R=["innerHTML","ownerDocument","style","attributes","nodeValue"],x=["Array","ArrayBuffer","AsyncFunction","AsyncGenerator","AsyncGeneratorFunction","Date","Error","Function","Generator","GeneratorFunction","HTMLElement","Map","Object","Promise","RegExp","Set","WeakMap","WeakSet"],P=["bigint","boolean","null","number","string","symbol","undefined"];function D(e){const t=Object.prototype.toString.call(e).slice(8,-1);return/HTML\w+Element/.test(t)?"HTMLElement":(n=t,x.includes(n)?t:void 0);var n}function O(e){return t=>D(t)===e}function N(e){return t=>typeof t===e}function B(e){if(null===e)return"null";switch(typeof e){case"bigint":return"bigint";case"boolean":return"boolean";case"number":return"number";case"string":return"string";case"symbol":return"symbol";case"undefined":return"undefined"}if(B.array(e))return"Array";if(B.plainFunction(e))return"Function";const t=D(e);return t||"Object"}B.array=Array.isArray,B.arrayOf=(e,t)=>!(!B.array(e)&&!B.function(t))&&e.every((e=>t(e))),B.asyncGeneratorFunction=e=>"AsyncGeneratorFunction"===D(e),B.asyncFunction=O("AsyncFunction"),B.bigint=N("bigint"),B.boolean=e=>!0===e||!1===e,B.date=O("Date"),B.defined=e=>!B.undefined(e),B.domElement=e=>B.object(e)&&!B.plainObject(e)&&1===e.nodeType&&B.string(e.nodeName)&&R.every((t=>t in e)),B.empty=e=>B.string(e)&&0===e.length||B.array(e)&&0===e.length||B.object(e)&&!B.map(e)&&!B.set(e)&&0===Object.keys(e).length||B.set(e)&&0===e.size||B.map(e)&&0===e.size,B.error=O("Error"),B.function=N("function"),B.generator=e=>B.iterable(e)&&B.function(e.next)&&B.function(e.throw),B.generatorFunction=O("GeneratorFunction"),B.instanceOf=(e,t)=>!(!e||!t)&&Object.getPrototypeOf(e)===t.prototype,B.iterable=e=>!B.nullOrUndefined(e)&&B.function(e[Symbol.iterator]),B.map=O("Map"),B.nan=e=>Number.isNaN(e),B.null=e=>null===e,B.nullOrUndefined=e=>B.null(e)||B.undefined(e),B.number=e=>N("number")(e)&&!B.nan(e),B.numericString=e=>B.string(e)&&e.length>0&&!Number.isNaN(Number(e)),B.object=e=>!B.nullOrUndefined(e)&&(B.function(e)||"object"===typeof e),B.oneOf=(e,t)=>!!B.array(e)&&e.indexOf(t)>-1,B.plainFunction=O("Function"),B.plainObject=e=>{if("Object"!==D(e))return!1;const t=Object.getPrototypeOf(e);return null===t||t===Object.getPrototypeOf({})},B.primitive=e=>{return B.null(e)||(t=typeof e,P.includes(t));var t},B.promise=O("Promise"),B.propertyOf=(e,t,n)=>{if(!B.object(e)||!t)return!1;const r=e[t];return B.function(n)?n(r):B.defined(r)},B.regexp=O("RegExp"),B.set=O("Set"),B.string=N("string"),B.symbol=N("symbol"),B.undefined=N("undefined"),B.weakMap=O("WeakMap"),B.weakSet=O("WeakSet");var L=B,M=n(54164),U=n(72618),F=n.n(U),K=n(29117),j=n.n(K),Z=n(6426),z=n.n(Z),V=n(57441),H=n(49948),q=n.n(H),G=n(52007),W=n.n(G),Q=n(77156),Y=n(33187),J=["innerHTML","ownerDocument","style","attributes","nodeValue"],X=["Array","ArrayBuffer","AsyncFunction","AsyncGenerator","AsyncGeneratorFunction","Date","Error","Function","Generator","GeneratorFunction","HTMLElement","Map","Object","Promise","RegExp","Set","WeakMap","WeakSet"],$=["bigint","boolean","null","number","string","symbol","undefined"];function ee(e){var t,n=Object.prototype.toString.call(e).slice(8,-1);return/HTML\w+Element/.test(n)?"HTMLElement":(t=n,X.includes(t)?n:void 0)}function te(e){return function(t){return ee(t)===e}}function ne(e){return function(t){return typeof t===e}}function re(e){if(null===e)return"null";switch(typeof e){case"bigint":return"bigint";case"boolean":return"boolean";case"number":return"number";case"string":return"string";case"symbol":return"symbol";case"undefined":return"undefined"}if(re.array(e))return"Array";if(re.plainFunction(e))return"Function";var t=ee(e);return t||"Object"}re.array=Array.isArray,re.arrayOf=function(e,t){return!(!re.array(e)&&!re.function(t))&&e.every((function(e){return t(e)}))},re.asyncGeneratorFunction=function(e){return"AsyncGeneratorFunction"===ee(e)},re.asyncFunction=te("AsyncFunction"),re.bigint=ne("bigint"),re.boolean=function(e){return!0===e||!1===e},re.date=te("Date"),re.defined=function(e){return!re.undefined(e)},re.domElement=function(e){return re.object(e)&&!re.plainObject(e)&&1===e.nodeType&&re.string(e.nodeName)&&J.every((function(t){return t in e}))},re.empty=function(e){return re.string(e)&&0===e.length||re.array(e)&&0===e.length||re.object(e)&&!re.map(e)&&!re.set(e)&&0===Object.keys(e).length||re.set(e)&&0===e.size||re.map(e)&&0===e.size},re.error=te("Error"),re.function=ne("function"),re.generator=function(e){return re.iterable(e)&&re.function(e.next)&&re.function(e.throw)},re.generatorFunction=te("GeneratorFunction"),re.instanceOf=function(e,t){return!(!e||!t)&&Object.getPrototypeOf(e)===t.prototype},re.iterable=function(e){return!re.nullOrUndefined(e)&&re.function(e[Symbol.iterator])},re.map=te("Map"),re.nan=function(e){return Number.isNaN(e)},re.null=function(e){return null===e},re.nullOrUndefined=function(e){return re.null(e)||re.undefined(e)},re.number=function(e){return ne("number")(e)&&!re.nan(e)},re.numericString=function(e){return re.string(e)&&e.length>0&&!Number.isNaN(Number(e))},re.object=function(e){return!re.nullOrUndefined(e)&&(re.function(e)||"object"===typeof e)},re.oneOf=function(e,t){return!!re.array(e)&&e.indexOf(t)>-1},re.plainFunction=te("Function"),re.plainObject=function(e){if("Object"!==ee(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.getPrototypeOf({})},re.primitive=function(e){return re.null(e)||(t=typeof e,$.includes(t));var t},re.promise=te("Promise"),re.propertyOf=function(e,t,n){if(!re.object(e)||!t)return!1;var r=e[t];return re.function(n)?n(r):re.defined(r)},re.regexp=te("RegExp"),re.set=te("Set"),re.string=ne("string"),re.symbol=ne("symbol"),re.undefined=ne("undefined"),re.weakMap=te("WeakMap"),re.weakSet=te("WeakSet");const ie=re;function oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(n),!0).forEach((function(t){ue(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function le(e,t,n){return t&&ce(e.prototype,t),n&&ce(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function ue(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function he(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fe(e,t)}function de(e){return de=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},de(e)}function fe(e,t){return fe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},fe(e,t)}function pe(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function ge(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ye(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=de(e);if(t){var i=de(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ge(e)}(this,n)}}var me={flip:{padding:20},preventOverflow:{padding:10}},ve={INIT:"init",IDLE:"idle",OPENING:"opening",OPEN:"open",CLOSING:"closing",ERROR:"error"},be=F().canUseDOM,we=void 0!==M.createPortal;function Ee(){return"ontouchstart"in window&&/Mobi/.test(navigator.userAgent)}function Ae(e){var t=e.title,n=e.data,r=e.warn,i=void 0!==r&&r,o=e.debug,s=void 0!==o&&o,a=i?console.warn||console.error:console.log;s&&t&&n&&(console.groupCollapsed("%creact-floater: ".concat(t),"color: #9b00ff; font-weight: bold; font-size: 12px;"),Array.isArray(n)?n.forEach((function(e){ie.plainObject(e)&&e.key?a.apply(console,[e.key,e.value]):a.apply(console,[e])})):a.apply(console,[n]),console.groupEnd())}function Se(){}var _e=function(e){he(n,e);var t=ye(n);function n(){return ae(this,n),t.apply(this,arguments)}return le(n,[{key:"componentDidMount",value:function(){be&&(this.node||this.appendNode(),we||this.renderPortal())}},{key:"componentDidUpdate",value:function(){be&&(we||this.renderPortal())}},{key:"componentWillUnmount",value:function(){be&&this.node&&(we||M.unmountComponentAtNode(this.node),this.node&&this.node.parentNode===document.body&&(document.body.removeChild(this.node),this.node=void 0))}},{key:"appendNode",value:function(){var e=this.props,t=e.id,n=e.zIndex;this.node||(this.node=document.createElement("div"),t&&(this.node.id=t),n&&(this.node.style.zIndex=n),document.body.appendChild(this.node))}},{key:"renderPortal",value:function(){if(!be)return null;var e=this.props,t=e.children,n=e.setRef;return this.node||this.appendNode(),we?M.createPortal(t,this.node):(n(M.unstable_renderSubtreeIntoContainer(this,t.length>1?r.createElement("div",null,t):t[0],this.node)),null)}},{key:"renderReact16",value:function(){var e=this.props,t=e.hasChildren,n=e.placement,r=e.target;return t||r||"center"===n?this.renderPortal():null}},{key:"render",value:function(){return we?this.renderReact16():null}}]),n}(r.Component);ue(_e,"propTypes",{children:W().oneOfType([W().element,W().array]),hasChildren:W().bool,id:W().oneOfType([W().string,W().number]),placement:W().string,setRef:W().func.isRequired,target:W().oneOfType([W().object,W().string]),zIndex:W().number});var Ie=function(e){he(n,e);var t=ye(n);function n(){return ae(this,n),t.apply(this,arguments)}return le(n,[{key:"parentStyle",get:function(){var e=this.props,t=e.placement,n=e.styles.arrow.length,r={pointerEvents:"none",position:"absolute",width:"100%"};return t.startsWith("top")?(r.bottom=0,r.left=0,r.right=0,r.height=n):t.startsWith("bottom")?(r.left=0,r.right=0,r.top=0,r.height=n):t.startsWith("left")?(r.right=0,r.top=0,r.bottom=0):t.startsWith("right")&&(r.left=0,r.top=0),r}},{key:"render",value:function(){var e,t=this.props,n=t.placement,i=t.setArrowRef,o=t.styles.arrow,s=o.color,a=o.display,c=o.length,l=o.margin,u=o.position,h=o.spread,d={display:a,position:u},f=h,p=c;return n.startsWith("top")?(e="0,0 ".concat(f/2,",").concat(p," ").concat(f,",0"),d.bottom=0,d.marginLeft=l,d.marginRight=l):n.startsWith("bottom")?(e="".concat(f,",").concat(p," ").concat(f/2,",0 0,").concat(p),d.top=0,d.marginLeft=l,d.marginRight=l):n.startsWith("left")?(p=h,e="0,0 ".concat(f=c,",").concat(p/2," 0,").concat(p),d.right=0,d.marginTop=l,d.marginBottom=l):n.startsWith("right")&&(p=h,e="".concat(f=c,",").concat(p," ").concat(f,",0 0,").concat(p/2),d.left=0,d.marginTop=l,d.marginBottom=l),r.createElement("div",{className:"__floater__arrow",style:this.parentStyle},r.createElement("span",{ref:i,style:d},r.createElement("svg",{width:f,height:p,version:"1.1",xmlns:"http://www.w3.org/2000/svg"},r.createElement("polygon",{points:e,fill:s}))))}}]),n}(r.Component);ue(Ie,"propTypes",{placement:W().string.isRequired,setArrowRef:W().func.isRequired,styles:W().object.isRequired});var Ce=["color","height","width"],Te=function(e){var t=e.handleClick,n=e.styles,i=n.color,o=n.height,s=n.width,a=pe(n,Ce);return r.createElement("button",{"aria-label":"close",onClick:t,style:a,type:"button"},r.createElement("svg",{width:"".concat(s,"px"),height:"".concat(o,"px"),viewBox:"0 0 18 18",version:"1.1",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMidYMid"},r.createElement("g",null,r.createElement("path",{d:"M8.13911129,9.00268191 L0.171521827,17.0258467 C-0.0498027049,17.248715 -0.0498027049,17.6098394 0.171521827,17.8327545 C0.28204354,17.9443526 0.427188206,17.9998706 0.572051765,17.9998706 C0.71714958,17.9998706 0.862013139,17.9443526 0.972581703,17.8327545 L9.0000937,9.74924618 L17.0276057,17.8327545 C17.1384085,17.9443526 17.2832721,17.9998706 17.4281356,17.9998706 C17.5729992,17.9998706 17.718097,17.9443526 17.8286656,17.8327545 C18.0499901,17.6098862 18.0499901,17.2487618 17.8286656,17.0258467 L9.86135722,9.00268191 L17.8340066,0.973848225 C18.0553311,0.750979934 18.0553311,0.389855532 17.8340066,0.16694039 C17.6126821,-0.0556467968 17.254037,-0.0556467968 17.0329467,0.16694039 L9.00042166,8.25611765 L0.967006424,0.167268345 C0.745681892,-0.0553188426 0.387317931,-0.0553188426 0.165993399,0.167268345 C-0.0553311331,0.390136635 -0.0553311331,0.751261038 0.165993399,0.974176179 L8.13920499,9.00268191 L8.13911129,9.00268191 Z",fill:i}))))};Te.propTypes={handleClick:W().func.isRequired,styles:W().object.isRequired};var ke=function(e){var t=e.content,n=e.footer,i=e.handleClick,o=e.open,s=e.positionWrapper,a=e.showCloseButton,c=e.title,l=e.styles,u={content:r.isValidElement(t)?t:r.createElement("div",{className:"__floater__content",style:l.content},t)};return c&&(u.title=r.isValidElement(c)?c:r.createElement("div",{className:"__floater__title",style:l.title},c)),n&&(u.footer=r.isValidElement(n)?n:r.createElement("div",{className:"__floater__footer",style:l.footer},n)),!a&&!s||ie.boolean(o)||(u.close=r.createElement(Te,{styles:l.close,handleClick:i})),r.createElement("div",{className:"__floater__container",style:l.container},u.close,u.title,u.content,u.footer)};ke.propTypes={content:W().node.isRequired,footer:W().node,handleClick:W().func.isRequired,open:W().bool,positionWrapper:W().bool.isRequired,showCloseButton:W().bool.isRequired,styles:W().object.isRequired,title:W().node};var Re=function(e){he(n,e);var t=ye(n);function n(){return ae(this,n),t.apply(this,arguments)}return le(n,[{key:"style",get:function(){var e=this.props,t=e.disableAnimation,n=e.component,r=e.placement,i=e.hideArrow,o=e.status,s=e.styles,a=s.arrow.length,c=s.floater,l=s.floaterCentered,u=s.floaterClosing,h=s.floaterOpening,d=s.floaterWithAnimation,f=s.floaterWithComponent,p={};return i||(r.startsWith("top")?p.padding="0 0 ".concat(a,"px"):r.startsWith("bottom")?p.padding="".concat(a,"px 0 0"):r.startsWith("left")?p.padding="0 ".concat(a,"px 0 0"):r.startsWith("right")&&(p.padding="0 0 0 ".concat(a,"px"))),-1!==[ve.OPENING,ve.OPEN].indexOf(o)&&(p=se(se({},p),h)),o===ve.CLOSING&&(p=se(se({},p),u)),o!==ve.OPEN||t||(p=se(se({},p),d)),"center"===r&&(p=se(se({},p),l)),n&&(p=se(se({},p),f)),se(se({},c),p)}},{key:"render",value:function(){var e=this.props,t=e.component,n=e.handleClick,i=e.hideArrow,o=e.setFloaterRef,s=e.status,a={},c=["__floater"];return a.content=t?r.isValidElement(t)?r.cloneElement(t,{closeFn:n}):t({closeFn:n}):r.createElement(ke,this.props),s===ve.OPEN&&c.push("__floater__open"),i||(a.arrow=r.createElement(Ie,this.props)),r.createElement("div",{ref:o,className:c.join(" "),style:this.style},r.createElement("div",{className:"__floater__body"},a.content,a.arrow))}}]),n}(r.Component);ue(Re,"propTypes",{component:W().oneOfType([W().func,W().element]),content:W().node,disableAnimation:W().bool.isRequired,footer:W().node,handleClick:W().func.isRequired,hideArrow:W().bool.isRequired,open:W().bool,placement:W().string.isRequired,positionWrapper:W().bool.isRequired,setArrowRef:W().func.isRequired,setFloaterRef:W().func.isRequired,showCloseButton:W().bool,status:W().string.isRequired,styles:W().object.isRequired,title:W().node});var xe=function(e){he(n,e);var t=ye(n);function n(){return ae(this,n),t.apply(this,arguments)}return le(n,[{key:"render",value:function(){var e,t=this.props,n=t.children,i=t.handleClick,o=t.handleMouseEnter,s=t.handleMouseLeave,a=t.setChildRef,c=t.setWrapperRef,l=t.style,u=t.styles;if(n)if(1===r.Children.count(n))if(r.isValidElement(n)){var h=ie.function(n.type)?"innerRef":"ref";e=r.cloneElement(r.Children.only(n),ue({},h,a))}else e=r.createElement("span",null,n);else e=n;return e?r.createElement("span",{ref:c,style:se(se({},u),l),onClick:i,onMouseEnter:o,onMouseLeave:s},e):null}}]),n}(r.Component);ue(xe,"propTypes",{children:W().node,handleClick:W().func.isRequired,handleMouseEnter:W().func.isRequired,handleMouseLeave:W().func.isRequired,setChildRef:W().func.isRequired,setWrapperRef:W().func.isRequired,style:W().object,styles:W().object.isRequired});var Pe={zIndex:100};var De=["arrow","flip","offset"],Oe=["position","top","right","bottom","left"],Ne=function(e){he(i,e);var t=ye(i);function i(e){var n;return ae(this,i),ue(ge(n=t.call(this,e)),"setArrowRef",(function(e){n.arrowRef=e})),ue(ge(n),"setChildRef",(function(e){n.childRef=e})),ue(ge(n),"setFloaterRef",(function(e){n.floaterRef=e})),ue(ge(n),"setWrapperRef",(function(e){n.wrapperRef=e})),ue(ge(n),"handleTransitionEnd",(function(){var e=n.state.status,t=n.props.callback;n.wrapperPopper&&n.wrapperPopper.instance.update(),n.setState({status:e===ve.OPENING?ve.OPEN:ve.IDLE},(function(){var e=n.state.status;t(e===ve.OPEN?"open":"close",n.props)}))})),ue(ge(n),"handleClick",(function(){var e=n.props,t=e.event,r=e.open;if(!ie.boolean(r)){var i=n.state,o=i.positionWrapper,s=i.status;("click"===n.event||"hover"===n.event&&o)&&(Ae({title:"click",data:[{event:t,status:s===ve.OPEN?"closing":"opening"}],debug:n.debug}),n.toggle())}})),ue(ge(n),"handleMouseEnter",(function(){var e=n.props,t=e.event,r=e.open;if(!ie.boolean(r)&&!Ee()){var i=n.state.status;"hover"===n.event&&i===ve.IDLE&&(Ae({title:"mouseEnter",data:[{key:"originalEvent",value:t}],debug:n.debug}),clearTimeout(n.eventDelayTimeout),n.toggle())}})),ue(ge(n),"handleMouseLeave",(function(){var e=n.props,t=e.event,r=e.eventDelay,i=e.open;if(!ie.boolean(i)&&!Ee()){var o=n.state,s=o.status,a=o.positionWrapper;"hover"===n.event&&(Ae({title:"mouseLeave",data:[{key:"originalEvent",value:t}],debug:n.debug}),r?-1===[ve.OPENING,ve.OPEN].indexOf(s)||a||n.eventDelayTimeout||(n.eventDelayTimeout=setTimeout((function(){delete n.eventDelayTimeout,n.toggle()}),1e3*r)):n.toggle(ve.IDLE))}})),n.state={currentPlacement:e.placement,needsUpdate:!1,positionWrapper:e.wrapperOptions.position&&!!e.target,status:ve.INIT,statusWrapper:ve.INIT},n._isMounted=!1,n.hasMounted=!1,be&&window.addEventListener("load",(function(){n.popper&&n.popper.instance.update(),n.wrapperPopper&&n.wrapperPopper.instance.update()})),n}return le(i,[{key:"componentDidMount",value:function(){if(be){var e=this.state.positionWrapper,t=this.props,n=t.children,r=t.open,i=t.target;this._isMounted=!0,Ae({title:"init",data:{hasChildren:!!n,hasTarget:!!i,isControlled:ie.boolean(r),positionWrapper:e,target:this.target,floater:this.floaterRef},debug:this.debug}),this.hasMounted||(this.initPopper(),this.hasMounted=!0),!n&&i&&ie.boolean(r)}}},{key:"componentDidUpdate",value:function(e,t){if(be){var n,r=this.props,i=r.autoOpen,o=r.open,s=r.target,a=r.wrapperOptions,c=k(t,this.state),l=c.changedFrom,u=c.changed;if(e.open!==o)ie.boolean(o)&&(n=o?ve.OPENING:ve.CLOSING),this.toggle(n);e.wrapperOptions.position===a.position&&e.target===s||this.changeWrapperPosition(this.props),(u("status",ve.IDLE)&&o||l("status",ve.INIT,ve.IDLE)&&i)&&this.toggle(ve.OPEN),this.popper&&u("status",ve.OPENING)&&this.popper.instance.update(),this.floaterRef&&(u("status",ve.OPENING)||u("status",ve.CLOSING))&&function(e,t,n){var r;r=function(i){n(i),function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];e.removeEventListener(t,n,r)}(e,t,r)},function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];e.addEventListener(t,n,r)}(e,t,r,arguments.length>3&&void 0!==arguments[3]&&arguments[3])}(this.floaterRef,"transitionend",this.handleTransitionEnd),u("needsUpdate",!0)&&this.rebuildPopper()}}},{key:"componentWillUnmount",value:function(){be&&(this._isMounted=!1,this.popper&&this.popper.instance.destroy(),this.wrapperPopper&&this.wrapperPopper.instance.destroy())}},{key:"initPopper",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.target,n=this.state.positionWrapper,r=this.props,i=r.disableFlip,o=r.getPopper,s=r.hideArrow,a=r.offset,c=r.placement,l=r.wrapperOptions,u="top"===c||"bottom"===c?"flip":["right","bottom-end","top-end","left","top-start","bottom-start"];if("center"===c)this.setState({status:ve.IDLE});else if(t&&this.floaterRef){var h=this.options,d=h.arrow,f=h.flip,p=h.offset,g=pe(h,De);new Y.Z(t,this.floaterRef,{placement:c,modifiers:se({arrow:se({enabled:!s,element:this.arrowRef},d),flip:se({enabled:!i,behavior:u},f),offset:se({offset:"0, ".concat(a,"px")},p)},g),onCreate:function(t){var n;e.popper=t,null!==(n=e.floaterRef)&&void 0!==n&&n.isConnected?(o(t,"floater"),e._isMounted&&e.setState({currentPlacement:t.placement,status:ve.IDLE}),c!==t.placement&&setTimeout((function(){t.instance.update()}),1)):e.setState({needsUpdate:!0})},onUpdate:function(t){e.popper=t;var n=e.state.currentPlacement;e._isMounted&&t.placement!==n&&e.setState({currentPlacement:t.placement})}})}if(n){var y=ie.undefined(l.offset)?0:l.offset;new Y.Z(this.target,this.wrapperRef,{placement:l.placement||c,modifiers:{arrow:{enabled:!1},offset:{offset:"0, ".concat(y,"px")},flip:{enabled:!1}},onCreate:function(t){e.wrapperPopper=t,e._isMounted&&e.setState({statusWrapper:ve.IDLE}),o(t,"wrapper"),c!==t.placement&&setTimeout((function(){t.instance.update()}),1)}})}}},{key:"rebuildPopper",value:function(){var e=this;this.floaterRefInterval=setInterval((function(){var t;null!==(t=e.floaterRef)&&void 0!==t&&t.isConnected&&(clearInterval(e.floaterRefInterval),e.setState({needsUpdate:!1}),e.initPopper())}),50)}},{key:"changeWrapperPosition",value:function(e){var t=e.target,n=e.wrapperOptions;this.setState({positionWrapper:n.position&&!!t})}},{key:"toggle",value:function(e){var t=this.state.status===ve.OPEN?ve.CLOSING:ve.OPENING;ie.undefined(e)||(t=e),this.setState({status:t})}},{key:"debug",get:function(){return this.props.debug||!!n.g.ReactFloaterDebug}},{key:"event",get:function(){var e=this.props,t=e.disableHoverToClick,n=e.event;return"hover"===n&&Ee()&&!t?"click":n}},{key:"options",get:function(){var e=this.props.options;return q()(me,e||{})}},{key:"styles",get:function(){var e,t=this,n=this.state,r=n.status,i=n.positionWrapper,o=n.statusWrapper,s=this.props.styles,a=q()(function(e){var t=q()(Pe,e.options||{});return{wrapper:{cursor:"help",display:"inline-flex",flexDirection:"column",zIndex:t.zIndex},wrapperPosition:{left:-1e3,position:"absolute",top:-1e3,visibility:"hidden"},floater:{display:"inline-block",filter:"drop-shadow(0 0 3px rgba(0, 0, 0, 0.3))",maxWidth:300,opacity:0,position:"relative",transition:"opacity 0.3s",visibility:"hidden",zIndex:t.zIndex},floaterOpening:{opacity:1,visibility:"visible"},floaterWithAnimation:{opacity:1,transition:"opacity 0.3s, transform 0.2s",visibility:"visible"},floaterWithComponent:{maxWidth:"100%"},floaterClosing:{opacity:0,visibility:"visible"},floaterCentered:{left:"50%",position:"fixed",top:"50%",transform:"translate(-50%, -50%)"},container:{backgroundColor:"#fff",color:"#666",minHeight:60,minWidth:200,padding:20,position:"relative",zIndex:10},title:{borderBottom:"1px solid #555",color:"#555",fontSize:18,marginBottom:5,paddingBottom:6,paddingRight:18},content:{fontSize:15},close:{backgroundColor:"transparent",border:0,borderRadius:0,color:"#555",fontSize:0,height:15,outline:"none",padding:10,position:"absolute",right:0,top:0,width:15,WebkitAppearance:"none"},footer:{borderTop:"1px solid #ccc",fontSize:13,marginTop:10,paddingTop:5},arrow:{color:"#fff",display:"inline-flex",length:16,margin:8,position:"absolute",spread:32},options:t}}(s),s);i&&(e=-1===[ve.IDLE].indexOf(r)||-1===[ve.IDLE].indexOf(o)?a.wrapperPosition:this.wrapperPopper.styles,a.wrapper=se(se({},a.wrapper),e));if(this.target){var c=window.getComputedStyle(this.target);this.wrapperStyles?a.wrapper=se(se({},a.wrapper),this.wrapperStyles):-1===["relative","static"].indexOf(c.position)&&(this.wrapperStyles={},i||(Oe.forEach((function(e){t.wrapperStyles[e]=c[e]})),a.wrapper=se(se({},a.wrapper),this.wrapperStyles),this.target.style.position="relative",this.target.style.top="auto",this.target.style.right="auto",this.target.style.bottom="auto",this.target.style.left="auto"))}return a}},{key:"target",get:function(){if(!be)return null;var e=this.props.target;return e?ie.domElement(e)?e:document.querySelector(e):this.childRef||this.wrapperRef}},{key:"render",value:function(){var e=this.state,t=e.currentPlacement,n=e.positionWrapper,i=e.status,o=this.props,s=o.children,a=o.component,c=o.content,l=o.disableAnimation,u=o.footer,h=o.hideArrow,d=o.id,f=o.open,p=o.showCloseButton,g=o.style,y=o.target,m=o.title,v=r.createElement(xe,{handleClick:this.handleClick,handleMouseEnter:this.handleMouseEnter,handleMouseLeave:this.handleMouseLeave,setChildRef:this.setChildRef,setWrapperRef:this.setWrapperRef,style:g,styles:this.styles.wrapper},s),b={};return n?b.wrapperInPortal=v:b.wrapperAsChildren=v,r.createElement("span",null,r.createElement(_e,{hasChildren:!!s,id:d,placement:t,setRef:this.setFloaterRef,target:y,zIndex:this.styles.options.zIndex},r.createElement(Re,{component:a,content:c,disableAnimation:l,footer:u,handleClick:this.handleClick,hideArrow:h||"center"===t,open:f,placement:t,positionWrapper:n,setArrowRef:this.setArrowRef,setFloaterRef:this.setFloaterRef,showCloseButton:p,status:i,styles:this.styles,title:m}),b.wrapperInPortal),b.wrapperAsChildren)}}]),i}(r.Component);function Be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Be(Object(n),!0).forEach((function(t){Ke(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Me(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ue(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,We(r.key),r)}}function Fe(e,t,n){return t&&Ue(e.prototype,t),n&&Ue(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ke(e,t,n){return(t=We(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function je(){return je=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},je.apply(this,arguments)}function Ze(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ve(e,t)}function ze(e){return ze=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ze(e)}function Ve(e,t){return Ve=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ve(e,t)}function He(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function qe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ge(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ze(e);if(t){var i=ze(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return qe(e)}(this,n)}}function We(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}ue(Ne,"propTypes",{autoOpen:W().bool,callback:W().func,children:W().node,component:(0,Q.Z)(W().oneOfType([W().func,W().element]),(function(e){return!e.content})),content:(0,Q.Z)(W().node,(function(e){return!e.component})),debug:W().bool,disableAnimation:W().bool,disableFlip:W().bool,disableHoverToClick:W().bool,event:W().oneOf(["hover","click"]),eventDelay:W().number,footer:W().node,getPopper:W().func,hideArrow:W().bool,id:W().oneOfType([W().string,W().number]),offset:W().number,open:W().bool,options:W().object,placement:W().oneOf(["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end","auto","center"]),showCloseButton:W().bool,style:W().object,styles:W().object,target:W().oneOfType([W().object,W().string]),title:W().node,wrapperOptions:W().shape({offset:W().number,placement:W().oneOf(["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end","auto"]),position:W().bool})}),ue(Ne,"defaultProps",{autoOpen:!1,callback:Se,debug:!1,disableAnimation:!1,disableFlip:!1,disableHoverToClick:!1,event:"click",eventDelay:.4,getPopper:Se,hideArrow:!1,offset:15,placement:"bottom",showCloseButton:!1,styles:{},target:null,wrapperOptions:{position:!1}});var Qe={INIT:"init",START:"start",STOP:"stop",RESET:"reset",PREV:"prev",NEXT:"next",GO:"go",CLOSE:"close",SKIP:"skip",UPDATE:"update"},Ye="tour:start",Je="step:before",Xe="beacon",$e="tooltip",et="step:after",tt="tour:end",nt="tour:status",rt="error:target_not_found",it={INIT:"init",READY:"ready",BEACON:"beacon",TOOLTIP:"tooltip",COMPLETE:"complete",ERROR:"error"},ot={IDLE:"idle",READY:"ready",WAITING:"waiting",RUNNING:"running",PAUSED:"paused",SKIPPED:"skipped",FINISHED:"finished",ERROR:"error"},st=F().canUseDOM,at=void 0!==M.createPortal;function ct(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator.userAgent,t=e;return"undefined"===typeof window?t="node":document.documentMode?t="ie":/Edge/.test(e)?t="edge":Boolean(window.opera)||e.indexOf(" OPR/")>=0?t="opera":"undefined"!==typeof window.InstallTrigger?t="firefox":window.chrome?t="chrome":/(Version\/([0-9._]+).*Safari|CriOS|FxiOS| Mobile\/)/.test(e)&&(t="safari"),t}function lt(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function ut(e){var t=[];return function e(n){if("string"===typeof n||"number"===typeof n)t.push(n);else if(Array.isArray(n))n.forEach((function(t){return e(t)}));else if(n&&n.props){var r=n.props.children;Array.isArray(r)?r.forEach((function(t){return e(t)})):e(r)}}(e),t.join(" ").trim()}function ht(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function dt(e){var t=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(e,t,n,r){return t+t+n+n+r+r})),n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return n?[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16)]:[]}function ft(e){return e.disableBeacon||"center"===e.placement}function pt(e,t){var n,i=(0,r.isValidElement)(e)||(0,r.isValidElement)(t),o=L.undefined(e)||L.undefined(t);if(lt(e)!==lt(t)||i||o)return!1;if(L.domElement(e))return e.isSameNode(t);if(L.number(e))return e===t;if(L.function(e))return e.toString()===t.toString();for(var s in e)if(ht(e,s)){if("undefined"===typeof e[s]||"undefined"===typeof t[s])return!1;if(n=lt(e[s]),-1!==["object","array"].indexOf(n)&&pt(e[s],t[s]))continue;if("function"===n&&pt(e[s],t[s]))continue;if(e[s]!==t[s])return!1}for(var a in t)if(ht(t,a)&&"undefined"===typeof e[a])return!1;return!0}function gt(){return!(-1!==["chrome","safari","firefox","opera"].indexOf(ct()))}function yt(e){var t=e.title,n=e.data,r=e.warn,i=void 0!==r&&r,o=e.debug,s=void 0!==o&&o,a=i?console.warn||console.error:console.log;s&&(t&&n?(console.groupCollapsed("%creact-joyride: ".concat(t),"color: #ff0044; font-weight: bold; font-size: 12px;"),Array.isArray(n)?n.forEach((function(e){L.plainObject(e)&&e.key?a.apply(console,[e.key,e.value]):a.apply(console,[e])})):a.apply(console,[n]),console.groupEnd()):console.error("Missing title or data props"))}var mt={action:"",controlled:!1,index:0,lifecycle:it.INIT,size:0,status:ot.IDLE},vt=["action","index","lifecycle","status"];function bt(e){var t=new Map,n=new Map,r=function(){function e(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=r.continuous,o=void 0!==i&&i,s=r.stepIndex,a=r.steps,c=void 0===a?[]:a;Me(this,e),Ke(this,"listener",void 0),Ke(this,"setSteps",(function(e){var r=t.getState(),i=r.size,o=r.status,s={size:e.length,status:o};n.set("steps",e),o===ot.WAITING&&!i&&e.length&&(s.status=ot.RUNNING),t.setState(s)})),Ke(this,"addListener",(function(e){t.listener=e})),Ke(this,"update",(function(e){if(n=e,r=vt,!(L.plainObject(n)&&L.array(r)&&Object.keys(n).every((function(e){return-1!==r.indexOf(e)}))))throw new Error("State is not valid. Valid keys: ".concat(vt.join(", ")));var n,r;t.setState(Le({},t.getNextState(Le(Le(Le({},t.getState()),e),{},{action:e.action||Qe.UPDATE}),!0)))})),Ke(this,"start",(function(e){var n=t.getState(),r=n.index,i=n.size;t.setState(Le(Le({},t.getNextState({action:Qe.START,index:L.number(e)?e:r},!0)),{},{status:i?ot.RUNNING:ot.WAITING}))})),Ke(this,"stop",(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=t.getState(),r=n.index,i=n.status;-1===[ot.FINISHED,ot.SKIPPED].indexOf(i)&&t.setState(Le(Le({},t.getNextState({action:Qe.STOP,index:r+(e?1:0)})),{},{status:ot.PAUSED}))})),Ke(this,"close",(function(){var e=t.getState(),n=e.index;e.status===ot.RUNNING&&t.setState(Le({},t.getNextState({action:Qe.CLOSE,index:n+1})))})),Ke(this,"go",(function(e){var n=t.getState(),r=n.controlled,i=n.status;if(!r&&i===ot.RUNNING){var o=t.getSteps()[e];t.setState(Le(Le({},t.getNextState({action:Qe.GO,index:e})),{},{status:o?i:ot.FINISHED}))}})),Ke(this,"info",(function(){return t.getState()})),Ke(this,"next",(function(){var e=t.getState(),n=e.index;e.status===ot.RUNNING&&t.setState(t.getNextState({action:Qe.NEXT,index:n+1}))})),Ke(this,"open",(function(){t.getState().status===ot.RUNNING&&t.setState(Le({},t.getNextState({action:Qe.UPDATE,lifecycle:it.TOOLTIP})))})),Ke(this,"prev",(function(){var e=t.getState(),n=e.index;e.status===ot.RUNNING&&t.setState(Le({},t.getNextState({action:Qe.PREV,index:n-1})))})),Ke(this,"reset",(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t.getState().controlled||t.setState(Le(Le({},t.getNextState({action:Qe.RESET,index:0})),{},{status:e?ot.RUNNING:ot.READY}))})),Ke(this,"skip",(function(){t.getState().status===ot.RUNNING&&t.setState({action:Qe.SKIP,lifecycle:it.INIT,status:ot.SKIPPED})})),this.setState({action:Qe.INIT,controlled:L.number(s),continuous:o,index:L.number(s)?s:0,lifecycle:it.INIT,status:c.length?ot.READY:ot.IDLE},!0),this.setSteps(c)}return Fe(e,[{key:"setState",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.getState(),i=Le(Le({},r),e),o=i.action,s=i.index,a=i.lifecycle,c=i.size,l=i.status;t.set("action",o),t.set("index",s),t.set("lifecycle",a),t.set("size",c),t.set("status",l),n&&(t.set("controlled",e.controlled),t.set("continuous",e.continuous)),this.listener&&this.hasUpdatedState(r)&&this.listener(this.getState())}},{key:"getState",value:function(){return t.size?{action:t.get("action")||"",controlled:t.get("controlled")||!1,index:parseInt(t.get("index"),10),lifecycle:t.get("lifecycle")||"",size:t.get("size")||0,status:t.get("status")||""}:Le({},mt)}},{key:"getNextState",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.getState(),r=n.action,i=n.controlled,o=n.index,s=n.size,a=n.status,c=L.number(e.index)?e.index:o,l=i&&!t?o:Math.min(Math.max(c,0),s);return{action:e.action||r,controlled:i,index:l,lifecycle:e.lifecycle||it.INIT,size:e.size||s,status:l===s?ot.FINISHED:e.status||a}}},{key:"hasUpdatedState",value:function(e){return JSON.stringify(e)!==JSON.stringify(this.getState())}},{key:"getSteps",value:function(){var e=n.get("steps");return Array.isArray(e)?e:[]}},{key:"getHelpers",value:function(){return{close:this.close,go:this.go,info:this.info,next:this.next,open:this.open,prev:this.prev,reset:this.reset,skip:this.skip}}}]),e}();return new r(e)}function wt(e){return e?e.getBoundingClientRect():{}}function Et(){var e=document,t=e.body,n=e.documentElement;return t&&n?Math.max(t.scrollHeight,t.offsetHeight,n.clientHeight,n.scrollHeight,n.offsetHeight):0}function At(e){return"string"===typeof e?document.querySelector(e):e}function St(e,t,n){var r=z()(e);return r.isSameNode(kt())?n?document:kt():r.scrollHeight>r.offsetHeight||t?r:(r.style.overflow="initial",kt())}function _t(e,t){return!!e&&!St(e,t).isSameNode(kt())}function It(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"fixed";if(!e||!(e instanceof HTMLElement))return!1;var n=e.nodeName;return"BODY"!==n&&"HTML"!==n&&(function(e){return e&&1===e.nodeType?getComputedStyle(e):{}}(e).position===t||It(e.parentNode,t))}function Ct(e){return e instanceof HTMLElement?e.offsetParent instanceof HTMLElement?Ct(e.offsetParent)+e.offsetTop:e.offsetTop:0}function Tt(e,t,n){if(!e)return 0;var r=z()(e),i=Ct(e);return _t(e,n)&&!function(e){return e.offsetParent!==document.body}(e)&&(i-=Ct(r)),Math.floor(i-t)}function kt(){return document.scrollingElement||document.createElement("body")}!function(e){function t(t,n,r,i,o,s){var a=i||"<<anonymous>>",c=s||r;if(null==n[r])return t?new Error("Required ".concat(o," `").concat(c,"` was not specified in `").concat(a,"`.")):null;for(var l=arguments.length,u=new Array(l>6?l-6:0),h=6;h<l;h++)u[h-6]=arguments[h];return e.apply(void 0,[n,r,a,o,c].concat(u))}var n=t.bind(null,!1);n.isRequired=t.bind(null,!0)}((function(e,t,n,i,o){var s=e[t],a=s;if(!r.isValidElement(s)&&(0,V.isValidElementType)(s)){var c={ref:function(){},step:{}};a=r.createElement(a,c)}if(L.string(s)||L.number(s)||!(0,V.isValidElementType)(s)||-1===[V.Element,V.ForwardRef].indexOf((0,V.typeOf)(a)))return new Error("Invalid ".concat(i," `").concat(o,"` supplied to `").concat(n,"`. Expected a React class or forwardRef."))}));var Rt={arrowColor:"#fff",backgroundColor:"#fff",beaconSize:36,overlayColor:"rgba(0, 0, 0, 0.5)",primaryColor:"#f04",spotlightShadow:"0 0 15px rgba(0, 0, 0, 0.5)",textColor:"#333",zIndex:100},xt={backgroundColor:"transparent",border:0,borderRadius:0,color:"#555",cursor:"pointer",fontSize:16,lineHeight:1,padding:8,WebkitAppearance:"none"},Pt={borderRadius:4,position:"absolute"};var Dt={floaterProps:{options:{preventOverflow:{boundariesElement:"scrollParent"}},wrapperOptions:{offset:-18,position:!0}},locale:{back:"Back",close:"Close",last:"Last",next:"Next",open:"Open the dialog",skip:"Skip"},step:{event:"click",placement:"bottom",offset:10}};function Ot(e){var t=["beaconComponent","disableCloseOnEsc","disableOverlay","disableOverlayClose","disableScrolling","disableScrollParentFix","floaterProps","hideBackButton","hideCloseButton","locale","showProgress","showSkipButton","spotlightClicks","spotlightPadding","styles","tooltipComponent"];return Object.keys(e).filter((function(e){return-1!==t.indexOf(e)})).reduce((function(t,n){return t[n]=e[n],t}),{})}function Nt(e,t){if(!e)return null;var n=q().all([Ot(t),Dt.step,e],{isMergeableObject:L.plainObject}),r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=q()(Rt,e.options||{}),n=290;window.innerWidth>480&&(n=380),t.width&&(n=window.innerWidth<t.width?window.innerWidth-30:t.width);var r={bottom:0,left:0,overflow:"hidden",position:"absolute",right:0,top:0,zIndex:t.zIndex},i={beacon:Le(Le({},xt),{},{display:"inline-block",height:t.beaconSize,position:"relative",width:t.beaconSize,zIndex:t.zIndex}),beaconInner:{animation:"joyride-beacon-inner 1.2s infinite ease-in-out",backgroundColor:t.primaryColor,borderRadius:"50%",display:"block",height:"50%",left:"50%",opacity:.7,position:"absolute",top:"50%",transform:"translate(-50%, -50%)",width:"50%"},beaconOuter:{animation:"joyride-beacon-outer 1.2s infinite ease-in-out",backgroundColor:"rgba(".concat(dt(t.primaryColor).join(","),", 0.2)"),border:"2px solid ".concat(t.primaryColor),borderRadius:"50%",boxSizing:"border-box",display:"block",height:"100%",left:0,opacity:.9,position:"absolute",top:0,transformOrigin:"center",width:"100%"},tooltip:{backgroundColor:t.backgroundColor,borderRadius:5,boxSizing:"border-box",color:t.textColor,fontSize:16,maxWidth:"100%",padding:15,position:"relative",width:n},tooltipContainer:{lineHeight:1.4,textAlign:"center"},tooltipTitle:{fontSize:18,margin:0},tooltipContent:{padding:"20px 10px"},tooltipFooter:{alignItems:"center",display:"flex",justifyContent:"flex-end",marginTop:15},tooltipFooterSpacer:{flex:1},buttonNext:Le(Le({},xt),{},{backgroundColor:t.primaryColor,borderRadius:4,color:"#fff"}),buttonBack:Le(Le({},xt),{},{color:t.primaryColor,marginLeft:"auto",marginRight:5}),buttonClose:Le(Le({},xt),{},{color:t.textColor,height:14,padding:15,position:"absolute",right:0,top:0,width:14}),buttonSkip:Le(Le({},xt),{},{color:t.textColor,fontSize:14}),overlay:Le(Le({},r),{},{backgroundColor:t.overlayColor,mixBlendMode:"hard-light"}),overlayLegacy:Le({},r),overlayLegacyCenter:Le(Le({},r),{},{backgroundColor:t.overlayColor}),spotlight:Le(Le({},Pt),{},{backgroundColor:"gray"}),spotlightLegacy:Le(Le({},Pt),{},{boxShadow:"0 0 0 9999px ".concat(t.overlayColor,", ").concat(t.spotlightShadow)}),floaterStyles:{arrow:{color:t.arrowColor},options:{zIndex:t.zIndex+100}},options:t};return q()(i,e)}(q()(t.styles||{},e.styles||{})),i=_t(At(e.target),n.disableScrollParentFix),o=q().all([t.floaterProps||{},Dt.floaterProps,n.floaterProps||{}]);return o.offset=n.offset,o.styles=q()(o.styles||{},r.floaterStyles||{}),delete r.floaterStyles,o.offset+=t.spotlightPadding||e.spotlightPadding||0,e.placementBeacon&&(o.wrapperOptions.placement=e.placementBeacon),i&&(o.options.preventOverflow.boundariesElement="window"),Le(Le({},n),{},{locale:q().all([Dt.locale,t.locale||{},n.locale||{}]),floaterProps:o,styles:r})}function Bt(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return L.plainObject(e)?!!e.target||(yt({title:"validateStep",data:"target is missing from the step",warn:!0,debug:t}),!1):(yt({title:"validateStep",data:"step must be an object",warn:!0,debug:t}),!1)}function Lt(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return L.array(e)?e.every((function(e){return Bt(e,t)})):(yt({title:"validateSteps",data:"steps must be an array",warn:!0,debug:t}),!1)}var Mt=Fe((function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(Me(this,e),Ke(this,"element",void 0),Ke(this,"options",void 0),Ke(this,"canBeTabbed",(function(e){var t=e.tabIndex;return(null===t||t<0)&&(t=void 0),!isNaN(t)&&n.canHaveFocus(e)})),Ke(this,"canHaveFocus",(function(e){var t=e.nodeName.toLowerCase();return(/input|select|textarea|button|object/.test(t)&&!e.getAttribute("disabled")||"a"===t&&!!e.getAttribute("href"))&&n.isVisible(e)})),Ke(this,"findValidTabElements",(function(){return[].slice.call(n.element.querySelectorAll("*"),0).filter(n.canBeTabbed)})),Ke(this,"handleKeyDown",(function(e){var t=n.options.keyCode,r=void 0===t?9:t;e.keyCode===r&&n.interceptTab(e)})),Ke(this,"interceptTab",(function(e){var t=n.findValidTabElements();if(t.length){e.preventDefault();var r=e.shiftKey,i=t.indexOf(document.activeElement);-1===i||!r&&i+1===t.length?i=0:r&&0===i?i=t.length-1:i+=r?-1:1,t[i].focus()}})),Ke(this,"isHidden",(function(e){var t=e.offsetWidth<=0&&e.offsetHeight<=0,n=window.getComputedStyle(e);return!(!t||e.innerHTML)||(t&&"visible"!==n.getPropertyValue("overflow")||"none"===n.getPropertyValue("display"))})),Ke(this,"isVisible",(function(e){for(var t=e;t;)if(t instanceof HTMLElement){if(t===document.body)break;if(n.isHidden(t))return!1;t=t.parentNode}return!0})),Ke(this,"removeScope",(function(){window.removeEventListener("keydown",n.handleKeyDown)})),Ke(this,"checkFocus",(function(e){document.activeElement!==e&&(e.focus(),window.requestAnimationFrame((function(){return n.checkFocus(e)})))})),Ke(this,"setFocus",(function(){var e=n.options.selector;if(e){var t=n.element.querySelector(e);t&&window.requestAnimationFrame((function(){return n.checkFocus(t)}))}})),!(t instanceof HTMLElement))throw new TypeError("Invalid parameter: element must be an HTMLElement");this.element=t,this.options=r,window.addEventListener("keydown",this.handleKeyDown,!1),this.setFocus()})),Ut=function(e){Ze(n,e);var t=Ge(n);function n(e){var r;if(Me(this,n),Ke(qe(r=t.call(this,e)),"setBeaconRef",(function(e){r.beacon=e})),!e.beaconComponent){var i=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css",o.id="joyride-beacon-animation",void 0!==e.nonce&&o.setAttribute("nonce",e.nonce),o.appendChild(document.createTextNode("\n        @keyframes joyride-beacon-inner {\n          20% {\n            opacity: 0.9;\n          }\n        \n          90% {\n            opacity: 0.7;\n          }\n        }\n        \n        @keyframes joyride-beacon-outer {\n          0% {\n            transform: scale(1);\n          }\n        \n          45% {\n            opacity: 0.7;\n            transform: scale(0.75);\n          }\n        \n          100% {\n            opacity: 0.9;\n            transform: scale(1);\n          }\n        }\n      ")),i.appendChild(o)}return r}return Fe(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.shouldFocus;setTimeout((function(){L.domElement(e.beacon)&&t&&e.beacon.focus()}),0)}},{key:"componentWillUnmount",value:function(){var e=document.getElementById("joyride-beacon-animation");e&&e.parentNode.removeChild(e)}},{key:"render",value:function(){var e,t=this.props,n=t.beaconComponent,i=t.locale,o=t.onClickOrHover,s=t.styles,a={"aria-label":i.open,onClick:o,onMouseEnter:o,ref:this.setBeaconRef,title:i.open};if(n){var c=n;e=r.createElement(c,a)}else e=r.createElement("button",je({key:"JoyrideBeacon",className:"react-joyride__beacon",style:s.beacon,type:"button"},a),r.createElement("span",{style:s.beaconInner}),r.createElement("span",{style:s.beaconOuter}));return e}}]),n}(r.Component);function Ft(e){var t=e.styles;return r.createElement("div",{key:"JoyrideSpotlight",className:"react-joyride__spotlight",style:t})}var Kt=["mixBlendMode","zIndex"],jt=function(e){Ze(n,e);var t=Ge(n);function n(){var e;Me(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ke(qe(e=t.call.apply(t,[this].concat(i))),"_isMounted",!1),Ke(qe(e),"state",{mouseOverSpotlight:!1,isScrolling:!1,showSpotlight:!0}),Ke(qe(e),"handleMouseMove",(function(t){var n=e.state.mouseOverSpotlight,r=e.spotlightStyles,i=r.height,o=r.left,s=r.position,a=r.top,c=r.width,l="fixed"===s?t.clientY:t.pageY,u="fixed"===s?t.clientX:t.pageX,h=u>=o&&u<=o+c&&(l>=a&&l<=a+i);h!==n&&e.updateState({mouseOverSpotlight:h})})),Ke(qe(e),"handleScroll",(function(){var t=At(e.props.target);e.scrollParent!==document?(e.state.isScrolling||e.updateState({isScrolling:!0,showSpotlight:!1}),clearTimeout(e.scrollTimeout),e.scrollTimeout=setTimeout((function(){e.updateState({isScrolling:!1,showSpotlight:!0})}),50)):It(t,"sticky")&&e.updateState({})})),Ke(qe(e),"handleResize",(function(){clearTimeout(e.resizeTimeout),e.resizeTimeout=setTimeout((function(){e._isMounted&&e.forceUpdate()}),100)})),e}return Fe(n,[{key:"componentDidMount",value:function(){var e=this.props;e.debug,e.disableScrolling;var t=e.disableScrollParentFix,n=At(e.target);this.scrollParent=St(n,t,!0),this._isMounted=!0,window.addEventListener("resize",this.handleResize)}},{key:"componentDidUpdate",value:function(e){var t=this,n=this.props,r=n.lifecycle,i=n.spotlightClicks,o=k(e,this.props).changed;o("lifecycle",it.TOOLTIP)&&(this.scrollParent.addEventListener("scroll",this.handleScroll,{passive:!0}),setTimeout((function(){t.state.isScrolling||t.updateState({showSpotlight:!0})}),100)),(o("spotlightClicks")||o("disableOverlay")||o("lifecycle"))&&(i&&r===it.TOOLTIP?window.addEventListener("mousemove",this.handleMouseMove,!1):r!==it.TOOLTIP&&window.removeEventListener("mousemove",this.handleMouseMove))}},{key:"componentWillUnmount",value:function(){this._isMounted=!1,window.removeEventListener("mousemove",this.handleMouseMove),window.removeEventListener("resize",this.handleResize),clearTimeout(this.resizeTimeout),clearTimeout(this.scrollTimeout),this.scrollParent.removeEventListener("scroll",this.handleScroll)}},{key:"spotlightStyles",get:function(){var e=this.state.showSpotlight,t=this.props,n=t.disableScrollParentFix,r=t.spotlightClicks,i=t.spotlightPadding,o=t.styles,s=At(t.target),a=wt(s),c=It(s),l=function(e,t,n){var r=wt(e),i=St(e,n),o=_t(e,n),s=0;i instanceof HTMLElement&&(s=i.scrollTop);var a=r.top+(o||It(e)?0:s);return Math.floor(a-t)}(s,i,n);return Le(Le({},gt()?o.spotlightLegacy:o.spotlight),{},{height:Math.round(a.height+2*i),left:Math.round(a.left-i),opacity:e?1:0,pointerEvents:r?"none":"auto",position:c?"fixed":"absolute",top:l,transition:"opacity 0.2s",width:Math.round(a.width+2*i)})}},{key:"updateState",value:function(e){this._isMounted&&this.setState(e)}},{key:"render",value:function(){var e=this.state,t=e.mouseOverSpotlight,n=e.showSpotlight,i=this.props,o=i.disableOverlay,s=i.disableOverlayClose,a=i.lifecycle,c=i.onClickOverlay,l=i.placement,u=i.styles;if(o||a!==it.TOOLTIP)return null;var h=u.overlay;gt()&&(h="center"===l?u.overlayLegacyCenter:u.overlayLegacy);var d=Le({cursor:s?"default":"pointer",height:Et(),pointerEvents:t?"none":"auto"},h),f="center"!==l&&n&&r.createElement(Ft,{styles:this.spotlightStyles});if("safari"===ct()){d.mixBlendMode,d.zIndex;var p=He(d,Kt);f=r.createElement("div",{style:Le({},p)},f),delete d.backgroundColor}return r.createElement("div",{className:"react-joyride__overlay",style:d,onClick:c},f)}}]),n}(r.Component),Zt=["styles"],zt=["color","height","width"];function Vt(e){var t=e.styles,n=He(e,Zt),i=t.color,o=t.height,s=t.width,a=He(t,zt);return r.createElement("button",je({style:a,type:"button"},n),r.createElement("svg",{width:"number"===typeof s?"".concat(s,"px"):s,height:"number"===typeof o?"".concat(o,"px"):o,viewBox:"0 0 18 18",version:"1.1",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMidYMid"},r.createElement("g",null,r.createElement("path",{d:"M8.13911129,9.00268191 L0.171521827,17.0258467 C-0.0498027049,17.248715 -0.0498027049,17.6098394 0.171521827,17.8327545 C0.28204354,17.9443526 0.427188206,17.9998706 0.572051765,17.9998706 C0.71714958,17.9998706 0.862013139,17.9443526 0.972581703,17.8327545 L9.0000937,9.74924618 L17.0276057,17.8327545 C17.1384085,17.9443526 17.2832721,17.9998706 17.4281356,17.9998706 C17.5729992,17.9998706 17.718097,17.9443526 17.8286656,17.8327545 C18.0499901,17.6098862 18.0499901,17.2487618 17.8286656,17.0258467 L9.86135722,9.00268191 L17.8340066,0.973848225 C18.0553311,0.750979934 18.0553311,0.389855532 17.8340066,0.16694039 C17.6126821,-0.0556467968 17.254037,-0.0556467968 17.0329467,0.16694039 L9.00042166,8.25611765 L0.967006424,0.167268345 C0.745681892,-0.0553188426 0.387317931,-0.0553188426 0.165993399,0.167268345 C-0.0553311331,0.390136635 -0.0553311331,0.751261038 0.165993399,0.974176179 L8.13920499,9.00268191 L8.13911129,9.00268191 Z",fill:i}))))}var Ht=function(e){Ze(n,e);var t=Ge(n);function n(){return Me(this,n),t.apply(this,arguments)}return Fe(n,[{key:"render",value:function(){var e=this.props,t=e.backProps,n=e.closeProps,i=e.continuous,o=e.index,s=e.isLastStep,a=e.primaryProps,c=e.size,l=e.skipProps,u=e.step,h=e.tooltipProps,d=u.content,f=u.hideBackButton,p=u.hideCloseButton,g=u.hideFooter,y=u.showProgress,m=u.showSkipButton,v=u.title,b=u.styles,w=u.locale,E=w.back,A=w.close,S=w.last,_=w.next,I=w.skip,C={primary:A};return i&&(C.primary=s?S:_,y&&(C.primary=r.createElement("span",null,C.primary," (",o+1,"/",c,")"))),m&&!s&&(C.skip=r.createElement("button",je({style:b.buttonSkip,type:"button","aria-live":"off"},l),I)),!f&&o>0&&(C.back=r.createElement("button",je({style:b.buttonBack,type:"button"},t),E)),C.close=!p&&r.createElement(Vt,je({styles:b.buttonClose},n)),r.createElement("div",je({key:"JoyrideTooltip",className:"react-joyride__tooltip",style:b.tooltip},h),r.createElement("div",{style:b.tooltipContainer},v&&r.createElement("h4",{style:b.tooltipTitle,"aria-label":v},v),r.createElement("div",{style:b.tooltipContent},d)),!g&&r.createElement("div",{style:b.tooltipFooter},r.createElement("div",{style:b.tooltipFooterSpacer},C.skip),C.back,r.createElement("button",je({style:b.buttonNext,type:"button"},a),C.primary)),C.close)}}]),n}(r.Component),qt=["beaconComponent","tooltipComponent"],Gt=function(e){Ze(n,e);var t=Ge(n);function n(){var e;Me(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ke(qe(e=t.call.apply(t,[this].concat(i))),"handleClickBack",(function(t){t.preventDefault(),e.props.helpers.prev()})),Ke(qe(e),"handleClickClose",(function(t){t.preventDefault(),e.props.helpers.close()})),Ke(qe(e),"handleClickPrimary",(function(t){t.preventDefault();var n=e.props,r=n.continuous,i=n.helpers;r?i.next():i.close()})),Ke(qe(e),"handleClickSkip",(function(t){t.preventDefault(),e.props.helpers.skip()})),Ke(qe(e),"getElementsProps",(function(){var t=e.props,n=t.continuous,r=t.isLastStep,i=t.setTooltipRef,o=t.step,s=ut(o.locale.back),a=ut(o.locale.close),c=ut(o.locale.last),l=ut(o.locale.next),u=ut(o.locale.skip),h=n?l:a;return r&&(h=c),{backProps:{"aria-label":s,"data-action":"back",onClick:e.handleClickBack,role:"button",title:s},closeProps:{"aria-label":a,"data-action":"close",onClick:e.handleClickClose,role:"button",title:a},primaryProps:{"aria-label":h,"data-action":"primary",onClick:e.handleClickPrimary,role:"button",title:h},skipProps:{"aria-label":u,"data-action":"skip",onClick:e.handleClickSkip,role:"button",title:u},tooltipProps:{"aria-modal":!0,ref:i,role:"alertdialog"}}})),e}return Fe(n,[{key:"render",value:function(){var e=this.props,t=e.continuous,n=e.index,i=e.isLastStep,o=e.size,s=e.step;s.beaconComponent;var a,c=s.tooltipComponent,l=He(s,qt);if(c){var u=Le(Le({},this.getElementsProps()),{},{continuous:t,index:n,isLastStep:i,size:o,step:l}),h=c;a=r.createElement(h,u)}else a=r.createElement(Ht,je({},this.getElementsProps(),{continuous:t,index:n,isLastStep:i,size:o,step:s}));return a}}]),n}(r.Component),Wt=function(e){Ze(n,e);var t=Ge(n);function n(){return Me(this,n),t.apply(this,arguments)}return Fe(n,[{key:"componentDidMount",value:function(){st&&(at||this.renderReact15())}},{key:"componentDidUpdate",value:function(){st&&(at||this.renderReact15())}},{key:"componentWillUnmount",value:function(){st&&this.node&&(at||M.unmountComponentAtNode(this.node),this.node.parentNode===document.body&&(document.body.removeChild(this.node),this.node=void 0))}},{key:"appendNode",value:function(){var e=this.props.id;this.node||(this.node=document.createElement("div"),e&&(this.node.id=e),document.body.appendChild(this.node))}},{key:"renderReact15",value:function(){if(!st)return null;var e=this.props.children;return this.node||this.appendNode(),M.unstable_renderSubtreeIntoContainer(this,e,this.node),null}},{key:"renderReact16",value:function(){if(!st||!at)return null;var e=this.props.children;return this.node||this.appendNode(),M.createPortal(e,this.node)}},{key:"render",value:function(){return at?this.renderReact16():null}}]),n}(r.Component),Qt=function(e){Ze(n,e);var t=Ge(n);function n(){var e;Me(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ke(qe(e=t.call.apply(t,[this].concat(i))),"scope",{removeScope:function(){}}),Ke(qe(e),"handleClickHoverBeacon",(function(t){var n=e.props,r=n.step,i=n.update;"mouseenter"===t.type&&"hover"!==r.event||i({lifecycle:it.TOOLTIP})})),Ke(qe(e),"handleClickOverlay",(function(){var t=e.props,n=t.helpers;t.step.disableOverlayClose||n.close()})),Ke(qe(e),"setTooltipRef",(function(t){e.tooltip=t})),Ke(qe(e),"setPopper",(function(t,n){var r=e.props,i=r.action,o=r.setPopper,s=r.update;"wrapper"===n?e.beaconPopper=t:e.tooltipPopper=t,o(t,n),e.beaconPopper&&e.tooltipPopper&&s({action:i===Qe.CLOSE?Qe.CLOSE:i,lifecycle:it.READY})})),e}return Fe(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.debug,n=e.index;yt({title:"step:".concat(n),data:[{key:"props",value:this.props}],debug:t})}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.action,r=t.callback,i=t.continuous,o=t.controlled,s=t.debug,a=t.index,c=t.lifecycle,l=t.size,u=t.status,h=t.step,d=t.update,f=k(e,this.props),p=f.changed,g=f.changedFrom,y={action:n,controlled:o,index:a,lifecycle:c,size:l,status:u},m=i&&n!==Qe.CLOSE&&(a>0||n===Qe.PREV),v=p("action")||p("index")||p("lifecycle")||p("status"),b=g("lifecycle",[it.TOOLTIP,it.INIT],it.INIT);if(p("action",[Qe.NEXT,Qe.PREV,Qe.SKIP,Qe.CLOSE])&&(b||o)&&r(Le(Le({},y),{},{index:e.index,lifecycle:it.COMPLETE,step:e.step,type:et})),"center"===h.placement&&u===ot.RUNNING&&p("index")&&n!==Qe.START&&c===it.INIT&&d({lifecycle:it.READY}),v){var w=At(h.target),E=!!w,A=E&&function(e){if(!e)return!1;for(var t=e;t&&t!==document.body;){if(t instanceof HTMLElement){var n=getComputedStyle(t),r=n.display,i=n.visibility;if("none"===r||"hidden"===i)return!1}t=t.parentNode}return!0}(w);A?(g("status",ot.READY,ot.RUNNING)||g("lifecycle",it.INIT,it.READY))&&r(Le(Le({},y),{},{step:h,type:Je})):(console.warn(E?"Target not visible":"Target not mounted",h),r(Le(Le({},y),{},{type:rt,step:h})),o||d({index:a+(-1!==[Qe.PREV].indexOf(n)?-1:1)}))}g("lifecycle",it.INIT,it.READY)&&d({lifecycle:ft(h)||m?it.TOOLTIP:it.BEACON}),p("index")&&yt({title:"step:".concat(c),data:[{key:"props",value:this.props}],debug:s}),p("lifecycle",it.BEACON)&&r(Le(Le({},y),{},{step:h,type:Xe})),p("lifecycle",it.TOOLTIP)&&(r(Le(Le({},y),{},{step:h,type:$e})),this.scope=new Mt(this.tooltip,{selector:"[data-action=primary]"}),this.scope.setFocus()),g("lifecycle",[it.TOOLTIP,it.INIT],it.INIT)&&(this.scope.removeScope(),delete this.beaconPopper,delete this.tooltipPopper)}},{key:"componentWillUnmount",value:function(){this.scope.removeScope()}},{key:"open",get:function(){var e=this.props,t=e.step,n=e.lifecycle;return!(!ft(t)&&n!==it.TOOLTIP)}},{key:"render",value:function(){var e=this.props,t=e.continuous,n=e.debug,i=e.helpers,o=e.index,s=e.lifecycle,a=e.nonce,c=e.shouldScroll,l=e.size,u=e.step,h=At(u.target);return Bt(u)&&L.domElement(h)?r.createElement("div",{key:"JoyrideStep-".concat(o),className:"react-joyride__step"},r.createElement(Wt,{id:"react-joyride-portal"},r.createElement(jt,je({},u,{debug:n,lifecycle:s,onClickOverlay:this.handleClickOverlay}))),r.createElement(Ne,je({component:r.createElement(Gt,{continuous:t,helpers:i,index:o,isLastStep:o+1===l,setTooltipRef:this.setTooltipRef,size:l,step:u}),debug:n,getPopper:this.setPopper,id:"react-joyride-step-".concat(o),isPositioned:u.isFixed||It(h),open:this.open,placement:u.placement,target:u.target},u.floaterProps),r.createElement(Ut,{beaconComponent:u.beaconComponent,locale:u.locale,nonce:a,onClickOrHover:this.handleClickHoverBeacon,shouldFocus:c,styles:u.styles}))):null}}]),n}(r.Component),Yt=function(e){Ze(n,e);var t=Ge(n);function n(e){var r;return Me(this,n),Ke(qe(r=t.call(this,e)),"initStore",(function(){var e=r.props,t=e.debug,n=e.getHelpers,i=e.run,o=e.stepIndex;r.store=new bt(Le(Le({},r.props),{},{controlled:i&&L.number(o)})),r.helpers=r.store.getHelpers();var s=r.store.addListener;return yt({title:"init",data:[{key:"props",value:r.props},{key:"state",value:r.state}],debug:t}),s(r.syncState),n(r.helpers),r.store.getState()})),Ke(qe(r),"callback",(function(e){var t=r.props.callback;L.function(t)&&t(e)})),Ke(qe(r),"handleKeyboard",(function(e){var t=r.state,n=t.index,i=t.lifecycle,o=r.props.steps[n],s=window.Event?e.which:e.keyCode;i===it.TOOLTIP&&27===s&&o&&!o.disableCloseOnEsc&&r.store.close()})),Ke(qe(r),"syncState",(function(e){r.setState(e)})),Ke(qe(r),"setPopper",(function(e,t){"wrapper"===t?r.beaconPopper=e:r.tooltipPopper=e})),Ke(qe(r),"shouldScroll",(function(e,t,n,r,i,o,s){return!e&&(0!==t||n||r===it.TOOLTIP)&&"center"!==i.placement&&(!i.isFixed||!It(o))&&s.lifecycle!==r&&-1!==[it.BEACON,it.TOOLTIP].indexOf(r)})),r.state=r.initStore(),r}return Fe(n,[{key:"componentDidMount",value:function(){if(st){var e=this.props,t=e.disableCloseOnEsc,n=e.debug,r=e.run,i=e.steps,o=this.store.start;Lt(i,n)&&r&&o(),t||document.body.addEventListener("keydown",this.handleKeyboard,{passive:!0})}}},{key:"componentDidUpdate",value:function(e,t){if(st){var n=this.state,r=n.action,i=n.controlled,o=n.index,s=n.lifecycle,a=n.status,c=this.props,l=c.debug,u=c.run,h=c.stepIndex,d=c.steps,f=e.steps,p=e.stepIndex,g=this.store,y=g.reset,m=g.setSteps,v=g.start,b=g.stop,w=g.update,E=k(e,this.props).changed,A=k(t,this.state),S=A.changed,_=A.changedFrom,I=Nt(d[o],this.props),C=!pt(f,d),T=L.number(h)&&E("stepIndex"),R=At(null===I||void 0===I?void 0:I.target);if(C&&(Lt(d,l)?m(d):console.warn("Steps are not valid",d)),E("run")&&(u?v(h):b()),T){var x=p<h?Qe.NEXT:Qe.PREV;r===Qe.STOP&&(x=Qe.START),-1===[ot.FINISHED,ot.SKIPPED].indexOf(a)&&w({action:r===Qe.CLOSE?Qe.CLOSE:x,index:h,lifecycle:it.INIT})}i||a!==ot.RUNNING||0!==o||R||(w({index:o+1}),this.callback(Le(Le({},this.state),{},{type:rt,step:I})));var P=Le(Le({},this.state),{},{index:o,step:I});if(S("action",[Qe.NEXT,Qe.PREV,Qe.SKIP,Qe.CLOSE])&&S("status",ot.PAUSED)){var D=Nt(d[t.index],this.props);this.callback(Le(Le({},P),{},{index:t.index,lifecycle:it.COMPLETE,step:D,type:et}))}if(S("status",[ot.FINISHED,ot.SKIPPED])){var O=Nt(d[t.index],this.props);i||this.callback(Le(Le({},P),{},{index:t.index,lifecycle:it.COMPLETE,step:O,type:et})),this.callback(Le(Le({},P),{},{index:t.index,step:O,type:tt})),y()}else _("status",[ot.IDLE,ot.READY],ot.RUNNING)?this.callback(Le(Le({},P),{},{type:Ye})):(S("status")||S("action",Qe.RESET))&&this.callback(Le(Le({},P),{},{type:nt}));I&&(this.scrollToStep(t),"center"===I.placement&&a===ot.RUNNING&&r===Qe.START&&s===it.INIT&&w({lifecycle:it.READY}))}}},{key:"componentWillUnmount",value:function(){this.props.disableCloseOnEsc||document.body.removeEventListener("keydown",this.handleKeyboard)}},{key:"scrollToStep",value:function(e){var t=this.state,n=t.index,r=t.lifecycle,i=t.status,o=this.props,s=o.debug,a=o.disableScrollParentFix,c=o.scrollToFirstStep,l=o.scrollOffset,u=o.scrollDuration,h=Nt(o.steps[n],this.props);if(h){var d=At(h.target),f=this.shouldScroll(h.disableScrolling,n,c,r,h,d,e);if(i===ot.RUNNING&&f){var p=_t(d,a),g=St(d,a),y=Math.floor(Tt(d,l,a))||0;if(yt({title:"scrollToStep",data:[{key:"index",value:n},{key:"lifecycle",value:r},{key:"status",value:i}],debug:s}),r===it.BEACON&&this.beaconPopper){var m=this.beaconPopper,v=m.placement,b=m.popper;-1!==["bottom"].indexOf(v)||p||(y=Math.floor(b.top-l))}else if(r===it.TOOLTIP&&this.tooltipPopper){var w=this.tooltipPopper,E=w.flipped,A=w.placement,S=w.popper;-1===["top","right","left"].indexOf(A)||E||p?y-=h.spotlightPadding:y=Math.floor(S.top-l)}y=y>=0?y:0,i===ot.RUNNING&&function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:kt(),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:300;new Promise((function(r,i){var o=t.scrollTop,s=e>o?e-o:o-e;j().top(t,e,{duration:s<100?50:n},(function(e){return e&&"Element already at target scroll position"!==e.message?i(e):r()}))}))}(y,g,u)}}}},{key:"render",value:function(){if(!st)return null;var e,t=this.state,n=t.index,i=t.status,o=this.props,s=o.continuous,a=o.debug,c=o.nonce,l=o.scrollToFirstStep,u=Nt(o.steps[n],this.props);return i===ot.RUNNING&&u&&(e=r.createElement(Qt,je({},this.state,{callback:this.callback,continuous:s,debug:a,setPopper:this.setPopper,helpers:this.helpers,nonce:c,shouldScroll:!u.disableScrolling&&(0!==n||l),step:u,update:this.store.update}))),r.createElement("div",{className:"react-joyride"},e)}}]),n}(r.Component);Ke(Yt,"defaultProps",{continuous:!1,debug:!1,disableCloseOnEsc:!1,disableOverlay:!1,disableOverlayClose:!1,disableScrolling:!1,disableScrollParentFix:!1,getHelpers:function(){},hideBackButton:!1,run:!0,scrollOffset:20,scrollDuration:300,scrollToFirstStep:!1,showSkipButton:!1,showProgress:!1,spotlightClicks:!1,spotlightPadding:10,steps:[]})},23688:(e,t,n)=>{"use strict";function r(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);null!==e&&void 0!==e&&this.setState(e)}function i(e){this.setState(function(t){var n=this.constructor.getDerivedStateFromProps(e,t);return null!==n&&void 0!==n?n:null}.bind(this))}function o(e,t){try{var n=this.props,r=this.state;this.props=e,this.state=t,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(n,r)}finally{this.props=n,this.state=r}}function s(e){var t=e.prototype;if(!t||!t.isReactComponent)throw new Error("Can only polyfill class components");if("function"!==typeof e.getDerivedStateFromProps&&"function"!==typeof t.getSnapshotBeforeUpdate)return e;var n=null,s=null,a=null;if("function"===typeof t.componentWillMount?n="componentWillMount":"function"===typeof t.UNSAFE_componentWillMount&&(n="UNSAFE_componentWillMount"),"function"===typeof t.componentWillReceiveProps?s="componentWillReceiveProps":"function"===typeof t.UNSAFE_componentWillReceiveProps&&(s="UNSAFE_componentWillReceiveProps"),"function"===typeof t.componentWillUpdate?a="componentWillUpdate":"function"===typeof t.UNSAFE_componentWillUpdate&&(a="UNSAFE_componentWillUpdate"),null!==n||null!==s||null!==a){var c=e.displayName||e.name,l="function"===typeof e.getDerivedStateFromProps?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error("Unsafe legacy lifecycles will not be called for components using new component APIs.\n\n"+c+" uses "+l+" but also contains the following legacy lifecycles:"+(null!==n?"\n  "+n:"")+(null!==s?"\n  "+s:"")+(null!==a?"\n  "+a:"")+"\n\nThe above lifecycles should be removed. Learn more about this warning here:\nhttps://fb.me/react-async-component-lifecycle-hooks")}if("function"===typeof e.getDerivedStateFromProps&&(t.componentWillMount=r,t.componentWillReceiveProps=i),"function"===typeof t.getSnapshotBeforeUpdate){if("function"!==typeof t.componentDidUpdate)throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");t.componentWillUpdate=o;var u=t.componentDidUpdate;t.componentDidUpdate=function(e,t,n){var r=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:n;u.call(this,e,t,r)}}return e}n.d(t,{O:()=>s}),r.__suppressDeprecationWarning=!0,i.__suppressDeprecationWarning=!0,o.__suppressDeprecationWarning=!0},77156:(e,t)=>{"use strict";t.Z=function(e,t,n){return function(e,t){if("function"!=typeof e)throw new TypeError("The typeValidator argument must be a function with the signature function(props, propName, componentName).");if(t&&"string"!=typeof t)throw new TypeError("The error message is optional, but must be a string if provided.")}(e,n),function(r,i,o){for(var s=arguments.length,a=Array(3<s?s-3:0),c=3;c<s;c++)a[c-3]=arguments[c];return function(e,t,n,r){return"boolean"==typeof e?e:"function"==typeof e?e(t,n,r):!(!0!==!!e)&&!!e}(t,r,i,o)?function(e,t){return Object.hasOwnProperty.call(e,t)}(r,i)?e.apply(void 0,[r,i,o].concat(a)):function(e,t,n,r){return r?new Error(r):new Error("Required "+e[t]+" `"+t+"` was not specified in `"+n+"`.")}(r,i,o,n):e.apply(void 0,[r,i,o].concat(a))}}},39475:(e,t,n)=>{"use strict";function r(e){return e&&"object"===typeof e&&"default"in e?e.default:e}var i=n(72791),o=r(i),s=r(n(79613));function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c=!("undefined"===typeof window||!window.document||!window.document.createElement);e.exports=function(e,t,n){if("function"!==typeof e)throw new Error("Expected reducePropsToState to be a function.");if("function"!==typeof t)throw new Error("Expected handleStateChangeOnClient to be a function.");if("undefined"!==typeof n&&"function"!==typeof n)throw new Error("Expected mapStateOnServer to either be undefined or a function.");return function(r){if("function"!==typeof r)throw new Error("Expected WrappedComponent to be a React component.");var l,u=[];function h(){l=e(u.map((function(e){return e.props}))),d.canUseDOM?t(l):n&&(l=n(l))}var d=function(e){var t,n;function i(){return e.apply(this,arguments)||this}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i.peek=function(){return l},i.rewind=function(){if(i.canUseDOM)throw new Error("You may only call rewind() on the server. Call peek() to read the current state.");var e=l;return l=void 0,u=[],e};var a=i.prototype;return a.shouldComponentUpdate=function(e){return!s(e,this.props)},a.componentWillMount=function(){u.push(this),h()},a.componentDidUpdate=function(){h()},a.componentWillUnmount=function(){var e=u.indexOf(this);u.splice(e,1),h()},a.render=function(){return o.createElement(r,this.props)},i}(i.Component);return a(d,"displayName","SideEffect("+function(e){return e.displayName||e.name||"Component"}(r)+")"),a(d,"canUseDOM",c),d}}},4775:(e,t,n)=>{"use strict";n.d(t,{qj:()=>W,sg:()=>Ye,aV:()=>ye,Sr:()=>qe,iA:()=>$e,_K:()=>yt});var r=n(6610),i=n(5991),o=n(46070),s=n(77608),a=n(63349),c=n(10379),l=n(96156),u=n(72791),h=n(23688),d=n(22122);function f(e){var t,n,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=f(e[t]))&&(r&&(r+=" "),r+=n);else for(t in e)e[t]&&(r&&(r+=" "),r+=t);return r}const p=function(){for(var e,t,n=0,r="";n<arguments.length;)(e=arguments[n++])&&(t=f(e))&&(r&&(r+=" "),r+=t);return r};function g(e){var t=e.cellCount,n=e.cellSize,r=e.computeMetadataCallback,i=e.computeMetadataCallbackProps,o=e.nextCellsCount,s=e.nextCellSize,a=e.nextScrollToIndex,c=e.scrollToIndex,l=e.updateScrollOffsetForScrollToIndex;t===o&&("number"!==typeof n&&"number"!==typeof s||n===s)||(r(i),c>=0&&c===a&&l())}var y=n(81253),m=function(){function e(t){var n=t.cellCount,i=t.cellSizeGetter,o=t.estimatedCellSize;(0,r.Z)(this,e),(0,l.Z)(this,"_cellSizeAndPositionData",{}),(0,l.Z)(this,"_lastMeasuredIndex",-1),(0,l.Z)(this,"_lastBatchedIndex",-1),(0,l.Z)(this,"_cellCount",void 0),(0,l.Z)(this,"_cellSizeGetter",void 0),(0,l.Z)(this,"_estimatedCellSize",void 0),this._cellSizeGetter=i,this._cellCount=n,this._estimatedCellSize=o}return(0,i.Z)(e,[{key:"areOffsetsAdjusted",value:function(){return!1}},{key:"configure",value:function(e){var t=e.cellCount,n=e.estimatedCellSize,r=e.cellSizeGetter;this._cellCount=t,this._estimatedCellSize=n,this._cellSizeGetter=r}},{key:"getCellCount",value:function(){return this._cellCount}},{key:"getEstimatedCellSize",value:function(){return this._estimatedCellSize}},{key:"getLastMeasuredIndex",value:function(){return this._lastMeasuredIndex}},{key:"getOffsetAdjustment",value:function(){return 0}},{key:"getSizeAndPositionOfCell",value:function(e){if(e<0||e>=this._cellCount)throw Error("Requested index ".concat(e," is outside of range 0..").concat(this._cellCount));if(e>this._lastMeasuredIndex)for(var t=this.getSizeAndPositionOfLastMeasuredCell(),n=t.offset+t.size,r=this._lastMeasuredIndex+1;r<=e;r++){var i=this._cellSizeGetter({index:r});if(void 0===i||isNaN(i))throw Error("Invalid size returned for cell ".concat(r," of value ").concat(i));null===i?(this._cellSizeAndPositionData[r]={offset:n,size:0},this._lastBatchedIndex=e):(this._cellSizeAndPositionData[r]={offset:n,size:i},n+=i,this._lastMeasuredIndex=e)}return this._cellSizeAndPositionData[e]}},{key:"getSizeAndPositionOfLastMeasuredCell",value:function(){return this._lastMeasuredIndex>=0?this._cellSizeAndPositionData[this._lastMeasuredIndex]:{offset:0,size:0}}},{key:"getTotalSize",value:function(){var e=this.getSizeAndPositionOfLastMeasuredCell();return e.offset+e.size+(this._cellCount-this._lastMeasuredIndex-1)*this._estimatedCellSize}},{key:"getUpdatedOffsetForIndex",value:function(e){var t=e.align,n=void 0===t?"auto":t,r=e.containerSize,i=e.currentOffset,o=e.targetIndex;if(r<=0)return 0;var s,a=this.getSizeAndPositionOfCell(o),c=a.offset,l=c-r+a.size;switch(n){case"start":s=c;break;case"end":s=l;break;case"center":s=c-(r-a.size)/2;break;default:s=Math.max(l,Math.min(c,i))}var u=this.getTotalSize();return Math.max(0,Math.min(u-r,s))}},{key:"getVisibleCellRange",value:function(e){var t=e.containerSize,n=e.offset;if(0===this.getTotalSize())return{};var r=n+t,i=this._findNearestCell(n),o=this.getSizeAndPositionOfCell(i);n=o.offset+o.size;for(var s=i;n<r&&s<this._cellCount-1;)s++,n+=this.getSizeAndPositionOfCell(s).size;return{start:i,stop:s}}},{key:"resetCell",value:function(e){this._lastMeasuredIndex=Math.min(this._lastMeasuredIndex,e-1)}},{key:"_binarySearch",value:function(e,t,n){for(;t<=e;){var r=t+Math.floor((e-t)/2),i=this.getSizeAndPositionOfCell(r).offset;if(i===n)return r;i<n?t=r+1:i>n&&(e=r-1)}return t>0?t-1:0}},{key:"_exponentialSearch",value:function(e,t){for(var n=1;e<this._cellCount&&this.getSizeAndPositionOfCell(e).offset<t;)e+=n,n*=2;return this._binarySearch(Math.min(e,this._cellCount-1),Math.floor(e/2),t)}},{key:"_findNearestCell",value:function(e){if(isNaN(e))throw Error("Invalid offset ".concat(e," specified"));e=Math.max(0,e);var t=this.getSizeAndPositionOfLastMeasuredCell(),n=Math.max(0,this._lastMeasuredIndex);return t.offset>=e?this._binarySearch(n,0,e):this._exponentialSearch(n,e)}}]),e}(),v=function(){return"undefined"!==typeof window&&window.chrome?16777100:15e5},b=function(){function e(t){var n=t.maxScrollSize,i=void 0===n?v():n,o=(0,y.Z)(t,["maxScrollSize"]);(0,r.Z)(this,e),(0,l.Z)(this,"_cellSizeAndPositionManager",void 0),(0,l.Z)(this,"_maxScrollSize",void 0),this._cellSizeAndPositionManager=new m(o),this._maxScrollSize=i}return(0,i.Z)(e,[{key:"areOffsetsAdjusted",value:function(){return this._cellSizeAndPositionManager.getTotalSize()>this._maxScrollSize}},{key:"configure",value:function(e){this._cellSizeAndPositionManager.configure(e)}},{key:"getCellCount",value:function(){return this._cellSizeAndPositionManager.getCellCount()}},{key:"getEstimatedCellSize",value:function(){return this._cellSizeAndPositionManager.getEstimatedCellSize()}},{key:"getLastMeasuredIndex",value:function(){return this._cellSizeAndPositionManager.getLastMeasuredIndex()}},{key:"getOffsetAdjustment",value:function(e){var t=e.containerSize,n=e.offset,r=this._cellSizeAndPositionManager.getTotalSize(),i=this.getTotalSize(),o=this._getOffsetPercentage({containerSize:t,offset:n,totalSize:i});return Math.round(o*(i-r))}},{key:"getSizeAndPositionOfCell",value:function(e){return this._cellSizeAndPositionManager.getSizeAndPositionOfCell(e)}},{key:"getSizeAndPositionOfLastMeasuredCell",value:function(){return this._cellSizeAndPositionManager.getSizeAndPositionOfLastMeasuredCell()}},{key:"getTotalSize",value:function(){return Math.min(this._maxScrollSize,this._cellSizeAndPositionManager.getTotalSize())}},{key:"getUpdatedOffsetForIndex",value:function(e){var t=e.align,n=void 0===t?"auto":t,r=e.containerSize,i=e.currentOffset,o=e.targetIndex;i=this._safeOffsetToOffset({containerSize:r,offset:i});var s=this._cellSizeAndPositionManager.getUpdatedOffsetForIndex({align:n,containerSize:r,currentOffset:i,targetIndex:o});return this._offsetToSafeOffset({containerSize:r,offset:s})}},{key:"getVisibleCellRange",value:function(e){var t=e.containerSize,n=e.offset;return n=this._safeOffsetToOffset({containerSize:t,offset:n}),this._cellSizeAndPositionManager.getVisibleCellRange({containerSize:t,offset:n})}},{key:"resetCell",value:function(e){this._cellSizeAndPositionManager.resetCell(e)}},{key:"_getOffsetPercentage",value:function(e){var t=e.containerSize,n=e.offset,r=e.totalSize;return r<=t?0:n/(r-t)}},{key:"_offsetToSafeOffset",value:function(e){var t=e.containerSize,n=e.offset,r=this._cellSizeAndPositionManager.getTotalSize(),i=this.getTotalSize();if(r===i)return n;var o=this._getOffsetPercentage({containerSize:t,offset:n,totalSize:r});return Math.round(o*(i-t))}},{key:"_safeOffsetToOffset",value:function(e){var t=e.containerSize,n=e.offset,r=this._cellSizeAndPositionManager.getTotalSize(),i=this.getTotalSize();if(r===i)return n;var o=this._getOffsetPercentage({containerSize:t,offset:n,totalSize:i});return Math.round(o*(r-t))}}]),e}();function w(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t={};return function(n){var r=n.callback,i=n.indices,o=Object.keys(i),s=!e||o.every((function(e){var t=i[e];return Array.isArray(t)?t.length>0:t>=0})),a=o.length!==Object.keys(t).length||o.some((function(e){var n=t[e],r=i[e];return Array.isArray(r)?n.join(",")!==r.join(","):n!==r}));t=i,s&&a&&r(i)}}function E(e){var t=e.cellSize,n=e.cellSizeAndPositionManager,r=e.previousCellsCount,i=e.previousCellSize,o=e.previousScrollToAlignment,s=e.previousScrollToIndex,a=e.previousSize,c=e.scrollOffset,l=e.scrollToAlignment,u=e.scrollToIndex,h=e.size,d=e.sizeJustIncreasedFromZero,f=e.updateScrollIndexCallback,p=n.getCellCount(),g=u>=0&&u<p;g&&(h!==a||d||!i||"number"===typeof t&&t!==i||l!==o||u!==s)?f(u):!g&&p>0&&(h<a||p<r)&&c>n.getTotalSize()-h&&f(p-1)}var A,S,_,I=n(58063),C=(A="undefined"!==typeof window?window:"undefined"!==typeof self?self:{}).requestAnimationFrame||A.webkitRequestAnimationFrame||A.mozRequestAnimationFrame||A.oRequestAnimationFrame||A.msRequestAnimationFrame||function(e){return A.setTimeout(e,1e3/60)},T=A.cancelAnimationFrame||A.webkitCancelAnimationFrame||A.mozCancelAnimationFrame||A.oCancelAnimationFrame||A.msCancelAnimationFrame||function(e){A.clearTimeout(e)},k=C,R=T,x=function(e){return R(e.id)},P=function(e,t){var n;Promise.resolve().then((function(){n=Date.now()}));var r={id:k((function i(){Date.now()-n>=t?e.call():r.id=k(i)}))};return r};function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(n,!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var N="observed",B="requested",L=(_=S=function(e){function t(e){var n;(0,r.Z)(this,t),n=(0,o.Z)(this,(0,s.Z)(t).call(this,e)),(0,l.Z)((0,a.Z)(n),"_onGridRenderedMemoizer",w()),(0,l.Z)((0,a.Z)(n),"_onScrollMemoizer",w(!1)),(0,l.Z)((0,a.Z)(n),"_deferredInvalidateColumnIndex",null),(0,l.Z)((0,a.Z)(n),"_deferredInvalidateRowIndex",null),(0,l.Z)((0,a.Z)(n),"_recomputeScrollLeftFlag",!1),(0,l.Z)((0,a.Z)(n),"_recomputeScrollTopFlag",!1),(0,l.Z)((0,a.Z)(n),"_horizontalScrollBarSize",0),(0,l.Z)((0,a.Z)(n),"_verticalScrollBarSize",0),(0,l.Z)((0,a.Z)(n),"_scrollbarPresenceChanged",!1),(0,l.Z)((0,a.Z)(n),"_scrollingContainer",void 0),(0,l.Z)((0,a.Z)(n),"_childrenToDisplay",void 0),(0,l.Z)((0,a.Z)(n),"_columnStartIndex",void 0),(0,l.Z)((0,a.Z)(n),"_columnStopIndex",void 0),(0,l.Z)((0,a.Z)(n),"_rowStartIndex",void 0),(0,l.Z)((0,a.Z)(n),"_rowStopIndex",void 0),(0,l.Z)((0,a.Z)(n),"_renderedColumnStartIndex",0),(0,l.Z)((0,a.Z)(n),"_renderedColumnStopIndex",0),(0,l.Z)((0,a.Z)(n),"_renderedRowStartIndex",0),(0,l.Z)((0,a.Z)(n),"_renderedRowStopIndex",0),(0,l.Z)((0,a.Z)(n),"_initialScrollTop",void 0),(0,l.Z)((0,a.Z)(n),"_initialScrollLeft",void 0),(0,l.Z)((0,a.Z)(n),"_disablePointerEventsTimeoutId",void 0),(0,l.Z)((0,a.Z)(n),"_styleCache",{}),(0,l.Z)((0,a.Z)(n),"_cellCache",{}),(0,l.Z)((0,a.Z)(n),"_debounceScrollEndedCallback",(function(){n._disablePointerEventsTimeoutId=null,n.setState({isScrolling:!1,needToResetStyleCache:!1})})),(0,l.Z)((0,a.Z)(n),"_invokeOnGridRenderedHelper",(function(){var e=n.props.onSectionRendered;n._onGridRenderedMemoizer({callback:e,indices:{columnOverscanStartIndex:n._columnStartIndex,columnOverscanStopIndex:n._columnStopIndex,columnStartIndex:n._renderedColumnStartIndex,columnStopIndex:n._renderedColumnStopIndex,rowOverscanStartIndex:n._rowStartIndex,rowOverscanStopIndex:n._rowStopIndex,rowStartIndex:n._renderedRowStartIndex,rowStopIndex:n._renderedRowStopIndex}})})),(0,l.Z)((0,a.Z)(n),"_setScrollingContainerRef",(function(e){n._scrollingContainer=e})),(0,l.Z)((0,a.Z)(n),"_onScroll",(function(e){e.target===n._scrollingContainer&&n.handleScrollEvent(e.target)}));var i=new b({cellCount:e.columnCount,cellSizeGetter:function(n){return t._wrapSizeGetter(e.columnWidth)(n)},estimatedCellSize:t._getEstimatedColumnSize(e)}),c=new b({cellCount:e.rowCount,cellSizeGetter:function(n){return t._wrapSizeGetter(e.rowHeight)(n)},estimatedCellSize:t._getEstimatedRowSize(e)});return n.state={instanceProps:{columnSizeAndPositionManager:i,rowSizeAndPositionManager:c,prevColumnWidth:e.columnWidth,prevRowHeight:e.rowHeight,prevColumnCount:e.columnCount,prevRowCount:e.rowCount,prevIsScrolling:!0===e.isScrolling,prevScrollToColumn:e.scrollToColumn,prevScrollToRow:e.scrollToRow,scrollbarSize:0,scrollbarSizeMeasured:!1},isScrolling:!1,scrollDirectionHorizontal:1,scrollDirectionVertical:1,scrollLeft:0,scrollTop:0,scrollPositionChangeReason:null,needToResetStyleCache:!1},e.scrollToRow>0&&(n._initialScrollTop=n._getCalculatedScrollTop(e,n.state)),e.scrollToColumn>0&&(n._initialScrollLeft=n._getCalculatedScrollLeft(e,n.state)),n}return(0,c.Z)(t,e),(0,i.Z)(t,[{key:"getOffsetForCell",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.alignment,n=void 0===t?this.props.scrollToAlignment:t,r=e.columnIndex,i=void 0===r?this.props.scrollToColumn:r,o=e.rowIndex,s=void 0===o?this.props.scrollToRow:o,a=O({},this.props,{scrollToAlignment:n,scrollToColumn:i,scrollToRow:s});return{scrollLeft:this._getCalculatedScrollLeft(a),scrollTop:this._getCalculatedScrollTop(a)}}},{key:"getTotalRowsHeight",value:function(){return this.state.instanceProps.rowSizeAndPositionManager.getTotalSize()}},{key:"getTotalColumnsWidth",value:function(){return this.state.instanceProps.columnSizeAndPositionManager.getTotalSize()}},{key:"handleScrollEvent",value:function(e){var t=e.scrollLeft,n=void 0===t?0:t,r=e.scrollTop,i=void 0===r?0:r;if(!(i<0)){this._debounceScrollEnded();var o=this.props,s=o.autoHeight,a=o.autoWidth,c=o.height,l=o.width,u=this.state.instanceProps,h=u.scrollbarSize,d=u.rowSizeAndPositionManager.getTotalSize(),f=u.columnSizeAndPositionManager.getTotalSize(),p=Math.min(Math.max(0,f-l+h),n),g=Math.min(Math.max(0,d-c+h),i);if(this.state.scrollLeft!==p||this.state.scrollTop!==g){var y={isScrolling:!0,scrollDirectionHorizontal:p!==this.state.scrollLeft?p>this.state.scrollLeft?1:-1:this.state.scrollDirectionHorizontal,scrollDirectionVertical:g!==this.state.scrollTop?g>this.state.scrollTop?1:-1:this.state.scrollDirectionVertical,scrollPositionChangeReason:N};s||(y.scrollTop=g),a||(y.scrollLeft=p),y.needToResetStyleCache=!1,this.setState(y)}this._invokeOnScrollMemoizer({scrollLeft:p,scrollTop:g,totalColumnsWidth:f,totalRowsHeight:d})}}},{key:"invalidateCellSizeAfterRender",value:function(e){var t=e.columnIndex,n=e.rowIndex;this._deferredInvalidateColumnIndex="number"===typeof this._deferredInvalidateColumnIndex?Math.min(this._deferredInvalidateColumnIndex,t):t,this._deferredInvalidateRowIndex="number"===typeof this._deferredInvalidateRowIndex?Math.min(this._deferredInvalidateRowIndex,n):n}},{key:"measureAllCells",value:function(){var e=this.props,t=e.columnCount,n=e.rowCount,r=this.state.instanceProps;r.columnSizeAndPositionManager.getSizeAndPositionOfCell(t-1),r.rowSizeAndPositionManager.getSizeAndPositionOfCell(n-1)}},{key:"recomputeGridSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.columnIndex,n=void 0===t?0:t,r=e.rowIndex,i=void 0===r?0:r,o=this.props,s=o.scrollToColumn,a=o.scrollToRow,c=this.state.instanceProps;c.columnSizeAndPositionManager.resetCell(n),c.rowSizeAndPositionManager.resetCell(i),this._recomputeScrollLeftFlag=s>=0&&(1===this.state.scrollDirectionHorizontal?n<=s:n>=s),this._recomputeScrollTopFlag=a>=0&&(1===this.state.scrollDirectionVertical?i<=a:i>=a),this._styleCache={},this._cellCache={},this.forceUpdate()}},{key:"scrollToCell",value:function(e){var t=e.columnIndex,n=e.rowIndex,r=this.props.columnCount,i=this.props;r>1&&void 0!==t&&this._updateScrollLeftForScrollToColumn(O({},i,{scrollToColumn:t})),void 0!==n&&this._updateScrollTopForScrollToRow(O({},i,{scrollToRow:n}))}},{key:"componentDidMount",value:function(){var e=this.props,n=e.getScrollbarSize,r=e.height,i=e.scrollLeft,o=e.scrollToColumn,s=e.scrollTop,a=e.scrollToRow,c=e.width,l=this.state.instanceProps;if(this._initialScrollTop=0,this._initialScrollLeft=0,this._handleInvalidatedGridSize(),l.scrollbarSizeMeasured||this.setState((function(e){var t=O({},e,{needToResetStyleCache:!1});return t.instanceProps.scrollbarSize=n(),t.instanceProps.scrollbarSizeMeasured=!0,t})),"number"===typeof i&&i>=0||"number"===typeof s&&s>=0){var u=t._getScrollToPositionStateUpdate({prevState:this.state,scrollLeft:i,scrollTop:s});u&&(u.needToResetStyleCache=!1,this.setState(u))}this._scrollingContainer&&(this._scrollingContainer.scrollLeft!==this.state.scrollLeft&&(this._scrollingContainer.scrollLeft=this.state.scrollLeft),this._scrollingContainer.scrollTop!==this.state.scrollTop&&(this._scrollingContainer.scrollTop=this.state.scrollTop));var h=r>0&&c>0;o>=0&&h&&this._updateScrollLeftForScrollToColumn(),a>=0&&h&&this._updateScrollTopForScrollToRow(),this._invokeOnGridRenderedHelper(),this._invokeOnScrollMemoizer({scrollLeft:i||0,scrollTop:s||0,totalColumnsWidth:l.columnSizeAndPositionManager.getTotalSize(),totalRowsHeight:l.rowSizeAndPositionManager.getTotalSize()}),this._maybeCallOnScrollbarPresenceChange()}},{key:"componentDidUpdate",value:function(e,t){var n=this,r=this.props,i=r.autoHeight,o=r.autoWidth,s=r.columnCount,a=r.height,c=r.rowCount,l=r.scrollToAlignment,u=r.scrollToColumn,h=r.scrollToRow,d=r.width,f=this.state,p=f.scrollLeft,g=f.scrollPositionChangeReason,y=f.scrollTop,m=f.instanceProps;this._handleInvalidatedGridSize();var v=s>0&&0===e.columnCount||c>0&&0===e.rowCount;g===B&&(!o&&p>=0&&(p!==this._scrollingContainer.scrollLeft||v)&&(this._scrollingContainer.scrollLeft=p),!i&&y>=0&&(y!==this._scrollingContainer.scrollTop||v)&&(this._scrollingContainer.scrollTop=y));var b=(0===e.width||0===e.height)&&a>0&&d>0;if(this._recomputeScrollLeftFlag?(this._recomputeScrollLeftFlag=!1,this._updateScrollLeftForScrollToColumn(this.props)):E({cellSizeAndPositionManager:m.columnSizeAndPositionManager,previousCellsCount:e.columnCount,previousCellSize:e.columnWidth,previousScrollToAlignment:e.scrollToAlignment,previousScrollToIndex:e.scrollToColumn,previousSize:e.width,scrollOffset:p,scrollToAlignment:l,scrollToIndex:u,size:d,sizeJustIncreasedFromZero:b,updateScrollIndexCallback:function(){return n._updateScrollLeftForScrollToColumn(n.props)}}),this._recomputeScrollTopFlag?(this._recomputeScrollTopFlag=!1,this._updateScrollTopForScrollToRow(this.props)):E({cellSizeAndPositionManager:m.rowSizeAndPositionManager,previousCellsCount:e.rowCount,previousCellSize:e.rowHeight,previousScrollToAlignment:e.scrollToAlignment,previousScrollToIndex:e.scrollToRow,previousSize:e.height,scrollOffset:y,scrollToAlignment:l,scrollToIndex:h,size:a,sizeJustIncreasedFromZero:b,updateScrollIndexCallback:function(){return n._updateScrollTopForScrollToRow(n.props)}}),this._invokeOnGridRenderedHelper(),p!==t.scrollLeft||y!==t.scrollTop){var w=m.rowSizeAndPositionManager.getTotalSize(),A=m.columnSizeAndPositionManager.getTotalSize();this._invokeOnScrollMemoizer({scrollLeft:p,scrollTop:y,totalColumnsWidth:A,totalRowsHeight:w})}this._maybeCallOnScrollbarPresenceChange()}},{key:"componentWillUnmount",value:function(){this._disablePointerEventsTimeoutId&&x(this._disablePointerEventsTimeoutId)}},{key:"render",value:function(){var e=this.props,t=e.autoContainerWidth,n=e.autoHeight,r=e.autoWidth,i=e.className,o=e.containerProps,s=e.containerRole,a=e.containerStyle,c=e.height,l=e.id,h=e.noContentRenderer,f=e.role,g=e.style,y=e.tabIndex,m=e.width,v=this.state,b=v.instanceProps,w=v.needToResetStyleCache,E=this._isScrolling(),A={boxSizing:"border-box",direction:"ltr",height:n?"auto":c,position:"relative",width:r?"auto":m,WebkitOverflowScrolling:"touch",willChange:"transform"};w&&(this._styleCache={}),this.state.isScrolling||this._resetStyleCache(),this._calculateChildrenToRender(this.props,this.state);var S=b.columnSizeAndPositionManager.getTotalSize(),_=b.rowSizeAndPositionManager.getTotalSize(),I=_>c?b.scrollbarSize:0,C=S>m?b.scrollbarSize:0;C===this._horizontalScrollBarSize&&I===this._verticalScrollBarSize||(this._horizontalScrollBarSize=C,this._verticalScrollBarSize=I,this._scrollbarPresenceChanged=!0),A.overflowX=S+I<=m?"hidden":"auto",A.overflowY=_+C<=c?"hidden":"auto";var T=this._childrenToDisplay,k=0===T.length&&c>0&&m>0;return u.createElement("div",(0,d.Z)({ref:this._setScrollingContainerRef},o,{"aria-label":this.props["aria-label"],"aria-readonly":this.props["aria-readonly"],className:p("ReactVirtualized__Grid",i),id:l,onScroll:this._onScroll,role:f,style:O({},A,{},g),tabIndex:y}),T.length>0&&u.createElement("div",{className:"ReactVirtualized__Grid__innerScrollContainer",role:s,style:O({width:t?"auto":S,height:_,maxWidth:S,maxHeight:_,overflow:"hidden",pointerEvents:E?"none":"",position:"relative"},a)},T),k&&h())}},{key:"_calculateChildrenToRender",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.state,n=e.cellRenderer,r=e.cellRangeRenderer,i=e.columnCount,o=e.deferredMeasurementCache,s=e.height,a=e.overscanColumnCount,c=e.overscanIndicesGetter,l=e.overscanRowCount,u=e.rowCount,h=e.width,d=e.isScrollingOptOut,f=t.scrollDirectionHorizontal,p=t.scrollDirectionVertical,g=t.instanceProps,y=this._initialScrollTop>0?this._initialScrollTop:t.scrollTop,m=this._initialScrollLeft>0?this._initialScrollLeft:t.scrollLeft,v=this._isScrolling(e,t);if(this._childrenToDisplay=[],s>0&&h>0){var b=g.columnSizeAndPositionManager.getVisibleCellRange({containerSize:h,offset:m}),w=g.rowSizeAndPositionManager.getVisibleCellRange({containerSize:s,offset:y}),E=g.columnSizeAndPositionManager.getOffsetAdjustment({containerSize:h,offset:m}),A=g.rowSizeAndPositionManager.getOffsetAdjustment({containerSize:s,offset:y});this._renderedColumnStartIndex=b.start,this._renderedColumnStopIndex=b.stop,this._renderedRowStartIndex=w.start,this._renderedRowStopIndex=w.stop;var S=c({direction:"horizontal",cellCount:i,overscanCellsCount:a,scrollDirection:f,startIndex:"number"===typeof b.start?b.start:0,stopIndex:"number"===typeof b.stop?b.stop:-1}),_=c({direction:"vertical",cellCount:u,overscanCellsCount:l,scrollDirection:p,startIndex:"number"===typeof w.start?w.start:0,stopIndex:"number"===typeof w.stop?w.stop:-1}),I=S.overscanStartIndex,C=S.overscanStopIndex,T=_.overscanStartIndex,k=_.overscanStopIndex;if(o){if(!o.hasFixedHeight())for(var R=T;R<=k;R++)if(!o.has(R,0)){I=0,C=i-1;break}if(!o.hasFixedWidth())for(var x=I;x<=C;x++)if(!o.has(0,x)){T=0,k=u-1;break}}this._childrenToDisplay=r({cellCache:this._cellCache,cellRenderer:n,columnSizeAndPositionManager:g.columnSizeAndPositionManager,columnStartIndex:I,columnStopIndex:C,deferredMeasurementCache:o,horizontalOffsetAdjustment:E,isScrolling:v,isScrollingOptOut:d,parent:this,rowSizeAndPositionManager:g.rowSizeAndPositionManager,rowStartIndex:T,rowStopIndex:k,scrollLeft:m,scrollTop:y,styleCache:this._styleCache,verticalOffsetAdjustment:A,visibleColumnIndices:b,visibleRowIndices:w}),this._columnStartIndex=I,this._columnStopIndex=C,this._rowStartIndex=T,this._rowStopIndex=k}}},{key:"_debounceScrollEnded",value:function(){var e=this.props.scrollingResetTimeInterval;this._disablePointerEventsTimeoutId&&x(this._disablePointerEventsTimeoutId),this._disablePointerEventsTimeoutId=P(this._debounceScrollEndedCallback,e)}},{key:"_handleInvalidatedGridSize",value:function(){if("number"===typeof this._deferredInvalidateColumnIndex&&"number"===typeof this._deferredInvalidateRowIndex){var e=this._deferredInvalidateColumnIndex,t=this._deferredInvalidateRowIndex;this._deferredInvalidateColumnIndex=null,this._deferredInvalidateRowIndex=null,this.recomputeGridSize({columnIndex:e,rowIndex:t})}}},{key:"_invokeOnScrollMemoizer",value:function(e){var t=this,n=e.scrollLeft,r=e.scrollTop,i=e.totalColumnsWidth,o=e.totalRowsHeight;this._onScrollMemoizer({callback:function(e){var n=e.scrollLeft,r=e.scrollTop,s=t.props,a=s.height;(0,s.onScroll)({clientHeight:a,clientWidth:s.width,scrollHeight:o,scrollLeft:n,scrollTop:r,scrollWidth:i})},indices:{scrollLeft:n,scrollTop:r}})}},{key:"_isScrolling",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.state;return Object.hasOwnProperty.call(e,"isScrolling")?Boolean(e.isScrolling):Boolean(t.isScrolling)}},{key:"_maybeCallOnScrollbarPresenceChange",value:function(){if(this._scrollbarPresenceChanged){var e=this.props.onScrollbarPresenceChange;this._scrollbarPresenceChanged=!1,e({horizontal:this._horizontalScrollBarSize>0,size:this.state.instanceProps.scrollbarSize,vertical:this._verticalScrollBarSize>0})}}},{key:"scrollToPosition",value:function(e){var n=e.scrollLeft,r=e.scrollTop,i=t._getScrollToPositionStateUpdate({prevState:this.state,scrollLeft:n,scrollTop:r});i&&(i.needToResetStyleCache=!1,this.setState(i))}},{key:"_getCalculatedScrollLeft",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.state;return t._getCalculatedScrollLeft(e,n)}},{key:"_updateScrollLeftForScrollToColumn",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.state,r=t._getScrollLeftForScrollToColumnStateUpdate(e,n);r&&(r.needToResetStyleCache=!1,this.setState(r))}},{key:"_getCalculatedScrollTop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.state;return t._getCalculatedScrollTop(e,n)}},{key:"_resetStyleCache",value:function(){var e=this._styleCache,t=this._cellCache,n=this.props.isScrollingOptOut;this._cellCache={},this._styleCache={};for(var r=this._rowStartIndex;r<=this._rowStopIndex;r++)for(var i=this._columnStartIndex;i<=this._columnStopIndex;i++){var o="".concat(r,"-").concat(i);this._styleCache[o]=e[o],n&&(this._cellCache[o]=t[o])}}},{key:"_updateScrollTopForScrollToRow",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.state,r=t._getScrollTopForScrollToRowStateUpdate(e,n);r&&(r.needToResetStyleCache=!1,this.setState(r))}}],[{key:"getDerivedStateFromProps",value:function(e,n){var r={};0===e.columnCount&&0!==n.scrollLeft||0===e.rowCount&&0!==n.scrollTop?(r.scrollLeft=0,r.scrollTop=0):(e.scrollLeft!==n.scrollLeft&&e.scrollToColumn<0||e.scrollTop!==n.scrollTop&&e.scrollToRow<0)&&Object.assign(r,t._getScrollToPositionStateUpdate({prevState:n,scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}));var i,o,s=n.instanceProps;return r.needToResetStyleCache=!1,e.columnWidth===s.prevColumnWidth&&e.rowHeight===s.prevRowHeight||(r.needToResetStyleCache=!0),s.columnSizeAndPositionManager.configure({cellCount:e.columnCount,estimatedCellSize:t._getEstimatedColumnSize(e),cellSizeGetter:t._wrapSizeGetter(e.columnWidth)}),s.rowSizeAndPositionManager.configure({cellCount:e.rowCount,estimatedCellSize:t._getEstimatedRowSize(e),cellSizeGetter:t._wrapSizeGetter(e.rowHeight)}),0!==s.prevColumnCount&&0!==s.prevRowCount||(s.prevColumnCount=0,s.prevRowCount=0),e.autoHeight&&!1===e.isScrolling&&!0===s.prevIsScrolling&&Object.assign(r,{isScrolling:!1}),g({cellCount:s.prevColumnCount,cellSize:"number"===typeof s.prevColumnWidth?s.prevColumnWidth:null,computeMetadataCallback:function(){return s.columnSizeAndPositionManager.resetCell(0)},computeMetadataCallbackProps:e,nextCellsCount:e.columnCount,nextCellSize:"number"===typeof e.columnWidth?e.columnWidth:null,nextScrollToIndex:e.scrollToColumn,scrollToIndex:s.prevScrollToColumn,updateScrollOffsetForScrollToIndex:function(){i=t._getScrollLeftForScrollToColumnStateUpdate(e,n)}}),g({cellCount:s.prevRowCount,cellSize:"number"===typeof s.prevRowHeight?s.prevRowHeight:null,computeMetadataCallback:function(){return s.rowSizeAndPositionManager.resetCell(0)},computeMetadataCallbackProps:e,nextCellsCount:e.rowCount,nextCellSize:"number"===typeof e.rowHeight?e.rowHeight:null,nextScrollToIndex:e.scrollToRow,scrollToIndex:s.prevScrollToRow,updateScrollOffsetForScrollToIndex:function(){o=t._getScrollTopForScrollToRowStateUpdate(e,n)}}),s.prevColumnCount=e.columnCount,s.prevColumnWidth=e.columnWidth,s.prevIsScrolling=!0===e.isScrolling,s.prevRowCount=e.rowCount,s.prevRowHeight=e.rowHeight,s.prevScrollToColumn=e.scrollToColumn,s.prevScrollToRow=e.scrollToRow,s.scrollbarSize=e.getScrollbarSize(),void 0===s.scrollbarSize?(s.scrollbarSizeMeasured=!1,s.scrollbarSize=0):s.scrollbarSizeMeasured=!0,r.instanceProps=s,O({},r,{},i,{},o)}},{key:"_getEstimatedColumnSize",value:function(e){return"number"===typeof e.columnWidth?e.columnWidth:e.estimatedColumnSize}},{key:"_getEstimatedRowSize",value:function(e){return"number"===typeof e.rowHeight?e.rowHeight:e.estimatedRowSize}},{key:"_getScrollToPositionStateUpdate",value:function(e){var t=e.prevState,n=e.scrollLeft,r=e.scrollTop,i={scrollPositionChangeReason:B};return"number"===typeof n&&n>=0&&(i.scrollDirectionHorizontal=n>t.scrollLeft?1:-1,i.scrollLeft=n),"number"===typeof r&&r>=0&&(i.scrollDirectionVertical=r>t.scrollTop?1:-1,i.scrollTop=r),"number"===typeof n&&n>=0&&n!==t.scrollLeft||"number"===typeof r&&r>=0&&r!==t.scrollTop?i:{}}},{key:"_wrapSizeGetter",value:function(e){return"function"===typeof e?e:function(){return e}}},{key:"_getCalculatedScrollLeft",value:function(e,t){var n=e.columnCount,r=e.height,i=e.scrollToAlignment,o=e.scrollToColumn,s=e.width,a=t.scrollLeft,c=t.instanceProps;if(n>0){var l=n-1,u=o<0?l:Math.min(l,o),h=c.rowSizeAndPositionManager.getTotalSize(),d=c.scrollbarSizeMeasured&&h>r?c.scrollbarSize:0;return c.columnSizeAndPositionManager.getUpdatedOffsetForIndex({align:i,containerSize:s-d,currentOffset:a,targetIndex:u})}return 0}},{key:"_getScrollLeftForScrollToColumnStateUpdate",value:function(e,n){var r=n.scrollLeft,i=t._getCalculatedScrollLeft(e,n);return"number"===typeof i&&i>=0&&r!==i?t._getScrollToPositionStateUpdate({prevState:n,scrollLeft:i,scrollTop:-1}):{}}},{key:"_getCalculatedScrollTop",value:function(e,t){var n=e.height,r=e.rowCount,i=e.scrollToAlignment,o=e.scrollToRow,s=e.width,a=t.scrollTop,c=t.instanceProps;if(r>0){var l=r-1,u=o<0?l:Math.min(l,o),h=c.columnSizeAndPositionManager.getTotalSize(),d=c.scrollbarSizeMeasured&&h>s?c.scrollbarSize:0;return c.rowSizeAndPositionManager.getUpdatedOffsetForIndex({align:i,containerSize:n-d,currentOffset:a,targetIndex:u})}return 0}},{key:"_getScrollTopForScrollToRowStateUpdate",value:function(e,n){var r=n.scrollTop,i=t._getCalculatedScrollTop(e,n);return"number"===typeof i&&i>=0&&r!==i?t._getScrollToPositionStateUpdate({prevState:n,scrollLeft:-1,scrollTop:i}):{}}}]),t}(u.PureComponent),(0,l.Z)(S,"propTypes",null),_);(0,l.Z)(L,"defaultProps",{"aria-label":"grid","aria-readonly":!0,autoContainerWidth:!1,autoHeight:!1,autoWidth:!1,cellRangeRenderer:function(e){for(var t=e.cellCache,n=e.cellRenderer,r=e.columnSizeAndPositionManager,i=e.columnStartIndex,o=e.columnStopIndex,s=e.deferredMeasurementCache,a=e.horizontalOffsetAdjustment,c=e.isScrolling,l=e.isScrollingOptOut,u=e.parent,h=e.rowSizeAndPositionManager,d=e.rowStartIndex,f=e.rowStopIndex,p=e.styleCache,g=e.verticalOffsetAdjustment,y=e.visibleColumnIndices,m=e.visibleRowIndices,v=[],b=r.areOffsetsAdjusted()||h.areOffsetsAdjusted(),w=!c&&!b,E=d;E<=f;E++)for(var A=h.getSizeAndPositionOfCell(E),S=i;S<=o;S++){var _=r.getSizeAndPositionOfCell(S),I=S>=y.start&&S<=y.stop&&E>=m.start&&E<=m.stop,C="".concat(E,"-").concat(S),T=void 0;w&&p[C]?T=p[C]:s&&!s.has(E,S)?T={height:"auto",left:0,position:"absolute",top:0,width:"auto"}:(T={height:A.size,left:_.offset+a,position:"absolute",top:A.offset+g,width:_.size},p[C]=T);var k={columnIndex:S,isScrolling:c,isVisible:I,key:C,parent:u,rowIndex:E,style:T},R=void 0;!l&&!c||a||g?R=n(k):(t[C]||(t[C]=n(k)),R=t[C]),null!=R&&!1!==R&&v.push(R)}return v},containerRole:"rowgroup",containerStyle:{},estimatedColumnSize:100,estimatedRowSize:30,getScrollbarSize:I.Z,noContentRenderer:function(){return null},onScroll:function(){},onScrollbarPresenceChange:function(){},onSectionRendered:function(){},overscanColumnCount:0,overscanIndicesGetter:function(e){var t=e.cellCount,n=e.overscanCellsCount,r=e.scrollDirection,i=e.startIndex,o=e.stopIndex;return 1===r?{overscanStartIndex:Math.max(0,i),overscanStopIndex:Math.min(t-1,o+n)}:{overscanStartIndex:Math.max(0,i-n),overscanStopIndex:Math.min(t-1,o)}},overscanRowCount:10,role:"grid",scrollingResetTimeInterval:150,scrollToAlignment:"auto",scrollToColumn:-1,scrollToRow:-1,style:{},tabIndex:0,isScrollingOptOut:!1}),(0,h.O)(L);const M=L;function U(e){var t=e.cellCount,n=e.overscanCellsCount,r=e.scrollDirection,i=e.startIndex,o=e.stopIndex;return n=Math.max(1,n),1===r?{overscanStartIndex:Math.max(0,i-1),overscanStopIndex:Math.min(t-1,o+n)}:{overscanStartIndex:Math.max(0,i-n),overscanStopIndex:Math.min(t-1,o+1)}}var F,K;function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Z=(K=F=function(e){function t(){var e,n;(0,r.Z)(this,t);for(var i=arguments.length,c=new Array(i),u=0;u<i;u++)c[u]=arguments[u];return n=(0,o.Z)(this,(e=(0,s.Z)(t)).call.apply(e,[this].concat(c))),(0,l.Z)((0,a.Z)(n),"state",{scrollToColumn:0,scrollToRow:0,instanceProps:{prevScrollToColumn:0,prevScrollToRow:0}}),(0,l.Z)((0,a.Z)(n),"_columnStartIndex",0),(0,l.Z)((0,a.Z)(n),"_columnStopIndex",0),(0,l.Z)((0,a.Z)(n),"_rowStartIndex",0),(0,l.Z)((0,a.Z)(n),"_rowStopIndex",0),(0,l.Z)((0,a.Z)(n),"_onKeyDown",(function(e){var t=n.props,r=t.columnCount,i=t.disabled,o=t.mode,s=t.rowCount;if(!i){var a=n._getScrollState(),c=a.scrollToColumn,l=a.scrollToRow,u=n._getScrollState(),h=u.scrollToColumn,d=u.scrollToRow;switch(e.key){case"ArrowDown":d="cells"===o?Math.min(d+1,s-1):Math.min(n._rowStopIndex+1,s-1);break;case"ArrowLeft":h="cells"===o?Math.max(h-1,0):Math.max(n._columnStartIndex-1,0);break;case"ArrowRight":h="cells"===o?Math.min(h+1,r-1):Math.min(n._columnStopIndex+1,r-1);break;case"ArrowUp":d="cells"===o?Math.max(d-1,0):Math.max(n._rowStartIndex-1,0)}h===c&&d===l||(e.preventDefault(),n._updateScrollState({scrollToColumn:h,scrollToRow:d}))}})),(0,l.Z)((0,a.Z)(n),"_onSectionRendered",(function(e){var t=e.columnStartIndex,r=e.columnStopIndex,i=e.rowStartIndex,o=e.rowStopIndex;n._columnStartIndex=t,n._columnStopIndex=r,n._rowStartIndex=i,n._rowStopIndex=o})),n}return(0,c.Z)(t,e),(0,i.Z)(t,[{key:"setScrollIndexes",value:function(e){var t=e.scrollToColumn,n=e.scrollToRow;this.setState({scrollToRow:n,scrollToColumn:t})}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.children,r=this._getScrollState(),i=r.scrollToColumn,o=r.scrollToRow;return u.createElement("div",{className:t,onKeyDown:this._onKeyDown},n({onSectionRendered:this._onSectionRendered,scrollToColumn:i,scrollToRow:o}))}},{key:"_getScrollState",value:function(){return this.props.isControlled?this.props:this.state}},{key:"_updateScrollState",value:function(e){var t=e.scrollToColumn,n=e.scrollToRow,r=this.props,i=r.isControlled,o=r.onScrollToChange;"function"===typeof o&&o({scrollToColumn:t,scrollToRow:n}),i||this.setState({scrollToColumn:t,scrollToRow:n})}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.isControlled?{}:e.scrollToColumn!==t.instanceProps.prevScrollToColumn||e.scrollToRow!==t.instanceProps.prevScrollToRow?function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(n,!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t,{scrollToColumn:e.scrollToColumn,scrollToRow:e.scrollToRow,instanceProps:{prevScrollToColumn:e.scrollToColumn,prevScrollToRow:e.scrollToRow}}):{}}}]),t}(u.PureComponent),(0,l.Z)(F,"propTypes",null),K);(0,l.Z)(Z,"defaultProps",{disabled:!1,isControlled:!1,mode:"edges",scrollToColumn:0,scrollToRow:0}),(0,h.O)(Z);function z(e,t){var r,i="undefined"!==typeof(r="undefined"!==typeof t?t:"undefined"!==typeof window?window:"undefined"!==typeof self?self:n.g).document&&r.document.attachEvent;if(!i){var o=function(){var e=r.requestAnimationFrame||r.mozRequestAnimationFrame||r.webkitRequestAnimationFrame||function(e){return r.setTimeout(e,20)};return function(t){return e(t)}}(),s=function(){var e=r.cancelAnimationFrame||r.mozCancelAnimationFrame||r.webkitCancelAnimationFrame||r.clearTimeout;return function(t){return e(t)}}(),a=function(e){var t=e.__resizeTriggers__,n=t.firstElementChild,r=t.lastElementChild,i=n.firstElementChild;r.scrollLeft=r.scrollWidth,r.scrollTop=r.scrollHeight,i.style.width=n.offsetWidth+1+"px",i.style.height=n.offsetHeight+1+"px",n.scrollLeft=n.scrollWidth,n.scrollTop=n.scrollHeight},c=function(e){if(!(e.target.className&&"function"===typeof e.target.className.indexOf&&e.target.className.indexOf("contract-trigger")<0&&e.target.className.indexOf("expand-trigger")<0)){var t=this;a(this),this.__resizeRAF__&&s(this.__resizeRAF__),this.__resizeRAF__=o((function(){(function(e){return e.offsetWidth!=e.__resizeLast__.width||e.offsetHeight!=e.__resizeLast__.height})(t)&&(t.__resizeLast__.width=t.offsetWidth,t.__resizeLast__.height=t.offsetHeight,t.__resizeListeners__.forEach((function(n){n.call(t,e)})))}))}},l=!1,u="",h="animationstart",d="Webkit Moz O ms".split(" "),f="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),p=r.document.createElement("fakeelement");if(void 0!==p.style.animationName&&(l=!0),!1===l)for(var g=0;g<d.length;g++)if(void 0!==p.style[d[g]+"AnimationName"]){u="-"+d[g].toLowerCase()+"-",h=f[g],l=!0;break}var y="resizeanim",m="@"+u+"keyframes "+y+" { from { opacity: 0; } to { opacity: 0; } } ",v=u+"animation: 1ms "+y+"; "}return{addResizeListener:function(t,n){if(i)t.attachEvent("onresize",n);else{if(!t.__resizeTriggers__){var o=t.ownerDocument,s=r.getComputedStyle(t);s&&"static"==s.position&&(t.style.position="relative"),function(t){if(!t.getElementById("detectElementResize")){var n=(m||"")+".resize-triggers { "+(v||"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',r=t.head||t.getElementsByTagName("head")[0],i=t.createElement("style");i.id="detectElementResize",i.type="text/css",null!=e&&i.setAttribute("nonce",e),i.styleSheet?i.styleSheet.cssText=n:i.appendChild(t.createTextNode(n)),r.appendChild(i)}}(o),t.__resizeLast__={},t.__resizeListeners__=[],(t.__resizeTriggers__=o.createElement("div")).className="resize-triggers";var l='<div class="expand-trigger"><div></div></div><div class="contract-trigger"></div>';if(window.trustedTypes){var u=trustedTypes.createPolicy("react-virtualized-auto-sizer",{createHTML:function(){return l}});t.__resizeTriggers__.innerHTML=u.createHTML("")}else t.__resizeTriggers__.innerHTML=l;t.appendChild(t.__resizeTriggers__),a(t),t.addEventListener("scroll",c,!0),h&&(t.__resizeTriggers__.__animationListener__=function(e){e.animationName==y&&a(t)},t.__resizeTriggers__.addEventListener(h,t.__resizeTriggers__.__animationListener__))}t.__resizeListeners__.push(n)}},removeResizeListener:function(e,t){if(i)e.detachEvent("onresize",t);else if(e.__resizeListeners__.splice(e.__resizeListeners__.indexOf(t),1),!e.__resizeListeners__.length){e.removeEventListener("scroll",c,!0),e.__resizeTriggers__.__animationListener__&&(e.__resizeTriggers__.removeEventListener(h,e.__resizeTriggers__.__animationListener__),e.__resizeTriggers__.__animationListener__=null);try{e.__resizeTriggers__=!e.removeChild(e.__resizeTriggers__)}catch(n){}}}}}var V,H;function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(n,!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var W=(H=V=function(e){function t(){var e,n;(0,r.Z)(this,t);for(var i=arguments.length,c=new Array(i),u=0;u<i;u++)c[u]=arguments[u];return n=(0,o.Z)(this,(e=(0,s.Z)(t)).call.apply(e,[this].concat(c))),(0,l.Z)((0,a.Z)(n),"state",{height:n.props.defaultHeight||0,width:n.props.defaultWidth||0}),(0,l.Z)((0,a.Z)(n),"_parentNode",void 0),(0,l.Z)((0,a.Z)(n),"_autoSizer",void 0),(0,l.Z)((0,a.Z)(n),"_window",void 0),(0,l.Z)((0,a.Z)(n),"_detectElementResize",void 0),(0,l.Z)((0,a.Z)(n),"_onResize",(function(){var e=n.props,t=e.disableHeight,r=e.disableWidth,i=e.onResize;if(n._parentNode){var o=n._parentNode.offsetHeight||0,s=n._parentNode.offsetWidth||0,a=(n._window||window).getComputedStyle(n._parentNode)||{},c=parseInt(a.paddingLeft,10)||0,l=parseInt(a.paddingRight,10)||0,u=parseInt(a.paddingTop,10)||0,h=parseInt(a.paddingBottom,10)||0,d=o-u-h,f=s-c-l;(!t&&n.state.height!==d||!r&&n.state.width!==f)&&(n.setState({height:o-u-h,width:s-c-l}),i({height:o,width:s}))}})),(0,l.Z)((0,a.Z)(n),"_setRef",(function(e){n._autoSizer=e})),n}return(0,c.Z)(t,e),(0,i.Z)(t,[{key:"componentDidMount",value:function(){var e=this.props.nonce;this._autoSizer&&this._autoSizer.parentNode&&this._autoSizer.parentNode.ownerDocument&&this._autoSizer.parentNode.ownerDocument.defaultView&&this._autoSizer.parentNode instanceof this._autoSizer.parentNode.ownerDocument.defaultView.HTMLElement&&(this._parentNode=this._autoSizer.parentNode,this._window=this._autoSizer.parentNode.ownerDocument.defaultView,this._detectElementResize=z(e,this._window),this._detectElementResize.addResizeListener(this._parentNode,this._onResize),this._onResize())}},{key:"componentWillUnmount",value:function(){this._detectElementResize&&this._parentNode&&this._detectElementResize.removeResizeListener(this._parentNode,this._onResize)}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.className,r=e.disableHeight,i=e.disableWidth,o=e.style,s=this.state,a=s.height,c=s.width,l={overflow:"visible"},h={};return r||(l.height=0,h.height=a),i||(l.width=0,h.width=c),u.createElement("div",{className:n,ref:this._setRef,style:G({},l,{},o)},t(h))}}]),t}(u.Component),(0,l.Z)(V,"propTypes",null),H);(0,l.Z)(W,"defaultProps",{onResize:function(){},disableHeight:!1,disableWidth:!1,style:{}});var Q,Y,J=n(54164),X=(Y=Q=function(e){function t(){var e,n;(0,r.Z)(this,t);for(var i=arguments.length,c=new Array(i),u=0;u<i;u++)c[u]=arguments[u];return n=(0,o.Z)(this,(e=(0,s.Z)(t)).call.apply(e,[this].concat(c))),(0,l.Z)((0,a.Z)(n),"_child",void 0),(0,l.Z)((0,a.Z)(n),"_measure",(function(){var e=n.props,t=e.cache,r=e.columnIndex,i=void 0===r?0:r,o=e.parent,s=e.rowIndex,a=void 0===s?n.props.index||0:s,c=n._getCellMeasurements(),l=c.height,u=c.width;l===t.getHeight(a,i)&&u===t.getWidth(a,i)||(t.set(a,i,u,l),o&&"function"===typeof o.recomputeGridSize&&o.recomputeGridSize({columnIndex:i,rowIndex:a}))})),(0,l.Z)((0,a.Z)(n),"_registerChild",(function(e){!e||e instanceof Element||console.warn("CellMeasurer registerChild expects to be passed Element or null"),n._child=e,e&&n._maybeMeasureCell()})),n}return(0,c.Z)(t,e),(0,i.Z)(t,[{key:"componentDidMount",value:function(){this._maybeMeasureCell()}},{key:"componentDidUpdate",value:function(){this._maybeMeasureCell()}},{key:"render",value:function(){var e=this.props.children;return"function"===typeof e?e({measure:this._measure,registerChild:this._registerChild}):e}},{key:"_getCellMeasurements",value:function(){var e=this.props.cache,t=this._child||(0,J.findDOMNode)(this);if(t&&t.ownerDocument&&t.ownerDocument.defaultView&&t instanceof t.ownerDocument.defaultView.HTMLElement){var n=t.style.width,r=t.style.height;e.hasFixedWidth()||(t.style.width="auto"),e.hasFixedHeight()||(t.style.height="auto");var i=Math.ceil(t.offsetHeight),o=Math.ceil(t.offsetWidth);return n&&(t.style.width=n),r&&(t.style.height=r),{height:i,width:o}}return{height:0,width:0}}},{key:"_maybeMeasureCell",value:function(){var e=this.props,t=e.cache,n=e.columnIndex,r=void 0===n?0:n,i=e.parent,o=e.rowIndex,s=void 0===o?this.props.index||0:o;if(!t.has(s,r)){var a=this._getCellMeasurements(),c=a.height,l=a.width;t.set(s,r,l,c),i&&"function"===typeof i.invalidateCellSizeAfterRender&&i.invalidateCellSizeAfterRender({columnIndex:r,rowIndex:s})}}}]),t}(u.PureComponent),(0,l.Z)(Q,"propTypes",null),Y);(0,l.Z)(X,"__internalCellMeasurerFlag",!1);function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(n,!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var te="observed",ne="requested",re=function(e){function t(){var e,n;(0,r.Z)(this,t);for(var i=arguments.length,c=new Array(i),u=0;u<i;u++)c[u]=arguments[u];return n=(0,o.Z)(this,(e=(0,s.Z)(t)).call.apply(e,[this].concat(c))),(0,l.Z)((0,a.Z)(n),"state",{isScrolling:!1,scrollLeft:0,scrollTop:0}),(0,l.Z)((0,a.Z)(n),"_calculateSizeAndPositionDataOnNextUpdate",!1),(0,l.Z)((0,a.Z)(n),"_onSectionRenderedMemoizer",w()),(0,l.Z)((0,a.Z)(n),"_onScrollMemoizer",w(!1)),(0,l.Z)((0,a.Z)(n),"_invokeOnSectionRenderedHelper",(function(){var e=n.props,t=e.cellLayoutManager,r=e.onSectionRendered;n._onSectionRenderedMemoizer({callback:r,indices:{indices:t.getLastRenderedIndices()}})})),(0,l.Z)((0,a.Z)(n),"_setScrollingContainerRef",(function(e){n._scrollingContainer=e})),(0,l.Z)((0,a.Z)(n),"_updateScrollPositionForScrollToCell",(function(){var e=n.props,t=e.cellLayoutManager,r=e.height,i=e.scrollToAlignment,o=e.scrollToCell,s=e.width,a=n.state,c=a.scrollLeft,l=a.scrollTop;if(o>=0){var u=t.getScrollPositionForCell({align:i,cellIndex:o,height:r,scrollLeft:c,scrollTop:l,width:s});u.scrollLeft===c&&u.scrollTop===l||n._setScrollPosition(u)}})),(0,l.Z)((0,a.Z)(n),"_onScroll",(function(e){if(e.target===n._scrollingContainer){n._enablePointerEventsAfterDelay();var t=n.props,r=t.cellLayoutManager,i=t.height,o=t.isScrollingChange,s=t.width,a=n._scrollbarSize,c=r.getTotalSize(),l=c.height,u=c.width,h=Math.max(0,Math.min(u-s+a,e.target.scrollLeft)),d=Math.max(0,Math.min(l-i+a,e.target.scrollTop));if(n.state.scrollLeft!==h||n.state.scrollTop!==d){var f=e.cancelable?te:ne;n.state.isScrolling||o(!0),n.setState({isScrolling:!0,scrollLeft:h,scrollPositionChangeReason:f,scrollTop:d})}n._invokeOnScrollMemoizer({scrollLeft:h,scrollTop:d,totalWidth:u,totalHeight:l})}})),n._scrollbarSize=(0,I.Z)(),void 0===n._scrollbarSize?(n._scrollbarSizeMeasured=!1,n._scrollbarSize=0):n._scrollbarSizeMeasured=!0,n}return(0,c.Z)(t,e),(0,i.Z)(t,[{key:"recomputeCellSizesAndPositions",value:function(){this._calculateSizeAndPositionDataOnNextUpdate=!0,this.forceUpdate()}},{key:"componentDidMount",value:function(){var e=this.props,t=e.cellLayoutManager,n=e.scrollLeft,r=e.scrollToCell,i=e.scrollTop;this._scrollbarSizeMeasured||(this._scrollbarSize=(0,I.Z)(),this._scrollbarSizeMeasured=!0,this.setState({})),r>=0?this._updateScrollPositionForScrollToCell():(n>=0||i>=0)&&this._setScrollPosition({scrollLeft:n,scrollTop:i}),this._invokeOnSectionRenderedHelper();var o=t.getTotalSize(),s=o.height,a=o.width;this._invokeOnScrollMemoizer({scrollLeft:n||0,scrollTop:i||0,totalHeight:s,totalWidth:a})}},{key:"componentDidUpdate",value:function(e,t){var n=this.props,r=n.height,i=n.scrollToAlignment,o=n.scrollToCell,s=n.width,a=this.state,c=a.scrollLeft,l=a.scrollPositionChangeReason,u=a.scrollTop;l===ne&&(c>=0&&c!==t.scrollLeft&&c!==this._scrollingContainer.scrollLeft&&(this._scrollingContainer.scrollLeft=c),u>=0&&u!==t.scrollTop&&u!==this._scrollingContainer.scrollTop&&(this._scrollingContainer.scrollTop=u)),r===e.height&&i===e.scrollToAlignment&&o===e.scrollToCell&&s===e.width||this._updateScrollPositionForScrollToCell(),this._invokeOnSectionRenderedHelper()}},{key:"componentWillUnmount",value:function(){this._disablePointerEventsTimeoutId&&clearTimeout(this._disablePointerEventsTimeoutId)}},{key:"render",value:function(){var e=this.props,t=e.autoHeight,n=e.cellCount,r=e.cellLayoutManager,i=e.className,o=e.height,s=e.horizontalOverscanSize,a=e.id,c=e.noContentRenderer,l=e.style,h=e.verticalOverscanSize,d=e.width,f=this.state,g=f.isScrolling,y=f.scrollLeft,m=f.scrollTop;(this._lastRenderedCellCount!==n||this._lastRenderedCellLayoutManager!==r||this._calculateSizeAndPositionDataOnNextUpdate)&&(this._lastRenderedCellCount=n,this._lastRenderedCellLayoutManager=r,this._calculateSizeAndPositionDataOnNextUpdate=!1,r.calculateSizeAndPositionData());var v=r.getTotalSize(),b=v.height,w=v.width,E=Math.max(0,y-s),A=Math.max(0,m-h),S=Math.min(w,y+d+s),_=Math.min(b,m+o+h),I=o>0&&d>0?r.cellRenderers({height:_-A,isScrolling:g,width:S-E,x:E,y:A}):[],C={boxSizing:"border-box",direction:"ltr",height:t?"auto":o,position:"relative",WebkitOverflowScrolling:"touch",width:d,willChange:"transform"},T=b>o?this._scrollbarSize:0,k=w>d?this._scrollbarSize:0;return C.overflowX=w+T<=d?"hidden":"auto",C.overflowY=b+k<=o?"hidden":"auto",u.createElement("div",{ref:this._setScrollingContainerRef,"aria-label":this.props["aria-label"],className:p("ReactVirtualized__Collection",i),id:a,onScroll:this._onScroll,role:"grid",style:ee({},C,{},l),tabIndex:0},n>0&&u.createElement("div",{className:"ReactVirtualized__Collection__innerScrollContainer",style:{height:b,maxHeight:b,maxWidth:w,overflow:"hidden",pointerEvents:g?"none":"",width:w}},I),0===n&&c())}},{key:"_enablePointerEventsAfterDelay",value:function(){var e=this;this._disablePointerEventsTimeoutId&&clearTimeout(this._disablePointerEventsTimeoutId),this._disablePointerEventsTimeoutId=setTimeout((function(){(0,e.props.isScrollingChange)(!1),e._disablePointerEventsTimeoutId=null,e.setState({isScrolling:!1})}),150)}},{key:"_invokeOnScrollMemoizer",value:function(e){var t=this,n=e.scrollLeft,r=e.scrollTop,i=e.totalHeight,o=e.totalWidth;this._onScrollMemoizer({callback:function(e){var n=e.scrollLeft,r=e.scrollTop,s=t.props,a=s.height;(0,s.onScroll)({clientHeight:a,clientWidth:s.width,scrollHeight:i,scrollLeft:n,scrollTop:r,scrollWidth:o})},indices:{scrollLeft:n,scrollTop:r}})}},{key:"_setScrollPosition",value:function(e){var t=e.scrollLeft,n=e.scrollTop,r={scrollPositionChangeReason:ne};t>=0&&(r.scrollLeft=t),n>=0&&(r.scrollTop=n),(t>=0&&t!==this.state.scrollLeft||n>=0&&n!==this.state.scrollTop)&&this.setState(r)}}],[{key:"getDerivedStateFromProps",value:function(e,t){return 0!==e.cellCount||0===t.scrollLeft&&0===t.scrollTop?e.scrollLeft!==t.scrollLeft||e.scrollTop!==t.scrollTop?{scrollLeft:null!=e.scrollLeft?e.scrollLeft:t.scrollLeft,scrollTop:null!=e.scrollTop?e.scrollTop:t.scrollTop,scrollPositionChangeReason:ne}:null:{scrollLeft:0,scrollTop:0,scrollPositionChangeReason:ne}}}]),t}(u.PureComponent);(0,l.Z)(re,"defaultProps",{"aria-label":"grid",horizontalOverscanSize:0,noContentRenderer:function(){return null},onScroll:function(){return null},onSectionRendered:function(){return null},scrollToAlignment:"auto",scrollToCell:-1,style:{},verticalOverscanSize:0}),re.propTypes={},(0,h.O)(re);const ie=re;var oe=function(){function e(t){var n=t.height,i=t.width,o=t.x,s=t.y;(0,r.Z)(this,e),this.height=n,this.width=i,this.x=o,this.y=s,this._indexMap={},this._indices=[]}return(0,i.Z)(e,[{key:"addCellIndex",value:function(e){var t=e.index;this._indexMap[t]||(this._indexMap[t]=!0,this._indices.push(t))}},{key:"getCellIndices",value:function(){return this._indices}},{key:"toString",value:function(){return"".concat(this.x,",").concat(this.y," ").concat(this.width,"x").concat(this.height)}}]),e}(),se=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;(0,r.Z)(this,e),this._sectionSize=t,this._cellMetadata=[],this._sections={}}return(0,i.Z)(e,[{key:"getCellIndices",value:function(e){var t=e.height,n=e.width,r=e.x,i=e.y,o={};return this.getSections({height:t,width:n,x:r,y:i}).forEach((function(e){return e.getCellIndices().forEach((function(e){o[e]=e}))})),Object.keys(o).map((function(e){return o[e]}))}},{key:"getCellMetadata",value:function(e){var t=e.index;return this._cellMetadata[t]}},{key:"getSections",value:function(e){for(var t=e.height,n=e.width,r=e.x,i=e.y,o=Math.floor(r/this._sectionSize),s=Math.floor((r+n-1)/this._sectionSize),a=Math.floor(i/this._sectionSize),c=Math.floor((i+t-1)/this._sectionSize),l=[],u=o;u<=s;u++)for(var h=a;h<=c;h++){var d="".concat(u,".").concat(h);this._sections[d]||(this._sections[d]=new oe({height:this._sectionSize,width:this._sectionSize,x:u*this._sectionSize,y:h*this._sectionSize})),l.push(this._sections[d])}return l}},{key:"getTotalSectionCount",value:function(){return Object.keys(this._sections).length}},{key:"toString",value:function(){var e=this;return Object.keys(this._sections).map((function(t){return e._sections[t].toString()}))}},{key:"registerCell",value:function(e){var t=e.cellMetadatum,n=e.index;this._cellMetadata[n]=t,this.getSections(t).forEach((function(e){return e.addCellIndex({index:n})}))}}]),e}();function ae(e){var t=e.align,n=void 0===t?"auto":t,r=e.cellOffset,i=e.cellSize,o=e.containerSize,s=e.currentOffset,a=r,c=a-o+i;switch(n){case"start":return a;case"end":return c;case"center":return a-(o-i)/2;default:return Math.max(c,Math.min(a,s))}}var ce=function(e){function t(e,n){var i;return(0,r.Z)(this,t),(i=(0,o.Z)(this,(0,s.Z)(t).call(this,e,n)))._cellMetadata=[],i._lastRenderedCellIndices=[],i._cellCache=[],i._isScrollingChange=i._isScrollingChange.bind((0,a.Z)(i)),i._setCollectionViewRef=i._setCollectionViewRef.bind((0,a.Z)(i)),i}return(0,c.Z)(t,e),(0,i.Z)(t,[{key:"forceUpdate",value:function(){void 0!==this._collectionView&&this._collectionView.forceUpdate()}},{key:"recomputeCellSizesAndPositions",value:function(){this._cellCache=[],this._collectionView.recomputeCellSizesAndPositions()}},{key:"render",value:function(){var e=(0,d.Z)({},this.props);return u.createElement(ie,(0,d.Z)({cellLayoutManager:this,isScrollingChange:this._isScrollingChange,ref:this._setCollectionViewRef},e))}},{key:"calculateSizeAndPositionData",value:function(){var e=this.props,t=function(e){for(var t=e.cellCount,n=e.cellSizeAndPositionGetter,r=e.sectionSize,i=[],o=new se(r),s=0,a=0,c=0;c<t;c++){var l=n({index:c});if(null==l.height||isNaN(l.height)||null==l.width||isNaN(l.width)||null==l.x||isNaN(l.x)||null==l.y||isNaN(l.y))throw Error("Invalid metadata returned for cell ".concat(c,":\n        x:").concat(l.x,", y:").concat(l.y,", width:").concat(l.width,", height:").concat(l.height));s=Math.max(s,l.y+l.height),a=Math.max(a,l.x+l.width),i[c]=l,o.registerCell({cellMetadatum:l,index:c})}return{cellMetadata:i,height:s,sectionManager:o,width:a}}({cellCount:e.cellCount,cellSizeAndPositionGetter:e.cellSizeAndPositionGetter,sectionSize:e.sectionSize});this._cellMetadata=t.cellMetadata,this._sectionManager=t.sectionManager,this._height=t.height,this._width=t.width}},{key:"getLastRenderedIndices",value:function(){return this._lastRenderedCellIndices}},{key:"getScrollPositionForCell",value:function(e){var t=e.align,n=e.cellIndex,r=e.height,i=e.scrollLeft,o=e.scrollTop,s=e.width,a=this.props.cellCount;if(n>=0&&n<a){var c=this._cellMetadata[n];i=ae({align:t,cellOffset:c.x,cellSize:c.width,containerSize:s,currentOffset:i,targetIndex:n}),o=ae({align:t,cellOffset:c.y,cellSize:c.height,containerSize:r,currentOffset:o,targetIndex:n})}return{scrollLeft:i,scrollTop:o}}},{key:"getTotalSize",value:function(){return{height:this._height,width:this._width}}},{key:"cellRenderers",value:function(e){var t=this,n=e.height,r=e.isScrolling,i=e.width,o=e.x,s=e.y,a=this.props,c=a.cellGroupRenderer,l=a.cellRenderer;return this._lastRenderedCellIndices=this._sectionManager.getCellIndices({height:n,width:i,x:o,y:s}),c({cellCache:this._cellCache,cellRenderer:l,cellSizeAndPositionGetter:function(e){var n=e.index;return t._sectionManager.getCellMetadata({index:n})},indices:this._lastRenderedCellIndices,isScrolling:r})}},{key:"_isScrollingChange",value:function(e){e||(this._cellCache=[])}},{key:"_setCollectionViewRef",value:function(e){this._collectionView=e}}]),t}(u.PureComponent);(0,l.Z)(ce,"defaultProps",{"aria-label":"grid",cellGroupRenderer:function(e){var t=e.cellCache,n=e.cellRenderer,r=e.cellSizeAndPositionGetter,i=e.indices,o=e.isScrolling;return i.map((function(e){var i=r({index:e}),s={index:e,isScrolling:o,key:e,style:{height:i.height,left:i.x,position:"absolute",top:i.y,width:i.width}};return o?(e in t||(t[e]=n(s)),t[e]):n(s)})).filter((function(e){return!!e}))}}),ce.propTypes={};(function(e){function t(e,n){var i;return(0,r.Z)(this,t),(i=(0,o.Z)(this,(0,s.Z)(t).call(this,e,n)))._registerChild=i._registerChild.bind((0,a.Z)(i)),i}return(0,c.Z)(t,e),(0,i.Z)(t,[{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.columnMaxWidth,r=t.columnMinWidth,i=t.columnCount,o=t.width;n===e.columnMaxWidth&&r===e.columnMinWidth&&i===e.columnCount&&o===e.width||this._registeredChild&&this._registeredChild.recomputeGridSize()}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.columnMaxWidth,r=e.columnMinWidth,i=e.columnCount,o=e.width,s=r||1,a=n?Math.min(n,o):o,c=o/i;return c=Math.max(s,c),c=Math.min(a,c),c=Math.floor(c),t({adjustedWidth:Math.min(o,c*i),columnWidth:c,getColumnWidth:function(){return c},registerChild:this._registerChild})}},{key:"_registerChild",value:function(e){if(e&&"function"!==typeof e.recomputeGridSize)throw Error("Unexpected child type registered; only Grid/MultiGrid children are supported.");this._registeredChild=e,this._registeredChild&&this._registeredChild.recomputeGridSize()}}]),t}(u.PureComponent)).propTypes={};var le=n(50676);var ue=n(96410),he=n(82961);function de(e){return function(e){if(Array.isArray(e))return(0,le.Z)(e)}(e)||(0,ue.Z)(e)||(0,he.Z)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var fe=function(e){function t(e,n){var i;return(0,r.Z)(this,t),(i=(0,o.Z)(this,(0,s.Z)(t).call(this,e,n)))._loadMoreRowsMemoizer=w(),i._onRowsRendered=i._onRowsRendered.bind((0,a.Z)(i)),i._registerChild=i._registerChild.bind((0,a.Z)(i)),i}return(0,c.Z)(t,e),(0,i.Z)(t,[{key:"resetLoadMoreRowsCache",value:function(e){this._loadMoreRowsMemoizer=w(),e&&this._doStuff(this._lastRenderedStartIndex,this._lastRenderedStopIndex)}},{key:"render",value:function(){return(0,this.props.children)({onRowsRendered:this._onRowsRendered,registerChild:this._registerChild})}},{key:"_loadUnloadedRanges",value:function(e){var t=this,n=this.props.loadMoreRows;e.forEach((function(e){var r=n(e);r&&r.then((function(){(function(e){var t=e.lastRenderedStartIndex,n=e.lastRenderedStopIndex,r=e.startIndex,i=e.stopIndex;return!(r>n||i<t)})({lastRenderedStartIndex:t._lastRenderedStartIndex,lastRenderedStopIndex:t._lastRenderedStopIndex,startIndex:e.startIndex,stopIndex:e.stopIndex})&&t._registeredChild&&function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n="function"===typeof e.recomputeGridSize?e.recomputeGridSize:e.recomputeRowHeights;n?n.call(e,t):e.forceUpdate()}(t._registeredChild,t._lastRenderedStartIndex)}))}))}},{key:"_onRowsRendered",value:function(e){var t=e.startIndex,n=e.stopIndex;this._lastRenderedStartIndex=t,this._lastRenderedStopIndex=n,this._doStuff(t,n)}},{key:"_doStuff",value:function(e,t){var n,r=this,i=this.props,o=i.isRowLoaded,s=i.minimumBatchSize,a=i.rowCount,c=i.threshold,l=function(e){for(var t=e.isRowLoaded,n=e.minimumBatchSize,r=e.rowCount,i=e.startIndex,o=e.stopIndex,s=[],a=null,c=null,l=i;l<=o;l++){t({index:l})?null!==c&&(s.push({startIndex:a,stopIndex:c}),a=c=null):(c=l,null===a&&(a=l))}if(null!==c){for(var u=Math.min(Math.max(c,a+n-1),r-1),h=c+1;h<=u&&!t({index:h});h++)c=h;s.push({startIndex:a,stopIndex:c})}if(s.length)for(var d=s[0];d.stopIndex-d.startIndex+1<n&&d.startIndex>0;){var f=d.startIndex-1;if(t({index:f}))break;d.startIndex=f}return s}({isRowLoaded:o,minimumBatchSize:s,rowCount:a,startIndex:Math.max(0,e-c),stopIndex:Math.min(a-1,t+c)}),u=(n=[]).concat.apply(n,de(l.map((function(e){return[e.startIndex,e.stopIndex]}))));this._loadMoreRowsMemoizer({callback:function(){r._loadUnloadedRanges(l)},indices:{squashedUnloadedRanges:u}})}},{key:"_registerChild",value:function(e){this._registeredChild=e}}]),t}(u.PureComponent);(0,l.Z)(fe,"defaultProps",{minimumBatchSize:10,rowCount:0,threshold:15}),fe.propTypes={};var pe,ge,ye=(ge=pe=function(e){function t(){var e,n;(0,r.Z)(this,t);for(var i=arguments.length,c=new Array(i),u=0;u<i;u++)c[u]=arguments[u];return n=(0,o.Z)(this,(e=(0,s.Z)(t)).call.apply(e,[this].concat(c))),(0,l.Z)((0,a.Z)(n),"Grid",void 0),(0,l.Z)((0,a.Z)(n),"_cellRenderer",(function(e){var t=e.parent,r=e.rowIndex,i=e.style,o=e.isScrolling,s=e.isVisible,a=e.key,c=n.props.rowRenderer,l=Object.getOwnPropertyDescriptor(i,"width");return l&&l.writable&&(i.width="100%"),c({index:r,style:i,isScrolling:o,isVisible:s,key:a,parent:t})})),(0,l.Z)((0,a.Z)(n),"_setRef",(function(e){n.Grid=e})),(0,l.Z)((0,a.Z)(n),"_onScroll",(function(e){var t=e.clientHeight,r=e.scrollHeight,i=e.scrollTop;(0,n.props.onScroll)({clientHeight:t,scrollHeight:r,scrollTop:i})})),(0,l.Z)((0,a.Z)(n),"_onSectionRendered",(function(e){var t=e.rowOverscanStartIndex,r=e.rowOverscanStopIndex,i=e.rowStartIndex,o=e.rowStopIndex;(0,n.props.onRowsRendered)({overscanStartIndex:t,overscanStopIndex:r,startIndex:i,stopIndex:o})})),n}return(0,c.Z)(t,e),(0,i.Z)(t,[{key:"forceUpdateGrid",value:function(){this.Grid&&this.Grid.forceUpdate()}},{key:"getOffsetForRow",value:function(e){var t=e.alignment,n=e.index;return this.Grid?this.Grid.getOffsetForCell({alignment:t,rowIndex:n,columnIndex:0}).scrollTop:0}},{key:"invalidateCellSizeAfterRender",value:function(e){var t=e.columnIndex,n=e.rowIndex;this.Grid&&this.Grid.invalidateCellSizeAfterRender({rowIndex:n,columnIndex:t})}},{key:"measureAllRows",value:function(){this.Grid&&this.Grid.measureAllCells()}},{key:"recomputeGridSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.columnIndex,n=void 0===t?0:t,r=e.rowIndex,i=void 0===r?0:r;this.Grid&&this.Grid.recomputeGridSize({rowIndex:i,columnIndex:n})}},{key:"recomputeRowHeights",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.Grid&&this.Grid.recomputeGridSize({rowIndex:e,columnIndex:0})}},{key:"scrollToPosition",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.Grid&&this.Grid.scrollToPosition({scrollTop:e})}},{key:"scrollToRow",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.Grid&&this.Grid.scrollToCell({columnIndex:0,rowIndex:e})}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.noRowsRenderer,r=e.scrollToIndex,i=e.width,o=p("ReactVirtualized__List",t);return u.createElement(M,(0,d.Z)({},this.props,{autoContainerWidth:!0,cellRenderer:this._cellRenderer,className:o,columnWidth:i,columnCount:1,noContentRenderer:n,onScroll:this._onScroll,onSectionRendered:this._onSectionRendered,ref:this._setRef,scrollToRow:r}))}}]),t}(u.PureComponent),(0,l.Z)(pe,"propTypes",null),ge);(0,l.Z)(ye,"defaultProps",{autoHeight:!1,estimatedRowSize:30,onScroll:function(){},noRowsRenderer:function(){return null},onRowsRendered:function(){},overscanIndicesGetter:U,overscanRowCount:10,scrollToAlignment:"auto",scrollToIndex:-1,style:{}});var me=n(28481);const ve={ge:function(e,t,n,r,i){return"function"===typeof n?function(e,t,n,r,i){for(var o=n+1;t<=n;){var s=t+n>>>1;i(e[s],r)>=0?(o=s,n=s-1):t=s+1}return o}(e,void 0===r?0:0|r,void 0===i?e.length-1:0|i,t,n):function(e,t,n,r){for(var i=n+1;t<=n;){var o=t+n>>>1;e[o]>=r?(i=o,n=o-1):t=o+1}return i}(e,void 0===n?0:0|n,void 0===r?e.length-1:0|r,t)},gt:function(e,t,n,r,i){return"function"===typeof n?function(e,t,n,r,i){for(var o=n+1;t<=n;){var s=t+n>>>1;i(e[s],r)>0?(o=s,n=s-1):t=s+1}return o}(e,void 0===r?0:0|r,void 0===i?e.length-1:0|i,t,n):function(e,t,n,r){for(var i=n+1;t<=n;){var o=t+n>>>1;e[o]>r?(i=o,n=o-1):t=o+1}return i}(e,void 0===n?0:0|n,void 0===r?e.length-1:0|r,t)},lt:function(e,t,n,r,i){return"function"===typeof n?function(e,t,n,r,i){for(var o=t-1;t<=n;){var s=t+n>>>1;i(e[s],r)<0?(o=s,t=s+1):n=s-1}return o}(e,void 0===r?0:0|r,void 0===i?e.length-1:0|i,t,n):function(e,t,n,r){for(var i=t-1;t<=n;){var o=t+n>>>1;e[o]<r?(i=o,t=o+1):n=o-1}return i}(e,void 0===n?0:0|n,void 0===r?e.length-1:0|r,t)},le:function(e,t,n,r,i){return"function"===typeof n?function(e,t,n,r,i){for(var o=t-1;t<=n;){var s=t+n>>>1;i(e[s],r)<=0?(o=s,t=s+1):n=s-1}return o}(e,void 0===r?0:0|r,void 0===i?e.length-1:0|i,t,n):function(e,t,n,r){for(var i=t-1;t<=n;){var o=t+n>>>1;e[o]<=r?(i=o,t=o+1):n=o-1}return i}(e,void 0===n?0:0|n,void 0===r?e.length-1:0|r,t)},eq:function(e,t,n,r,i){return"function"===typeof n?function(e,t,n,r,i){for(;t<=n;){var o=t+n>>>1,s=i(e[o],r);if(0===s)return o;s<=0?t=o+1:n=o-1}return-1}(e,void 0===r?0:0|r,void 0===i?e.length-1:0|i,t,n):function(e,t,n,r){for(;t<=n;){var i=t+n>>>1,o=e[i];if(o===r)return i;o<=r?t=i+1:n=i-1}return-1}(e,void 0===n?0:0|n,void 0===r?e.length-1:0|r,t)}};function be(e,t,n,r,i){this.mid=e,this.left=t,this.right=n,this.leftPoints=r,this.rightPoints=i,this.count=(t?t.count:0)+(n?n.count:0)+r.length}var we=be.prototype;function Ee(e,t){e.mid=t.mid,e.left=t.left,e.right=t.right,e.leftPoints=t.leftPoints,e.rightPoints=t.rightPoints,e.count=t.count}function Ae(e,t){var n=Pe(t);e.mid=n.mid,e.left=n.left,e.right=n.right,e.leftPoints=n.leftPoints,e.rightPoints=n.rightPoints,e.count=n.count}function Se(e,t){var n=e.intervals([]);n.push(t),Ae(e,n)}function _e(e,t){var n=e.intervals([]),r=n.indexOf(t);return r<0?0:(n.splice(r,1),Ae(e,n),1)}function Ie(e,t,n){for(var r=0;r<e.length&&e[r][0]<=t;++r){var i=n(e[r]);if(i)return i}}function Ce(e,t,n){for(var r=e.length-1;r>=0&&e[r][1]>=t;--r){var i=n(e[r]);if(i)return i}}function Te(e,t){for(var n=0;n<e.length;++n){var r=t(e[n]);if(r)return r}}function ke(e,t){return e-t}function Re(e,t){var n=e[0]-t[0];return n||e[1]-t[1]}function xe(e,t){var n=e[1]-t[1];return n||e[0]-t[0]}function Pe(e){if(0===e.length)return null;for(var t=[],n=0;n<e.length;++n)t.push(e[n][0],e[n][1]);t.sort(ke);var r=t[t.length>>1],i=[],o=[],s=[];for(n=0;n<e.length;++n){var a=e[n];a[1]<r?i.push(a):r<a[0]?o.push(a):s.push(a)}var c=s,l=s.slice();return c.sort(Re),l.sort(xe),new be(r,Pe(i),Pe(o),c,l)}function De(e){this.root=e}we.intervals=function(e){return e.push.apply(e,this.leftPoints),this.left&&this.left.intervals(e),this.right&&this.right.intervals(e),e},we.insert=function(e){var t=this.count-this.leftPoints.length;if(this.count+=1,e[1]<this.mid)this.left?4*(this.left.count+1)>3*(t+1)?Se(this,e):this.left.insert(e):this.left=Pe([e]);else if(e[0]>this.mid)this.right?4*(this.right.count+1)>3*(t+1)?Se(this,e):this.right.insert(e):this.right=Pe([e]);else{var n=ve.ge(this.leftPoints,e,Re),r=ve.ge(this.rightPoints,e,xe);this.leftPoints.splice(n,0,e),this.rightPoints.splice(r,0,e)}},we.remove=function(e){var t=this.count-this.leftPoints;if(e[1]<this.mid)return this.left?4*(this.right?this.right.count:0)>3*(t-1)?_e(this,e):2===(o=this.left.remove(e))?(this.left=null,this.count-=1,1):(1===o&&(this.count-=1),o):0;if(e[0]>this.mid)return this.right?4*(this.left?this.left.count:0)>3*(t-1)?_e(this,e):2===(o=this.right.remove(e))?(this.right=null,this.count-=1,1):(1===o&&(this.count-=1),o):0;if(1===this.count)return this.leftPoints[0]===e?2:0;if(1===this.leftPoints.length&&this.leftPoints[0]===e){if(this.left&&this.right){for(var n=this,r=this.left;r.right;)n=r,r=r.right;if(n===this)r.right=this.right;else{var i=this.left,o=this.right;n.count-=r.count,n.right=r.left,r.left=i,r.right=o}Ee(this,r),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?Ee(this,this.left):Ee(this,this.right);return 1}for(i=ve.ge(this.leftPoints,e,Re);i<this.leftPoints.length&&this.leftPoints[i][0]===e[0];++i)if(this.leftPoints[i]===e){this.count-=1,this.leftPoints.splice(i,1);for(o=ve.ge(this.rightPoints,e,xe);o<this.rightPoints.length&&this.rightPoints[o][1]===e[1];++o)if(this.rightPoints[o]===e)return this.rightPoints.splice(o,1),1}return 0},we.queryPoint=function(e,t){if(e<this.mid){if(this.left)if(n=this.left.queryPoint(e,t))return n;return Ie(this.leftPoints,e,t)}if(e>this.mid){var n;if(this.right)if(n=this.right.queryPoint(e,t))return n;return Ce(this.rightPoints,e,t)}return Te(this.leftPoints,t)},we.queryInterval=function(e,t,n){var r;if(e<this.mid&&this.left&&(r=this.left.queryInterval(e,t,n)))return r;if(t>this.mid&&this.right&&(r=this.right.queryInterval(e,t,n)))return r;return t<this.mid?Ie(this.leftPoints,t,n):e>this.mid?Ce(this.rightPoints,e,n):Te(this.leftPoints,n)};var Oe=De.prototype;Oe.insert=function(e){this.root?this.root.insert(e):this.root=new be(e[0],null,null,[e],[e])},Oe.remove=function(e){if(this.root){var t=this.root.remove(e);return 2===t&&(this.root=null),0!==t}return!1},Oe.queryPoint=function(e,t){if(this.root)return this.root.queryPoint(e,t)},Oe.queryInterval=function(e,t,n){if(e<=t&&this.root)return this.root.queryInterval(e,t,n)},Object.defineProperty(Oe,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(Oe,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}});var Ne,Be,Le=function(){function e(){var t;(0,r.Z)(this,e),(0,l.Z)(this,"_columnSizeMap",{}),(0,l.Z)(this,"_intervalTree",t&&0!==t.length?new De(Pe(t)):new De(null)),(0,l.Z)(this,"_leftMap",{})}return(0,i.Z)(e,[{key:"estimateTotalHeight",value:function(e,t,n){var r=e-this.count;return this.tallestColumnSize+Math.ceil(r/t)*n}},{key:"range",value:function(e,t,n){var r=this;this._intervalTree.queryInterval(e,e+t,(function(e){var t=(0,me.Z)(e,3),i=t[0],o=(t[1],t[2]);return n(o,r._leftMap[o],i)}))}},{key:"setPosition",value:function(e,t,n,r){this._intervalTree.insert([n,n+r,e]),this._leftMap[e]=t;var i=this._columnSizeMap,o=i[t];i[t]=void 0===o?n+r:Math.max(o,n+r)}},{key:"count",get:function(){return this._intervalTree.count}},{key:"shortestColumnSize",get:function(){var e=this._columnSizeMap,t=0;for(var n in e){var r=e[n];t=0===t?r:Math.min(t,r)}return t}},{key:"tallestColumnSize",get:function(){var e=this._columnSizeMap,t=0;for(var n in e){var r=e[n];t=Math.max(t,r)}return t}}]),e}();function Me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ue(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Me(n,!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Me(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Fe=(Be=Ne=function(e){function t(){var e,n;(0,r.Z)(this,t);for(var i=arguments.length,c=new Array(i),u=0;u<i;u++)c[u]=arguments[u];return n=(0,o.Z)(this,(e=(0,s.Z)(t)).call.apply(e,[this].concat(c))),(0,l.Z)((0,a.Z)(n),"state",{isScrolling:!1,scrollTop:0}),(0,l.Z)((0,a.Z)(n),"_debounceResetIsScrollingId",void 0),(0,l.Z)((0,a.Z)(n),"_invalidateOnUpdateStartIndex",null),(0,l.Z)((0,a.Z)(n),"_invalidateOnUpdateStopIndex",null),(0,l.Z)((0,a.Z)(n),"_positionCache",new Le),(0,l.Z)((0,a.Z)(n),"_startIndex",null),(0,l.Z)((0,a.Z)(n),"_startIndexMemoized",null),(0,l.Z)((0,a.Z)(n),"_stopIndex",null),(0,l.Z)((0,a.Z)(n),"_stopIndexMemoized",null),(0,l.Z)((0,a.Z)(n),"_debounceResetIsScrollingCallback",(function(){n.setState({isScrolling:!1})})),(0,l.Z)((0,a.Z)(n),"_setScrollingContainerRef",(function(e){n._scrollingContainer=e})),(0,l.Z)((0,a.Z)(n),"_onScroll",(function(e){var t=n.props.height,r=e.currentTarget.scrollTop,i=Math.min(Math.max(0,n._getEstimatedTotalHeight()-t),r);r===i&&(n._debounceResetIsScrolling(),n.state.scrollTop!==i&&n.setState({isScrolling:!0,scrollTop:i}))})),n}return(0,c.Z)(t,e),(0,i.Z)(t,[{key:"clearCellPositions",value:function(){this._positionCache=new Le,this.forceUpdate()}},{key:"invalidateCellSizeAfterRender",value:function(e){var t=e.rowIndex;null===this._invalidateOnUpdateStartIndex?(this._invalidateOnUpdateStartIndex=t,this._invalidateOnUpdateStopIndex=t):(this._invalidateOnUpdateStartIndex=Math.min(this._invalidateOnUpdateStartIndex,t),this._invalidateOnUpdateStopIndex=Math.max(this._invalidateOnUpdateStopIndex,t))}},{key:"recomputeCellPositions",value:function(){var e=this._positionCache.count-1;this._positionCache=new Le,this._populatePositionCache(0,e),this.forceUpdate()}},{key:"componentDidMount",value:function(){this._checkInvalidateOnUpdate(),this._invokeOnScrollCallback(),this._invokeOnCellsRenderedCallback()}},{key:"componentDidUpdate",value:function(e,t){this._checkInvalidateOnUpdate(),this._invokeOnScrollCallback(),this._invokeOnCellsRenderedCallback(),this.props.scrollTop!==e.scrollTop&&this._debounceResetIsScrolling()}},{key:"componentWillUnmount",value:function(){this._debounceResetIsScrollingId&&x(this._debounceResetIsScrollingId)}},{key:"render",value:function(){var e,t=this,n=this.props,r=n.autoHeight,i=n.cellCount,o=n.cellMeasurerCache,s=n.cellRenderer,a=n.className,c=n.height,h=n.id,d=n.keyMapper,f=n.overscanByPixels,g=n.role,y=n.style,m=n.tabIndex,v=n.width,b=n.rowDirection,w=this.state,E=w.isScrolling,A=w.scrollTop,S=[],_=this._getEstimatedTotalHeight(),I=this._positionCache.shortestColumnSize,C=this._positionCache.count,T=0;if(this._positionCache.range(Math.max(0,A-f),c+2*f,(function(n,r,i){var a;"undefined"===typeof e?(T=n,e=n):(T=Math.min(T,n),e=Math.max(e,n)),S.push(s({index:n,isScrolling:E,key:d(n),parent:t,style:(a={height:o.getHeight(n)},(0,l.Z)(a,"ltr"===b?"left":"right",r),(0,l.Z)(a,"position","absolute"),(0,l.Z)(a,"top",i),(0,l.Z)(a,"width",o.getWidth(n)),a)}))})),I<A+c+f&&C<i)for(var k=Math.min(i-C,Math.ceil((A+c+f-I)/o.defaultHeight*v/o.defaultWidth)),R=C;R<C+k;R++)e=R,S.push(s({index:R,isScrolling:E,key:d(R),parent:this,style:{width:o.getWidth(R)}}));return this._startIndex=T,this._stopIndex=e,u.createElement("div",{ref:this._setScrollingContainerRef,"aria-label":this.props["aria-label"],className:p("ReactVirtualized__Masonry",a),id:h,onScroll:this._onScroll,role:g,style:Ue({boxSizing:"border-box",direction:"ltr",height:r?"auto":c,overflowX:"hidden",overflowY:_<c?"hidden":"auto",position:"relative",width:v,WebkitOverflowScrolling:"touch",willChange:"transform"},y),tabIndex:m},u.createElement("div",{className:"ReactVirtualized__Masonry__innerScrollContainer",style:{width:"100%",height:_,maxWidth:"100%",maxHeight:_,overflow:"hidden",pointerEvents:E?"none":"",position:"relative"}},S))}},{key:"_checkInvalidateOnUpdate",value:function(){if("number"===typeof this._invalidateOnUpdateStartIndex){var e=this._invalidateOnUpdateStartIndex,t=this._invalidateOnUpdateStopIndex;this._invalidateOnUpdateStartIndex=null,this._invalidateOnUpdateStopIndex=null,this._populatePositionCache(e,t),this.forceUpdate()}}},{key:"_debounceResetIsScrolling",value:function(){var e=this.props.scrollingResetTimeInterval;this._debounceResetIsScrollingId&&x(this._debounceResetIsScrollingId),this._debounceResetIsScrollingId=P(this._debounceResetIsScrollingCallback,e)}},{key:"_getEstimatedTotalHeight",value:function(){var e=this.props,t=e.cellCount,n=e.cellMeasurerCache,r=e.width,i=Math.max(1,Math.floor(r/n.defaultWidth));return this._positionCache.estimateTotalHeight(t,i,n.defaultHeight)}},{key:"_invokeOnScrollCallback",value:function(){var e=this.props,t=e.height,n=e.onScroll,r=this.state.scrollTop;this._onScrollMemoized!==r&&(n({clientHeight:t,scrollHeight:this._getEstimatedTotalHeight(),scrollTop:r}),this._onScrollMemoized=r)}},{key:"_invokeOnCellsRenderedCallback",value:function(){this._startIndexMemoized===this._startIndex&&this._stopIndexMemoized===this._stopIndex||((0,this.props.onCellsRendered)({startIndex:this._startIndex,stopIndex:this._stopIndex}),this._startIndexMemoized=this._startIndex,this._stopIndexMemoized=this._stopIndex)}},{key:"_populatePositionCache",value:function(e,t){for(var n=this.props,r=n.cellMeasurerCache,i=n.cellPositioner,o=e;o<=t;o++){var s=i(o),a=s.left,c=s.top;this._positionCache.setPosition(o,a,c,r.getHeight(o))}}}],[{key:"getDerivedStateFromProps",value:function(e,t){return void 0!==e.scrollTop&&t.scrollTop!==e.scrollTop?{isScrolling:!0,scrollTop:e.scrollTop}:null}}]),t}(u.PureComponent),(0,l.Z)(Ne,"propTypes",null),Be);function Ke(){}(0,l.Z)(Fe,"defaultProps",{autoHeight:!1,keyMapper:function(e){return e},onCellsRendered:Ke,onScroll:Ke,overscanByPixels:20,role:"grid",scrollingResetTimeInterval:150,style:{},tabIndex:0,rowDirection:"ltr"});(0,h.O)(Fe);var je=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,r.Z)(this,e),(0,l.Z)(this,"_cellMeasurerCache",void 0),(0,l.Z)(this,"_columnIndexOffset",void 0),(0,l.Z)(this,"_rowIndexOffset",void 0),(0,l.Z)(this,"columnWidth",(function(e){var n=e.index;t._cellMeasurerCache.columnWidth({index:n+t._columnIndexOffset})})),(0,l.Z)(this,"rowHeight",(function(e){var n=e.index;t._cellMeasurerCache.rowHeight({index:n+t._rowIndexOffset})}));var i=n.cellMeasurerCache,o=n.columnIndexOffset,s=void 0===o?0:o,a=n.rowIndexOffset,c=void 0===a?0:a;this._cellMeasurerCache=i,this._columnIndexOffset=s,this._rowIndexOffset=c}return(0,i.Z)(e,[{key:"clear",value:function(e,t){this._cellMeasurerCache.clear(e+this._rowIndexOffset,t+this._columnIndexOffset)}},{key:"clearAll",value:function(){this._cellMeasurerCache.clearAll()}},{key:"hasFixedHeight",value:function(){return this._cellMeasurerCache.hasFixedHeight()}},{key:"hasFixedWidth",value:function(){return this._cellMeasurerCache.hasFixedWidth()}},{key:"getHeight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._cellMeasurerCache.getHeight(e+this._rowIndexOffset,t+this._columnIndexOffset)}},{key:"getWidth",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._cellMeasurerCache.getWidth(e+this._rowIndexOffset,t+this._columnIndexOffset)}},{key:"has",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._cellMeasurerCache.has(e+this._rowIndexOffset,t+this._columnIndexOffset)}},{key:"set",value:function(e,t,n,r){this._cellMeasurerCache.set(e+this._rowIndexOffset,t+this._columnIndexOffset,n,r)}},{key:"defaultHeight",get:function(){return this._cellMeasurerCache.defaultHeight}},{key:"defaultWidth",get:function(){return this._cellMeasurerCache.defaultWidth}}]),e}();function Ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ze(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ze(n,!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ze(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ve=function(e){function t(e,n){var i;(0,r.Z)(this,t),i=(0,o.Z)(this,(0,s.Z)(t).call(this,e,n)),(0,l.Z)((0,a.Z)(i),"state",{scrollLeft:0,scrollTop:0,scrollbarSize:0,showHorizontalScrollbar:!1,showVerticalScrollbar:!1}),(0,l.Z)((0,a.Z)(i),"_deferredInvalidateColumnIndex",null),(0,l.Z)((0,a.Z)(i),"_deferredInvalidateRowIndex",null),(0,l.Z)((0,a.Z)(i),"_bottomLeftGridRef",(function(e){i._bottomLeftGrid=e})),(0,l.Z)((0,a.Z)(i),"_bottomRightGridRef",(function(e){i._bottomRightGrid=e})),(0,l.Z)((0,a.Z)(i),"_cellRendererBottomLeftGrid",(function(e){var t=e.rowIndex,n=(0,y.Z)(e,["rowIndex"]),r=i.props,o=r.cellRenderer,s=r.fixedRowCount;return t===r.rowCount-s?u.createElement("div",{key:n.key,style:ze({},n.style,{height:20})}):o(ze({},n,{parent:(0,a.Z)(i),rowIndex:t+s}))})),(0,l.Z)((0,a.Z)(i),"_cellRendererBottomRightGrid",(function(e){var t=e.columnIndex,n=e.rowIndex,r=(0,y.Z)(e,["columnIndex","rowIndex"]),o=i.props,s=o.cellRenderer,c=o.fixedColumnCount,l=o.fixedRowCount;return s(ze({},r,{columnIndex:t+c,parent:(0,a.Z)(i),rowIndex:n+l}))})),(0,l.Z)((0,a.Z)(i),"_cellRendererTopRightGrid",(function(e){var t=e.columnIndex,n=(0,y.Z)(e,["columnIndex"]),r=i.props,o=r.cellRenderer,s=r.columnCount,c=r.fixedColumnCount;return t===s-c?u.createElement("div",{key:n.key,style:ze({},n.style,{width:20})}):o(ze({},n,{columnIndex:t+c,parent:(0,a.Z)(i)}))})),(0,l.Z)((0,a.Z)(i),"_columnWidthRightGrid",(function(e){var t=e.index,n=i.props,r=n.columnCount,o=n.fixedColumnCount,s=n.columnWidth,a=i.state,c=a.scrollbarSize;return a.showHorizontalScrollbar&&t===r-o?c:"function"===typeof s?s({index:t+o}):s})),(0,l.Z)((0,a.Z)(i),"_onScroll",(function(e){var t=e.scrollLeft,n=e.scrollTop;i.setState({scrollLeft:t,scrollTop:n});var r=i.props.onScroll;r&&r(e)})),(0,l.Z)((0,a.Z)(i),"_onScrollbarPresenceChange",(function(e){var t=e.horizontal,n=e.size,r=e.vertical,o=i.state,s=o.showHorizontalScrollbar,a=o.showVerticalScrollbar;if(t!==s||r!==a){i.setState({scrollbarSize:n,showHorizontalScrollbar:t,showVerticalScrollbar:r});var c=i.props.onScrollbarPresenceChange;"function"===typeof c&&c({horizontal:t,size:n,vertical:r})}})),(0,l.Z)((0,a.Z)(i),"_onScrollLeft",(function(e){var t=e.scrollLeft;i._onScroll({scrollLeft:t,scrollTop:i.state.scrollTop})})),(0,l.Z)((0,a.Z)(i),"_onScrollTop",(function(e){var t=e.scrollTop;i._onScroll({scrollTop:t,scrollLeft:i.state.scrollLeft})})),(0,l.Z)((0,a.Z)(i),"_rowHeightBottomGrid",(function(e){var t=e.index,n=i.props,r=n.fixedRowCount,o=n.rowCount,s=n.rowHeight,a=i.state,c=a.scrollbarSize;return a.showVerticalScrollbar&&t===o-r?c:"function"===typeof s?s({index:t+r}):s})),(0,l.Z)((0,a.Z)(i),"_topLeftGridRef",(function(e){i._topLeftGrid=e})),(0,l.Z)((0,a.Z)(i),"_topRightGridRef",(function(e){i._topRightGrid=e}));var c=e.deferredMeasurementCache,h=e.fixedColumnCount,d=e.fixedRowCount;return i._maybeCalculateCachedStyles(!0),c&&(i._deferredMeasurementCacheBottomLeftGrid=d>0?new je({cellMeasurerCache:c,columnIndexOffset:0,rowIndexOffset:d}):c,i._deferredMeasurementCacheBottomRightGrid=h>0||d>0?new je({cellMeasurerCache:c,columnIndexOffset:h,rowIndexOffset:d}):c,i._deferredMeasurementCacheTopRightGrid=h>0?new je({cellMeasurerCache:c,columnIndexOffset:h,rowIndexOffset:0}):c),i}return(0,c.Z)(t,e),(0,i.Z)(t,[{key:"forceUpdateGrids",value:function(){this._bottomLeftGrid&&this._bottomLeftGrid.forceUpdate(),this._bottomRightGrid&&this._bottomRightGrid.forceUpdate(),this._topLeftGrid&&this._topLeftGrid.forceUpdate(),this._topRightGrid&&this._topRightGrid.forceUpdate()}},{key:"invalidateCellSizeAfterRender",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.columnIndex,n=void 0===t?0:t,r=e.rowIndex,i=void 0===r?0:r;this._deferredInvalidateColumnIndex="number"===typeof this._deferredInvalidateColumnIndex?Math.min(this._deferredInvalidateColumnIndex,n):n,this._deferredInvalidateRowIndex="number"===typeof this._deferredInvalidateRowIndex?Math.min(this._deferredInvalidateRowIndex,i):i}},{key:"measureAllCells",value:function(){this._bottomLeftGrid&&this._bottomLeftGrid.measureAllCells(),this._bottomRightGrid&&this._bottomRightGrid.measureAllCells(),this._topLeftGrid&&this._topLeftGrid.measureAllCells(),this._topRightGrid&&this._topRightGrid.measureAllCells()}},{key:"recomputeGridSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.columnIndex,n=void 0===t?0:t,r=e.rowIndex,i=void 0===r?0:r,o=this.props,s=o.fixedColumnCount,a=o.fixedRowCount,c=Math.max(0,n-s),l=Math.max(0,i-a);this._bottomLeftGrid&&this._bottomLeftGrid.recomputeGridSize({columnIndex:n,rowIndex:l}),this._bottomRightGrid&&this._bottomRightGrid.recomputeGridSize({columnIndex:c,rowIndex:l}),this._topLeftGrid&&this._topLeftGrid.recomputeGridSize({columnIndex:n,rowIndex:i}),this._topRightGrid&&this._topRightGrid.recomputeGridSize({columnIndex:c,rowIndex:i}),this._leftGridWidth=null,this._topGridHeight=null,this._maybeCalculateCachedStyles(!0)}},{key:"componentDidMount",value:function(){var e=this.props,t=e.scrollLeft,n=e.scrollTop;if(t>0||n>0){var r={};t>0&&(r.scrollLeft=t),n>0&&(r.scrollTop=n),this.setState(r)}this._handleInvalidatedGridSize()}},{key:"componentDidUpdate",value:function(){this._handleInvalidatedGridSize()}},{key:"render",value:function(){var e=this.props,t=e.onScroll,n=e.onSectionRendered,r=(e.onScrollbarPresenceChange,e.scrollLeft,e.scrollToColumn),i=(e.scrollTop,e.scrollToRow),o=(0,y.Z)(e,["onScroll","onSectionRendered","onScrollbarPresenceChange","scrollLeft","scrollToColumn","scrollTop","scrollToRow"]);if(this._prepareForRender(),0===this.props.width||0===this.props.height)return null;var s=this.state,a=s.scrollLeft,c=s.scrollTop;return u.createElement("div",{style:this._containerOuterStyle},u.createElement("div",{style:this._containerTopStyle},this._renderTopLeftGrid(o),this._renderTopRightGrid(ze({},o,{onScroll:t,scrollLeft:a}))),u.createElement("div",{style:this._containerBottomStyle},this._renderBottomLeftGrid(ze({},o,{onScroll:t,scrollTop:c})),this._renderBottomRightGrid(ze({},o,{onScroll:t,onSectionRendered:n,scrollLeft:a,scrollToColumn:r,scrollToRow:i,scrollTop:c}))))}},{key:"_getBottomGridHeight",value:function(e){return e.height-this._getTopGridHeight(e)}},{key:"_getLeftGridWidth",value:function(e){var t=e.fixedColumnCount,n=e.columnWidth;if(null==this._leftGridWidth)if("function"===typeof n){for(var r=0,i=0;i<t;i++)r+=n({index:i});this._leftGridWidth=r}else this._leftGridWidth=n*t;return this._leftGridWidth}},{key:"_getRightGridWidth",value:function(e){return e.width-this._getLeftGridWidth(e)}},{key:"_getTopGridHeight",value:function(e){var t=e.fixedRowCount,n=e.rowHeight;if(null==this._topGridHeight)if("function"===typeof n){for(var r=0,i=0;i<t;i++)r+=n({index:i});this._topGridHeight=r}else this._topGridHeight=n*t;return this._topGridHeight}},{key:"_handleInvalidatedGridSize",value:function(){if("number"===typeof this._deferredInvalidateColumnIndex){var e=this._deferredInvalidateColumnIndex,t=this._deferredInvalidateRowIndex;this._deferredInvalidateColumnIndex=null,this._deferredInvalidateRowIndex=null,this.recomputeGridSize({columnIndex:e,rowIndex:t}),this.forceUpdate()}}},{key:"_maybeCalculateCachedStyles",value:function(e){var t=this.props,n=t.columnWidth,r=t.enableFixedColumnScroll,i=t.enableFixedRowScroll,o=t.height,s=t.fixedColumnCount,a=t.fixedRowCount,c=t.rowHeight,l=t.style,u=t.styleBottomLeftGrid,h=t.styleBottomRightGrid,d=t.styleTopLeftGrid,f=t.styleTopRightGrid,p=t.width,g=e||o!==this._lastRenderedHeight||p!==this._lastRenderedWidth,y=e||n!==this._lastRenderedColumnWidth||s!==this._lastRenderedFixedColumnCount,m=e||a!==this._lastRenderedFixedRowCount||c!==this._lastRenderedRowHeight;(e||g||l!==this._lastRenderedStyle)&&(this._containerOuterStyle=ze({height:o,overflow:"visible",width:p},l)),(e||g||m)&&(this._containerTopStyle={height:this._getTopGridHeight(this.props),position:"relative",width:p},this._containerBottomStyle={height:o-this._getTopGridHeight(this.props),overflow:"visible",position:"relative",width:p}),(e||u!==this._lastRenderedStyleBottomLeftGrid)&&(this._bottomLeftGridStyle=ze({left:0,overflowX:"hidden",overflowY:r?"auto":"hidden",position:"absolute"},u)),(e||y||h!==this._lastRenderedStyleBottomRightGrid)&&(this._bottomRightGridStyle=ze({left:this._getLeftGridWidth(this.props),position:"absolute"},h)),(e||d!==this._lastRenderedStyleTopLeftGrid)&&(this._topLeftGridStyle=ze({left:0,overflowX:"hidden",overflowY:"hidden",position:"absolute",top:0},d)),(e||y||f!==this._lastRenderedStyleTopRightGrid)&&(this._topRightGridStyle=ze({left:this._getLeftGridWidth(this.props),overflowX:i?"auto":"hidden",overflowY:"hidden",position:"absolute",top:0},f)),this._lastRenderedColumnWidth=n,this._lastRenderedFixedColumnCount=s,this._lastRenderedFixedRowCount=a,this._lastRenderedHeight=o,this._lastRenderedRowHeight=c,this._lastRenderedStyle=l,this._lastRenderedStyleBottomLeftGrid=u,this._lastRenderedStyleBottomRightGrid=h,this._lastRenderedStyleTopLeftGrid=d,this._lastRenderedStyleTopRightGrid=f,this._lastRenderedWidth=p}},{key:"_prepareForRender",value:function(){this._lastRenderedColumnWidth===this.props.columnWidth&&this._lastRenderedFixedColumnCount===this.props.fixedColumnCount||(this._leftGridWidth=null),this._lastRenderedFixedRowCount===this.props.fixedRowCount&&this._lastRenderedRowHeight===this.props.rowHeight||(this._topGridHeight=null),this._maybeCalculateCachedStyles(),this._lastRenderedColumnWidth=this.props.columnWidth,this._lastRenderedFixedColumnCount=this.props.fixedColumnCount,this._lastRenderedFixedRowCount=this.props.fixedRowCount,this._lastRenderedRowHeight=this.props.rowHeight}},{key:"_renderBottomLeftGrid",value:function(e){var t=e.enableFixedColumnScroll,n=e.fixedColumnCount,r=e.fixedRowCount,i=e.rowCount,o=e.hideBottomLeftGridScrollbar,s=this.state.showVerticalScrollbar;if(!n)return null;var a=s?1:0,c=this._getBottomGridHeight(e),l=this._getLeftGridWidth(e),h=this.state.showVerticalScrollbar?this.state.scrollbarSize:0,f=o?l+h:l,p=u.createElement(M,(0,d.Z)({},e,{cellRenderer:this._cellRendererBottomLeftGrid,className:this.props.classNameBottomLeftGrid,columnCount:n,deferredMeasurementCache:this._deferredMeasurementCacheBottomLeftGrid,height:c,onScroll:t?this._onScrollTop:void 0,ref:this._bottomLeftGridRef,rowCount:Math.max(0,i-r)+a,rowHeight:this._rowHeightBottomGrid,style:this._bottomLeftGridStyle,tabIndex:null,width:f}));return o?u.createElement("div",{className:"BottomLeftGrid_ScrollWrapper",style:ze({},this._bottomLeftGridStyle,{height:c,width:l,overflowY:"hidden"})},p):p}},{key:"_renderBottomRightGrid",value:function(e){var t=e.columnCount,n=e.fixedColumnCount,r=e.fixedRowCount,i=e.rowCount,o=e.scrollToColumn,s=e.scrollToRow;return u.createElement(M,(0,d.Z)({},e,{cellRenderer:this._cellRendererBottomRightGrid,className:this.props.classNameBottomRightGrid,columnCount:Math.max(0,t-n),columnWidth:this._columnWidthRightGrid,deferredMeasurementCache:this._deferredMeasurementCacheBottomRightGrid,height:this._getBottomGridHeight(e),onScroll:this._onScroll,onScrollbarPresenceChange:this._onScrollbarPresenceChange,ref:this._bottomRightGridRef,rowCount:Math.max(0,i-r),rowHeight:this._rowHeightBottomGrid,scrollToColumn:o-n,scrollToRow:s-r,style:this._bottomRightGridStyle,width:this._getRightGridWidth(e)}))}},{key:"_renderTopLeftGrid",value:function(e){var t=e.fixedColumnCount,n=e.fixedRowCount;return t&&n?u.createElement(M,(0,d.Z)({},e,{className:this.props.classNameTopLeftGrid,columnCount:t,height:this._getTopGridHeight(e),ref:this._topLeftGridRef,rowCount:n,style:this._topLeftGridStyle,tabIndex:null,width:this._getLeftGridWidth(e)})):null}},{key:"_renderTopRightGrid",value:function(e){var t=e.columnCount,n=e.enableFixedRowScroll,r=e.fixedColumnCount,i=e.fixedRowCount,o=e.scrollLeft,s=e.hideTopRightGridScrollbar,a=this.state,c=a.showHorizontalScrollbar,l=a.scrollbarSize;if(!i)return null;var h=c?1:0,f=this._getTopGridHeight(e),p=this._getRightGridWidth(e),g=c?l:0,y=f,m=this._topRightGridStyle;s&&(y=f+g,m=ze({},this._topRightGridStyle,{left:0}));var v=u.createElement(M,(0,d.Z)({},e,{cellRenderer:this._cellRendererTopRightGrid,className:this.props.classNameTopRightGrid,columnCount:Math.max(0,t-r)+h,columnWidth:this._columnWidthRightGrid,deferredMeasurementCache:this._deferredMeasurementCacheTopRightGrid,height:y,onScroll:n?this._onScrollLeft:void 0,ref:this._topRightGridRef,rowCount:i,scrollLeft:o,style:m,tabIndex:null,width:p}));return s?u.createElement("div",{className:"TopRightGrid_ScrollWrapper",style:ze({},this._topRightGridStyle,{height:f,width:p,overflowX:"hidden"})},v):v}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.scrollLeft!==t.scrollLeft||e.scrollTop!==t.scrollTop?{scrollLeft:null!=e.scrollLeft&&e.scrollLeft>=0?e.scrollLeft:t.scrollLeft,scrollTop:null!=e.scrollTop&&e.scrollTop>=0?e.scrollTop:t.scrollTop}:null}}]),t}(u.PureComponent);(0,l.Z)(Ve,"defaultProps",{classNameBottomLeftGrid:"",classNameBottomRightGrid:"",classNameTopLeftGrid:"",classNameTopRightGrid:"",enableFixedColumnScroll:!1,enableFixedRowScroll:!1,fixedColumnCount:0,fixedRowCount:0,scrollToColumn:-1,scrollToRow:-1,style:{},styleBottomLeftGrid:{},styleBottomRightGrid:{},styleTopLeftGrid:{},styleTopRightGrid:{},hideTopRightGridScrollbar:!1,hideBottomLeftGridScrollbar:!1}),Ve.propTypes={},(0,h.O)(Ve);(function(e){function t(e,n){var i;return(0,r.Z)(this,t),(i=(0,o.Z)(this,(0,s.Z)(t).call(this,e,n))).state={clientHeight:0,clientWidth:0,scrollHeight:0,scrollLeft:0,scrollTop:0,scrollWidth:0},i._onScroll=i._onScroll.bind((0,a.Z)(i)),i}return(0,c.Z)(t,e),(0,i.Z)(t,[{key:"render",value:function(){var e=this.props.children,t=this.state,n=t.clientHeight,r=t.clientWidth,i=t.scrollHeight,o=t.scrollLeft,s=t.scrollTop,a=t.scrollWidth;return e({clientHeight:n,clientWidth:r,onScroll:this._onScroll,scrollHeight:i,scrollLeft:o,scrollTop:s,scrollWidth:a})}},{key:"_onScroll",value:function(e){var t=e.clientHeight,n=e.clientWidth,r=e.scrollHeight,i=e.scrollLeft,o=e.scrollTop,s=e.scrollWidth;this.setState({clientHeight:t,clientWidth:n,scrollHeight:r,scrollLeft:i,scrollTop:o,scrollWidth:s})}}]),t}(u.PureComponent)).propTypes={};function He(e){var t=e.className,n=e.columns,r=e.style;return u.createElement("div",{className:t,role:"row",style:r},n)}He.propTypes=null;const qe={ASC:"ASC",DESC:"DESC"};function Ge(e){var t=e.sortDirection,n=p("ReactVirtualized__Table__sortableHeaderIcon",{"ReactVirtualized__Table__sortableHeaderIcon--ASC":t===qe.ASC,"ReactVirtualized__Table__sortableHeaderIcon--DESC":t===qe.DESC});return u.createElement("svg",{className:n,width:18,height:18,viewBox:"0 0 24 24"},t===qe.ASC?u.createElement("path",{d:"M7 14l5-5 5 5z"}):u.createElement("path",{d:"M7 10l5 5 5-5z"}),u.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}))}function We(e){var t=e.dataKey,n=e.label,r=e.sortBy,i=e.sortDirection,o=r===t,s=[u.createElement("span",{className:"ReactVirtualized__Table__headerTruncatedText",key:"label",title:"string"===typeof n?n:null},n)];return o&&s.push(u.createElement(Ge,{key:"SortIndicator",sortDirection:i})),s}function Qe(e){var t=e.className,n=e.columns,r=e.index,i=e.key,o=e.onRowClick,s=e.onRowDoubleClick,a=e.onRowMouseOut,c=e.onRowMouseOver,l=e.onRowRightClick,h=e.rowData,f=e.style,p={"aria-rowindex":r+1};return(o||s||a||c||l)&&(p["aria-label"]="row",p.tabIndex=0,o&&(p.onClick=function(e){return o({event:e,index:r,rowData:h})}),s&&(p.onDoubleClick=function(e){return s({event:e,index:r,rowData:h})}),a&&(p.onMouseOut=function(e){return a({event:e,index:r,rowData:h})}),c&&(p.onMouseOver=function(e){return c({event:e,index:r,rowData:h})}),l&&(p.onContextMenu=function(e){return l({event:e,index:r,rowData:h})})),u.createElement("div",(0,d.Z)({},p,{className:t,key:i,role:"row",style:f}),n)}Ge.propTypes={},We.propTypes=null,Qe.propTypes=null;var Ye=function(e){function t(){return(0,r.Z)(this,t),(0,o.Z)(this,(0,s.Z)(t).apply(this,arguments))}return(0,c.Z)(t,e),t}(u.Component);function Je(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Xe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Je(n,!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Je(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}(0,l.Z)(Ye,"defaultProps",{cellDataGetter:function(e){var t=e.dataKey,n=e.rowData;return"function"===typeof n.get?n.get(t):n[t]},cellRenderer:function(e){var t=e.cellData;return null==t?"":String(t)},defaultSortDirection:qe.ASC,flexGrow:0,flexShrink:1,headerRenderer:We,style:{}}),Ye.propTypes={};var $e=function(e){function t(e){var n;return(0,r.Z)(this,t),(n=(0,o.Z)(this,(0,s.Z)(t).call(this,e))).state={scrollbarWidth:0},n._createColumn=n._createColumn.bind((0,a.Z)(n)),n._createRow=n._createRow.bind((0,a.Z)(n)),n._onScroll=n._onScroll.bind((0,a.Z)(n)),n._onSectionRendered=n._onSectionRendered.bind((0,a.Z)(n)),n._setRef=n._setRef.bind((0,a.Z)(n)),n}return(0,c.Z)(t,e),(0,i.Z)(t,[{key:"forceUpdateGrid",value:function(){this.Grid&&this.Grid.forceUpdate()}},{key:"getOffsetForRow",value:function(e){var t=e.alignment,n=e.index;return this.Grid?this.Grid.getOffsetForCell({alignment:t,rowIndex:n}).scrollTop:0}},{key:"invalidateCellSizeAfterRender",value:function(e){var t=e.columnIndex,n=e.rowIndex;this.Grid&&this.Grid.invalidateCellSizeAfterRender({rowIndex:n,columnIndex:t})}},{key:"measureAllRows",value:function(){this.Grid&&this.Grid.measureAllCells()}},{key:"recomputeGridSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.columnIndex,n=void 0===t?0:t,r=e.rowIndex,i=void 0===r?0:r;this.Grid&&this.Grid.recomputeGridSize({rowIndex:i,columnIndex:n})}},{key:"recomputeRowHeights",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.Grid&&this.Grid.recomputeGridSize({rowIndex:e})}},{key:"scrollToPosition",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.Grid&&this.Grid.scrollToPosition({scrollTop:e})}},{key:"scrollToRow",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.Grid&&this.Grid.scrollToCell({columnIndex:0,rowIndex:e})}},{key:"getScrollbarWidth",value:function(){if(this.Grid){var e=(0,J.findDOMNode)(this.Grid),t=e.clientWidth||0;return(e.offsetWidth||0)-t}return 0}},{key:"componentDidMount",value:function(){this._setScrollbarWidth()}},{key:"componentDidUpdate",value:function(){this._setScrollbarWidth()}},{key:"render",value:function(){var e=this,t=this.props,n=t.children,r=t.className,i=t.disableHeader,o=t.gridClassName,s=t.gridStyle,a=t.headerHeight,c=t.headerRowRenderer,l=t.height,h=t.id,f=t.noRowsRenderer,g=t.rowClassName,y=t.rowStyle,m=t.scrollToIndex,v=t.style,b=t.width,w=this.state.scrollbarWidth,E=i?l:l-a,A="function"===typeof g?g({index:-1}):g,S="function"===typeof y?y({index:-1}):y;return this._cachedColumnStyles=[],u.Children.toArray(n).forEach((function(t,n){var r=e._getFlexStyleForColumn(t,t.props.style);e._cachedColumnStyles[n]=Xe({overflow:"hidden"},r)})),u.createElement("div",{"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-colcount":u.Children.toArray(n).length,"aria-rowcount":this.props.rowCount,className:p("ReactVirtualized__Table",r),id:h,role:"grid",style:v},!i&&c({className:p("ReactVirtualized__Table__headerRow",A),columns:this._getHeaderColumns(),style:Xe({height:a,overflow:"hidden",paddingRight:w,width:b},S)}),u.createElement(M,(0,d.Z)({},this.props,{"aria-readonly":null,autoContainerWidth:!0,className:p("ReactVirtualized__Table__Grid",o),cellRenderer:this._createRow,columnWidth:b,columnCount:1,height:E,id:void 0,noContentRenderer:f,onScroll:this._onScroll,onSectionRendered:this._onSectionRendered,ref:this._setRef,role:"rowgroup",scrollbarWidth:w,scrollToRow:m,style:Xe({},s,{overflowX:"hidden"})})))}},{key:"_createColumn",value:function(e){var t=e.column,n=e.columnIndex,r=e.isScrolling,i=e.parent,o=e.rowData,s=e.rowIndex,a=this.props.onColumnClick,c=t.props,l=c.cellDataGetter,h=c.cellRenderer,d=c.className,f=c.columnData,g=c.dataKey,y=c.id,m=h({cellData:l({columnData:f,dataKey:g,rowData:o}),columnData:f,columnIndex:n,dataKey:g,isScrolling:r,parent:i,rowData:o,rowIndex:s}),v=this._cachedColumnStyles[n],b="string"===typeof m?m:null;return u.createElement("div",{"aria-colindex":n+1,"aria-describedby":y,className:p("ReactVirtualized__Table__rowColumn",d),key:"Row"+s+"-Col"+n,onClick:function(e){a&&a({columnData:f,dataKey:g,event:e})},role:"gridcell",style:v,title:b},m)}},{key:"_createHeader",value:function(e){var t,n,r,i,o,s=e.column,a=e.index,c=this.props,l=c.headerClassName,h=c.headerStyle,d=c.onHeaderClick,f=c.sort,g=c.sortBy,y=c.sortDirection,m=s.props,v=m.columnData,b=m.dataKey,w=m.defaultSortDirection,E=m.disableSort,A=m.headerRenderer,S=m.id,_=m.label,I=!E&&f,C=p("ReactVirtualized__Table__headerColumn",l,s.props.headerClassName,{ReactVirtualized__Table__sortableHeaderColumn:I}),T=this._getFlexStyleForColumn(s,Xe({},h,{},s.props.headerStyle)),k=A({columnData:v,dataKey:b,disableSort:E,label:_,sortBy:g,sortDirection:y});if(I||d){var R=g!==b?w:y===qe.DESC?qe.ASC:qe.DESC,x=function(e){I&&f({defaultSortDirection:w,event:e,sortBy:b,sortDirection:R}),d&&d({columnData:v,dataKey:b,event:e})};o=s.props["aria-label"]||_||b,i="none",r=0,t=x,n=function(e){"Enter"!==e.key&&" "!==e.key||x(e)}}return g===b&&(i=y===qe.ASC?"ascending":"descending"),u.createElement("div",{"aria-label":o,"aria-sort":i,className:C,id:S,key:"Header-Col"+a,onClick:t,onKeyDown:n,role:"columnheader",style:T,tabIndex:r},k)}},{key:"_createRow",value:function(e){var t=this,n=e.rowIndex,r=e.isScrolling,i=e.key,o=e.parent,s=e.style,a=this.props,c=a.children,l=a.onRowClick,h=a.onRowDoubleClick,d=a.onRowRightClick,f=a.onRowMouseOver,g=a.onRowMouseOut,y=a.rowClassName,m=a.rowGetter,v=a.rowRenderer,b=a.rowStyle,w=this.state.scrollbarWidth,E="function"===typeof y?y({index:n}):y,A="function"===typeof b?b({index:n}):b,S=m({index:n}),_=u.Children.toArray(c).map((function(e,i){return t._createColumn({column:e,columnIndex:i,isScrolling:r,parent:o,rowData:S,rowIndex:n,scrollbarWidth:w})})),I=p("ReactVirtualized__Table__row",E),C=Xe({},s,{height:this._getRowHeight(n),overflow:"hidden",paddingRight:w},A);return v({className:I,columns:_,index:n,isScrolling:r,key:i,onRowClick:l,onRowDoubleClick:h,onRowRightClick:d,onRowMouseOver:f,onRowMouseOut:g,rowData:S,style:C})}},{key:"_getFlexStyleForColumn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="".concat(e.props.flexGrow," ").concat(e.props.flexShrink," ").concat(e.props.width,"px"),r=Xe({},t,{flex:n,msFlex:n,WebkitFlex:n});return e.props.maxWidth&&(r.maxWidth=e.props.maxWidth),e.props.minWidth&&(r.minWidth=e.props.minWidth),r}},{key:"_getHeaderColumns",value:function(){var e=this,t=this.props,n=t.children;return(t.disableHeader?[]:u.Children.toArray(n)).map((function(t,n){return e._createHeader({column:t,index:n})}))}},{key:"_getRowHeight",value:function(e){var t=this.props.rowHeight;return"function"===typeof t?t({index:e}):t}},{key:"_onScroll",value:function(e){var t=e.clientHeight,n=e.scrollHeight,r=e.scrollTop;(0,this.props.onScroll)({clientHeight:t,scrollHeight:n,scrollTop:r})}},{key:"_onSectionRendered",value:function(e){var t=e.rowOverscanStartIndex,n=e.rowOverscanStopIndex,r=e.rowStartIndex,i=e.rowStopIndex;(0,this.props.onRowsRendered)({overscanStartIndex:t,overscanStopIndex:n,startIndex:r,stopIndex:i})}},{key:"_setRef",value:function(e){this.Grid=e}},{key:"_setScrollbarWidth",value:function(){var e=this.getScrollbarWidth();this.setState({scrollbarWidth:e})}}]),t}(u.PureComponent);(0,l.Z)($e,"defaultProps",{disableHeader:!1,estimatedRowSize:30,headerHeight:0,headerStyle:{},noRowsRenderer:function(){return null},onRowsRendered:function(){return null},onScroll:function(){return null},overscanIndicesGetter:U,overscanRowCount:10,rowRenderer:Qe,headerRowRenderer:He,rowStyle:{},scrollToAlignment:"auto",scrollToIndex:-1,style:{}}),$e.propTypes={};var et=[],tt=null,nt=null;function rt(){nt&&(nt=null,document.body&&null!=tt&&(document.body.style.pointerEvents=tt),tt=null)}function it(){rt(),et.forEach((function(e){return e.__resetIsScrolling()}))}function ot(e){e.currentTarget===window&&null==tt&&document.body&&(tt=document.body.style.pointerEvents,document.body.style.pointerEvents="none"),function(){nt&&x(nt);var e=0;et.forEach((function(t){e=Math.max(e,t.props.scrollingResetTimeInterval)})),nt=P(it,e)}(),et.forEach((function(t){t.props.scrollElement===e.currentTarget&&t.__handleWindowScrollEvent()}))}function st(e,t){et.some((function(e){return e.props.scrollElement===t}))||t.addEventListener("scroll",ot),et.push(e)}function at(e,t){(et=et.filter((function(t){return t!==e}))).length||(t.removeEventListener("scroll",ot),nt&&(x(nt),rt()))}var ct,lt,ut=function(e){return e===window},ht=function(e){return e.getBoundingClientRect()};function dt(e,t){if(e){if(ut(e)){var n=window,r=n.innerHeight,i=n.innerWidth;return{height:"number"===typeof r?r:0,width:"number"===typeof i?i:0}}return ht(e)}return{height:t.serverHeight,width:t.serverWidth}}function ft(e){return ut(e)&&document.documentElement?{top:"scrollY"in window?window.scrollY:document.documentElement.scrollTop,left:"scrollX"in window?window.scrollX:document.documentElement.scrollLeft}:{top:e.scrollTop,left:e.scrollLeft}}function pt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var gt=function(){return"undefined"!==typeof window?window:void 0},yt=(lt=ct=function(e){function t(){var e,n;(0,r.Z)(this,t);for(var i=arguments.length,c=new Array(i),u=0;u<i;u++)c[u]=arguments[u];return n=(0,o.Z)(this,(e=(0,s.Z)(t)).call.apply(e,[this].concat(c))),(0,l.Z)((0,a.Z)(n),"_window",gt()),(0,l.Z)((0,a.Z)(n),"_isMounted",!1),(0,l.Z)((0,a.Z)(n),"_positionFromTop",0),(0,l.Z)((0,a.Z)(n),"_positionFromLeft",0),(0,l.Z)((0,a.Z)(n),"_detectElementResize",void 0),(0,l.Z)((0,a.Z)(n),"_child",void 0),(0,l.Z)((0,a.Z)(n),"state",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pt(n,!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pt(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},dt(n.props.scrollElement,n.props),{isScrolling:!1,scrollLeft:0,scrollTop:0})),(0,l.Z)((0,a.Z)(n),"_registerChild",(function(e){!e||e instanceof Element||console.warn("WindowScroller registerChild expects to be passed Element or null"),n._child=e,n.updatePosition()})),(0,l.Z)((0,a.Z)(n),"_onChildScroll",(function(e){var t=e.scrollTop;if(n.state.scrollTop!==t){var r=n.props.scrollElement;r&&("function"===typeof r.scrollTo?r.scrollTo(0,t+n._positionFromTop):r.scrollTop=t+n._positionFromTop)}})),(0,l.Z)((0,a.Z)(n),"_registerResizeListener",(function(e){e===window?window.addEventListener("resize",n._onResize,!1):n._detectElementResize.addResizeListener(e,n._onResize)})),(0,l.Z)((0,a.Z)(n),"_unregisterResizeListener",(function(e){e===window?window.removeEventListener("resize",n._onResize,!1):e&&n._detectElementResize.removeResizeListener(e,n._onResize)})),(0,l.Z)((0,a.Z)(n),"_onResize",(function(){n.updatePosition()})),(0,l.Z)((0,a.Z)(n),"__handleWindowScrollEvent",(function(){if(n._isMounted){var e=n.props.onScroll,t=n.props.scrollElement;if(t){var r=ft(t),i=Math.max(0,r.left-n._positionFromLeft),o=Math.max(0,r.top-n._positionFromTop);n.setState({isScrolling:!0,scrollLeft:i,scrollTop:o}),e({scrollLeft:i,scrollTop:o})}}})),(0,l.Z)((0,a.Z)(n),"__resetIsScrolling",(function(){n.setState({isScrolling:!1})})),n}return(0,c.Z)(t,e),(0,i.Z)(t,[{key:"updatePosition",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.scrollElement,t=this.props.onResize,n=this.state,r=n.height,i=n.width,o=this._child||J.findDOMNode(this);if(o instanceof Element&&e){var s=function(e,t){if(ut(t)&&document.documentElement){var n=document.documentElement,r=ht(e),i=ht(n);return{top:r.top-i.top,left:r.left-i.left}}var o=ft(t),s=ht(e),a=ht(t);return{top:s.top+o.top-a.top,left:s.left+o.left-a.left}}(o,e);this._positionFromTop=s.top,this._positionFromLeft=s.left}var a=dt(e,this.props);r===a.height&&i===a.width||(this.setState({height:a.height,width:a.width}),t({height:a.height,width:a.width}))}},{key:"componentDidMount",value:function(){var e=this.props.scrollElement;this._detectElementResize=z(),this.updatePosition(e),e&&(st(this,e),this._registerResizeListener(e)),this._isMounted=!0}},{key:"componentDidUpdate",value:function(e,t){var n=this.props.scrollElement,r=e.scrollElement;r!==n&&null!=r&&null!=n&&(this.updatePosition(n),at(this,r),st(this,n),this._unregisterResizeListener(r),this._registerResizeListener(n))}},{key:"componentWillUnmount",value:function(){var e=this.props.scrollElement;e&&(at(this,e),this._unregisterResizeListener(e)),this._isMounted=!1}},{key:"render",value:function(){var e=this.props.children,t=this.state,n=t.isScrolling,r=t.scrollTop,i=t.scrollLeft,o=t.height,s=t.width;return e({onChildScroll:this._onChildScroll,registerChild:this._registerChild,height:o,isScrolling:n,scrollLeft:i,scrollTop:r,width:s})}}]),t}(u.PureComponent),(0,l.Z)(ct,"propTypes",null),lt);(0,l.Z)(yt,"defaultProps",{onResize:function(){},onScroll:function(){},scrollingResetTimeInterval:150,scrollElement:gt(),serverHeight:0,serverWidth:0})},59117:(e,t,n)=>{"use strict";var r=n(31725),i="function"===typeof Symbol&&Symbol.for,o=i?Symbol.for("react.element"):60103,s=i?Symbol.for("react.portal"):60106,a=i?Symbol.for("react.fragment"):60107,c=i?Symbol.for("react.strict_mode"):60108,l=i?Symbol.for("react.profiler"):60114,u=i?Symbol.for("react.provider"):60109,h=i?Symbol.for("react.context"):60110,d=i?Symbol.for("react.forward_ref"):60112,f=i?Symbol.for("react.suspense"):60113,p=i?Symbol.for("react.memo"):60115,g=i?Symbol.for("react.lazy"):60116,y="function"===typeof Symbol&&Symbol.iterator;function m(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b={};function w(e,t,n){this.props=e,this.context=t,this.refs=b,this.updater=n||v}function E(){}function A(e,t,n){this.props=e,this.context=t,this.refs=b,this.updater=n||v}w.prototype.isReactComponent={},w.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error(m(85));this.updater.enqueueSetState(this,e,t,"setState")},w.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},E.prototype=w.prototype;var S=A.prototype=new E;S.constructor=A,r(S,w.prototype),S.isPureReactComponent=!0;var _={current:null},I=Object.prototype.hasOwnProperty,C={key:!0,ref:!0,__self:!0,__source:!0};function T(e,t,n){var r,i={},s=null,a=null;if(null!=t)for(r in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(s=""+t.key),t)I.call(t,r)&&!C.hasOwnProperty(r)&&(i[r]=t[r]);var c=arguments.length-2;if(1===c)i.children=n;else if(1<c){for(var l=Array(c),u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}if(e&&e.defaultProps)for(r in c=e.defaultProps)void 0===i[r]&&(i[r]=c[r]);return{$$typeof:o,type:e,key:s,ref:a,props:i,_owner:_.current}}function k(e){return"object"===typeof e&&null!==e&&e.$$typeof===o}var R=/\/+/g,x=[];function P(e,t,n,r){if(x.length){var i=x.pop();return i.result=e,i.keyPrefix=t,i.func=n,i.context=r,i.count=0,i}return{result:e,keyPrefix:t,func:n,context:r,count:0}}function D(e){e.result=null,e.keyPrefix=null,e.func=null,e.context=null,e.count=0,10>x.length&&x.push(e)}function O(e,t,n,r){var i=typeof e;"undefined"!==i&&"boolean"!==i||(e=null);var a=!1;if(null===e)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case o:case s:a=!0}}if(a)return n(r,e,""===t?"."+B(e,0):t),1;if(a=0,t=""===t?".":t+":",Array.isArray(e))for(var c=0;c<e.length;c++){var l=t+B(i=e[c],c);a+=O(i,l,n,r)}else if(null===e||"object"!==typeof e?l=null:l="function"===typeof(l=y&&e[y]||e["@@iterator"])?l:null,"function"===typeof l)for(e=l.call(e),c=0;!(i=e.next()).done;)a+=O(i=i.value,l=t+B(i,c++),n,r);else if("object"===i)throw n=""+e,Error(m(31,"[object Object]"===n?"object with keys {"+Object.keys(e).join(", ")+"}":n,""));return a}function N(e,t,n){return null==e?0:O(e,"",t,n)}function B(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+(""+e).replace(/[=:]/g,(function(e){return t[e]}))}(e.key):t.toString(36)}function L(e,t){e.func.call(e.context,t,e.count++)}function M(e,t,n){var r=e.result,i=e.keyPrefix;e=e.func.call(e.context,t,e.count++),Array.isArray(e)?U(e,r,n,(function(e){return e})):null!=e&&(k(e)&&(e=function(e,t){return{$$typeof:o,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(e,i+(!e.key||t&&t.key===e.key?"":(""+e.key).replace(R,"$&/")+"/")+n)),r.push(e))}function U(e,t,n,r,i){var o="";null!=n&&(o=(""+n).replace(R,"$&/")+"/"),N(e,M,t=P(t,o,r,i)),D(t)}var F={current:null};function K(){var e=F.current;if(null===e)throw Error(m(321));return e}var j={ReactCurrentDispatcher:F,ReactCurrentBatchConfig:{suspense:null},ReactCurrentOwner:_,IsSomeRendererActing:{current:!1},assign:r};t.Children={map:function(e,t,n){if(null==e)return e;var r=[];return U(e,r,null,t,n),r},forEach:function(e,t,n){if(null==e)return e;N(e,L,t=P(null,null,t,n)),D(t)},count:function(e){return N(e,(function(){return null}),null)},toArray:function(e){var t=[];return U(e,t,null,(function(e){return e})),t},only:function(e){if(!k(e))throw Error(m(143));return e}},t.Component=w,t.Fragment=a,t.Profiler=l,t.PureComponent=A,t.StrictMode=c,t.Suspense=f,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=j,t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error(m(267,e));var i=r({},e.props),s=e.key,a=e.ref,c=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,c=_.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(u in t)I.call(t,u)&&!C.hasOwnProperty(u)&&(i[u]=void 0===t[u]&&void 0!==l?l[u]:t[u])}var u=arguments.length-2;if(1===u)i.children=n;else if(1<u){l=Array(u);for(var h=0;h<u;h++)l[h]=arguments[h+2];i.children=l}return{$$typeof:o,type:e.type,key:s,ref:a,props:i,_owner:c}},t.createContext=function(e,t){return void 0===t&&(t=null),(e={$$typeof:h,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:u,_context:e},e.Consumer=e},t.createElement=T,t.createFactory=function(e){var t=T.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:d,render:e}},t.isValidElement=k,t.lazy=function(e){return{$$typeof:g,_ctor:e,_status:-1,_result:null}},t.memo=function(e,t){return{$$typeof:p,type:e,compare:void 0===t?null:t}},t.useCallback=function(e,t){return K().useCallback(e,t)},t.useContext=function(e,t){return K().useContext(e,t)},t.useDebugValue=function(){},t.useEffect=function(e,t){return K().useEffect(e,t)},t.useImperativeHandle=function(e,t,n){return K().useImperativeHandle(e,t,n)},t.useLayoutEffect=function(e,t){return K().useLayoutEffect(e,t)},t.useMemo=function(e,t){return K().useMemo(e,t)},t.useReducer=function(e,t,n){return K().useReducer(e,t,n)},t.useRef=function(e){return K().useRef(e)},t.useState=function(e){return K().useState(e)},t.version="16.14.0"},72791:(e,t,n)=>{"use strict";e.exports=n(59117)},449:(e,t,n)=>{"use strict";e.exports=s;var r=n(78193),i=s.prototype,o=new Date%1e9;function s(e){e=e||{},this.id=e.id||(1e9*Math.random()>>>0)+o++,this.max=e.max||1/0,this.items=e.items||[],this._lookup={},this.size=this.items.length,this.lastModified=new Date(e.lastModified||new Date);for(var t,n,r=this.items.length;r--;)t=this.items[r],n=new Date(t.expires)-new Date,this._lookup[t.key]=t,n>0?this.expire(t.key,n):n<=0&&this.delete(t.key)}i.has=function(e){return e in this._lookup},i.get=function(e){if(!this.has(e))return null;var t=this._lookup[e];return t.refresh&&this.expire(e,t.refresh),this.items.splice(this.items.indexOf(t),1),this.items.push(t),t.value},i.meta=function(e){if(!this.has(e))return null;var t=this._lookup[e];return"meta"in t?t.meta:null},i.set=function(e,t,n){var r=this._lookup[e],i=this._lookup[e]={key:e,value:t};return this.lastModified=new Date,r?(clearTimeout(r.timeout),this.items.splice(this.items.indexOf(r),1,i)):(this.size>=this.max&&this.delete(this.items[0].key),this.items.push(i),this.size++),n&&("ttl"in n&&this.expire(e,n.ttl),"meta"in n&&(i.meta=n.meta),n.refresh&&(i.refresh=n.ttl)),this},i.delete=function(e){var t=this._lookup[e];return!!t&&(this.lastModified=new Date,this.items.splice(this.items.indexOf(t),1),clearTimeout(t.timeout),delete this._lookup[e],this.size--,this)},i.expire=function(e,t){var n=t||0,i=this._lookup[e];if(!i)return this;if("string"===typeof n&&(n=r(t)),"number"!==typeof n)throw new TypeError("Expiration time must be a string or number.");return clearTimeout(i.timeout),i.timeout=setTimeout(this.delete.bind(this,i.key),n),i.expires=Number(new Date)+n,this},i.clear=function(){for(var e=this.items.length;e--;)this.delete(this.items[e].key);return this},i.toJSON=function(){for(var e,t=new Array(this.items.length),n=t.length;n--;)e=this.items[n],t[n]={key:e.key,meta:e.meta,value:e.value,expires:e.expires,refresh:e.refresh};return{id:this.id,max:isFinite(this.max)?this.max:void 0,lastModified:this.lastModified,items:t}}},218:(e,t,n)=>{"use strict";n.d(t,{$:()=>s,z:()=>o});var r=n(72791),i={store:function(){}},o=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.getChildContext=function(){return{store:this.props.store}},t.prototype.render=function(){return r.Children.only(this.props.children)},t}(r.Component);o.childContextTypes=i;var s=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=e.slice(-1)[0],o=e.length>1?e.slice(0,-1):[],s=[],a=[];o.forEach((function(e){if("select"!==e.slice(0,6)){if("do"!==e.slice(0,2))throw Error("CanNotConnect "+e);s.push(e)}else a.push(e)}));var c=function(e){function t(t,n){var r=this;e.call(this,t,n);var i=n.store;this.state=i.select(a),this.unsubscribe=i.subscribeToSelectors(a,this.setState.bind(this)),this.actionCreators={},s.forEach((function(e){r.actionCreators[e]=function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];return i.action?i.action(e,t):i[e].apply(i,t)}}))}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.componentWillUnmount=function(){this.unsubscribe()},t.prototype.render=function(){return(0,r.createElement)(n,Object.assign({},this.props,this.state,this.actionCreators))},t}(r.Component);return c.contextTypes=i,c.displayName="connect("+(n.displayName||n.name)+")",c}},99491:(e,t,n)=>{"use strict";n.d(t,{Ds:()=>O,Jc:()=>ye,P1:()=>E,Wn:()=>T,Zh:()=>ge,dV:()=>k,pY:()=>me,qF:()=>pe}),e=n.hmd(e);var r={name:"appTime",reducer:function(){return Date.now()},selectAppTime:function(e){return e.appTime}},i={STARTED:1,FINISHED:-1,FAILED:-1},o=/_(STARTED|FINISHED|FAILED)$/,s={name:"asyncCount",reducer:function(e,t){void 0===e&&(e=0);var n=t.type,r=o.exec(n);return r?e+i[r[1]]:e},selectAsyncActive:function(e){return e.asyncCount>0}},a=function(e){return function(t){return function(n){var r=n.actionCreator,i=n.args;if(r){var o=e.meta.unboundActionCreators[r];if(!o)throw Error("NoSuchActionCreator: "+r);return t(i?o.apply(void 0,i):o())}return t(n)}}};var c=function(e){var t,n=e.Symbol;return"function"===typeof n?n.observable?t=n.observable:(t=n("observable"),n.observable=t):t="@@observable",t}("undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:e),l=function(){return Math.random().toString(36).substring(7).split("").join(".")},u={INIT:"@@redux/INIT"+l(),REPLACE:"@@redux/REPLACE"+l(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+l()}};function h(e){if("object"!==typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function d(e,t,n){var r;if("function"===typeof t&&"function"===typeof n||"function"===typeof n&&"function"===typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function");if("function"===typeof t&&"undefined"===typeof n&&(n=t,t=void 0),"undefined"!==typeof n){if("function"!==typeof n)throw new Error("Expected the enhancer to be a function.");return n(d)(e,t)}if("function"!==typeof e)throw new Error("Expected the reducer to be a function.");var i=e,o=t,s=[],a=s,l=!1;function f(){a===s&&(a=s.slice())}function p(){if(l)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return o}function g(e){if("function"!==typeof e)throw new Error("Expected the listener to be a function.");if(l)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");var t=!0;return f(),a.push(e),function(){if(t){if(l)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");t=!1,f();var n=a.indexOf(e);a.splice(n,1)}}}function y(e){if(!h(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if("undefined"===typeof e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(l)throw new Error("Reducers may not dispatch actions.");try{l=!0,o=i(o,e)}finally{l=!1}for(var t=s=a,n=0;n<t.length;n++){(0,t[n])()}return e}return y({type:u.INIT}),(r={dispatch:y,subscribe:g,getState:p,replaceReducer:function(e){if("function"!==typeof e)throw new Error("Expected the nextReducer to be a function.");i=e,y({type:u.REPLACE})}})[c]=function(){var e,t=g;return(e={subscribe:function(e){if("object"!==typeof e||null===e)throw new TypeError("Expected the observer to be an object.");function n(){e.next&&e.next(p())}return n(),{unsubscribe:t(n)}}})[c]=function(){return this},e},r}function f(e,t){var n=t&&t.type;return"Given "+(n&&'action "'+String(n)+'"'||"an action")+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function p(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++){var i=t[r];0,"function"===typeof e[i]&&(n[i]=e[i])}var o,s=Object.keys(n);try{!function(e){Object.keys(e).forEach((function(t){var n=e[t];if("undefined"===typeof n(void 0,{type:u.INIT}))throw new Error('Reducer "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if("undefined"===typeof n(void 0,{type:u.PROBE_UNKNOWN_ACTION()}))throw new Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+u.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')}))}(n)}catch(a){o=a}return function(e,t){if(void 0===e&&(e={}),o)throw o;for(var r=!1,i={},a=0;a<s.length;a++){var c=s[a],l=n[c],u=e[c],h=l(u,t);if("undefined"===typeof h){var d=f(c,t);throw new Error(d)}i[c]=h,r=r||h!==u}return r?i:e}}function g(e,t){return function(){return t(e.apply(this,arguments))}}function y(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}var m=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return function(t){return function(n,r,i){var o=t(n,r,i),s=e.map((function(e){return e(o)}));return o.dispatch=y.apply(void 0,s)(o.dispatch),o}}};function v(e,t){return e===t}function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v,n=null,r=null;return function(){return function(e,t,n){if(null===t||null===n||t.length!==n.length)return!1;for(var r=t.length,i=0;i<r;i++)if(!e(t[i],n[i]))return!1;return!0}(t,n,arguments)||(r=e.apply(null,arguments)),n=arguments,r}}var w=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];var o=0,s=r.pop(),a=function(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every((function(e){return"function"===typeof e}))){var n=t.map((function(e){return typeof e})).join(", ");throw new Error("Selector creators expect all input-selectors to be functions, instead received the following types: ["+n+"]")}return t}(r),c=e.apply(void 0,[function(){return o++,s.apply(null,arguments)}].concat(n)),l=b((function(){for(var e=[],t=a.length,n=0;n<t;n++)e.push(a[n].apply(null,arguments));return c.apply(null,e)}));return l.resultFunc=s,l.recomputations=function(){return o},l.resetRecomputations=function(){return o=0},l}}(b),E=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=e.slice(-1)[0],r=function(e,t){var r=t.map((function(t){return function(e,t){if("string"!==typeof t)return t;var n=e[t];if(!n)throw Error("No selector "+t+" found on the obj.");return n}(e,t)}));return r.push(n),w.apply(void 0,r)};return r.deps=e.slice(0,-1),r.resultFunc=n,r},A=!1;try{A=!!window.localStorage.debug}catch(ve){}var S=A||!1,_="undefined"!==typeof window,I=_||"undefined"!==typeof self,C=function(e){return setTimeout(e,0)},T=I&&self.requestAnimationFrame?self.requestAnimationFrame:C,k=I&&self.requestIdleCallback?self.requestIdleCallback:C,R=function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch(n){e=!1}return e}(),x=function(e,t){return e.substr(0,t.length)===t},P=function(e,t,n){if(void 0===n&&(n={passive:!1}),!I)return function(){};var r=n.passive?R?[e,t,{passive:!0}]:[e,O(t,200),!1]:[e,t];return self.addEventListener.apply(self,r),function(){return self.removeEventListener.apply(self,r)}},D=function(e){var t="s"===e[0]?6:5;return e[t].toLowerCase()+e.slice(t+1)},O=function(e,t){var n,r=function(){var r=this,i=arguments;clearTimeout(n),n=setTimeout((function(){e.apply(r,i)}),t)};return r.cancel=function(){clearTimeout(n)},r},N=function(){history.replaceState({height:window.innerHeight,width:window.innerWidth,y:window.scrollY,x:window.scrollX},"")},B=function(){var e=history.state;e&&setTimeout((function(){var t="height: "+e.height+"px; width: "+e.width+"px;";document.body.setAttribute("style",t),window.scrollTo(e.x,e.y),k((function(){return document.body.removeAttribute("style")}))}))},L=function(e){var t=e.name;if(!t)throw TypeError('bundles must have a "name" property');var n={name:t,reducer:e.reducer||e.getReducer&&e.getReducer()||null,init:e.init||null,extraArgCreators:e.getExtraArgs||null,middlewareCreators:e.getMiddleware,actionCreators:null,selectors:null,reactorNames:null,rawBundle:e};return Object.keys(e).forEach((function(t){if(x(t,"do"))(n.actionCreators||(n.actionCreators={}))[t]=e[t];else{var r=x(t,"select"),i=x(t,"react");(r||i)&&((n.selectors||(n.selectors={}))[t]=e[t],i&&(n.reactorNames||(n.reactorNames=[])).push(t))}})),n},M=function(e){var t=e.map(L),n={bundleNames:[],reducers:{},selectors:{},actionCreators:{},rawBundles:[],processedBundles:[],initMethods:[],destroyMethods:[],middlewareCreators:[],extraArgCreators:[],reactorNames:[]};return t.forEach((function(e){var t,r;n.bundleNames.push(e.name),Object.assign(n.selectors,e.selectors),Object.assign(n.actionCreators,e.actionCreators),e.reducer&&Object.assign(n.reducers,((t={})[e.name]=e.reducer,t)),e.init&&n.initMethods.push(e.init),e.middlewareCreators&&n.middlewareCreators.push(e.middlewareCreators),e.extraArgCreators&&n.extraArgCreators.push(e.extraArgCreators),e.reactorNames&&(r=n.reactorNames).push.apply(r,e.reactorNames),n.processedBundles.push(e),n.rawBundles.push(e.rawBundle)})),n},U=function(e,t){e.meta||(e.meta={chunks:[],unboundSelectors:{},unboundActionCreators:{},reactorNames:[],destroyMethods:[]});var n=e.meta;n.chunks.push(t);var r=Object.assign(n.unboundSelectors,t.selectors);!function(e){var t=function(t){return t.call&&!t.deps||!e[t].deps},n=!1,r=function(r){var i=e[r];t(r)?n=!0:i.deps=i.deps.map((function(t,i){if(t.call){for(var o in e)if(e[o]===t)return o;if(!t.deps)return n=!0,t}if(e[t])return t;throw Error("The input selector at index "+i+" for '"+r+"' is missing from the object passed to resolveSelectors()")}))};for(var i in e)r(i);if(!n)throw Error("You must pass at least one real selector. If they're all string references there's no");for(var o,s=function(){var n=!1;for(var r in e){var i=e[r];if(!t(r)&&(n=!0,i.deps.every(t))){var o=i(e,i.deps);delete e[r],e[r]=o}}return n};s();)if(o||(o=Date.now()),Date.now()-o>500)throw Error("Could not resolve selector dependencies.")}(r),n.unboundSelectors=r,function(e,t){var n=function(n){var r=t[n];e[n]||(e[n]=function(){return r(e.getState())})};for(var r in t)n(r)}(e,r),n.reactorNames=n.reactorNames.concat(t.reactorNames),Object.assign(n.unboundActionCreators,t.actionCreators),Object.assign(e,function(e,t){if("function"===typeof e)return g(e,t);if("object"!==typeof e||null===e)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===e?"null":typeof e)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');for(var n=Object.keys(e),r={},i=0;i<n.length;i++){var o=n[i],s=e[o];"function"===typeof s&&(r[o]=g(s,t))}return r}(t.actionCreators,e.dispatch)),n.destroyMethods=n.destroyMethods.concat(t.destroyMethods),t.initMethods.forEach((function(t){var r=t(e);"function"===typeof r&&(n.destroyMethods=n.destroyMethods.concat(r))}))},F=y((function(e){return function(t,n){return"BATCH_ACTIONS"===n.type?n.actions.reduce(e,t):e(t,n)}}),(function(e){return function(t,n){return"REPLACE_STATE"===n.type?e(n.payload,n):e(t,n)}})),K=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=M(e);return function(e){var t,r=d(F(p(n.reducers)),e,y(m.apply(void 0,[a,(t=n.extraArgCreators,function(e){var n=t.reduce((function(t,n){return Object.assign(t,n(e))}),{});return function(t){return function(r){if("function"===typeof r){var i=e.getState,o=e.dispatch;return r(Object.assign({},{getState:i,dispatch:o,store:e},n))}return t(r)}}})].concat(n.middlewareCreators.map((function(e){return e(n)})))),_&&window.__REDUX_DEVTOOLS_EXTENSION__&&S?window.__REDUX_DEVTOOLS_EXTENSION__():function(e){return e}));return r.select=function(e){return e.reduce((function(e,t){if(!r[t])throw Error("SelectorNotFound "+t);return e[D(t)]=r[t](),e}),{})},r.selectAll=function(){return r.select(Object.keys(r.meta.unboundSelectors))},r.action=function(e,t){return r[e].apply(r,t)},function(e){e.subscriptions={watchedValues:{}};var t=e.subscriptions.set=new Set,n=e.subscriptions.watchedSelectors={},r=function(e){n[e]=(n[e]||0)+1},i=function(e){var t=n[e]-1;0===t?delete n[e]:n[e]=t};e.subscribe((function(){var r=n.all?e.selectAll():e.select(Object.keys(n)),i=e.subscriptions.watchedValues,o={};for(var s in r){var a=r[s];a!==i[s]&&(o[s]=a)}e.subscriptions.watchedValues=r,t.forEach((function(e){var t={},n=!1;"all"===e.names?(Object.assign(t,o),n=!!Object.keys(t).length):e.names.forEach((function(e){o.hasOwnProperty(e)&&(t[e]=o[e],n=!0)})),n&&e.fn(t)}))})),e.subscribeToAllChanges=function(t){return e.subscribeToSelectors("all",t)},e.subscribeToSelectors=function(n,o){var s="all"===n,a={fn:o,names:s?"all":n.map(D)};return t.add(a),s?r("all"):n.forEach(r),Object.assign(e.subscriptions.watchedValues,s?e.selectAll():e.select(n)),function(){t.delete(a),s?i("all"):n.forEach(i)}}}(r),U(r,n),r.destroy=function(){return r.meta.destroyMethods.forEach((function(e){return e(r)}))},r.integrateBundles=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];U(r,M(e));var n=r.meta.chunks.reduce((function(e,t){return Object.assign(e,t.reducers)}),{});r.replaceReducer(F(p(n))),r.buildPersistActionMap&&r.buildPersistActionMap()},r}},j=/\((.*?)\)/g,Z=/(\(\?)?:\w+/g,z=/[\-{}\[\]+?.,\\\^$|#\s]/g,V=/\*/g,H=function(e,t){var n=Object.keys(e);for(var r in e)e[r]={value:e[r]};return function(r){var i,o,s=n.some((function(t){var n;(o=e[t]).regExp||(n=function(e){var t=[];return e=e.replace(z,"\\$&").replace(j,"(?:$1)?").replace(Z,(function(e,n){return t.push(e.slice(1)),n?e:"([^/?]+)"})).replace(V,(function(e,n){return t.push("path"),"([^?]*?)"})),{regExp:new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$"),namedParams:t}}(t),o.regExp=n.regExp,o.namedParams=n.namedParams,o.pattern=t);var s=o.regExp.exec(r);if(s)return s=s.slice(1,-1),i=s.reduce((function(e,t,n){return t&&(e[o.namedParams[n]]=t),e}),{}),!0}));return s?{page:o.value,params:i,url:r,pattern:o.pattern}:t?{page:t,url:r,params:null}:null}},q={routeInfoSelector:"selectPathname"},G={actionBaseType:null,staleAfter:9e5,retryAfter:6e4,expireAfter:1/0,checkIfOnline:!0,persist:!0},W=function(e){var t=Object.assign({},G,e),n=t.name,r=t.staleAfter,i=t.retryAfter,o=t.actionBaseType,s=t.checkIfOnline,a=t.expireAfter,c=n.charAt(0).toUpperCase()+n.slice(1),l=o||n.toUpperCase(),u="select"+c+"Raw",h="select"+c,d="select"+c+"LastSuccess",f="select"+c+"IsExpired",p="select"+c+"LastError",g="select"+c+"IsStale",y="select"+c+"IsWaitingToRetry",m="select"+c+"IsLoading",v="select"+c+"FailedPermanently",b="select"+c+"ShouldUpdate",w={STARTED:l+"_FETCH_STARTED",FINISHED:l+"_FETCH_FINISHED",FAILED:l+"_FETCH_FAILED",CLEARED:l+"_CLEARED",OUTDATED:l+"_OUTDATED",EXPIRED:l+"_EXPIRED"},A=function(){return{type:w.EXPIRED}},S={data:null,errorTimes:[],errorType:null,lastSuccess:null,isOutdated:!1,isLoading:!1,isExpired:!1,failedPermanently:!1},_={name:n,reducer:function(e,t){void 0===e&&(e=S);var n,r=t.type,i=t.payload,o=t.error,s=t.merge;if(r===w.STARTED)return Object.assign({},e,{isLoading:!0});if(r===w.FINISHED)return n=s?Object.assign({},e.data,i):i,Object.assign({},e,{isLoading:!1,data:n,lastSuccess:Date.now(),errorTimes:[],errorType:null,failedPermanently:!1,isOutdated:!1,isExpired:!1});if(r===w.FAILED){var a=o&&o.message||o;return Object.assign({},e,{isLoading:!1,errorTimes:e.errorTimes.concat([Date.now()]),errorType:a,failedPermanently:!(!o||!o.permanent)})}return r===w.CLEARED?S:r===w.EXPIRED?Object.assign({},S,{isExpired:!0,errorTimes:e.errorTimes,errorType:e.errorType}):r===w.OUTDATED?Object.assign({},e,{isOutdated:!0}):e}};return _[u]=function(e){return e[n]},_[h]=E(u,(function(e){return e.data})),_[g]=E(u,d,"selectAppTime",(function(e,t,n){return!!e.isOutdated||!!t&&n-t>r})),_[f]=E(u,(function(e){return e.isExpired})),_[p]=E(u,(function(e){return e.errorTimes.slice(-1)[0]||null})),_[d]=E(u,(function(e){return e.lastSuccess})),_[y]=E(p,"selectAppTime",(function(e,t){return!!e&&t-e<i})),_[m]=E(u,(function(e){return e.isLoading})),_[v]=E(u,(function(e){return e.failedPermanently})),_[b]=E(m,v,y,h,g,"selectIsOnline",(function(e,t,n,r,i,o){return!(s&&!o||e||t||n)&&(null===r||i)})),_["doFetch"+c]=function(){return function(e){var n=e.dispatch;return n({type:w.STARTED}),t.getPromise(e).then((function(e){n(function(e){return{type:w.FINISHED,payload:e}}(e))}),(function(e){n(function(e){return{type:w.FAILED,error:e}}(e))}))}},_["doMark"+c+"AsOutdated"]=function(){return{type:w.OUTDATED}},_["doClear"+c]=function(){return{type:w.CLEARED}},_["doExpire"+c]=A,t.persist&&(_.persistActions=[w.FINISHED,w.EXPIRED,w.OUTDATED,w.CLEARED]),a!==1/0&&(_["reactExpire"+c]=E(d,"selectAppTime",(function(e,t){return!!e&&(t-e>a?A():void 0)}))),_},Q={idleTimeout:3e4,idleAction:"APP_IDLE",doneCallback:null,stopWhenTabInactive:!0,cancelIdleWhenDone:!0,reactorPermissionCheck:null},Y={timeout:500},J=function(e,t,n){return O((function(){e?T((function(){return k(n,Y)})):k(n,Y)}),t)},X=function(e){return{name:"reactors",init:function(t){var n,r=Object.assign({},Q,e),i=r.idleAction,o=r.idleTimeout,s=r.cancelIdleWhenDone,a=r.doneCallback,c=r.stopWhenTabInactive,l=r.reactorPermissionCheck;o&&(n=J(c,o,(function(){return t.dispatch({type:i})})));var u=function(){t.nextReaction||(t.meta.reactorNames.some((function(e){var n=t[e]();if(n){if(l&&!l(e,n))return;return t.activeReactor=e,t.nextReaction=n,n}})),t.nextReaction&&k((function(){var e=t.nextReaction;t.activeReactor=null,t.nextReaction=null,t.dispatch(e)}),Y)),n&&(n(),s&&(I||t.nextReaction||t.selectAsyncActive&&t.selectAsyncActive()||(n&&n.cancel(),a&&a())))},h=t.subscribe(u);return u(),function(){n&&n.cancel(),h()}}}},$=Object.prototype.hasOwnProperty;function ee(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(ve){return null}}var te=function(e){for(var t,n=/([^=?&]+)=?([^&]*)/g,r={};t=n.exec(e);){var i=ee(t[1]),o=ee(t[2]);null===i||null===o||i in r||(r[i]=o)}return r},ne={stringify:function(e,t){t=t||"";var n,r,i=[];for(r in"string"!==typeof t&&(t="?"),e)if($.call(e,r)){if((n=e[r])||null!==n&&undefined!==n&&!isNaN(n)||(n=""),r=encodeURIComponent(r),n=encodeURIComponent(n),null===r||null===n)continue;i.push(r+"="+n)}return i.length?t+i.join("&"):""},parse:te},re=function(e){return"[object String]"===Object.prototype.toString.call(e)},ie=function(e){return"undefined"!==typeof e},oe=function(e){return re(e)?e:ne.stringify(e)},se=/^[0-9.]+$/,ae=_?window.location:{},ce={name:"url",inert:!_,actionType:"URL_UPDATED",handleScrollRestoration:!0},le=function(e){var t=Object.assign({},ce,e),n=t.actionType,r=function(e){return e[t.name]},i=E(r,(function(e){return function(e){var t={};for(var n in e){var r=e[n];re(r)&&(t[n]=r)}return t}(new URL(e.url))})),o=E(i,(function(e){return ne.parse(e.search)})),s=E(o,(function(e){return ne.stringify(e)})),a=E(i,(function(e){return e.pathname})),c=E(i,(function(e){return t="#",(n=e.hash).charAt(0)===t?n.slice(1):n;var t,n})),l=E(c,(function(e){return ne.parse(e)})),u=E(i,(function(e){return e.hostname})),h=E(u,(function(e){return function(e,t){if(se.test(e))return[];var n=e.split(".");return t?n.slice(-2).join("."):e.split(".").slice(0,-2)}(e)})),d=function(e,t){return void 0===t&&(t={replace:!1,maintainScrollPosition:!1}),function(i){var o=i.dispatch,s=i.getState,a=e;if("string"===typeof e){var c=new URL("/"===e.charAt(0)?"http://example.com"+e:e);a={pathname:c.pathname,query:c.search||"",hash:c.hash||""}}var l=new URL(r(s()).url);ie(a.pathname)&&(l.pathname=a.pathname),ie(a.hash)&&(l.hash=oe(a.hash)),ie(a.query)&&(l.search=oe(a.query)),o({type:n,payload:{url:l.href,replace:t.replace,maintainScrollPosition:t.maintainScrollPosition}})}};return{name:t.name,init:function(e){if(!t.inert){var n=t.handleScrollRestoration?function(){if(_){history.scrollRestoration&&(history.scrollRestoration="manual");var e=P("popstate",B),t=P("scroll",O(N,300),{passive:!0});return B(),function(){e(),t()}}}():null,r=P("popstate",(function(){e.doUpdateUrl({pathname:ae.pathname,hash:ae.hash,query:ae.search})})),i=e.selectUrlRaw(),o=e.subscribe((function(){var n=e.selectUrlRaw(),r=n.url;if(i!==n&&r!==ae.href)try{window.history[n.replace?"replaceState":"pushState"]({},null,n.url),t.handleScrollRestoration&&N(),n.maintainScrollPosition||window.scrollTo(0,0)}catch(ve){console.error(ve)}i=n}));return function(){n&&n(),r(),o()}}},getReducer:function(){var e={url:!t.inert&&_?ae.href:"/",replace:!1,maintainScrollPosition:!1};return function(t,r){void 0===t&&(t=e);var i=r.type,o=r.payload;return"string"===typeof t?{url:t,replace:!1,maintainScrollPosition:!1}:i===n?Object.assign({url:o.url||o,replace:!!o.replace,maintainScrollPosition:!!o.maintainScrollPosition}):t}},doUpdateUrl:d,doReplaceUrl:function(e){return d(e,{replace:!0})},doUpdateQuery:function(e,t){return void 0===t&&(t={replace:!0}),d({query:oe(e)},t)},doUpdateHash:function(e,t){return void 0===t&&(t={replace:!1}),d({hash:(n="#",r=oe(e),r===n||""===r?"":r.charAt(0)!==n?n+r:r)},t);var n,r},selectUrlRaw:r,selectUrlObject:i,selectQueryObject:o,selectQueryString:s,selectPathname:a,selectHash:c,selectHashObject:l,selectHostname:u,selectSubdomains:h}},ue=function(e){var t="DEBUG_ENABLED",n="DEBUG_DISABLED",r="color: #1676D2;",i="color: #F57C00;",o=function(e,t){var n=t.method;void 0===n&&(n="log");var r=t.label,i=t.color;return console[n].apply(console,I?["%c"+r,i,e]:[r,e])},s={logSelectors:!0,logState:!0,enabled:S,actionFilter:null},a=Object.assign({},s,e);return{name:"debug",reducer:function(e,r){void 0===e&&(e=a.enabled);var i=r.type;return i===t||i!==n&&e},doEnableDebug:function(){return function(e){var n=e.dispatch;if(I)try{localStorage.debug=!0}catch(ve){}n({type:t})}},doDisableDebug:function(){return function(e){var t=e.dispatch;if(I)try{delete localStorage.debug}catch(ve){}t({type:n})}},selectIsDebug:function(e){return e.debug},getMiddleware:function(){return function(e){return function(t){return function(n){if(!e.getState().debug||a.actionFilter&&!a.actionFilter(n))return t(n);console.group(n.type),console.info("action:",n);var r=t(n);return a.logState&&console.debug("state:",e.getState()),a.logSelectors&&e.doLogSelectors(),e.doLogNextReaction&&e.doLogNextReaction(),console.groupEnd(n.type),r}}}},doLogBundles:function(){return function(e){var t=e.store;o(t.meta.chunks.reduce((function(e,t){return e.push.apply(e,t.bundleNames),e}),[]),{label:"installed bundles:",color:r})}},doLogSelectors:function(){return function(e){var t=e.store;o(Object.keys(t.meta.unboundSelectors).sort().reduce((function(e,n){return e[n]=t[n](),e}),{}),{label:"selectors:",color:"color: #4CAF50;"})}},doLogActionCreators:function(){return function(e){var t=e.store;o(Object.keys(t.meta.unboundActionCreators).sort(),{label:"action creators:",color:i})}},doLogReactors:function(){return function(e){var t=e.store;o(t.meta.reactorNames,{label:"reactors:",color:i})}},doLogNextReaction:function(){return function(e){var t=e.store,n=t.nextReaction,r=t.activeReactor;n&&o(n,{color:i,label:"next reaction "+r+":"})}},doLogDebugSummary:function(){return function(e){var t=e.store;t.doLogBundles(),t.doLogSelectors(),t.doLogActionCreators(),t.doLogReactors(),t.doLogNextReaction()}},init:function(e){e.selectIsDebug()&&I&&(self.store=e,console.groupCollapsed("%credux bundler v26.1.0",r),e.doLogDebugSummary(),console.groupEnd())}}},he="OFFLINE",de="ONLINE",fe={name:"online",selectIsOnline:function(e){return e.online},getReducer:function(){var e=!I||navigator.onLine;return function(t,n){void 0===t&&(t=e);var r=n.type;return r!==he&&(r===de||t)}},init:function(e){var t=P("online",(function(){return e.dispatch({type:de})})),n=P("offline",(function(){return e.dispatch({type:he})}));return function(){t(),n()}}},pe=function(e){var t=e.cacheFn,n=e.logger,r=e.enabled;return void 0===r&&(r=I),{name:"localCache",init:function(e){e.buildPersistActionMap=function(){e.meta.persistActionMap=e.meta.chunks.reduce((function(e,t){return t.rawBundles.forEach((function(t){t.persistActions&&t.persistActions.forEach((function(n){e[n]||(e[n]=[]),e[n].push(t.name)}))})),e}),{})},e.buildPersistActionMap()},getMiddleware:function(){return function(e){return function(i){return function(o){var s=e.getState,a=e.meta.persistActionMap[o.type],c=i(o),l=s();return r&&a&&k((function(){Promise.all(a.map((function(e){return t(e,l[e])}))).then((function(){n&&n("cached "+a.join(", ")+" due to "+o.type)}))}),{timeout:500}),c}}}}}},ge=function(e,t){var n=Object.assign({},q,t).routeInfoSelector,r=H(e);return{name:"routes",selectRoutes:function(){return e},selectRouteMatcher:function(){return r},selectRouteInfo:E(n,r),selectRouteParams:E("selectRouteInfo",(function(e){return e.params})),selectRoute:E("selectRouteInfo",(function(e){return e.page}))}},ye=W,me=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];e||(e=[]);var n=[r,s,fe,le(),X(),ue()].concat(e);return K.apply(void 0,n)}},31779:(e,t,n)=>{"use strict";const r=n(36222);class i{constructor(e,t,n){const i=this;this._started=r(),this._rescheduled=0,this._scheduled=t,this._args=n,this._triggered=!1,this._timerWrapper=()=>{i._rescheduled>0?(i._scheduled=i._rescheduled-(r()-i._started),i._schedule(i._scheduled)):(i._triggered=!0,e.apply(null,i._args))},this._timer=setTimeout(this._timerWrapper,t)}reschedule(e){e||(e=this._scheduled);const t=r();t+e-(this._started+this._scheduled)<0?(clearTimeout(this._timer),this._schedule(e)):this._triggered?this._schedule(e):(this._started=t,this._rescheduled=e)}_schedule(e){this._triggered=!1,this._started=r(),this._rescheduled=0,this._scheduled=e,this._timer=setTimeout(this._timerWrapper,e)}clear(){clearTimeout(this._timer)}}e.exports=function(){if("function"!==typeof arguments[0])throw new Error("callback needed");if("number"!==typeof arguments[1])throw new Error("timeout needed");let e;if(arguments.length>0){e=new Array(arguments.length-2);for(var t=0;t<e.length;t++)e[t]=arguments[t+2]}return new i(arguments[0],arguments[1],e)}},36222:e=>{"use strict";e.exports=function(){return Date.now()}},99158:(e,t,n)=>{n(95509)},95509:(e,t,n)=>{var r=n(1500);t.operation=function(e){var n=t.timeouts(e);return new r(n,{forever:e&&(e.forever||e.retries===1/0),unref:e&&e.unref,maxRetryTime:e&&e.maxRetryTime})},t.timeouts=function(e){if(e instanceof Array)return[].concat(e);var t={retries:10,factor:2,minTimeout:1e3,maxTimeout:1/0,randomize:!1};for(var n in e)t[n]=e[n];if(t.minTimeout>t.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var r=[],i=0;i<t.retries;i++)r.push(this.createTimeout(i,t));return e&&e.forever&&!r.length&&r.push(this.createTimeout(i,t)),r.sort((function(e,t){return e-t})),r},t.createTimeout=function(e,t){var n=t.randomize?Math.random()+1:1,r=Math.round(n*Math.max(t.minTimeout,1)*Math.pow(t.factor,e));return r=Math.min(r,t.maxTimeout)},t.wrap=function(e,n,r){if(n instanceof Array&&(r=n,n=null),!r)for(var i in r=[],e)"function"===typeof e[i]&&r.push(i);for(var o=0;o<r.length;o++){var s=r[o],a=e[s];e[s]=function(r){var i=t.operation(n),o=Array.prototype.slice.call(arguments,1),s=o.pop();o.push((function(e){i.retry(e)||(e&&(arguments[0]=i.mainError()),s.apply(this,arguments))})),i.attempt((function(){r.apply(e,o)}))}.bind(e,a),e[s].options=n}}},1500:e=>{function t(e,t){"boolean"===typeof t&&(t={forever:t}),this._originalTimeouts=JSON.parse(JSON.stringify(e)),this._timeouts=e,this._options=t||{},this._maxRetryTime=t&&t.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}e.exports=t,t.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)},t.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null},t.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;var t=(new Date).getTime();if(e&&t-this._operationStart>=this._maxRetryTime)return this._errors.push(e),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(e);var n=this._timeouts.shift();if(void 0===n){if(!this._cachedTimeouts)return!1;this._errors.splice(0,this._errors.length-1),n=this._cachedTimeouts.slice(-1)}var r=this;return this._timer=setTimeout((function(){r._attempts++,r._operationTimeoutCb&&(r._timeout=setTimeout((function(){r._operationTimeoutCb(r._attempts)}),r._operationTimeout),r._options.unref&&r._timeout.unref()),r._fn(r._attempts)}),n),this._options.unref&&this._timer.unref(),!0},t.prototype.attempt=function(e,t){this._fn=e,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb));var n=this;this._operationTimeoutCb&&(this._timeout=setTimeout((function(){n._operationTimeoutCb()}),n._operationTimeout)),this._operationStart=(new Date).getTime(),this._fn(this._attempts)},t.prototype.try=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)},t.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)},t.prototype.start=t.prototype.try,t.prototype.errors=function(){return this._errors},t.prototype.attempts=function(){return this._attempts},t.prototype.mainError=function(){if(0===this._errors.length)return null;for(var e={},t=null,n=0,r=0;r<this._errors.length;r++){var i=this._errors[r],o=i.message,s=(e[o]||0)+1;e[o]=s,s>=n&&(t=i,n=s)}return t}},6327:(e,t,n)=>{"use strict";var r=n(60206),i=/[\/\?<>\\:\*\|"]/g,o=/[\x00-\x1f\x80-\x9f]/g,s=/^\.+$/,a=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,c=/[\. ]+$/;function l(e,t){if("string"!==typeof e)throw new Error("Input must be string");var n=e.replace(i,t).replace(o,t).replace(s,t).replace(a,t).replace(c,t);return r(n,255)}e.exports=function(e,t){var n=t&&t.replacement||"",r=l(e,n);return""===n?r:l(r,"")}},36813:(e,t)=>{"use strict";var n,r,i,o,s;if("undefined"===typeof window||"function"!==typeof MessageChannel){var a=null,c=null,l=function(){if(null!==a)try{var e=t.unstable_now();a(!0,e),a=null}catch(n){throw setTimeout(l,0),n}},u=Date.now();t.unstable_now=function(){return Date.now()-u},n=function(e){null!==a?setTimeout(n,0,e):(a=e,setTimeout(l,0))},r=function(e,t){c=setTimeout(e,t)},i=function(){clearTimeout(c)},o=function(){return!1},s=t.unstable_forceFrameRate=function(){}}else{var h=window.performance,d=window.Date,f=window.setTimeout,p=window.clearTimeout;if("undefined"!==typeof console){var g=window.cancelAnimationFrame;"function"!==typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"),"function"!==typeof g&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills")}if("object"===typeof h&&"function"===typeof h.now)t.unstable_now=function(){return h.now()};else{var y=d.now();t.unstable_now=function(){return d.now()-y}}var m=!1,v=null,b=-1,w=5,E=0;o=function(){return t.unstable_now()>=E},s=function(){},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing framerates higher than 125 fps is not unsupported"):w=0<e?Math.floor(1e3/e):5};var A=new MessageChannel,S=A.port2;A.port1.onmessage=function(){if(null!==v){var e=t.unstable_now();E=e+w;try{v(!0,e)?S.postMessage(null):(m=!1,v=null)}catch(n){throw S.postMessage(null),n}}else m=!1},n=function(e){v=e,m||(m=!0,S.postMessage(null))},r=function(e,n){b=f((function(){e(t.unstable_now())}),n)},i=function(){p(b),b=-1}}function _(e,t){var n=e.length;e.push(t);e:for(;;){var r=n-1>>>1,i=e[r];if(!(void 0!==i&&0<T(i,t)))break e;e[r]=t,e[n]=i,n=r}}function I(e){return void 0===(e=e[0])?null:e}function C(e){var t=e[0];if(void 0!==t){var n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length;r<i;){var o=2*(r+1)-1,s=e[o],a=o+1,c=e[a];if(void 0!==s&&0>T(s,n))void 0!==c&&0>T(c,s)?(e[r]=c,e[a]=n,r=a):(e[r]=s,e[o]=n,r=o);else{if(!(void 0!==c&&0>T(c,n)))break e;e[r]=c,e[a]=n,r=a}}}return t}return null}function T(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}var k=[],R=[],x=1,P=null,D=3,O=!1,N=!1,B=!1;function L(e){for(var t=I(R);null!==t;){if(null===t.callback)C(R);else{if(!(t.startTime<=e))break;C(R),t.sortIndex=t.expirationTime,_(k,t)}t=I(R)}}function M(e){if(B=!1,L(e),!N)if(null!==I(k))N=!0,n(U);else{var t=I(R);null!==t&&r(M,t.startTime-e)}}function U(e,n){N=!1,B&&(B=!1,i()),O=!0;var s=D;try{for(L(n),P=I(k);null!==P&&(!(P.expirationTime>n)||e&&!o());){var a=P.callback;if(null!==a){P.callback=null,D=P.priorityLevel;var c=a(P.expirationTime<=n);n=t.unstable_now(),"function"===typeof c?P.callback=c:P===I(k)&&C(k),L(n)}else C(k);P=I(k)}if(null!==P)var l=!0;else{var u=I(R);null!==u&&r(M,u.startTime-n),l=!1}return l}finally{P=null,D=s,O=!1}}function F(e){switch(e){case 1:return-1;case 2:return 250;case 5:return 1073741823;case 4:return 1e4;default:return 5e3}}var K=s;t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){N||O||(N=!0,n(U))},t.unstable_getCurrentPriorityLevel=function(){return D},t.unstable_getFirstCallbackNode=function(){return I(k)},t.unstable_next=function(e){switch(D){case 1:case 2:case 3:var t=3;break;default:t=D}var n=D;D=t;try{return e()}finally{D=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=K,t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=D;D=e;try{return t()}finally{D=n}},t.unstable_scheduleCallback=function(e,o,s){var a=t.unstable_now();if("object"===typeof s&&null!==s){var c=s.delay;c="number"===typeof c&&0<c?a+c:a,s="number"===typeof s.timeout?s.timeout:F(e)}else s=F(e),c=a;return e={id:x++,callback:o,priorityLevel:e,startTime:c,expirationTime:s=c+s,sortIndex:-1},c>a?(e.sortIndex=c,_(R,e),null===I(k)&&e===I(R)&&(B?i():B=!0,r(M,c-a))):(e.sortIndex=s,_(k,e),N||O||(N=!0,n(U))),e},t.unstable_shouldYield=function(){var e=t.unstable_now();L(e);var n=I(k);return n!==P&&null!==P&&null!==n&&null!==n.callback&&n.startTime<=e&&n.expirationTime<P.expirationTime||o()},t.unstable_wrapCallback=function(e){var t=D;return function(){var n=D;D=t;try{return e.apply(this,arguments)}finally{D=n}}}},45296:(e,t,n)=>{"use strict";e.exports=n(36813)},29117:e=>{var t=new Error("Element already at target scroll position"),n=new Error("Scroll cancelled"),r=Math.min,i=Date.now;function o(e){return function(o,c,l,u){"function"==typeof(l=l||{})&&(u=l,l={}),"function"!=typeof u&&(u=a);var h=i(),d=o[e],f=l.ease||s,p=isNaN(l.duration)?350:+l.duration,g=!1;return d===c?u(t,o[e]):requestAnimationFrame((function t(s){if(g)return u(n,o[e]);var a=i(),l=r(1,(a-h)/p),y=f(l);o[e]=y*(c-d)+d,l<1?requestAnimationFrame(t):requestAnimationFrame((function(){u(null,o[e])}))})),function(){g=!0}}}function s(e){return.5*(1-Math.cos(Math.PI*e))}function a(){}e.exports={left:o("scrollLeft"),top:o("scrollTop")}},6426:function(e,t){var n,r,i;r=[],void 0===(i="function"===typeof(n=function(){function e(e){var t=getComputedStyle(e,null).getPropertyValue("overflow");return t.indexOf("scroll")>-1||t.indexOf("auto")>-1}function t(t){if(t instanceof HTMLElement||t instanceof SVGElement){for(var n=t.parentNode;n.parentNode;){if(e(n))return n;n=n.parentNode}return document.scrollingElement||document.documentElement}}return t})?n.apply(t,r):n)||(e.exports=i)},93884:(e,t,n)=>{var r=n(17870),i=n(32996);e.exports=function(e,t){return i(r(e,t),t)}},79613:e=>{e.exports=function(e,t,n,r){var i=n?n.call(r,e,t):void 0;if(void 0!==i)return!!i;if(e===t)return!0;if("object"!==typeof e||!e||"object"!==typeof t||!t)return!1;var o=Object.keys(e),s=Object.keys(t);if(o.length!==s.length)return!1;for(var a=Object.prototype.hasOwnProperty.bind(t),c=0;c<o.length;c++){var l=o[c];if(!a(l))return!1;var u=e[l],h=t[l];if(!1===(i=n?n.call(r,u,h,l):void 0)||void 0===i&&u!==h)return!1}return!0}},42956:(e,t,n)=>{var r=n(17870);e.exports=function(e,t){return r(e,t,"_")}},60807:(e,t,n)=>{const r=n(21309),i=n(66662);e.exports=e=>({sink:r(e),source:i(e)})},6966:(e,t,n)=>{e.exports=n(66662),e.exports.source=n(66662),e.exports.sink=n(21309),e.exports.transform=n(93803),e.exports.duplex=n(60807)},77776:e=>{e.exports=function(e){if(e){if("function"===typeof e[Symbol.iterator])return e[Symbol.iterator]();if("function"===typeof e[Symbol.asyncIterator])return e[Symbol.asyncIterator]();if("function"===typeof e.next)return e}throw new Error("argument is not an iterator or iterable")}},21309:(e,t,n)=>{const r=n(77776);e.exports=e=>async t=>{t=r(t);const n=e=>{"function"===typeof e.return&&e.return()};let i=null,o=null;const s=e=>{i=e,o&&o(e),n(t)};let a=null,c=!1;const l=()=>{c=!0,a&&a()};let u=null,h=!1;const d=()=>{h=!0,u&&u()};let f=null;const p=()=>{f&&f()};e.once("error",s),e.once("close",l),e.once("finish",d);try{for await(const n of t){if(!e.writable||e.destroyed||i)break;!1===e.write(n)&&await new Promise(((t,n)=>{a=f=t,o=n,e.once("drain",p)}))}}catch(g){i||e.destroy(),i=g}try{if(e.writable&&e.end(),await(n(t),new Promise(((e,t)=>{if(c||h||i)return e();u=a=e,o=t}))),i)throw i}finally{e.removeListener("error",s),e.removeListener("close",l),e.removeListener("finish",d),e.removeListener("drain",p)}}},66662:e=>{e.exports=e=>{if(e[Symbol.asyncIterator])return e;if(e.getReader)return async function*(){const t=e.getReader();try{for(;;){const{done:e,value:n}=await t.read();if(e)return;yield n}}finally{t.releaseLock()}}();throw new Error("unknown stream")}},93803:(e,t,n)=>{const r=n(60807);e.exports=e=>async function*(t){const n=r(e);let i;if(n.sink(t).catch((e=>{i=e})),yield*n.source,i)throw i}},68241:(e,t,n)=>{var r=n(98059),i=n(60463);e.exports=function(e,t){if(null==e)return"";for(var n="",o=0;o<e.length;o++){var s=e[o],a=r(s,t);n+=a===s?i(s,t):a}return n}},92244:e=>{!function(){e.exports=y;var t=86400,n=3200,r=146097*n/400,i=t*r,o=1e3*i,s=864e13,a=4294967296,c=1e6,l="000000000",u=Math.trunc||function(e){var t=e-e%1;return 0==t&&(e<0||0===e&&1/e!=1/0)?-0:t},h=y.prototype,d=(y.fromDate=function(e){return new y(+e)},y.fromInt64BE=E(0,1,2,3,0,4),y.fromInt64LE=E(3,2,1,0,4,0),y.fromString=function(e){var t,n=new y;e=(e+="").replace(/^\s*[+\-]?\d+/,(function(e){var t=1970+((e=+e)-1970)%400;return n.year=e-t,t})).replace(/(?:Z|([+\-]\d{2}):?(\d{2}))$/,(function(e,n,r){return n<0&&(r*=-1),t=6e4*(60*+n+ +r),""})).replace(/\.\d+$/,(function(e){return n.nano=+(e+l).substr(1,9),""})).split(/\D+/);if(1<e.length?e[1]--:e[1]=0,n.time=t=Date.UTC.apply(Date,e)-(t||0),isNaN(t))throw new TypeError("Invalid Date");return m(n)},y.fromTimeT=function(e){return b(e,0)},h.year=0,h.time=0,h.nano=0,h.addNano=function(e){return this.nano+=+e||0,this},h.getNano=function(){var e=m(this);return(e.time%1e3*c+ +e.nano+1e9)%1e9},h.getTimeT=function(){var e=m(this),i=Math.floor(e.time/1e3);return(e=e.year)&&(i+=e*r*t/n),i},h.getYear=function(){return this.toDate().getUTCFullYear()+this.year},h.toDate=function(){return v(m(this).time)},h.toJSON=function(){return this.toString().replace(/0{1,6}Z$/,"Z")},h.toString=function(e){var t=this,n=t.toDate(),r={H:function(){return S(n.getUTCHours())},L:function(){return _(n.getUTCMilliseconds(),3)},M:function(){return S(n.getUTCMinutes())},N:function(){return _(t.getNano(),9)},S:function(){return S(n.getUTCSeconds())},Y:function(){var e=t.getYear();return 999999<e?"+"+e:9999<e?"+"+_(e,6):0<=e?_(e,4):-999999<=e?"-"+_(-e,6):e},a:function(){return p[n.getUTCDay()]},b:function(){return f[n.getUTCMonth()]},d:function(){return S(n.getUTCDate())},e:function(){return function(e){return(9<e?"":" ")+(0|e)}(n.getUTCDate())},m:function(){return S(n.getUTCMonth()+1)}};return function e(t){return t.replace(/%./g,(function(t){var n=t[1],i=g[n];n=r[n];return i?e(i):n?n():t}))}(e||d)},h.writeInt64BE=w(0,1,2,3,0,4),h.writeInt64LE=w(3,2,1,0,4,0),"%Y-%m-%dT%H:%M:%S.%NZ"),f=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],p=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],g={"%":"%",F:"%Y-%m-%d",n:"\n",R:"%H:%M",T:"%H:%M:%S",t:"\t",X:"%T",Z:"GMT",z:"+0000"};return y;function y(e,t,n){var r=this;if(!(r instanceof y))return new y(e,t,n);r.time=+e||0,r.nano=+t||0,r.year=+n||0,m(r)}function m(e){var t,r,i,a=e.year,l=e.time,h=e.nano,d=((h<0||c<=h)&&(h-=(r=Math.floor(h/c))*c,l+=r,r=1),a%n);return(l<-s||s<l||d)&&((t=u(l/o))&&(a+=t*n,l-=t*o),(i=v(l)).setUTCFullYear(d+i.getUTCFullYear()),i=(l=+i)+(t=u((a-=d)/n))*o,t&&-s<=i&&i<=s&&(a-=t*n,l=i),r=1),r&&(e.year=a,e.time=l,e.nano=h),e}function v(e){var t=new Date(0);return t.setTime(e),t}function b(e,t){e=+e||0;var r=u((t=(0|t)*a)/i)+u(e/i);return(e=u((t=t%i+e%i)/i))&&(r+=e,t-=e*i),new y(1e3*t,0,r*n)}function w(e,i,o,s,c,l){return function(e,i){var o=m(this);A(e=e||new Array(8),i|=0);var s=Math.floor(o.time/1e3),d=(o=o.year*(r*t/n),u(o/a)+u(s/a));o=o%a+s%a;return(s=Math.floor(o/a))&&(d+=s,o-=s*a),h(e,i+c,d),h(e,i+l,o),e};function h(t,n,r){t[n+e]=r>>24&255,t[n+i]=r>>16&255,t[n+o]=r>>8&255,t[n+s]=255&r}}function E(e,t,n,r,i,o){return function(e,t){A(e,t|=0);var n=s(e,t+i);return b(s(e,t+o),n)};function s(i,o){return 16777216*i[o+e]+(i[o+t]<<16|i[o+n]<<8|i[o+r])}}function A(e,t){if(null==(e=e&&e.length))throw new TypeError("Invalid Buffer");if(e<t+8)throw new RangeError("Out of range")}function S(e){return(9<e?"":"0")+(0|e)}function _(e,t){return(l+(0|e)).substr(-t)}}()},27220:(e,t,n)=>{var r=n(17870),i=n(98059);e.exports=function(e,t){return r(e,t).replace(/^.| ./g,(function(e){return i(e,t)}))}},60206:(e,t,n)=>{"use strict";var r=n(49022),i=n(34847);e.exports=r.bind(null,i)},49022:e=>{"use strict";function t(e){return e>=55296&&e<=56319}function n(e){return e>=56320&&e<=57343}e.exports=function(e,r,i){if("string"!==typeof r)throw new Error("Input must be string");for(var o,s,a=r.length,c=0,l=0;l<a;l+=1){if(o=r.charCodeAt(l),s=r[l],t(o)&&n(r.charCodeAt(l+1))&&(s+=r[l+=1]),(c+=e(s))===i)return r.slice(0,l+1);if(c>i)return r.slice(0,l-s.length+1)}return r}},80136:(e,t,n)=>{"use strict";n.d(t,{Jx:()=>g,P$:()=>f,cv:()=>p});var r=n(69958);const i=Math.pow(2,7),o=Math.pow(2,14),s=Math.pow(2,21),a=Math.pow(2,28),c=Math.pow(2,35),l=Math.pow(2,42),u=Math.pow(2,49),h=128,d=127;function f(e){if(e<i)return 1;if(e<o)return 2;if(e<s)return 3;if(e<a)return 4;if(e<c)return 5;if(e<l)return 6;if(e<u)return 7;if(null!=Number.MAX_SAFE_INTEGER&&e>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return 8}function p(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return null==t&&(t=(0,r.E)(f(e))),t instanceof Uint8Array?function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;switch(f(e)){case 8:t[n++]=255&e|h,e/=128;case 7:t[n++]=255&e|h,e/=128;case 6:t[n++]=255&e|h,e/=128;case 5:t[n++]=255&e|h,e/=128;case 4:t[n++]=255&e|h,e>>>=7;case 3:t[n++]=255&e|h,e>>>=7;case 2:t[n++]=255&e|h,e>>>=7;case 1:t[n++]=255&e,e>>>=7;break;default:throw new Error("unreachable")}return t}(e,t,n):function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;switch(f(e)){case 8:t.set(n++,255&e|h),e/=128;case 7:t.set(n++,255&e|h),e/=128;case 6:t.set(n++,255&e|h),e/=128;case 5:t.set(n++,255&e|h),e/=128;case 4:t.set(n++,255&e|h),e>>>=7;case 3:t.set(n++,255&e|h),e>>>=7;case 2:t.set(n++,255&e|h),e>>>=7;case 1:t.set(n++,255&e),e>>>=7;break;default:throw new Error("unreachable")}return t}(e,t,n)}function g(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e instanceof Uint8Array?function(e,t){let n=e[t],r=0;if(r+=n&d,n<h)return r;if(n=e[t+1],r+=(n&d)<<7,n<h)return r;if(n=e[t+2],r+=(n&d)<<14,n<h)return r;if(n=e[t+3],r+=(n&d)<<21,n<h)return r;if(n=e[t+4],r+=(n&d)*a,n<h)return r;if(n=e[t+5],r+=(n&d)*c,n<h)return r;if(n=e[t+6],r+=(n&d)*l,n<h)return r;if(n=e[t+7],r+=(n&d)*u,n<h)return r;throw new RangeError("Could not decode varint")}(e,t):function(e,t){let n=e.get(t),r=0;if(r+=n&d,n<h)return r;if(n=e.get(t+1),r+=(n&d)<<7,n<h)return r;if(n=e.get(t+2),r+=(n&d)<<14,n<h)return r;if(n=e.get(t+3),r+=(n&d)<<21,n<h)return r;if(n=e.get(t+4),r+=(n&d)*a,n<h)return r;if(n=e.get(t+5),r+=(n&d)*c,n<h)return r;if(n=e.get(t+6),r+=(n&d)*l,n<h)return r;if(n=e.get(t+7),r+=(n&d)*u,n<h)return r;throw new RangeError("Could not decode varint")}(e,t)}},32996:(e,t,n)=>{var r=n(98059);e.exports=function(e,t){return null==e?"":(e=String(e),r(e.charAt(0),t)+e.substr(1))}},98059:e=>{var t={tr:{regexp:/[\u0069]/g,map:{i:"\u0130"}},az:{regexp:/[\u0069]/g,map:{i:"\u0130"}},lt:{regexp:/[\u0069\u006A\u012F]\u0307|\u0069\u0307[\u0300\u0301\u0303]/g,map:{"i\u0307":"I","j\u0307":"J","\u012f\u0307":"\u012e","i\u0307\u0300":"\xcc","i\u0307\u0301":"\xcd","i\u0307\u0303":"\u0128"}}};e.exports=function(e,n){var r=t[n];return e=null==e?"":String(e),r&&(e=e.replace(r.regexp,(function(e){return r.map[e]}))),e.toUpperCase()}},34847:e=>{"use strict";function t(e){return e>=55296&&e<=56319}function n(e){return e>=56320&&e<=57343}e.exports=function(e){if("string"!==typeof e)throw new Error("Input must be string");for(var r=e.length,i=0,o=null,s=null,a=0;a<r;a++)n(o=e.charCodeAt(a))?null!=s&&t(s)?i+=1:i+=3:o<=127?i+=1:o>=128&&o<=2047?i+=2:o>=2048&&o<=65535&&(i+=3),s=o;return i}},89662:e=>{e.exports=function e(r,i){var o,s=0,a=0,c=i=i||0,l=r.length;do{if(c>=l)throw e.bytes=0,new RangeError("Could not decode varint");o=r[c++],s+=a<28?(o&n)<<a:(o&n)*Math.pow(2,a),a+=7}while(o>=t);return e.bytes=c-i,s};var t=128,n=127},41625:e=>{e.exports=function e(i,o,s){o=o||[];var a=s=s||0;for(;i>=r;)o[s++]=255&i|t,i/=128;for(;i&n;)o[s++]=255&i|t,i>>>=7;return o[s]=0|i,e.bytes=s-a+1,o};var t=128,n=-128,r=Math.pow(2,31)},66074:(e,t,n)=>{e.exports={encode:n(41625),decode:n(89662),encodingLength:n(33120)}},33120:e=>{var t=Math.pow(2,7),n=Math.pow(2,14),r=Math.pow(2,21),i=Math.pow(2,28),o=Math.pow(2,35),s=Math.pow(2,42),a=Math.pow(2,49),c=Math.pow(2,56),l=Math.pow(2,63);e.exports=function(e){return e<t?1:e<n?2:e<r?3:e<i?4:e<o?5:e<s?6:e<a?7:e<c?8:e<l?9:10}},29806:(e,t,n)=>{"use strict";const r=n(66074);e.exports=e=>{if(!(e instanceof Uint8Array))throw new Error("arg needs to be a Uint8Array");const t=[];for(;e.length>0;){const n=r.decode(e);t.push(n),e=e.slice(r.decode.bytes)}return t}},23522:e=>{e.exports=function e(r,i){var o,s=0,a=0,c=i=i||0,l=r.length;do{if(c>=l||a>49)throw e.bytes=0,new RangeError("Could not decode varint");o=r[c++],s+=a<28?(o&n)<<a:(o&n)*Math.pow(2,a),a+=7}while(o>=t);return e.bytes=c-i,s};var t=128,n=127},26993:e=>{e.exports=function e(i,o,s){if(Number.MAX_SAFE_INTEGER&&i>Number.MAX_SAFE_INTEGER)throw e.bytes=0,new RangeError("Could not encode varint");o=o||[];var a=s=s||0;for(;i>=r;)o[s++]=255&i|t,i/=128;for(;i&n;)o[s++]=255&i|t,i>>>=7;return o[s]=0|i,e.bytes=s-a+1,o};var t=128,n=-128,r=Math.pow(2,31)},74561:(e,t,n)=>{e.exports={encode:n(26993),decode:n(23522),encodingLength:n(12570)}},12570:e=>{var t=Math.pow(2,7),n=Math.pow(2,14),r=Math.pow(2,21),i=Math.pow(2,28),o=Math.pow(2,35),s=Math.pow(2,42),a=Math.pow(2,49),c=Math.pow(2,56),l=Math.pow(2,63);e.exports=function(e){return e<t?1:e<n?2:e<r?3:e<i?4:e<o?5:e<s?6:e<a?7:e<c?8:e<l?9:10}},17399:e=>{e.exports={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}},15560:function(e,t,n){"use strict";e.exports="object"===typeof self&&self.self===self&&self||"object"===typeof n.g&&n.g.global===n.g&&n.g||this},54636:(e,t,n)=>{"use strict";n.d(t,{C:()=>i,aY:()=>o,h6:()=>s});var r=n(21319);function i(e){return Boolean((0,r.cs)(e))}function o(e){return Boolean((0,r.XK)(e))}function s(e){return Boolean((0,r.yb)(e))}},21319:(e,t,n)=>{"use strict";n.d(t,{yb:()=>c,cs:()=>s,XK:()=>a});const r=45,i=15,o=new class{index=0;input="";new(e){return this.index=0,this.input=e,this}readAtomically(e){const t=this.index,n=e();return void 0===n&&(this.index=t),n}parseWith(e){const t=e();if(this.index===this.input.length)return t}peekChar(){if(!(this.index>=this.input.length))return this.input[this.index]}readChar(){if(!(this.index>=this.input.length))return this.input[this.index++]}readGivenChar(e){return this.readAtomically((()=>{const t=this.readChar();if(t===e)return t}))}readSeparator(e,t,n){return this.readAtomically((()=>{if(!(t>0&&void 0===this.readGivenChar(e)))return n()}))}readNumber(e,t,n,r){return this.readAtomically((()=>{let i=0,o=0;const s=this.peekChar();if(void 0===s)return;const a="0"===s,c=2**(8*r)-1;for(;;){const n=this.readAtomically((()=>{const t=this.readChar();if(void 0===t)return;const n=Number.parseInt(t,e);return Number.isNaN(n)?void 0:n}));if(void 0===n)break;if(i*=e,i+=n,i>c)return;if(o+=1,void 0!==t&&o>t)return}return 0===o||!n&&a&&o>1?void 0:i}))}readIPv4Addr(){return this.readAtomically((()=>{const e=new Uint8Array(4);for(let t=0;t<e.length;t++){const n=this.readSeparator(".",t,(()=>this.readNumber(10,3,!1,1)));if(void 0===n)return;e[t]=n}return e}))}readIPv6Addr(){const e=e=>{for(let t=0;t<e.length/2;t++){const n=2*t;if(t<e.length-3){const r=this.readSeparator(":",t,(()=>this.readIPv4Addr()));if(void 0!==r)return e[n]=r[0],e[n+1]=r[1],e[n+2]=r[2],e[n+3]=r[3],[n+4,!0]}const r=this.readSeparator(":",t,(()=>this.readNumber(16,4,!0,2)));if(void 0===r)return[n,!1];e[n]=r>>8,e[n+1]=255&r}return[e.length,!1]};return this.readAtomically((()=>{const t=new Uint8Array(16),[n,r]=e(t);if(16===n)return t;if(r)return;if(void 0===this.readGivenChar(":"))return;if(void 0===this.readGivenChar(":"))return;const i=new Uint8Array(14),o=16-(n+2),[s]=e(i.subarray(0,o));return t.set(i.subarray(0,s),16-s),t}))}readIPAddr(){return this.readIPv4Addr()??this.readIPv6Addr()}};function s(e){if(!(e.length>i))return o.new(e).parseWith((()=>o.readIPv4Addr()))}function a(e){if(e.includes("%")&&(e=e.split("%")[0]),!(e.length>r))return o.new(e).parseWith((()=>o.readIPv6Addr()))}function c(e){if(e.includes("%")&&(e=e.split("%")[0]),!(e.length>r))return o.new(e).parseWith((()=>o.readIPAddr()))}},25546:(e,t,n)=>{"use strict";n.d(t,{dx:()=>X,Rk:()=>x,IP:()=>L,Iq:()=>B,Ul:()=>J,uF:()=>$,Ih:()=>G,Mk:()=>Q});var r=n(54636);n(95321);var i=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==n[s])throw new TypeError(o+" is ambiguous");n[s]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var r=0,i=0;e[t]===c;)r++,t++;for(var o=(e.length-t)*l+1>>>0,s=new Uint8Array(o);e[t];){var u=n[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=o-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*s[d]>>>0,s[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=o-i;f!==o&&0===s[f];)f++;for(var p=new Uint8Array(r+(o-f)),g=r;f!==o;)p[g++]=s[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,o=t.length;i!==o&&0===t[i];)i++,n++;for(var s=(o-i)*u+1>>>0,l=new Uint8Array(s);i!==o;){for(var h=t[i],d=0,f=s-1;(0!==h||d<r)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");r=d,i++}for(var p=s-r;p!==s&&0===l[p];)p++;for(var g=c.repeat(n);p<s;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:h,decode:function(e){var n=h(e);if(n)return n;throw new Error(`Non-${t} character`)}}};const o=i;new Uint8Array(0);class s{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class a{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return l(this,e)}}class c{constructor(e){this.decoders=e}or(e){return l(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const l=(e,t)=>new c({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class u{constructor(e,t,n,r){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=r,this.encoder=new s(e,t,n),this.decoder=new a(e,t,r)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const h=({name:e,prefix:t,encode:n,decode:r})=>new u(e,t,n,r),d=({prefix:e,name:t,alphabet:n})=>{const{encode:r,decode:i}=o(n,t);return h({prefix:e,name:t,encode:r,decode:e=>(e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")})(i(e))})},f=({name:e,prefix:t,bitsPerChar:n,alphabet:r})=>h({prefix:t,name:e,encode:e=>((e,t,n)=>{const r="="===t[t.length-1],i=(1<<n)-1;let o="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>n;)s-=n,o+=t[i&a>>s];if(s&&(o+=t[i&a<<n-s]),r)for(;o.length*n&7;)o+="=";return o})(e,r,n),decode:t=>((e,t,n,r)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*n/8|0);let a=0,c=0,l=0;for(let u=0;u<o;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError(`Non-${r} character`);c=c<<n|t,a+=n,a>=8&&(a-=8,s[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s})(t,r,n,e)}),p=d({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),g=(d({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),f({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),f({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),f({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6})),y=(f({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),e=>({match:t=>!(t.length<1)&&(!!e(t[0])&&t.slice(1)),pattern:"fn"})),m=e=>({match:t=>y((t=>t===e)).match(t),pattern:e}),v=()=>({match:e=>y((e=>"string"===typeof e)).match(e),pattern:"{string}"}),b=()=>({match:e=>y((e=>!isNaN(parseInt(e)))).match(e),pattern:"{number}"}),w=()=>({match:e=>{if(e.length<2)return!1;if("p2p"!==e[0]&&"ipfs"!==e[0])return!1;if(!e[1].startsWith("Q")&&!e[1].startsWith("1"))return!1;try{p.decode(`z${e[1]}`)}catch(t){return!1}return e.slice(2)},pattern:"/p2p/{peerid}"}),E=()=>({match:e=>{if(e.length<2)return!1;if("certhash"!==e[0])return!1;try{g.decode(e[1])}catch{return!1}return e.slice(2)},pattern:"/certhash/{certhash}"}),A=e=>({match:t=>{const n=e.match(t);return!1===n?t:n},pattern:`optional(${e.pattern})`}),S=(...e)=>({match:t=>{let n;for(const r of e){const e=r.match(t);!1!==e&&((null==n||e.length<n.length)&&(n=e))}return null!=n&&n},pattern:`or(${e.map((e=>e.pattern)).join(", ")})`}),_=(...e)=>({match:t=>{for(const n of e){const e=n.match(t);if(!1===e)return!1;t=e}return t},pattern:`and(${e.map((e=>e.pattern)).join(", ")})`});function I(...e){function t(t){let n=(e=>e.toString().split("/").slice(1))(t);for(const r of e){const e=r.match(n);if(!1===e)return!1;n=e}return n}return{matches:function(e){return!1!==t(e)},exactMatch:function(e){const n=t(e);return!1!==n&&0===n.length}}}const C=_(m("dns4"),v()),T=_(m("dns6"),v()),k=_(m("dnsaddr"),v()),R=_(m("dns"),v()),x=(I(C),I(T),I(k),I(S(R,k,C,T))),P=_(m("ip4"),y(r.C)),D=_(m("ip6"),y(r.aY)),O=S(P,D),N=S(O,R,C,T,k),B=I(N),L=(I(P),I(D),I(O)),M=_(N,m("tcp"),b()),U=_(N,m("udp"),b()),F=S(M,U),K=(I(M),I(U),_(U,m("quic"))),j=_(U,m("quic-v1")),Z=S(K,j),z=(I(K),I(j),S(N,M,U,K,j)),V=S(_(z,m("ws"),A(w()))),H=(I(V),S(_(z,m("wss"),A(w())),_(z,m("tls"),m("ws"),A(w())))),q=(I(H),_(F,m("webrtc-direct"),E(),A(E()),A(w()))),G=I(q),W=_(j,m("webtransport"),E(),E(),A(w())),Q=I(W),Y=S(V,H,_(M,A(w())),_(Z,A(w())),_(N,A(w())),q,W,w()),J=I(Y),X=I(_(Y,m("p2p-circuit"),w())),$=I(S(_(Y,m("p2p-circuit"),m("webrtc"),w()),_(Y,m("webrtc"),A(w())),m("webrtc")))},96118:(e,t,n)=>{"use strict";n.d(t,{k:()=>c});var r=n(95321);function i(e){let t;try{t=(0,r.a_)("sni").code}catch(n){return null}for(const[r,i]of e)if(r===t&&void 0!==i)return i;return null}function o(e){return e.some((([e,t])=>e===(0,r.a_)("tls").code))}function s(e,t,n){const i=a[(0,r.a_)(e).name];if(void 0===i)throw new Error(`Can't interpret protocol ${(0,r.a_)(e).name}`);const o=i(t,n);return e===(0,r.a_)("ip6").code?`[${o}]`:o}const a={ip4:(e,t)=>e,ip6:(e,t)=>0===t.length?e:`[${e}]`,tcp:(e,t)=>{const n=t.pop();if(void 0===n)throw new Error("Unexpected end of multiaddr");return`tcp://${s(n[0],n[1]??"",t)}:${e}`},udp:(e,t)=>{const n=t.pop();if(void 0===n)throw new Error("Unexpected end of multiaddr");return`udp://${s(n[0],n[1]??"",t)}:${e}`},dnsaddr:(e,t)=>e,dns4:(e,t)=>e,dns6:(e,t)=>e,dns:(e,t)=>e,ipfs:(e,t)=>{const n=t.pop();if(void 0===n)throw new Error("Unexpected end of multiaddr");return`${s(n[0],n[1]??"",t)}/ipfs/${e}`},p2p:(e,t)=>{const n=t.pop();if(void 0===n)throw new Error("Unexpected end of multiaddr");return`${s(n[0],n[1]??"",t)}/p2p/${e}`},http:(e,t)=>{const n=o(t),r=i(t);if(n&&null!==r)return`https://${r}`;const a=n?"https://":"http://",c=t.pop();if(void 0===c)throw new Error("Unexpected end of multiaddr");let l=s(c[0],c[1]??"",t);return l=l.replace("tcp://",""),`${a}${l}`},tls:(e,t)=>{const n=t.pop();if(void 0===n)throw new Error("Unexpected end of multiaddr");return s(n[0],n[1]??"",t)},sni:(e,t)=>{const n=t.pop();if(void 0===n)throw new Error("Unexpected end of multiaddr");return s(n[0],n[1]??"",t)},https:(e,t)=>{const n=t.pop();if(void 0===n)throw new Error("Unexpected end of multiaddr");let r=s(n[0],n[1]??"",t);return r=r.replace("tcp://",""),`https://${r}`},ws:(e,t)=>{const n=o(t),r=i(t);if(n&&null!==r)return`wss://${r}`;const a=n?"wss://":"ws://",c=t.pop();if(void 0===c)throw new Error("Unexpected end of multiaddr");let l=s(c[0],c[1]??"",t);return l=l.replace("tcp://",""),`${a}${l}`},wss:(e,t)=>{const n=t.pop();if(void 0===n)throw new Error("Unexpected end of multiaddr");let r=s(n[0],n[1]??"",t);return r=r.replace("tcp://",""),`wss://${r}`},"p2p-websocket-star":(e,t)=>{const n=t.pop();if(void 0===n)throw new Error("Unexpected end of multiaddr");return`${s(n[0],n[1]??"",t)}/p2p-websocket-star`},"p2p-webrtc-star":(e,t)=>{const n=t.pop();if(void 0===n)throw new Error("Unexpected end of multiaddr");return`${s(n[0],n[1]??"",t)}/p2p-webrtc-star`},"p2p-webrtc-direct":(e,t)=>{const n=t.pop();if(void 0===n)throw new Error("Unexpected end of multiaddr");return`${s(n[0],n[1]??"",t)}/p2p-webrtc-direct`}};function c(e,t){const n=(0,r.HM)(e).stringTuples(),i=n.pop();if(void 0===i)throw new Error("Unexpected end of multiaddr");const o=(0,r.a_)(i[0]),s=a[o.name];if(null==s)throw new Error(`No interpreter found for ${o.name}`);let c=s(i[1]??"",n);return!1!==t?.assumeHttp&&i[0]===(0,r.a_)("tcp").code&&(c=c.replace("tcp://","http://"),"443"!==i[1]&&"80"!==i[1]||("443"===i[1]&&(c=c.replace("http://","https://")),c=c.substring(0,c.lastIndexOf(":")))),c}},37318:(e,t,n)=>{"use strict";n.d(t,{Fm:()=>E,xV:()=>w});n(21319);parseInt("0xFFFF",16),new Uint8Array([0,0,0,0,0,0,0,0,0,0,255,255]);var r=n(3886),i=n(55577),o=n(52704),s=n(47652),a=n(71178),c=n(80136),l=n(84728),u=n(13806),h=n(12392);function d(e,t="utf8"){const n=h.Z[t];if(null==n)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.decoder.decode(`${n.prefix}${e}`):(0,u.P)(globalThis.Buffer.from(e,"utf-8"))}var f=n(60737),p=n(54636);const g=p.C,y=p.aY,m=function(e){let t=0;if(e=e.toString().trim(),g(e)){const n=new Uint8Array(t+4);return e.split(/\./g).forEach((e=>{n[t++]=255&parseInt(e,10)})),n}if(y(e)){const n=e.split(":",8);let r;for(r=0;r<n.length;r++){let e;g(n[r])&&(e=m(n[r]),n[r]=(0,f.B)(e.slice(0,2),"base16")),null!=e&&++r<8&&n.splice(r,0,(0,f.B)(e.slice(2,4),"base16"))}if(""===n[0])for(;n.length<8;)n.unshift("0");else if(""===n[n.length-1])for(;n.length<8;)n.push("0");else if(n.length<8){for(r=0;r<n.length&&""!==n[r];r++);const e=[r,1];for(r=9-n.length;r>0;r--)e.push("0");n.splice.apply(n,e)}const i=new Uint8Array(t+16);for(r=0;r<n.length;r++){const e=parseInt(n[r],16);i[t++]=e>>8&255,i[t++]=255&e}return i}throw new Error("invalid ip address")},v=function(e,t=0,n){t=~~t,n=n??e.length-t;const r=new DataView(e.buffer);if(4===n){const r=[];for(let i=0;i<n;i++)r.push(e[t+i]);return r.join(".")}if(16===n){const e=[];for(let i=0;i<n;i+=2)e.push(r.getUint16(t+i).toString(16));return e.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""};var b=n(67024);(0,b.Ev)("ip4"),(0,b.Ev)("ip6"),(0,b.Ev)("ipcidr");function w(e,t){switch((0,b.Ev)(e).code){case 4:case 41:return function(e){const t=v(e,0,e.length);if(null==t)throw new Error("ipBuff is required");if(!p.h6(t))throw new Error("invalid ip address");return t}(t);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return k(t);case 6:case 273:case 33:case 132:return C(t).toString();case 421:return function(e){const t=c.Jx(e),n=e.slice(c.P$(t));if(n.length!==t)throw new Error("inconsistent lengths");return(0,f.B)(n,"base58btc")}(t);case 444:case 445:return R(t);case 466:return function(e){const t=c.Jx(e),n=e.slice(c.P$(t));if(n.length!==t)throw new Error("inconsistent lengths");return"u"+(0,f.B)(n,"base64url")}(t);default:return(0,f.B)(t,"base16")}}function E(e,t){switch((0,b.Ev)(e).code){case 4:case 41:return _(t);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return T(t);case 6:case 273:case 33:case 132:return I(parseInt(t,10));case 421:return function(e){let t;t="Q"===e[0]||"1"===e[0]?a.Jx(i.base58btc.decode(`z${e}`)).bytes:s.k0.parse(e).multihash.bytes;const n=Uint8Array.from(c.cv(t.length));return(0,l.z)([n,t],n.length+t.length)}(t);case 444:return function(e){const t=e.split(":");if(2!==t.length)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(16!==t[0].length)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion address.`);const n=r.base32.decode("b"+t[0]),i=parseInt(t[1],10);if(i<1||i>65536)throw new Error("Port number is not in range(1, 65536)");const o=I(i);return(0,l.z)([n,o],n.length+o.length)}(t);case 445:return function(e){const t=e.split(":");if(2!==t.length)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(56!==t[0].length)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion3 address.`);const n=r.base32.decode(`b${t[0]}`),i=parseInt(t[1],10);if(i<1||i>65536)throw new Error("Port number is not in range(1, 65536)");const o=I(i);return(0,l.z)([n,o],n.length+o.length)}(t);case 466:return function(e){const t=S.decode(e),n=Uint8Array.from(c.cv(t.length));return(0,l.z)([n,t],n.length+t.length)}(t);default:return d(t,"base16")}}const A=Object.values(o.gh).map((e=>e.decoder)),S=function(){let e=A[0].or(A[1]);return A.slice(2).forEach((t=>e=e.or(t))),e}();function _(e){if(!p.h6(e))throw new Error("invalid ip address");return m(e)}function I(e){const t=new ArrayBuffer(2);return new DataView(t).setUint16(0,e),new Uint8Array(t)}function C(e){return new DataView(e.buffer).getUint16(e.byteOffset)}function T(e){const t=d(e),n=Uint8Array.from(c.cv(t.length));return(0,l.z)([n,t],n.length+t.length)}function k(e){const t=c.Jx(e);if((e=e.slice(c.P$(t))).length!==t)throw new Error("inconsistent lengths");return(0,f.B)(e)}function R(e){const t=e.slice(0,e.length-2),n=e.slice(e.length-2);return`${(0,f.B)(t,"base32")}:${C(n)}`}},95321:(e,t,n)=>{"use strict";n.d(t,{h2:()=>A,HM:()=>S,a_:()=>u.Ev,s_:()=>E});var r=n(7619),i=n(55577),o=n(47652);var s=n(60737),a=n(80136),c=n(84728),l=n(37318),u=n(67024);function h(e){const t=[],n=[];let r=null,i=0;for(;i<e.length;){const o=a.Jx(e,i),c=a.P$(o),h=(0,u.Ev)(o),d=p(h,e.slice(i+c));if(0===d){t.push([o]),n.push([o]),i+=c;continue}const f=e.slice(i+c,i+c+d);if(i+=d+c,i>e.length)throw y("Invalid address Uint8Array: "+(0,s.B)(e,"base16"));t.push([o,f]);const g=(0,l.xV)(o,f);if(n.push([o,g]),!0===h.path){r=g;break}}return{bytes:Uint8Array.from(e),string:d(n),tuples:t,stringTuples:n,path:r}}function d(e){const t=[];return e.map((e=>{const n=(0,u.Ev)(e[0]);return t.push(n.name),e.length>1&&null!=e[1]&&t.push(e[1]),null})),g(t.join("/"))}function f(e){return(0,c.z)(e.map((e=>{const t=(0,u.Ev)(e[0]);let n=Uint8Array.from(a.cv(t.code));return e.length>1&&null!=e[1]&&(n=(0,c.z)([n,e[1]])),n})))}function p(e,t){if(e.size>0)return e.size/8;if(0===e.size)return 0;{const e=a.Jx(t instanceof Uint8Array?t:Uint8Array.from(t));return e+a.P$(e)}}function g(e){return"/"+e.trim().split("/").filter((e=>e)).join("/")}function y(e){return new Error("Error parsing address: "+e)}const m=Symbol.for("nodejs.util.inspect.custom"),v=Symbol.for("@multiformats/js-multiaddr/multiaddr"),b=[(0,u.Ev)("dns").code,(0,u.Ev)("dns4").code,(0,u.Ev)("dns6").code,(0,u.Ev)("dnsaddr").code];class w{bytes;#e;#t;#n;#r;[v]=!0;constructor(e){let t;if(null==e&&(e=""),e instanceof Uint8Array)t=h(e);else if("string"===typeof e){if(e.length>0&&"/"!==e.charAt(0))throw new Error(`multiaddr "${e}" must start with a "/"`);t=function(e){const t=[],n=[];let r=null;const i=(e=g(e)).split("/").slice(1);if(1===i.length&&""===i[0])return{bytes:new Uint8Array,string:"/",tuples:[],stringTuples:[],path:null};for(let o=0;o<i.length;o++){const s=i[o],a=(0,u.Ev)(s);if(0===a.size){t.push([a.code]),n.push([a.code]);continue}if(o++,o>=i.length)throw y("invalid address: "+e);if(!0===a.path){r=g(i.slice(o).join("/")),t.push([a.code,(0,l.Fm)(a.code,r)]),n.push([a.code,r]);break}const c=(0,l.Fm)(a.code,i[o]);t.push([a.code,c]),n.push([a.code,(0,l.xV)(a.code,c)])}return{string:d(n),bytes:f(t),tuples:t,stringTuples:n,path:r}}(e)}else{if(!A(e))throw new Error("addr must be a string, Buffer, or another Multiaddr");t=h(e.bytes)}this.bytes=t.bytes,this.#e=t.string,this.#t=t.tuples,this.#n=t.stringTuples,this.#r=t.path}toString(){return this.#e}toJSON(){return this.toString()}toOptions(){let e,t,n,r,i="";const o=(0,u.Ev)("tcp"),s=(0,u.Ev)("udp"),a=(0,u.Ev)("ip4"),c=(0,u.Ev)("ip6"),l=(0,u.Ev)("dns6"),h=(0,u.Ev)("ip6zone");for(const[d,f]of this.stringTuples())d===h.code&&(i=`%${f??""}`),b.includes(d)&&(t=o.name,r=443,n=`${f??""}${i}`,e=d===l.code?6:4),d!==o.code&&d!==s.code||(t=(0,u.Ev)(d).name,r=parseInt(f??"")),d!==a.code&&d!==c.code||(t=(0,u.Ev)(d).name,n=`${f??""}${i}`,e=d===c.code?6:4);if(null==e||null==t||null==n||null==r)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e,host:n,transport:t,port:r}}protos(){return this.#t.map((([e])=>Object.assign({},(0,u.Ev)(e))))}protoCodes(){return this.#t.map((([e])=>e))}protoNames(){return this.#t.map((([e])=>(0,u.Ev)(e).name))}tuples(){return this.#t}stringTuples(){return this.#n}encapsulate(e){return e=new w(e),new w(this.toString()+e.toString())}decapsulate(e){const t=e.toString(),n=this.toString(),r=n.lastIndexOf(t);if(r<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${e.toString()}`);return new w(n.slice(0,r))}decapsulateCode(e){const t=this.tuples();for(let n=t.length-1;n>=0;n--)if(t[n][0]===e)return new w(f(t.slice(0,n)));return this}getPeerId(){try{let e=[];this.stringTuples().forEach((([t,n])=>{t===u.R5.p2p.code&&e.push([t,n]),t===u.R5["p2p-circuit"].code&&(e=[])}));const t=e.pop();if(null!=t?.[1]){const e=t[1];return"Q"===e[0]||"1"===e[0]?(0,s.B)(i.base58btc.decode(`z${e}`),"base58btc"):(0,s.B)(o.k0.parse(e).multihash.bytes,"base58btc")}return null}catch(e){return null}}getPath(){return this.#r}equals(e){return function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0}(this.bytes,e.bytes)}async resolve(e){const t=this.protos().find((e=>e.resolvable));if(null==t)return[this];const n=E.get(t.name);if(null==n)throw new r.sv(`no available resolver for ${t.name}`,"ERR_NO_AVAILABLE_RESOLVER");return(await n(this,e)).map((e=>new w(e)))}nodeAddress(){const e=this.toOptions();if("tcp"!==e.transport&&"udp"!==e.transport)throw new Error(`multiaddr must have a valid format - no protocol with name: "${e.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:e.family,address:e.host,port:e.port}}isThinWaistAddress(e){const t=(e??this).protos();return 2===t.length&&((4===t[0].code||41===t[0].code)&&(6===t[1].code||273===t[1].code))}[m](){return`Multiaddr(${this.#e})`}}const E=new Map;function A(e){return Boolean(e?.[v])}function S(e){return new w(e)}},67024:(e,t,n)=>{"use strict";n.d(t,{Ev:()=>s,R5:()=>i});const r=-1,i={},o={};function s(e){if("number"===typeof e){if(null!=o[e])return o[e];throw new Error(`no protocol with code: ${e}`)}if("string"===typeof e){if(null!=i[e])return i[e];throw new Error(`no protocol with name: ${e}`)}throw new Error("invalid protocol id type: "+typeof e)}[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,r,"ip6zone"],[43,8,"ipcidr"],[53,r,"dns",!0],[54,r,"dns4",!0],[55,r,"dns6",!0],[56,r,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,r,"unix",!1,!0],[421,r,"ipfs"],[421,r,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,r,"garlic64"],[448,0,"tls"],[449,r,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,r,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,r,"memory"]].forEach((e=>{const t=function(e,t,n,r,i){return{code:e,size:t,name:n,resolvable:Boolean(r),path:Boolean(i)}}(...e);o[t.code]=t,i[t.name]=t}))},31573:(e,t,n)=>{"use strict";n.d(t,{E:()=>i});var r=n(13806);function i(e=0){return null!=globalThis.Buffer?.allocUnsafe?(0,r.P)(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}},84728:(e,t,n)=>{"use strict";n.d(t,{z:()=>o});var r=n(31573),i=n(13806);function o(e,t){if(null!=globalThis.Buffer)return(0,i.P)(globalThis.Buffer.concat(e,t));null==t&&(t=e.reduce(((e,t)=>e+t.length),0));const n=(0,r.E)(t);let o=0;for(const r of e)n.set(r,o),o+=r.length;return(0,i.P)(n)}},60737:(e,t,n)=>{"use strict";n.d(t,{B:()=>i});var r=n(12392);function i(e,t="utf8"){const n=r.Z[t];if(null==n)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}},13806:(e,t,n)=>{"use strict";function r(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}n.d(t,{P:()=>r})},12392:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var r=n(52704),i=n(31573);function o(e,t,n,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:r}}}const s=o("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),a=o("ascii","a",(e=>{let t="a";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}),(e=>{e=e.substring(1);const t=(0,i.E)(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t})),c={utf8:s,"utf-8":s,hex:r.gh.base16,latin1:a,ascii:a,binary:a,...r.gh}},65450:(e,t,n)=>{"use strict";n.d(t,{E:()=>i});var r=n(64617);function i(e=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?(0,r.P)(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}},94450:(e,t,n)=>{"use strict";n.r(t),n.d(t,{concat:()=>o});var r=n(65450),i=n(64617);function o(e,t){t||(t=e.reduce(((e,t)=>e+t.length),0));const n=(0,r.E)(t);let o=0;for(const r of e)n.set(r,o),o+=r.length;return(0,i.P)(n)}},27271:(e,t,n)=>{"use strict";n.r(t),n.d(t,{fromString:()=>o});var r=n(77470),i=n(64617);function o(e,t="utf8"){const n=r.Z[t];if(!n)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.decoder.decode(`${n.prefix}${e}`):(0,i.P)(globalThis.Buffer.from(e,"utf-8"))}},88238:(e,t,n)=>{"use strict";n.r(t),n.d(t,{toString:()=>i});var r=n(77470);function i(e,t="utf8"){const n=r.Z[t];if(!n)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}},64617:(e,t,n)=>{"use strict";function r(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}n.d(t,{P:()=>r})},77470:(e,t,n)=>{"use strict";n.d(t,{Z:()=>Ve});var r={};n.r(r),n.d(r,{identity:()=>k});var i={};n.r(i),n.d(i,{base2:()=>R});var o={};n.r(o),n.d(o,{base8:()=>x});var s={};n.r(s),n.d(s,{base10:()=>P});var a={};n.r(a),n.d(a,{base16:()=>D,base16upper:()=>O});var c={};n.r(c),n.d(c,{base32:()=>N,base32hex:()=>U,base32hexpad:()=>K,base32hexpadupper:()=>j,base32hexupper:()=>F,base32pad:()=>L,base32padupper:()=>M,base32upper:()=>B,base32z:()=>Z});var l={};n.r(l),n.d(l,{base36:()=>z,base36upper:()=>V});var u={};n.r(u),n.d(u,{base58btc:()=>H,base58flickr:()=>q});var h={};n.r(h),n.d(h,{base64:()=>G,base64pad:()=>W,base64url:()=>Q,base64urlpad:()=>Y});var d={};n.r(d),n.d(d,{base256emoji:()=>ee});var f={};n.r(f),n.d(f,{sha256:()=>Ie,sha512:()=>Ce});var p={};n.r(p),n.d(p,{identity:()=>ke});var g={};n.r(g),n.d(g,{code:()=>xe,decode:()=>De,encode:()=>Pe,name:()=>Re});var y={};n.r(y),n.d(y,{code:()=>Le,decode:()=>Ue,encode:()=>Me,name:()=>Be});var m=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==n[s])throw new TypeError(o+" is ambiguous");n[s]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var r=0,i=0;e[t]===c;)r++,t++;for(var o=(e.length-t)*l+1>>>0,s=new Uint8Array(o);e[t];){var u=n[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=o-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*s[d]>>>0,s[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=o-i;f!==o&&0===s[f];)f++;for(var p=new Uint8Array(r+(o-f)),g=r;f!==o;)p[g++]=s[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,o=t.length;i!==o&&0===t[i];)i++,n++;for(var s=(o-i)*u+1>>>0,l=new Uint8Array(s);i!==o;){for(var h=t[i],d=0,f=s-1;(0!==h||d<r)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");r=d,i++}for(var p=s-r;p!==s&&0===l[p];)p++;for(var g=c.repeat(n);p<s;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:h,decode:function(e){var n=h(e);if(n)return n;throw new Error("Non-".concat(t," character"))}}};const v=m,b=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class w{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(e));throw Error("Unknown type, must be binary type")}}class E{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(e),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return S(this,e)}}class A{constructor(e){this.decoders=e}or(e){return S(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(e),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}}const S=(e,t)=>new A({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class _{constructor(e,t,n,r){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=r,this.encoder=new w(e,t,n),this.decoder=new E(e,t,r)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const I=e=>{let{name:t,prefix:n,encode:r,decode:i}=e;return new _(t,n,r,i)},C=e=>{let{prefix:t,name:n,alphabet:r}=e;const{encode:i,decode:o}=v(r,n);return I({prefix:t,name:n,encode:i,decode:e=>b(o(e))})},T=e=>{let{name:t,prefix:n,bitsPerChar:r,alphabet:i}=e;return I({prefix:n,name:t,encode:e=>((e,t,n)=>{const r="="===t[t.length-1],i=(1<<n)-1;let o="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>n;)s-=n,o+=t[i&a>>s];if(s&&(o+=t[i&a<<n-s]),r)for(;o.length*n&7;)o+="=";return o})(e,i,r),decode:e=>((e,t,n,r)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*n/8|0);let a=0,c=0,l=0;for(let u=0;u<o;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError("Non-".concat(r," character"));c=c<<n|t,a+=n,a>=8&&(a-=8,s[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s})(e,i,r,t)})},k=I({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),R=T({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),x=T({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),P=C({prefix:"9",name:"base10",alphabet:"0123456789"}),D=T({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),O=T({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),N=T({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),B=T({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),L=T({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),M=T({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),U=T({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),F=T({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),K=T({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),j=T({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Z=T({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),z=C({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),V=C({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),H=C({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),q=C({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),G=T({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),W=T({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Q=T({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Y=T({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),J=Array.from("\ud83d\ude80\ud83e\ude90\u2604\ud83d\udef0\ud83c\udf0c\ud83c\udf11\ud83c\udf12\ud83c\udf13\ud83c\udf14\ud83c\udf15\ud83c\udf16\ud83c\udf17\ud83c\udf18\ud83c\udf0d\ud83c\udf0f\ud83c\udf0e\ud83d\udc09\u2600\ud83d\udcbb\ud83d\udda5\ud83d\udcbe\ud83d\udcbf\ud83d\ude02\u2764\ud83d\ude0d\ud83e\udd23\ud83d\ude0a\ud83d\ude4f\ud83d\udc95\ud83d\ude2d\ud83d\ude18\ud83d\udc4d\ud83d\ude05\ud83d\udc4f\ud83d\ude01\ud83d\udd25\ud83e\udd70\ud83d\udc94\ud83d\udc96\ud83d\udc99\ud83d\ude22\ud83e\udd14\ud83d\ude06\ud83d\ude44\ud83d\udcaa\ud83d\ude09\u263a\ud83d\udc4c\ud83e\udd17\ud83d\udc9c\ud83d\ude14\ud83d\ude0e\ud83d\ude07\ud83c\udf39\ud83e\udd26\ud83c\udf89\ud83d\udc9e\u270c\u2728\ud83e\udd37\ud83d\ude31\ud83d\ude0c\ud83c\udf38\ud83d\ude4c\ud83d\ude0b\ud83d\udc97\ud83d\udc9a\ud83d\ude0f\ud83d\udc9b\ud83d\ude42\ud83d\udc93\ud83e\udd29\ud83d\ude04\ud83d\ude00\ud83d\udda4\ud83d\ude03\ud83d\udcaf\ud83d\ude48\ud83d\udc47\ud83c\udfb6\ud83d\ude12\ud83e\udd2d\u2763\ud83d\ude1c\ud83d\udc8b\ud83d\udc40\ud83d\ude2a\ud83d\ude11\ud83d\udca5\ud83d\ude4b\ud83d\ude1e\ud83d\ude29\ud83d\ude21\ud83e\udd2a\ud83d\udc4a\ud83e\udd73\ud83d\ude25\ud83e\udd24\ud83d\udc49\ud83d\udc83\ud83d\ude33\u270b\ud83d\ude1a\ud83d\ude1d\ud83d\ude34\ud83c\udf1f\ud83d\ude2c\ud83d\ude43\ud83c\udf40\ud83c\udf37\ud83d\ude3b\ud83d\ude13\u2b50\u2705\ud83e\udd7a\ud83c\udf08\ud83d\ude08\ud83e\udd18\ud83d\udca6\u2714\ud83d\ude23\ud83c\udfc3\ud83d\udc90\u2639\ud83c\udf8a\ud83d\udc98\ud83d\ude20\u261d\ud83d\ude15\ud83c\udf3a\ud83c\udf82\ud83c\udf3b\ud83d\ude10\ud83d\udd95\ud83d\udc9d\ud83d\ude4a\ud83d\ude39\ud83d\udde3\ud83d\udcab\ud83d\udc80\ud83d\udc51\ud83c\udfb5\ud83e\udd1e\ud83d\ude1b\ud83d\udd34\ud83d\ude24\ud83c\udf3c\ud83d\ude2b\u26bd\ud83e\udd19\u2615\ud83c\udfc6\ud83e\udd2b\ud83d\udc48\ud83d\ude2e\ud83d\ude46\ud83c\udf7b\ud83c\udf43\ud83d\udc36\ud83d\udc81\ud83d\ude32\ud83c\udf3f\ud83e\udde1\ud83c\udf81\u26a1\ud83c\udf1e\ud83c\udf88\u274c\u270a\ud83d\udc4b\ud83d\ude30\ud83e\udd28\ud83d\ude36\ud83e\udd1d\ud83d\udeb6\ud83d\udcb0\ud83c\udf53\ud83d\udca2\ud83e\udd1f\ud83d\ude41\ud83d\udea8\ud83d\udca8\ud83e\udd2c\u2708\ud83c\udf80\ud83c\udf7a\ud83e\udd13\ud83d\ude19\ud83d\udc9f\ud83c\udf31\ud83d\ude16\ud83d\udc76\ud83e\udd74\u25b6\u27a1\u2753\ud83d\udc8e\ud83d\udcb8\u2b07\ud83d\ude28\ud83c\udf1a\ud83e\udd8b\ud83d\ude37\ud83d\udd7a\u26a0\ud83d\ude45\ud83d\ude1f\ud83d\ude35\ud83d\udc4e\ud83e\udd32\ud83e\udd20\ud83e\udd27\ud83d\udccc\ud83d\udd35\ud83d\udc85\ud83e\uddd0\ud83d\udc3e\ud83c\udf52\ud83d\ude17\ud83e\udd11\ud83c\udf0a\ud83e\udd2f\ud83d\udc37\u260e\ud83d\udca7\ud83d\ude2f\ud83d\udc86\ud83d\udc46\ud83c\udfa4\ud83d\ude47\ud83c\udf51\u2744\ud83c\udf34\ud83d\udca3\ud83d\udc38\ud83d\udc8c\ud83d\udccd\ud83e\udd40\ud83e\udd22\ud83d\udc45\ud83d\udca1\ud83d\udca9\ud83d\udc50\ud83d\udcf8\ud83d\udc7b\ud83e\udd10\ud83e\udd2e\ud83c\udfbc\ud83e\udd75\ud83d\udea9\ud83c\udf4e\ud83c\udf4a\ud83d\udc7c\ud83d\udc8d\ud83d\udce3\ud83e\udd42"),X=J.reduce(((e,t,n)=>(e[n]=t,e)),[]),$=J.reduce(((e,t,n)=>(e[t.codePointAt(0)]=n,e)),[]);const ee=I({prefix:"\ud83d\ude80",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=X[t]),"")},decode:function(e){const t=[];for(const n of e){const e=$[n.codePointAt(0)];if(void 0===e)throw new Error("Non-base256emoji character: ".concat(n));t.push(e)}return new Uint8Array(t)}});var te=function e(t,n,r){n=n||[];var i=r=r||0;for(;t>=ie;)n[r++]=255&t|ne,t/=128;for(;t&re;)n[r++]=255&t|ne,t>>>=7;return n[r]=0|t,e.bytes=r-i+1,n},ne=128,re=-128,ie=Math.pow(2,31);var oe=function e(t,n){var r,i=0,o=0,s=n=n||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");r=t[s++],i+=o<28?(r&ae)<<o:(r&ae)*Math.pow(2,o),o+=7}while(r>=se);return e.bytes=s-n,i},se=128,ae=127;var ce=Math.pow(2,7),le=Math.pow(2,14),ue=Math.pow(2,21),he=Math.pow(2,28),de=Math.pow(2,35),fe=Math.pow(2,42),pe=Math.pow(2,49),ge=Math.pow(2,56),ye=Math.pow(2,63);const me={encode:te,decode:oe,encodingLength:function(e){return e<ce?1:e<le?2:e<ue?3:e<he?4:e<de?5:e<fe?6:e<pe?7:e<ge?8:e<ye?9:10}},ve=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return me.encode(e,t,n),t},be=e=>me.encodingLength(e),we=(e,t)=>{const n=t.byteLength,r=be(e),i=r+be(n),o=new Uint8Array(i+n);return ve(e,o,0),ve(n,o,r),o.set(t,i),new Ee(e,n,t,o)};class Ee{constructor(e,t,n,r){this.code=e,this.size=t,this.digest=n,this.bytes=r}}const Ae=e=>{let{name:t,code:n,encode:r}=e;return new Se(t,n,r)};class Se{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?we(this.code,t):t.then((e=>we(this.code,e)))}throw Error("Unknown type, must be binary type")}}const _e=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Ie=Ae({name:"sha2-256",code:18,encode:_e("SHA-256")}),Ce=Ae({name:"sha2-512",code:19,encode:_e("SHA-512")}),Te=b,ke={code:0,name:"identity",encode:Te,digest:e=>we(0,Te(e))},Re="raw",xe=85,Pe=e=>b(e),De=e=>b(e),Oe=new TextEncoder,Ne=new TextDecoder,Be="json",Le=512,Me=e=>Oe.encode(JSON.stringify(e)),Ue=e=>JSON.parse(Ne.decode(e));Symbol.toStringTag,Symbol.for("nodejs.util.inspect.custom");Symbol.for("@ipld/js-cid/CID");const Fe={...r,...i,...o,...s,...a,...c,...l,...u,...h,...d};var Ke=n(65450);function je(e,t,n,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:r}}}const Ze=je("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),ze=je("ascii","a",(e=>{let t="a";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}),(e=>{e=e.substring(1);const t=(0,Ke.E)(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t})),Ve={utf8:Ze,"utf-8":Ze,hex:Fe.base16,latin1:ze,ascii:ze,binary:ze,...Fe}},69958:(e,t,n)=>{"use strict";n.d(t,{E:()=>o,u:()=>i});var r=n(81472);function i(e=0){return null!=globalThis.Buffer?.alloc?(0,r.P)(globalThis.Buffer.alloc(e)):new Uint8Array(e)}function o(e=0){return null!=globalThis.Buffer?.allocUnsafe?(0,r.P)(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}},71403:(e,t,n)=>{"use strict";n.d(t,{z:()=>o});var r=n(69958),i=n(81472);function o(e,t){if(null!=globalThis.Buffer)return(0,i.P)(globalThis.Buffer.concat(e,t));null==t&&(t=e.reduce(((e,t)=>e+t.length),0));const n=(0,r.E)(t);let o=0;for(const r of e)n.set(r,o),o+=r.length;return(0,i.P)(n)}},1202:(e,t,n)=>{"use strict";function r(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0}n.d(t,{f:()=>r})},80540:(e,t,n)=>{"use strict";n.d(t,{m:()=>o});var r=n(81472),i=n(92728);function o(e,t="utf8"){const n=i.Z[t];if(null==n)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.decoder.decode(`${n.prefix}${e}`):(0,r.P)(globalThis.Buffer.from(e,"utf-8"))}},27929:(e,t,n)=>{"use strict";n.d(t,{BB:()=>s.B,fS:()=>i.f,mL:()=>o.m,zo:()=>r.z});var r=n(71403),i=n(1202),o=n(80540),s=n(18601)},18601:(e,t,n)=>{"use strict";n.d(t,{B:()=>i});var r=n(92728);function i(e,t="utf8"){const n=r.Z[t];if(null==n)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}},81472:(e,t,n)=>{"use strict";function r(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}n.d(t,{P:()=>r})},92728:(e,t,n)=>{"use strict";n.d(t,{Z:()=>Ve});var r={};n.r(r),n.d(r,{base10:()=>k});var i={};n.r(i),n.d(i,{base16:()=>R,base16upper:()=>x});var o={};n.r(o),n.d(o,{base2:()=>P});var s={};n.r(s),n.d(s,{base256emoji:()=>B});var a={};n.r(a),n.d(a,{base32:()=>L,base32hex:()=>K,base32hexpad:()=>Z,base32hexpadupper:()=>z,base32hexupper:()=>j,base32pad:()=>U,base32padupper:()=>F,base32upper:()=>M,base32z:()=>V});var c={};n.r(c),n.d(c,{base36:()=>H,base36upper:()=>q});var l={};n.r(l),n.d(l,{base58btc:()=>G,base58flickr:()=>W});var u={};n.r(u),n.d(u,{base64:()=>Q,base64pad:()=>Y,base64url:()=>J,base64urlpad:()=>X});var h={};n.r(h),n.d(h,{base8:()=>$});var d={};n.r(d),n.d(d,{identity:()=>ee});var f={};n.r(f),n.d(f,{code:()=>ie,decode:()=>se,encode:()=>oe,name:()=>re});var p={};n.r(p),n.d(p,{code:()=>ce,decode:()=>ue,encode:()=>le,name:()=>ae});var g={};n.r(g),n.d(g,{identity:()=>Oe});var y={};n.r(y),n.d(y,{sha256:()=>Me,sha512:()=>Ue});var m=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==n[s])throw new TypeError(o+" is ambiguous");n[s]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var r=0,i=0;e[t]===c;)r++,t++;for(var o=(e.length-t)*l+1>>>0,s=new Uint8Array(o);e[t];){var u=n[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=o-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*s[d]>>>0,s[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=o-i;f!==o&&0===s[f];)f++;for(var p=new Uint8Array(r+(o-f)),g=r;f!==o;)p[g++]=s[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,o=t.length;i!==o&&0===t[i];)i++,n++;for(var s=(o-i)*u+1>>>0,l=new Uint8Array(s);i!==o;){for(var h=t[i],d=0,f=s-1;(0!==h||d<r)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");r=d,i++}for(var p=s-r;p!==s&&0===l[p];)p++;for(var g=c.repeat(n);p<s;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:h,decode:function(e){var n=h(e);if(n)return n;throw new Error(`Non-${t} character`)}}};const v=m,b=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class w{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class E{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return S(this,e)}}class A{constructor(e){this.decoders=e}or(e){return S(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const S=(e,t)=>new A({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class _{constructor(e,t,n,r){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=r,this.encoder=new w(e,t,n),this.decoder=new E(e,t,r)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const I=({name:e,prefix:t,encode:n,decode:r})=>new _(e,t,n,r),C=({prefix:e,name:t,alphabet:n})=>{const{encode:r,decode:i}=v(n,t);return I({prefix:e,name:t,encode:r,decode:e=>b(i(e))})},T=({name:e,prefix:t,bitsPerChar:n,alphabet:r})=>I({prefix:t,name:e,encode:e=>((e,t,n)=>{const r="="===t[t.length-1],i=(1<<n)-1;let o="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>n;)s-=n,o+=t[i&a>>s];if(s&&(o+=t[i&a<<n-s]),r)for(;o.length*n&7;)o+="=";return o})(e,r,n),decode:t=>((e,t,n,r)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*n/8|0);let a=0,c=0,l=0;for(let u=0;u<o;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError(`Non-${r} character`);c=c<<n|t,a+=n,a>=8&&(a-=8,s[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s})(t,r,n,e)}),k=C({prefix:"9",name:"base10",alphabet:"0123456789"}),R=T({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),x=T({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),P=T({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),D=Array.from("\ud83d\ude80\ud83e\ude90\u2604\ud83d\udef0\ud83c\udf0c\ud83c\udf11\ud83c\udf12\ud83c\udf13\ud83c\udf14\ud83c\udf15\ud83c\udf16\ud83c\udf17\ud83c\udf18\ud83c\udf0d\ud83c\udf0f\ud83c\udf0e\ud83d\udc09\u2600\ud83d\udcbb\ud83d\udda5\ud83d\udcbe\ud83d\udcbf\ud83d\ude02\u2764\ud83d\ude0d\ud83e\udd23\ud83d\ude0a\ud83d\ude4f\ud83d\udc95\ud83d\ude2d\ud83d\ude18\ud83d\udc4d\ud83d\ude05\ud83d\udc4f\ud83d\ude01\ud83d\udd25\ud83e\udd70\ud83d\udc94\ud83d\udc96\ud83d\udc99\ud83d\ude22\ud83e\udd14\ud83d\ude06\ud83d\ude44\ud83d\udcaa\ud83d\ude09\u263a\ud83d\udc4c\ud83e\udd17\ud83d\udc9c\ud83d\ude14\ud83d\ude0e\ud83d\ude07\ud83c\udf39\ud83e\udd26\ud83c\udf89\ud83d\udc9e\u270c\u2728\ud83e\udd37\ud83d\ude31\ud83d\ude0c\ud83c\udf38\ud83d\ude4c\ud83d\ude0b\ud83d\udc97\ud83d\udc9a\ud83d\ude0f\ud83d\udc9b\ud83d\ude42\ud83d\udc93\ud83e\udd29\ud83d\ude04\ud83d\ude00\ud83d\udda4\ud83d\ude03\ud83d\udcaf\ud83d\ude48\ud83d\udc47\ud83c\udfb6\ud83d\ude12\ud83e\udd2d\u2763\ud83d\ude1c\ud83d\udc8b\ud83d\udc40\ud83d\ude2a\ud83d\ude11\ud83d\udca5\ud83d\ude4b\ud83d\ude1e\ud83d\ude29\ud83d\ude21\ud83e\udd2a\ud83d\udc4a\ud83e\udd73\ud83d\ude25\ud83e\udd24\ud83d\udc49\ud83d\udc83\ud83d\ude33\u270b\ud83d\ude1a\ud83d\ude1d\ud83d\ude34\ud83c\udf1f\ud83d\ude2c\ud83d\ude43\ud83c\udf40\ud83c\udf37\ud83d\ude3b\ud83d\ude13\u2b50\u2705\ud83e\udd7a\ud83c\udf08\ud83d\ude08\ud83e\udd18\ud83d\udca6\u2714\ud83d\ude23\ud83c\udfc3\ud83d\udc90\u2639\ud83c\udf8a\ud83d\udc98\ud83d\ude20\u261d\ud83d\ude15\ud83c\udf3a\ud83c\udf82\ud83c\udf3b\ud83d\ude10\ud83d\udd95\ud83d\udc9d\ud83d\ude4a\ud83d\ude39\ud83d\udde3\ud83d\udcab\ud83d\udc80\ud83d\udc51\ud83c\udfb5\ud83e\udd1e\ud83d\ude1b\ud83d\udd34\ud83d\ude24\ud83c\udf3c\ud83d\ude2b\u26bd\ud83e\udd19\u2615\ud83c\udfc6\ud83e\udd2b\ud83d\udc48\ud83d\ude2e\ud83d\ude46\ud83c\udf7b\ud83c\udf43\ud83d\udc36\ud83d\udc81\ud83d\ude32\ud83c\udf3f\ud83e\udde1\ud83c\udf81\u26a1\ud83c\udf1e\ud83c\udf88\u274c\u270a\ud83d\udc4b\ud83d\ude30\ud83e\udd28\ud83d\ude36\ud83e\udd1d\ud83d\udeb6\ud83d\udcb0\ud83c\udf53\ud83d\udca2\ud83e\udd1f\ud83d\ude41\ud83d\udea8\ud83d\udca8\ud83e\udd2c\u2708\ud83c\udf80\ud83c\udf7a\ud83e\udd13\ud83d\ude19\ud83d\udc9f\ud83c\udf31\ud83d\ude16\ud83d\udc76\ud83e\udd74\u25b6\u27a1\u2753\ud83d\udc8e\ud83d\udcb8\u2b07\ud83d\ude28\ud83c\udf1a\ud83e\udd8b\ud83d\ude37\ud83d\udd7a\u26a0\ud83d\ude45\ud83d\ude1f\ud83d\ude35\ud83d\udc4e\ud83e\udd32\ud83e\udd20\ud83e\udd27\ud83d\udccc\ud83d\udd35\ud83d\udc85\ud83e\uddd0\ud83d\udc3e\ud83c\udf52\ud83d\ude17\ud83e\udd11\ud83c\udf0a\ud83e\udd2f\ud83d\udc37\u260e\ud83d\udca7\ud83d\ude2f\ud83d\udc86\ud83d\udc46\ud83c\udfa4\ud83d\ude47\ud83c\udf51\u2744\ud83c\udf34\ud83d\udca3\ud83d\udc38\ud83d\udc8c\ud83d\udccd\ud83e\udd40\ud83e\udd22\ud83d\udc45\ud83d\udca1\ud83d\udca9\ud83d\udc50\ud83d\udcf8\ud83d\udc7b\ud83e\udd10\ud83e\udd2e\ud83c\udfbc\ud83e\udd75\ud83d\udea9\ud83c\udf4e\ud83c\udf4a\ud83d\udc7c\ud83d\udc8d\ud83d\udce3\ud83e\udd42"),O=D.reduce(((e,t,n)=>(e[n]=t,e)),[]),N=D.reduce(((e,t,n)=>(e[t.codePointAt(0)]=n,e)),[]);const B=I({prefix:"\ud83d\ude80",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=O[t]),"")},decode:function(e){const t=[];for(const n of e){const e=N[n.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${n}`);t.push(e)}return new Uint8Array(t)}}),L=T({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),M=T({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),U=T({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),F=T({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),K=T({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),j=T({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Z=T({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),z=T({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),V=T({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),H=C({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),q=C({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),G=C({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),W=C({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Q=T({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Y=T({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),J=T({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),X=T({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),$=T({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),ee=I({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),te=new TextEncoder,ne=new TextDecoder,re="json",ie=512,oe=e=>te.encode(JSON.stringify(e)),se=e=>JSON.parse(ne.decode(e)),ae="raw",ce=85,le=e=>b(e),ue=e=>b(e);var he=function e(t,n,r){n=n||[];var i=r=r||0;for(;t>=pe;)n[r++]=255&t|de,t/=128;for(;t&fe;)n[r++]=255&t|de,t>>>=7;return n[r]=0|t,e.bytes=r-i+1,n},de=128,fe=-128,pe=Math.pow(2,31);var ge=function e(t,n){var r,i=0,o=0,s=n=n||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");r=t[s++],i+=o<28?(r&me)<<o:(r&me)*Math.pow(2,o),o+=7}while(r>=ye);return e.bytes=s-n,i},ye=128,me=127;var ve=Math.pow(2,7),be=Math.pow(2,14),we=Math.pow(2,21),Ee=Math.pow(2,28),Ae=Math.pow(2,35),Se=Math.pow(2,42),_e=Math.pow(2,49),Ie=Math.pow(2,56),Ce=Math.pow(2,63);const Te={encode:he,decode:ge,encodingLength:function(e){return e<ve?1:e<be?2:e<we?3:e<Ee?4:e<Ae?5:e<Se?6:e<_e?7:e<Ie?8:e<Ce?9:10}},ke=(e,t,n=0)=>(Te.encode(e,t,n),t),Re=e=>Te.encodingLength(e),xe=(e,t)=>{const n=t.byteLength,r=Re(e),i=r+Re(n),o=new Uint8Array(i+n);return ke(e,o,0),ke(n,o,r),o.set(t,i),new Pe(e,n,t,o)};class Pe{constructor(e,t,n,r){this.code=e,this.size=t,this.digest=n,this.bytes=r}}const De=b,Oe={code:0,name:"identity",encode:De,digest:e=>xe(0,De(e))},Ne=({name:e,code:t,encode:n})=>new Be(e,t,n);class Be{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?xe(this.code,t):t.then((e=>xe(this.code,e)))}throw Error("Unknown type, must be binary type")}}const Le=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Me=Ne({name:"sha2-256",code:18,encode:Le("SHA-256")}),Ue=Ne({name:"sha2-512",code:19,encode:Le("SHA-512")});new WeakMap;Symbol.toStringTag,Symbol.for("nodejs.util.inspect.custom");Symbol.for("@ipld/js-cid/CID");const Fe={...d,...o,...h,...r,...i,...a,...c,...l,...u,...s};var Ke=n(69958);function je(e,t,n,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:r}}}const Ze=je("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),ze=je("ascii","a",(e=>{let t="a";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}),(e=>{e=e.substring(1);const t=(0,Ke.E)(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t})),Ve={utf8:Ze,"utf-8":Ze,hex:Fe.base16,latin1:ze,ascii:ze,binary:ze,...Fe}},62678:()=>{},25819:()=>{},81265:()=>{},35539:()=>{},90721:e=>{"use strict";e.exports=JSON.parse('{"colors":{"navy":"#0b3a53","navy-muted":"#244e66","aqua":"#69c4cd","aqua-muted":"#9ad4db","gray":"#b7bbc8","gray-muted":"#d9dbe2","charcoal":"#34373f","charcoal-muted":"#7f8491","red":"#ea5037","red-muted":"#f36149","yellow":"#f39021","yellow-muted":"#f9a13e","teal":"#378085","teal-muted":"#439a9d","green":"#0cb892","green-muted":"#0aca9f","snow":"#edf0f4","snow-muted":"#f7f8fa","link":"#117eb3","washed-blue":"#F0F6FA"}}')},4147:e=>{"use strict";e.exports=JSON.parse('{"version":"4.2.1","dependencies":{"@loadable/component":"^5.14.1","@multiformats/multiaddr":"^12.1.14","@multiformats/multiaddr-to-uri":"^9.0.7","@tableflip/react-dropdown":"^1.3.0","brace":"^0.11.1","change-case":"^3.1.0","chart.js":"^2.9.4","classnames":"^2.3.1","countly-sdk-web":"^19.8.0","d3":"^5.16.0","datatransfer-files-promise":"^1.3.1","details-polyfill":"^1.1.0","file-extension":"^4.0.5","filesize":"^6.3.0","hashlru":"^2.3.0","i18next":"^21.6.10","i18next-browser-languagedetector":"^6.1.3","i18next-chained-backend":"^3.0.2","i18next-http-backend":"^1.3.2","i18next-icu":"2.0.3","i18next-localstorage-backend":"^3.1.3","iltorb":"^2.4.5","internal-nav-helper":"^3.1.0","intl-messageformat":"9.12.0","ip":"^1.1.9","ipfs-css":"^1.4.0","ipfs-geoip":"^9.1.0","ipfs-provider":"^2.1.0","ipld-explorer-components":"^5.2.0","is-ipfs":"^8.0.1","istextorbinary":"^6.0.0","it-all":"^1.0.5","it-first":"^1.0.6","it-last":"^1.0.5","it-map":"^1.0.5","kubo-rpc-client":"^3.0.2","milliseconds":"^1.0.3","money-clip":"^3.0.5","multiformats":"^13.0.1","p-memoize":"^4.0.0","p-queue":"^7.3.0","prop-types":"^15.7.2","react":"^16.14.0","react-ace":"^8.1.0","react-chartjs-2":"^2.10.0","react-copy-to-clipboard":"^5.0.2","react-country-flag":"^1.1.0","react-debounce-render":"^5.0.0","react-dnd":"^11.1.3","react-dnd-html5-backend":"^11.1.3","react-dom":"^16.14.0","react-faux-dom":"^4.5.0","react-helmet":"^5.2.1","react-hook-form":"^6.0.6","react-i18next":"^12.3.1","react-identicons":"^1.2.4","react-joyride":"^2.3.0","react-overlays":"^2.1.1","react-scripts":"5.0.1","react-virtualized":"^9.22.3","redux-bundler":"^26.1.0","redux-bundler-react":"^1.2.0","tachyons":"^4.12.0","topojson-client":"^3.1.0","window-or-global":"^1.0.1"}}')},73788:e=>{"use strict";e.exports=JSON.parse('{"ar":{"locale":"ar","nativeName":"\u0627\u0644\u0639\u0631\u0628\u064a\u0629","englishName":"Arabic"},"ca":{"locale":"ca","nativeName":"Catal\xe0","englishName":"Catalan"},"cs":{"locale":"cs","nativeName":"\u010ce\u0161tina","englishName":"Czech"},"da":{"locale":"da","nativeName":"Dansk","englishName":"Danish"},"de":{"locale":"de","nativeName":"Deutsch","englishName":"German"},"en":{"locale":"en","nativeName":"English","englishName":"English"},"es":{"locale":"es","nativeName":"Espa\xf1ol","englishName":"Spanish"},"fi":{"locale":"fi","nativeName":"Suomi","englishName":"Finnish"},"fr":{"locale":"fr","nativeName":"Fran\xe7ais","englishName":"French"},"hi-IN":{"locale":"hi-IN","nativeName":"\u0939\u093f\u0928\u094d\u0926\u0940","englishName":"Hindi"},"hu":{"locale":"hu","nativeName":"Magyar","englishName":"Hungarian"},"id":{"locale":"id","nativeName":"Bahasa Indonesia","englishName":"Indonesian"},"it":{"locale":"it","nativeName":"Italiano","englishName":"Italian"},"ja-JP":{"locale":"ja-JP","nativeName":"\u65e5\u672c\u8a9e","englishName":"Japanese"},"ko-KR":{"locale":"ko-KR","nativeName":"\ud55c\uad6d\uc5b4 (\u97e9\u56fd)","englishName":"Korean (Korea)"},"nl":{"locale":"nl","nativeName":"Nederlands","englishName":"Dutch"},"no":{"locale":"no","nativeName":"Norsk","englishName":"Norwegian"},"pl":{"locale":"pl","nativeName":"Polski","englishName":"Polish"},"pt":{"locale":"pt","nativeName":"Portugu\xeas","englishName":"Portuguese"},"pt-BR":{"locale":"pt-BR","nativeName":"Portugu\xeas (Brasil)","englishName":"Portuguese (Brazil)"},"ro":{"locale":"ro","nativeName":"Rom\xe2n\u0103","englishName":"Romanian"},"ru":{"locale":"ru","nativeName":"\u0420\u0443\u0441\u0441\u043a\u0438\u0439","englishName":"Russian"},"sk":{"locale":"sk","nativeName":"Sloven\u010dina","englishName":"Slovak"},"sv":{"locale":"sv","nativeName":"Svenska","englishName":"Swedish"},"tr":{"locale":"tr","nativeName":"T\xfcrk\xe7e","englishName":"Turkish"},"uk":{"locale":"uk","nativeName":"\u0423\u043a\u0440\u0430\u0457\u043d\u0441\u044c\u043a\u0430","englishName":"Ukrainian"},"ur":{"locale":"ur","nativeName":"\u0627\u0631\u062f\u0648","englishName":"Urdu"},"zh-CN":{"locale":"zh-CN","nativeName":"\u4e2d\u6587\uff08\u4e2d\u56fd\uff09","englishName":"Chinese Simplified (China)"},"zh-HK":{"locale":"zh-HK","nativeName":"\u4e2d\u6587\uff08\u9999\u6e2f\uff09","englishName":"Chinese Traditional (Hong Kong)"},"zh-TW":{"locale":"zh-TW","nativeName":"\u4e2d\u6587\uff08\u53f0\u7063\uff09","englishName":"Chinese Traditional (Taiwan)"}}')}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e].call(n.exports,n,n.exports,__webpack_require__),n.loaded=!0,n.exports}__webpack_require__.m=__webpack_modules__,__webpack_require__.amdD=function(){throw new Error("define cannot be used indirect")},__webpack_require__.amdO={},__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;__webpack_require__.t=function(n,r){if(1&r&&(n=this(n)),8&r)return n;if("object"===typeof n&&n){if(4&r&&n.__esModule)return n;if(16&r&&"function"===typeof n.then)return n}var i=Object.create(null);__webpack_require__.r(i);var o={};e=e||[null,t({}),t([]),t(t)];for(var s=2&r&&n;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((e=>o[e]=()=>n[e]));return o.default=()=>n,__webpack_require__.d(i,o),i}})(),__webpack_require__.d=(e,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.f={},__webpack_require__.e=e=>Promise.all(Object.keys(__webpack_require__.f).reduce(((t,n)=>(__webpack_require__.f[n](e,t),t)),[])),__webpack_require__.u=e=>"static/js/"+e+"."+{3:"37f65297",37:"02d00593",40:"4f526f9a",104:"d628318d",174:"dbd298a0",178:"3a31ebff",257:"da5706c5",259:"568c4dcd",301:"a1deaa10",353:"14679d6f",424:"b369bfa6",433:"cb128a66",480:"36fa1d6c",529:"dd6ccd50",539:"27ce2161",588:"68496158",654:"034d02e2",706:"d5ee7435",739:"23505ca5",835:"05c1f0d9",942:"e8a01e2e",960:"39e7b782",965:"35340751"}[e]+".chunk.js",__webpack_require__.miniCssF=e=>"static/css/"+e+"."+{301:"e555fe27",588:"34e9d0f2",835:"6caf85c6",965:"2d0ccef5"}[e]+".chunk.css",__webpack_require__.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),__webpack_require__.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="ipfs-webui:";__webpack_require__.l=(n,r,i,o)=>{if(e[n])e[n].push(r);else{var s,a;if(void 0!==i)for(var c=document.getElementsByTagName("script"),l=0;l<c.length;l++){var u=c[l];if(u.getAttribute("src")==n||u.getAttribute("data-webpack")==t+i){s=u;break}}s||(a=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,__webpack_require__.nc&&s.setAttribute("nonce",__webpack_require__.nc),s.setAttribute("data-webpack",t+i),s.src=n),e[n]=[r];var h=(t,r)=>{s.onerror=s.onload=null,clearTimeout(d);var i=e[n];if(delete e[n],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach((e=>e(r))),t)return t(r)},d=setTimeout(h.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=h.bind(null,s.onerror),s.onload=h.bind(null,s.onload),a&&document.head.appendChild(s)}}})(),__webpack_require__.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),__webpack_require__.p="./",(()=>{if("undefined"!==typeof document){var e=e=>new Promise(((t,n)=>{var r=__webpack_require__.miniCssF(e),i=__webpack_require__.p+r;if(((e,t)=>{for(var n=document.getElementsByTagName("link"),r=0;r<n.length;r++){var i=(s=n[r]).getAttribute("data-href")||s.getAttribute("href");if("stylesheet"===s.rel&&(i===e||i===t))return s}var o=document.getElementsByTagName("style");for(r=0;r<o.length;r++){var s;if((i=(s=o[r]).getAttribute("data-href"))===e||i===t)return s}})(r,i))return t();((e,t,n,r,i)=>{var o=document.createElement("link");o.rel="stylesheet",o.type="text/css",o.onerror=o.onload=n=>{if(o.onerror=o.onload=null,"load"===n.type)r();else{var s=n&&("load"===n.type?"missing":n.type),a=n&&n.target&&n.target.href||t,c=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");c.code="CSS_CHUNK_LOAD_FAILED",c.type=s,c.request=a,o.parentNode&&o.parentNode.removeChild(o),i(c)}},o.href=t,n?n.parentNode.insertBefore(o,n.nextSibling):document.head.appendChild(o)})(e,i,null,t,n)})),t={179:0};__webpack_require__.f.miniCss=(n,r)=>{t[n]?r.push(t[n]):0!==t[n]&&{301:1,588:1,835:1,965:1}[n]&&r.push(t[n]=e(n).then((()=>{t[n]=0}),(e=>{throw delete t[n],e})))}}})(),(()=>{var e={179:0};__webpack_require__.f.j=(t,n)=>{var r=__webpack_require__.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var i=new Promise(((n,i)=>r=e[t]=[n,i]));n.push(r[2]=i);var o=__webpack_require__.p+__webpack_require__.u(t),s=new Error;__webpack_require__.l(o,(n=>{if(__webpack_require__.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var i=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;s.message="Loading chunk "+t+" failed.\n("+i+": "+o+")",s.name="ChunkLoadError",s.type=i,s.request=o,r[1](s)}}),"chunk-"+t,t)}};var t=(t,n)=>{var r,i,o=n[0],s=n[1],a=n[2],c=0;if(o.some((t=>0!==e[t]))){for(r in s)__webpack_require__.o(s,r)&&(__webpack_require__.m[r]=s[r]);if(a)a(__webpack_require__)}for(t&&t(n);c<o.length;c++)i=o[c],__webpack_require__.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self.webpackChunkipfs_webui=self.webpackChunkipfs_webui||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var __webpack_exports__={};(()=>{"use strict";var e=__webpack_require__(72791),t=__webpack_require__(54164),n=__webpack_require__(218),r=__webpack_require__(52007),i=__webpack_require__.n(r),o=function(e){return e?"A"===e.tagName?e:o(e.parentElement):null},s=function(e){return function(t){if(0===t.button&&!t.ctrlKey&&!t.shiftKey&&!t.altKey&&!t.metaKey){var n=o(t.target);if(n&&"_blank"!==n.target&&"_external"!==n.target&&"external"!==n.rel&&!n.hasAttribute("download")){var r=-1!==(i=n).href.indexOf(location.protocol+"//"+location.host)?i.href.split(location.host,2)[1]:null;r&&(t.preventDefault(),e(r))}}var i}},a=__webpack_require__(14964),c=__webpack_require__(87945),l=__webpack_require__(83383),u=__webpack_require__(77208),h=__webpack_require__(12743),d=__webpack_require__(64746),f=__webpack_require__(70814),p=__webpack_require__(81694),g=__webpack_require__.n(p);const y=__webpack_require__.p+"static/media/ipfs-logo-text-vert.6fc9edd5f753fba1c9f20b667e26d29d.svg";const m=__webpack_require__.p+"static/media/ipfs-logo-text-horiz.2c5486c412b66a8fad882021ae564641.svg";function v(){return v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},v.apply(this,arguments)}const b=function(t){return e.createElement("svg",v({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 100"},t),e.createElement("path",{d:"M76.595 19.785h-52.93a3.93 3.93 0 00-3.92 3.92v39.12a5.74 5.74 0 005.73 5.73h23.79v6.25h-9.67a4 4 0 00-4 4 3.59 3.59 0 00.08.81l.12.6h28.49l.13-.6a4.28 4.28 0 00.08-.81 4 4 0 00-4-4h-9.73v-6.25h25.83a3.67 3.67 0 003.66-3.67v-41.44a3.67 3.67 0 00-3.66-3.66zm-13.61 58.94h-25.95a2.52 2.52 0 012.56-2.42h20.88a2.51 2.51 0 012.51 2.42zm-39.32-55.94h52.93a.66.66 0 01.66.66v5.56h-54.51v-5.3a.92.92 0 01.92-.92zm52.93 42.77h-51.12a2.73 2.73 0 01-2.73-2.73v-32.29h54.53v34.35a.67.67 0 01-.68.67z"}),e.createElement("path",{d:"M68.315 35.735a3.61 3.61 0 00-3.61 3.61 3.58 3.58 0 00.74 2.17l-9.77 10.38a3.5 3.5 0 00-4.13.46l-7.4-5a3.61 3.61 0 10-6.9-1.48 3.58 3.58 0 00.41 1.63l-.06-.05-4.54 5.55a3.57 3.57 0 00-1.35-.27 3.62 3.62 0 102.6 1.11l4.29-5.21a3.53 3.53 0 002.3.86 3.62 3.62 0 002.39-.92l7.41 5a3.52 3.52 0 00-.37 1.43 3.635 3.635 0 107.27 0 3.57 3.57 0 00-.74-2.16l9.74-10.35a3.49 3.49 0 001.73.46 3.61 3.61 0 000-7.22zm-36.61 22.72a2.11 2.11 0 112.11-2.11 2.12 2.12 0 01-2.11 2.11zm9.15-10.45a2.11 2.11 0 112.11-2.11 2.12 2.12 0 01-2.11 2.11zm13.08 9.15a2.11 2.11 0 112.11-2.15 2.11 2.11 0 01-2.11 2.14zm14.38-15.7a2.11 2.11 0 112.11-2.11 2.11 2.11 0 01-2.11 2.11z"}))};function w(){return w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},w.apply(this,arguments)}const E=function(t){return e.createElement("svg",w({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 100"},t),e.createElement("path",{d:"M36 33.4h14.21a1 1 0 000-2H36a1 1 0 000 2zm0 8.84h14.21a1 1 0 000-2H36a1 1 0 000 2zm30.08 7.57a1.07 1.07 0 00-.07-.19.64.64 0 010-.07l-.08-.08-.14-.15-.15-.1-.18-.08h-.2a.35.35 0 00-.11 0H36a1 1 0 00-1 1v17.68a.71.71 0 000 .2.64.64 0 00.06.18.36.36 0 010 .07.65.65 0 00.13.16 1.26 1.26 0 00.28.19h.08a1 1 0 00.34.07h29.24a1 1 0 001-1V50a1.62 1.62 0 00-.05-.19zm-4.52 1.26L37 66V51.07zm-22 15.68l24.52-14.9v14.9z"}),e.createElement("path",{d:"M75.13 37.17v-.05L56.55 17.8H30a5.51 5.51 0 00-5.5 5.5v53.4a5.51 5.51 0 005.5 5.5h40a5.51 5.51 0 005.5-5.5V37.51zM56.91 22.51l14 14.61h-7.08c-4 0-6.92-2.53-6.92-6zM70 79.2H30a2.5 2.5 0 01-2.5-2.5V23.3a2.5 2.5 0 012.5-2.5h24.91v10.31c0 4.64 3.75 8 8.92 8h8.63V76.7A2.5 2.5 0 0170 79.2z"}))};var A=__webpack_require__(17098);function S(){return S=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},S.apply(this,arguments)}const _=function(t){return e.createElement("svg",S({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 100"},t),e.createElement("path",{d:"M50.077 42.884h-.09a7.14 7.14 0 00-5 2.06 7.07 7.07 0 00-2.11 5 7.16 7.16 0 007.11 7.21 7.14 7.14 0 00.09-14.27zm-.09 11.67a4.57 4.57 0 01-4.54-4.54 4.46 4.46 0 011.34-3.19 4.54 4.54 0 013.2-1.34 4.53 4.53 0 014.48 4.67 4.54 4.54 0 01-4.48 4.4z"}),e.createElement("path",{d:"M83.697 56.764c-3.29-1.27-4.93-3.4-5-6.51-.07-3.29 1.56-5.53 5-6.86a1.3 1.3 0 00.82-1.38c-.25-2.51-3-9-4.45-10.72a1.3 1.3 0 00-1.53-.28c-3.25 1.52-6 1.15-8.27-1.14-2.27-2.29-2.71-5-1.17-8.39a1.29 1.29 0 00-.5-1.65 34.72 34.72 0 00-10.42-4.29 1.29 1.29 0 00-1.52.84c-1.11 3.22-3.1 4.9-6.1 5.12-3.57.27-6-1.41-7.36-5.11a1.31 1.31 0 00-1.53-.82 35.49 35.49 0 00-10.38 4.37 1.3 1.3 0 00-.48 1.66c1.56 3.28 1.21 6-1.07 8.32-2.28 2.32-5.05 2.74-8.38 1.21a1.31 1.31 0 00-1.66.5 35.31 35.31 0 00-4.23 10.38 1.31 1.31 0 00.82 1.51c3.34 1.23 5 3.35 5.07 6.51.07 3.16-1.55 5.53-5 6.86a1.3 1.3 0 00-.79 1.52 34.69 34.69 0 004.42 10.34 1.29 1.29 0 001.63.5c3.23-1.44 5.9-1.06 8.16 1.14s2.75 5 1.32 8.23a1.3 1.3 0 00.52 1.63 35.46 35.46 0 0010.37 4.23 1.15 1.15 0 00.26 0 1.44 1.44 0 001.23-.79 2.43 2.43 0 00.14-.28 6.89 6.89 0 0113-.17 1.7 1.7 0 002.16 1.06 35.78 35.78 0 009.44-3.9l.36-.24.11-.08a1.29 1.29 0 00.47-1.61c-1.32-3-1.06-5.51.8-7.68 2.29-2.66 5.12-3.22 8.67-1.71a1.29 1.29 0 001.61-.51 34.87 34.87 0 004.3-10.33 1.29 1.29 0 00-.84-1.48zm-5.16 9.55a9.16 9.16 0 00-10.55 2.82 9.05 9.05 0 00-1.62 9.36 33 33 0 01-7.63 3.16 9.36 9.36 0 00-8.75-5.5h-.14a9.5 9.5 0 00-8.38 5.54 32.24 32.24 0 01-7.63-3.12 9.06 9.06 0 00-2.32-10 9.11 9.11 0 00-10-2.08 32.48 32.48 0 01-3.2-7.57 9.1 9.1 0 005.67-8.91 9.08 9.08 0 00-5.69-8.44 32.5 32.5 0 013.09-7.62 9.08 9.08 0 0010.23-2.2 9 9 0 002-10.17 32.73 32.73 0 017.6-3.18 9.12 9.12 0 009.53 5.71 9 9 0 007.93-5.75 32.76 32.76 0 017.61 3.14 9.09 9.09 0 002.15 10.24 9.08 9.08 0 0010.19 2.07 37.24 37.24 0 013.13 7.6 9.49 9.49 0 00-.06 17.33 32.18 32.18 0 01-3.16 7.57z"}),e.createElement("path",{d:"M49.987 32.934a17.09 17.09 0 1017.08 17.08 17.1 17.1 0 00-17.08-17.08zm0 32.67a15.59 15.59 0 1115.58-15.59 15.61 15.61 0 01-15.58 15.59z"}))};var I=__webpack_require__(62472);const C=t=>{let{to:n,icon:r,alternative:i,disabled:o,children:s}=t;const a=r,{hash:c}=window.location,l="#".concat(n),u=i?c===l||c.startsWith("".concat(l).concat(i)):c&&c.startsWith(l),h=g()({"bg-white-10 navbar-item-active":u,"o-50 no-pointer-events":o},["navbar-item dib db-l pt2 pb3 pv1-l white no-underline f5 hover-bg-white-10 tc bb bw2 bw0-l b--navy"]),d=g()({"o-100":u,"o-50":!u},["fill-current-color"]);return e.createElement("a",{href:o?null:l,className:h,role:"menuitem",title:s},e.createElement("div",{className:"db ph2 pv1"},e.createElement("div",{className:"db"},e.createElement(a,{width:"46",role:"presentation",className:d})),e.createElement("div",{className:"".concat(u?"o-100":"o-50"," db f6 tc montserrat ttu fw1 "),style:{whiteSpace:"pre-wrap"}},s)))},T=(0,n.$)((0,c.Zh)()((t=>{let{t:n}=t;const r="https://github.com/ipfs/ipfs-webui",i="".concat(r,"/issues"),o="9c10520",s="".concat(r,"/commit/").concat(o);return e.createElement("div",{className:"h-100 fixed-l flex flex-column justify-between",style:{overflowY:"auto",width:"inherit"}},e.createElement("div",{className:"flex flex-column"},e.createElement("a",{href:"#/welcome",role:"menuitem",title:n("welcome:description")},e.createElement("div",{className:"pt3 pb1 pb2-l"},e.createElement("img",{className:"navbar-logo-vert center db-l dn pt3 pb1",style:{height:94},src:y,alt:""}),e.createElement("img",{className:"navbar-logo-horiz center db dn-l",style:{height:70},src:m,alt:""}))),e.createElement("div",{className:"db overflow-x-scroll overflow-x-hidden-l nowrap tc",role:"menubar"},e.createElement(C,{to:"/",alternative:"status",icon:b},n("status:title")),e.createElement(C,{to:"/files",icon:E},n("files:title")),e.createElement(C,{to:"/explore",icon:I.Z},n("explore:tabName")),e.createElement(C,{to:"/peers",icon:A.Z},n("peers:title")),e.createElement(C,{to:"/settings",icon:_},n("settings:title")))),e.createElement("div",{className:"dn db-l navbar-footer mb2 tc center f7 o-80 glow"},o&&e.createElement("div",{className:"mb1"},e.createElement("a",{className:"link white",href:s,target:"_blank",rel:"noopener noreferrer"},n("app:terms.revision")," ",o)),e.createElement("div",{className:"mb1"},e.createElement("a",{className:"link white",href:r,target:"_blank",rel:"noopener noreferrer"},n("app:nav.codeLink"))),e.createElement("div",null,e.createElement("a",{className:"link white",href:i,target:"_blank",rel:"noopener noreferrer"},n("app:nav.bugsLink")))))})));var k=__webpack_require__(11848),R=__webpack_require__(83072);const x=t=>{let{error:n,children:r,onDismiss:i}=t;const o=n?"bg-yellow":"bg-green";return e.createElement("div",{className:"fixed bottom-0 tc pb2 z-max",style:{left:"50% ",transform:"translateX(-50%)"}},e.createElement("div",{className:"flex items-center f5 lh-copy avenir pl2 pl4-ns pv2 white br2 ".concat(o)},r,e.createElement(R.Z,{className:"fill-current-color ph3 glow o-80 pointer",style:{height:"28px",transform:"scale(1.5)"},onClick:i})))},P=(0,n.$)("selectNotify","selectNotifyI18nKey","doNotifyDismiss",(0,c.Zh)("notify")((t=>{let{t:n,notify:r,notifyI18nKey:i,doNotifyDismiss:o}=t;const{show:s,error:a,msgArgs:c}=r;return s?e.createElement(x,{error:a,onDismiss:o},n(i,c)):null}))),D=(0,n.$)("selectIpfsReady","selectIpfsConnected","doSetIsNodeInfoOpen",(0,c.Zh)("notify")((t=>{let{t:n,className:r,size:i=28,ipfsReady:o,ipfsConnected:s,doSetIsNodeInfoOpen:a}=t;const c=n(((e,t)=>e&&t?"app:status.connectedToIpfs":e?"ipfsApiRequestFailed":"app:status.connectingToIpfs")(o,s)),l=((e,t)=>e&&t?"teal":e?"red":"gray")(o,s),u=s?"o-60":"o-100";return e.createElement("a",{title:c,className:"dib ".concat(r),href:"#/status",onClick:()=>a(!0)},e.createElement("svg",{className:"".concat(l," ").concat(u," fill-current-color transition-all glow"),viewBox:"0 0 24 24",width:i,height:i,"aria-hidden":"true"},e.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zM6.5 9L10 5.5 13.5 9H11v4H9V9H6.5zm11 6L14 18.5 10.5 15H13v-4h2v4h2.5z "})))}))),O=(0,n.$)("doEnableTours",(0,c.Zh)("app")((t=>{let{doEnableTours:n,className:r="",size:i=23,t:o}=t;return e.createElement("button",{className:"dib mr1 ml4-m pointer ".concat(r),onClick:()=>{n()},"aria-label":o("startTourHelper")},e.createElement("svg",{className:"fill-teal o-60 glow",viewBox:"0 0 44 44",width:i,height:i,"aria-hidden":"true"},e.createElement("path",{d:"m22,0c-12.2,0-22,9.8-22,22s9.8,22 22,22 22-9.8 22-22-9.8-22-22-22zm2,34c0,0.6-0.4,1-1,1h-2c-0.6,0-1-0.4-1-1v-2c0-0.6 0.4-1 1-1h2c0.6,0 1,0.4 1,1v2zm2.7-8.9c-1.4,1.2-2.4,2-2.7,3.1-0.1,0.5-0.5,0.8-1,0.8h-2c-0.6,0-1.1-0.5-1-1.1 0.4-2.9 2.5-4.5 4.2-5.9 1.8-1.4 2.8-2.3 2.8-4 0-2.8-2.2-5-5-5s-5,2.2-5,5c0,0.2 0,0.4 0,0.6 0.1,0.5-0.2,1-0.7,1.1l-1.9,.6c-0.6,0.2-1.2-0.2-1.3-0.8-0.1-0.5-0.1-1-0.1-1.5 0-5 4-9 9-9s9,4 9,9c0,3.7-2.4,5.6-4.3,7.1z"})))})));var N=__webpack_require__(7341),B=__webpack_require__(73741),L=__webpack_require__(53350);class M extends e.Component{constructor(e){super(e),this.state={path:"",hideExplore:!1},this.onChange=this.onChange.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.onBrowse=this.onBrowse.bind(this),this.onInspect=this.onInspect.bind(this)}onKeyDown(e){"Enter"===e.key&&this.onBrowse(e)}onBrowse(e){if(e.preventDefault(),this.isValid){let e=this.path;N.rb(e)&&(e="/ipfs/".concat(e)),this.props.onBrowse({path:e}),this.setState({path:""})}}onInspect(e){e.preventDefault(),this.isValid&&(this.props.onInspect(this.path),this.setState({path:""}))}onChange(e){const t=e.target.value;this.setState({path:t})}get path(){return this.state.path.trim()}get isValid(){return""!==this.path&&(N.rb(this.path)||N.ET(this.path))}get inputClass(){return""===this.path?"focus-outline":this.isValid?"b--green-muted focus-outline-green":"b--red-muted focus-outline-red"}render(){const{t:t}=this.props;return e.createElement("div",{"data-id":"FilesExploreForm",className:"sans-serif black-80 flex"},e.createElement("div",{className:"flex-auto"},e.createElement("div",{className:"relative"},e.createElement("input",{id:"ipfs-path",className:"input-reset bn pa2 mb2 db w-100 f6 br-0 placeholder-light ".concat(this.inputClass),style:{borderRadius:"3px 0 0 3px"},type:"text",placeholder:"QmHash/bafyHash","aria-describedby":"ipfs-path-desc",onChange:this.onChange,onKeyDown:this.onKeyDown,value:this.state.path}),e.createElement("small",{id:"ipfs-path-desc",className:"o-0 absolute f6 black-60 db mb2"},"Paste in a CID or IPFS path"))),e.createElement("div",{className:"flex flex-row-reverse mb2"},e.createElement(L.Z,{minWidth:0,disabled:!this.isValid,title:t("app:actions.inspect"),style:{borderRadius:"0 3px 3px 0"},onClick:this.onInspect,bg:"bg-teal",className:"ExploreFormButton button-reset pv1 ph2 ba f7 fw4 white overflow-hidden tc"},e.createElement(I.Z,{style:{height:"2em"},className:"dib fill-current-color v-mid"}),e.createElement("span",{className:"ml2"},t("app:actions.inspect"))),e.createElement(L.Z,{minWidth:0,disabled:!this.isValid,style:{borderRadius:"0"},title:t("app:actions.browse"),onClick:this.onBrowse,className:"ExploreFormButton button-reset pv1 ph2 ba f7 fw4 white bg-gray overflow-hidden tc"},e.createElement(B.Z,{style:{height:"2em"},className:"dib fill-current-color v-mid"}),e.createElement("span",{className:"ml2"},t("app:actions.browse")))))}}const U=(0,c.Zh)("files")(M);function F(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class K extends e.Component{constructor(){super(...arguments),F(this,"addFiles",(async e=>{const{doFilesWrite:t,doUpdateHash:n,routeInfo:r,filesPathInfo:i}=this.props,o="/files*"===r.pattern,s=o?(null===i||void 0===i?void 0:i.realPath)||r.params.path:"/",a=await e;t((0,l.dw)(a),s),o||n("/files")})),F(this,"handleJoyrideCb",(e=>{"close"===e.action&&this.props.doDisableTooltip()}))}componentDidMount(){this.props.doTryInitIpfs(),this.props.doInitHelia()}render(){const{t:t,route:n,ipfsReady:r,doFilesNavigateTo:i,doExploreUserProvidedPath:o,routeInfo:{url:c},connectDropTarget:l,canDrop:u,isOver:h,showTooltip:p}=this.props;return l(e.createElement("div",{className:"sans-serif h-100 relative",onClick:s(this.props.doUpdateUrl)},u&&h&&e.createElement("div",{className:"h-100 top-0 right-0 fixed appOverlay",style:{background:"rgba(99, 202, 210, 0.2)"}}),e.createElement("div",{className:"flex flex-row-reverse-l flex-column-reverse justify-end justify-start-l",style:{minHeight:"100vh"}},e.createElement("div",{className:"flex-auto-l"},e.createElement("div",{className:"flex items-center ph3 ph4-l",style:{WebkitAppRegion:"drag",height:75,background:"#F0F6FA",paddingTop:"20px",paddingBottom:"15px"}},e.createElement("div",{className:"joyride-app-explore",style:{width:560}},e.createElement(U,{onBrowse:i,onInspect:o})),e.createElement("div",{className:"dn flex-ns flex-auto items-center justify-end"},e.createElement(O,null),e.createElement(D,{className:"joyride-app-status"}))),e.createElement("main",{className:"bg-white pv3 pa3 pa4-l"},r||"/welcome"===c||c.startsWith("/settings")?e.createElement(n,null):e.createElement(k.Z,null))),e.createElement("div",{className:"navbar-container flex-none-l bg-navy"},e.createElement(T,null))),e.createElement(a.ZP,{run:p,steps:d.us.getSteps({t:t}),styles:d.us.styles,callback:this.handleJoyrideCb,scrollToFirstStep:!0,disableOverlay:!0,locale:(0,f._)(t)}),e.createElement(P,null)))}}F(K,"propTypes",{doTryInitIpfs:i().func.isRequired,doInitHelia:i().func.isRequired,doUpdateUrl:i().func.isRequired,doUpdateHash:i().func.isRequired,doFilesWrite:i().func.isRequired,routeInfo:i().object.isRequired,filesPathInfo:i().object,isOver:i().bool.isRequired});const j=(0,u.DropTarget)(h.FILE,{drop:(e,t,n)=>{if(t.didDrop())return;const{filesPromise:r}=t.getItem();n.addFiles(r)},canDrop:e=>!e.filesPathInfo||e.filesPathInfo.isMfs},((e,t)=>({connectDropTarget:e.dropTarget(),isOver:t.isOver(),canDrop:t.canDrop()})))(K),Z=(0,n.$)("selectRoute","selectRouteInfo","selectIpfsReady","selectShowTooltip","doFilesNavigateTo","doExploreUserProvidedPath","doUpdateUrl","doUpdateHash","doTryInitIpfs","doInitHelia","doFilesWrite","doDisableTooltip","selectFilesPathInfo",(0,c.Zh)("app")(j));var z=__webpack_require__(99491),V=__webpack_require__(4046),H=__webpack_require__(24799);const q={idleTimeout:2e3,idleAction:"APP_IDLE",stopWhenTabInactive:!1},G={timeout:500},W=e=>({name:"appIdle",init:t=>{const n=Object.assign({},q,e),{idleAction:r,idleTimeout:i}=n;let o;i&&(o=((e,t,n)=>(0,z.Ds)((()=>{e?(0,z.Wn)((()=>(0,z.dV)(n,G))):(0,z.dV)(n,G)}),t))(n.stopWhenTabInactive,i,(()=>t.dispatch({type:r}))));const s=()=>{o&&o()};t.subscribe(s),s()}});const Q=function(e){return(e=e||{}).windowSize=e.windowSize||864e5,{name:"nodeBandwidthChart",reducer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{data:{in:[],out:[]}},t=arguments.length>1?arguments[1]:void 0;return"NODE_BANDWIDTH_CHART_DATA_UPDATED"===t.type?{...e,data:t.payload.chartData}:e},selectNodeBandwidthChartData:e=>e.nodeBandwidthChart.data,doUpdateNodeBandwidthChartData:(t,n,r)=>i=>{let{dispatch:o}=i;const s=(r={in:r.in.concat({x:n,y:parseInt(t.rateIn.toFixed(0),10)}),out:r.out.concat({x:n,y:parseInt(-1*t.rateOut.toFixed(0),10)})}).in.findIndex((t=>t.x>=n-e.windowSize));s>0&&(r.in=r.in.slice(s),r.out=r.out.slice(s)),o({type:"NODE_BANDWIDTH_CHART_DATA_UPDATED",payload:{chartData:r}})},reactUpdateNodeBandwidthChartData:(0,z.P1)("selectNodeBandwidth","selectNodeBandwidthLastSuccess","selectNodeBandwidthEnabled","selectNodeBandwidthChartData",((e,t,n,r)=>{if(e&&n)return!r.in.length||t>r.in[r.in.length-1].x?{actionCreator:"doUpdateNodeBandwidthChartData",args:[e,t,r]}:void 0}))}};var Y=__webpack_require__(26034),J=__webpack_require__.n(Y),X=__webpack_require__(26723),$=__webpack_require__.n(X);const ee=(0,z.Jc)({name:"nodeBandwidth",actionBaseType:"NODE_BANDWIDTH",getPromise:async e=>{let{getIpfs:t}=e;try{return await $()(t().stats.bw())}catch(n){if(/bandwidth reporter disabled in config/.test(n))return{disabled:!0};throw n}},staleAfter:J().seconds(3),retryAfter:J().seconds(3),persist:!1,checkIfOnline:!1});ee.selectNodeBandwidthEnabled=e=>!!e.nodeBandwidth.data&&!e.nodeBandwidth.data.disabled,ee.selectNodeBandwidthLastSuccess=e=>e.nodeBandwidth.lastSuccess,ee.reactNodeBandwidthFetchWhenIdle=(0,z.P1)("selectNodeBandwidthShouldUpdate","selectIpfsReady",((e,t)=>{if(e&&t)return{actionCreator:"doFetchNodeBandwidth"}}));const te=ee;var ne=__webpack_require__(95321);const re=J().seconds(10),ie=(0,z.Jc)({name:"peers",actionBaseType:"PEERS",getPromise:e=>{let{getIpfs:t}=e;return t().swarm.peers({verbose:!0,timeout:re})},staleAfter:re,persist:!1,checkIfOnline:!1}),oe=ie.reducer;ie.reducer=(e,t)=>{const n=oe(e,t);return"SET_SELECTED_PEER"===t.type?{...n,selectedPeers:t.payload}:n},ie.selectPeersCount=(0,z.P1)("selectPeers",(e=>Array.isArray(e)?e.length:0)),ie.doConnectSwarm=(e,t)=>async n=>{let{dispatch:r,getIpfs:i,store:o}=n;r({type:"SWARM_CONNECT_STARTED",payload:{addr:e}});const s=i();try{if(await s.swarm.connect(e),t){const t=(0,ne.HM)(e),n=t.getPeerId(),r=t.decapsulateCode(421).toString();let i=await s.config.get("Peering.Peers")||[];const a=i.find((e=>e.ID===n));a?a.Addrs.find((e=>e===r))||a.Addrs.push(r):i=[...i,{ID:n,Addrs:[r]}],await s.config.set("Peering.Peers",i),await o.doMarkConfigAsOutdated()}}catch(a){return r({type:"SWARM_CONNECT_FAILED",payload:{addr:e,error:a}})}return r({type:"SWARM_CONNECT_FINISHED",payload:{addr:e}})},ie.reactPeersFetchWhenIdle=(0,z.P1)("selectPeersShouldUpdate","selectIpfsConnected",((e,t)=>{if(e&&t)return{actionCreator:"doFetchPeers"}})),ie.reactPeersFetchWhenActive=(0,z.P1)("selectAppTime","selectRouteInfo","selectPeersRaw","selectIpfsConnected",((e,t,n,r,i)=>{const o=n.lastSuccess||0;if("/peers"===t.url&&i&&!n.isLoading&&e-o>J().seconds(5))return{actionCreator:"doFetchPeers"}})),ie.selectSelectedPeers=e=>e.peers.selectedPeers,ie.doSetSelectedPeers=e=>t=>{let{dispatch:n}=t;n({type:"SET_SELECTED_PEER",payload:e})};const se=ie;function ae(e){return new Promise(((t,n)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>n(e.error)}))}function ce(e,t){const n=function(){if(navigator.userAgentData||!/Safari\//.test(navigator.userAgent)||/Chrom(e|ium)\//.test(navigator.userAgent)||!indexedDB.databases)return Promise.resolve();let e;return new Promise((t=>{const n=()=>indexedDB.databases().finally(t);e=setInterval(n,100),n()})).finally((()=>clearInterval(e)))}().then((()=>{const n=indexedDB.open(e);return n.onupgradeneeded=()=>n.result.createObjectStore(t),ae(n)}));return(e,r)=>n.then((n=>r(n.transaction(t,e).objectStore(t))))}let le;function ue(){return le||(le=ce("keyval-store","keyval")),le}function he(e,t){return e("readonly",(e=>(e.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},ae(e.transaction))))}var de={__proto__:null,clear:function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:ue())("readwrite",(e=>(e.clear(),ae(e.transaction))))},createStore:ce,del:function(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:ue())("readwrite",(t=>(t.delete(e),ae(t.transaction))))},entries:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ue();const t=[];return he(e,(e=>t.push([e.key,e.value]))).then((()=>t))},get:function(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:ue())("readonly",(t=>ae(t.get(e))))},getMany:function(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:ue())("readonly",(t=>Promise.all(e.map((e=>ae(t.get(e)))))))},keys:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ue();const t=[];return he(e,(e=>t.push(e.key))).then((()=>t))},promisifyRequest:ae,set:function(e,t){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:ue())("readwrite",(n=>(n.put(t,e),ae(n.transaction))))},setMany:function(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:ue())("readwrite",(t=>(e.forEach((e=>t.put(e[1],e[0]))),ae(t.transaction))))},update:function(e,t){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:ue())("readwrite",(n=>new Promise(((r,i)=>{n.get(e).onsuccess=function(){try{n.put(t(this.result),e),r(ae(n.transaction))}catch(o){i(o)}}}))))},values:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ue();const t=[];return he(e,(e=>t.push(e.value))).then((()=>t))}},fe={maxAge:1/0,version:0,lib:de},pe=function(e){return Object.assign({},fe,e)},ge=function(e,t,n){var r=pe(t),i=r.maxAge,o=r.version,s=r.lib;return s.get(e,n).then(JSON.parse).then((function(t){return Date.now()-t.time>i||o!==t.version?(s.del(e,n),null):t.data})).catch((function(){return null}))},ye=function(e){var t,n=pe(e);return n.name&&(t=ce(n.name,n.name)),{get:function(e){return ge(e,n,t)},set:function(e,r){return function(e,t,n,r){var i=pe(n),o=i.lib,s=i.version;return o.set(e,JSON.stringify({version:s,time:Date.now(),data:t}),r).catch((function(){return null}))}(e,r,n,t)},getAll:function(){return function(e,t){var n,r=pe(e);return r.lib.keys(t).then((function(e){return n=e,Promise.all(n.map((function(e){return ge(e,r,t)})))})).then((function(e){return e.reduce((function(e,t,r){return t&&(e[n[r]]=t),e}),{})})).catch((function(){}))}(n,t)},del:function(e){return n.lib.del(e,t)},clear:function(){return n.lib.clear(t)},keys:function(){return n.lib.keys(t)}}},me=Object.create,ve=Object.defineProperty,be=Object.getOwnPropertyDescriptor,we=Object.getOwnPropertyNames,Ee=Object.getPrototypeOf,Ae=Object.prototype.hasOwnProperty,Se=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),_e=(e,t,n)=>(n=null!=e?me(Ee(e)):{},((e,t,n,r)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let i of we(t))!Ae.call(e,i)&&i!==n&&ve(e,i,{get:()=>t[i],enumerable:!(r=be(t,i))||r.enumerable});return e})(!t&&e&&e.__esModule?n:ve(n,"default",{value:e,enumerable:!0}),e)),Ie=Se((e=>{e.byteLength=function(e){var t=s(e),n=t[0],r=t[1];return 3*(n+r)/4-r},e.toByteArray=function(e){var t,n,o=s(e),a=o[0],c=o[1],l=new i(function(e,t,n){return 3*(t+n)/4-n}(0,a,c)),u=0,h=c>0?a-4:a;for(n=0;n<h;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],l[u++]=t>>16&255,l[u++]=t>>8&255,l[u++]=255&t;return 2===c&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,l[u++]=255&t),1===c&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,l[u++]=t>>8&255,l[u++]=255&t),l},e.fromByteArray=function(e){for(var t,r=e.length,i=r%3,o=[],s=16383,a=0,l=r-i;a<l;a+=s)o.push(c(e,a,a+s>l?l:a+s));return 1===i?(t=e[r-1],o.push(n[t>>2]+n[t<<4&63]+"==")):2===i&&(t=(e[r-2]<<8)+e[r-1],o.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"=")),o.join("")};var t,n=[],r=[],i=typeof Uint8Array<"u"?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(t=0,64;t<64;++t)n[t]=o[t],r[o.charCodeAt(t)]=t;function s(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function a(e){return n[e>>18&63]+n[e>>12&63]+n[e>>6&63]+n[63&e]}function c(e,t,n){for(var r,i=[],o=t;o<n;o+=3)r=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),i.push(a(r));return i.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63})),Ce=Se((e=>{e.read=function(e,t,n,r,i){var o,s,a=8*i-r-1,c=(1<<a)-1,l=c>>1,u=-7,h=n?i-1:0,d=n?-1:1,f=e[t+h];for(h+=d,o=f&(1<<-u)-1,f>>=-u,u+=a;u>0;o=256*o+e[t+h],h+=d,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=r;u>0;s=256*s+e[t+h],h+=d,u-=8);if(0===o)o=1-l;else{if(o===c)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,r),o-=l}return(f?-1:1)*s*Math.pow(2,o-r)},e.write=function(e,t,n,r,i,o){var s,a,c,l=8*o-i-1,u=(1<<l)-1,h=u>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,p=r?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+h>=1?d/c:d*Math.pow(2,1-h))*c>=2&&(s++,c/=2),s+h>=u?(a=0,s=u):s+h>=1?(a=(t*c-1)*Math.pow(2,i),s+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;e[n+f]=255&a,f+=p,a/=256,i-=8);for(s=s<<i|a,l+=i;l>0;e[n+f]=255&s,f+=p,s/=256,l-=8);e[n+f-p]|=128*g}})),Te=Se((e=>{var t=Ie(),n=Ce(),r="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=s,e.SlowBuffer=function(e){return+e!=e&&(e=0),s.alloc(+e)},e.INSPECT_MAX_BYTES=50;var i=2147483647;function o(e){if(e>i)throw new RangeError('The value "'+e+'" is invalid for option "size"');let t=new Uint8Array(e);return Object.setPrototypeOf(t,s.prototype),t}function s(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return l(e)}return a(e,t,n)}function a(e,t,n){if("string"==typeof e)return function(e,t){if(("string"!=typeof t||""===t)&&(t="utf8"),!s.isEncoding(t))throw new TypeError("Unknown encoding: "+t);let n=0|f(e,t),r=o(n),i=r.write(e,t);return i!==n&&(r=r.slice(0,i)),r}(e,t);if(ArrayBuffer.isView(e))return function(e){if(G(e,Uint8Array)){let t=new Uint8Array(e);return h(t.buffer,t.byteOffset,t.byteLength)}return u(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(G(e,ArrayBuffer)||e&&G(e.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(G(e,SharedArrayBuffer)||e&&G(e.buffer,SharedArrayBuffer)))return h(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');let r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return s.from(r,t,n);let i=function(e){if(s.isBuffer(e)){let t=0|d(e.length),n=o(t);return 0===n.length||e.copy(n,0,0,t),n}if(void 0!==e.length)return"number"!=typeof e.length||W(e.length)?o(0):u(e);if("Buffer"===e.type&&Array.isArray(e.data))return u(e.data)}(e);if(i)return i;if(typeof Symbol<"u"&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return s.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function l(e){return c(e),o(e<0?0:0|d(e))}function u(e){let t=e.length<0?0:0|d(e.length),n=o(t);for(let r=0;r<t;r+=1)n[r]=255&e[r];return n}function h(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');let r;return r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(r,s.prototype),r}function d(e){if(e>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return 0|e}function f(e,t){if(s.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||G(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);let n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return V(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return H(e).length;default:if(i)return r?-1:V(e).length;t=(""+t).toLowerCase(),i=!0}}function p(e,t,n){let r=!1;if((void 0===t||t<0)&&(t=0),t>this.length||((void 0===n||n>this.length)&&(n=this.length),n<=0)||(n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return k(this,t,n);case"utf8":case"utf-8":return _(this,t,n);case"ascii":return C(this,t,n);case"latin1":case"binary":return T(this,t,n);case"base64":return S(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function g(e,t,n){let r=e[t];e[t]=e[n],e[n]=r}function y(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),W(n=+n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=s.from(t,r)),s.isBuffer(t))return 0===t.length?-1:m(e,t,n,r,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):m(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function m(e,t,n,r,i){let o,s=1,a=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s=2,a/=2,c/=2,n/=2}function l(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){let r=-1;for(o=n;o<a;o++)if(l(e,o)===l(t,-1===r?0:o-r)){if(-1===r&&(r=o),o-r+1===c)return r*s}else-1!==r&&(o-=o-r),r=-1}else for(n+c>a&&(n=a-c),o=n;o>=0;o--){let n=!0;for(let r=0;r<c;r++)if(l(e,o+r)!==l(t,r)){n=!1;break}if(n)return o}return-1}function v(e,t,n,r){n=Number(n)||0;let i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;let o,s=t.length;for(r>s/2&&(r=s/2),o=0;o<r;++o){let r=parseInt(t.substr(2*o,2),16);if(W(r))return o;e[n+o]=r}return o}function b(e,t,n,r){return q(V(t,e.length-n),e,n,r)}function w(e,t,n,r){return q(function(e){let t=[];for(let n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function E(e,t,n,r){return q(H(t),e,n,r)}function A(e,t,n,r){return q(function(e,t){let n,r,i,o=[];for(let s=0;s<e.length&&!((t-=2)<0);++s)n=e.charCodeAt(s),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function S(e,n,r){return 0===n&&r===e.length?t.fromByteArray(e):t.fromByteArray(e.slice(n,r))}function _(e,t,n){n=Math.min(e.length,n);let r=[],i=t;for(;i<n;){let t=e[i],o=null,s=t>239?4:t>223?3:t>191?2:1;if(i+s<=n){let n,r,a,c;switch(s){case 1:t<128&&(o=t);break;case 2:n=e[i+1],128===(192&n)&&(c=(31&t)<<6|63&n,c>127&&(o=c));break;case 3:n=e[i+1],r=e[i+2],128===(192&n)&&128===(192&r)&&(c=(15&t)<<12|(63&n)<<6|63&r,c>2047&&(c<55296||c>57343)&&(o=c));break;case 4:n=e[i+1],r=e[i+2],a=e[i+3],128===(192&n)&&128===(192&r)&&128===(192&a)&&(c=(15&t)<<18|(63&n)<<12|(63&r)<<6|63&a,c>65535&&c<1114112&&(o=c))}}null===o?(o=65533,s=1):o>65535&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|1023&o),r.push(o),i+=s}return function(e){let t=e.length;if(t<=I)return String.fromCharCode.apply(String,e);let n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=I));return n}(r)}e.kMaxLength=i,s.TYPED_ARRAY_SUPPORT=function(){try{let e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch{return!1}}(),!s.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&"function"==typeof console.error&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}}),s.poolSize=8192,s.from=function(e,t,n){return a(e,t,n)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array),s.alloc=function(e,t,n){return function(e,t,n){return c(e),e<=0?o(e):void 0!==t?"string"==typeof n?o(e).fill(t,n):o(e).fill(t):o(e)}(e,t,n)},s.allocUnsafe=function(e){return l(e)},s.allocUnsafeSlow=function(e){return l(e)},s.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==s.prototype},s.compare=function(e,t){if(G(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),G(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),!s.isBuffer(e)||!s.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let n=e.length,r=t.length;for(let i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},s.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return s.alloc(0);let n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;let r=s.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){let t=e[n];if(G(t,Uint8Array))i+t.length>r.length?(s.isBuffer(t)||(t=s.from(t)),t.copy(r,i)):Uint8Array.prototype.set.call(r,t,i);else{if(!s.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(r,i)}i+=t.length}return r},s.byteLength=f,s.prototype._isBuffer=!0,s.prototype.swap16=function(){let e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)g(this,t,t+1);return this},s.prototype.swap32=function(){let e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},s.prototype.swap64=function(){let e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},s.prototype.toString=function(){let e=this.length;return 0===e?"":0===arguments.length?_(this,0,e):p.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(e){if(!s.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===s.compare(this,e)},s.prototype.inspect=function(){let t="",n=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(t+=" ... "),"<Buffer "+t+">"},r&&(s.prototype[r]=s.prototype.inspect),s.prototype.compare=function(e,t,n,r,i){if(G(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),!s.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;let o=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0),c=Math.min(o,a),l=this.slice(r,i),u=e.slice(t,n);for(let s=0;s<c;++s)if(l[s]!==u[s]){o=l[s],a=u[s];break}return o<a?-1:a<o?1:0},s.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},s.prototype.indexOf=function(e,t,n){return y(this,e,t,n,!0)},s.prototype.lastIndexOf=function(e,t,n){return y(this,e,t,n,!1)},s.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}let i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let o=!1;for(;;)switch(r){case"hex":return v(this,e,t,n);case"utf8":case"utf-8":return b(this,e,t,n);case"ascii":case"latin1":case"binary":return w(this,e,t,n);case"base64":return E(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var I=4096;function C(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function T(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function k(e,t,n){let r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);let i="";for(let o=t;o<n;++o)i+=Q[e[o]];return i}function R(e,t,n){let r=e.slice(t,n),i="";for(let o=0;o<r.length-1;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function x(e,t,n){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function P(e,t,n,r,i,o){if(!s.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function D(e,t,n,r,i){K(t,r,i,e,n,7);let o=Number(t&BigInt(4294967295));e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s,n}function O(e,t,n,r,i){K(t,r,i,e,n,7);let o=Number(t&BigInt(4294967295));e[n+7]=o,o>>=8,e[n+6]=o,o>>=8,e[n+5]=o,o>>=8,e[n+4]=o;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[n+3]=s,s>>=8,e[n+2]=s,s>>=8,e[n+1]=s,s>>=8,e[n]=s,n+8}function N(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function B(e,t,r,i,o){return t=+t,r>>>=0,o||N(e,0,r,4),n.write(e,t,r,i,23,4),r+4}function L(e,t,r,i,o){return t=+t,r>>>=0,o||N(e,0,r,8),n.write(e,t,r,i,52,8),r+8}s.prototype.slice=function(e,t){let n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);let r=this.subarray(e,t);return Object.setPrototypeOf(r,s.prototype),r},s.prototype.readUintLE=s.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||x(e,t,this.length);let r=this[e],i=1,o=0;for(;++o<t&&(i*=256);)r+=this[e+o]*i;return r},s.prototype.readUintBE=s.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||x(e,t,this.length);let r=this[e+--t],i=1;for(;t>0&&(i*=256);)r+=this[e+--t]*i;return r},s.prototype.readUint8=s.prototype.readUInt8=function(e,t){return e>>>=0,t||x(e,1,this.length),this[e]},s.prototype.readUint16LE=s.prototype.readUInt16LE=function(e,t){return e>>>=0,t||x(e,2,this.length),this[e]|this[e+1]<<8},s.prototype.readUint16BE=s.prototype.readUInt16BE=function(e,t){return e>>>=0,t||x(e,2,this.length),this[e]<<8|this[e+1]},s.prototype.readUint32LE=s.prototype.readUInt32LE=function(e,t){return e>>>=0,t||x(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},s.prototype.readUint32BE=s.prototype.readUInt32BE=function(e,t){return e>>>=0,t||x(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},s.prototype.readBigUInt64LE=Y((function(e){j(e>>>=0,"offset");let t=this[e],n=this[e+7];(void 0===t||void 0===n)&&Z(e,this.length-8);let r=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+n*2**24;return BigInt(r)+(BigInt(i)<<BigInt(32))})),s.prototype.readBigUInt64BE=Y((function(e){j(e>>>=0,"offset");let t=this[e],n=this[e+7];(void 0===t||void 0===n)&&Z(e,this.length-8);let r=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+n;return(BigInt(r)<<BigInt(32))+BigInt(i)})),s.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||x(e,t,this.length);let r=this[e],i=1,o=0;for(;++o<t&&(i*=256);)r+=this[e+o]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*t)),r},s.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||x(e,t,this.length);let r=t,i=1,o=this[e+--r];for(;r>0&&(i*=256);)o+=this[e+--r]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*t)),o},s.prototype.readInt8=function(e,t){return e>>>=0,t||x(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},s.prototype.readInt16LE=function(e,t){e>>>=0,t||x(e,2,this.length);let n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt16BE=function(e,t){e>>>=0,t||x(e,2,this.length);let n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt32LE=function(e,t){return e>>>=0,t||x(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},s.prototype.readInt32BE=function(e,t){return e>>>=0,t||x(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},s.prototype.readBigInt64LE=Y((function(e){j(e>>>=0,"offset");let t=this[e],n=this[e+7];(void 0===t||void 0===n)&&Z(e,this.length-8);let r=this[e+4]+256*this[e+5]+65536*this[e+6]+(n<<24);return(BigInt(r)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),s.prototype.readBigInt64BE=Y((function(e){j(e>>>=0,"offset");let t=this[e],n=this[e+7];(void 0===t||void 0===n)&&Z(e,this.length-8);let r=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(r)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+n)})),s.prototype.readFloatLE=function(e,t){return e>>>=0,t||x(e,4,this.length),n.read(this,e,!0,23,4)},s.prototype.readFloatBE=function(e,t){return e>>>=0,t||x(e,4,this.length),n.read(this,e,!1,23,4)},s.prototype.readDoubleLE=function(e,t){return e>>>=0,t||x(e,8,this.length),n.read(this,e,!0,52,8)},s.prototype.readDoubleBE=function(e,t){return e>>>=0,t||x(e,8,this.length),n.read(this,e,!1,52,8)},s.prototype.writeUintLE=s.prototype.writeUIntLE=function(e,t,n,r){if(e=+e,t>>>=0,n>>>=0,!r){P(this,e,t,n,Math.pow(2,8*n)-1,0)}let i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},s.prototype.writeUintBE=s.prototype.writeUIntBE=function(e,t,n,r){if(e=+e,t>>>=0,n>>>=0,!r){P(this,e,t,n,Math.pow(2,8*n)-1,0)}let i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},s.prototype.writeUint8=s.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||P(this,e,t,1,255,0),this[t]=255&e,t+1},s.prototype.writeUint16LE=s.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||P(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},s.prototype.writeUint16BE=s.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||P(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},s.prototype.writeUint32LE=s.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||P(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},s.prototype.writeUint32BE=s.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||P(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},s.prototype.writeBigUInt64LE=Y((function(e,t=0){return D(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),s.prototype.writeBigUInt64BE=Y((function(e,t=0){return O(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),s.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){let r=Math.pow(2,8*n-1);P(this,e,t,n,r-1,-r)}let i=0,o=1,s=0;for(this[t]=255&e;++i<n&&(o*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/o>>0)-s&255;return t+n},s.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){let r=Math.pow(2,8*n-1);P(this,e,t,n,r-1,-r)}let i=n-1,o=1,s=0;for(this[t+i]=255&e;--i>=0&&(o*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/o>>0)-s&255;return t+n},s.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||P(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},s.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||P(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},s.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||P(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},s.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||P(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},s.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||P(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},s.prototype.writeBigInt64LE=Y((function(e,t=0){return D(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),s.prototype.writeBigInt64BE=Y((function(e,t=0){return O(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),s.prototype.writeFloatLE=function(e,t,n){return B(this,e,t,!0,n)},s.prototype.writeFloatBE=function(e,t,n){return B(this,e,t,!1,n)},s.prototype.writeDoubleLE=function(e,t,n){return L(this,e,t,!0,n)},s.prototype.writeDoubleBE=function(e,t,n){return L(this,e,t,!1,n)},s.prototype.copy=function(e,t,n,r){if(!s.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),!r&&0!==r&&(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n||0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);let i=r-n;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,r):Uint8Array.prototype.set.call(e,this.subarray(n,r),t),i},s.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!s.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){let t=e.charCodeAt(0);("utf8"===r&&t<128||"latin1"===r)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;let i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{let o=s.isBuffer(e)?e:s.from(e,r),a=o.length;if(0===a)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<n-t;++i)this[i+t]=o[i%a]}return this};var M={};function U(e,t,n){M[e]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function F(e){let t="",n=e.length,r="-"===e[0]?1:0;for(;n>=r+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function K(e,t,n,r,i,o){if(e>n||e<t){let r,i="bigint"==typeof t?"n":"";throw r=o>3?0===t||t===BigInt(0)?`>= 0${i} and < 2${i} ** ${8*(o+1)}${i}`:`>= -(2${i} ** ${8*(o+1)-1}${i}) and < 2 ** ${8*(o+1)-1}${i}`:`>= ${t}${i} and <= ${n}${i}`,new M.ERR_OUT_OF_RANGE("value",r,e)}!function(e,t,n){j(t,"offset"),(void 0===e[t]||void 0===e[t+n])&&Z(t,e.length-(n+1))}(r,i,o)}function j(e,t){if("number"!=typeof e)throw new M.ERR_INVALID_ARG_TYPE(t,"number",e)}function Z(e,t,n){throw Math.floor(e)!==e?(j(e,n),new M.ERR_OUT_OF_RANGE(n||"offset","an integer",e)):t<0?new M.ERR_BUFFER_OUT_OF_BOUNDS:new M.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${t}`,e)}U("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),U("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),U("ERR_OUT_OF_RANGE",(function(e,t,n){let r=`The value of "${e}" is out of range.`,i=n;return Number.isInteger(n)&&Math.abs(n)>2**32?i=F(String(n)):"bigint"==typeof n&&(i=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(i=F(i)),i+="n"),r+=` It must be ${t}. Received ${i}`,r}),RangeError);var z=/[^+/0-9A-Za-z-_]/g;function V(e,t){t=t||1/0;let n,r=e.length,i=null,o=[];for(let s=0;s<r;++s){if(n=e.charCodeAt(s),n>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function H(e){return t.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(z,"")).length<2)return"";for(;e.length%4!==0;)e+="=";return e}(e))}function q(e,t,n,r){let i;for(i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function G(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function W(e){return e!==e}var Q=function(){let e="0123456789abcdef",t=new Array(256);for(let n=0;n<16;++n){let r=16*n;for(let i=0;i<16;++i)t[r+i]=e[n]+e[i]}return t}();function Y(e){return typeof BigInt>"u"?J:e}function J(){throw new Error("BigInt not supported")}})),ke=Se((()=>{})),Re=Se((e=>{var t=e,{Buffer:n}=Te(),r=ke();t.toBuffer=function(e,t,r){let i;if(r=~~r,this.isV4Format(e))i=t||n.alloc(r+4),e.split(/\./g).map((e=>{i[r++]=255&parseInt(e,10)}));else if(this.isV6Format(e)){let o,s=e.split(":",8);for(o=0;o<s.length;o++){let e;this.isV4Format(s[o])&&(e=this.toBuffer(s[o]),s[o]=e.slice(0,2).toString("hex")),e&&++o<8&&s.splice(o,0,e.slice(2,4).toString("hex"))}if(""===s[0])for(;s.length<8;)s.unshift("0");else if(""===s[s.length-1])for(;s.length<8;)s.push("0");else if(s.length<8){for(o=0;o<s.length&&""!==s[o];o++);let e=[o,1];for(o=9-s.length;o>0;o--)e.push("0");s.splice(...e)}for(i=t||n.alloc(r+16),o=0;o<s.length;o++){let e=parseInt(s[o],16);i[r++]=e>>8&255,i[r++]=255&e}}if(!i)throw Error(`Invalid ip address: ${e}`);return i},t.toString=function(e,t,n){t=~~t;let r=[];if(4===(n=n||e.length-t)){for(let i=0;i<n;i++)r.push(e[t+i]);r=r.join(".")}else if(16===n){for(let i=0;i<n;i+=2)r.push(e.readUInt16BE(t+i).toString(16));r=r.join(":"),r=r.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3"),r=r.replace(/:{3,4}/,"::")}return r};var i=/^(\d{1,3}\.){3,3}\d{1,3}$/,o=/^(::)?(((\d{1,3}\.){3}(\d{1,3}){1})?([0-9a-f]){0,4}:{0,2}){1,8}(::)?$/i;function s(e){return 4===e?"ipv4":6===e?"ipv6":e?e.toLowerCase():"ipv4"}t.isV4Format=function(e){return i.test(e)},t.isV6Format=function(e){return o.test(e)},t.fromPrefixLen=function(e,r){let i=4;"ipv6"===(r=e>32?"ipv6":s(r))&&(i=16);let o=n.alloc(i);for(let t=0,n=o.length;t<n;++t){let n=8;e<8&&(n=e),e-=n,o[t]=255&~(255>>n)}return t.toString(o)},t.mask=function(e,r){e=t.toBuffer(e),r=t.toBuffer(r);let i,o=n.alloc(Math.max(e.length,r.length));if(e.length===r.length)for(i=0;i<e.length;i++)o[i]=e[i]&r[i];else if(4===r.length)for(i=0;i<r.length;i++)o[i]=e[e.length-4+i]&r[i];else{for(i=0;i<o.length-6;i++)o[i]=0;for(o[10]=255,o[11]=255,i=0;i<e.length;i++)o[i+12]=e[i]&r[i+12];i+=12}for(;i<o.length;i++)o[i]=0;return t.toString(o)},t.cidr=function(e){let n=e.split("/"),r=n[0];if(2!==n.length)throw new Error(`invalid CIDR subnet: ${r}`);let i=t.fromPrefixLen(parseInt(n[1],10));return t.mask(r,i)},t.subnet=function(e,n){let r=t.toLong(t.mask(e,n)),i=t.toBuffer(n),o=0;for(let t=0;t<i.length;t++)if(255===i[t])o+=8;else{let e=255&i[t];for(;e;)e=e<<1&255,o++}let s=2**(32-o);return{networkAddress:t.fromLong(r),firstAddress:s<=2?t.fromLong(r):t.fromLong(r+1),lastAddress:s<=2?t.fromLong(r+s-1):t.fromLong(r+s-2),broadcastAddress:t.fromLong(r+s-1),subnetMask:n,subnetMaskLength:o,numHosts:s<=2?s:s-2,length:s,contains:e=>r===t.toLong(t.mask(e,n))}},t.cidrSubnet=function(e){let n=e.split("/"),r=n[0];if(2!==n.length)throw new Error(`invalid CIDR subnet: ${r}`);let i=t.fromPrefixLen(parseInt(n[1],10));return t.subnet(r,i)},t.not=function(e){let n=t.toBuffer(e);for(let t=0;t<n.length;t++)n[t]=255^n[t];return t.toString(n)},t.or=function(e,n){if(e=t.toBuffer(e),n=t.toBuffer(n),e.length===n.length){for(let t=0;t<e.length;++t)e[t]|=n[t];return t.toString(e)}let r=e,i=n;n.length>e.length&&(r=n,i=e);let o=r.length-i.length;for(let t=o;t<r.length;++t)r[t]|=i[t-o];return t.toString(r)},t.isEqual=function(e,n){if(e=t.toBuffer(e),n=t.toBuffer(n),e.length===n.length){for(let t=0;t<e.length;t++)if(e[t]!==n[t])return!1;return!0}if(4===n.length){let t=n;n=e,e=t}for(let t=0;t<10;t++)if(0!==n[t])return!1;let r=n.readUInt16BE(10);if(0!==r&&65535!==r)return!1;for(let t=0;t<4;t++)if(e[t]!==n[t+12])return!1;return!0},t.isPrivate=function(e){return/^(::f{4}:)?10\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^(::f{4}:)?192\.168\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^(::f{4}:)?172\.(1[6-9]|2\d|30|31)\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^(::f{4}:)?127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^(::f{4}:)?169\.254\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^f[cd][0-9a-f]{2}:/i.test(e)||/^fe80:/i.test(e)||/^::1$/.test(e)||/^::$/.test(e)},t.isPublic=function(e){return!t.isPrivate(e)},t.isLoopback=function(e){return/^(::f{4}:)?127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})/.test(e)||/^fe80::1$/.test(e)||/^::1$/.test(e)||/^::$/.test(e)},t.loopback=function(e){if("ipv4"!==(e=s(e))&&"ipv6"!==e)throw new Error("family must be ipv4 or ipv6");return"ipv4"===e?"127.0.0.1":"fe80::1"},t.address=function(e,n){let i=r.networkInterfaces();if(n=s(n),e&&"private"!==e&&"public"!==e){let t=i[e].filter((e=>s(e.family)===n));return 0===t.length?void 0:t[0].address}let o=Object.keys(i).map((r=>{let o=i[r].filter((r=>(r.family=s(r.family),r.family===n&&!t.isLoopback(r.address)&&(!e||("public"===e?t.isPrivate(r.address):t.isPublic(r.address))))));return o.length?o[0].address:void 0})).filter(Boolean);return o.length?o[0]:t.loopback(n)},t.toLong=function(e){let t=0;return e.split(".").forEach((e=>{t<<=8,t+=parseInt(e)})),t>>>0},t.fromLong=function(e){return`${e>>>24}.${e>>16&255}.${e>>8&255}.${255&e}`}})),xe=Se(((e,t)=>{var n,r=typeof self<"u"?self:e,i=function(){function e(){this.fetch=!1,this.DOMException=r.DOMException}return e.prototype=r,new e}();n=i,function(e){var t="URLSearchParams"in n,r="Symbol"in n&&"iterator"in Symbol,i="FileReader"in n&&"Blob"in n&&function(){try{return new Blob,!0}catch{return!1}}(),o="FormData"in n,s="ArrayBuffer"in n;if(s)var a=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],c=ArrayBuffer.isView||function(e){return e&&a.indexOf(Object.prototype.toString.call(e))>-1};function l(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function u(e){return"string"!=typeof e&&(e=String(e)),e}function h(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return r&&(t[Symbol.iterator]=function(){return t}),t}function d(e){this.map={},e instanceof d?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function f(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function p(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function g(e){var t=new FileReader,n=p(t);return t.readAsArrayBuffer(e),n}function y(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function m(){return this.bodyUsed=!1,this._initBody=function(e){this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:i&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:o&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:t&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():s&&i&&function(e){return e&&DataView.prototype.isPrototypeOf(e)}(e)?(this._bodyArrayBuffer=y(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):s&&(ArrayBuffer.prototype.isPrototypeOf(e)||c(e))?this._bodyArrayBuffer=y(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},i&&(this.blob=function(){var e=f(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?f(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(g)}),this.text=function(){var e=f(this);if(e)return e;if(this._bodyBlob)return function(e){var t=new FileReader,n=p(t);return t.readAsText(e),n}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o&&(this.formData=function(){return this.text().then(w)}),this.json=function(){return this.text().then(JSON.parse)},this}d.prototype.append=function(e,t){e=l(e),t=u(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},d.prototype.delete=function(e){delete this.map[l(e)]},d.prototype.get=function(e){return e=l(e),this.has(e)?this.map[e]:null},d.prototype.has=function(e){return this.map.hasOwnProperty(l(e))},d.prototype.set=function(e,t){this.map[l(e)]=u(t)},d.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},d.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),h(e)},d.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),h(e)},d.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),h(e)},r&&(d.prototype[Symbol.iterator]=d.prototype.entries);var v=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function b(e,t){var n=(t=t||{}).body;if(e instanceof b){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new d(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,!n&&null!=e._bodyInit&&(n=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",(t.headers||!this.headers)&&(this.headers=new d(t.headers)),this.method=function(e){var t=e.toUpperCase();return v.indexOf(t)>-1?t:e}(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function w(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}})),t}function E(e){var t=new d;return e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();t.append(r,i)}})),t}function A(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new d(t.headers),this.url=t.url||"",this._initBody(e)}b.prototype.clone=function(){return new b(this,{body:this._bodyInit})},m.call(b.prototype),m.call(A.prototype),A.prototype.clone=function(){return new A(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new d(this.headers),url:this.url})},A.error=function(){var e=new A(null,{status:0,statusText:""});return e.type="error",e};var S=[301,302,303,307,308];A.redirect=function(e,t){if(-1===S.indexOf(t))throw new RangeError("Invalid status code");return new A(null,{status:t,headers:{location:e}})},e.DOMException=n.DOMException;try{new e.DOMException}catch{e.DOMException=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function _(t,n){return new Promise((function(r,o){var s=new b(t,n);if(s.signal&&s.signal.aborted)return o(new e.DOMException("Aborted","AbortError"));var a=new XMLHttpRequest;function c(){a.abort()}a.onload=function(){var e={status:a.status,statusText:a.statusText,headers:E(a.getAllResponseHeaders()||"")};e.url="responseURL"in a?a.responseURL:e.headers.get("X-Request-URL");var t="response"in a?a.response:a.responseText;r(new A(t,e))},a.onerror=function(){o(new TypeError("Network request failed"))},a.ontimeout=function(){o(new TypeError("Network request failed"))},a.onabort=function(){o(new e.DOMException("Aborted","AbortError"))},a.open(s.method,s.url,!0),"include"===s.credentials?a.withCredentials=!0:"omit"===s.credentials&&(a.withCredentials=!1),"responseType"in a&&i&&(a.responseType="blob"),s.headers.forEach((function(e,t){a.setRequestHeader(t,e)})),s.signal&&(s.signal.addEventListener("abort",c),a.onreadystatechange=function(){4===a.readyState&&s.signal.removeEventListener("abort",c)}),a.send(typeof s._bodyInit>"u"?null:s._bodyInit)}))}_.polyfill=!0,n.fetch||(n.fetch=_,n.Headers=d,n.Request=b,n.Response=A),e.Headers=d,e.Request=b,e.Response=A,e.fetch=_,Object.defineProperty(e,"__esModule",{value:!0})}({}),i.fetch.ponyfill=!0,delete i.fetch.polyfill;var o=i;(e=o.fetch).default=o.fetch,e.fetch=o.fetch,e.Headers=o.Headers,e.Request=o.Request,e.Response=o.Response,t.exports=e})),Pe=(e,t,n,r)=>{if("length"===n||"prototype"===n||"arguments"===n||"caller"===n)return;let i=Object.getOwnPropertyDescriptor(e,n),o=Object.getOwnPropertyDescriptor(t,n);!De(i,o)&&r||Object.defineProperty(e,n,o)},De=function(e,t){return void 0===e||e.configurable||e.writable===t.writable&&e.enumerable===t.enumerable&&e.configurable===t.configurable&&(e.writable||e.value===t.value)},Oe=(e,t)=>{let n=Object.getPrototypeOf(t);n!==Object.getPrototypeOf(e)&&Object.setPrototypeOf(e,n)},Ne=(e,t)=>`/* Wrapped ${e}*/\n${t}`,Be=Object.getOwnPropertyDescriptor(Function.prototype,"toString"),Le=Object.getOwnPropertyDescriptor(Function.prototype.toString,"name"),Me=(e,t,n)=>{let r=""===n?"":`with ${n.trim()}() `,i=Ne.bind(null,r,t.toString());Object.defineProperty(i,"name",Le),Object.defineProperty(e,"toString",{...Be,value:i})};var Ue=new WeakMap;var Fe=_e(Re(),1),Ke=null,je=null;function Ze(e){if(null===e)return"null";if(void 0===e)return"undefined";if(!0===e||!1===e)return"boolean";let t=typeof e;if(Ke.includes(t))return t;if("function"===t)return"Function";if(Array.isArray(e))return"Array";if(function(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}(e))return"Buffer";let n=function(e){let t=Object.prototype.toString.call(e).slice(8,-1);if(je.includes(t))return t}(e);return n||"Object"}var ze=class{constructor(e,t,n){this.major=e,this.majorEncoded=e<<5,this.name=t,this.terminal=n}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}};ze.uint=new ze(0,"uint",!0),ze.negint=new ze(1,"negint",!0),ze.bytes=new ze(2,"bytes",!0),ze.string=new ze(3,"string",!0),ze.array=new ze(4,"array",!1),ze.map=new ze(5,"map",!1),ze.tag=new ze(6,"tag",!1),ze.float=new ze(7,"float",!0),ze.false=new ze(7,"false",!0),ze.true=new ze(7,"true",!0),ze.null=new ze(7,"null",!0),ze.undefined=new ze(7,"undefined",!0),ze.break=new ze(7,"break",!0);var Ve=class{constructor(e,t,n){this.type=e,this.value=t,this.encodedLength=n,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}},He=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&"function"==typeof globalThis.Buffer.isBuffer,qe=new TextDecoder,Ge=new TextEncoder;function We(e){return He&&globalThis.Buffer.isBuffer(e)}var Qe=He?(e,t,n)=>n-t>64?globalThis.Buffer.from(e.subarray(t,n)).toString("utf8"):tt(e,t,n):(e,t,n)=>n-t>64?qe.decode(e.subarray(t,n)):tt(e,t,n),Ye=He?e=>e.length>64?globalThis.Buffer.from(e):et(e):e=>e.length>64?Ge.encode(e):et(e),Je=He?(e,t,n)=>We(e)?new Uint8Array(e.subarray(t,n)):e.slice(t,n):(e,t,n)=>e.slice(t,n),Xe=He?(e,t)=>(e=e.map((e=>e instanceof Uint8Array?e:globalThis.Buffer.from(e))),function(e){return e instanceof Uint8Array?We(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e:Uint8Array.from(e)}(globalThis.Buffer.concat(e,t))):(e,t)=>{let n=new Uint8Array(t),r=0;for(let i of e)r+i.length>n.length&&(i=i.subarray(0,n.length-r)),n.set(i,r),r+=i.length;return n},$e=He?e=>globalThis.Buffer.allocUnsafe(e):e=>new Uint8Array(e);function et(e,t=1/0){let n,r=e.length,i=null,o=[];for(let s=0;s<r;++s){if(n=e.charCodeAt(s),n>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function tt(e,t,n){let r=[];for(;t<n;){let i=e[t],o=null,s=i>239?4:i>223?3:i>191?2:1;if(t+s<=n){let n,r,a,c;switch(s){case 1:i<128&&(o=i);break;case 2:n=e[t+1],128===(192&n)&&(c=(31&i)<<6|63&n,c>127&&(o=c));break;case 3:n=e[t+1],r=e[t+2],128===(192&n)&&128===(192&r)&&(c=(15&i)<<12|(63&n)<<6|63&r,c>2047&&(c<55296||c>57343)&&(o=c));break;case 4:n=e[t+1],r=e[t+2],a=e[t+3],128===(192&n)&&128===(192&r)&&128===(192&a)&&(c=(15&i)<<18|(63&n)<<12|(63&r)<<6|63&a,c>65535&&c<1114112&&(o=c))}}null===o?(o=65533,s=1):o>65535&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|1023&o),r.push(o),t+=s}return function(e){let t=e.length;if(t<=nt)return String.fromCharCode.apply(String,e);let n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=nt));return n}(r)}var nt=4096;var rt="CBOR decode error:",it="CBOR encode error:",ot=[];function st(e,t,n){if(e.length-t<n)throw new Error(`${rt} not enough data for type`)}ot[23]=1,ot[24]=2,ot[25]=3,ot[26]=5,ot[27]=9;var at=[24,256,65536,4294967296,BigInt("18446744073709551616")];function ct(e,t,n){st(e,t,1);let r=e[t];if(!0===n.strict&&r<at[0])throw new Error(`${rt} integer encoded in more bytes than necessary (strict decode)`);return r}function lt(e,t,n){st(e,t,2);let r=e[t]<<8|e[t+1];if(!0===n.strict&&r<at[1])throw new Error(`${rt} integer encoded in more bytes than necessary (strict decode)`);return r}function ut(e,t,n){st(e,t,4);let r=16777216*e[t]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];if(!0===n.strict&&r<at[2])throw new Error(`${rt} integer encoded in more bytes than necessary (strict decode)`);return r}function ht(e,t,n){st(e,t,8);let r=16777216*e[t]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3],i=16777216*e[t+4]+(e[t+5]<<16)+(e[t+6]<<8)+e[t+7],o=(BigInt(r)<<BigInt(32))+BigInt(i);if(!0===n.strict&&o<at[3])throw new Error(`${rt} integer encoded in more bytes than necessary (strict decode)`);if(o<=Number.MAX_SAFE_INTEGER)return Number(o);if(!0===n.allowBigInt)return o;throw new Error(`${rt} integers outside of the safe integer range are not supported`)}function dt(e,t){return ft(e,0,t.value)}function ft(e,t,n){if(n<at[0]){let r=Number(n);e.push([t|r])}else if(n<at[1]){let r=Number(n);e.push([24|t,r])}else if(n<at[2]){let r=Number(n);e.push([25|t,r>>>8,255&r])}else if(n<at[3]){let r=Number(n);e.push([26|t,r>>>24&255,r>>>16&255,r>>>8&255,255&r])}else{let r=BigInt(n);if(!(r<at[4]))throw new Error(`${rt} encountered BigInt larger than allowable range`);{let n=[27|t,0,0,0,0,0,0,0],i=Number(r&BigInt(4294967295)),o=Number(r>>BigInt(32)&BigInt(4294967295));n[8]=255&i,i>>=8,n[7]=255&i,i>>=8,n[6]=255&i,i>>=8,n[5]=255&i,n[4]=255&o,o>>=8,n[3]=255&o,o>>=8,n[2]=255&o,o>>=8,n[1]=255&o,e.push(n)}}}dt.encodedSize=function(e){return ft.encodedSize(e.value)},ft.encodedSize=function(e){return e<at[0]?1:e<at[1]?2:e<at[2]?3:e<at[3]?5:9},dt.compareTokens=function(e,t){return e.value<t.value?-1:e.value>t.value?1:0};var pt=BigInt(-1),gt=BigInt(1);function yt(e,t){let n=t.value,r="bigint"==typeof n?n*pt-gt:-1*n-1;ft(e,t.type.majorEncoded,r)}function mt(e,t,n,r){st(e,t,n+r);let i=Je(e,t+n,t+n+r);return new Ve(ze.bytes,i,n+r)}function vt(e,t,n,r){return mt(e,t,1,n)}function bt(e){return void 0===e.encodedBytes&&(e.encodedBytes=e.type===ze.string?Ye(e.value):e.value),e.encodedBytes}function wt(e,t){let n=bt(t);ft(e,t.type.majorEncoded,n.length),e.push(n)}function Et(e,t,n,r,i){let o=n+r;st(e,t,o);let s=new Ve(ze.string,Qe(e,t+n,t+o),o);return!0===i.retainStringBytes&&(s.byteValue=Je(e,t+n,t+o)),s}function At(e,t,n,r){return Et(e,t,1,n,r)}yt.encodedSize=function(e){let t=e.value,n="bigint"==typeof t?t*pt-gt:-1*t-1;return n<at[0]?1:n<at[1]?2:n<at[2]?3:n<at[3]?5:9},yt.compareTokens=function(e,t){return e.value<t.value?1:e.value>t.value?-1:0},wt.encodedSize=function(e){let t=bt(e);return ft.encodedSize(t.length)+t.length},wt.compareTokens=function(e,t){return function(e,t){return e.length<t.length?-1:e.length>t.length?1:function(e,t){if(We(e)&&We(t))return e.compare(t);for(let n=0;n<e.length;n++)if(e[n]!==t[n])return e[n]<t[n]?-1:1;return 0}(e,t)}(bt(e),bt(t))};var St=wt;function _t(e,t,n,r){return new Ve(ze.array,r,n)}function It(e,t,n,r){return _t(0,0,1,n)}function Ct(e,t){ft(e,ze.array.majorEncoded,t.value)}function Tt(e,t,n,r){return new Ve(ze.map,r,n)}function kt(e,t,n,r){return Tt(0,0,1,n)}function Rt(e,t){ft(e,ze.map.majorEncoded,t.value)}function xt(e,t,n,r){return new Ve(ze.tag,n,1)}function Pt(e,t){ft(e,ze.tag.majorEncoded,t.value)}Ct.compareTokens=dt.compareTokens,Ct.encodedSize=function(e){return ft.encodedSize(e.value)},Rt.compareTokens=dt.compareTokens,Rt.encodedSize=function(e){return ft.encodedSize(e.value)},Pt.compareTokens=dt.compareTokens,Pt.encodedSize=function(e){return ft.encodedSize(e.value)};var Dt=20,Ot=21,Nt=22,Bt=23;function Lt(e,t,n){if(n){if(!1===n.allowNaN&&Number.isNaN(e))throw new Error(`${rt} NaN values are not supported`);if(!1===n.allowInfinity&&(e===1/0||e===-1/0))throw new Error(`${rt} Infinity values are not supported`)}return new Ve(ze.float,e,t)}function Mt(e,t,n){let r=t.value;if(!1===r)e.push([ze.float.majorEncoded|Dt]);else if(!0===r)e.push([ze.float.majorEncoded|Ot]);else if(null===r)e.push([ze.float.majorEncoded|Nt]);else if(void 0===r)e.push([ze.float.majorEncoded|Bt]);else{let t,i=!1;(!n||!0!==n.float64)&&(jt(r),t=Zt(Kt,1),r===t||Number.isNaN(r)?(Kt[0]=249,e.push(Kt.slice(0,3)),i=!0):(zt(r),t=Vt(Kt,1),r===t&&(Kt[0]=250,e.push(Kt.slice(0,5)),i=!0))),i||(function(e){Ft.setFloat64(0,e,!1)}(r),t=Ht(Kt,1),Kt[0]=251,e.push(Kt.slice(0,9)))}}Mt.encodedSize=function(e,t){let n=e.value;if(!1===n||!0===n||null===n||void 0===n)return 1;if(!t||!0!==t.float64){jt(n);let e=Zt(Kt,1);if(n===e||Number.isNaN(n))return 3;if(zt(n),e=Vt(Kt,1),n===e)return 5}return 9};var Ut=new ArrayBuffer(9),Ft=new DataView(Ut,1),Kt=new Uint8Array(Ut,0);function jt(e){if(e===1/0)Ft.setUint16(0,31744,!1);else if(e===-1/0)Ft.setUint16(0,64512,!1);else if(Number.isNaN(e))Ft.setUint16(0,32256,!1);else{Ft.setFloat32(0,e);let t=Ft.getUint32(0),n=(2139095040&t)>>23,r=8388607&t;if(255===n)Ft.setUint16(0,31744,!1);else if(0===n)Ft.setUint16(0,(2147483648&e)>>16|r>>13,!1);else{let e=n-127;e<-24?Ft.setUint16(0,0):e<-14?Ft.setUint16(0,(2147483648&t)>>16|1<<24+e,!1):Ft.setUint16(0,(2147483648&t)>>16|e+15<<10|r>>13,!1)}}}function Zt(e,t){if(e.length-t<2)throw new Error(`${rt} not enough data for float16`);let n=(e[t]<<8)+e[t+1];if(31744===n)return 1/0;if(64512===n)return-1/0;if(32256===n)return NaN;let r,i=n>>10&31,o=1023&n;return r=0===i?o*2**-24:31!==i?(o+1024)*2**(i-25):0===o?1/0:NaN,32768&n?-r:r}function zt(e){Ft.setFloat32(0,e,!1)}function Vt(e,t){if(e.length-t<4)throw new Error(`${rt} not enough data for float32`);let n=(e.byteOffset||0)+t;return new DataView(e.buffer,n,4).getFloat32(0,!1)}function Ht(e,t){if(e.length-t<8)throw new Error(`${rt} not enough data for float64`);let n=(e.byteOffset||0)+t;return new DataView(e.buffer,n,8).getFloat64(0,!1)}function qt(e,t,n){throw new Error(`${rt} encountered invalid minor (${n}) for major ${e[t]>>>5}`)}function Gt(e){return()=>{throw new Error(`${rt} ${e}`)}}Mt.compareTokens=dt.compareTokens;var Wt=[];for(let Ls=0;Ls<=23;Ls++)Wt[Ls]=qt;Wt[24]=function(e,t,n,r){return new Ve(ze.uint,ct(e,t+1,r),2)},Wt[25]=function(e,t,n,r){return new Ve(ze.uint,lt(e,t+1,r),3)},Wt[26]=function(e,t,n,r){return new Ve(ze.uint,ut(e,t+1,r),5)},Wt[27]=function(e,t,n,r){return new Ve(ze.uint,ht(e,t+1,r),9)},Wt[28]=qt,Wt[29]=qt,Wt[30]=qt,Wt[31]=qt;for(let Ls=32;Ls<=55;Ls++)Wt[Ls]=qt;Wt[56]=function(e,t,n,r){return new Ve(ze.negint,-1-ct(e,t+1,r),2)},Wt[57]=function(e,t,n,r){return new Ve(ze.negint,-1-lt(e,t+1,r),3)},Wt[58]=function(e,t,n,r){return new Ve(ze.negint,-1-ut(e,t+1,r),5)},Wt[59]=function(e,t,n,r){let i=ht(e,t+1,r);if("bigint"!=typeof i){let e=-1-i;if(e>=Number.MIN_SAFE_INTEGER)return new Ve(ze.negint,e,9)}if(!0!==r.allowBigInt)throw new Error(`${rt} integers outside of the safe integer range are not supported`);return new Ve(ze.negint,pt-BigInt(i),9)},Wt[60]=qt,Wt[61]=qt,Wt[62]=qt,Wt[63]=qt;for(let Ls=64;Ls<=87;Ls++)Wt[Ls]=vt;Wt[88]=function(e,t,n,r){return mt(e,t,2,ct(e,t+1,r))},Wt[89]=function(e,t,n,r){return mt(e,t,3,lt(e,t+1,r))},Wt[90]=function(e,t,n,r){return mt(e,t,5,ut(e,t+1,r))},Wt[91]=function(e,t,n,r){let i=ht(e,t+1,r);if("bigint"==typeof i)throw new Error(`${rt} 64-bit integer bytes lengths not supported`);return mt(e,t,9,i)},Wt[92]=qt,Wt[93]=qt,Wt[94]=qt,Wt[95]=Gt("indefinite length bytes/strings are not supported");for(let Ls=96;Ls<=119;Ls++)Wt[Ls]=At;Wt[120]=function(e,t,n,r){return Et(e,t,2,ct(e,t+1,r),r)},Wt[121]=function(e,t,n,r){return Et(e,t,3,lt(e,t+1,r),r)},Wt[122]=function(e,t,n,r){return Et(e,t,5,ut(e,t+1,r),r)},Wt[123]=function(e,t,n,r){let i=ht(e,t+1,r);if("bigint"==typeof i)throw new Error(`${rt} 64-bit integer string lengths not supported`);return Et(e,t,9,i,r)},Wt[124]=qt,Wt[125]=qt,Wt[126]=qt,Wt[127]=Gt("indefinite length bytes/strings are not supported");for(let Ls=128;Ls<=151;Ls++)Wt[Ls]=It;Wt[152]=function(e,t,n,r){return _t(0,0,2,ct(e,t+1,r))},Wt[153]=function(e,t,n,r){return _t(0,0,3,lt(e,t+1,r))},Wt[154]=function(e,t,n,r){return _t(0,0,5,ut(e,t+1,r))},Wt[155]=function(e,t,n,r){let i=ht(e,t+1,r);if("bigint"==typeof i)throw new Error(`${rt} 64-bit integer array lengths not supported`);return _t(0,0,9,i)},Wt[156]=qt,Wt[157]=qt,Wt[158]=qt,Wt[159]=function(e,t,n,r){if(!1===r.allowIndefinite)throw new Error(`${rt} indefinite length items not allowed`);return _t(0,0,1,1/0)};for(let Ls=160;Ls<=183;Ls++)Wt[Ls]=kt;Wt[184]=function(e,t,n,r){return Tt(0,0,2,ct(e,t+1,r))},Wt[185]=function(e,t,n,r){return Tt(0,0,3,lt(e,t+1,r))},Wt[186]=function(e,t,n,r){return Tt(0,0,5,ut(e,t+1,r))},Wt[187]=function(e,t,n,r){let i=ht(e,t+1,r);if("bigint"==typeof i)throw new Error(`${rt} 64-bit integer map lengths not supported`);return Tt(0,0,9,i)},Wt[188]=qt,Wt[189]=qt,Wt[190]=qt,Wt[191]=function(e,t,n,r){if(!1===r.allowIndefinite)throw new Error(`${rt} indefinite length items not allowed`);return Tt(0,0,1,1/0)};for(let Ls=192;Ls<=215;Ls++)Wt[Ls]=xt;Wt[216]=function(e,t,n,r){return new Ve(ze.tag,ct(e,t+1,r),2)},Wt[217]=function(e,t,n,r){return new Ve(ze.tag,lt(e,t+1,r),3)},Wt[218]=function(e,t,n,r){return new Ve(ze.tag,ut(e,t+1,r),5)},Wt[219]=function(e,t,n,r){return new Ve(ze.tag,ht(e,t+1,r),9)},Wt[220]=qt,Wt[221]=qt,Wt[222]=qt,Wt[223]=qt;for(let Ls=224;Ls<=243;Ls++)Wt[Ls]=Gt("simple values are not supported");Wt[244]=qt,Wt[245]=qt,Wt[246]=qt,Wt[247]=function(e,t,n,r){if(!1===r.allowUndefined)throw new Error(`${rt} undefined values are not supported`);return!0===r.coerceUndefinedToNull?new Ve(ze.null,null,1):new Ve(ze.undefined,void 0,1)},Wt[248]=Gt("simple values are not supported"),Wt[249]=function(e,t,n,r){return Lt(Zt(e,t+1),3,r)},Wt[250]=function(e,t,n,r){return Lt(Vt(e,t+1),5,r)},Wt[251]=function(e,t,n,r){return Lt(Ht(e,t+1),9,r)},Wt[252]=qt,Wt[253]=qt,Wt[254]=qt,Wt[255]=function(e,t,n,r){if(!1===r.allowIndefinite)throw new Error(`${rt} indefinite length items not allowed`);return new Ve(ze.break,void 0,1)};var Qt=[];for(let Ls=0;Ls<24;Ls++)Qt[Ls]=new Ve(ze.uint,Ls,1);for(let Ls=-1;Ls>=-24;Ls--)Qt[31-Ls]=new Ve(ze.negint,Ls,1);Qt[64]=new Ve(ze.bytes,new Uint8Array(0),1),Qt[96]=new Ve(ze.string,"",1),Qt[128]=new Ve(ze.array,0,1),Qt[160]=new Ve(ze.map,0,1),Qt[244]=new Ve(ze.false,!1,1),Qt[245]=new Ve(ze.true,!0,1),Qt[246]=new Ve(ze.null,null,1);(function(){let e=[];e[ze.uint.major]=dt,e[ze.negint.major]=yt,e[ze.bytes.major]=wt,e[ze.string.major]=St,e[ze.array.major]=Ct,e[ze.map.major]=Rt,e[ze.tag.major]=Pt,e[ze.float.major]=Mt})(),new class{constructor(e=256){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),null!==this._initReuseChunk&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let t=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){let n=t.length-(this.maxCursor-this.cursor)-1;t.set(e,n)}else{if(t){let e=t.length-(this.maxCursor-this.cursor)-1;e<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,e),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(t=$e(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,null===this._initReuseChunk&&(this._initReuseChunk=t),t.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let t;if(1===this.chunks.length){let n=this.chunks[0];e&&this.cursor>n.length/2?(t=this.cursor===n.length?n:n.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):t=Je(n,0,this.cursor)}else t=Xe(this.chunks,this.cursor);return e&&this.reset(),t}};var Yt=class{constructor(e,t){this.obj=e,this.parent=t}includes(e){let t=this;do{if(t.obj===e)return!0}while(t=t.parent);return!1}static createCheck(e,t){if(e&&e.includes(t))throw new Error(`${it} object contains circular references`);return new Yt(t,e)}},Jt={null:new Ve(ze.null,null),undefined:new Ve(ze.undefined,void 0),true:new Ve(ze.true,!0),false:new Ve(ze.false,!1),emptyArray:new Ve(ze.array,0),emptyMap:new Ve(ze.map,0)},Xt={number:(e,t,n,r)=>Number.isInteger(e)&&Number.isSafeInteger(e)?new Ve(e>=0?ze.uint:ze.negint,e):new Ve(ze.float,e),bigint:(e,t,n,r)=>e>=BigInt(0)?new Ve(ze.uint,e):new Ve(ze.negint,e),Uint8Array:(e,t,n,r)=>new Ve(ze.bytes,e),string:(e,t,n,r)=>new Ve(ze.string,e),boolean:(e,t,n,r)=>e?Jt.true:Jt.false,null:(e,t,n,r)=>Jt.null,undefined:(e,t,n,r)=>Jt.undefined,ArrayBuffer:(e,t,n,r)=>new Ve(ze.bytes,new Uint8Array(e)),DataView:(e,t,n,r)=>new Ve(ze.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),Array(e,t,n,r){if(!e.length)return!0===n.addBreakTokens?[Jt.emptyArray,new Ve(ze.break)]:Jt.emptyArray;r=Yt.createCheck(r,e);let i=[],o=0;for(let s of e)i[o++]=$t(s,n,r);return n.addBreakTokens?[new Ve(ze.array,e.length),i,new Ve(ze.break)]:[new Ve(ze.array,e.length),i]},Object(e,t,n,r){let i="Object"!==t,o=i?e.keys():Object.keys(e),s=i?e.size:o.length;if(!s)return!0===n.addBreakTokens?[Jt.emptyMap,new Ve(ze.break)]:Jt.emptyMap;r=Yt.createCheck(r,e);let a=[],c=0;for(let l of o)a[c++]=[$t(l,n,r),$t(i?e.get(l):e[l],n,r)];return function(e,t){t.mapSorter&&e.sort(t.mapSorter)}(a,n),n.addBreakTokens?[new Ve(ze.map,s),a,new Ve(ze.break)]:[new Ve(ze.map,s),a]}};Xt.Map=Xt.Object,Xt.Buffer=Xt.Uint8Array;for(let Ls of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))Xt[`${Ls}Array`]=Xt.DataView;function $t(e,t={},n){let r=Ze(e),i=t&&t.typeEncoders&&t.typeEncoders[r]||Xt[r];if("function"==typeof i){let o=i(e,r,t,n);if(null!=o)return o}let o=Xt[r];if(!o)throw new Error(`${it} unsupported type: ${r}`);return o(e,r,t,n)}var en={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0},tn=Symbol.for("DONE"),nn=Symbol.for("BREAK");function rn(e,t){if(e.done())return tn;let n=e.next();if(n.type===ze.break)return nn;if(n.type.terminal)return n.value;if(n.type===ze.array)return function(e,t,n){let r=[];for(let i=0;i<e.value;i++){let o=rn(t,n);if(o===nn){if(e.value===1/0)break;throw new Error(`${rt} got unexpected break to lengthed array`)}if(o===tn)throw new Error(`${rt} found array but not enough entries (got ${i}, expected ${e.value})`);r[i]=o}return r}(n,e,t);if(n.type===ze.map)return function(e,t,n){let r=!0===n.useMaps,i=r?void 0:{},o=r?new Map:void 0;for(let s=0;s<e.value;s++){let a=rn(t,n);if(a===nn){if(e.value===1/0)break;throw new Error(`${rt} got unexpected break to lengthed map`)}if(a===tn)throw new Error(`${rt} found map but not enough entries (got ${s} [no key], expected ${e.value})`);if(!0!==r&&"string"!=typeof a)throw new Error(`${rt} non-string keys not supported (got ${typeof a})`);let c=rn(t,n);if(c===tn)throw new Error(`${rt} found map but not enough entries (got ${s} [no value], expected ${e.value})`);r?o.set(a,c):i[a]=c}return r?o:i}(n,e,t);if(n.type===ze.tag){if(t.tags&&"function"==typeof t.tags[n.value]){let r=rn(e,t);return t.tags[n.value](r)}throw new Error(`${rt} tag not supported (${n.value})`)}throw new Error("unsupported")}function on(e,t){if(!(e instanceof Uint8Array))throw new Error(`${rt} data to decode must be a Uint8Array`);let n=(t=Object.assign({},en,t)).tokenizer||new class{constructor(e,t={}){this.pos=0,this.data=e,this.options=t}done(){return this.pos>=this.data.length}next(){let e=this.data[this.pos],t=Qt[e];if(void 0===t){let n=Wt[e];if(!n)throw new Error(`${rt} no decoder for major type ${e>>>5} (byte 0x${e.toString(16).padStart(2,"0")})`);let r=31&e;t=n(this.data,this.pos,r,this.options)}return this.pos+=t.encodedLength,t}}(e,t),r=rn(n,t);if(r===tn)throw new Error(`${rt} did not find any content to decode`);if(r===nn)throw new Error(`${rt} got unexpected break`);if(!n.done())throw new Error(`${rt} too many terminals, data makes no sense`);return r}var sn=function e(t,n,r){n=n||[];for(var i=r=r||0;t>=ln;)n[r++]=255&t|an,t/=128;for(;t&cn;)n[r++]=255&t|an,t>>>=7;return n[r]=0|t,e.bytes=r-i+1,n},an=128,cn=-128,ln=Math.pow(2,31);var un=function e(t,n){var r,i=0,o=0,s=n=n||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");r=t[s++],i+=o<28?(r&dn)<<o:(r&dn)*Math.pow(2,o),o+=7}while(r>=hn);return e.bytes=s-n,i},hn=128,dn=127;var fn=Math.pow(2,7),pn=Math.pow(2,14),gn=Math.pow(2,21),yn=Math.pow(2,28),mn=Math.pow(2,35),vn=Math.pow(2,42),bn=Math.pow(2,49),wn=Math.pow(2,56),En=Math.pow(2,63),An={encode:sn,decode:un,encodingLength:function(e){return e<fn?1:e<pn?2:e<gn?3:e<yn?4:e<mn?5:e<vn?6:e<bn?7:e<wn?8:e<En?9:10}},Sn=(e,t=0)=>[An.decode(e,t),An.decode.bytes],_n=(e,t,n=0)=>(An.encode(e,t,n),t),In=e=>An.encodingLength(e),Cn=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}),Tn=class{constructor(e,t,n,r){this.code=e,this.size=t,this.digest=n,this.bytes=r}};var kn=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==n[s])throw new TypeError(o+" is ambiguous");n[s]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var r=0,i=0;e[t]===c;)r++,t++;for(var o=(e.length-t)*l+1>>>0,s=new Uint8Array(o);e[t];){var u=n[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=o-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*s[d]>>>0,s[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=o-i;f!==o&&0===s[f];)f++;for(var p=new Uint8Array(r+(o-f)),g=r;f!==o;)p[g++]=s[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,o=t.length;i!==o&&0===t[i];)i++,n++;for(var s=(o-i)*u+1>>>0,l=new Uint8Array(s);i!==o;){for(var h=t[i],d=0,f=s-1;(0!==h||d<r)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");r=d,i++}for(var p=s-r;p!==s&&0===l[p];)p++;for(var g=c.repeat(n);p<s;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:h,decode:function(e){var n=h(e);if(n)return n;throw new Error(`Non-${t} character`)}}},Rn=(e,t)=>new class{constructor(e){this.decoders=e}or(e){return Rn(this,e)}decode(e){let t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}}),xn=({name:e,prefix:t,encode:n,decode:r})=>new class{constructor(e,t,n,r){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=r,this.encoder=new class{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}(e,t,n),this.decoder=new class{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return Rn(this,e)}}(e,t,r)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}(e,t,n,r),Pn=({prefix:e,name:t,alphabet:n})=>{let{encode:r,decode:i}=kn(n,t);return xn({prefix:e,name:t,encode:r,decode:e=>Cn(i(e))})},Dn=({name:e,prefix:t,bitsPerChar:n,alphabet:r})=>xn({prefix:t,name:e,encode:e=>((e,t,n)=>{let r="="===t[t.length-1],i=(1<<n)-1,o="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>n;)s-=n,o+=t[i&a>>s];if(s&&(o+=t[i&a<<n-s]),r)for(;o.length*n&7;)o+="=";return o})(e,r,n),decode:t=>((e,t,n,r)=>{let i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let o=e.length;for(;"="===e[o-1];)--o;let s=new Uint8Array(o*n/8|0),a=0,c=0,l=0;for(let u=0;u<o;++u){let t=i[e[u]];if(void 0===t)throw new SyntaxError(`Non-${r} character`);c=c<<n|t,a+=n,a>=8&&(a-=8,s[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s})(t,r,n,e)}),On=Pn({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Nn=(Pn({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Dn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5})),Bn=(Dn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Dn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Dn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Dn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Dn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Dn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Dn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Dn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),class{constructor(e,t,n,r){this.code=t,this.version=e,this.multihash=n,this.bytes=r,this.byteOffset=r.byteOffset,this.byteLength=r.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:Vn,byteLength:Vn,code:zn,version:zn,multihash:zn,bytes:zn,_baseCache:Vn,asCID:Vn})}toV0(){if(0===this.version)return this;{let{code:e,multihash:t}=this;if(e!==Fn)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==Kn)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Bn.createV0(t)}}toV1(){switch(this.version){case 0:{let{code:e,digest:t}=this.multihash,n=((e,t)=>{let n=t.byteLength,r=In(e),i=r+In(n),o=new Uint8Array(i+n);return _n(e,o,0),_n(n,o,r),o.set(t,i),new Tn(e,n,t,o)})(e,t);return Bn.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&((e,t)=>e===t||e.code===t.code&&e.size===t.size&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0})(e.bytes,t.bytes))(this.multihash,e.multihash)}toString(e){let{bytes:t,version:n,_baseCache:r}=this;return 0===n?Mn(t,r,e||On.encoder):Un(t,r,e||Nn.encoder)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return Hn(/^0\.0/,qn),!(!e||!e[Zn]&&e.asCID!==e)}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof Bn)return e;if(null!=e&&e.asCID===e){let{version:t,code:n,multihash:r,bytes:i}=e;return new Bn(t,n,r,i||jn(t,n,r.bytes))}if(null!=e&&!0===e[Zn]){let{version:t,multihash:n,code:r}=e,i=(e=>{let t=Cn(e),[n,r]=Sn(t),[i,o]=Sn(t.subarray(r)),s=t.subarray(r+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new Tn(n,i,s,t)})(n);return Bn.create(t,r,i)}return null}static create(e,t,n){if("number"!=typeof t)throw new Error("String codecs are no longer supported");switch(e){case 0:if(t!==Fn)throw new Error(`Version 0 CID must use dag-pb (code: ${Fn}) block encoding`);return new Bn(e,t,n,n.bytes);case 1:{let r=jn(e,t,n.bytes);return new Bn(e,t,n,r)}default:throw new Error("Invalid version")}}static createV0(e){return Bn.create(0,Fn,e)}static createV1(e,t){return Bn.create(1,e,t)}static decode(e){let[t,n]=Bn.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){let t=Bn.inspectBytes(e),n=t.size-t.multihashSize,r=Cn(e.subarray(n,n+t.multihashSize));if(r.byteLength!==t.multihashSize)throw new Error("Incorrect length");let i=r.subarray(t.multihashSize-t.digestSize),o=new Tn(t.multihashCode,t.digestSize,i,r);return[0===t.version?Bn.createV0(o):Bn.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0,n=()=>{let[n,r]=Sn(e.subarray(t));return t+=r,n},r=n(),i=Fn;if(18===r?(r=0,t=0):1===r&&(i=n()),0!==r&&1!==r)throw new RangeError(`Invalid CID version ${r}`);let o=t,s=n(),a=n(),c=t+a;return{version:r,codec:i,multihashCode:s,digestSize:a,multihashSize:c-o,size:c}}static parse(e,t){let[n,r]=Ln(e,t),i=Bn.decode(r);return i._baseCache.set(n,e),i}}),Ln=(e,t)=>{switch(e[0]){case"Q":{let n=t||On;return[On.prefix,n.decode(`${On.prefix}${e}`)]}case On.prefix:{let n=t||On;return[On.prefix,n.decode(e)]}case Nn.prefix:{let n=t||Nn;return[Nn.prefix,n.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},Mn=(e,t,n)=>{let{prefix:r}=n;if(r!==On.prefix)throw Error(`Cannot string encode V0 in ${n.name} encoding`);let i=t.get(r);if(null==i){let i=n.encode(e).slice(1);return t.set(r,i),i}return i},Un=(e,t,n)=>{let{prefix:r}=n,i=t.get(r);if(null==i){let i=n.encode(e);return t.set(r,i),i}return i},Fn=112,Kn=18,jn=(e,t,n)=>{let r=In(e),i=r+In(t),o=new Uint8Array(i+n.byteLength);return _n(e,o,0),_n(t,o,r),o.set(n,i),o},Zn=Symbol.for("@ipld/js-cid/CID"),zn={writable:!1,configurable:!1,enumerable:!0},Vn={writable:!1,enumerable:!1,configurable:!1},Hn=(e,t)=>{if(!e.test("0.0.0-dev"))throw new Error(t);console.warn(t)},qn="CID.isCID(v) is deprecated and will be removed in the next major release.\nFollowing code pattern:\n\nif (CID.isCID(value)) {\n  doSomethingWithCID(value)\n}\n\nIs replaced with:\n\nconst cid = CID.asCID(value)\nif (cid) {\n  // Make sure to use cid instead of value\n  doSomethingWithCID(cid)\n}\n";var Gn={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};Gn.tags[42]=function(e){if(0!==e[0])throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return Bn.decode(e.subarray(1))};var Wn=e=>on(e,Gn);var Qn=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==n[s])throw new TypeError(o+" is ambiguous");n[s]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var r=0,i=0;e[t]===c;)r++,t++;for(var o=(e.length-t)*l+1>>>0,s=new Uint8Array(o);e[t];){var u=n[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=o-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*s[d]>>>0,s[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=o-i;f!==o&&0===s[f];)f++;for(var p=new Uint8Array(r+(o-f)),g=r;f!==o;)p[g++]=s[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,o=t.length;i!==o&&0===t[i];)i++,n++;for(var s=(o-i)*u+1>>>0,l=new Uint8Array(s);i!==o;){for(var h=t[i],d=0,f=s-1;(0!==h||d<r)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");r=d,i++}for(var p=s-r;p!==s&&0===l[p];)p++;for(var g=c.repeat(n);p<s;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:h,decode:function(e){var n=h(e);if(n)return n;throw new Error(`Non-${t} character`)}}},Yn=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}),Jn=(e,t)=>new class{constructor(e){this.decoders=e}or(e){return Jn(this,e)}decode(e){let t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}}),Xn=({name:e,prefix:t,encode:n,decode:r})=>new class{constructor(e,t,n,r){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=r,this.encoder=new class{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}(e,t,n),this.decoder=new class{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return Jn(this,e)}}(e,t,r)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}(e,t,n,r),$n=({prefix:e,name:t,alphabet:n})=>{let{encode:r,decode:i}=Qn(n,t);return Xn({prefix:e,name:t,encode:r,decode:e=>Yn(i(e))})},er=({name:e,prefix:t,bitsPerChar:n,alphabet:r})=>Xn({prefix:t,name:e,encode:e=>((e,t,n)=>{let r="="===t[t.length-1],i=(1<<n)-1,o="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>n;)s-=n,o+=t[i&a>>s];if(s&&(o+=t[i&a<<n-s]),r)for(;o.length*n&7;)o+="=";return o})(e,r,n),decode:t=>((e,t,n,r)=>{let i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let o=e.length;for(;"="===e[o-1];)--o;let s=new Uint8Array(o*n/8|0),a=0,c=0,l=0;for(let u=0;u<o;++u){let t=i[e[u]];if(void 0===t)throw new SyntaxError(`Non-${r} character`);c=c<<n|t,a+=n,a>=8&&(a-=8,s[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s})(t,r,n,e)}),tr=er({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),nr=(er({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),er({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),er({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),er({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),er({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),er({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),er({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),er({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),$n({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"})),rr=($n({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),function e(t,n,r){n=n||[];for(var i=r=r||0;t>=sr;)n[r++]=255&t|ir,t/=128;for(;t&or;)n[r++]=255&t|ir,t>>>=7;return n[r]=0|t,e.bytes=r-i+1,n}),ir=128,or=-128,sr=Math.pow(2,31);var ar=function e(t,n){var r,i=0,o=0,s=n=n||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");r=t[s++],i+=o<28?(r&lr)<<o:(r&lr)*Math.pow(2,o),o+=7}while(r>=cr);return e.bytes=s-n,i},cr=128,lr=127;var ur=Math.pow(2,7),hr=Math.pow(2,14),dr=Math.pow(2,21),fr=Math.pow(2,28),pr=Math.pow(2,35),gr=Math.pow(2,42),yr=Math.pow(2,49),mr=Math.pow(2,56),vr=Math.pow(2,63),br={encode:rr,decode:ar,encodingLength:function(e){return e<ur?1:e<hr?2:e<dr?3:e<fr?4:e<pr?5:e<gr?6:e<yr?7:e<mr?8:e<vr?9:10}},wr=(e,t=0)=>[br.decode(e,t),br.decode.bytes],Er=(e,t,n=0)=>(br.encode(e,t,n),t),Ar=e=>br.encodingLength(e),Sr=class{constructor(e,t,n,r){this.code=e,this.size=t,this.digest=n,this.bytes=r}},_r=(e,t)=>{let{bytes:n,version:r}=e;return 0===r?Rr(n,Cr(e),t||nr.encoder):xr(n,Cr(e),t||tr.encoder)},Ir=new WeakMap,Cr=e=>{let t=Ir.get(e);if(null==t){let t=new Map;return Ir.set(e,t),t}return t},Tr=class{constructor(e,t,n,r){this.code=t,this.version=e,this.multihash=n,this.bytes=r,this["/"]=r}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:t}=this;if(e!==Pr)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==Dr)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Tr.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:t}=this.multihash,n=((e,t)=>{let n=t.byteLength,r=Ar(e),i=r+Ar(n),o=new Uint8Array(i+n);return Er(e,o,0),Er(n,o,r),o.set(t,i),new Sr(e,n,t,o)})(e,t);return Tr.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Tr.equals(this,e)}static equals(e,t){let n=t;return n&&e.code===n.code&&e.version===n.version&&((e,t)=>{if(e===t)return!0;{let n=t;return e.code===n.code&&e.size===n.size&&n.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0})(e.bytes,n.bytes)}})(e.multihash,n.multihash)}toString(e){return _r(this,e)}toJSON(){return{"/":_r(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;let t=e;if(t instanceof Tr)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){let{version:e,code:n,multihash:r,bytes:i}=t;return new Tr(e,n,r,i||Or(e,n,r.bytes))}if(!0===t[Nr]){let{version:e,multihash:n,code:r}=t,i=(e=>{let t=Yn(e),[n,r]=wr(t),[i,o]=wr(t.subarray(r)),s=t.subarray(r+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new Sr(n,i,s,t)})(n);return Tr.create(e,r,i)}return null}static create(e,t,n){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==Pr)throw new Error(`Version 0 CID must use dag-pb (code: ${Pr}) block encoding`);return new Tr(e,t,n,n.bytes);case 1:{let r=Or(e,t,n.bytes);return new Tr(e,t,n,r)}default:throw new Error("Invalid version")}}static createV0(e){return Tr.create(0,Pr,e)}static createV1(e,t){return Tr.create(1,e,t)}static decode(e){let[t,n]=Tr.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){let t=Tr.inspectBytes(e),n=t.size-t.multihashSize,r=Yn(e.subarray(n,n+t.multihashSize));if(r.byteLength!==t.multihashSize)throw new Error("Incorrect length");let i=r.subarray(t.multihashSize-t.digestSize),o=new Sr(t.multihashCode,t.digestSize,i,r);return[0===t.version?Tr.createV0(o):Tr.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0,n=()=>{let[n,r]=wr(e.subarray(t));return t+=r,n},r=n(),i=Pr;if(18===r?(r=0,t=0):i=n(),0!==r&&1!==r)throw new RangeError(`Invalid CID version ${r}`);let o=t,s=n(),a=n(),c=t+a;return{version:r,codec:i,multihashCode:s,digestSize:a,multihashSize:c-o,size:c}}static parse(e,t){let[n,r]=kr(e,t),i=Tr.decode(r);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return Cr(i).set(n,e),i}},kr=(e,t)=>{switch(e[0]){case"Q":{let n=t||nr;return[nr.prefix,n.decode(`${nr.prefix}${e}`)]}case nr.prefix:{let n=t||nr;return[nr.prefix,n.decode(e)]}case tr.prefix:{let n=t||tr;return[tr.prefix,n.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},Rr=(e,t,n)=>{let{prefix:r}=n;if(r!==nr.prefix)throw Error(`Cannot string encode V0 in ${n.name} encoding`);let i=t.get(r);if(null==i){let i=n.encode(e).slice(1);return t.set(r,i),i}return i},xr=(e,t,n)=>{let{prefix:r}=n,i=t.get(r);if(null==i){let i=n.encode(e);return t.set(r,i),i}return i},Pr=112,Dr=18,Or=(e,t,n)=>{let r=Ar(e),i=r+Ar(t),o=new Uint8Array(i+n.byteLength);return Er(e,o,0),Er(t,o,r),o.set(n,i),o},Nr=Symbol.for("@ipld/js-cid/CID"),Br=_e(xe(),1),Lr="Earth";var Mr=Tr.parse("bafyreif3tfdpr5n4jdrbielmcapwvbpcthepfkwq2vwonmlhirbjmotedi"),Ur=["https://ipfs.io","https://dweb.link"];async function Fr(e,t,n=1){try{let n=await async function(e,t){if("function"==typeof e)return e(t);if("function"==typeof e?.block?.get)return e.block.get(t);let n=Array.isArray(e)?e:[e];for(let i of n){let e=new URL(i);e.pathname=`/ipfs/${t.toString()}`,e.search="?format=raw";try{let t=await(0,Br.default)(e,{headers:{Accept:"application/vnd.ipld.raw"},cache:"force-cache"});if(!t.ok)throw t;return new Uint8Array(await t.arrayBuffer())}catch(r){throw new Error(`unable to fetch raw block for CID ${t}`,{cause:r})}}}(e,t);return{obj:await Wn(n),block:n}}catch(r){if(n<3)return await Fr(e,t,n+1);throw r}}var Kr=function(e,{cacheKey:t=(([e])=>e),cache:n=new Map}={}){let r=new Map,i=function(...i){let o=t(i);if(r.has(o))return r.get(o);let s=(async()=>{try{if(n&&await n.has(o))return await n.get(o);let t=await e.apply(this,i);try{return t}finally{n&&await n.set(o,t)}}finally{r.delete(o)}})();return r.set(o,s),s};return function(e,t,{ignoreNonConfigurable:n=!1}={}){let{name:r}=e;for(let i of Reflect.ownKeys(t))Pe(e,t,i,n);Oe(e,t),Me(e,t,r)}(i,e,{ignoreNonConfigurable:!0}),Ue.set(i,n),i}((async function(e,t,n){let r,i;try{({obj:r,block:i}=await Fr(e,t))}catch(s){throw({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_GIT_REV:"9c10520",REACT_APP_VERSION:"4.2.1"}?.DEBUG||{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_GIT_REV:"9c10520",REACT_APP_VERSION:"4.2.1"}?.TEST)&&console.error(i?`[ipfs-geoip] failed to parse DAG-CBOR behind CID '${t}'`:`[ipfs-geoip] failed to get raw block for CID '${t}'`,s),s}let o=0;if(!("data"in r)){for(;r.mins[o]&&r.mins[o]<=n;)o++;let t=r.links[o-1];if(!t)throw new Error("Failed to lookup node");let i=function(e){return e?Tr.asCID(e):null}(t);if(!i)throw new Error("Failed to lookup node");return Kr(e,i,n)}if("data"in r){for(;r.data[o]&&r.data[o].min<=n;)o++;let e=r.data[o-1];if(!e)throw new Error("Failed to lookup leaf node");if(!e.data)throw new Error("Unmapped range");return function(e){return{country_name:e[0],country_code:e[1],region_code:e[2],city:e[3],postal_code:e[4],latitude:e[5],longitude:e[6],planet:Lr}}(e.data)}}),{cachePromiseRejection:!1,cacheKey:e=>{let[,t,n]=e;return`${t}.${n}`}});function jr(e=Ur,t){return Kr(e,Mr,Fe.default.toLong(t))}var Zr=__webpack_require__(68702),zr=__webpack_require__(34737),Vr=__webpack_require__.n(zr),Hr=__webpack_require__(59496),qr=__webpack_require__.n(Hr),Gr=__webpack_require__(23596),Wr=__webpack_require__.n(Gr),Qr=__webpack_require__(4147);const{dependencies:Yr}=Qr,Jr=J().seconds(1),Xr=Yr["ipfs-geoip"];const $r=e=>4===e[0]&&"127.0.0.1"!==e[1],ei=e=>{if(!e)return null;const{country_name:t,city:n}=e;return n&&t?"".concat(t,", ").concat(n):t},ti=e=>e.protoNames().join(" \u2022 "),ni=e=>{if("n/a"===e)return;let t=parseInt(e);return t="s"===/(s|ms)/.exec(e)[0]?1e3*t:t,t},ri=Wr()((e=>{if(e)for(const n of e.addresses)try{const e=(0,ne.HM)(n).nodeAddress();if((qr().isV4Format(e.address)||qr().isV6Format(e.address))&&!qr().isPrivate(e.address))return e.address}catch(t){}})),ii=async(e,t)=>{const n=await ri(t);let r,i=!1,o=!1;try{r=e.nodeAddress()}catch(s){return{isPrivate:i,isNearby:o}}return i=qr().isPrivate(r.address),n&&(qr().isV4Format(r.address)?o=qr().cidrSubnet("".concat(n,"/24")).contains(r.address):qr().isV6Format(r.address)&&(o=qr().cidrSubnet("".concat(n,"/48")).contains(r.address)&&!qr().cidrSubnet("fc00::/8").contains(r.address))),{isPrivate:i,isNearby:o}};class oi{constructor(e){this.geoipCache=ye({name:"geoipCache",version:Xr,maxAge:J().weeks(1),...e.cache}),this.failedAddrs=Vr()(500),this.queue=new Zr.Z({concurrency:e.concurrency,autoStart:!0}),this.geoipLookupPromises=new Map,this.pass=0}async findLocations(e,t){const n={};for(const r of this.optimizedPeerSet(t)){const t=r.peer,i=r.addr.stringTuples().find($r);if(!i)continue;const o=i[1];if(this.failedAddrs.has(o))continue;const s=await this.geoipCache.get(o);s?n[t]=s:this.geoipLookupPromises.has(o)||this.geoipLookupPromises.set(o,this.queue.add((async()=>{try{const t=await jr(e,o);await this.geoipCache.set(o,t)}catch(t){this.failedAddrs.set(o,!0)}finally{this.geoipLookupPromises.delete(o)}})))}return n}optimizedPeerSet(e){if(this.pass<3){const t=e=>ni(e.latency)||9999,n=e.concat().sort(((e,n)=>t(e)-t(n)));switch(this.pass=this.pass+1,this.pass-1){case 0:return n.slice(0,10);case 1:return n.slice(0,100);default:return n.slice(0,200)}}return e}}const si=function(e){(e=e||{}).concurrency=e.concurrency||4,e.cache=e.cache||{};const t=new oi(e),n=(0,z.Jc)({name:"peerLocations",actionBaseType:"PEER_LOCATIONS",getPromise:e=>{let{store:n}=e;return t.findLocations(n.selectAvailableGatewayUrl(),n.selectPeers())},staleAfter:Jr,retryAfter:Jr,persist:!1,checkIfOnline:!1});return n.reactPeerLocationsFetch=(0,z.P1)("selectRouteInfo","selectPeerLocationsShouldUpdate","selectIpfsConnected",((e,t,n)=>{if("/peers"===e.url&&t&&n)return{actionCreator:"doFetchPeerLocations"}})),n.selectPeerLocationsForSwarm=(0,z.P1)("selectPeers","selectPeerLocations","selectBootstrapPeers","selectIdentity",(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>3?arguments[3]:void 0;return e&&Promise.all(e.map((async e=>{const r=e.peer,i=t?t[r]:null,o=ei(i),s=i&&i.country_code,a=i&&[i.longitude,i.latitude],c=ti(e.addr),l=e.addr.toString(),u=ni(e.latency),h=e.direction,{isPrivate:d,isNearby:f}=await ii(e.addr,n);return{peerId:r,location:o,flagCode:s,coordinates:a,connection:c,address:l,protocols:(Array.isArray(e.streams)?Array.from(new Set(e.streams.map((e=>e.Protocol)).map((e=>null!==e&&void 0!==e&&e.trim()?e:"[unnamed]")))).sort():[]).join(", "),direction:h,latency:u,isPrivate:d,isNearby:f}})))})),n.selectPeersCoordinates=(0,z.P1)("selectPeerLocationsForSwarm",(async e=>{if(!e)return[];return(await e).reduce(((e,t)=>{let{peerId:n,coordinates:r}=t;if(!r)return e;let i=!1;const o=e.map((e=>{if(!e||i)return e;const[t,o]=e.coordinates,[s,a]=r;return t-4<=s&&t+4>=s&&(o-4<=a&&o+4>=a)&&(e.peerIds.push(n),i=!0),e}));return i?o:[...o,{peerIds:[n],coordinates:r}]}),[])})),n};var ai=__webpack_require__(76290),ci=__webpack_require__(47652),li=__webpack_require__(50464),ui=__webpack_require__.n(li),hi=__webpack_require__(11044);const di=e=>e.split(":").at(-1),fi=e=>[...new Set(e)],pi=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>t.every((t=>!t.some((t=>t===e))))},gi=(e,t)=>{if(e.length!==t.length)return t;return e.filter((e=>!t.includes(e))).length>0?t:e},yi=async(e,t,n)=>{var r,i,o;const s=t.find((t=>e.endpoint.toString()===t.apiEndpoint.toString())),a=null===s||void 0===s?void 0:s.icon,c=null===s||void 0===s?void 0:s.visitServiceUrl,l={...e,name:e.service,icon:a,visitServiceUrl:c};if("invalid"===(null===e||void 0===e||null===(r=e.stat)||void 0===r?void 0:r.status))return{...l,numberOfPins:-1,online:!1};const u=null===(i=e.stat)||void 0===i||null===(o=i.pinCount)||void 0===o?void 0:o.pinned,h="number"===typeof u,d=h?await mi(e.service,n):void 0;return{...l,numberOfPins:u,online:h,autoUpload:d}},mi=Wr()((async(e,t)=>{try{return await t.config.get("Pinning.RemoteServices.".concat(e,".Policies.MFS.Enable"))}catch(r){var n;if(null!==(n=r.message)&&void 0!==n&&n.includes("key has no attribute"))try{return await t.config.get('Pinning.RemoteServices["'.concat(e,'"].Policies.MFS.Enable'))}catch(i){}console.error('unexpected config.get error for "'.concat(e,'": ').concat(r.message))}return!1}),{maxAge:3e3}),vi=(e,t)=>{const n=(0,hi.g)("remotesServicesBackoffs")||{},{service:r}=t,{lastTry:i,tryAfter:o}=n[r]||{lastTry:0,tryAfter:3e4};if(i+o>(new Date).getTime())throw new Error("still within back-off period");try{return e.pin.remote.ls(t)}catch(s){throw s.toString().includes("429 Too Many Requests")&&(n[r]={lastTry:(new Date).getTime(),tryAfter:3*o},(0,hi.D)("remotesServicesBackoffs",n)),s}},bi={name:"pinning",persistActions:["UPDATE_REMOTE_PINS","DISMISS_REMOTE_PINS","CANCEL_PENDING_PINS"],init:e=>{(e=>{const t=setInterval((()=>{e.selectIpfsReady()&&(clearTimeout(t),e.selectPendingPins().forEach((t=>{var n;const[r,i]=t.split(":");e.doSetPinning({cid:null!==(n=ci.k0.asCID(i))&&void 0!==n?n:ci.k0.parse(i)},[r],!1)})))}),1e3)})(e),(e=>{setInterval((()=>{const t=[...e.selectPendingPins(),...e.selectFailedPins()].map((e=>({cid:e.split(":")[1]})));e.doFetchRemotePins(t,!0)}),3e4)})(e)},reducer:(e,t)=>{var n,r,i,o,s,a,c,l,u;if("UPDATE_REMOTE_PINS"===t.type){const{adds:n=[],removals:r=[],pending:i=[],failed:o=[]}=t.payload,s=gi(e.remotePins,fi([...e.remotePins,...n].filter(pi(r,i,o)))),a=gi(e.notRemotePins,fi([...e.notRemotePins,...r].filter(pi(n,i,o)))),c=gi(e.pendingPins,fi([...e.pendingPins,...i].filter(pi(n,r,o)))),l=gi(e.failedPins,fi([...e.failedPins,...o].filter(pi(n,r,i)))),u=gi(e.completedPins,fi([...e.completedPins,...n].filter((t=>e.pendingPins.some((e=>e===t))))));return{...e,remotePins:s,notRemotePins:a,pendingPins:c,failedPins:l,completedPins:u}}if("DISMISS_REMOTE_PINS"===t.type){const{failed:n=[],completed:r=[]}=t.payload,i=e.failedPins.filter(pi(n)),o=e.completedPins.filter(pi(r));return{...e,failedPins:i,completedPins:o}}if("SET_LOCAL_PINS_STATS"===t.type){const{localPinsSize:n,localNumberOfPins:r}=t.payload;return{...e,localNumberOfPins:r,localPinsSize:n}}if("SET_REMOTE_PINNING_SERVICES"===t.type){const n=e.pinningServices,r=t.payload;if((null===n||void 0===n?void 0:n.length)===(null===r||void 0===r?void 0:r.length)){const t=e=>e&&"undefined"!==typeof e.numberOfPins,i=n.some(t),o=r.some(t);if(i&&!o)return e}return{...e,pinningServices:r}}return"SET_REMOTE_PINNING_SERVICES_AVAILABLE"===t.type?{...e,arePinningServicesSupported:t.payload}:{...e,pinningServices:null!==(n=null===e||void 0===e?void 0:e.pinningServices)&&void 0!==n?n:[],remotePins:null!==(r=null===e||void 0===e?void 0:e.remotePins)&&void 0!==r?r:[],pendingPins:null!==(i=null===e||void 0===e?void 0:e.pendingPins)&&void 0!==i?i:[],failedPins:null!==(o=null===e||void 0===e?void 0:e.failedPins)&&void 0!==o?o:[],completedPins:null!==(s=null===e||void 0===e?void 0:e.completedPins)&&void 0!==s?s:[],notRemotePins:null!==(a=null===e||void 0===e?void 0:e.notRemotePins)&&void 0!==a?a:[],localPinsSize:null!==(c=null===e||void 0===e?void 0:e.localPinsSize)&&void 0!==c?c:0,localNumberOfPins:null!==(l=null===e||void 0===e?void 0:e.localNumberOfPins)&&void 0!==l?l:0,arePinningServicesSupported:null!==(u=null===e||void 0===e?void 0:e.arePinningServicesSupported)&&void 0!==u&&u}},doFetchRemotePins:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return async n=>{var r,i;let{dispatch:o,store:s,getIpfs:a}=n;const c=s.selectPinningServices();if(null===c||void 0===c||!c.length)return;const l=a();if(!l||null!==s&&void 0!==s&&null!==(r=s.ipfs)&&void 0!==r&&null!==(i=r.ipfs)&&void 0!==i&&i.ready||!l.pin.remote)return;const u=e?e.map((e=>e.cid.toString())):[],h=s.selectRemotePins(),d=s.selectNotRemotePins(),f=((e,t)=>{const n=[...new Set(e)],r=[];for(let i=0;i<n.length;i+=t){const e=n.slice(i,i+t);r.push(e)}return r})(u,10),p=[],g=[],y=[],m=[];await Promise.allSettled(c.map((async e=>{try{const r=t?new Set:new Set([...h,...d].filter((t=>t.startsWith(e.name))).map(di));for(const t of f){const i=t.filter((e=>!r.has(e.toString())));if(!i.length)continue;const o=new Set(i.map((e=>e.toString())));try{const t=vi(l,{service:e.name,cid:i.map((e=>{var t;return null!==(t=ci.k0.asCID(e))&&void 0!==t?t:ci.k0.parse(e)})),status:["queued","pinning","pinned","failed"]});for await(const n of t){const t=n.cid.toString();o.delete(t),"queued"===n.status||"pinning"===n.status?m.push("".concat(e.name,":").concat(t)):"failed"===n.status?y.push("".concat(e.name,":").concat(t)):p.push("".concat(e.name,":").concat(t))}}catch(n){console.error("Error: pin.remote.ls service=".concat(e.name," cid=").concat(i,": ").concat(n.toString()))}for(const t of o)g.push("".concat(e.name,":").concat(t))}}catch(n){console.error("unexpected error during doFetchRemotePins",n)}}))),o({type:"UPDATE_REMOTE_PINS",payload:{adds:p,removals:g,pending:m,failed:y}})}},selectRemotePins:e=>e.pinning.remotePins||[],selectNotRemotePins:e=>e.pinning.notRemotePins||[],selectPendingPins:e=>e.pinning.pendingPins||[],selectFailedPins:e=>e.pinning.failedPins||[],selectCompletedPins:e=>e.pinning.completedPins||[],selectLocalPinsSize:e=>e.pinning.localPinsSize,selectLocalNumberOfPins:e=>e.pinning.localNumberOfPins,doSelectRemotePinsForFile:e=>t=>{let{store:n}=t;const r=n.selectPinningServices().map((e=>e.name));return fi([...n.selectPendingPins(),...n.selectRemotePins()]).filter((t=>di(t)===e.cid.toString())).map((e=>e.split(":").at(0))).filter((e=>r.includes(e)))},doFetchLocalPinsStats:()=>async e=>{let{getIpfs:t,dispatch:n}=e;const r=t();if(!r)return null;n({type:"SET_LOCAL_PINS_STATS",payload:{localPinsSize:-1,localNumberOfPins:(await ui()(r.pin.ls({type:"recursive"}))).length}})},doFetchPinningServices:()=>async e=>{var t,n;let{getIpfs:r,store:i,dispatch:o}=e;const s=r();if(!s||null!==i&&void 0!==i&&null!==(t=i.ipfs)&&void 0!==t&&null!==(n=t.ipfs)&&void 0!==n&&n.ready||!s.pin.remote)return null;const a=(await s.commands()).Subcommands.find((e=>"pin"===e.Name)).Subcommands.some((e=>"remote"===e.Name));if(o({type:"SET_REMOTE_PINNING_SERVICES_AVAILABLE",payload:a}),!a)return null;const c=i.selectRemoteServiceTemplates(),l=await s.pin.remote.service.ls();o({type:"SET_REMOTE_PINNING_SERVICES",payload:await Promise.all(l.map((e=>yi(e,c,s))))})},doFetchPinningServicesStats:()=>async e=>{var t,n;let{getIpfs:r,store:i,dispatch:o}=e;const s=r();if(!s||null!==i&&void 0!==i&&null!==(t=i.ipfs)&&void 0!==t&&null!==(n=t.ipfs)&&void 0!==n&&n.ready||!s.pin.remote)return null;if(!(await s.commands()).Subcommands.find((e=>"pin"===e.Name)).Subcommands.some((e=>"remote"===e.Name)))return null;const a=i.selectRemoteServiceTemplates(),c=await s.pin.remote.service.ls({stat:!0});o({type:"SET_REMOTE_PINNING_SERVICES",payload:await Promise.all(c.map((e=>yi(e,a,s))))})},selectPinningServices:e=>e.pinning.pinningServices||[],selectRemoteServiceTemplates:()=>ai.X,selectArePinningServicesSupported:e=>e.pinning.arePinningServicesSupported,selectPinningServicesDefaults:()=>ai.X.reduce(((e,t)=>({...e,[t.name]:{...t,nickname:t.name}})),{}),doDismissCompletedPin:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return async e=>{let{dispatch:n}=e;n({type:"DISMISS_REMOTE_PINS",payload:{completed:t}})}},doDismissFailedPin:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return async e=>{let{dispatch:n}=e;n({type:"DISMISS_REMOTE_PINS",payload:{failed:t}})}},doCancelPendingPin:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return async e=>{let{getIpfs:n,dispatch:r}=e;const i=n();for(const s of t){var o;const[e,t]=s.split(":");await i.pin.remote.rm({cid:[null!==(o=ci.k0.asCID(t))&&void 0!==o?o:ci.k0.parse(t)],service:e})}r({type:"UPDATE_REMOTE_PINS",payload:{removals:t}})}},doSetPinning:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return async i=>{let{getIpfs:o,store:s,dispatch:a}=i;const c=o(),{cid:l,name:u}=e,h=t.includes("local");if(n!==h)try{const e={serviceName:"Local node"};h?(await c.pin.add(l),a({type:"IPFS_PIN_SUCCEED",msgArgs:e})):(await c.pin.rm(l),a({type:"IPFS_UNPIN_SUCCEED",msgArgs:e}))}catch(g){console.error("unexpected local pin error for ".concat(l," (").concat(u,")"),g);const e={serviceName:"local",errorMsg:g.toString()};a({type:"IPFS_PIN_FAILED",msgArgs:e})}const d=[],f=[],p=[];s.selectPinningServices().forEach((async e=>{const n=t.includes(e.name);if(r.includes(e.name)===n)return;const i="".concat(e.name,":").concat(l);try{const t={serviceName:e.name};n?(d.push(i),await c.pin.remote.add(l,{service:e.name,name:u,background:!0}),a({type:"IPFS_PIN_SUCCEED",msgArgs:t})):(p.push(i),await c.pin.remote.rm({cid:[l],service:e.name}),a({type:"IPFS_UNPIN_SUCCEED",msgArgs:t}))}catch(g){console.error("ipfs.pin.remote error for ".concat(l,"@").concat(e.name),g);const n={serviceName:e.name,errorMsg:g.toString()};f.push(i),a({type:"IPFS_PIN_FAILED",msgArgs:n})}})),a({type:"UPDATE_REMOTE_PINS",payload:{adds:[],removals:p,pending:d,failed:f}}),await s.doPinsFetch()}},doAddPinningService:e=>{let{apiEndpoint:t,nickname:n,secretApiKey:r}=e;return async e=>{let{getIpfs:i}=e;const o=i();n=n.replaceAll(".","_"),await o.pin.remote.service.add(n,{endpoint:t,key:r})}},doRemovePinningService:e=>async t=>{let{getIpfs:n,store:r}=t;const i=n();await i.pin.remote.service.rm(e),r.doFetchPinningServices()},doSetAutoUploadForService:e=>async t=>{let{getIpfs:n,store:r}=t;const i=n(),o="Pinning.RemoteServices.".concat(e,".Policies.MFS.Enable"),s=await i.config.get(o);await i.config.set(o,!s),r.doFetchPinningServices()}},wi=bi;var Ei=__webpack_require__(5803);const Ai=(0,Ei.ZP)((()=>Promise.all([__webpack_require__.e(174),__webpack_require__.e(353),__webpack_require__.e(960)]).then(__webpack_require__.bind(__webpack_require__,51960))),{fallback:e.createElement(k.Z,null)}),Si=(0,Ei.ZP)((()=>Promise.all([__webpack_require__.e(539),__webpack_require__.e(424),__webpack_require__.e(257),__webpack_require__.e(588)]).then(__webpack_require__.bind(__webpack_require__,93353))),{fallback:e.createElement(k.Z,null)}),_i=(0,Ei.ZP)((()=>__webpack_require__.e(965).then(__webpack_require__.bind(__webpack_require__,2965))),{fallback:e.createElement(k.Z,null)}),Ii=(0,Ei.ZP)((()=>__webpack_require__.e(942).then(__webpack_require__.bind(__webpack_require__,65942))),{fallback:e.createElement(k.Z,null)}),Ci=(0,Ei.ZP)((()=>__webpack_require__.e(178).then(__webpack_require__.bind(__webpack_require__,43178))),{fallback:e.createElement(k.Z,null)}),Ti=(0,Ei.ZP)((()=>Promise.all([__webpack_require__.e(539),__webpack_require__.e(37),__webpack_require__.e(301)]).then(__webpack_require__.bind(__webpack_require__,58301))),{fallback:e.createElement(k.Z,null)}),ki=(0,Ei.ZP)((()=>Promise.all([__webpack_require__.e(539),__webpack_require__.e(654),__webpack_require__.e(257),__webpack_require__.e(835)]).then(__webpack_require__.bind(__webpack_require__,93835))),{fallback:e.createElement(k.Z,null)});var Ri=__webpack_require__(18970),xi=__webpack_require__(17457),Pi=__webpack_require__(84855),Di=__webpack_require__(43697);const Oi=(0,c.Zh)("settings")((t=>{let{t:n}=t;return e.createElement("div",{"data-id":"AnalyticsPage",className:"mw9 center"},e.createElement(Ri.ql,null,e.createElement("title",null,n("title")," | IPFS")),e.createElement(Pi.Z,null,e.createElement(xi.Z,null,n("analytics")),e.createElement(Di.Z,{t:n,open:!0})))})),Ni=(0,Ei.ZP)((()=>__webpack_require__.e(706).then(__webpack_require__.bind(__webpack_require__,10706))),{fallback:e.createElement(k.Z,null)}),Bi=()=>e.createElement("div",{"data-id":"BlankPage"}),Li=(0,z.Zh)({"/explore":Ii,"/explore*":Ci,"/files*":Si,"/ipfs*":Si,"/ipns*":Si,"/pins*":_i,"/peers":Ti,"/settings/analytics":Oi,"/settings*":ki,"/welcome":Ni,"/blank":Bi,"/status*":Ai,"/":Ai,"":Ai},{routeInfoSelector:"selectHash"}),Mi={name:"redirects",reactToEmptyHash:(0,z.P1)("selectHash",(e=>{if(""===e)return{actionCreator:"doUpdateHash",args:["#/"]}})),reactToIpfsConnectionFail:(0,z.P1)("selectIpfsInitFailed","selectHash",((e,t)=>{if(e&&"/welcome"!==t&&!t.startsWith("/settings"))return{actionCreator:"doUpdateHash",args:["#/welcome"]}}))};var Ui=__webpack_require__(72126),Fi=__webpack_require__(96118),Ki=__webpack_require__(19778).Buffer;const ji=["127.0.0.1","[::1]","0.0.0.0","[::]"],Zi=(0,z.Jc)({name:"config",staleAfter:6e4,persist:!1,checkIfOnline:!1,getPromise:async e=>{let{getIpfs:t,store:n}=e;const r=await t().config.getAll();let i;i=Ki.isBuffer(r)?r.toString():JSON.stringify(r,null,"\t");const o=JSON.parse(i),s=n.selectPublicGateway(),a=zi("Gateway",o)||s,c=new URL(a);if(ji.includes(c.hostname)){c.hostname="localhost";const e=c.toString().replace(/\/+$/,"");if(await Hi(e))return n.doSetAvailableGateway(e),i}return await Vi(a)||n.doSetAvailableGateway(s),i}});function zi(e,t){if(!t)return null;try{const n=Array.isArray(t.Addresses[e])?t.Addresses[e][0]:t.Addresses[e],r=(0,Fi.k)(n,{assumeHttp:!0});if(0===new URL(r).port)throw Error("port set to 0, not deterministic");return r}catch(n){return console.log("Failed to get url from config at Addresses.".concat(e),n),null}}Zi.selectConfigObject=(0,z.P1)("selectConfig",(e=>JSON.parse(e))),Zi.selectApiUrl=(0,z.P1)("selectConfigObject","selectPublicGateway",((e,t)=>zi("API",e)||t)),Zi.selectGatewayUrl=(0,z.P1)("selectConfigObject","selectPublicGateway",((e,t)=>zi("Gateway",e)||t)),Zi.selectAvailableGatewayUrl=(0,z.P1)("selectAvailableGateway","selectGatewayUrl",((e,t)=>e||t)),Zi.selectBootstrapPeers=(0,z.P1)("selectConfigObject",(e=>e&&e.Bootstrap)),Zi.reactConfigFetch=(0,z.P1)("selectConfigShouldUpdate","selectIpfsReady",((e,t)=>{if(e&&t)return{actionCreator:"doFetchConfig"}}));const Vi=Wr()((async e=>{try{const{status:t}=await fetch("".concat(e,"/ipfs/bafkqae2xmvwgg33nmuqhi3zajfiemuzahiwss"));return 200===t}catch(t){return console.error("Unable to use the gateway at ".concat(e,". The public gateway will be used as a fallback"),t),!1}})),Hi=Wr()((async e=>{try{(e=new URL(e)).hostname="bafkqae2xmvwgg33nmuqhi3zajfiemuzahiwss.ipfs.".concat(e.hostname);const{status:t}=await fetch(e.toString());return 200===t}catch(t){return console.error("Unable to use the subdomain gateway at ".concat(e,". Regular gateway will be used as a fallback"),t),!1}})),qi=Zi;var Gi=__webpack_require__(98595),Wi=__webpack_require__(89849);const Qi={doSaveConfig:e=>async t=>{let{store:n}=t;n.selectConfigIsSaving()?console.log("doSaveConfig skipped, config save already in progress"):await n.doPerformSaveConfig(e)},doPerformSaveConfig:e=>(0,Wi.f)("CONFIG_SAVE",(async t=>{const n=await Yi((async()=>{const n=JSON.parse(e),r=t.getIpfs();if(null==r)throw Error("IPFS node is not found");await r.config.replace(n)}));if(!n.ok)throw n.error;await t.store.doMarkConfigAsOutdated()}))},Yi=async e=>{try{return{ok:!0,value:await e()}}catch(t){return{ok:!1,error:t}}},Ji=Gi.D(["CONFIG_SAVE"]),Xi={name:"config_save",reducer:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isSaving:!1},t=arguments.length>1?arguments[1]:void 0;if(t.type===Ji.CONFIG_SAVE){const{task:n}=t;switch(n.status){case"Init":return{...e,isSaving:!0};case"Exit":{const{result:t}=n;if(t.ok)return{...e,isSaving:!1,lastSuccess:Date.now()};{const{error:n}=t,r=n&&n.message||String(n);return{...e,isSaving:!1,lastError:Date.now(),errorMessage:r}}}default:return e}}return e},selectConfigIsSaving:e=>e.config_save.isSaving,selectConfigSaveLastSuccess:e=>e.config_save.lastSuccess,selectConfigSaveLastError:e=>e.config_save.lastError,...Qi},$i=Xi;var eo=__webpack_require__(15560),to=__webpack_require__.n(eo);const no={name:"tours",init:e=>{to().localStorage.getItem("tourTooltip")&&e.doDisableTooltip()},reducer:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{enabled:!1,tooltip:!0},t=arguments.length>1?arguments[1]:void 0;return"TOURS_ENABLE"===t.type?{...e,enabled:!0}:"TOURS_DISABLE"===t.type?{...e,enabled:!1}:"TOURS_TOOLTIP_DISABLE"===t.type?{...e,tooltip:!1}:e},doDisableTooltip:()=>e=>{let{dispatch:t}=e;to().localStorage.setItem("tourTooltip",!1),t({type:"TOURS_TOOLTIP_DISABLE"})},doEnableTours:()=>e=>{let{dispatch:t}=e;t({type:"TOURS_ENABLE"})},doDisableTours:()=>e=>{let{dispatch:t}=e;t({type:"TOURS_DISABLE"})},selectTours:e=>e.tours,selectToursEnabled:e=>e.tours.enabled,selectShowTooltip:e=>e.tours.tooltip},ro=Gi.D(["EXPERIMENTS_TOGGLE","EXPERIMENTS_UPDATE_STATE"]),io=[],oo=(e,t)=>({...e,[t]:{...e[t],blocked:!1}}),so={selectExperimentsState:e=>e.experiments,selectExperiments:(0,z.P1)("selectExperimentsState",(e=>io.map((t=>({...t,...e[t.key]})))))},ao={doExpToggleAction:e=>t=>{let{dispatch:n}=t;e&&n({type:ro.EXPERIMENTS_TOGGLE,task:{status:"Init",id:Symbol(ro.EXPERIMENTS_TOGGLE),init:{key:e}}})}},co={name:"experiments",persistActions:[ro.EXPERIMENTS_TOGGLE,ro.EXPERIMENTS_UPDATE_STATE],reducer:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ro.EXPERIMENTS_TOGGLE:{const{task:n}=t;switch(n.status){case"Init":return((e,t)=>({...e,[t]:{...e[t],blocked:!0}}))(e,n.init.key);case"Exit":{const{result:t}=n;return t.ok?((e,t)=>oo({...e,[t]:{...e[t],enabled:!(e&&e[t]&&e[t].enabled)}},t))(e,t.value.key):oo(e,t.error.key)}default:return e}}case ro.EXPERIMENTS_UPDATE_STATE:return((e,t)=>Object.keys(t).reduce(((n,r)=>({...n,[r]:{...e[r],...t[r]}})),e))(e,t.payload);default:return e}},...so,...ao},lo=co,uo={show:!1,error:!1,eventId:null,code:null},ho={name:"notify",reducer:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:uo,t=arguments.length>1?arguments[1]:void 0;return"NOTIFY_DISMISSED"===t.type?{...e,show:!1}:"STATS_FETCH_FAILED"===t.type?{...e,show:!0,error:!0,eventId:t.type}:t.type.match(/^FILES_\w+_FAILED$/)?{...e,show:!0,error:!0,eventId:"FILES_EVENT_FAILED",code:t.payload.error.code}:"STATS_FETCH_FINISHED"===t.type&&"STATS_FETCH_FAILED"===e.eventId?{...e,error:!1,eventId:"STATS_FETCH_FINISHED",lastSuccess:Date.now()}:"SWARM_CONNECT_FAILED"===t.type||"SWARM_CONNECT_FINISHED"===t.type?{...e,show:!0,error:"SWARM_CONNECT_FAILED"===t.type,eventId:t.type}:t.type===ro.EXP_TOGGLE_FAILED?{...e,show:!0,error:!0,eventId:"experimentsErrors.".concat(t.payload.key)}:"IPFS_PIN_FAILED"===t.type?{...e,show:!0,error:!0,msgArgs:t.msgArgs,eventId:t.type}:"IPFS_PIN_SUCCEED"===t.type||"IPFS_UNPIN_SUCCEED"===t.type?{...e,show:!0,error:!1,msgArgs:t.msgArgs,eventId:t.type}:"IPFS_CONNECT_FAILED"===t.type?{...e,show:!0,error:!0,eventId:t.type}:"IPFS_CONNECT_SUCCEED"===t.type?{...e,show:!0,error:!1,eventId:t.type}:"IPFS_API_ADDRESS_INVALID"===t.type?{...e,show:!0,error:!0,eventId:t.type}:e},selectNotify:e=>e.notify,selectNotifyI18nKey:(0,z.P1)("selectNotify","selectIpfsProvider",((e,t)=>{const{eventId:n,code:r}=e;if("STATS_FETCH_FAILED"===n)return"ipfsApiRequestFailed";if("IPFS_CONNECT_FAILED"===n)return"ipfsConnectFail";if("IPFS_CONNECT_SUCCEED"===n)return"ipfsConnectSuccess";if("IPFS_API_ADDRESS_INVALID"===n)return"ipfsInvalidApiAddress";if("IPFS_PIN_FAILED"===n)return"ipfsPinFailReason";if("IPFS_PIN_SUCCEED"===n)return"ipfsPinSucceedReason";if("IPFS_UNPIN_SUCCEED"===n)return"ipfsUnpinSucceedReason";if("FILES_EVENT_FAILED"===n){switch(r?r.replace(/^(ERR_)/,""):""){case"FOLDER_EXISTS":return"folderExists";case Ui.aO.WRITE:case Ui.aO.ADD_BY_PATH:case"API_RESPONSE":return"filesAddFailed";case Ui.aO.FETCH:return"filesFetchFailed";case Ui.aO.MOVE:return"filesRenameFailed";case Ui.aO.MAKE_DIR:return"filesMakeDirFailed";case Ui.aO.COPY:return"filesCopyFailed";case Ui.aO.DELETE:return"filesRemoveFailed";default:return"filesEventFailed"}}return"STATS_FETCH_FINISHED"===n?"ipfsIsBack":"SWARM_CONNECT_FAILED"===n?"couldntConnectToPeer":"SWARM_CONNECT_FINISHED"===n?"connectedToPeer":n})),doNotifyDismiss:()=>e=>{let{dispatch:t}=e;return t({type:"NOTIFY_DISMISSED"})},reactNotifyOkDismiss:(0,z.P1)("selectAppTime","selectNotify",((e,t)=>{if("STATS_FETCH_FINISHED"===t.eventId&&t.show&&e-t.lastSuccess>3e3)return{type:"NOTIFY_DISMISSED"}}))},fo={name:"connected",reducer:(e,t)=>{switch(e=e||{lastError:0,isNodeInfoOpen:!1},t.type){case"STATS_FETCH_FAILED":return{...e,lastError:Date.now()};case"NODE_INFO_OPEN":return{...e,isNodeInfoOpen:t.payload};default:return e}},doSetIsNodeInfoOpen:e=>t=>{let{dispatch:n}=t;return n({type:"NODE_INFO_OPEN",payload:e})},...{selectConnectedLastError:e=>e.connected.lastError,selectIpfsConnected:(0,z.P1)("selectIpfsReady","selectNodeBandwidthLastSuccess","selectNodeBandwidthLastError",((e,t,n)=>e&&null!=t&&t>n)),selectIsNodeInfoOpen:e=>e.connected.isNodeInfoOpen}},po={name:"retryInit",reducer:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{tryCount:0,needToRetry:!0,startedAt:void 0,failedAt:void 0,currentlyTrying:!1},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"RETRY_INIT_DISABLE":return{tryCount:0,needToRetry:!0,startedAt:void 0,failedAt:void 0,currentlyTrying:!1,needToRetry:!1};case V.aO.IPFS_INIT:{const{task:n}=t;switch(n.status){case"Init":{const t=Date.now();return{...e,currentlyTrying:!0,startedAt:t,tryCount:(e.tryCount||0)+1}}case"Exit":if(n.result.ok)return{tryCount:0,needToRetry:!0,startedAt:void 0,failedAt:void 0,currentlyTrying:!1,needToRetry:!1};{const t=Date.now();return{...e,failedAt:t,currentlyTrying:!1}}default:return e}}default:return e}},doDisableRetryInit:()=>e=>{e.dispatch({type:"RETRY_INIT_DISABLE"})},selectRetryInitState:e=>e.retryInit,reactConnectionInitRetry:(0,z.P1)("selectAppTime","selectIpfsReady","selectRetryInitState",((e,t,n)=>{let{failedAt:r,tryCount:i,needToRetry:o,currentlyTrying:s}=n;return!s&&(!!e&&(!!o&&(null!=i&&i>5||t?{actionCreator:"doDisableRetryInit"}:!(!r||e-r<2500)&&{actionCreator:"doTryInitIpfs"})))}))},go=po,yo=(0,z.Jc)({name:"identity",actionBaseType:"IDENTITY",getPromise:e=>{let{getIpfs:t}=e;return t().id().catch((e=>{console.error("Failed to get identity",e)}))},staleAfter:1/0,persist:!1,checkIfOnline:!1});yo.selectIdentityLastSuccess=e=>e.identity.lastSuccess,yo.reactIdentityFetch=(0,z.P1)("selectIpfsConnected","selectIdentityIsLoading","selectIdentityLastSuccess","selectConnectedLastError",((e,t,n,r)=>{if(e&&!t&&(!n||r>n))return{actionCreator:"doFetchIdentity"}}));const mo=yo,vo=ye({name:"bundle-cache",version:1,maxAge:1/0}),bo=window,wo={selectIsIpfsDesktop:()=>!!bo.ipfsDesktop,selectDesktopCountlyActions:()=>[]},Eo={...wo,selectDesktopVersion:()=>{var e;return null===(e=bo.ipfsDesktop)||void 0===e?void 0:e.version},selectDesktopCountlyDeviceId:()=>{var e;return null===(e=bo.ipfsDesktop)||void 0===e?void 0:e.countlyDeviceId},selectDesktopCountlyActions:()=>{var e;return null===(e=bo.ipfsDesktop)||void 0===e?void 0:e.countlyActions}},Ao={doDesktopAddConsent:e=>()=>{var t;return null===(t=bo.ipfsDesktop)||void 0===t?void 0:t.addConsent(e)},doDesktopRemoveConsent:e=>()=>{var t;return null===(t=bo.ipfsDesktop)||void 0===t?void 0:t.removeConsent(e)},doDesktopUpdateLanguage:e=>()=>{var t;return null===(t=bo.ipfsDesktop)||void 0===t?void 0:t.updateLanguage(e)}},So={name:"ipfsDesktop",reducer:function(){return arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}},...bo.ipfsDesktop?Eo:wo,...bo.ipfsDesktop?Ao:{}},_o=(0,z.Jc)({name:"repoStats",getPromise:async e=>{let{getIpfs:t}=e;return t().repo.stat()},staleAfter:6e4,persist:!1,checkIfOnline:!1});_o.selectRepoSize=(0,z.P1)("selectRepoStats",(e=>{if(e&&e.repoSize)return e.repoSize.toString()})),_o.selectRepoNumObjects=(0,z.P1)("selectRepoStats",(e=>{if(e&&e.numObjects)return e.numObjects.toString()})),_o.reactRepoStatsFetch=(0,z.P1)("selectRepoStatsShouldUpdate","selectIpfsReady",((e,t)=>{if(e&&t)return{actionCreator:"doFetchRepoStats"}}));const Io=_o;var Co=__webpack_require__(69497),To=__webpack_require__(34585);const ko=/webui[-.]ipfs/,Ro=/(?:localhost|127.0.0.1)/,xo=/ipfs/;function Po(e){if("function"===typeof e)return!0;if(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])throw new TypeError("Expected a function");return!1}function Do(e){if("number"===typeof e)return!0;if(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])throw new TypeError("Expected a number");return!1}const Oo=Gi.D(["DESKTOP_SETTING_TOGGLE"]),No=Gi.D(["ANALYTICS_ENABLED","ANALYTICS_DISABLED","ANALYTICS_ADD_CONSENT","ANALYTICS_REMOVE_CONSENT","SET_SHOW_ANALYTICS_BANNER"]),Bo=[V.aO.IPFS_INIT,Ji.CONFIG_SAVE,To.aO.MAKE_DIR,To.aO.WRITE,To.aO.ADD_BY_PATH,To.aO.MOVE,To.aO.DELETE,To.aO.DOWNLOAD_LINK,ro.EXPERIMENTS_TOGGLE,Oo.DESKTOP_SETTING_TOGGLE];async function Lo(){var e;if(null!==(e=to().ipfsDesktop)&&void 0!==e&&e.countlyAppKey)return to().ipfsDesktop.countlyAppKey;return"kubo"===await async function(){const{origin:e}=globalThis.location;if(ko.test(e))return Ro.test(e)?"local":"webui.ipfs";try{const e=await fetch("/webui",{method:"HEAD"}),{pathname:t}=new URL(e.url);if(e.redirected&&xo.test(t))return"kubo"}catch{}return Ro.test(e)?"local":"webui.ipfs"}()?"c4524cc93fed92a5838d4ea27c5a65526b4e7558":"8fa213e6049bff23b08e5f5fbac89e7c27397612"}const Mo={all:["sessions","events","views","location","crashes"],safe:["sessions","events","views","location"]};function Uo(e,t){to().Countly.q.push(["add_consent",e]),t.selectIsIpfsDesktop()&&t.doDesktopAddConsent(e)}function Fo(e,t){to().Countly.q.push(["remove_consent",e]),t.selectIsIpfsDesktop()&&t.doDesktopRemoveConsent(e)}function Ko(e){let{id:t,duration:n}=e;to().Countly.q.push(["add_event",{key:t,count:1,dur:n}])}const jo=new Map([["IPFS_INIT_FAILED",((e,t)=>(Po(e)&&Do(t),((e,t)=>{Po(e)&&Do(t);let n=0;return function(){if(n++,n>=t)return e(...arguments)}})((e=>{Po(e);let t,n=!1;return function(){return n||(t=e(...arguments),n=!0),t}})(e),t)))(Ko,5)]]);const Zo={selectAnalytics:e=>e.analytics,selectAnalyticsConsent:e=>e.analytics.consent,selectAnalyticsEnabled:e=>e.analytics.consent.length>0,selectAnalyticsOptedOutPriorToDefaultOptIn:e=>!e.analytics.optedOut&&0===e.analytics.consent.length&&e.analytics.lastDisabledAt>e.analytics.lastEnabledAt,selectAnalyticsOptedOut:e=>e.analytics.optedOut,selectShowAnalyticsComponents:e=>e.analytics.showAnalyticsComponents,selectShowAnalyticsBanner:e=>e.analytics.showAnalyticsBanner,selectAnalyticsActionsToRecord:(0,z.P1)("selectIsIpfsDesktop","selectDesktopCountlyActions",((e,t)=>e?t.concat(Bo).sort():Array.from(Bo).sort()))},zo={doToggleAnalytics:()=>e=>{let{store:t}=e;!t.selectAnalyticsEnabled()?t.doEnableAnalytics():t.doDisableAnalytics()},doDisableAnalytics:()=>e=>{let{dispatch:t,store:n}=e;to().Countly.opt_out(),Fo(Mo.all,n),t({type:"ANALYTICS_DISABLED",payload:{consent:[]}})},doEnableAnalytics:()=>e=>{let{dispatch:t,store:n}=e;Fo(Mo.all,n),to().Countly.opt_in(),Uo(Mo.safe,n),t({type:"ANALYTICS_ENABLED",payload:{consent:Mo.safe}})},doToggleConsent:e=>t=>{let{store:n}=t;n.selectAnalyticsConsent().includes(e)?n.doRemoveConsent(e):n.doAddConsent(e)},doRemoveConsent:e=>t=>{let{dispatch:n,store:r}=t;0===r.selectAnalyticsConsent().filter((t=>t!==e)).length&&to().Countly.opt_out(),Fo(e,r),n({type:"ANALYTICS_REMOVE_CONSENT",payload:{name:e}})},doAddConsent:e=>t=>{let{dispatch:n,store:r}=t;0===r.selectAnalyticsConsent().length&&to().Countly.opt_in(),Uo(e,r),n({type:"ANALYTICS_ADD_CONSENT",payload:{name:e}})},doToggleShowAnalyticsBanner:e=>t=>{let{dispatch:n}=t;n({type:"SET_SHOW_ANALYTICS_BANNER",payload:{shouldShow:e}})}},Vo=e=>{switch(e.type){case To.aO.MAKE_DIR:case To.aO.WRITE:case To.aO.ADD_BY_PATH:case To.aO.MOVE:case To.aO.DELETE:case To.aO.DOWNLOAD_LINK:case V.aO.IPFS_INIT:case Ji.CONFIG_SAVE:return Ho(e.task,e.type);case ro.EXPERIMENTS_TOGGLE:return qo(e.task,"EXPERIMENTS");case Oo.DESKTOP_SETTING_TOGGLE:return qo(e.task,"DESKTOP_SETTING");default:return null}},Ho=(e,t)=>{if("Exit"===e.status){const{duration:n,result:r}=e;return{id:r.ok?t:"".concat(t,"_FAILED"),duration:n,error:r.ok?null:r.error}}return null},qo=(e,t)=>{if("Exit"===e.status){const{result:n,duration:r}=e,{key:i}=n.ok?n.value:n.error,o=n.ok?null:n.error,s=n.ok?n.value.value?"ENABLED":"DISABLED":"FAILED";return{id:"".concat(t,"_").concat(Co.constantCase(i),"_").concat(s),duration:r,error:o}}return null},Go=e=>{let{countlyUrl:t="https://countly.ipfs.tech",appVersion:n="4.2.1",appGitRevision:r="9c10520",debug:i=!1}=e;return{name:"analytics",persistActions:[No.ANALYTICS_ENABLED,No.ANALYTICS_DISABLED,No.ANALYTICS_DISABLED,No.ANALYTICS_ADD_CONSENT,No.ANALYTICS_REMOVE_CONSENT,No.SET_SHOW_ANALYTICS_BANNER],init:async e=>{to().Countly||(to().Countly={},to().Countly.q=[],await __webpack_require__.e(739).then(__webpack_require__.t.bind(__webpack_require__,33739,23)));const r=to().Countly;r.require_consent=!0,r.url=t;const o=Lo();if(o.then((e=>{r.app_key=e})),r.app_version=n,r.debug=i,e.selectIsIpfsDesktop()&&(r.app_version=e.selectDesktopVersion(),r.q.push(["change_id",e.selectDesktopCountlyDeviceId(),!0])),r.q.push(["track_sessions"]),r.q.push(["track_errors"]),e.selectAnalyticsEnabled()){Uo(e.selectAnalyticsConsent(),e)}else e.selectAnalyticsOptedOut()||(e.selectAnalyticsOptedOutPriorToDefaultOptIn()&&e.doToggleShowAnalyticsBanner(!0),e.doEnableAnalytics());e.subscribeToSelectors(["selectRouteInfo"],(e=>{let{routeInfo:t}=e;to().location&&to().location.hash&&to().Countly.q.push(["track_pageview",t.pattern])})),"function"===typeof r.init&&(await o,r.init())},getMiddleware:()=>()=>e=>t=>{const n=Vo(t);if(n){const{id:e,duration:r,error:i}=n;!function(e){let{id:t,duration:n}=e;const r=jo.get(t);r?r({id:t,duration:n}):Ko({id:t,duration:n})}({id:e,duration:r}),i&&(to().Countly.q.push(["add_log",t.type]),to().Countly.q.push(["log_error",i]))}return e(t)},reducer:(e,t)=>{switch(e=e||{lastEnabledAt:0,lastDisabledAt:0,showAnalyticsComponents:!1,showAnalyticsBanner:!1,optedOut:true,consent:[]},t.type){case No.ANALYTICS_ENABLED:return{...e,lastEnabledAt:Date.now(),consent:t.payload.consent,optedOut:!1};case No.ANALYTICS_DISABLED:return{...e,lastDisabledAt:Date.now(),consent:t.payload.consent,optedOut:!0,showAnalyticsBanner:!1};case No.ANALYTICS_ADD_CONSENT:{const n=e.consent.filter((e=>e!==t.payload.name)).concat(t.payload.name);return{...e,lastEnabledAt:Date.now(),consent:n,optedOut:!1}}case No.ANALYTICS_REMOVE_CONSENT:{const n=e.consent.filter((e=>e!==t.payload.name)),r=0===n.length?Date.now():e.lastDisabledAt,i=0===n.length;return{...e,lastDisabledAt:r,consent:n,optedOut:i,showAnalyticsBanner:!1}}case No.SET_SHOW_ANALYTICS_BANNER:{var n;const r=(null===(n=t.payload)||void 0===n?void 0:n.shouldShow)||!1;return{...e,showAnalyticsBanner:r}}default:return e.consent?e:e.lastEnabledAt>e.lastDisabledAt?{...e,consent:Mo.safe}:{...e,consent:[]}}},...Zo,...zo}},Wo=(0,z.Jc)({name:"cliTutorMode",actionBaseType:"CLI_TUTOR_MODE_TOGGLE",persist:!0,checkIfOnline:!1,getPromise:()=>{}});Wo.reactIsCliTutorModeEnabled=(0,z.P1)("selectIsCliTutorModeEnabled",(e=>{const t=Boolean(JSON.parse(localStorage.getItem("isCliTutorModeEnabled")));void 0!==e&&e!==t&&localStorage.setItem("isCliTutorModeEnabled",e)})),Wo.selectIsCliTutorModeEnabled=e=>e.cliTutorMode.isCliTutorModeEnabled,Wo.selectIsCliTutorModalOpen=e=>!!e.cliTutorMode.showCliTutorModal,Wo.selectCliOptions=e=>e.cliTutorMode.cliOptions,Wo.reducer=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return"CLI_TUTOR_MODE_TOGGLE"===t.type?{...e,isCliTutorModeEnabled:t.payload}:"CLI_TUTOR_MODAL_ENABLE"===t.type?{...e,showCliTutorModal:t.payload}:"CLI_OPTIONS"===t.type?{...e,cliOptions:t.payload}:e},Wo.doToggleCliTutorMode=e=>t=>{let{dispatch:n}=t;n({type:"CLI_TUTOR_MODE_TOGGLE",payload:e})},Wo.doSetCliOptions=e=>t=>{let{dispatch:n}=t;n({type:"CLI_OPTIONS",payload:e})},Wo.doOpenCliTutorModal=e=>t=>{let{dispatch:n}=t;n({type:"CLI_TUTOR_MODAL_ENABLE",payload:e})},Wo.doOpenCliTutorModal=e=>t=>{let{dispatch:n}=t;n({type:"CLI_TUTOR_MODAL_ENABLE",payload:e})},Wo.init=e=>{const t=Boolean(JSON.parse(localStorage.getItem("isCliTutorModeEnabled")));return e.doToggleCliTutorMode(t)};const Qo=Wo;var Yo=__webpack_require__(72672);const Jo={name:"ipns",reducer:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{keys:[],expectedPublishTime:(0,hi.g)("expectedPublishTime")||60},t=arguments.length>1?arguments[1]:void 0;return"CACHE_IPNS_KEYS"===t.type?{...e,keys:t.payload}:"SET_EXPECTED_PUBLISH_TIME"===t.type?{...e,expectedPublishTime:t.payload}:e},selectIpnsKeys:e=>e.ipns.keys||[],selectExpectedPublishTime:e=>e.ipns.expectedPublishTime,doFetchIpnsKeys:()=>async e=>{let{getIpfs:t,dispatch:n}=e;const r=t(),i=await r.key.list(),o=[];for(const{id:s,name:a}of i){const e=(await ui()(r.name.resolve("/ipns/".concat(s),{offline:!0}))).length>0;o.push({id:s,name:a,published:e})}n({type:"CACHE_IPNS_KEYS",payload:o})},doGenerateIpnsKey:e=>async t=>{let{getIpfs:n,store:r}=t;const i=n();await i.key.gen(e),r.doFetchIpnsKeys()},doRemoveIpnsKey:e=>async t=>{let{getIpfs:n,store:r}=t;const i=n();await i.key.rm(e),r.doFetchIpnsKeys()},doRenameIpnsKey:(e,t)=>async n=>{let{getIpfs:r,store:i}=n;const o=r();await o.key.rename(e,t),i.doFetchIpnsKeys()},doPublishIpnsKey:(e,t)=>async n=>{let{getIpfs:r,store:i}=n;const o=r();await o.name.publish(e,{key:t})},doUpdateExpectedPublishTime:e=>async t=>{let{store:n,dispatch:r}=t;const i=n.selectExpectedPublishTime(),o=Math.floor((1.5*e+i)/2);await(0,hi.D)("expectedPublishTime",o),r({type:"SET_EXPECTED_PUBLISH_TIME",payload:o})}},Xo=Jo,$o=(0,z.pY)((0,z.qF)({cacheFn:vo.set}),W({idleTimeout:5e3}),V.ZP,H.b0,mo,Li,Mi,no,(0,Ui.ZP)(),(0,H.py)(),qi,$i,Yo.ZP,te,Q(),se,si(),wi,ho,fo,go,lo,So,Io,Qo,Go({}),Xo);var es=__webpack_require__(32821),ts=__webpack_require__(60348);function ns(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(c){i=!0,o=c}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return rs(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rs(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rs(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function is(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var os=0,ss=(0,e.memo)((function(t){var n=t.children,r=function(e){if("manager"in e){return[{dragDropManager:e.manager},!1]}var t=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:cs(),n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=t;i[as]||(i[as]=(0,ts.W)(e,t,n,r));return i[as]}(e.backend,e.context,e.options,e.debugMode),n=!e.context;return[t,n]}(is(t,["children"])),i=ns(r,2),o=i[0],s=i[1];return e.useEffect((function(){return s&&os++,function(){s&&(0===--os&&(cs()[as]=null))}}),[]),e.createElement(ts.L.Provider,{value:o},n)}));ss.displayName="DndProvider";var as=Symbol.for("__REACT_DND_CONTEXT_INSTANCE__");function cs(){return"undefined"!==typeof __webpack_require__.g?__webpack_require__.g:window}var ls=__webpack_require__(52354);function us(e){var t=null;return function(){return null==t&&(t=e()),t}}function hs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ds=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.entered=[],this.isNodeInDocument=t}var t,n,r;return t=e,n=[{key:"enter",value:function(e){var t=this,n=this.entered.length;return this.entered=function(e,t){var n=new Set,r=function(e){return n.add(e)};e.forEach(r),t.forEach(r);var i=[];return n.forEach((function(e){return i.push(e)})),i}(this.entered.filter((function(n){return t.isNodeInDocument(n)&&(!n.contains||n.contains(e))})),[e]),0===n&&this.entered.length>0}},{key:"leave",value:function(e){var t,n,r=this.entered.length;return this.entered=(t=this.entered.filter(this.isNodeInDocument),n=e,t.filter((function(e){return e!==n}))),r>0&&0===this.entered.length}},{key:"reset",value:function(){this.entered=[]}}],n&&hs(t.prototype,n),r&&hs(t,r),e}(),fs=us((function(){return/firefox/i.test(navigator.userAgent)})),ps=us((function(){return Boolean(window.safari)}));function gs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ys,ms=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);for(var r=t.length,i=[],o=0;o<r;o++)i.push(o);i.sort((function(e,n){return t[e]<t[n]?-1:1}));for(var s,a,c=[],l=[],u=[],h=0;h<r-1;h++)s=t[h+1]-t[h],a=n[h+1]-n[h],l.push(s),c.push(a),u.push(a/s);for(var d=[u[0]],f=0;f<l.length-1;f++){var p=u[f],g=u[f+1];if(p*g<=0)d.push(0);else{s=l[f];var y=l[f+1],m=s+y;d.push(3*m/((m+y)/p+(m+s)/g))}}d.push(u[u.length-1]);for(var v,b=[],w=[],E=0;E<d.length-1;E++){v=u[E];var A=d[E],S=1/l[E],_=A+d[E+1]-v-v;b.push((v-A-_)*S),w.push(_*S*S)}this.xs=t,this.ys=n,this.c1s=d,this.c2s=b,this.c3s=w}var t,n,r;return t=e,n=[{key:"interpolate",value:function(e){var t=this.xs,n=this.ys,r=this.c1s,i=this.c2s,o=this.c3s,s=t.length-1;if(e===t[s])return n[s];for(var a,c=0,l=o.length-1;c<=l;){var u=t[a=Math.floor(.5*(c+l))];if(u<e)c=a+1;else{if(!(u>e))return n[a];l=a-1}}var h=e-t[s=Math.max(0,l)],d=h*h;return n[s]+r[s]*h+i[s]*d+o[s]*h*d}}],n&&gs(t.prototype,n),r&&gs(t,r),e}(),vs=1;function bs(e){var t=e.nodeType===vs?e:e.parentElement;if(!t)return null;var n=t.getBoundingClientRect(),r=n.top;return{x:n.left,y:r}}function ws(e){return{x:e.clientX,y:e.clientY}}function Es(e,t,n,r,i){var o=function(e){var t;return"IMG"===e.nodeName&&(fs()||!(null===(t=document.documentElement)||void 0===t?void 0:t.contains(e)))}(t),s=bs(o?e:t),a={x:n.x-s.x,y:n.y-s.y},c=e.offsetWidth,l=e.offsetHeight,u=r.anchorX,h=r.anchorY,d=function(e,t,n,r){var i=e?t.width:n,o=e?t.height:r;return ps()&&e&&(o/=window.devicePixelRatio,i/=window.devicePixelRatio),{dragPreviewWidth:i,dragPreviewHeight:o}}(o,t,c,l),f=d.dragPreviewWidth,p=d.dragPreviewHeight,g=i.offsetX,y=i.offsetY,m=0===y||y;return{x:0===g||g?g:new ms([0,.5,1],[a.x,a.x/c*f,a.x+f-c]).interpolate(u),y:m?y:function(){var e=new ms([0,.5,1],[a.y,a.y/l*p,a.y+p-l]).interpolate(h);return ps()&&o&&(e+=(window.devicePixelRatio-1)*p),e}()}}function As(e,t,n){var r=t.reduce((function(t,n){return t||e.getData(n)}),"");return null!=r?r:n}function Ss(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _s=(Ss(ys={},h.FILE,{exposeProperties:{files:function(e){return Array.prototype.slice.call(e.files)},items:function(e){return e.items}},matchesTypes:["Files"]}),Ss(ys,h.URL,{exposeProperties:{urls:function(e,t){return As(e,t,"").split("\n")}},matchesTypes:["Url","text/uri-list"]}),Ss(ys,h.TEXT,{exposeProperties:{text:function(e,t){return As(e,t,"")}},matchesTypes:["Text","text/plain"]}),ys);function Is(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Cs=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t,this.item={},this.initializeExposedProperties()}var t,n,r;return t=e,(n=[{key:"initializeExposedProperties",value:function(){var e=this;Object.keys(this.config.exposeProperties).forEach((function(t){Object.defineProperty(e.item,t,{configurable:!0,enumerable:!0,get:function(){return console.warn("Browser doesn't allow reading \"".concat(t,'" until the drop event.')),null}})}))}},{key:"loadDataTransfer",value:function(e){var t=this;if(e){var n={};Object.keys(this.config.exposeProperties).forEach((function(r){n[r]={value:t.config.exposeProperties[r](e,t.config.matchesTypes),configurable:!0,enumerable:!0}})),Object.defineProperties(this.item,n)}}},{key:"canDrag",value:function(){return!0}},{key:"beginDrag",value:function(){return this.item}},{key:"isDragging",value:function(e,t){return t===e.getSourceId()}},{key:"endDrag",value:function(){}}])&&Is(t.prototype,n),r&&Is(t,r),e}();function Ts(e){if(!e)return null;var t=Array.prototype.slice.call(e.types||[]);return Object.keys(_s).filter((function(e){return _s[e].matchesTypes.some((function(e){return t.indexOf(e)>-1}))}))[0]||null}function ks(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Rs=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.globalContext=t}var t,n,r;return t=e,(n=[{key:"window",get:function(){return this.globalContext?this.globalContext:"undefined"!==typeof window?window:void 0}},{key:"document",get:function(){if(this.window)return this.window.document}}])&&ks(t.prototype,n),r&&ks(t,r),e}();function xs(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ps(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xs(Object(n),!0).forEach((function(t){Ds(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xs(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ds(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Os(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ns=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sourcePreviewNodes=new Map,this.sourcePreviewNodeOptions=new Map,this.sourceNodes=new Map,this.sourceNodeOptions=new Map,this.dragStartSourceIds=null,this.dropTargetIds=[],this.dragEnterTargetIds=[],this.currentNativeSource=null,this.currentNativeHandle=null,this.currentDragSourceNode=null,this.altKeyPressed=!1,this.mouseMoveTimeoutTimer=null,this.asyncEndDragFrameId=null,this.dragOverTargetIds=null,this.getSourceClientOffset=function(e){var t=r.sourceNodes.get(e);return t&&bs(t)||null},this.endDragNativeItem=function(){r.isDraggingNativeItem()&&(r.actions.endDrag(),r.currentNativeHandle&&r.registry.removeSource(r.currentNativeHandle),r.currentNativeHandle=null,r.currentNativeSource=null)},this.isNodeInDocument=function(e){return Boolean(e&&r.document&&r.document.body&&document.body.contains(e))},this.endDragIfSourceWasRemovedFromDOM=function(){var e=r.currentDragSourceNode;r.isNodeInDocument(e)||r.clearCurrentDragSourceNode()&&r.actions.endDrag()},this.handleTopDragStartCapture=function(){r.clearCurrentDragSourceNode(),r.dragStartSourceIds=[]},this.handleTopDragStart=function(e){if(!e.defaultPrevented){var t=r.dragStartSourceIds;r.dragStartSourceIds=null;var n=ws(e);r.monitor.isDragging()&&r.actions.endDrag(),r.actions.beginDrag(t||[],{publishSource:!1,getSourceClientOffset:r.getSourceClientOffset,clientOffset:n});var i=e.dataTransfer,o=Ts(i);if(r.monitor.isDragging()){if(i&&"function"===typeof i.setDragImage){var s=r.monitor.getSourceId(),a=r.sourceNodes.get(s),c=r.sourcePreviewNodes.get(s)||a;if(c){var l=r.getCurrentSourcePreviewNodeOptions(),u=Es(a,c,n,{anchorX:l.anchorX,anchorY:l.anchorY},{offsetX:l.offsetX,offsetY:l.offsetY});i.setDragImage(c,u.x,u.y)}}try{null===i||void 0===i||i.setData("application/json",{})}catch(h){}r.setCurrentDragSourceNode(e.target),r.getCurrentSourcePreviewNodeOptions().captureDraggingState?r.actions.publishDragSource():setTimeout((function(){return r.actions.publishDragSource()}),0)}else if(o)r.beginDragNativeItem(o);else{if(i&&!i.types&&(e.target&&!e.target.hasAttribute||!e.target.hasAttribute("draggable")))return;e.preventDefault()}}},this.handleTopDragEndCapture=function(){r.clearCurrentDragSourceNode()&&r.actions.endDrag()},this.handleTopDragEnterCapture=function(e){if(r.dragEnterTargetIds=[],r.enterLeaveCounter.enter(e.target)&&!r.monitor.isDragging()){var t=e.dataTransfer,n=Ts(t);n&&r.beginDragNativeItem(n,t)}},this.handleTopDragEnter=function(e){var t=r.dragEnterTargetIds;(r.dragEnterTargetIds=[],r.monitor.isDragging())&&(r.altKeyPressed=e.altKey,fs()||r.actions.hover(t,{clientOffset:ws(e)}),t.some((function(e){return r.monitor.canDropOnTarget(e)}))&&(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect=r.getCurrentDropEffect())))},this.handleTopDragOverCapture=function(){r.dragOverTargetIds=[]},this.handleTopDragOver=function(e){var t=r.dragOverTargetIds;if(r.dragOverTargetIds=[],!r.monitor.isDragging())return e.preventDefault(),void(e.dataTransfer&&(e.dataTransfer.dropEffect="none"));r.altKeyPressed=e.altKey,r.actions.hover(t||[],{clientOffset:ws(e)}),(t||[]).some((function(e){return r.monitor.canDropOnTarget(e)}))?(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect=r.getCurrentDropEffect())):r.isDraggingNativeItem()?e.preventDefault():(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="none"))},this.handleTopDragLeaveCapture=function(e){r.isDraggingNativeItem()&&e.preventDefault(),r.enterLeaveCounter.leave(e.target)&&r.isDraggingNativeItem()&&r.endDragNativeItem()},this.handleTopDropCapture=function(e){var t;(r.dropTargetIds=[],e.preventDefault(),r.isDraggingNativeItem())&&(null===(t=r.currentNativeSource)||void 0===t||t.loadDataTransfer(e.dataTransfer));r.enterLeaveCounter.reset()},this.handleTopDrop=function(e){var t=r.dropTargetIds;r.dropTargetIds=[],r.actions.hover(t,{clientOffset:ws(e)}),r.actions.drop({dropEffect:r.getCurrentDropEffect()}),r.isDraggingNativeItem()?r.endDragNativeItem():r.endDragIfSourceWasRemovedFromDOM()},this.handleSelectStart=function(e){var t=e.target;"function"===typeof t.dragDrop&&("INPUT"===t.tagName||"SELECT"===t.tagName||"TEXTAREA"===t.tagName||t.isContentEditable||(e.preventDefault(),t.dragDrop()))},this.options=new Rs(n),this.actions=t.getActions(),this.monitor=t.getMonitor(),this.registry=t.getRegistry(),this.enterLeaveCounter=new ds(this.isNodeInDocument)}var t,n,r;return t=e,(n=[{key:"profile",value:function(){var e,t;return{sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,sourceNodeOptions:this.sourceNodeOptions.size,sourceNodes:this.sourceNodes.size,dragStartSourceIds:(null===(e=this.dragStartSourceIds)||void 0===e?void 0:e.length)||0,dropTargetIds:this.dropTargetIds.length,dragEnterTargetIds:this.dragEnterTargetIds.length,dragOverTargetIds:(null===(t=this.dragOverTargetIds)||void 0===t?void 0:t.length)||0}}},{key:"setup",value:function(){if(void 0!==this.window){if(this.window.__isReactDndBackendSetUp)throw new Error("Cannot have two HTML5 backends at the same time.");this.window.__isReactDndBackendSetUp=!0,this.addEventListeners(this.window)}}},{key:"teardown",value:function(){void 0!==this.window&&(this.window.__isReactDndBackendSetUp=!1,this.removeEventListeners(this.window),this.clearCurrentDragSourceNode(),this.asyncEndDragFrameId&&this.window.cancelAnimationFrame(this.asyncEndDragFrameId))}},{key:"connectDragPreview",value:function(e,t,n){var r=this;return this.sourcePreviewNodeOptions.set(e,n),this.sourcePreviewNodes.set(e,t),function(){r.sourcePreviewNodes.delete(e),r.sourcePreviewNodeOptions.delete(e)}}},{key:"connectDragSource",value:function(e,t,n){var r=this;this.sourceNodes.set(e,t),this.sourceNodeOptions.set(e,n);var i=function(t){return r.handleDragStart(t,e)},o=function(e){return r.handleSelectStart(e)};return t.setAttribute("draggable","true"),t.addEventListener("dragstart",i),t.addEventListener("selectstart",o),function(){r.sourceNodes.delete(e),r.sourceNodeOptions.delete(e),t.removeEventListener("dragstart",i),t.removeEventListener("selectstart",o),t.setAttribute("draggable","false")}}},{key:"connectDropTarget",value:function(e,t){var n=this,r=function(t){return n.handleDragEnter(t,e)},i=function(t){return n.handleDragOver(t,e)},o=function(t){return n.handleDrop(t,e)};return t.addEventListener("dragenter",r),t.addEventListener("dragover",i),t.addEventListener("drop",o),function(){t.removeEventListener("dragenter",r),t.removeEventListener("dragover",i),t.removeEventListener("drop",o)}}},{key:"addEventListeners",value:function(e){e.addEventListener&&(e.addEventListener("dragstart",this.handleTopDragStart),e.addEventListener("dragstart",this.handleTopDragStartCapture,!0),e.addEventListener("dragend",this.handleTopDragEndCapture,!0),e.addEventListener("dragenter",this.handleTopDragEnter),e.addEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.addEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.addEventListener("dragover",this.handleTopDragOver),e.addEventListener("dragover",this.handleTopDragOverCapture,!0),e.addEventListener("drop",this.handleTopDrop),e.addEventListener("drop",this.handleTopDropCapture,!0))}},{key:"removeEventListeners",value:function(e){e.removeEventListener&&(e.removeEventListener("dragstart",this.handleTopDragStart),e.removeEventListener("dragstart",this.handleTopDragStartCapture,!0),e.removeEventListener("dragend",this.handleTopDragEndCapture,!0),e.removeEventListener("dragenter",this.handleTopDragEnter),e.removeEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.removeEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.removeEventListener("dragover",this.handleTopDragOver),e.removeEventListener("dragover",this.handleTopDragOverCapture,!0),e.removeEventListener("drop",this.handleTopDrop),e.removeEventListener("drop",this.handleTopDropCapture,!0))}},{key:"getCurrentSourceNodeOptions",value:function(){var e=this.monitor.getSourceId(),t=this.sourceNodeOptions.get(e);return Ps({dropEffect:this.altKeyPressed?"copy":"move"},t||{})}},{key:"getCurrentDropEffect",value:function(){return this.isDraggingNativeItem()?"copy":this.getCurrentSourceNodeOptions().dropEffect}},{key:"getCurrentSourcePreviewNodeOptions",value:function(){var e=this.monitor.getSourceId();return Ps({anchorX:.5,anchorY:.5,captureDraggingState:!1},this.sourcePreviewNodeOptions.get(e)||{})}},{key:"isDraggingNativeItem",value:function(){var e=this.monitor.getItemType();return Object.keys(h).some((function(t){return h[t]===e}))}},{key:"beginDragNativeItem",value:function(e,t){this.clearCurrentDragSourceNode(),this.currentNativeSource=function(e,t){var n=new Cs(_s[e]);return n.loadDataTransfer(t),n}(e,t),this.currentNativeHandle=this.registry.addSource(e,this.currentNativeSource),this.actions.beginDrag([this.currentNativeHandle])}},{key:"setCurrentDragSourceNode",value:function(e){var t=this;this.clearCurrentDragSourceNode(),this.currentDragSourceNode=e,this.mouseMoveTimeoutTimer=setTimeout((function(){return t.window&&t.window.addEventListener("mousemove",t.endDragIfSourceWasRemovedFromDOM,!0)}),1e3)}},{key:"clearCurrentDragSourceNode",value:function(){return!!this.currentDragSourceNode&&(this.currentDragSourceNode=null,this.window&&(this.window.clearTimeout(this.mouseMoveTimeoutTimer||void 0),this.window.removeEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)),this.mouseMoveTimeoutTimer=null,!0)}},{key:"handleDragStart",value:function(e,t){e.defaultPrevented||(this.dragStartSourceIds||(this.dragStartSourceIds=[]),this.dragStartSourceIds.unshift(t))}},{key:"handleDragEnter",value:function(e,t){this.dragEnterTargetIds.unshift(t)}},{key:"handleDragOver",value:function(e,t){null===this.dragOverTargetIds&&(this.dragOverTargetIds=[]),this.dragOverTargetIds.unshift(t)}},{key:"handleDrop",value:function(e,t){this.dropTargetIds.unshift(t)}},{key:"window",get:function(){return this.options.window}},{key:"document",get:function(){return this.options.document}}])&&Os(t.prototype,n),r&&Os(t,r),e}();const Bs=e=>{const t=function(e,t){return new Ns(e,t)}(e),n=t.handleTopDropCapture;return t.handleTopDropCapture=e=>{if(n.call(t,e),t.currentNativeSource&&e.dataTransfer.items){if([...e.dataTransfer.items].every((e=>{let{kind:t}=e;return"string"===t})))return;const n=(0,ls.getFilesFromDataTransferItems)(e.dataTransfer.items);t.currentNativeSource.item.filesPromise=n}},t};console.log("IPFS Web UI - v".concat("4.2.1"," - https://github.com/ipfs-shipyard/ipfs-webui/commit/").concat("9c10520")),async function(){const r=await vo.getAll(),i=$o(r);t.render(e.createElement(n.z,{store:i},e.createElement(c.a3,{i18n:es.Z},e.createElement(ss,{backend:Bs},e.createElement(Z,null)))),document.getElementById("root"))}()})()})();
//# sourceMappingURL=main.25540e63.js.map